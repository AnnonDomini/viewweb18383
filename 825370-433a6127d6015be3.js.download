"use strict";(this.webpackChunk_msteams_convene=this.webpackChunk_msteams_convene||[]).push([[825370],{152386:(e,n,i)=>{i.d(n,{VY:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appDefinition"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinition"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}}]}},...i(795820).Eb.definitions]}},290023:(e,n,i)=>{i.d(n,{r6:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appDefinitions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinitions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}}]}},...i(795820).Eb.definitions]}},848e3:(e,n,i)=>{i.d(n,{pr:()=>d,qy:()=>s,xv:()=>r,Xr:()=>m,V8:()=>c,i7:()=>p,gV:()=>u,oG:()=>k,ju:()=>f,DP:()=>N,QR:()=>b,ch:()=>h,NQ:()=>S,kj:()=>y,xc:()=>T,yr:()=>I});var a,t=i(516909),o=i(646689),l=i(275742);!function(e){e.Bot="Bot",e.Connector="Connector",e.Messaging="Messaging",e.StaticTabs="StaticTabs",e.GalleryTab="GalleryTab"}(a||(a={}));const d=e=>!!e&&F(e,[t.JMQ.Installed,t.JMQ.InstalledAndFavorited,t.JMQ.InstalledAndPermanent,t.JMQ.AdminPreInstalled]),s=e=>"InstalledApp"===(null==e?void 0:e.__typename)&&!(0,l.isUndefined)(null==e?void 0:e.definition),r=e=>!!e&&F(e,[t.JMQ.InstalledAndPermanent]),m=e=>!!e&&F(e,[t.JMQ.Featured]),c=e=>!!e&&F(e,[t.JMQ.PreConsented]),p=e=>F(e,[t.JMQ.RequireConsent]),u=e=>F(e,[t.JMQ.NotInstalled]),k=e=>e&&(v(e.definition,a.Bot,t.qi6.Personal)||v(e.definition,a.StaticTabs,t.qi6.Personal))||!1,v=(e,n,i)=>{if(!e)return!1;switch(n){case a.Bot:return e.bots&&(0,l.first)(e.bots)&&(0,l.includes)(e.bots[0].scopes,i)||!1;case a.StaticTabs:return e.staticTabs&&(0,l.first)(e.staticTabs)&&(0,l.includes)(e.staticTabs[0].scopes,i)||!1;default:return!1}},g=(e,n)=>e.installedScope&&e.installedScope.includes(n),f=e=>d(e)&&g(e,t.qi6.Personal),N=(e,n=!1)=>{const i=m(e)||d(e)&&(g(e,t.qi6.GroupChat)||g(e,t.qi6.Team));return n?i||c(e):i},b=e=>d(e)&&(g(e,t.qi6.GroupChat)||g(e,t.qi6.Team)),h=e=>{const n=e.data&&e.data.installApp;return!!n&&"InstalledApp"===n.__typename},S=e=>{const n=e.data&&e.data.installCustomApp;return!!n&&"InstalledApp"===n.__typename},y=e=>{const n=e.data&&e.data.upgradeApp;return!!n&&"InstalledApp"===n.__typename},F=(e,n)=>(0,l.includes)(n,e.installationState),T=e=>{let n="",i="";if(e&&e.length>0){const a=e.indexOf(o.Jk.statusKey),t=e.indexOf(o.Jk.errorCodeKey);n=a>-1?`Http status code: ${A(e.substr(a),o.Jk.statusKey)}`:`Http status code: ${o.BY}`,i=t>-1?`Error code: ${A(e.substr(t),o.Jk.errorCodeKey)}`:`Error code: ${o.WK.NoSpecificErrorMessageFound}`}return`${n}, ${i}`},A=(e,n)=>{const i=e.length>0?e.split(","):[];if(i.length>0){const e=i[0].replace(/[\\"'{}\s]/g,"").split(":");if(e.length>1&&(n===o.Jk.statusKey&&e[1]in o.WE||n===o.Jk.errorCodeKey&&e[1]in o.WK))return e[1]}return n===o.Jk.statusKey?o.BY:o.WK.NoSpecificErrorMessageFound},I=()=>`${`Http status code: ${o.BY}`}, ${`Error code: ${o.WK.NoSpecificErrorMessageFound}`}`},646689:(e,n,i)=>{var a,t;i.d(n,{WK:()=>a,WE:()=>t,BY:()=>o,Jk:()=>l,HU:()=>d}),function(e){e.NoSpecificErrorMessageFound="NoSpecificErrorMessageFound",e.Unknown="Unknown",e.Unauthorized="Unauthorized",e.AccessDenied="AccessDenied",e.BadRequest="BadRequest",e.NotFound="NotFound",e.AppScopeIsNotAllowed="AppScopeIsNotAllowed",e.AppIsNotInstalledInTheChat="AppIsNotInstalledInTheChat",e.AppIsNotInstalledInTheTeam="AppIsNotInstalledInTheTeam",e.AppIsNotActivelyInstalled="AppIsNotActivelyInstalled",e.AppIsBlockedByAppPermissionPolicy="AppIsBlockedByAppPermissionPolicy",e.UnknownFailureToParseTeamsAppManifest="UnknownFailureToParseTeamsAppManifest",e.UnableToParseTeamsAppManifest="UnableToParseTeamsAppManifest",e.AppSideloadingForbidden="AppSideloadingForbidden",e.CreateGroupChatAppDefinitionFailed="CreateGroupChatAppDefinitionFailed",e.AppDefinitionAlreadyExists="AppDefinitionAlreadyExists",e.AppDefinitionDoesntExist="AppDefinitionDoesntExist",e.UpdateGroupChatAppDefinitionFailed="UpdateGroupChatAppDefinitionFailed",e.GetAppDefinitionFailed="GetAppDefinitionFailed",e.GetGlobalAppDefinitionsFailed="GetGlobalAppDefinitionsFailed",e.AppDefinitionUpdateNotPermitted="AppDefinitionUpdateNotPermitted",e.AppEntitlementAlreadyExists="AppEntitlementAlreadyExists",e.CreateGroupChatAppEntitlementFailed="CreateGroupChatAppEntitlementFailed",e.CreateTeamAppEntitlementFailed="CreateTeamAppEntitlementFailed",e.GroupChatEntitlementDoesntExist="GroupChatEntitlementDoesntExist",e.TeamAppEntitlementsDontExist="TeamAppEntitlementsDontExist",e.UserAppEntitlementsDontExist="UserAppEntitlementsDontExist",e.TenantAppEntitlementsDontExist="TenantAppEntitlementsDontExist",e.UpgradeTeamAppEntitlementFailed="UpgradeTeamAppEntitlementFailed",e.UpgradeUserAppEntitlementFailed="UpgradeUserAppEntitlementFailed",e.UpgradeGroupChatAppEntitlementFailed="UpgradeGroupChatAppEntitlementFailed",e.GetUserEntitlementsFailed="GetUserEntitlementsFailed",e.GetDefaultUserAppEntitlementsFailed="GetDefaultUserAppEntitlementsFailed",e.SetUserAppEntitlementFailed="SetUserAppEntitlementFailed",e.PermanentAppEntitlementUpdateNotAllowed="PermanentAppEntitlementUpdateNotAllowed",e.GetUserAggregatedAppsFailed="GetUserAggregatedAppsFailed",e.TemplatedAppNotAllowedByTenantSettings="TemplatedAppNotAllowedByTenantSettings",e.TemplatedAppNotAllowedByUserPermissionPolicy="TemplatedAppNotAllowedByUserPermissionPolicy",e.TemplatedInstanceAppNotAllowed="TemplatedInstanceAppNotAllowed",e.GetTeamThreadFailed="GetTeamThreadFailed",e.GetTeamThreadsFailed="GetTeamThreadsFailed",e.GetChatThreadFailed="GetChatThreadFailed",e.GetTenantSettingsFailed="GetTenantSettingsFailed",e.NoPermissionToInstallApp="NoPermissionToInstallApp",e.NoPermissionToUpgradeApp="NoPermissionToUpgradeApp",e.NoPermissionToUploadCustomApp="NoPermissionToUploadCustomApp",e.FailedToCheckPermissionToManageApp="FailedToCheckPermissionToManageApp",e.AppIsTenantAdminBlocked="AppIsTenantAdminBlocked",e.AppUploadNotAllowedByTenant="AppUploadNotAllowedByTenant",e.AppUpdateNotAllowedByTenant="AppUpdateNotAllowedByTenant",e.UserNotAuthorizedToPerformAppOperationOnGroupChat="UserNotAuthorizedToPerformAppOperationOnGroupChat",e.AddAppBotToChatRosterFailed="AddAppBotToChatRosterFailed",e.AddAppBotToTeamRosterFailed="AddAppBotToTeamRosterFailed",e.AddBotToRosterFailedMaxLimitReached="AddBotToRosterFailedMaxLimitReached",e.UserNotFoundInSkypeTeam="UserNotFoundInSkypeTeam",e.BotIdFormatIsIncorrect="BotIdFormatIsIncorrect",e.GuestNotAllowedToInstallApps="GuestNotAllowedToInstallApps",e.GuestNotAllowedToUpdateApps="GuestNotAllowedToUpdateApps",e.GuestNotAllowedToUpgradeApps="GuestNotAllowedToUpgradeApps",e.OperationNotAllowedOnInstalledAndDeprecatedApp="OperationNotAllowedOnInstalledAndDeprecatedApp",e.AnonymousUsersInteractionNotSupported="AnonymousUsersInteractionNotSupported",e.GetUserAppSetupPoliciesAsync="GetUserAppSetupPoliciesAsync",e.InvalidHostedAppOperationForbidden="InvalidHostedAppOperationForbidden",e.OperationNotAllowedOnArchivedTeam="OperationNotAllowedOnArchivedTeam",e.ClientNetworkOffline="ClientNetworkOffline"}(a||(a={})),function(e){e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.NOT_ALLOWED=405]="NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.REQUEST_ENTITY_TOO_LARGE=413]="REQUEST_ENTITY_TOO_LARGE",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.REQUEST_RANGE_NOT_SATISFIABLE=416]="REQUEST_RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.THROTTLED=429]="THROTTLED",e[e.SERVER_ERROR=500]="SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.BANDWIDTH_LIMIT_EXCEEDED=509]="BANDWIDTH_LIMIT_EXCEEDED"}(t||(t={}));const o="NoHttpStatusCode",l={statusKey:"status",errorCodeKey:"errorCode"};var d;!function(e){e[e.BotInputMenu=1]="BotInputMenu",e[e.BotMentions=2]="BotMentions",e[e.MessageExtension=3]="MessageExtension",e[e.MessageAction=4]="MessageAction",e[e.LinkUnfurling=5]="LinkUnfurling",e[e.Webhooks=6]="Webhooks",e[e.BotCards=7]="BotCards",e[e.ChatPane=8]="ChatPane",e[e.MeetingAppNotifications=9]="MeetingAppNotifications",e[e.AppDetails=10]="AppDetails",e[e.TcPickerNavigation=11]="TcPickerNavigation",e[e.Scenes=12]="Scenes",e[e.CallEscalation=13]="CallEscalation",e[e.VivaFeedback=14]="VivaFeedback",e[e.InContextStore=15]="InContextStore",e[e.MeetingAppsFlyout=16]="MeetingAppsFlyout",e[e.AppsFlyout=17]="AppsFlyout",e[e.FreDialog=18]="FreDialog",e[e.Compose=19]="Compose",e[e.Connectors=20]="Connectors",e[e.PreviewCardFooter=21]="PreviewCardFooter",e[e.ACV2CardJITInstall=22]="ACV2CardJITInstall",e[e.MessageExtensionCardFooter=23]="MessageExtensionCardFooter",e[e.TaskModule=24]="TaskModule",e[e.MessageExtensionFlyoutCommand=25]="MessageExtensionFlyoutCommand",e[e.MessageExtensionFlyoutCommandPostInstall=26]="MessageExtensionFlyoutCommandPostInstall",e[e.GetFetchCommandApps=27]="GetFetchCommandApps",e[e.PinnedMessageExtensions=28]="PinnedMessageExtensions"}(d||(d={}))},401717:(e,n,i)=>{i.d(n,{aN:()=>Y,LS:()=>K,WW:()=>z,P2:()=>L,VC:()=>x,yx:()=>D,Vn:()=>w,HQ:()=>P,dK:()=>B,Qw:()=>V,sV:()=>E,xJ:()=>$,co:()=>U,Bi:()=>O,nM:()=>Q,eI:()=>T,eA:()=>H,Er:()=>q,Y2:()=>I});var a=i(850402),t=i(275742),o=i(591333),l=i(738646),d=i(905581),s=i(132756),r=i(848e3),m=i(290023),c=i(152386),p=i(516909);const u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appImpressions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"impressionProperty"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appImpressions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"impressionProperty"},value:{kind:"Variable",name:{kind:"Name",value:"impressionProperty"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}}]}}]};var k=i(902541);const v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"installApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installParameters"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallParametersInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installScope"},value:{kind:"Variable",name:{kind:"Name",value:"installScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"installParameters"},value:{kind:"Variable",name:{kind:"Name",value:"installParameters"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...k.W4.definitions]},g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"upgradeApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"upgradeApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installScope"},value:{kind:"Variable",name:{kind:"Name",value:"installScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...k.W4.definitions]},f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"deleteApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScope"},value:{kind:"Variable",name:{kind:"Name",value:"installedScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}]}]}}]};var N=i(348543),b=i(675056),h=i(814616),S=i(646689),y=i(805370),F=i(199018);const T=(e,n,i,a,t,o,l,d,s)=>{const m={installScope:t,appId:a,conversationId:d},c=n.newScenario(i);return c.appendEventData({"Thread.Id":d,"App.Id":a}),s&&c.appendEventData(s),Y(c,d),e.mutate({mutation:v,variables:m,update:A(e,m,o,l)}).then((e=>{var n,i;if(!(0,r.ch)(e)||!(null===(i=null===(n=e.data)||void 0===n?void 0:n.installApp)||void 0===i?void 0:i.definition))throw new Error("unexpected response, install app failed");return c.stop(),e.data.installApp})).catch((e=>{const n=e&&e.message?(0,r.xc)(e.message):(0,r.yr)();throw n.includes(S.WK.ClientNetworkOffline)?c.cancel({errors:n}):c.fail({errors:n}),e}))},A=(e,{installScope:n,conversationId:i},a,t)=>(o,l)=>{try{const o=(0,r.ch)(l)&&l.data;o&&o.installApp?(0,N.WB)({client:e,installedScope:n,conversationId:i,logger:a,enableAppsQueryOptimization:t},o.installApp):a.error("mutation update, install app failed")}catch(e){a.error("Failed to add app to client cache")}},I=(e,n,i,a,t,o,l,d,s)=>{const m={installScope:t,appId:a,conversationId:d},c=n.newScenario(i);return e.mutate({mutation:g,variables:m,update:C(e,m,o,l)}).then((e=>{var n,i;if(!(0,r.kj)(e)||!(null===(i=null===(n=e.data)||void 0===n?void 0:n.upgradeApp)||void 0===i?void 0:i.definition))throw new Error("unexpected response, upgrade app failed");return s?c.stop(s):c.stop(),e.data.upgradeApp})).catch((e=>{const n=e&&e.message?(0,r.xc)(e.message):(0,r.yr)();throw s?c.fail(Object.assign(Object.assign({},s),{errors:n})):c.fail({errors:n}),e}))},C=(e,{installScope:n,conversationId:i},a,t)=>(o,l)=>{try{const o=(0,r.kj)(l)&&l.data;o&&o.upgradeApp?(0,N.WB)({client:e,installedScope:n,conversationId:i,logger:a,enableAppsQueryOptimization:t},o.upgradeApp):a.error("mutation update, upgrade app failed")}catch(e){a.error("Failed to add app to client cache")}},E=(e,n,i,t)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const a=[p.qi6.Personal],o=null==t?void 0:t.conversation,d={installedScopes:o?[...a,o.scope]:a,conversationId:o&&o.id,options:{capabilityFilter:null==t?void 0:t.capabilityFilter}},s=n.newScenario(l.RG.ExtInstalledApps);try{const n=yield(0,y.r7)(e,d,"no-cache");s.mark(l.ck.ExtAppsFetched);const a=null==n?void 0:n.filter((e=>e&&e.definition&&e.id===i));return s.mark(l.ck.ExtAppsProcessed),s.stop(),a}catch(e){return s.fail({errors:`failed to get installed app id: ${i}`}),[]}})),D=(e,n,i,t)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var a;let o;i&&(o=t||p.qi6.GroupChat);const{data:l,error:r}=yield e.query({query:c.VY,variables:{appId:n,scope:o,conversationId:i}});if(!l||!l.appDefinition||r){const e="Get AppDefinition failed";throw(0,d.Tr)("AppsHelper",s.jK.NotPresent,"getAppDefinition",void 0,null!==(a=null==r?void 0:r.message)&&void 0!==a?a:e)}return l.appDefinition})),w=(e,n,i,t,o)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const{data:a,error:l}=yield e.query({query:m.r6,variables:n,context:{callerInfo:i}});if(!a||!a.appDefinitions){const e="Get AppDefinitions failed";if(o){const e=`Fail to get App definitions, error message: ${null==l?void 0:l.message}`;o(e)}throw new Error(e)}return t&&t(),a.appDefinitions})),P=(e,n)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const i=yield w(e,{options:{capabilityFilter:[p.PwB.Messaging]}},"getAppDefinitionsByContext");return x(i,n)})),x=(e,n)=>e.filter((e=>M(e,n))),M=(e,n)=>{var i;if(!n)return!0;const a=null!==(i=e.messageExtensions)&&void 0!==i?i:[];if(!(0,t.isEmpty)(a))for(const e of a)if((0,t.some)(e.commands,(e=>(0,h.RL)(e,n))))return!0;return!1},O=e=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const{client:n,logger:i,scenarioFactory:a,enableInstalledAppsV2:t,enableAppsQueryOptimization:o,entryPoint:l,isOneOnOneBotChat:d,scope:s,convId:r,botId:m}=e;let c={};r&&(c={conversation:d?void 0:{scope:s||p.qi6.GroupChat,id:r},capabilityFilter:[p.PwB.Bot],shouldFetchPersonalApps:d,botId:m,entryPoint:l});const u=t?yield Q(n,i,a,o,c,void 0):yield _(n,i,a,c);if(t&&m){return null==u?void 0:u.filter((e=>{var n,i,a;return(null===(a=null===(i=null===(n=e.definition)||void 0===n?void 0:n.bots)||void 0===i?void 0:i[0])||void 0===a?void 0:a.id)===m}))}return u})),U=(e,n,i,t,o,l,d)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){return t?yield Q(e,n,i,o,l,d):yield _(e,n,i,l,d)})),V=(e,n,i,t)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const a=i.newScenario(l.RG.ExtGetSimpleAppModel);try{const n=yield(0,y.oW)(e,null!=t?t:"cache-only");return a.stop(),n}catch(e){const i="getAppInstalledByCurrentUser failed";return a.fail({errors:i}),n.warn(`${i} ${e}`),[]}})),_=(e,n,i,t,o)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var a,d;const s=i.newScenario(l.RG.ExtInstalledApps);try{const n=[];(null==t?void 0:t.shouldFetchPersonalApps)&&n.push(p.qi6.Personal),(null==t?void 0:t.conversation)&&n.push(t.conversation.scope);const i=yield(0,y.r7)(e,{installedScopes:n,conversationId:null===(a=null==t?void 0:t.conversation)||void 0===a?void 0:a.id,options:{capabilityFilter:null==t?void 0:t.capabilityFilter,botId:null==t?void 0:t.botId}},null==t?void 0:t.fetchPolicy);s.mark(l.ck.ExtAppsFetched);const d=q(i,o);return s.mark(l.ck.ExtAppsProcessed),s.stop(),d}catch(e){const i=`getInstalledApps failed: ${null!==(d=null==t?void 0:t.botId)&&void 0!==d?d:""}`;return s.fail({errors:i}),n.warn(`${i} ${e}`),[]}})),B=(e,n,i,t,o)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var a;const r={query:u,fetchPolicy:null!=o?o:"network-only",variables:{impressionProperty:t}},m=i.newScenario(l.RG.ExtGetAppImpression),c="Get AppImpressions failed";try{const{data:n}=yield e.query(r);if(!n||!n.appImpressions)throw(0,d.Tr)("AppsHelper",s.jK.NotPresent,"getAppImpressions",void 0,c);return m.stop(),n.appImpressions}catch(e){return m.fail({errors:c}),null===(a=n.warnToTelemetry)||void 0===a||a.call(n,`${c} ${e}`,"platform_appsframework_appscore_apps_helper"),[]}})),q=(e,n,i)=>(0,o.compose)(t.compact,(0,o.map)((e=>G(e,n))),(0,o.filter)((e=>(0,r.qy)(e)&&J(e,i))))(e),G=(e,n)=>{if(!n)return e;let i=!1,a=[];if(e.definition.messageExtensions&&(a=e.definition.messageExtensions.map((e=>{var a;let o=e;const l=null!==(a=e.commands)&&void 0!==a?a:[];return(0,t.isEmpty)(e.commands)||(o=Object.assign(Object.assign({},e),{commands:l.filter((e=>!!(0,h.RL)(e,n)&&(i=!0,!0)))})),o}))),!i)return null;const o=a.length?Object.assign(Object.assign({},e.definition),{messageExtensions:a}):e.definition;return Object.assign(Object.assign({},e),{definition:o})},R=(e,{appId:n,installedScope:i,conversationId:a},t,o)=>(l,{data:d})=>{try{d&&d.deleteApp?(0,N.nF)({client:e,installedScope:i,conversationId:a,logger:t,enableAppsQueryOptimization:o},n):t.error("mutation update, delete app failed")}catch(e){t.error("Failed to remove app from client cache")}},L=(e,n,i,t,o,l)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var a,d;const s=n.newScenario(i);s.appendEventData({"Thread.Id":null!==(a=o.conversationId)&&void 0!==a?a:void 0}),Y(s,o.conversationId);try{const n=yield e.mutate({mutation:f,variables:o,update:R(e,o,t,l)});if(!(null===(d=null==n?void 0:n.data)||void 0===d?void 0:d.deleteApp))throw new Error("unexpected response, delete app failed");return s.stop(),n}catch(e){throw s.fail({errors:`failed to delete app ${o.appId}`}),e}})),$=(e,n,i,t,o,d,s)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const a=s||{},r=i.newScenario(l.RG.ExtInstalledAppsV2),m=[];try{if(null==s?void 0:s.enableInstalledAppQueryOptimization){if(a.shouldFetchPersonalApps){const n=yield e.query({query:F.Z,variables:{installedScope:p.qi6.Personal,appId:t},context:{callerInfo:`${d}-getInstalledAppsByIdV2`}});n.data.installedApp&&m.push(n.data.installedApp)}if(a.conversation&&a.conversation.id){const n=yield e.query({query:F.Z,variables:{installedScope:a.conversation.scope,appId:t,conversationId:a.conversation.id},context:{callerInfo:`${d}-getInstalledAppsByIdV2`}});n.data.installedApp&&m.push(n.data.installedApp)}return r.mark(l.ck.ExtAppsProcessed),r.stop(),m}{const i=(yield W(e,r,n,o,`${d}-getInstalledAppsByIdV2`,a)).filter((e=>e&&e.definition&&e.id===t));return r.mark(l.ck.ExtAppsProcessed),r.stop(),i}}catch(e){return r.fail({errors:`failed to get installed app id: ${t}`}),[]}})),Q=(e,n,i,t,o,d,s,r)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var a,m,c,p;const u=i.newScenario(l.RG.ExtInstalledAppsV2),k={"Thread.Id":null===(a=null==o?void 0:o.conversation)||void 0===a?void 0:a.id};(null==o?void 0:o.entryPoint)&&(k["App.EntryPoint"]=S.HU[o.entryPoint]);try{const i=yield W(e,u,n,t,(null==o?void 0:o.entryPoint)?S.HU[o.entryPoint]:"getInstalledAppsV2",o),a=q(i,d,o);return u.mark(l.ck.ExtAppsProcessed),u.stop(k),s&&s(),a}catch(e){const i=`getInstalledAppsV2 failed convId: ${null!==(c=null===(m=null==o?void 0:o.conversation)||void 0===m?void 0:m.id)&&void 0!==c?c:""} botId: ${null!==(p=null==o?void 0:o.botId)&&void 0!==p?p:""}`;return u.fail(Object.assign(Object.assign({},k),{errors:i})),r&&r(i),n.warn(`${i}`),[]}})),W=(e,n,i,t,o,d)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){let a;const{fetchPolicyForScope:s,fetchOptions:r}=yield(0,b.EQ)(e,i,d);let m=null,c=null;(null==d?void 0:d.shouldFetchPersonalApps)&&(a={scope:p.qi6.Personal},m=(0,y.Px)(e,{installedContext:a},o,(0,b.i6)(s[p.qi6.Personal])).then((e=>(n.mark(l.ck.ExtAppsFetchedPersonalScope),i.log(`installedApps: ${e.length} scope: ${a.scope}`),e)))),(null==d?void 0:d.conversation)&&(null==d?void 0:d.conversation.id)&&(c=j(e,n,i,t,d.conversation,s,o));const u=[...m?[m]:[],...c?[c]:[]],[k,v]=yield Promise.all(u);return(0,b.N$)(e,i,r),k.concat(v)})),j=(e,n,i,a,t,o,d)=>{let s;const r=t.scope,m=t.scope===p.qi6.Team,c={scope:r,conversationId:t.id},u=(0,b.i6)(o[r]);return a&&!m?(s=(0,y.KD)(e,{conversationId:t.id},u),n.mark(l.ck.ExtAppsQueryInstalledAppsWithPreCheck)):(s=(0,y.Px)(e,{installedContext:c},d,u),n.mark(l.ck.ExtAppsQueryInstalledAppsV2)),s=s.then((e=>{i.log(`installedApps: ${e.length} scope: ${c.scope} conversationId: ${c.conversationId}`);const a=r===p.qi6.Team?l.ck.ExtAppsFetchedTeamScope:l.ck.ExtAppsFetchedGroupScope;return n.mark(a),e})),s},J=(e,n)=>{if((0,t.isEmpty)(null==n?void 0:n.capabilityFilter))return!0;const i=e.definition;return(0,t.some)(null==n?void 0:n.capabilityFilter,(e=>{switch(e){case p.PwB.Messaging:return!(0,t.isEmpty)(i.messageExtensions);case p.PwB.Tab:return!(0,t.isEmpty)(i.galleryTabs)||(null==n?void 0:n.enableStaticTabsPhase1)&&!(0,t.isEmpty)(i.staticTabs);case p.PwB.Bot:return!(0,t.isEmpty)(i.bots);case p.PwB.Connector:return!(0,t.isEmpty)(i.connectors)}}))},z=(e,n)=>{var i,a,t,o,l,d;let s=K(e,n.bots)||K(e,n.connectors)||K(e,n.galleryTabs)||K(e,n.staticTabs);if(e===p.qi6.Team)return s;if(s||(s=K(e,n.messageExtensions)),e!==p.qi6.Personal)return s;const r=(null!==(t=null===(a=null===(i=n.meetingExtensionDefinition)||void 0===i?void 0:i.scenes)||void 0===a?void 0:a.length)&&void 0!==t?t:0)>0,m=(null!==(d=null===(l=null===(o=n.meetingExtensionDefinition)||void 0===o?void 0:o.filters)||void 0===l?void 0:l.length)&&void 0!==d?d:0)>0;return s||r||m},K=(e,n)=>(0,t.some)(n,(n=>(0,t.includes)(n.scopes,e))),H=e=>!!e&&(e.toLowerCase().includes("replychainid")||e.toLowerCase().includes("messageid")),Y=(e,n)=>{H(n)&&e.appendEventData({"Thread.Type":"Channel"})}},976337:(e,n,i)=>{i.d(n,{l:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appsInstalledByCurrentUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appsInstalledByCurrentUser"}}]}}]}},388196:(e,n,i)=>{i.d(n,{e:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appsUsage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appsUsage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appsUsageFields"}}]}}]}},...i(103360).o.definitions]}},675056:(e,n,i)=>{i.d(n,{EQ:()=>s,i6:()=>p,N$:()=>m,Ns:()=>c});var a=i(850402),t=i(516909);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"platformAppsBatchFetchPolicy"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchPolicyOptions"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"platformAppsBatchFetchPolicy"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[{kind:"Argument",name:{kind:"Name",value:"always"},value:{kind:"BooleanValue",value:!0}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scope"}},{kind:"Field",name:{kind:"Name",value:"convId"}},{kind:"Field",name:{kind:"Name",value:"forceNetworkFetch"}}]}}]}}]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DataClientPlatformUpdateAllAppsFetchPoliciesMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fetchSource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateAllPlatformAppsFetchPolicies"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fetchSource"},value:{kind:"Variable",name:{kind:"Name",value:"fetchSource"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};var d=i(632132);const s=(e,n,i)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const a={};let o=[];try{(null==i?void 0:i.shouldFetchPersonalApps)&&(o=[{scope:t.qi6.Personal}]),(null==i?void 0:i.conversation)&&(null==i?void 0:i.conversation.id)&&(o=[...o,{scope:i.conversation.scope,convId:i.conversation.id}]);const a=yield r(e,o);return n.log("getFetchPolicy for installedApps",a),{fetchPolicyForScope:a,fetchOptions:o}}catch(e){return n.error("getFetchPolicy for installedApps failed"),{fetchPolicyForScope:a,fetchOptions:o}}})),r=(e,n)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var i;const{data:a}=yield e.query({query:o,variables:{options:n}}),t={},l=null===(i=null==a?void 0:a.platformAppsBatchFetchPolicy)||void 0===i?void 0:i.reduce(((e,n)=>Object.assign(Object.assign({},e),{[n.scope]:n.forceNetworkFetch})),t);return null!=l?l:t})),m=(e,n,i,a)=>{const o=null!=a?a:t.p1$.Cache,l=i.map((e=>Object.assign(Object.assign({},e),{fetchSource:o})));return e.mutate({mutation:d.Ur,variables:{input:l}}).catch((e=>(n.error("failed to set fetch policy to ",o),Promise.resolve(void 0))))},c=(e,n,i)=>{e.mutate({mutation:l,variables:{fetchSource:i}}).catch((e=>{n.error("failed to update all fetch policies to ",i)}))},p=e=>e?"network-only":"cache-first"},199018:(e,n,i)=>{i.d(n,{Z:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScope"},value:{kind:"Variable",name:{kind:"Name",value:"installedScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...i(902541).W4.definitions]}},426447:(e,n,i)=>{i.d(n,{Cj:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsV2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...i(902541).W4.definitions]}},805370:(e,n,i)=>{i.d(n,{oW:()=>u,yC:()=>p,KD:()=>m,r7:()=>k,Px:()=>c});var a=i(850402),t=i(426447),o=i(902541);const l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...o.W4.definitions]},d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedApps"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApps"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScopes"},value:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...o.W4.definitions]};var s=i(388196),r=i(976337);const m=(e,n,i)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const{data:a}=yield e.query({query:l,variables:n,fetchPolicy:i});return a&&a.installedChatAppsWithPreCheck?a.installedChatAppsWithPreCheck:[]})),c=(e,n,i,o)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const{data:a}=yield e.query({query:t.Cj,variables:n,fetchPolicy:o,context:{callerInfo:i}});return a&&a.installedAppsV2?a.installedAppsV2:[]})),p=(e,n)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const{data:i}=yield e.query({query:s.e,fetchPolicy:n});return(null==i?void 0:i.appsUsage)?i.appsUsage:{__typename:"AppsUsage",appIds:[],appActions:[],appScenes:[],appsMru:[]}})),u=(e,n)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const i=yield e.query({query:r.l,fetchPolicy:n}),{data:a}=i;return(null==a?void 0:a.appsInstalledByCurrentUser)?a.appsInstalledByCurrentUser:[]})),k=(e,n,i)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const{data:a}=yield e.query({query:d,variables:n,fetchPolicy:i});return a&&a.installedApps?a.installedApps:[]}))},348543:(e,n,i)=>{i.d(n,{WB:()=>v,sw:()=>p,nF:()=>k});var a=i(516909),t=i(275742);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsIdList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}}]}}]}}]};var l=i(675056);const d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedChatAppsIdsList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}}]}}]}}]};var s=i(199018);const r=(e,n,i)=>e===a.qi6.Personal?{installedScope:e,appId:n}:{installedScope:e,appId:n,conversationId:i},m=(e,n)=>({installedContext:e===a.qi6.Personal?{scope:e}:{scope:e,conversationId:n}}),c=e=>({conversationId:e}),p=(e,n,i,t,o)=>{const l=i.newLogger("UpdateAppsCache","components-apps-platform-queries");try{if(!n.installedAppsUpdateEventV2)return;const{installedAppsUpdateEventV2:{installedScope:i,app:d,appId:s,eventType:r,conversationId:m}}=n,c={client:e,installedScope:i,conversationId:m,logger:l,enableAppsQueryOptimization:t};if(o&&i===a.qi6.Personal)return void u(i,m,e,l,o);switch(r){case a.rQh.Added:v(c,d);break;case a.rQh.Removed:k(c,s);break;case a.rQh.Synced:u(i,m,e,l,o)}}catch(e){l.error("update apps cache failed")}},u=(e,n,i,t,o)=>{if(n&&(e===a.qi6.GroupChat||e===a.qi6.Team)||!n&&e===a.qi6.Personal){if(o&&e===a.qi6.Personal)return void(0,l.Ns)(i,t,a.p1$.Network);let d=[];d=[{scope:e,convId:n}],(0,l.N$)(i,t,d,a.p1$.Network)}},k=(e,n)=>{const{logger:i,client:o,installedScope:l,conversationId:d}=e;if((0,t.isNull)(n)||l!==a.qi6.Personal&&!d)return void i.warn("removeAppFromCache - invalid input",n,l,d);const m=r(l,n,d);try{o.writeQuery({query:s.Z,variables:m,data:{installedApp:null}})}catch(e){throw i.error("removeAppFromCache - failed to update installedApp query",n,l,d),e}const c=f(e);if((0,t.isNull)(c))return void i.warn("removeAppFromCache - no apps in cache",n);const p=(0,t.filter)(c,(e=>null===e||e.id!==n));p.length!==c.length?(i.log("Removing from apps cache "),N(e,p)):i.warn("app to delete already removed from cache")},v=(e,n)=>{const{logger:i,client:o,installedScope:l,conversationId:d}=e;if((0,t.isNull)(n)||l!==a.qi6.Personal&&!d)return void i.warn("addAppToCache - invalid input",n,l,d);const{id:m,installedVersion:c,conversationId:p,__typename:u}=n,k=r(l,m,d);try{o.writeQuery({query:s.Z,variables:k,data:{installedApp:n}})}catch(e){throw i.error("addAppToCache - failed to update installedApp query",n,l,d),e}const v=f(e);if((0,t.isNull)(v))return void i.warn("addAppToCache - no apps in cache",n);const g=n.id,b=(0,t.find)(v,(e=>(null==e?void 0:e.id)===g));(0,t.isNil)(b)?(i.log("Adding to apps cache"),N(e,[...v,{id:m,conversationId:p,installedVersion:c,installedScope:l,__typename:u}])):i.warn("app to add already in cache",b)},g=(e,n)=>e===a.qi6.GroupChat&&n,f=({client:e,installedScope:n,conversationId:i,logger:a,enableAppsQueryOptimization:t})=>{try{if(g(n,t)){if(i){const n=e.readQuery({query:d,variables:c(i)});return n&&n.installedChatAppsWithPreCheck?n.installedChatAppsWithPreCheck:(a.warn("readQuery for group scope returned no results"),null)}return a.error("invalid convid for cache read"),null}{const t=e.readQuery({query:o,variables:m(n,i)});return t&&t.installedAppsV2?t.installedAppsV2:(a.warn("readQuery returned no results"),null)}}catch(e){throw e}},N=({client:e,installedScope:n,conversationId:i,enableAppsQueryOptimization:a,logger:t},l)=>{try{g(n,a)?i?e.writeQuery({query:d,variables:c(i),data:{installedChatAppsWithPreCheck:l}}):t.error("invalid convid for cache update"):e.writeQuery({query:o,variables:m(n,i),data:{installedAppsV2:l}})}catch(e){throw e}}},265447:(e,n,i)=>{var a;i.d(n,{D:()=>a}),function(e){e.None="none",e.ApiSecretServiceAuth="apiSecretServiceAuth",e.MicrosoftEntra="microsoftEntra"}(a||(a={}))},814616:(e,n,i)=>{i.d(n,{Li:()=>c,mO:()=>u,lF:()=>k,Vn:()=>v,kH:()=>g,ZT:()=>f,hF:()=>N,F_:()=>b,RL:()=>y,O0:()=>T,Un:()=>C,S:()=>E});var a=i(516909),t=i(275742),o=i(591333),l=i(265447),d=i(760005),s=i(80719),r=i(281216);const m=[a.ht_.Compose,a.ht_.Commandbox],c=(e,n,i)=>{if(!n.id)return null;const a=b(n),t=h(n),l=a?p(a):null,[d,s]=(0,o.compose)((0,o.partition)(F),(0,o.map)((n=>A(e,n))),(0,o.filter)((e=>y(e,i))),S)(a);return{appInfo:t,validDomains:n.validDomains||[],type:null==a?void 0:a.type,botId:a&&a.botId||"",actionCommands:d,queryCommands:s,authorization:l||void 0,galleryTabs:n.galleryTabs||[]}},p=e=>{if(e.type!==a.y8Q.ApiBased)return null;const{authorization:n}=e;return n&&"microsoftEntra"===n.authType&&n.microsoftEntraConfiguration?{authType:l.D.MicrosoftEntra,microsoftEntraConfiguration:{supportsSingleSignOn:!!n.microsoftEntraConfiguration.supportsSingleSignOn}}:{authType:l.D.None}},u=e=>!(0,t.isEmpty)(e.appInfo.tenantId),k=e=>{const n=b(e),i=n&&n.botId||"";return`${d.at.BotPrefix}${i}`},v=e=>e&&(0,t.isEmpty)(e.queryCommands)&&(0,t.isArray)(e.actionCommands)&&e.actionCommands.length>=1,g=e=>e&&(0,t.isEmpty)(e.queryCommands)&&(0,t.isArray)(e.actionCommands)&&1===e.actionCommands.length,f=e=>e&&(0,t.isEmpty)(e.queryCommands)&&(0,t.isArray)(e.actionCommands)&&e.actionCommands.length>1,N=e=>e&&(0,t.isArray)(e.queryCommands)&&e.queryCommands.length>1,b=e=>e&&(0,o.first)(e.messageExtensions),h=e=>{var n;return{accentColor:e.accentColor||"",appId:e.id,appName:e.name||"",appIcon:e.largeImageUrl||"",isFullScreenApp:e.isFullScreenApp||!1,isFullTrustApp:e.isFullTrustApp||!1,tenantId:e.tenantId||"",externalId:e.externalId||"",resource:(null===(n=e.webApplicationInfo)||void 0===n?void 0:n.resource)||"",isMicrosoftOwned:e.isMicrosoftOwned||!1}},S=e=>e&&e.commands||[],y=(e,n)=>(0,t.isEmpty)(e.context)?(0,t.includes)(m,n):(0,t.includes)(e.context,n),F=e=>e&&(0,t.isString)(e.type)&&e.type.toLowerCase()===a.wHp.Action.toLowerCase(),T=(e,n)=>(e=>e.type===a.y8Q.ApiBased)(n)?e?`${d.at.TeamsAppPrefix}${n.appInfo.appId}`:"":`${d.at.BotPrefix}${n.botId}`,A=(e,n)=>({id:n.id,type:n.type||a.wHp.Query,context:n.context,fetchTask:!!n.fetchTask,description:n.description,initialRun:!!n.initialRun,parameters:n.parameters,title:n.title||"",appKey:n.appKey,taskInfo:C(e,n.taskInfo,n.parameters)}),I=(e,n)=>{const i={};return e&&(i.title=e.title||"",i.height=P(e.height),i.width=P(e.width)||n),i},C=(e,n,i)=>{const a=D(i);if(a){const i=e.stringTranslate("extensibility","inputExtension_task_module_button_title");return a.addSubmitAction("submitButton",i,{id:"submitButton"}),Object.assign(Object.assign({},I(n,s.Jc.Large)),{card:a.getCard()})}if(n)return n.url?Object.assign(Object.assign({},I(n)),{url:n.url}):Object.assign({},I(n))},E=(e,n)=>{const i=D(n);if(!i)return null;const a=e.stringTranslate("extensibility","message_extension_query_command_submit_button_title");return i.addSubmitAction("submitButton",a,{}),i.getRawJson()},D=e=>{if(!e||(0,t.isEmpty)(e))return null;const n=new r.h;return e.forEach((e=>w(n,e))),n},w=(e,n)=>{var i,t;if(!n)return;n.title&&e.addLabel(n.title);const o=n.title||"",l=n.name||"",d=n.description||"",s=null!==(i=n.value)&&void 0!==i?i:void 0;switch(n.inputType||a.evG.Text){case a.evG.Text:e.addTextInput(l,d,s,200,!1);break;case a.evG.Textarea:e.addTextInput(l,d,s,1e3,!0);break;case a.evG.Number:e.addNumberInput(l,d,s);break;case a.evG.Date:e.addDateInput(l,d,s);break;case a.evG.Time:e.addTimeInput(l,d,s);break;case a.evG.Toggle:e.addToggle(l,o,s);break;case a.evG.Choiceset:const i=(null!==(t=n.choices)&&void 0!==t?t:[]).map((e=>{var n,i;return{title:null!==(n=e.title)&&void 0!==n?n:"",value:null!==(i=e.value)&&void 0!==i?i:""}}));e.addChoiceSet(l,o,!1,!0,i,s)}},P=e=>{if(!(0,t.isNil)(e))return x(e)?(0,t.isNil)(e.customValue)?void 0:e.customValue:M(e)?O(e):void 0},x=e=>"DimensionInFloat"===e.__typename,M=e=>"DimensionInString"===e.__typename,O=e=>{if((0,t.isNil)(e.predefinedValue))return;switch(e.predefinedValue.toLowerCase()){case"small":return s.Jc.Small;case"medium":return s.Jc.Medium;case"large":return s.Jc.Large;default:return}}},186116:(e,n,i)=>{i.d(n,{ul:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPlatformTabUtilsChannelByIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"channelType"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"defaultOneNoteSectionId"}},{kind:"Field",name:{kind:"Name",value:"defaultFileSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesRelativePath"}}]}},{kind:"Field",name:{kind:"Name",value:"hostTeamGroupId"}},{kind:"Field",name:{kind:"Name",value:"hostTeamId"}},{kind:"Field",name:{kind:"Name",value:"hostTenantId"}},{kind:"Field",name:{kind:"Name",value:"owningTeam"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"isArchived"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"teamType"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}},{kind:"Field",name:{kind:"Name",value:"isGeneral"}}]}}]}}]}},371637:(e,n,i)=>{i.d(n,{li:()=>r,g4:()=>m,E9:()=>c,dJ:()=>p,iP:()=>k,ot:()=>g,dE:()=>f,Cn:()=>h});var a,t=i(466094),o=i(466149),l=i(118418),d=i(122862),s=i(500396);!function(e){e.Member="member",e.Guest="guest",e.External="external",e.Anonymous="anonymous",e.Unknown="unknown"}(a||(a={}));const r=(e,n,i)=>n===s.k2.None&&e===l.rf.Conference&&!i,m=(e,n,i)=>n===s.k2.None&&e===l.rf.P2P&&i,c=(e,n)=>{var i,t;if(p(e))return a.Anonymous;if(u(e))return a.Guest;if(e&&n){if(k(null===(i=e.profile)||void 0===i?void 0:i.tenantId,n))return a.External;if(v(null===(t=e.profile)||void 0===t?void 0:t.tenantId,n))return a.Member}return a.Unknown},p=e=>(null==e?void 0:e.role)===t.w4.Anonymous,u=e=>(null==e?void 0:e.role)===t.w4.Guest,k=(e,n,i)=>(null==i||i.log(`isExternalUser: tenantId-${n}, currentTenantId-${e}`),!(!n||!e||e===n)),v=(e,n)=>!!n&&!!e&&e===n,g=(e,n,i,a,t)=>{var o;const l=null===(o=null==e?void 0:e.baseInfo)||void 0===o?void 0:o.id,s=null==n?void 0:n.appDefinition;if(null==t||t.log(`(isValidTabForInMeetingExperience) Tab: ${l}, App: ${null==s?void 0:s.name} ${null==s?void 0:s.id}, isAnonymousUser: ${i}, enableMeetingSurfaces: ${a}`),!a||((e,n,i)=>{var a,t,o,l,s,r,m,c,p;const u=null===(t=null===(a=n.appDefinition)||void 0===a?void 0:a.galleryTabs)||void 0===t?void 0:t[0];let k=!1;if("StaticExtensionTab"===e.__typename){const a=null===(l=null===(o=n.appDefinition)||void 0===o?void 0:o.staticTabs)||void 0===l?void 0:l.find((n=>n.entityId===(null==e?void 0:e.entityId)));k=null===(s=null==a?void 0:a.context)||void 0===s?void 0:s.some((e=>e===d.BU.MeetingSidePanel)),null==i||i.log(`(isMeetingOptimizeApp) Static tab ${null===(r=null==e?void 0:e.baseInfo)||void 0===r?void 0:r.id} isMeetingOptimized: ${k}`)}else k=(null===(m=null==u?void 0:u.context)||void 0===m?void 0:m.some((e=>e===d.jD.MeetingSidePanel)))||(null===(c=null==u?void 0:u.meetingSurfaces)||void 0===c?void 0:c.some((e=>e===d.Aj.SidePanel))),null==i||i.log(`(isMeetingOptimizeApp) Gallery Tab ${null===(p=null==e?void 0:e.baseInfo)||void 0===p?void 0:p.id} isMeetingOptimized: ${k}. `);return!!k})(e,n,t)){const e=!i||(e=>{var n,i;return null===(i=null===(n=null==e?void 0:e.appDefinition)||void 0===n?void 0:n.meetingExtensionDefinition)||void 0===i?void 0:i.isAnonymousAccessAllowed})(n);return null==t||t.log(`(isValidTabForInMeetingExperience) is access to tab '${l}', valid: ${e}`),e}return!1},f=(e,n,i,a,d,s,m,c,p,u)=>{if(!s)return!1;const k=(null==e?void 0:e.type)===t.Ch.MsaLife;if(u&&k)return!0;if(h(e,s))return!1;const v=r(i,m,a);if(b(a,v,d))return!1;const g=n===o.Eh.Organizer||n===o.Eh.Presenter,f=c&&i===l.rf.P2P;return g||f||p&&N(n,v)},N=(e,n)=>e===o.Eh.Attendee&&n,b=(e,n,i)=>i&&(e||n),h=(e,n)=>{if(p(e))return!0;if(u(e))return!0;return!!k(null==e?void 0:e.profile.tenantId,n)}},369398:(e,n,i)=>{i.d(n,{g7:()=>S,$s:()=>y,hR:()=>F,$c:()=>T,RD:()=>A,kT:()=>I,u$:()=>E,uo:()=>w,kq:()=>P,zy:()=>x,xO:()=>M,LY:()=>O,KG:()=>U,eA:()=>_,OL:()=>B,s0:()=>q,Rd:()=>G,k6:()=>R,TQ:()=>L,gc:()=>$,jZ:()=>Q,SR:()=>W,uJ:()=>j,kU:()=>J,pQ:()=>z,rh:()=>K,BT:()=>H,Kf:()=>Y,vr:()=>Z,oP:()=>X,Nt:()=>ee,_K:()=>ne,J2:()=>ie,dN:()=>ae,ti:()=>te,Fd:()=>oe,r6:()=>le,kB:()=>de,CX:()=>se,Td:()=>re,ui:()=>ce,JF:()=>pe,Iv:()=>ue,rt:()=>ke,ig:()=>ve,eF:()=>ge,OJ:()=>fe,w4:()=>Ne,cq:()=>be});var a=i(850402),t=i(152386),o=i(516909),l=i(752491),d=i(248965),s=i(956255),r=i(662707),m=i(685370),c=i(486070),p=i(738646),u=i(663945),k=i(122862),v=i(554404),g=i(500396),f=i(118418),N=i(186116),b=i(371637),h=i(393879);const S=(e,n,i,t,l)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const{data:a,error:d}=yield e.query({query:r.br,variables:(null==i?void 0:i.isChannelMeeting)&&(null==i?void 0:i.messageId)?{id:n,queryType:o.rtK.QueryByMessage,storageOptions:{messageStorage:{messageId:i.messageId},platformTabsQueryType:o.rtK.QueryByMessage},options:t}:{id:n,queryType:o.rtK.QueryByThread,options:t},fetchPolicy:"no-cache"});return d&&(null==l||l.error(`(getTabsData) Error fetching tabs: ${d.message}`)),a})),y=(e,n,i,l,d,s)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const a=_(l),r=a?yield T(e,n):void 0,{data:m,error:c}=yield e.query({query:t.VY,variables:{scope:a?o.qi6.Team:o.qi6.GroupChat,conversationId:a?r:n,appId:i}});return c&&(null==s||s.fail({errors:`Error getting app data for app ${i}: ${c.message}`,"App.Id":i,reason:"AppDefinitionError"}),null==d||d.error(`(getAppData) Error getting app data for app ${i}: ${c.message}`)),m&&m.appDefinition||(null==s||s.fail({errors:`App definition not found for app ${i}`,"App.Id":i,reason:"AppDefinitionMissing"}),null==d||d.error(`(getAppData) App definition not found for app ${i}`)),m})),F=(e,n,i,o)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const{data:a}=yield e.query({query:t.VY,variables:{scope:o,conversationId:n,appId:i}});return a})),T=(e,n)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){return A(e,n)})),A=(e,n)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var i,a;if(!n)return;const{conversationId:t}=w(n);if(!t)return;return(null===(a=null===(i=(yield e.query({query:N.ul,variables:{conversationId:t}})).data)||void 0===i?void 0:i.channelByID.owningTeam)||void 0===a?void 0:a.id)||void 0})),I=(e,n,i)=>{var a,t;if(C(n)){if(!i)return{botMri:e,appId:n.id};if(null===(t=null===(a=n.definition)||void 0===a?void 0:a.staticTabs)||void 0===t?void 0:t.some((e=>e.entityId===i)))return{botMri:e,appId:n.id,tabEntityId:i}}},C=e=>{var n,i,a,t,o,l;return!!((null===(i=null===(n=e.definition)||void 0===n?void 0:n.galleryTabs)||void 0===i?void 0:i.some((e=>{var n;return null===(n=null==e?void 0:e.context)||void 0===n?void 0:n.some((e=>e===k.jD.MeetingSidePanel))})))||(null===(t=null===(a=e.definition)||void 0===a?void 0:a.galleryTabs)||void 0===t?void 0:t.some((e=>{var n;return null===(n=null==e?void 0:e.meetingSurfaces)||void 0===n?void 0:n.some((e=>e===k.Aj.SidePanel))})))||(null===(l=null===(o=e.definition)||void 0===o?void 0:o.staticTabs)||void 0===l?void 0:l.some((e=>{var n;return null===(n=null==e?void 0:e.context)||void 0===n?void 0:n.some((e=>e===k.BU.MeetingSidePanel))}))))},E=(e,n,i,t)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const{data:a,error:o}=yield e.query({query:m.yo,variables:{tabId:n,threadId:i}});return o&&(null==t||t.error(`(getPlatformTab) Error fetching tab: ${o.message}`)),a})),D=";messageid=",w=e=>{var n;const i=null!==(n=null==e?void 0:e.split(";replyChainId="))&&void 0!==n?n:[];let a=i[0];const t=i[1];if(null==a?void 0:a.includes("channelId")){a=JSON.parse(a).channelId}return(null==a?void 0:a.includes(D))&&(a=a.split(D)[0]),{conversationId:a,replyChainId:t}},P=e=>{const{replyChainId:n}=w(e);return _(n)?o.qi6.Team:o.qi6.GroupChat},x=(e,n,i,t,l,d,s,r,m,c)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var a,u;const k=[],v=[];if(!e)return k;for(const r of e)if(m&&"StaticExtensionTab"===r.__typename||"ExtensionTab"===r.__typename){const e={tabId:r.baseInfo.id,displayName:decodeURIComponent(r.baseInfo.displayName||""),entityId:r.entityId,tabType:r.__typename,tabPinnedState:r.pinnedState||o.vb$.UserPinned},m=yield y(n,i,r.baseInfo.appId,d,s,c);if((0,b.ot)(r,m,t,!!l,s)){const n={appId:r.baseInfo.appId,appName:(null===(a=m.appDefinition)||void 0===a?void 0:a.name)||"",iconUrl:(null===(u=m.appDefinition)||void 0===u?void 0:u.smallImageUrl)||""};e.displayName||(e.displayName=decodeURIComponent(n.appName));const i={tabInfo:e,appInfo:n};k.push(i)}else v.push(r.baseInfo.appId)}return(null==v?void 0:v.length)>0&&(null==c||c.mark(p.ck.PlatformTabFetchUbarDroppedTabsDueToMeetingContext),null==s||s.log(`convertToTabButtons(${r}) dropped apps: ${v.join(",")}`)),k})),M=(e,n,i,t,o,l,d,s,r,m)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var a;null==m||m.mark(p.ck.PlatformTabFetchStart);const c=yield S(e,n,o,s,l);null==l||l.log(`getPlatformTabs(${d}): fetched ${null===(a=c.platformTabs)||void 0===a?void 0:a.length} tabs`);const u=yield x(c.platformTabs,e,n,i,t,null==o?void 0:o.messageId,l,d,r,m);return null==m||m.stop(),u})),O=(e,n)=>{var i,a;const t=[],o=[];for(const n of e.platformTabsEvent)if("StaticExtensionTab"===(null==n?void 0:n.__typename)||"ExtensionTab"===(null==n?void 0:n.__typename)){const e=null!==(i=n.baseInfo.appId)&&void 0!==i?i:"",l=null!==(a=n.baseInfo.id)&&void 0!==a?a:"";t.push(e),o.push(l)}n.log(`tabsEvent appData: ${t.join(",")}`),n.log(`tabsEvent tabData: ${o.join(",")}`)},U=(e,n,i,a,t,l,d,s,r,m)=>{const c=[o.wJZ.Scheduled,o.wJZ.Recurring],p=e&&c.includes(e)&&(!l||m),u=s&&V(e,n,i),k=d&&(0,b.li)(n,i,a),v=r&&(0,b.g4)(n,i,a);return null==t||t.log(`isSupportedMeeting: meetingType-${e}, isChannelMeeting- ${l}, isSupportedInPrivateOrChannelMeeting-${p}, \n    callType -${n}, isSupportedInCalendarMeetNow: ${u}, isSupportedInGroupCall: ${k},\n    isSupportedInOneOnOneCall: ${v}: chatSubType - ${i}, isOneOnOne - ${a}`),!!(p||u||k||v)},V=(e,n,i)=>e&&e===o.wJZ.MeetNow&&n===f.rf.Conference&&i===g.k2.Meeting,_=e=>!!e&&"0"!==e;function B(e){return _(e)?{platformTabsQueryType:o.rtK.QueryByMessage,messageStorage:{messageId:e}}:void 0}function q(e){return e?{appInstallScope:o.qi6.Team}:{appInstallScope:o.qi6.GroupChat}}const G=e=>_(e)?o.rtK.QueryByMessage:o.rtK.QueryByThread,R=e=>{switch(e){case l.m.Channel:case l.m.ChannelMeeting:case l.m.ChannelMeetingSchedulingForm:case l.m.SelectAppEntity:return o.qi6.Team;default:return o.qi6.GroupChat}},L=e=>e?{appInstallScope:o.qi6.Team,platformTabsEntryPoint:o.sqJ.ChannelMeeting}:{appInstallScope:o.qi6.GroupChat,platformTabsEntryPoint:o.sqJ.PrivateMeeting},$=e=>{switch(e){case v.mQ.privateMeetingSchedulingForm:return{appInstallScope:o.qi6.GroupChat,platformTabsEntryPoint:o.sqJ.PrivateMeetingSchedulingForm};case v.mQ.chatTab:return{appInstallScope:o.qi6.GroupChat,platformTabsEntryPoint:o.sqJ.GroupChat};case v.mQ.channelMeetingSchedulingForm:return{appInstallScope:o.qi6.Team,platformTabsEntryPoint:o.sqJ.ChannelMeetingSchedulingForm};case v.mQ.channelTab:return{appInstallScope:o.qi6.Team,platformTabsEntryPoint:o.sqJ.Channel};default:return}},Q=e=>{const n=new Error(e.message);return n.name=e.name,n},W=e=>{switch(e){case o.qi6.GroupChat:return d.Mv.group;case o.qi6.Personal:return d.Mv.personal;case o.qi6.Team:return d.Mv.team;default:return}},j=e=>J({chatId:null==e?void 0:e.chatId,teamId:null==e?void 0:e.teamId,channelId:null==e?void 0:e.channelId}),J=e=>{const{chatId:n,teamId:i,channelId:a}=e||{};return n?o.qi6.GroupChat:i||a?o.qi6.Team:o.qi6.Personal},z=e=>Z(e)||ie(e)?e.baseInfo.id:"",K=e=>Z(e)||ie(e)?e.baseInfo.appId:"",H=e=>ie(e)&&e.entityId||"",Y=e=>(Z(e)||ie(e))&&e.websiteUrl?e.websiteUrl:null,Z=e=>"WebsiteTab"===(null==e?void 0:e.__typename),X=e=>"FileViewTab"===(null==e?void 0:e.__typename),ee="com.microsoft.teamspace.tab.file.staticviewer.pdf",ne=e=>e===ee,ie=e=>"ExtensionTab"===(null==e?void 0:e.__typename)||ae(e),ae=e=>"StaticExtensionTab"===(null==e?void 0:e.__typename),te=e=>"StaticExtensionTab"===e,oe=e=>"PlaceholderTab"===(null==e?void 0:e.__typename),le=e=>{var n,i;return!!ae(e)&&(null===(i=null===(n=e.baseInfo)||void 0===n?void 0:n.context)||void 0===i?void 0:i.includes(k.BU.TeamLevelApp))},de=(e,n)=>{var i;return(null===(i=null==e?void 0:e.linkedEntity)||void 0===i?void 0:i.type)===s.py.extensions&&!n},se=(e,n,i,a,t)=>({threadId:e,tab:{id:n,displayName:"",tabType:o.Qhk.StaticExtensionTab,appInstallScope:i,externalId:t},storageOptions:B(a)}),re=(e,n)=>{if(e)return me(e.id,e.isMeeting,e.isOneOnOne,e.isOneOnOneBotChat,n)},me=(e,n,i,a,t)=>{if(e)return n?u.Th.Meeting:i?a?u.Th.Botchat:u.Th.OneOnOneChat:t?u.Th.Channel:u.Th.GroupChat},ce=(e,n,i,a,t,o)=>{const l=(0,h.Z)(),d=d=>{var s;null===(s=e.findScenario(d))||void 0===s||s.cancel();const r=e.newScenario(d,{clientId:`${d};${l}`});e.hoistScenarioToCore&&e.hoistScenarioToCore(r),r.appendEventData({"App.Id":n,"App.EntryPoint":i,"PlatformApp.IsMultiWindow":!!t,"PlatformApp.FromOpenFileInTeams":!!o}),null==a||a.log(`phase 1 scenario marker started for entryPoint ${i}`)};d(p.RG.PlatformTabFrameLoading),d(p.RG.PlatformTabLaunch)},pe=(e,n,i)=>{(a=>{var t;null===(t=e.findScenario(a))||void 0===t||t.cancel();const o=(0,h.Z)();e.newScenario(a,{clientId:o}).appendEventData({"App.EntryPoint":n}),null==i||i.log(`fetch platform tabs - scenario marker started for entryPoint ${n}`)})(p.RG.PlatformTabFetchData)},ue=(e,n)=>{switch(e){case l.m.Meeting:case l.m.ChannelMeeting:return k.BU.MeetingSidePanel;case l.m.PrivateMeetingSchedulingForm:case l.m.ChannelMeetingSchedulingForm:return k.BU.MeetingDetailsTab;case l.m.Channel:return k.BU.ChannelTab;case l.m.Chat:return n&&he(n)?k.BU.MeetingChatTab:k.BU.PrivateChatTab;case l.m.MeetingChat:return k.BU.MeetingChatTab;default:return k.BU.Unknown}},ke=(e,n)=>e===c.PG.Desktop&&!1===n,ve=e=>{switch(e){case d.Mv.group:return o.qi6.GroupChat;case d.Mv.personal:return o.qi6.Personal;case d.Mv.team:return o.qi6.Team;default:return}},ge=(e,n,i)=>({threadId:e.threadId,messageId:e.messageId||(null==i?void 0:i.messageId),appId:n.appId||e.appId,tabId:e.tabId||n.tabId,tabEntityId:n.tabEntityId||e.tabEntityId}),fe=(e,n)=>n.find((n=>{var i;return"StaticExtensionTab"===n.__typename&&(null===(i=null==n?void 0:n.baseInfo)||void 0===i?void 0:i.appId)===e})),Ne=(e,n,i)=>Boolean(e&&e.length>0&&e.filter((e=>{var a,t;return-1!==(null===(a=e.context)||void 0===a?void 0:a.indexOf(n))&&-1!==(null===(t=e.scopes)||void 0===t?void 0:t.indexOf(i))})).length>0),be=(e,n,i)=>{let a;if(n)try{a=e.id&&JSON.parse(e.id)}catch(n){i.error(`entity id ${e.id} json parsing failed`)}else{const n=e.id&&decodeURIComponent(e.id);a=n&&JSON.parse(n)}return a},he=e=>!!e&&e.includes("meeting")},894506:(e,n,i)=>{i.d(n,{e:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"baseInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BaseTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"externalAppId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"dateAdded"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}},{kind:"Field",name:{kind:"Name",value:"teamInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"teamSiteDomain"}},{kind:"Field",name:{kind:"Name",value:"teamSitePath"}},{kind:"Field",name:{kind:"Name",value:"teamSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"channelInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"channelRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"channelType"}}]}},{kind:"Field",name:{kind:"Name",value:"tabPermission"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canUpdateConfig"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"definedDevicePermissions"}}]}}]}}]}},495275:(e,n,i)=>{i.d(n,{W:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesCalendarTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CalendarTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...i(894506).e.definitions]}},977907:(e,n,i)=>{i.d(n,{y:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlaceholderTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...i(894506).e.definitions]}},880977:(e,n,i)=>{i.d(n,{C:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"legacyDocumentLibraryTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LegacyDocumentLibraryTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"libraryId"}},{kind:"Field",name:{kind:"Name",value:"libraryServerRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"selectedSiteImageUrl"}},{kind:"Field",name:{kind:"Name",value:"selectedDocumentLibraryTitle"}},{kind:"Field",name:{kind:"Name",value:"selectedSiteTitle"}}]}},...i(894506).e.definitions]}},106879:(e,n,i)=>{i.d(n,{e:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"extensionTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"removeUrl"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"isPlaceholderTab"}}]}},...i(894506).e.definitions]}},127835:(e,n,i)=>{i.d(n,{N:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"fileViewTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FileViewTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"providerMetadata"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}}]}},...i(894506).e.definitions]}},403556:(e,n,i)=>{i.d(n,{K:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"legacyWikiTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LegacyWikiTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"wikiTabId"}},{kind:"Field",name:{kind:"Name",value:"wikiDefaultTab"}},{kind:"Field",name:{kind:"Name",value:"hasContent"}},{kind:"Field",name:{kind:"Name",value:"scenarioName"}},{kind:"Field",name:{kind:"Name",value:"isMyWiki"}},{kind:"Field",name:{kind:"Name",value:"isPrivateMeetingWiki"}},{kind:"Field",name:{kind:"Name",value:"meetingNotes"}},{kind:"Field",name:{kind:"Name",value:"hasMigratedToOneNote"}}]}},...i(894506).e.definitions]}},830426:(e,n,i)=>{i.d(n,{H:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"oneNoteTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OneNoteTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"oneNoteId"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"sectionUrl"}},{kind:"Field",name:{kind:"Name",value:"notebookId"}},{kind:"Field",name:{kind:"Name",value:"notebookLocation"}},{kind:"Field",name:{kind:"Name",value:"service"}},{kind:"Field",name:{kind:"Name",value:"subtype"}}]}},...i(894506).e.definitions]}},507149:(e,n,i)=>{i.d(n,{S:()=>N});var a=i(613992),t=i(894506);const o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"extensionTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...t.e.definitions]};var l=i(412615);const d={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"basicTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BasicTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}},{kind:"Field",name:{kind:"Name",value:"displayNameLocalizationKey"}}]}}]}},...t.e.definitions]};var s=i(174306),r=i(127835),m=i(820005),c=i(830426),p=i(403556),u=i(880977),k=i(977907),v=i(495275);const g={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesDocumentLibraryTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DocumentLibraryTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...t.e.definitions]},f={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesWikiTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WikiTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...t.e.definitions]},N={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"platformTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlatformTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"extensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"websiteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"basicTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"fileViewTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"powerBiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"oneNoteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyWikiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyDocumentLibraryTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesCalendarTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesDocumentLibraryTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesWikiTabFragment"}}]}},...a.p.definitions,...o.definitions,...l.Y.definitions,...d.definitions,...s.Q.definitions,...r.N.definitions,...m.y.definitions,...c.H.definitions,...p.K.definitions,...u.C.definitions,...k.y.definitions,...v.W.definitions,...g.definitions,...f.definitions]}},820005:(e,n,i)=>{i.d(n,{y:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"powerBiTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PowerBiTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"originatingTeam"}},{kind:"Field",name:{kind:"Name",value:"originatingTeamId"}},{kind:"Field",name:{kind:"Name",value:"reports"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...i(894506).e.definitions]}},174306:(e,n,i)=>{i.d(n,{Q:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"staticExtensionTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StaticExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"pinnedState"}}]}},...i(894506).e.definitions]}},613992:(e,n,i)=>{i.d(n,{p:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"staticExtensionTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StaticExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"pinnedState"}}]}},...i(894506).e.definitions]}},412615:(e,n,i)=>{i.d(n,{Y:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"websiteTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WebsiteTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...i(894506).e.definitions]}},685370:(e,n,i)=>{i.d(n,{yo:()=>k});var a=i(174306),t=i(106879),o=i(412615),l=i(613992),d=i(127835),s=i(820005),r=i(830426),m=i(403556),c=i(880977),p=i(977907),u=i(495275);const k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Tab"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"tabId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsStorage"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"TabOptionInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"platformTab"},arguments:[{kind:"Argument",name:{kind:"Name",value:"tabId"},value:{kind:"Variable",name:{kind:"Name",value:"tabId"}}},{kind:"Argument",name:{kind:"Name",value:"threadId"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}},{kind:"Argument",name:{kind:"Name",value:"storageOptions"},value:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"extensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"websiteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"fileViewTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"powerBiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"oneNoteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyWikiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyDocumentLibraryTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesCalendarTabFragment"}}]}}]}},...a.Q.definitions,...t.e.definitions,...o.Y.definitions,...l.p.definitions,...d.N.definitions,...s.y.definitions,...r.H.definitions,...m.K.definitions,...c.C.definitions,...p.y.definitions,...u.W.definitions]}},662707:(e,n,i)=>{i.d(n,{br:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"PlatformTabsInfo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"queryType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsQueryType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsStorage"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"TabOptionInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"platformTabs"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"platformTabsQueryType"},value:{kind:"Variable",name:{kind:"Name",value:"queryType"}}},{kind:"Argument",name:{kind:"Name",value:"storageOptions"},value:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"platformTabInfo"}}]}}]}},...i(507149).S.definitions]}},560197:(e,n,i)=>{i.d(n,{XL:()=>o,R2:()=>l,It:()=>d});var a=i(265858),t=i(275742);const o=a.createContext({recordPanelAction:()=>{},createDatabag:()=>({dispose:t.noop}),appendBiData:()=>{},removeBiData:()=>{},recordPanelView:()=>{}}),l=o.Provider,d=()=>a.useContext(o)},752491:(e,n,i)=>{var a;i.d(n,{m:()=>a}),function(e){e.Chat="Chat",e.EduEmptyState="EduEmptyState",e.Meeting="Meeting",e.Channel="Channel",e.ChannelMeeting="ChannelMeeting",e.PrivateMeetingSchedulingForm="PrivateMeetingSchedulingForm",e.ChannelMeetingSchedulingForm="ChannelMeetingSchedulingForm",e.SingleTeamGridView="SingleTeamGridView",e.MeetingChat="MeetingChat",e.SelectAppEntity="SelectAppEntity",e.ChatMakeAsATab="ChatMakeAsATab",e.ChannelMakeAsATab="ChannelMakeAsATab"}(a||(a={}))},80719:(e,n,i)=>{var a,t,o,l,d,s,r,m,c,p;i.d(n,{gV:()=>a,XY:()=>t,Jc:()=>o,Ae:()=>l}),function(e){e[e.Card=0]="Card",e[e.MessageExtension=1]="MessageExtension",e[e.PlatformExtensionTab=2]="PlatformExtensionTab",e[e.DeepLink=3]="DeepLink",e[e.ShareToOutlook=4]="ShareToOutlook",e[e.ContentBubble=5]="ContentBubble",e[e.AdaptiveCardTab=6]="AdaptiveCardTab",e[e.BotConfig=7]="BotConfig",e[e.StoreApp=8]="StoreApp"}(a||(a={})),function(e){e.contentBubble="contentBubble",e.targetedMeetingNotification="targetedMeetingNotification"}(t||(t={})),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(o||(o={})),function(e){e.message="message",e.compose="compose",e.commandBox="commandBox",e.copilot="copilot"}(l||(l={})),function(e){e.normal="normal",e.high="high",e.urgent="urgent"}(d||(d={})),function(e){e.aadApplication="aadApplication",e.bot="bot",e.tenantBot="tenantBot",e.office365Connector="office365Connector",e.webhook="webhook"}(s||(s={})),function(e){e.team="team",e.channel="channel"}(r||(r={})),function(e){e.html="html",e.text="text"}(m||(m={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry"}(c||(c={})),function(e){e.aadUser="aadUser",e.onPremiseAadUser="onPremiseAadUser",e.anonymousGuest="anonymousGuest",e.federatedUser="federatedUser"}(p||(p={}))},956255:(e,n,i)=>{var a,t,o;i.d(n,{uk:()=>a,py:()=>t,$z:()=>o}),function(e){e.config="config",e.confirm="confirm",e.create="create",e.default="default",e.delete="delete",e.empty="empty",e.error="error",e.health="health",e.info="info",e.infoDetails="infoDetails",e.join="join",e.leave="leave",e.list="list",e.loading="loading",e.locationhandler="locationhandler",e.manage="manage",e.mutate="mutate",e.pin="pin",e.share="share",e.signin="signin",e.tenantLogin="tenantLogin",e.tenantRedemption="tenantRedemption",e.update="update",e.view="view"}(a||(a={})),function(e){e.acceptsharedchannelinvitationdialog="acceptsharedchannelinvitationdialog",e.accessibilitypanel="accessibilitypanel",e.accounts="accounts",e.activity="activity",e.activityinapptoastundo="activityinapptoastundo",e.addchannel="addchannel",e.addcontactdialog="addcontactdialog",e.addmember="addmember",e.addmembernewteam="addmembernewteam",e.addmembertoprivatechanneldialog="addmembertoprivatechanneldialog",e.addmembertoteamdialog="addmembertoteamdialog",e.agendapage="agendapage",e.alttext="alttext",e.appswitcherdesktopactivecalldialog="appswitcherdesktopactivecalldialog",e.appswitcherwebactivecalldialog="appswitcherwebactivecalldialog",e.appswitcherwebmultipletabsdialog="appswitcherwebmultipletabsdialog",e.archiveteam="archiveteam",e.attendancereport="attendancereport",e.annotation="annotation",e.appdetails="appdetails",e.attendeeview="attendeeview",e.authrefreshdialog="authrefreshdialog",e.autobrbconfirmationdialog="autobrbconfirmationdialog",e.autobrbflowdialog="autobrbflowdialog",e.autoinstallnotification="autoinstallnotification",e.bannerNotification="bannerNotification",e.blank="blank",e.blockChat="blockChat",e.brbfeedbackdialog="brbfeedbackdialog",e.breakoutrooms="breakoutrooms",e.breakoutroomsassignment="breakoutroomsassignment",e.breakoutroomsassignmenttype="breakoutroomsassignmenttype",e.breakoutroomscreaterooms="breakoutroomscreaterooms",e.breakoutroomsdeleteroom="breakoutroomsdeleteroom",e.breakoutroomsdeleterooms="breakoutroomsdeleterooms",e.breakoutroomseditroom="breakoutroomseditroom",e.breakoutroomssettings="breakoutroomssettings",e.breakoutroomspanel="breakoutroomspanel",e.broadcastfeedback="broadcastfeedback",e.broadcastliveevent="broadcastliveevent",e.broadcastqna="broadcastqna",e.broadcasts="broadcasts",e.byodattendeewindow="byodattendeewindow",e.byodchat="byodchat",e.byodroster="byodroster",e.calendar="calendar",e.callablechannels="callablechannels",e.callhistoryrow="callhistoryrow",e.callingconfirmdialog="callingconfirmdialog",e.callingalertdialog="callingalertdialog",e.callingbannernotification="callingbannernotification",e.callingdeeplink="callingdeeplink",e.callingdeeplinkDialog="callingdeeplinkDialog",e.callingdialog="callingdialog",e.callingprotocoldeeplinkdialog="callingprotocoldeeplinkdialog",e.calls="calls",e.callscontent="callscontent",e.callsgallery="callsgallery",e.callsgalleryandcontent="callsgalleryandcontent",e.callskeypad="callskeypad",e.callsmain="callsmain",e.callsmonitor="callsmonitor",e.callstransfer="callstransfer",e.cameraeffects="cameraeffects",e.cast="cast",e.changeteampicture="changeteampicture",e.channelcalendar="channelcalendar",e.channelconnectors="channelconnectors",e.channelcopilot="channelcopilot",e.channelworkflows="channelworkflows",e.channeldeeplink="channeldeeplink",e.channeldelete="channeldelete",e.channeledit="channeledit",e.channelemail="channelemail",e.channelemailerror="channelemailerror",e.channelemailv2="channelemailv2",e.channelinvitations="channelinvitations",e.channelanalytics="channelanalytics",e.channelmanage="channelmanage",e.channelmembers="channelmembers",e.channelmoderators="channelmoderators",e.channelsettings="channelsettings",e.channeltags="channeltags",e.channelnotificationsettings="channelnotificationsettings",e.channelroster="channelroster",e.channels="channels",e.channelsPinnedPost="channelsPinnedPost",e.channelsSystemMessage="channelsSystemMessage",e.channelcontextualsearch="channelcontextualsearch",e.chats="chats",e.chatworkflows="chatworkflows",e.chatschannelconv="chatschannelconv",e.chatContextualSearch="chatContextualSearch",e.chatfilesdetails="chatfilesdetails",e.chatHighlightsDetails="chatHighlightsDetails",e.chatInviteConfirmation="chatInviteConfirmation",e.chatManageApps="chatManageApps",e.chatpeopledetails="chatpeopledetails",e.chatsInfo="chatsInfo",e.chatsInfoView="chatsInfoView",e.closedcaptionssettings="closedcaptionssettings",e.cloudStorageDialog="cloudStorageDialog",e.classesintegrationcontent="classesintegrationcontent",e.coachreport="coachreport",e.connectedcalendardialog="connectedcalendardialog",e.connectedcalendarsurfacedialog="connectedcalendarsurfacedialog",e.codesnippet="codesnippet",e.communities="communities",e.communitiesaddmember="communitiesaddmember",e.communitiesblockmembers="communitiesblockmembers",e.communitiesevents="communitiesevents",e.communitiescreatechannel="communitiescreatechannel",e.communitiesdeletechannel="communitiesdeletechannel",e.communitiescreateevent="communitiescreateevent",e.communitieseditchannel="communitieseditchannel",e.communitiesdelete="communitiesdelete",e.communitiesguidelinesdialog="communitiesguidelinesdialog",e.communitiesjoinrequest="communitiesjoinrequest",e.communitiesmembers="communitiesmembers",e.communitiesgetappdialog="communitiesgetappdialog",e.communitiescreatedialog="communitiescreatedialog",e.communitieseditdialog="communitieseditdialog",e.communitiesonboarding="communitiesonboarding",e.communitiesjoininviteview="communitiesjoininviteview",e.communitiesremovemember="communitiesremovemember",e.communitiessendpostasemaildialog="communitiessendpostasemaildialog",e.communitiessettings="communitiessettings",e.communitieswelcomebotconfigdialog="communitieswelcomebotconfigdialog",e.connectorinstanceconfiguration="connectorinstanceconfiguration",e.contactssync="contactssync",e.contentcamerasetup="contentcamerasetup",e.copilot="copilot",e.coursecalendar="coursecalendar",e.courseteams="courseteams",e.createchanneldialog="createchanneldialog",e.createchannelleftraildialog="createchannelleftraildialog",e.crosspostchannelselectiondialog="crosspostchannelselectiondialog",e.crosspostchannelselectiondialogV2="crosspostchannelselectiondialogV2",e.crosspostdeletedialog="crosspostdeletedialog",e.crossteamanalytics="crossteamanalytics",e.customapp="customapp",e.customizereactions="customizereactions",e.customemojiupload="customemojiupload",e.default="default",e.defaultchannelnavdialog="defaultchannelnavdialog",e.deletechannelreactdialog="deletechannelreactdialog",e.showhidegeneralchannelwarningdialog="showhidegeneralchannelwarningdialog",e.deletechat="deletechat",e.deleteteam="deleteteam",e.deleteActivityFeedItem="deleteActivityFeedItem",e.devicedetails="devicedetails",e.devicesettings="devicesettings",e.discoversurface="discoversurface",e.dlp="dlp",e.discoverappsnotifications="discoverappsnotifications",e.eduteamcreate="eduteamcreate",e.email="email",e.esp="esp",e.error="error",e.events="events",e.eventsbroadcastqna="eventsbroadcastqna",e.example="example",e.exploratorylicense="exploratorylicense",e.extensions="extensions",e.externalnavigation="externalnavigation",e.faceenrollment="faceenrollment",e.file="file",e.filepicker="filepicker",e.fileopensettings="fileopensettings",e.filesoneupviewer="filesoneupviewer",e.floatingmonitor="floatingmonitor",e.floodgate="floodgate",e.fluid="fluid",e.flyout="flyout",e.flyoutphonelink="flyoutphonelink",e.flyoutwhatsnew="flyoutwhatsnew",e.framework="framework",e.freemiumupgrade="freemiumupgrade",e.gallery="gallery",e.galleryImages="galleryImages",e.getlinktoteamorchanneldialog="getlinktoteamorchanneldialog",e.giphyconsent="giphyconsent",e.givefeedbackchoices="givefeedbackchoices",e.guardians="guardians",e.guardiansapprovalrequest="guardiansapprovalrequest",e.guardianssendapprovalerror="guardianssendapprovalerror",e.guardianssendapprovalsuccess="guardianssendapprovalsuccess",e.help="help",e.homepage="homepage",e.hostedflyout="hostedflyout",e.hostedincontextstore="hostedincontextstore",e.hybridplaceholder="hybridplaceholder",e.hyperlink="hyperlink",e.identity="identity",e.identitydialog="identitydialog",e.inAppToast="inAppToast",e.incontextstore="incontextstore",e.invisionwhiteboard="invisionwhiteboard",e.invitecoworkers="invitecoworkers",e.joinlinkdialog="joinlinkdialog",e.leavechanneldialog="leavechanneldialog",e.leavechannellastownerdialog="leavechannellastownerdialog",e.leavechat="leavechat",e.leavecommunity="leavecommunity",e.leaveteam="leaveteam",e.leaveGroupAndBlockUser="leaveGroupAndBlockUser",e.licenses="licenses",e.licenserequestdialog="licenserequestdialog",e.linkedin="linkedin",e.livepersonacard="livepersonacard",e.livepersonaeditor="livepersonaeditor",e.lobnotifications="lobnotifications",e.locationapi="locationapi",e.locationnotification="locationnotification",e.locationnotificationbanner="locationnotificationbanner",e.m365ChatDislike="m365ChatDislike",e.m365ChatLike="m365ChatLike",e.officeintegrationfredialog="officeintegrationfredialog",e.onboardingnotifications="onboardingnotifications",e.selectMediaApi="selectMediaApi",e.selectpeoplepicker="selectpeoplepicker",e.simplecollab="simplecollab",e.viewImagesApi="viewImagesApi",e.m365ChatReportHarm="m365ChatReportHarm",e.manageapps="manageapps",e.manageappswebhook="manageappswebhook",e.meetingcollaboration="meetingcollaboration",e.meetingcollaborationcontent="meetingcollaborationcontent",e.mediastreams="mediastreams",e.meetinganalytics="meetinganalytics",e.meetingdetails="meetingdetails",e.meetingoptionscreatedialog="meetingoptionscreatedialog",e.meetingrecap="meetingrecap",e.meetingrecapchiclet="meetingrecapchiclet",e.meetingrecaptab="meetingrecaptab",e.meetingroomallinone="meetingroomallinone",e.meetingroomallinonecall="meetingroomallinonecall",e.meetingroomconsolecall="meetingroomconsolecall",e.meetingroomfrontofroom="meetingroomfrontofroom",e.meetingroomfrontofroomcontent="meetingroomfrontofroomcontent",e.meetingroomfrontofroomgallery="meetingroomfrontofroomgallery",e.meet="meet",e.meetingapis="meetingapis",e.meetings="meetings",e.meetingsettings="meetingsettings",e.meetingstream="meetingstream",e.meshavatar="meshavatar",e.messagedraft="messagedraft",e.messages="messages",e.memenu="memenu",e.minimodeMeetingScheduler="minimodeMeetingScheduler",e.notificationsettingsdefault="notificationsettingsdefault",e.campaignnotifications="campaignnotifications",e.updatemsaprofileavatardialog="updatemsaprofileavatardialog",e.updatemsaprofilenamedialog="updatemsaprofilenamedialog",e.notes="notes",e.oauthcode="oauthcode",e.open3sfeedback="open3sfeedback",e.openfeedbackdialog="openfeedbackdialog",e.optionssettingsdialog="optionssettingsdialog",e.ownerleavecommunity="ownerleavecommunity",e.pstncallmedialog="pstncallmedialog",e.pearnotdefaultapp="pearnotdefaultapp",e.percommunitynotificationsettingsdialog="percommunitynotificationsettingsdialog",e.peopleapp="peopleapp",e.pinnedchatsmaxreached="pinnedchatsmaxreached",e.pinnedconversationitems="pinnedconversationitems",e.pinunpinpost="pinunpinpost",e.platformapp="platformapp",e.platformcontextlessinstalldialog="platformcontextlessinstalldialog",e.platformsubscriptionplans="platformsubscriptionplans",e.platformappdetails="platformappdetails",e.platformappratingcoachmark="platformappratingcoachmark",e.platformappconsent="platformappconsent",e.platformappdevicepermissions="platformappdevicepermissions",e.platformtab="platformtab",e.platformapps="platformapps",e.stagedapps="stagedapps",e.platformauthconsentdialog="platformauthconsentdialog",e.platformStage="platformStage",e.platformstageinactivemeeting="platformstageinactivemeeting",e.platformstagemodal="platformstagemodal",e.platformTabGallery="platformTabGallery",e.prejoinoverlaydialog="prejoinoverlaydialog",e.premiumtrialdialog="premiumtrialdialog",e.presentdeeplinknomeetingcontextdialog="presentdeeplinknomeetingcontextdialog",e.presenterchat="presenterchat",e.presentertoolbar="presentertoolbar",e.ptzextension="ptzextension",e.queues="queues",e.queueuser="queueuser",e.queuesanalyticsheadertab="queuesanalyticsheadertab",e.queuesanalyticsrealtimenavigationitem="queuesanalyticsrealtimenavigationitem",e.queuesanalyticshistoricalnavigationitem="queuesanalyticshistoricalnavigationitem",e.registration="registration",e.removechannelemail="removechannelemail",e.removechatuser="removechatuser",e.reportConcern="reportConcern",e.forwardMessage="forwardMessage",e.reportconcerncommunities="reportconcerncommunities",e.reportConcernForTFW="reportConcernForTFW",e.restartrecomendeddialog="restartrecomendeddialog",e.restorechannel="restorechannel",e.restorechannelreactdialog="restorechannelreactdialog",e.restoreteam="restoreteam",e.roomremote="roomremote",e.roster="roster",e.schedulingform="schedulingform",e.schoolteams="schoolteams",e.hwctaskmodule="hwctaskmodule",e.search="search",e.settingsdialog="settingsdialog",e.settingsstore="settingsstore",e.settingsstorecallqueue="settingsstorecallqueue",e.settingsstoredelegator="settingsstoredelegator",e.sharechannelwithuserdialog="sharechannelwithuserdialog",e.sharedchannelspendinginvites="sharedchannelspendinginvites",e.sharedchannelacceptinvitation="sharedchannelacceptinvitation",e.sharedchanneldeclineinvitation="sharedchanneldeclineinvitation",e.sharedchanneldenyinvitation="sharedchanneldenyinvitation",e.sharewithteamyouowndialog="sharewithteamyouowndialog",e.sharedchannelcreateinvitationsdialog="sharedchannelcreateinvitationsdialog",e.sharechatlink="sharechatlink",e.sharecommunitieslink="sharecommunitieslink",e.embedcommunitycodedialog="embedcommunitycodedialog",e.shareformdialog="shareformdialog",e.shareMeetingInfo="shareMeetingInfo",e.showchannelownersreactdialog="showchannelownersreactdialog",e.showChannelOwners="showChannelOwners",e.showformemberdialog="showformemberdialog",e.showformemberdialogv2="showformemberdialogv2",e.signoutdialog="signoutdialog",e.simplecollabremoveconversationfolder="simplecollabremoveconversationfolder",e.smartdeviceagendapage="smartdeviceagendapage",e.smartdevicelogin="smartdevicelogin",e.smartdevicelogoutdialog="smartdevicelogoutdialog",e.staleteamsdialog="staleteamsdialog",e.staleteamsdismiss="staleteamsdismiss",e.standaloneapp="standaloneapp",e.stagecontent="stagecontent",e.stagingroomstartmeetingconfirmationdialog="stagingroomstartmeetingconfirmationdialog",e.stopsharingchannelwithteam="stopsharingchannelwithteam",e.stopsharingchannelwithteamreactdialog="stopsharingchannelwithteamreactdialog",e.store="store",e.storefre="storefre",e.storecart="storecart",e.storecartcheckout="storecartcheckout",e.streamcamera="streamcamera",e.streamcamerainchannels="streamcamerainchannels",e.streamcameraincommunities="streamcameraincommunities",e.survey="survey",e.switchaccountdialog="switchaccountdialog",e.tabapps="tabapps",e.taskmodule="taskmodule",e.teamarchive="teamarchive",e.archivechannel="archivechannel",e.unarchivechannel="unarchivechannel",e.teamanalytics="teamanalytics",e.teamchannels="teamchannels",e.teamcreate="teamcreate",e.teamdeeplink="teamdeeplink",e.teamdiscover="teamdiscover",e.teamedit="teamedit",e.teamsgallery="teamsgallery",e.teamjoin="teamjoin",e.teamjoincode="teamjoincode",e.teamjoindialog="teamjoindialog",e.teamleave="teamleave",e.teammanage="teammanage",e.teammanageapps="teammanageapps",e.teammanagetags="teammanagetags",e.teampendingrequests="teampendingrequests",e.teampicture="teampicture",e.teamrenewal="teamrenewal",e.teamrestore="teamrestore",e.teams="teams",e.teamcreatedialog="teamcreatedialog",e.teamserrordialog="teamserrordialog",e.teamslist="teamslist",e.teamsettings="teamsettings",e.tflfre="tflfre",e.toasts="toasts",e.tpndialog="tpndialog",e.transcript="transcript",e.transcriptcontent="transcriptcontent",e.transcripttab="transcripttab",e.translationfeedback="translationfeedback",e.twowaysmsfriendlyname="twowaysmsfriendlyname",e.unparkcalldialog="unparkcalldialog",e.unifiedconsentdialog="unifiedconsentdialog",e.unsupporteddeeplinkdialog="unsupporteddeeplinkdialog",e.updatedesktopapp="updatedesktopapp",e.updategroupchatavatar="updategroupchatavatar",e.tfwupdategroupchatavatar="tfwupdategroupchatavatar",e.usermediadialog="usermediadialog",e.useronboardingteam="useronboardingteam",e.videobackgrounds="videobackgrounds",e.stylemyroom="stylemyroom",e.videoeffectsandavatar="videoeffectsandavatar",e.videoeffectscustomization="videoeffectscustomization",e.videoeffectsmoreview="videoeffectsmoreview",e.virtualconsumerevents="virtualconsumerevents",e.virtualevents="virtualevents",e.voiceenrollment="voiceenrollment",e.whatsnewdialog="whatsnewdialog",e.wiki="wiki",e.windowingerrordialog="windowingerrordialog",e.workflows="workflows",e.yammerqna="yammerqna",e.extensibilityapppickercallingpanel="extensibilityapppickercallingpanel"}(t||(t={})),function(e){e.subNavEntity="subNavEntity",e.headerEntity="headerEntity",e.startEntity="startEntity",e.mainEntity="mainEntity",e.endEntity="endEntity",e.monitorEntity="monitorEntity",e.inAppNotificationsEntity="inAppNotificationsEntity"}(o||(o={}))},248965:(e,n,i)=>{var a,t,o,l,d,s;i.d(n,{Mv:()=>a,Bd:()=>t,Ky:()=>o,sG:()=>l,Mb:()=>d,$E:()=>s}),function(e){e[e.general=0]="general",e[e.team=1]="team",e[e.personal=2]="personal",e[e.group=4]="group",e[e.meeting=8]="meeting"}(a||(a={})),function(e){e.installed="installed",e.notInstalled="notInstalled",e.preconsented="preconsented"}(t||(t={})),function(e){e[e.na=0]="na",e[e.bots=1]="bots",e[e.tabs=2]="tabs",e[e.messaging=3]="messaging",e[e.connectors=4]="connectors"}(o||(o={})),function(e){e[e.na=0]="na",e[e.card=1]="card",e[e.deepLink=2]="deepLink",e[e.messageExtension=3]="messageExtension",e[e.platformExtensionTab=4]="platformExtensionTab",e[e.contentBubble=5]="contentBubble",e[e.shareToOutlook=6]="shareToOutlook",e[e.adaptiveCardTab=7]="adaptiveCardTab",e[e.botConfig=8]="botConfig",e[e.storeapp=9]="storeapp"}(l||(l={})),function(e){e.bot="bot",e.inputextension="inputextension",e.connectors="connectors"}(d||(d={})),function(e){e.carousel="carousel",e.list="list"}(s||(s={}))},663945:(e,n,i)=>{function a(e={},n){return new Proxy(e,{get:(e,i)=>n?i in e?e[i]:n(String(i)):String(i)})}i.d(n,{wh:()=>t,Ai:()=>o,Th:()=>l,rA:()=>d,PO:()=>s,Tk:()=>r,Yu:()=>m,$K:()=>c,sz:()=>p,eD:()=>u,uS:()=>k,b6:()=>v});const t=a({}),o=a({}),l=a({}),d=a({}),s=a({}),r=a({}),m=a({}),c=a({}),p=a({}),u=a({}),k=a({}),v=a({})},632132:(e,n,i)=>{i.d(n,{Ur:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"setPlatformAppsFetchPolicy"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchPolicyInput"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setPlatformAppsFetchPolicy"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},795820:(e,n,i)=>{i.d(n,{Eb:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appDefinition"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"developerName"}},{kind:"Field",name:{kind:"Name",value:"developerUrl"}},{kind:"Field",name:{kind:"Name",value:"privacyUrl"}},{kind:"Field",name:{kind:"Name",value:"termsOfUseUrl"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"shortDescription"}},{kind:"Field",name:{kind:"Name",value:"longDescription"}},{kind:"Field",name:{kind:"Name",value:"smallImageUrl"}},{kind:"Field",name:{kind:"Name",value:"largeImageUrl"}},{kind:"Field",name:{kind:"Name",value:"accentColor"}},{kind:"Field",name:{kind:"Name",value:"categories"}},{kind:"Field",name:{kind:"Name",value:"validDomains"}},{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isFullScreenApp"}},{kind:"Field",name:{kind:"Name",value:"isFullTrustApp"}},{kind:"Field",name:{kind:"Name",value:"isMicrosoftOwned"}},{kind:"Field",name:{kind:"Name",value:"showTabLoadingIndicator"}},{kind:"Field",name:{kind:"Name",value:"bots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"botDefinition"}}]}},{kind:"Field",name:{kind:"Name",value:"customBots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"endpointUrl"}},{kind:"Field",name:{kind:"Name",value:"secret"}}]}},{kind:"Field",name:{kind:"Name",value:"connectors"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"configurationUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"galleryTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"configurationUrl"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"meetingSurfaces"}},{kind:"Field",name:{kind:"Name",value:"context"}}]}},{kind:"Field",name:{kind:"Name",value:"staticTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"contentBotId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"containerAppIds"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingExtensionDefinition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isAnonymousAccessAllowed"}},{kind:"Field",name:{kind:"Name",value:"supportsStreaming"}},{kind:"Field",name:{kind:"Name",value:"scenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"file"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"maxAudience"}},{kind:"Field",name:{kind:"Name",value:"seatsReservedForOrganizersOrPresenters"}}]}},{kind:"Field",name:{kind:"Name",value:"filters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}}]}},{kind:"Field",name:{kind:"Name",value:"videoAppContentUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orgWide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"fetchCommands"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"initialRun"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"parameters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"inputType"}},{kind:"Field",name:{kind:"Name",value:"value"}},{kind:"Field",name:{kind:"Name",value:"choices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"messageHandlers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"value"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"domains"}},{kind:"Field",name:{kind:"Name",value:"supportsAnonymousAccess"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authType"}},{kind:"Field",name:{kind:"Name",value:"microsoftEntraConfiguration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"supportsSingleSignOn"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"webApplicationInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"resource"}},{kind:"Field",name:{kind:"Name",value:"applicationPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"screenshotUrls"}},{kind:"Field",name:{kind:"Name",value:"officeAssetId"}},{kind:"Field",name:{kind:"Name",value:"videoUrl"}},{kind:"Field",name:{kind:"Name",value:"devicePermissions"}},{kind:"Field",name:{kind:"Name",value:"securityComplianceInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mcasId"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"csaId"}},{kind:"Field",name:{kind:"Name",value:"csaName"}}]}},{kind:"Field",name:{kind:"Name",value:"defaultInstallScope"}},{kind:"Field",name:{kind:"Name",value:"defaultGroupCapability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"team"}},{kind:"Field",name:{kind:"Name",value:"groupchat"}},{kind:"Field",name:{kind:"Name",value:"meetings"}}]}},{kind:"Field",name:{kind:"Name",value:"subscriptionOffer"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"offerId"}}]}},{kind:"Field",name:{kind:"Name",value:"manifestVersion"}}]}},...i(689845).g.definitions]}},103360:(e,n,i)=>{i.d(n,{o:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appsUsageFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppsUsage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIds"}},{kind:"Field",name:{kind:"Name",value:"appActions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"actionId"}}]}},{kind:"Field",name:{kind:"Name",value:"appScenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"sceneId"}}]}},{kind:"Field",name:{kind:"Name",value:"appsMru"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"lastUsedTimeStamp"}}]}}]}}]}},689845:(e,n,i)=>{i.d(n,{g:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"botDefinition"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BotDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"capabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isNotificationOnly"}},{kind:"Field",name:{kind:"Name",value:"supportsFiles"}},{kind:"Field",name:{kind:"Name",value:"supportsCalling"}},{kind:"Field",name:{kind:"Name",value:"supportsVideo"}}]}},{kind:"Field",name:{kind:"Name",value:"commandLists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"configuration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupChat"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"team"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}}]}}]}},902541:(e,n,i)=>{i.d(n,{W4:()=>d});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonInstallerIdentityFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InstallerIdentity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installerType"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"azureAdAppId"}}]}}]};var t=i(713303),o=i(795820);const l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appPermissions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppPermissions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orgWide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]},d={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"installedAppFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InstalledApp"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"installationState"}},{kind:"Field",name:{kind:"Name",value:"installedAppProps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUninstallable"}},{kind:"Field",name:{kind:"Name",value:"isAdminPreInstalled"}},{kind:"Field",name:{kind:"Name",value:"isNewGlobalPreInstalled"}},{kind:"Field",name:{kind:"Name",value:"isNewAdminPreInstalled"}}]}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}},{kind:"Field",name:{kind:"Name",value:"installerIdentity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonInstallerIdentityFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensionStates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageExtensionState"}}]}},{kind:"Field",name:{kind:"Name",value:"definition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}},{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appPermissions"}}]}}]}},...a.definitions,...t.l.definitions,...o.Eb.definitions,...l.definitions]}},713303:(e,n,i)=>{i.d(n,{l:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageExtensionState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MessageExtensionState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"pinOrder"}}]}}]}},554404:(e,n,i)=>{i.d(n,{E4:()=>t,$c:()=>o,C9:()=>l,vV:()=>d,xu:()=>s,mQ:()=>r,Np:()=>m});var a,t,o,l,d,s,r,m;!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(a||(a={})),function(e){e.web="web",e.desktop="desktop",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows"}(t||(t={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.meetingStage="meetingStage"}(o||(o={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(l||(l={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(d||(d={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(s||(s={})),function(e){e.activityFeed="activityFeed",e.card="card",e.connectorConfiguration="connectorConfiguration",e.deepLink="deepLink",e.deepLinkStageModal="deepLinkStageModal",e.contentBubble="contentBubble",e.messageExtension="messageExtension",e.tab="tab",e.shareToOutlook="shareToOutlook",e.adaptiveCardTab="adaptiveCardTab",e.adaptiveCardCollabStage="adaptiveCardCollabStage",e.adaptiveCardStageModal="adaptiveCardStageModal",e.platformAppView="platformAppView",e.chatTab="chatTab",e.channelTab="channelTab",e.sidePanel="sidePanel",e.privateMeetingSchedulingForm="privateMeetingSchedulingForm",e.channelMeetingSchedulingForm="channelMeetingSchedulingForm",e.personalApp="personalApp",e.botConfig="botConfig",e.storeApp="storeApp",e.sdk="sdk"}(r||(r={})),function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB",e.teamsMaglev="TEAMS-MAGLEV"}(m||(m={}))},122862:(e,n,i)=>{var a,t,o,l,d,s,r,m,c,p,u,k,v,g,f,N,b,h,S,y,F,T,A,I,C,E,D,w,P,x,M,O,U;i.d(n,{qi:()=>a,qb:()=>t,OM:()=>o,Pw:()=>l,aZ:()=>d,Aj:()=>s,jD:()=>r,BU:()=>m,YV:()=>c,y8:()=>p,Ye:()=>u,Uh:()=>k,i8:()=>v,b5:()=>g,Z9:()=>f,o1:()=>E,g7:()=>D,CL:()=>w,Hd:()=>P,_W:()=>x,Gr:()=>M,vb:()=>O,n$:()=>U}),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat"}(a||(a={})),function(e){e.Pin="Pin",e.Unpin="Unpin",e.Reorder="Reorder"}(t||(t={})),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat",e.Channel="Channel"}(o||(o={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Messaging="Messaging",e.Connector="Connector",e.StaticTab="StaticTab"}(l||(l={})),function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced",e.Mutated="Mutated"}(d||(d={})),function(e){e.Unknown="Unknown",e.SidePanel="SidePanel",e.Stage="Stage"}(s||(s={})),function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.CallingSidePanel="CallingSidePanel"}(r||(r={})),function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.TeamLevelApp="TeamLevelApp"}(m||(m={})),function(e){e.Application="Application",e.Delegated="Delegated"}(c||(c={})),function(e){e.BotBased="botBased",e.ApiBased="apiBased"}(p||(p={})),function(e){e.MRU="MRU",e.AlphabeticalAsc="AlphabeticalAsc",e.AlphabeticalDesc="AlphabeticalDesc"}(u||(u={})),function(e){e.NewUpload="NewUpload",e.Update="Update",e.Upgrade="Upgrade"}(k||(k={})),function(e){e.NewUpload="NewUpload",e.Update="Update"}(v||(v={})),function(e){e.User="User",e.AzureAdApp="AzureAdApp"}(g||(g={})),function(e){e.Unknown="Unknown",e.PrivateChannel="PrivateChannel"}(f||(f={})),function(e){e.Mail="mail"}(N||(N={})),function(e){e.Desktop="desktop",e.Mobile="mobile"}(b||(b={})),function(e){e.General="general"}(h||(h={})),function(e){e.Short="short",e.Long="long"}(S||(S={})),function(e){e.MailRead="mailRead",e.MailCompose="mailCompose",e.MeetingDetailsOrganizer="meetingDetailsOrganizer",e.MeetingDetailsAttendee="meetingDetailsAttendee"}(y||(y={})),function(e){e.After="after",e.Before="before"}(F||(F={})),function(e){e.Button="button",e.Menu="menu"}(T||(T={})),function(e){e.PromptUser="promptUser",e.SoftBlock="softBlock",e.Block="block"}(A||(A={})),function(e){e.Outlook="Outlook",e.Office="Office",e.Teams="Teams"}(I||(I={})),function(e){e.None="none",e.ApiSecretServiceAuth="apiSecretServiceAuth",e.MicrosoftEntra="microsoftEntra"}(C||(C={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meetings="Meetings"}(E||(E={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Connector="Connector"}(D||(D={})),function(e){e.Installed="Installed",e.InstalledAndFavorited="InstalledAndFavorited",e.InstalledAndHidden="InstalledAndHidden",e.InstalledAndPermanent="InstalledAndPermanent",e.InstalledAndDeprecated="InstalledAndDeprecated",e.Featured="Featured",e.NotInstalled="NotInstalled",e.PreConsented="PreConsented",e.AdminPreInstalled="AdminPreInstalled"}(w||(w={})),function(e){e.Unknown="Unknown",e.OfficeAddIn="OfficeAddIn",e.OfficeAddIns="OfficeAddIns",e.ExchangeAddIn="ExchangeAddIn",e.ExchangeAddIns="ExchangeAddIns",e.LineOfBusiness="LineOfBusiness",e.Bot="Bot",e.Bots="Bots",e.MessageExtension="MessageExtension",e.ComposeExtensions="ComposeExtensions",e.Extension="Extension",e.Extensions="Extensions",e.FirstPartyPages="FirstPartyPages",e.Dynamics="Dynamics",e.AAD="AAD",e.LaunchPage="LaunchPage",e.StaticTabs="StaticTabs",e.GraphConnector="GraphConnector",e.ConfigurableTabs="ConfigurableTabs",e.Connector="Connector",e.Connectors="Connectors",e.Activity="Activity",e.Activities="Activities",e.MeetingExtension="MeetingExtension",e.MeetingExtensionDefinition="MeetingExtensionDefinition"}(P||(P={})),function(e){e.MessageReadCommandSurface="MessageReadCommandSurface",e.MessageComposeCommandSurface="MessageComposeCommandSurface",e.AppointmentOrganizerCommandSurface="AppointmentOrganizerCommandSurface",e.AppointmentAttendeeCommandSurface="AppointmentAttendeeCommandSurface"}(x||(x={})),function(e){e.chats="chats",e.channels="channels",e.channelMeetings="meetings"}(M||(M={})),function(e){e.GlobalPrepinned="GlobalPrepinned",e.UserPinned="UserPinned",e.AdminPrepinned="AdminPrepinned"}(O||(O={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(U||(U={}))},466149:(e,n,i)=>{var a,t,o,l,d;i.d(n,{Eh:()=>a,kI:()=>t,RM:()=>o,Tk:()=>l,Qq:()=>d}),function(e){e.Attendee="attendee",e.Presenter="presenter",e.Organizer="organizer"}(a||(a={})),function(e){e.Interactive="interactive",e.NonInteractive="nonInteractive"}(t||(t={})),function(e){e.DeeplinkNonoffice="DeeplinkNonoffice",e.DeeplinkOffice="DeeplinkOffice",e.DeeplinkFileChiclet="DeeplinkFileChiclet",e.MeetingSidepanel="MeetingSidepanel",e.DocCollab="DocCollab",e.Annotation="Annotation"}(o||(o={})),function(e){e[e.Reconnecting=1e3]="Reconnecting",e[e.Transferring=1001]="Transferring",e[e.TransferFailed=1002]="TransferFailed",e[e.TransferSucceeded=1003]="TransferSucceeded",e[e.Escalating=1004]="Escalating",e[e.EscalationFailed=1005]="EscalationFailed",e[e.EscalationSucceeded=1006]="EscalationSucceeded",e[e.Parking=1007]="Parking",e[e.ParkSucceeded=1008]="ParkSucceeded",e[e.ParkFailed=1009]="ParkFailed",e[e.MusicOnHold=1010]="MusicOnHold",e[e.Aborted=1011]="Aborted"}(l||(l={})),function(e){e[e.CallSetupFailed=0]="CallSetupFailed",e[e.CallDropped=1]="CallDropped",e[e.Undefined=2]="Undefined"}(d||(d={}))},281216:(e,n,i)=>{i.d(n,{h:()=>t});var a=i(275742);class t{constructor(){this._card={type:"AdaptiveCard",version:"1.0",body:[{type:"Container",items:[]}],actions:[]}}addLabel(e){return this.addElement({type:"TextBlock",text:e,weight:"bolder"}),this}addTextBlock(e){return this.addElement({type:"TextBlock",text:e}),this}addTextInput(e,n,i,a,t){return this.addElement({type:"Input.Text",id:e,placeholder:n,value:i,maxLength:a,isMultiline:t}),this}addNumberInput(e,n,i){return this.addElement({type:"Input.Number",id:e,placeholder:n,value:i}),this}addDateInput(e,n,i){return this.addElement({type:"Input.Date",id:e,placeholder:n,value:i}),this}addTimeInput(e,n,i){return this.addElement({type:"Input.Time",id:e,placeholder:n,value:i}),this}addToggle(e,n,i){return this.addElement({type:"Input.Toggle",id:e,title:n,value:i}),this}addChoiceSet(e,n,i,a,t,o){return this.addElement({type:"Input.ChoiceSet",id:e,title:n,isMultiSelect:i,style:a?"compact":"expanded",choices:t,value:o}),this}addImageSet(e,n){return this.addElement({type:"ImageSet",id:e,images:n}),this}addSubmitAction(e,n,i){return this._card.actions&&this._card.actions.push({id:e,type:"Action.Submit",title:n,data:i}),this}addSpeak(e){return this._card.speak=e,this}getCard(){return{content:JSON.stringify(this._card),contentType:"application/vnd.microsoft.card.adaptive"}}getRawJson(){return(0,a.cloneDeep)(this._card)}addElement(e){this._card.body&&this._card.body[0].items.push(e)}}},949556:(e,n,i)=>{i.d(n,{G:()=>o});var a=i(228846),t=i(545618);const o=e=>e instanceof a.xQ?e.asObservable():e instanceof t.y?e:new t.y((n=>{const i=e.subscribe(n);return()=>i.unsubscribe()}))}}]);