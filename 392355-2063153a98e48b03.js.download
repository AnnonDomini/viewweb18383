(this.webpackChunk_msteams_convene=this.webpackChunk_msteams_convene||[]).push([[392355],{613829:(e,t,n)=>{"use strict";n.d(t,{W_:()=>Rt});var i=n(265858),a=n(27220),r=n(95249),o=n(597126),l=n(401717),s=n(516909),d=n(913094),c=n(802470),u=n(807202),p=n(180410),m=n(650627),g=n(77570),M=n(806784);const N=({children:e})=>i.createElement(i.Fragment,null,i.Children.map(e,(e=>i.cloneElement(e,{styles:{clipPath:"polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)"}}))));var T=n(251609),v=n(234025),I=n(382298),y=n(360628),A=n(898071),D=n(814423),C=n(50805);const b={isActionButton:!0},h=({isBotSupportCalling:e,startChat:t,startAudioCall:n,startVideoCall:a,isVideoAvailableForConversation:r,videoNotAvailableForConversationReason:o,isAudioAvailableForConversation:l,audioNotAvailableForConversationReason:s})=>{const d=(0,A.Cq)(),c=i.useMemo((()=>f(d,o,r,!0)),[d,o,r]),u=i.useMemo((()=>f(d,s,l)),[d,s,l]),{enableBotsCallingSupport:p}=(0,D.NC)(C.J.Extensibility),g=d.stringTranslate("extensibility","app_profile_card_toggleChat_on");return i.createElement(T.k,{hAlign:"start",fill:!0,gap:"gap.small"},i.createElement(m.z,{iconOnly:!0,text:!0,icon:i.createElement(v.k,{outline:!0,size:"medium"}),onClick:t,title:g,disabled:!1,variables:b}),p&&e?i.createElement(i.Fragment,null,i.createElement(m.z,{iconOnly:!0,text:!0,icon:i.createElement(I.N,{outline:!0,size:"medium"}),onClick:a,title:c,disabled:!r,variables:b}),i.createElement(m.z,{iconOnly:!0,text:!0,icon:i.createElement(y.o,{outline:!0,size:"medium"}),onClick:n,title:u,disabled:!l,variables:b})):null)},f=(e,t,n,i)=>!n&&t?e.stringTranslate("calling",t):e.stringTranslate("messaging",i?"calling_video":"calling_call");var k=n(236511);const S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"videoAvailableForConversationChanged"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"videoAvailableForConversationChangedEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"isAvailable"}},{kind:"Field",name:{kind:"Name",value:"notAvailableReason"}}]}}]}}]};var U=n(770145),E=n(427662),j=n(554694),L=n(663945),O=n(560197),F=n(738646),x=n(568094),w=n(248965);const z=(e,t,n,i,a,r,o)=>({actionGesture:e,actionOutcome:t,actionScenario:n,actionScenarioType:L.Yu.appMgmt,moduleName:i,panelRegion:L.Ai.popover,panelType:L.wh.AppProfileCardPopover,appName:a,extensibilityData:{id:r,capabilityId:o,scenarioCapability:w.Ky.bots}}),V=i.memo((({client:e,appProfile:t,botCallingCapabilities:n})=>{const{entityCommanding:a,scenarioFactory:r}=(0,E.SE)(),o=(0,j.w)(V.name),{startChat:l,startCall:s}=(0,U.G4)(a,e,o),d=(0,x.bp)(),{convId:c}=d.chatServiceSubscriptionFilter,{isBotAudioSupported:u,isBotVideoSupported:p,botAudioNotAvailableForConversationReason:m,botVideoNotAvailableForConversationReason:g}=Object.assign({},W(n)),{recordPanelAction:M}=(0,O.It)(),N=u||p,T=t.botIdOrAppId,v=i.useCallback((()=>{const e=r.newScenario(F.RG.AppProfileCardStartChat);M(z(L.uS.click,L.$K.select,L.Tk.appProfileCardChat,L.rA.appProfileCardStartChat,t.appName)),l(T,e)}),[T,t.appName,M,l,r]),I=i.useCallback((()=>{const e=r.newScenario(F.RG.AppProfileCardStartAudioCall);R(t,!1,M),s(T,!1,e)}),[T,t,s,r,M]),y=i.useCallback((()=>{const e=r.newScenario(F.RG.AppProfileCardStartVideoCall);R(t,!0,M),s(T,!0,e)}),[T,t,s,r,M]),{videoNotAvailableForConversationReason:A,isVideoAvailableForConversation:D}=P(e,c,p,g,o);return i.createElement(h,{startChat:v,startVideoCall:y,startAudioCall:I,isBotSupportCalling:!!N,videoNotAvailableForConversationReason:A,isVideoAvailableForConversation:D&&!!p,audioNotAvailableForConversationReason:null!=m?m:null,isAudioAvailableForConversation:!!u})}));V.displayName="ActionButtonsContainerInner";const Q=(0,k.C)(V),R=(e,t,n)=>{n(z(L.uS.click,L.$K.nav,L.Tk.appProfileCardCall,t?L.rA.appProfileCardVideoCall:L.rA.appProfileCardAudioCall,e.appName))},P=(e,t,n,a="bot_calling_video_not_supported",r)=>{const[o,l]=i.useState(null);i.useEffect((()=>{if(!n)return;const i=e.subscribe({query:S,variables:{conversationId:t}}).subscribe((({data:e,errors:t})=>{t&&r.error("Error on callQuery for video conversation subscription"),l(e)}));return()=>{i.unsubscribe()}}),[e,r,t,n]);const s=null==o?void 0:o.videoAvailableForConversationChangedEvent;let d=!1,c="calling_video_disabled";return s&&(d=s.isAvailable,c=d?n?null:a:B(s.notAvailableReason,r)),{isVideoAvailableForConversation:d,videoNotAvailableForConversationReason:c}},B=(e,t)=>{switch(e){case"calling_video_disabled":case"calling_video_disabled_by_admin":case"calling_video_disabled_no_device":case"calling_video_disabled_vdi":case"bot_calling_video_not_supported":case"bot_calling_audio_not_supported":return e;default:return t.warn(`_queryVideoAvailableForConversation: wrong videoDisabledReason received: ${e}`),"calling_video_disabled"}},W=e=>{if(!e)return;const t=!!(null==e?void 0:e.supportsVideo),n=!!(null==e?void 0:e.supportsCalling);let i="bot_calling_audio_not_supported",a="bot_calling_video_not_supported";return i=n?null:i,a=t?null:a,{isBotVideoSupported:t,isBotAudioSupported:n,botAudioNotAvailableForConversationReason:i,botVideoNotAvailableForConversationReason:a}};var Z=n(821826),Y=n(71233),G=n(657657);const J=({sendMessage:e,appName:t})=>{const n=(0,A.Cq)(),{vars:r}=(0,a.L)(),[o,l]=i.useState(""),s=""===o,c=i.useCallback((e=>{const t=e.target.value;l(t)}),[l]),u=i.useCallback((()=>{e(o),l("")}),[o,e,l]),p=n.stringTranslate("extensibility","app_profile_card_icons_send"),g=n.stringTranslate("extensibility","app_profile_card_quickMessage",{appName:t}),M=r("extensibility",["isAppProfileCardTextInput"]);return i.createElement(T.k,{column:!0,gap:"gap.small"},i.createElement(Z.l,{onSubmit:u},i.createElement(d.k,{variables:M,gap:"gap.smaller"},i.createElement(Y.II,{placeholder:g,onChange:c,value:o,fluid:!0}),i.createElement(m.z,{iconOnly:!0,icon:i.createElement(G.j,null),text:!0,disabled:s,title:p}))))};var H=n(711676),X=n(760005);const _=({client:e,appProfile:t})=>{const{entityCommanding:n,scenarioFactory:a}=(0,E.SE)(),r=(0,j.w)(_.name),{sendMessage:o}=(0,U.G4)(n,e,r),{recordPanelAction:l}=(0,O.It)(),{appName:s,botIdOrAppId:d,appId:c}=t,u=(0,H.bl)(d)?d.substring(X.at.BotPrefix.length):void 0,p=i.useCallback((e=>{const t=a.newScenario(F.RG.AppProfileCardSendQuickMessage);l(z(L.uS.click,L.$K.submit,L.Tk.quickIM,L.rA.appProfileCardQuickIM,s,c,u)),o(d,e,t)}),[d,s,c,u,l,o,a]);return i.createElement(J,{sendMessage:p,appName:s})},K=(0,k.C)(_);var q=n(361885),$=n(321561),ee=n(166146),te=n(155537),ne=n(660985);const ie=({title:e})=>i.createElement(te.q,{state:"success",title:e,variables:{appProfileCardPresenceImage:ne.F.Online}});var ae=n(362136),re=n(642799),oe=n(956255),le=n(606395);const se=(0,le.s)({isBotSettingsButton:{a9b677:"f14z66ap",Bqenvij:"f11ysow2",Bf4jedk:"fy77jfu",qb2dma:"f1locze1"}},{d:[".f14z66ap{width:auto;}",".f11ysow2{height:auto;}",".fy77jfu{min-width:0;}",".f1locze1{align-self:end;}"]});var de=n(365076),ce=n(712006),ue=n(519036);const pe=({botName:e,iconUrl:t,description:n,developerName:a,privacyUrl:r,termsOfUseUrl:o,botIdOrAppId:l,isShortProfileCard:d,sceneCount:c,showActionButtons:u,isSceneApp:p,sceneName:m,showRectAppImage:g,botCallingCapabilities:M,appId:N,supportsMeetingStreaming:T,botConfiguration:v,appDef:I})=>{var y;const A=i.useMemo((()=>({botIdOrAppId:l,appName:e,appId:N})),[N,l,e]),{host:b}=(0,E.SE)(),h=(0,ae.WG)(),{entity:f}=(0,re.sV)(),k=f.type===oe.py.channels?s.qi6.Team:s.qi6.GroupChat,S=(0,ae.LZ)(I,k),U=f.type===oe.py.channels?(e=>e.id&&(e=>{try{JSON.parse(e)}catch(e){return!1}return!0})(e.id)?JSON.parse(e.id).channelId:e.id)(f):f.id,j=i.useCallback((()=>{h(U,k,I,ae.ku.ReConfig)}),[I,U,h,k]),{enableFetchAPIForNonAdaptiveCardImages:L}=(0,D.NC)(C.J.Extensibility),O=(0,de.x)(),[{result:F}]=(0,ce.b)(O,(0,ue.HM)(t,b.location.origin)?t:"",!0,s.R0O.Url);let x="";return x=L&&(0,ue.HM)(t,b.location.origin)?null!==(y=null==F?void 0:F.blob)&&void 0!==y?y:"":null!=t?t:"",p?i.createElement(ge,{botName:e,description:n,iconUrl:x,sceneCount:c,sceneName:m,showRectAppImage:g,privacyUrl:r,termsOfUseUrl:o}):i.createElement(me,{appProfile:A,botName:e,description:n,iconUrl:x,isShortProfileCard:d,developerName:a,showRectAppImage:g,botCallingCapabilities:M,supportsMeetingStreaming:T,privacyUrl:r,termsOfUseUrl:o,showActionButtons:u,botConfiguration:S?v:null,launchBotConfig:j})},me=({appProfile:e,botName:t,iconUrl:n,description:a,developerName:r,privacyUrl:o,termsOfUseUrl:l,isShortProfileCard:s,showActionButtons:c,showRectAppImage:u,botCallingCapabilities:m,supportsMeetingStreaming:g,botConfiguration:M,launchBotConfig:N})=>{const{isAppProfileCard:T}=ke(),{enableBotConfiguration:v}=(0,D.NC)(C.J.Extensibility),I=se();return i.createElement(p.x,{variables:T},i.createElement(d.k,{fill:!0,vAlign:"start"},i.createElement(Ne,{botName:t,description:a,iconUrl:n,isShortProfileCard:s,developerName:r,showRectAppImage:u})),i.createElement(d.k,{column:!0},v&&M?i.createElement($.z,{appearance:"transparent",className:I.isBotSettingsButton,onClick:N,icon:i.createElement(ee.e,{outline:!0,size:"medium"})}):i.createElement(i.Fragment,null),i.createElement(fe,{isShortProfileCard:s,supportsMeetingStreaming:g}),s?null:i.createElement(he,{privacyUrl:o,termsOfUseUrl:l}),c?i.createElement(Ie,{appProfile:e,botCallingCapabilities:m}):null))},ge=({botName:e,description:t,iconUrl:n,sceneCount:a,sceneName:r,showRectAppImage:o,privacyUrl:l,termsOfUseUrl:s})=>{const{isAppProfileCard:c}=ke();return i.createElement(p.x,{variables:c},i.createElement(d.k,{fill:!0,vAlign:"start"},i.createElement(Me,{botName:e,description:t,iconUrl:n,sceneCount:a,sceneName:r,showRectAppImage:o})),i.createElement(d.k,{column:!0},i.createElement(he,{privacyUrl:l,termsOfUseUrl:s})))},Me=({botName:e,description:t,iconUrl:n,sceneCount:a,sceneName:r,showRectAppImage:l})=>{const{sceneAppProfileCard:s}=ke();return i.createElement(i.Fragment,null,i.createElement(d.k,{fill:!0,column:!0},i.createElement(ye,{botName:r}),i.createElement(o.x,{content:e,size:"small"}),i.createElement(d.k,{gap:"gap.small",vAlign:"center",variables:s},i.createElement(q.e,{size:"smaller",outline:!0}),i.createElement(De,{sceneCount:a})),i.createElement(Ce,{description:t})),i.createElement(Te,{iconUrl:n,showRectAppImage:l}))},Ne=({botName:e,description:t,developerName:n,iconUrl:a,isShortProfileCard:r,showRectAppImage:l})=>{const{isAppProfileCardDetail:s,isAppProfileCardPresence:c}=ke(),{presence:u}=Se();return i.createElement(i.Fragment,null,i.createElement(d.k,{fill:!0,column:!0,variables:s},i.createElement(ye,{botName:e}),i.createElement(d.k,{column:!0,gap:"gap.small"},i.createElement(o.x,{variables:c,content:u}),i.createElement(be,{description:t}),r?i.createElement(ye,{botName:e,isShortProfileCard:r}):i.createElement(Ae,{developerName:n}))),i.createElement(Te,{iconUrl:a,showRectAppImage:l}))},Te=({iconUrl:e,showRectAppImage:t})=>{const{appProfileImageBorderRadius:n}=ke();return t?i.createElement(ve,{iconUrl:e,width:60,height:60,variables:n}):i.createElement(ve,{showStatus:!0,iconUrl:e,width:68,height:60,isHexagon:!0})},ve=({iconUrl:e,showStatus:t,width:n,height:a,isHexagon:r,variables:o})=>{const{isAppProfileCardImageContainer:l}=ke(),{presence:s}=Se(),d=i.createElement(u.J,{src:e,width:n,height:a,variables:o});return i.createElement(p.x,{variables:l},r?i.createElement(N,null,d):d,t&&i.createElement(ie,{title:s}))},Ie=({appProfile:e,botCallingCapabilities:t})=>{const{isAppProfileCardActionButton:n,messageAppDivider:a}=ke();return i.createElement(d.k,{column:!0},i.createElement(d.k,{fill:!0,variables:n},i.createElement(Q,{appProfile:e,botCallingCapabilities:t})),i.createElement(c.i,{variables:a}),i.createElement(d.k.Item,{align:"start"},i.createElement(K,{appProfile:e})))},ye=({botName:e,isShortProfileCard:t})=>{const{isAppProfileCardTitle:n,isAppProfileShortCardDescription:a}=ke();return i.createElement(o.x,{variables:t?a:n,content:e})},Ae=({developerName:e})=>{const t=(0,A.Cq)().translate("extensibility","app_profile_card_developer",{developerName:e}),{isAppProfileCardDeveloper:n}=ke();return i.createElement(o.x,{variables:n,content:t})},De=({sceneCount:e})=>{const t=(0,A.Cq)().stringTranslate("extensibility","app_profile_card_scene_count_mf",{sceneCount:e});return i.createElement(o.x,{content:t,size:"small"})},Ce=({description:e})=>{const{isSceneProfileCardDesc:t}=ke();return i.createElement(o.x,{variables:Object.assign({isContentClamped:!0,numOfLines:6},t),content:e})},be=({description:e})=>{const{isAppProfileCardDescription:t}=ke();return i.createElement(o.x,{variables:Object.assign({isContentClamped:!0,numOfLines:6},t),content:e})},he=({privacyUrl:e,termsOfUseUrl:t})=>{const{isAppProfileCardLink:n}=ke(),{termsOfUse:a,privacy:r}=Se();return i.createElement(d.k.Item,{grow:!0},i.createElement(d.k,{vAlign:"end"},i.createElement(o.x,{link:!0,target:"_blank",href:e,variables:n,content:r}),i.createElement(d.k.Item,{push:!0},i.createElement(o.x,{link:!0,target:"_blank",href:t,variables:n,content:a}))))},fe=({isShortProfileCard:e,supportsMeetingStreaming:t})=>{const n=(0,A.Cq)(),a=e?["app_profile_card_imsend","app_profile_card_imreceive"]:["extension_addAppDialogBasicPermission1","extension_addAppDialogBasicPermission2","extension_addAppDialogIdentityPermission1","extension_addAppDialogTeamPermission1","extension_addAppDialogTeamPermission2","extension_addAppDialogIdentityPermission2"];t&&!e&&a.push("extension_addAppDialog_Permission_Meeting_Streaming_Access");const r=[],{listStyleBullet:l}=ke();for(let t=0;t<=a.length-1;t++)r.push(i.createElement(d.k,{gap:"gap.smaller",key:t},e?null:i.createElement(o.x,{variables:l},"•"),i.createElement(o.x,{content:n.translate("extensibility",a[t])})));const{isAppProfileCardBasicPermission:s,isAppProfileCardPermission:c}=ke(),{whatAppCanDo:u}=Se();return i.createElement(p.x,{variables:s},i.createElement(o.x,{content:u,variables:e?c:null}),i.createElement(d.k,{column:!0,variables:c},r))},ke=()=>{const{vars:e}=(0,a.L)();return{isAppProfileCardBasicPermission:e("extensibility",["isAppProfileCardBasicPermission"]),isAppProfileCardPermission:e("extensibility",["isAppProfileCardPermission"]),isAppProfileCardLink:e("extensibility",["isAppProfileCardLink"]),isAppProfileCardDeveloper:e("extensibility",["isAppProfileCardDeveloper"]),listStyleBullet:e("extensibility",["listStyleBullet"]),isAppProfileCardPresence:e("extensibility",["isAppProfileCardPresence"]),isAppProfileCardTitle:e("extensibility",["isAppProfileCardTitle"]),isAppProfileCardDescription:e("extensibility",["isAppProfileCardDescription"]),isAppProfileCardImageContainer:e("extensibility",["isAppProfileCardImageContainer"]),isAppProfileCard:e("extensibility",["isAppProfileCard"]),isAppProfileCardDetail:e("extensibility",["isAppProfileCardDetail"]),isAppProfileCardActionButton:e("extensibility",["isAppProfileCardActionButton"]),appProfileImageBorderRadius:e("extensibility",["appProfileImageBorderRadius"]),messageAppDivider:e("extensibility",["messageAppDivider"]),isAppProfileShortCardDescription:e("extensibility",["isAppProfileShortCardDescription"]),sceneAppProfileCard:e("extensibility",["sceneAppProfileCard"]),isSceneProfileCardDesc:e("extensibility",["isSceneProfileCardDesc"])}},Se=()=>{const e=(0,A.Cq)();return{whatAppCanDo:e.translate("extensibility","app_profile_card_basicPermission_what_app_can_do"),privacy:e.translate("extensibility","app_profile_card_privacy"),termsOfUse:e.translate("extensibility","app_profile_card_terms_of_use"),presence:e.stringTranslate("extensibility","app_profile_card_presence")}};var Ue=n(637088),Ee=n(854787),je=n(457695);const Le=(e,t)=>{var n;return!!(null===(n=t[e])||void 0===n?void 0:n.length)},Oe=({appDef:e})=>{const t=Le("galleryTabs",e)||(0,l.LS)(s.qi6.Team,e.staticTabs),n=Le("bots",e),a=Le("messageExtensions",e),r=Le("connectors",e),o=(0,l.LS)(s.qi6.Personal,e.staticTabs);return i.createElement(je.W,null,t&&i.createElement(Fe,{titleKey:"app_details_capability_tab",descriptionKey:"app_details_capability_tab_description"}),n&&i.createElement(Fe,{titleKey:"app_details_capability_bot",descriptionKey:"app_details_capability_bot_description"}),a&&i.createElement(Fe,{titleKey:"app_details_capability_message_extension",descriptionKey:"app_details_capability_message_extension_description"}),r&&i.createElement(Fe,{titleKey:"extension_addAppDialogV3_capability_connector_title",descriptionKey:"app_details_capability_connector_description"}),o&&i.createElement(Fe,{titleKey:"app_details_capability_personal_app",descriptionKey:"app_details_capability_personal_app_description"}))},Fe=({titleKey:e,descriptionKey:t})=>{const n=(0,A.Cq)(),r=i.useMemo((()=>n.translate("extensibility",e)),[n,e]),o=i.useMemo((()=>n.translate("extensibility",t)),[n,t]),{vars:l}=(0,a.L)();return i.createElement(je.W,null,i.createElement(Ee.h,{as:"h4",content:r,variables:l("extensibility",["isActionableAppProfileCardAppFeatureHeader"])}),o)};var xe=n(767588);const we=(0,le.s)({isBotSettingsButton:{a9b677:"f14z66ap",Bqenvij:"f11ysow2",Bf4jedk:"fy77jfu",qb2dma:"f1locze1"}},{d:[".f14z66ap{width:auto;}",".f11ysow2{height:auto;}",".fy77jfu{min-width:0;}",".f1locze1{align-self:end;}"]});var ze;!function(e){e[e.Default=0]="Default",e[e.InfoBanner=1]="InfoBanner"}(ze||(ze={}));const Ve=({appDef:e,botName:t,iconUrl:n,description:a,privacyUrl:r,termsOfUseUrl:o,botIdOrAppId:l,sceneCount:d,showActionButtons:c,isSceneApp:u,sceneName:p,showRectAppImage:m,botCallingCapabilities:g,appId:M,supportsMeetingStreaming:N,isInstalled:T,hasPersonalScope:v,botConfiguration:I})=>{var y;const A=i.useMemo((()=>({botIdOrAppId:l,appName:t,appId:M})),[M,l,t]),{host:b}=(0,E.SE)(),h=(0,ae.WG)(),{entity:f}=(0,re.sV)(),k=f.type===oe.py.channels?s.qi6.Team:s.qi6.GroupChat,S=f.type===oe.py.channels?(e=>e.id&&(e=>{try{JSON.parse(e)}catch(e){return!1}return!0})(e.id)?JSON.parse(e.id).channelId:e.id)(f):f.id,U=(0,ae.LZ)(e,k),j=i.useCallback((()=>{h(S,k,e,ae.ku.ReConfig)}),[e,S,h,k]),{enableFetchAPIForNonAdaptiveCardImages:L}=(0,D.NC)(C.J.Extensibility),O=(0,de.x)(),[{result:F}]=(0,ce.b)(O,(0,ue.HM)(n,b.location.origin)?n:"",!0,s.R0O.Url);let x="";return x=L&&(0,ue.HM)(n,b.location.origin)?null!==(y=null==F?void 0:F.blob)&&void 0!==y?y:"":null!=n?n:"",u?i.createElement(ge,{botName:t,description:a,iconUrl:x,sceneCount:d,sceneName:p,showRectAppImage:m,privacyUrl:r,termsOfUseUrl:o}):M?i.createElement(Qe,{appDef:e,appProfile:A,description:a,iconUrl:x,showRectAppImage:m,botCallingCapabilities:g,supportsMeetingStreaming:N,privacyUrl:r,termsOfUseUrl:o,showActionButtons:c,isInstalled:T,hasPersonalScope:v,botConfiguration:U?I:null,launchBotConfig:j}):i.createElement(Re,{appName:t,iconUrl:x,showRectAppImage:m})},Qe=({appDef:e,appProfile:t,iconUrl:n,description:a,privacyUrl:r,termsOfUseUrl:o,showActionButtons:l,showRectAppImage:s,botCallingCapabilities:u,supportsMeetingStreaming:p,isInstalled:m,hasPersonalScope:g,botConfiguration:M,launchBotConfig:N})=>{const{isActionableAppProfileCard:T,isActionableAppProfileCardDivider:v}=tt(),{enableBotConfiguration:I}=(0,D.NC)(C.J.Extensibility),y=we(),A=i.useRef(null),b=i.useRef(null),{recordPanelAction:h}=(0,O.It)(),f=i.useCallback((()=>{if(b.current&&A.current){const{appId:e,appName:n}=t;b.current.scrollTo({top:A.current.offsetTop-b.current.offsetTop,behavior:"smooth"}),h({actionGesture:L.uS.click,actionOutcome:L.$K.scroll,moduleName:L.rA.appProfileCard,panelRegion:L.Ai.popover,panelType:L.wh.AppProfileCardPopover,extensibilityData:{id:e,name:n}})}}),[t,A,b,h]);return i.createElement(d.k,{column:!0,variables:T},i.createElement(Pe,{appProfile:t,botCallingCapabilities:u,description:a,iconUrl:n,showActionButtons:l,showRectAppImage:s,isInstalled:m,hasPersonalScope:g}),I&&M?i.createElement($.z,{"data-tid":"bot-settings-button",appearance:"transparent",className:y.isBotSettingsButton,onClick:N,icon:i.createElement(ee.e,{outline:!0,size:"medium"})}):i.createElement(i.Fragment,null),i.createElement(c.i,{variables:v}),i.createElement(Be,{appDef:e,appProfile:t,bodyRef:b,permissionsRef:A,supportsMeetingStreaming:!!p}),i.createElement(c.i,{variables:v}),i.createElement(We,{appProfile:t,showActionButtons:l,onPermissionsClick:f,privacyUrl:r,termsOfUseUrl:o}))},Re=({appName:e,iconUrl:t,showRectAppImage:n})=>{const{isActionableAppProfileCardHeader:a,isActionableAppProfileCardDivider:r,isActionableAppProfileCardShort:o,isActionableAppProfileCardHeaderDescription:l}=tt();return i.createElement(d.k,{column:!0,variables:o},i.createElement(d.k,{variables:a},i.createElement(Ze,{iconUrl:t,showRectAppImage:n}),i.createElement(d.k,{column:!0,variables:l},i.createElement(Je,{name:e}))),i.createElement(c.i,{variables:r}),i.createElement(qe,{isShortCard:!0}))},Pe=({appProfile:e,botCallingCapabilities:t,description:n,iconUrl:a,showActionButtons:r,showRectAppImage:o,isInstalled:l,hasPersonalScope:s})=>{const{actionableAppProfileCardType:c}=(0,D.NC)(C.J.Extensibility),u=c===ze.InfoBanner,{isActionableAppProfileCardHeader:p,isActionableAppProfileCardHeaderDescription:m,isActionableAppProfileCardHeaderButtons:g,isActionableAppProfileCardActionButtonsWrapper:M}=tt();return i.createElement(d.k,{column:!0,variables:p},i.createElement(d.k,null,i.createElement(Ze,{iconUrl:a,showRectAppImage:o}),i.createElement(d.k,{column:!0,variables:m},i.createElement(Je,{name:e.appName}),i.createElement(He,{description:n}))),i.createElement(d.k,{fill:!0,variables:g},s?i.createElement(d.k.Item,null,i.createElement(Ge,{appId:e.appId,appName:e.appName,isInstalled:l,isInfoBannerType:u})):null,r?i.createElement(d.k,{variables:M},i.createElement(Q,{appProfile:e,botCallingCapabilities:t})):null),u&&!l?i.createElement(Xe,null):null)},Be=({appDef:e,appProfile:{appId:t,appName:n},bodyRef:a,permissionsRef:r,supportsMeetingStreaming:o})=>{const{isActionableAppProfileCardBody:l,isActionableAppProfileCardDivider:s}=tt(),{recordPanelAction:u}=(0,O.It)(),p=(0,xe.K)((()=>u({actionGesture:L.uS.scroll,actionOutcome:L.$K.read,moduleName:L.rA.appProfileCard,panelRegion:L.Ai.popover,panelType:L.wh.AppProfileCardPopover,extensibilityData:{id:t,name:n}})),1e3);return i.createElement(d.k,{column:!0,ref:a,variables:l,onScroll:p},i.createElement($e,{appDef:e}),i.createElement(c.i,{variables:s}),i.createElement(qe,{permissionsRef:r,supportsMeetingStreaming:o}))},We=({appProfile:e,onPermissionsClick:t,privacyUrl:n,showActionButtons:a,termsOfUseUrl:r})=>{const{isActionableAppProfileCardFooter:o}=tt();return i.createElement(d.k,{column:!0,variables:o},a?i.createElement(K,{appProfile:e}):null,i.createElement(Ke,{appName:e.appName,onPermissionsClick:t,privacyUrl:n,termsOfUseUrl:r}))},Ze=({iconUrl:e,showRectAppImage:t})=>{const{appProfileImageBorderRadius:n}=tt();return t?i.createElement(Ye,{iconUrl:e,width:80,height:72,variables:n}):i.createElement(Ye,{iconUrl:e,width:80,height:72,isHexagon:!0})},Ye=({iconUrl:e,width:t,height:n,isHexagon:a,variables:r})=>{const{isActionableAppProfileCardImageContainer:o}=tt(),l=i.createElement(u.J,{src:e,width:t,height:n,variables:r});return i.createElement(p.x,{variables:o},a?i.createElement(N,null,l):l)},Ge=({appId:e,appName:t,isInstalled:n,isInfoBannerType:a})=>{const{addAppButton:r,addToYourAppsButton:o,openAppButton:d}=nt(),[c,u]=i.useState(!1),[p,g]=i.useState(!1),M=(()=>{const e=(0,de.x)(),{scenarioFactory:t}=(0,E.SE)(),n=(0,j.w)("useInstallPersonalApp"),{enableAppsQueryOptimization:a}=(0,D.NC)(C.J.Extensibility);return i.useCallback((i=>(0,l.eI)(e,t,F.RG.AppProfileCardInstallApp,i,s.qi6.Personal,n,a)),[e,n,t,a])})(),N=(0,Ue.Y)(),{recordPanelAction:T}=(0,O.It)();i.useEffect((()=>(g(!0),()=>g(!1))),[]);const{isActionableAppProfileCardAppButton:v}=tt(),I=i.useCallback((()=>{c||void 0===e||(u(!0),M(e).then((()=>N(e))).catch((()=>{p&&u(!1)})),T(et({isAppInstallAction:!0,appId:e,appName:t})))}),[e,t,c,p,M,N,T]),y=i.useCallback((()=>{void 0!==e&&N(e),T(et({appId:e,appName:t}))}),[e,t,N,T]),A=n?d:a?r:o;return i.createElement(m.z,{disabled:void 0===e,loading:c,onClick:n?y:I,variables:v,content:A,title:A})},Je=({name:e})=>{const{isActionableAppProfileCardTitle:t}=tt();return i.createElement(o.x,{variables:t,content:e})},He=({description:e})=>{const{isActionableAppProfileCardDescription:t}=tt();return i.createElement(o.x,{variables:t,content:e})},Xe=()=>{const{addAppInfoBanner:e}=nt(),{isActionableAppProfileCardHeaderInfoBanner:t}=tt();return i.createElement(d.k,{gap:"gap.smaller",variables:t},i.createElement(g.s,null),i.createElement(o.x,{content:e}))},_e=({developerName:e,developerUrl:t})=>{const{isActionableAppProfileCardBodySectionParagrahp:n}=tt(),a=(0,A.Cq)(),r=i.useMemo((()=>a.getTransForNs("extensibility")),[a]);return i.createElement(o.x,{variables:n,content:i.createElement(r,{i18nKey:"ext_actionable_app_profile_card_app_features_created_by"},i.createElement(o.x,{link:!!t,target:"_blank",href:t,content:e}))})},Ke=({appName:e,onPermissionsClick:t,privacyUrl:n,termsOfUseUrl:a})=>{const{isActionableAppProfileCardConsent:r,isActionableAppProfileCardLink:l}=tt(),s=(0,A.Cq)(),c=i.useMemo((()=>s.getTransForNs("extensibility")),[s]),{termsOfUse:u,privacyPolicy:p,permissions:g}=nt();return i.createElement(d.k,{vAlign:"end",gap:"gap.medium"},i.createElement(o.x,{variables:r,content:i.createElement(c,{i18nKey:"ext_actionable_app_profile_card_consent"},i.createElement(o.x,{content:e}),i.createElement(o.x,{link:!0,target:"_blank",href:n,content:p}),i.createElement(o.x,{link:!0,target:"_blank",href:a,content:u}),i.createElement(m.z,{text:!0,onClick:t,content:g,variables:l}))}))},qe=({isShortCard:e,permissionsRef:t,supportsMeetingStreaming:n})=>{const a=(0,A.Cq)(),{isActionableAppProfileCardBodySection:r,isActionableAppProfileCardBodySectionTitle:l,isActionableAppProfileCardPermission:s,isActionableAppProfileCardPermissionsList:c}=tt(),u=i.useMemo((()=>{const t=e?["app_profile_card_imsend","app_profile_card_imreceive"]:["extension_addAppDialogBasicPermission1","extension_addAppDialogBasicPermission2","extension_addAppDialogIdentityPermission1","extension_addAppDialogTeamPermission1","extension_addAppDialogTeamPermission2","extension_addAppDialogIdentityPermission2"];return n&&t.push("extension_addAppDialog_Permission_Meeting_Streaming_Access"),t}),[e,n]),p=i.useMemo((()=>u.map((e=>({key:e,content:a.translate("extensibility",e),variables:s})))),[s,u,a]),{permissionsTitle:m}=nt();return i.createElement(d.k,{column:!0,ref:t,variables:r},i.createElement(o.x,{content:m,variables:l}),i.createElement(M.a,{variables:c,items:p}))},$e=({appDef:e})=>{const{isActionableAppProfileCardBodySection:t,isActionableAppProfileCardBodySectionTitle:n}=tt(),{appFeaturesTitle:a}=nt(),{developerName:r,developerUrl:l}=e;return i.createElement(d.k,{column:!0,variables:t},i.createElement(o.x,{content:a,variables:n}),i.createElement(Oe,{appDef:e}),i.createElement(_e,{developerName:r||"",developerUrl:l||""}))},et=({isAppInstallAction:e,appId:t,appName:n})=>({actionGesture:L.uS.click,actionOutcome:L.$K.nav,actionScenario:e?L.Tk.appCardAdd:L.Tk.appCardOpen,actionScenarioType:L.Yu.appCardActions,moduleName:L.rA.appProfileCard,panelRegion:L.Ai.popover,panelType:L.wh.AppProfileCardPopover,extensibilityData:{id:t,name:n}}),tt=()=>{const{vars:e}=(0,a.L)();return i.useMemo((()=>({isActionableAppProfileCardActionButtonsWrapper:e("extensibility",["isActionableAppProfileCardActionButtonsWrapper"]),isActionableAppProfileCardAppButton:e("extensibility",["isActionableAppProfileCardAppButton"]),isActionableAppProfileCardPermission:e("extensibility",["isActionableAppProfileCardPermission"]),isActionableAppProfileCardPermissionsList:e("extensibility",["isActionableAppProfileCardPermissionsList"]),isActionableAppProfileCardConsent:e("extensibility",["isActionableAppProfileCardConsent"]),isActionableAppProfileCardDeveloper:e("extensibility",["isActionableAppProfileCardDeveloper"]),isActionableAppProfileCardLink:e("extensibility",["isActionableAppProfileCardLink"]),isActionableAppProfileCardPresence:e("extensibility",["isActionableAppProfileCardPresence"]),isActionableAppProfileCardTitle:e("extensibility",["isActionableAppProfileCardTitle"]),isActionableAppProfileCardDescription:e("extensibility",["isActionableAppProfileCardDescription"]),isActionableAppProfileCardImageContainer:e("extensibility",["isActionableAppProfileCardImageContainer"]),isActionableAppProfileCard:e("extensibility",["isActionableAppProfileCard"]),isActionableAppProfileCardShort:e("extensibility",["isActionableAppProfileCardShort"]),appProfileImageBorderRadius:e("extensibility",["appProfileImageBorderRadius"]),isActionableAppProfileCardHeader:e("extensibility",["isActionableAppProfileCardHeader"]),isActionableAppProfileCardHeaderDescription:e("extensibility",["isActionableAppProfileCardHeaderDescription"]),isActionableAppProfileCardHeaderButtons:e("extensibility",["isActionableAppProfileCardHeaderButtons"]),isActionableAppProfileCardHeaderInfoBanner:e("extensibility",["isActionableAppProfileCardHeaderInfoBanner"]),isActionableAppProfileCardDivider:e("extensibility",["isActionableAppProfileCardDivider"]),isActionableAppProfileCardBody:e("extensibility",["isActionableAppProfileCardBody","customScrollbar"]),isActionableAppProfileCardBodySection:e("extensibility",["isActionableAppProfileCardBodySection"]),isActionableAppProfileCardBodySectionParagrahp:e("extensibility",["isActionableAppProfileCardBodySectionParagrahp"]),isActionableAppProfileCardBodySectionTitle:e("extensibility",["isActionableAppProfileCardBodySectionTitle"]),isActionableAppProfileCardFooter:e("extensibility",["isActionableAppProfileCardFooter"])})),[e])},nt=()=>{const e=(0,A.Cq)();return i.useMemo((()=>({addAppButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_app_button_text"),addAppInfoBanner:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_app_info_banner_text"),addToYourAppsButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_to_your_apps_button_text"),appFeaturesTitle:e.stringTranslate("extensibility","ext_actionable_app_profile_card_app_features_title"),openAppButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_open_app_button_text"),permissions:e.stringTranslate("extensibility","ext_actionable_app_profile_card_permissions_link_text"),permissionsTitle:e.stringTranslate("extensibility","ext_actionable_app_profile_card_permissions_title"),privacyPolicy:e.stringTranslate("extensibility","ext_actionable_app_profile_card_privacy_policy_link_text"),termsOfUse:e.stringTranslate("extensibility","ext_actionable_app_profile_card_terms_of_use_link_text")})),[e])};var it=n(850402),at=n(152386),rt=n(290023),ot=n(500396),lt=n(491465),st=n(275742);const dt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"user"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"mri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"imageUri"}}]}}]}}]};var ct=n(369398),ut=n(181620);const pt=[],mt=(e,t,n,i,a,r)=>{const o=pt.find((o=>o.botOrAppId===e&&o.isWebhook===t&&(0,st.isEqual)(o.conversationId,i)&&(0,st.isEqual)(o.connectorSenderGuid,a)&&(0,st.isEqual)(o.displayName,r)&&(0,st.isEqual)(o.togetherModeParams,n)));if(o)return o;const l={botOrAppId:e,togetherModeParams:n,conversationId:i,connectorSenderGuid:a,displayName:r,isWebhook:t,isGetAppDefinitionCallInProgress:!1,listeners:[]};return pt.push(l),l},gt=(e,t)=>{e&&(e.listeners.forEach((e=>{e(t)})),e.isGetAppDefinitionCallInProgress=!1)},Mt=(e,t,n,a,r,o,l=!1,s=!1)=>{const[d,c]=(0,i.useState)(),{loggerFactory:{newLogger:u},scenarioFactory:p}=(0,E.SE)(),m=(0,i.useMemo)((()=>u("AppProfileCardContentContainer","app-profile-card-data")),[u]),g=(0,x.bp)(),{convId:M}=g.chatServiceSubscriptionFilter,{appDefinition:N,isSceneApp:T}=n||{},{entity:v}=(0,re.sV)(),I=M||a,y=(0,i.useRef)(!1);return(0,i.useEffect)((()=>{const e=mt(t,l,n,a,r,o);return e.listeners.push(c),()=>{e.listeners=e.listeners.filter((e=>e!==c)),0===e.listeners.length&&(e=>{const t=pt.findIndex((t=>t.botOrAppId===e.botOrAppId&&t.isWebhook===e.isWebhook&&(0,st.isEqual)(t.conversationId,e.conversationId)&&(0,st.isEqual)(t.connectorSenderGuid,e.connectorSenderGuid)&&(0,st.isEqual)(t.displayName,e.displayName)&&(0,st.isEqual)(t.togetherModeParams,e.togetherModeParams)));t>=0&&pt.splice(t,1)})(e)}}),[t,n,a,r,o,l]),(0,i.useEffect)((()=>{let i;y.current=!0;const d=mt(t,l,n,a,r,o);if(!d.isGetAppDefinitionCallInProgress){d.isGetAppDefinitionCallInProgress=!0,i=p.newScenario(F.RG.AppProfileCardGetAppDefinition);const n=(0,H.bl)(t)?"Bot.Id":"App.Id";i.appendEventData({[n]:t}),N?y.current&&(gt(d,N),i.stop()):Nt(e,m,p,t,I||"",v,T,r,o,l,s).then((e=>{y.current&&(gt(d,e),i.stop())})).catch((e=>{const n=`Unable to fetch appDefinition for :${t} with :${e}`;m.error(n,{botOrAppId:t}),y.current&&i&&i.fail({message:n}),d.isGetAppDefinitionCallInProgress=!1}))}return()=>{y.current=!1,i&&i.cancel()}}),[e,t,T,m,c,p,N,I,r,v,o,l,a,n,s]),d},Nt=(e,t,n,i,a,r,o,l,d,c=!1,u=!1)=>(0,it.__awaiter)(void 0,void 0,void 0,(function*(){var p;let m,g;const M=r.type===oe.py.channels;if(M)m=s.qi6.Team;else{const t=a?yield At(e,a):null;if(t){g=(null==t?void 0:t.chatSubType)===ot.k2.Channel;const e=Dt(i,t);m=g?s.qi6.Team:e||o?s.qi6.Personal:s.qi6.GroupChat}}return(M||g)&&(a=null!==(p=yield(0,ct.RD)(e,a))&&void 0!==p?p:""),Tt(e,t,n,i,a,l,m,d,c,u)})),Tt=(e,t,n,i,a,r,o,d,c=!1,u=!1)=>(0,it.__awaiter)(void 0,void 0,void 0,(function*(){const p=(0,H.bl)(i),m=(0,H.cQ)(i)&&!!r,g=c?yield((e,t,n,i,a,r,o=!1)=>(0,it.__awaiter)(void 0,void 0,void 0,(function*(){var d,c;const u=yield(0,l.xJ)(e,n,a,i,!0,"outgoing-webhook",{conversation:{scope:r||s.qi6.Team,id:t||""},enableInstalledAppQueryOptimization:o});return null!==(c=null===(d=null==u?void 0:u[0])||void 0===d?void 0:d.definition)&&void 0!==c?c:null})))(e,a,t,i,n,o,u):m?yield((e,t,n,i)=>(0,it.__awaiter)(void 0,void 0,void 0,(function*(){if(!n)return null;const{data:a}=yield e.query({query:rt.r6,variables:{conversationId:t,scope:i,options:{capabilityFilter:[s.PwB.Connector]}},context:{callerInfo:"app-profile-card-data-getAppDefinitionForConnector"}});if((null==a?void 0:a.appDefinitions)&&a.appDefinitions.length>0){const e=a.appDefinitions.filter((e=>(null==e?void 0:e.connectors)&&(null==e?void 0:e.connectors[0].connectorId)===n));if(e.length&&e[0])return e[0]}return null})))(e,a,r,o):p?yield((e,t,n,i)=>(0,it.__awaiter)(void 0,void 0,void 0,(function*(){var a;const{data:r}=yield e.query({query:rt.r6,variables:{conversationId:n,scope:i,options:{botId:(0,ut.HC)(t)}},context:{callerInfo:"app-profile-card-data-getAppDefinitionForBot"}});return(null===(a=null==r?void 0:r.appDefinitions)||void 0===a?void 0:a.length)&&r.appDefinitions[0]?r.appDefinitions[0]:null})))(e,i,a,o):yield((e,t,n,i)=>(0,it.__awaiter)(void 0,void 0,void 0,(function*(){const{data:a}=yield e.query({query:at.VY,variables:{conversationId:n,scope:i,appId:t}});return(null==a?void 0:a.appDefinition)?a.appDefinition:null})))(e,i,a,o);if(g)return g;const M=p?yield((e,t,n)=>(0,it.__awaiter)(void 0,void 0,void 0,(function*(){if((0,H.cQ)(t)&&n)return{name:n,largeImageUrl:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjMjkzODRGIi8+CjxwYXRoIGQ9Ik0xMS45OTAyIDMuMjVDMTIuNTgyNyAzLjI1IDEzLjE0OTEgMy4zMjgxMiAxMy42ODk1IDMuNDg0MzhDMTQuMjI5OCAzLjYzNDExIDE0LjczMTEgMy44NDU3IDE1LjE5MzQgNC4xMTkxNEMxNS42NTU2IDQuMzkyNTggMTYuMDcyMyA0LjcyNDYxIDE2LjQ0MzQgNS4xMTUyM0MxNi44MjEgNS41MDU4NiAxNy4xNDMyIDUuOTM1NTUgMTcuNDEwMiA2LjQwNDNDMTcuNjc3MSA2Ljg3MzA1IDE3Ljg4MjIgNy4zODA4NiAxOC4wMjU0IDcuOTI3NzNDMTguMTY4NiA4LjQ2ODEgMTguMjQwMiA5LjAzMTI1IDE4LjI0MDIgOS42MTcxOUMxOC40MjkgOS42ODIyOSAxOC41OTgzIDkuNzczNDQgMTguNzQ4IDkuODkwNjJDMTguOTA0MyAxMC4wMDc4IDE5LjAzNDUgMTAuMTQ0NSAxOS4xMzg3IDEwLjMwMDhDMTkuMjQ5MyAxMC40NTA1IDE5LjMzNCAxMC42MTk4IDE5LjM5MjYgMTAuODA4NkMxOS40NTc3IDEwLjk5MDkgMTkuNDkwMiAxMS4xNzk3IDE5LjQ5MDIgMTEuMzc1VjEzLjg3NUMxOS40OTAyIDE0LjEyODkgMTkuNDQxNCAxNC4zNjk4IDE5LjM0MzggMTQuNTk3N0MxOS4yNDYxIDE0LjgyNTUgMTkuMTA5NCAxNS4wMjczIDE4LjkzMzYgMTUuMjAzMUMxOC43NjQzIDE1LjM3MjQgMTguNTY1OCAxNS41MDU5IDE4LjMzNzkgMTUuNjAzNUMxOC4xMSAxNS43MDEyIDE3Ljg2OTEgMTUuNzUgMTcuNjE1MiAxNS43NUgxNi4zNjUyQzE2LjE5NiAxNS43NSAxNi4wNDk1IDE1LjY4ODIgMTUuOTI1OCAxNS41NjQ1QzE1LjgwMjEgMTUuNDQwOCAxNS43NDAyIDE1LjI5NDMgMTUuNzQwMiAxNS4xMjVWMTAuMTI1QzE1Ljc0MDIgOS45NDkyMiAxNS43ODI2IDkuODE5MDEgMTUuODY3MiA5LjczNDM4QzE1Ljk1MTggOS42NDMyMyAxNi4wNTYgOS41ODEzOCAxNi4xNzk3IDkuNTQ4ODNDMTYuMzAzNCA5LjUwOTc3IDE2LjQzNjggOS40OTM0OSAxNi41ODAxIDkuNUMxNi43Mjk4IDkuNSAxNi44NjY1IDkuNSAxNi45OTAyIDkuNUMxNi45OTAyIDguODA5OSAxNi44NTY4IDguMTYyMTEgMTYuNTg5OCA3LjU1NjY0QzE2LjMyOTQgNi45NTExNyAxNS45NzE0IDYuNDIzODMgMTUuNTE1NiA1Ljk3NDYxQzE1LjA2NjQgNS41MTg4OCAxNC41MzkxIDUuMTYwODEgMTMuOTMzNiA0LjkwMDM5QzEzLjMyODEgNC42MzM0NiAxMi42ODAzIDQuNSAxMS45OTAyIDQuNUMxMS4zMDAxIDQuNSAxMC42NTIzIDQuNjMzNDYgMTAuMDQ2OSA0LjkwMDM5QzkuNDQxNDEgNS4xNjA4MSA4LjkxMDgxIDUuNTE4ODggOC40NTUwOCA1Ljk3NDYxQzguMDA1ODYgNi40MjM4MyA3LjY0Nzc5IDYuOTUxMTcgNy4zODA4NiA3LjU1NjY0QzcuMTIwNDQgOC4xNjIxMSA2Ljk5MDIzIDguODA5OSA2Ljk5MDIzIDkuNUg3LjI3MzQ0QzcuMzg0MTEgOS41IDcuNDk4MDUgOS41MDY1MSA3LjYxNTIzIDkuNTE5NTNDNy43MzI0MiA5LjUyNjA0IDcuODM2NTkgOS41NTIwOCA3LjkyNzczIDkuNTk3NjZDOC4wMTg4OCA5LjYzNjcyIDguMDkzNzUgOS42OTg1NyA4LjE1MjM0IDkuNzgzMkM4LjIxMDk0IDkuODY3ODQgOC4yNDAyMyA5Ljk4MTc3IDguMjQwMjMgMTAuMTI1VjE1LjEyNUM4LjI0MDIzIDE1LjMwMDggOC4xOTc5MiAxNS40MzQyIDguMTEzMjggMTUuNTI1NEM4LjAyODY1IDE1LjYxIDcuOTI0NDggMTUuNjcxOSA3LjgwMDc4IDE1LjcxMDlDNy42NzcwOCAxNS43NDM1IDcuNTQwMzYgMTUuNzU5OCA3LjM5MDYyIDE1Ljc1OThDNy4yNDc0IDE1Ljc1MzMgNy4xMTM5MyAxNS43NSA2Ljk5MDIzIDE1Ljc1VjE3Ljk3NjZDNi45OTAyMyAxOC4xMzI4IDcuMDM5MDYgMTguMjYzIDcuMTM2NzIgMTguMzY3MkM3LjI0MDg5IDE4LjQ2NDggNy4zNzEwOSAxOC41NDYyIDcuNTI3MzQgMTguNjExM0M3LjY5MDEgMTguNjc2NCA3Ljg2OTE0IDE4LjcyNTMgOC4wNjQ0NSAxOC43NTc4QzguMjU5NzcgMTguNzkwNCA4LjQ1NTA4IDE4LjgxNjQgOC42NTAzOSAxOC44MzU5QzguODQ1NyAxOC44NDkgOS4wMjc5OSAxOC44NTg3IDkuMTk3MjcgMTguODY1MkM5LjM2NjU0IDE4Ljg2NTIgOS41MDMyNiAxOC44NjUyIDkuNjA3NDIgMTguODY1MkM5LjY3OTA0IDE4LjY4MjkgOS43NzM0NCAxOC41MTY5IDkuODkwNjIgMTguMzY3MkMxMC4wMDc4IDE4LjIxNzQgMTAuMTQxMyAxOC4wODcyIDEwLjI5MSAxNy45NzY2QzEwLjQ0NzMgMTcuODY1OSAxMC42MTY1IDE3Ljc4MTIgMTAuNzk4OCAxNy43MjI3QzEwLjk4MTEgMTcuNjU3NiAxMS4xNjk5IDE3LjYyNSAxMS4zNjUyIDE3LjYyNUgxMS45OTAyQzEyLjI0NDEgMTcuNjI1IDEyLjQ4NSAxNy42NzM4IDEyLjcxMjkgMTcuNzcxNUMxMi45NDA4IDE3Ljg2OTEgMTMuMTM5MyAxOC4wMDU5IDEzLjMwODYgMTguMTgxNkMxMy40ODQ0IDE4LjM1MDkgMTMuNjIxMSAxOC41NDk1IDEzLjcxODggMTguNzc3M0MxMy44MTY0IDE5LjAwNTIgMTMuODY1MiAxOS4yNDYxIDEzLjg2NTIgMTkuNUMxMy44NjUyIDE5Ljc1MzkgMTMuODE2NCAxOS45OTQ4IDEzLjcxODggMjAuMjIyN0MxMy42MjExIDIwLjQ1MDUgMTMuNDg0NCAyMC42NTIzIDEzLjMwODYgMjAuODI4MUMxMy4xMzkzIDIwLjk5NzQgMTIuOTQwOCAyMS4xMzA5IDEyLjcxMjkgMjEuMjI4NUMxMi40ODUgMjEuMzI2MiAxMi4yNDQxIDIxLjM3NSAxMS45OTAyIDIxLjM3NUgxMS4zNjUyQzEwLjk2MTYgMjEuMzc1IDEwLjYwMDMgMjEuMjYxMSAxMC4yODEyIDIxLjAzMzJDOS45NjIyNCAyMC43OTg4IDkuNzM0MzggMjAuNDkyOCA5LjU5NzY2IDIwLjExNTJDOS4zNTAyNiAyMC4xMDg3IDkuMDgwMDggMjAuMDk5IDguNzg3MTEgMjAuMDg1OUM4LjUwMDY1IDIwLjA3MjkgOC4yMTQxOSAyMC4wNDY5IDcuOTI3NzMgMjAuMDA3OEM3LjY0MTI4IDE5Ljk2MjIgNy4zNjQ1OCAxOS44OTcxIDcuMDk3NjYgMTkuODEyNUM2LjgzNzI0IDE5LjcyMTQgNi42MDYxMiAxOS41OTc3IDYuNDA0MyAxOS40NDE0QzYuMjAyNDcgMTkuMjc4NiA2LjAzOTcxIDE5LjA4MDEgNS45MTYwMiAxOC44NDU3QzUuNzk4ODMgMTguNjA0OCA1Ljc0MDIzIDE4LjMxNTEgNS43NDAyMyAxNy45NzY2VjE1LjYzMjhDNS41NTc5NCAxNS41Njc3IDUuMzg4NjcgMTUuNDc2NiA1LjIzMjQyIDE1LjM1OTRDNS4wNzYxNyAxNS4yNDIyIDQuOTQyNzEgMTUuMTA4NyA0LjgzMjAzIDE0Ljk1OUM0LjcyNzg2IDE0LjgwMjcgNC42NDMyMyAxNC42MzM1IDQuNTc4MTIgMTQuNDUxMkM0LjUxOTUzIDE0LjI2MjQgNC40OTAyMyAxNC4wNzAzIDQuNDkwMjMgMTMuODc1VjExLjM3NUM0LjQ5MDIzIDExLjE3OTcgNC41MTk1MyAxMC45OTA5IDQuNTc4MTIgMTAuODA4NkM0LjY0MzIzIDEwLjYxOTggNC43Mjc4NiAxMC40NTA1IDQuODMyMDMgMTAuMzAwOEM0Ljk0MjcxIDEwLjE0NDUgNS4wNzYxNyAxMC4wMDc4IDUuMjMyNDIgOS44OTA2MkM1LjM4ODY3IDkuNzczNDQgNS41NTc5NCA5LjY4MjI5IDUuNzQwMjMgOS42MTcxOUM1Ljc0MDIzIDkuMDMxMjUgNS44MTE4NSA4LjQ2ODEgNS45NTUwOCA3LjkyNzczQzYuMDk4MzEgNy4zODA4NiA2LjMwMzM5IDYuODczMDUgNi41NzAzMSA2LjQwNDNDNi44MzcyNCA1LjkzNTU1IDcuMTU2MjUgNS41MDU4NiA3LjUyNzM0IDUuMTE1MjNDNy45MDQ5NSA0LjcyNDYxIDguMzI0ODcgNC4zOTI1OCA4Ljc4NzExIDQuMTE5MTRDOS4yNDkzNSAzLjg0NTcgOS43NTA2NSAzLjYzNDExIDEwLjI5MSAzLjQ4NDM4QzEwLjgzMTQgMy4zMjgxMiAxMS4zOTc4IDMuMjUgMTEuOTkwMiAzLjI1Wk0xMS4zNjUyIDE4Ljg3NUMxMS4xOTYgMTguODc1IDExLjA0OTUgMTguOTM2OCAxMC45MjU4IDE5LjA2MDVDMTAuODAyMSAxOS4xODQyIDEwLjc0MDIgMTkuMzMwNyAxMC43NDAyIDE5LjVDMTAuNzQwMiAxOS42NjkzIDEwLjgwMjEgMTkuODE1OCAxMC45MjU4IDE5LjkzOTVDMTEuMDQ5NSAyMC4wNjMyIDExLjE5NiAyMC4xMjUgMTEuMzY1MiAyMC4xMjVIMTEuOTkwMkMxMi4xNTk1IDIwLjEyNSAxMi4zMDYgMjAuMDYzMiAxMi40Mjk3IDE5LjkzOTVDMTIuNTUzNCAxOS44MTU4IDEyLjYxNTIgMTkuNjY5MyAxMi42MTUyIDE5LjVDMTIuNjE1MiAxOS4zMzA3IDEyLjU1MzQgMTkuMTg0MiAxMi40Mjk3IDE5LjA2MDVDMTIuMzA2IDE4LjkzNjggMTIuMTU5NSAxOC44NzUgMTEuOTkwMiAxOC44NzVIMTEuMzY1MlpNNi4zNjUyMyAxMC43NUM2LjE5NTk2IDEwLjc1IDYuMDQ5NDggMTAuODExOCA1LjkyNTc4IDEwLjkzNTVDNS44MDIwOCAxMS4wNTkyIDUuNzQwMjMgMTEuMjA1NyA1Ljc0MDIzIDExLjM3NVYxMy44NzVDNS43NDAyMyAxNC4wNDQzIDUuODAyMDggMTQuMTkwOCA1LjkyNTc4IDE0LjMxNDVDNi4wNDk0OCAxNC40MzgyIDYuMTk1OTYgMTQuNSA2LjM2NTIzIDE0LjVINi45OTAyM1YxMC43NUg2LjM2NTIzWk0xNi45OTAyIDEwLjc1VjE0LjVIMTcuNjE1MkMxNy43ODQ1IDE0LjUgMTcuOTMxIDE0LjQzODIgMTguMDU0NyAxNC4zMTQ1QzE4LjE3ODQgMTQuMTkwOCAxOC4yNDAyIDE0LjA0NDMgMTguMjQwMiAxMy44NzVWMTEuMzc1QzE4LjI0MDIgMTEuMjA1NyAxOC4xNzg0IDExLjA1OTIgMTguMDU0NyAxMC45MzU1QzE3LjkzMSAxMC44MTE4IDE3Ljc4NDUgMTAuNzUgMTcuNjE1MiAxMC43NUgxNi45OTAyWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg=="};const{data:i}=yield e.query({query:dt,variables:{mri:t},context:{callerInfo:"app-profile-card-data"}}),a=null==i?void 0:i.user;return a?{name:a.displayName||"",largeImageUrl:a.imageUri||""}:null})))(e,i,d):null;return M})),vt=e=>e.bots&&e.bots.length>0&&(0,st.includes)(e.bots[0].scopes,s.qi6.Personal)||!1,It=(e,t)=>{const[n,a]=(0,i.useState)(!1),[r,o]=(0,i.useState)(!1),[l,s]=(0,i.useState)(!0),d=(0,x.bp)(),{scenarioFactory:c}=(0,E.SE)(),u=(0,j.w)("AppProfileCardContentContainer");return(0,i.useEffect)((()=>{const n=bt(t);if(!n)return;const{convId:i}=d.chatServiceSubscriptionFilter;let r=!0;const l=c.newScenario(F.RG.UseOneOnOneAndDisabledByTenantChecker);return At(e,i||"").then((e=>{r&&(a(!e||Dt(n,e)),o(!e||Ct(n,e)),s(!e||Dt(n,e)),l.stop())})).catch((()=>{const e=`Failed to get conversation with conversationId:${i} for bot/app:${n}`;u.error(e,{botMri:n}),r&&l&&l.fail({message:e})})),()=>{r=!1,l&&l.cancel()}}),[d.chatServiceSubscriptionFilter,t,e,u,c]),{isDisabledByTenant:r,isOneOnOne:n,isOneOnOneBotChat:l}},yt=(e,t)=>{const[n,a]=(0,i.useState)(!1),{scenarioFactory:r}=(0,E.SE)(),o=(0,j.w)("AppProfileCardContentContainer");return(0,i.useEffect)((()=>{const n=bt(t);if(!n)return;let i=!0;const l=r.newScenario(F.RG.UseDisabledByUserChecker);return(0,U.cc)(e,n).then((e=>{i&&(a(!e||Ct(n,e)),l.stop())})).catch((()=>{const e=`Failed to get conversation for bot/app:${n}`;o.error(e,{botMri:n}),i&&l&&l.fail({message:e})})),()=>{i=!1,l&&l.cancel()}}),[t,e,o,r]),n},At=(e,t)=>(0,it.__awaiter)(void 0,void 0,void 0,(function*(){var n;return null===(n=(yield e.query({query:lt.vh,variables:{convId:t},context:{callerInfo:"app-profile-card-data"}})).data)||void 0===n?void 0:n.chat})),Dt=(e,t)=>!!t&&!!t.isOneOnOne&&!!t.memberIds&&-1!==t.memberIds.indexOf(e),Ct=(e,t)=>!!t&&!!t.isDisabled&&!!t.memberIds&&-1!==t.memberIds.indexOf(e),bt=e=>{let t=e&&e.bots&&e.bots.length>0&&e.bots[0].id;if(t){const e=null==t?void 0:t.startsWith(X.at.BotPrefix);t=e?t:`${X.at.BotPrefix}${t}`}return t||null},ht=e=>e&&e.meetingExtensionDefinition&&e.meetingExtensionDefinition.scenes&&e.meetingExtensionDefinition.scenes.length>0?e.meetingExtensionDefinition.scenes.length:0,ft=e=>{var t,n,i;const a={supportsCalling:!1,supportsVideo:!1},r=e.bots&&(null===(t=null==e?void 0:e.bots[0])||void 0===t?void 0:t.capabilities);return a.supportsCalling=null!==(n=null==r?void 0:r.supportsCalling)&&void 0!==n&&n,a.supportsVideo=null!==(i=null==r?void 0:r.supportsVideo)&&void 0!==i&&i,a},kt=e=>{var t;return e.bots&&(null===(t=null==e?void 0:e.bots[0])||void 0===t?void 0:t.configuration)},St="ext_actionable_app_profile_card_use_is_app_installed_get_installed_apps",Ut=({client:e,botIdOrAppId:t,hideActionButtons:n,appDef:a,togetherModeParams:r})=>{const{isOneOnOne:o,isDisabledByTenant:d,isOneOnOneBotChat:c}=It(e,a),u=yt(e,a),p=a&&bt(a),m=a&&ht(a),g=a&&ft(a),M=a&&kt(a),{id:N,name:T,privacyUrl:v,termsOfUseUrl:I,largeImageUrl:y,shortDescription:A,meetingExtensionDefinition:b}=a,h=vt(a),f=!h&&!!n,k=((e,t)=>{const[n,a]=i.useState(null),{scenarioFactory:r}=(0,E.SE)(),o=(0,j.w)("useIsAppInstalled"),{enableAppsQueryOptimization:s,enableInstalledAppQueryOptimization:d}=(0,D.NC)(C.J.Extensibility);return i.useEffect((()=>{(0,l.xJ)(e,o,r,t,s,"use-is-app-installed",{shouldFetchPersonalApps:!0,enableInstalledAppQueryOptimization:d}).then((e=>{const t=`Loaded installed apps. Length: ${e.length}`;o.infoToTelemetry?o.infoToTelemetry(t,St):o.log(`${St}: ${t}`),a(e.length>0)})).catch((()=>{const e=`Failed to get installed apps by ID for app id: ${t}`;o.errorToTelemetry?o.errorToTelemetry(e,St):o.error(`${St}: ${e}`)}))}),[e,o,r,t,s,d]),n})(e,N),S=(0,l.WW)(s.qi6.Personal,a);return i.createElement(Ve,{appDef:a,botName:Et(T),privacyUrl:Et(v),termsOfUseUrl:Et(I),iconUrl:Et(y),description:Et(A),botIdOrAppId:p||t,showRectAppImage:!!(null==r?void 0:r.isSceneApp)||f,sceneCount:m||0,isSceneApp:!!(null==r?void 0:r.isSceneApp),showActionButtons:h&&!o&&!d&&!u&&!n,sceneName:Et(null==r?void 0:r.sceneName),botCallingCapabilities:g,appId:N,supportsMeetingStreaming:null==b?void 0:b.supportsStreaming,hasPersonalScope:S,isInstalled:!!k,botConfiguration:c?null:M})},Et=e=>e||"",jt=({client:e,botIdOrAppId:t,hideActionButtons:n,appDef:a,togetherModeParams:r})=>{const{isOneOnOne:o,isDisabledByTenant:l,isOneOnOneBotChat:s}=It(e,a),d=yt(e,a),c=a&&bt(a),u=a&&ht(a),p=a&&ft(a),m=a&&kt(a),{id:g,name:M,privacyUrl:N,termsOfUseUrl:T,developerName:v,largeImageUrl:I,longDescription:y,shortDescription:A,meetingExtensionDefinition:D}=a,C=vt(a),b=!C&&n||!1,h=!(null==a?void 0:a.id)&&!n;return i.createElement(pe,{botName:Lt(M),privacyUrl:Lt(N),termsOfUseUrl:Lt(T),developerName:Ot(r)?"":Lt(v),iconUrl:Lt(I),description:Ot(r)?Lt(A):Lt(y),botIdOrAppId:c||t,showRectAppImage:Ot(r)||b,isShortProfileCard:h,sceneCount:u||0,isSceneApp:!!Ot(r),showActionButtons:C&&!o&&!l&&!d&&!n&&!h,sceneName:Lt(r&&r.sceneName),botCallingCapabilities:p,appId:g,supportsMeetingStreaming:null==D?void 0:D.supportsStreaming,botConfiguration:s?null:m,appDef:a})},Lt=e=>e||"",Ot=e=>e&&e.isSceneApp;var Ft=n(182497);const xt=()=>i.createElement(p.x,{variables:{isAppProfileCard:!0}},i.createElement(T.k,{fill:!0,vAlign:"center",hAlign:"center"},i.createElement(Ft.aN,null)));var wt=n(923270);const zt=i.memo((({children:e,client:t,botIdOrAppId:n,hideActionButtons:l,position:s,align:d,offset:c,togetherModeParams:u,autoFocus:p,connectorSenderGuid:m,conversationId:g,onBehalfOfId:M,renderTriggerAsLink:N=!0,displayName:T,tabbableTrigger:v,nonFocusableTrigger:I})=>{const y=i.useContext(A.OO),{recordPanelAction:b,createDatabag:h}=(0,O.It)(),f=i.useRef(!1),{enableAppProfileCard:k,enableActionableAppProfileCard:S,enableInstalledAppQueryOptimization:U}=(0,D.NC)(C.J.Extensibility),{vars:E}=(0,a.L)(),j=(0,H.YQ)(n),F=Mt(t,j&&M?M:n,u,g,m,T,j,!!U),x=i.useCallback(((e,t)=>{var n,i,a;const r=null==t?void 0:t.open;if(r&&!f.current){const e=z(L.uS.hover,L.$K.inspect,L.Tk.appProfileCardAppear,L.rA.appProfileCard,null!==(n=null==F?void 0:F.name)&&void 0!==n?n:void 0,null==F?void 0:F.id,null===(a=null===(i=null==F?void 0:F.bots)||void 0===i?void 0:i[0])||void 0===a?void 0:a.id);S&&(e.dataBag=h(),e.dataBag.actionableAppProfileCard=!0),b(e)}void 0!==r&&r!==f.current&&(f.current=r)}),[h,b,F,S,f]),w=i.useMemo((()=>Qt(!!S)),[S]);if(!k)return i.createElement(i.Fragment,null,e);let V="";if(null===F)return null;if(F){const{name:e,developerName:t,longDescription:n,shortDescription:i}=F,a=(S?i:n)||"";V=y.stringTranslate("extensibility","app_profile_card_app_information_dialog_aria_label",{name:e||"",developerName:t||"",longDescription:a})}const Q=null!=e?e:null==F?void 0:F.name;return i.createElement(r.G,{on:"hover",position:s||"before",align:d||"center",offset:c,onOpenChange:x,autoFocus:p,trapFocus:Vt(p),content:{"aria-label":V,autoFocus:!0,className:wt.L,content:F?i.createElement(w,{botIdOrAppId:n,client:t,appDef:F,hideActionButtons:l,togetherModeParams:u,convId:g}):i.createElement(xt,null),variables:{removePopupContentPadding:!0,hasNoBorder:!0}},tabbableTrigger:v,trigger:i.createElement(o.x,Object.assign({link:!!N,content:Q,variables:E("extensibility",["isFocusableOutlineBorder"])},I&&{tabIndex:"-1"})),overflowBoundary:"window",flipBoundary:"window"})})),Vt=e=>!!e&&!e,Qt=(e=!1)=>e?Ut:jt,Rt=(0,k.C)(zt)},770145:(e,t,n)=>{"use strict";n.d(t,{cc:()=>N,PZ:()=>v,G4:()=>M});var i=n(850402),a=n(265858);const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"chatWithUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chatWithUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"memberIds"}}]}}]}}]},o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"sendMessage"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"message"}},type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"action"}},type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageAction"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendMessage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"message"},value:{kind:"Variable",name:{kind:"Name",value:"message"}}},{kind:"Argument",name:{kind:"Name",value:"action"},value:{kind:"Variable",name:{kind:"Name",value:"action"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var l=n(516909);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"fireCallingIntent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fireCallingIntent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntent"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var d=n(32552),c=n(50805),u=n(419925),p=n(955105),m=n(814423),g=n(711676);const M=(e,t,n)=>{const{enableCentralizedCommandingForEV:i}=(0,m.NC)(c.J.Host),{enablePlatformNavigationForBots:r}=(0,m.NC)(c.J.Extensibility);return a.useMemo((()=>({sendMessage:T(t,n),startChat:v(e,t,!!r,n),startCall:I(e,t,n,!!i)})),[e,t,n,i,r])},N=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{data:n}=yield e.query({query:r,variables:{userId:t},fetchPolicy:"network-only"});return null==n?void 0:n.chatWithUser})),T=(e,t)=>(n,a,r)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{const t=yield N(e,n);if(!t)throw new Error(`Could not fetch the user conversation using the mri ${n}`);const i={convId:t.id,message:{content:a,clientMessageId:(0,d.K)()},action:l.xyM.Create};yield e.mutate({mutation:o,variables:i}),r.stop()}catch(e){const i=`Error while sending quick message with mri ${n}`;t.error(i),null==r||r.fail({message:i})}})),v=(e,t,n,a)=>(r,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{if(!r)throw new Error("No mri provided");const i=yield N(t,r);if(i&&i.id){(0,g.bl)(r)&&n?e.platform.platformTabById(JSON.stringify({appId:r,threadId:i.id,tabEntityId:"conversations"}),{stateTransition:u.su.new,visibilityState:u.fe.show,correlation:{source:p.D.AppProfileCard}}):e.chat.chatById(i.id,{entityCommand:{stateTransition:u.su.new,visibilityState:u.fe.show,correlation:{source:p.D.AppProfileCard}}})}else e.chat.chatWithUsers({userIds:[r],entityCommand:{stateTransition:u.su.new,visibilityState:u.fe.show,correlation:{source:p.D.AppProfileCard}}});null==o||o.stop()}catch(e){const t=`Error while we execute start chat with mri ${r}`;null==a||a.error(t),null==o||o.fail({message:t})}})),I=(e,t,n,a)=>(r,o,d)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{if(!r)throw new Error(`Could not get the user mri ${r} from the persona identifier `);const n=((e,t,n=!1)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const a={callingIntent:{type:l.GXC.OneToOneCall,joinOptions:{outgoingVideo:n,outgoingAudio:!0,oneToOne:{sharingSourceId:void 0}},coordinates:{oneToOne:{mri:t}}}},{data:r}=yield e.mutate({mutation:s,variables:a});return null===(i=null==r?void 0:r.fireCallingIntent)||void 0===i?void 0:i.id})))(t,r,o),c=N(t,r),[m,g]=yield Promise.all([n,c]);if(!m)throw new Error(`Could not fetch the user calling IntentId using the mri ${r}`);const M=null==g?void 0:g.id;a||e.call.callById(m,{stateTransition:u.su.new,visibilityState:u.fe.show,correlation:{source:p.D.AppProfileCard}},M),d.stop()}catch(e){const t=`Error while StartCall using the mri ${r}`;n.error(t),d.fail({message:t})}}))},136209:(e,t,n)=>{"use strict";var i,a,r;n.d(t,{tS:()=>i,$D:()=>a,xB:()=>r}),function(e){e[e.User=0]="User",e[e.Group=1]="Group",e[e.Team=2]="Team",e[e.MsaUser=3]="MsaUser",e[e.MsaGroup=4]="MsaGroup",e[e.Bot=5]="Bot",e[e.Unknown=6]="Unknown",e[e.TFLOffNetwork=7]="TFLOffNetwork",e[e.TFLSMSUnverified=8]="TFLSMSUnverified",e[e.Initials=9]="Initials",e[e.MergedGroup=10]="MergedGroup",e[e.Connector=11]="Connector",e[e.OutgoingWebhook=12]="OutgoingWebhook",e[e.VoiceApp=13]="VoiceApp",e[e.App=14]="App",e[e.Mail=15]="Mail",e[e.Pstn=16]="Pstn",e[e.SharedChannelInviteeTeam=17]="SharedChannelInviteeTeam",e[e.Communities=18]="Communities",e[e.Simple=19]="Simple",e[e.SubCommunity=20]="SubCommunity"}(i||(i={})),function(e){e.Large="HR196x196",e.Medium="HR96x96",e.Small="HR64x64",e.XMedium="HR120x120",e.XSmall="HR32x32"}(a||(a={})),function(e){e.Icon="icon",e.Url="url",e.Name="name",e.Label="label"}(r||(r={}))},647231:(e,t,n)=>{"use strict";n.d(t,{HA:()=>u,oG:()=>M,B4:()=>T,sB:()=>I,WJ:()=>y,AZ:()=>A,Gt:()=>D,NO:()=>C,sq:()=>b,LA:()=>f,vn:()=>k});var i=n(136209),a=n(711676),r=n(760005),o=n(308292),l=n(451567),s=n(982346),d=n(205480),c=n(522067);const u=(e,t,n,r,o,s,d,c,u)=>{let m=i.tS.Unknown;const M=S(u);return c&&n?m=i.tS.SharedChannelInviteeTeam:!r&&n?m=i.tS.Team:s?m=i.tS.App:d?m=i.tS.Mail:o?m=i.tS.MergedGroup:M||e&&(0,a.y)(e)||(0,a.Cq)(e)?m=i.tS.Initials:v(e)?m=i.tS.Connector:e&&(0,a.YQ)(e)?m=i.tS.OutgoingWebhook:T(e)?m=i.tS.VoiceApp:N(e)?m=i.tS.Bot:l.eo.isTFLOffNetworkUser(e)?m=i.tS.TFLOffNetwork:l.eo.isTFLSmsUnVerifiedMri(e)?m=i.tS.TFLSMSUnverified:e&&(0,a.EG)(e)?m=i.tS.Pstn:r?m=p(m,e,t,n):r||(m=g(m,e,u)),m},p=(e,t,n,a)=>(t?e=i.tS.MsaUser:n?e=i.tS.MsaGroup:a&&(e=i.tS.Communities),e),m=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,g=(e,t,n)=>{const r=((0,a.lp)(t)||t&&m.test(t.toLowerCase()))&&!Array.isArray(n),o=!(0,a.lp)(t)&&Array.isArray(n);return r||o?e=t?i.tS.User:i.tS.Group:e},M=e=>{var t;const n=null===(t=null==e?void 0:e.type)||void 0===t?void 0:t.toUpperCase(),i=null==e?void 0:e.id;return n===s.t.botType||N(i)},N=e=>!!e&&e.startsWith(r.at.BotPrefix),T=e=>!!e&&(0,a.B4)(e,r.f0),v=e=>!!e&&e.startsWith(r.kR),I=(e,t)=>!!e&&(e===t.audienceBotId||e===t.largeGridBotId),y=(e,t,n)=>{if(t)return n?o.Rq:o.WW;switch(e){case i.tS.Mail:return o.SX;case i.tS.App:case i.tS.Connector:case i.tS.Bot:case i.tS.OutgoingWebhook:return o.zD;case i.tS.User:case i.tS.MsaUser:case i.tS.Initials:case i.tS.Unknown:return o.zw;case i.tS.Group:case i.tS.MsaGroup:case i.tS.MergedGroup:case i.tS.Team:case i.tS.Communities:case i.tS.SubCommunity:return o.dA;case i.tS.TFLOffNetwork:case i.tS.TFLSMSUnverified:return o.uj;case i.tS.VoiceApp:return o.dH;case i.tS.Pstn:return o.Az;default:return o.zw}},A=e=>-1!==(null==e?void 0:e.indexOf("profilePictureV2ForSharedChannel")),D=(e,t,n)=>!(!e||e&&(0,d.zP)(t))&&(void 0===n||n),C=(e,t)=>e?c.cU:t?c.YP:c.W9,b=(e,t,n)=>e&&(null==t?void 0:t.id)===e.id&&n===e.id&&"avatar"===e.updateType?e.updatedTime:void 0,h=new Map([["smallest",20],["smaller",24],["small",28],["medium",32],["medium-large",36],["large",48],["larger",64],["largest",96]]),f=e=>e&&h.get(e)||32,k=(e,t,n)=>{if(n&&e)try{const n=new URL(e);if("https:"!==n.protocol)return e;const a=n.searchParams.get("size"),r=t||i.$D.Small;return null!==a&&a!==r?e.replace(`size=${a}`,`size=${r}`):e}catch(t){return e}return e},S=e=>!!(null==e?void 0:e.isInitialsImage)},392355:(e,t,n)=>{"use strict";n.d(t,{mw:()=>Te});var i=n(850402),a=n(265858),r=n(915929),o=n(613829),l=n(27220),s=n(505160),d=n(341395),c=n(919876),u=n(516909),p=n(136209),m=n(318198),g=n(427662),M=n(814423),N=n(50805);const T=e=>{const{hexagonal:t}=e,n=(0,i.__rest)(e,["hexagonal"]);if(t){const e=(e,t)=>{const{"aria-label":r,src:o}=t,l=(0,i.__rest)(t,["aria-label","src"]);return a.createElement("svg",{viewBox:"0 0 34 34",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"100%"},a.createElement("title",null,n.name||l.alt||""),a.createElement("rect",{fill:"transparent",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px"}),a.createElement(e,Object.assign({as:"image",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px",xlinkHref:o,"aria-label":r||n.name||l.alt||""},l)))};return a.createElement(s.q,Object.assign({},n,{image:Object.assign(Object.assign({},"object"==typeof n.image&&n.image),{children:e})}))}return a.createElement(s.q,Object.assign({},n))};T.displayName="CustomAvatar";const v=T;var I=n(759873),y=n(799894),A=n(554694),D=n(738646),C=n(830887),b=n(365076),h=n(734625),f=n(606395);const k=(0,f.s)({transparent:{sj55zd:"f44pa96",De3pzq:"f3rmtva",Bic5iru:"f1pspie5"}},{d:[".f44pa96{color:transparent;}",".f3rmtva{background-color:transparent;}",".f1pspie5::before{color:transparent;}"]}),S=({badge:e,name:t,size:n,src:r,className:o,setShouldFallbackToDefault:l,setBlobUrl:s,enableFetchApiForBotAvatar:d,setError:c,error:p})=>{const m=k(),M=(0,b.x)(),N=(0,A.w)("custom-avatar-v9"),{scenarioFactory:T}=(0,g.SE)();let v=T.findScenario(D.RG.ExtBotAvatar);v||(v=T.newScenario(D.RG.ExtBotAvatar),v.appendEventData({"App.Name":t}));const f=(e,t)=>{var n;null==v||v.mark(D.ck.ExtBotAvatarFetchApi,{errors:null!=t?t:""},e),"failure"===e&&(null===(n=N.errorToTelemetry)||void 0===n||n.call(N,"CustomAvatarV9:: bot avatar did not load properly, rendering fallback","platform_bot_avatar_error"),l&&l(!0),c&&c(!0))};return a.createElement(a.Fragment,null,a.createElement(I.q,{badge:e,className:(0,y.z)(m.transparent,o),icon:{children:()=>a.createElement("svg",{viewBox:"0 0 34 34",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"100%"},a.createElement("title",null,""),a.createElement("rect",{fill:"transparent",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px"}),a.createElement("image",{clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px",xlinkHref:r}))},initials:null,name:t,size:n,onError:()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;try{if(d)if(r&&(0,h.$O)(r)){const n=yield(0,C.H)(M,r,u.R0O.Url,!0);if(null===(e=n.result)||void 0===e?void 0:e.blob)s&&s(n.result.blob),f("success");else{f("failure",`CustomAvatarV9:: amsDownload did not return a blob for app: ${t}`)}}else{f("failure",`CustomAvatarV9:: non-AMS image did not load properly for app: ${t}`)}else l&&l(!0)}catch(e){f("failure",`CustomAvatarv9:: Failed to load bot avatar for app: ${t}`)}})),onLoad:()=>{p?null==v||v.fail():null==v||v.stop()}}))};S.displayName="CustomAvatarV9";const U=a.createElement("svg",{xmlns:"http://w3.org/2000/svg",style:{width:0,height:0,position:"absolute"}},a.createElement("defs",{role:"presentation"},a.createElement("clipPath",{id:"bot-hexagon-clip-path"},a.createElement("path",{d:"M23.93,2H10.07C9,2,8.01,2.57,7.47,3.5l-6.92,12c-0.54,0.93-0.54,2.07,0,3l6.93,12c0.54,0.93,1.53,1.5,2.6,1.5h13.85c1.07,0,2.06-0.57,2.6-1.5l6.93-12c0.54-0.93,0.54-2.07,0-3l-6.93-12C25.99,2.57,25,2,23.93,2z"})))),E=e=>{var t;const{host:n}=(0,g.SE)(),{enableFluentV9Avatar:i}=(0,M.NC)(N.J.People,["enableFluentV9Avatar"]),{enableFetchApiForBotAvatar:r}=(0,M.NC)(N.J.Extensibility,["enableFetchApiForBotAvatar"]),o=(e=>{const t="bot-hexagon-clip-path-container";let n=e.document.body.querySelector(`[id='${t}']`);return n||(n=e.document.createElement("div"),n.id=t,e.document.body.insertBefore(n,e.document.body.childNodes[0])),n})(n),[l,s]=a.useState(!1),[d,c]=a.useState(""),[u,p]=a.useState(!1);return a.useEffect((()=>{o.hasChildNodes()||m.render(U,o)}),[o]),i?a.createElement(S,Object.assign({src:d&&r?d:l?"data:image/png;base64,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":null===(t=e.commonImgAttributes)||void 0===t?void 0:t.src,badge:e.badgeProps,size:"number"==typeof e.size?e.size:void 0,setShouldFallbackToDefault:s,setBlobUrl:c,enableFetchApiForBotAvatar:!!r,error:u,setError:p},e)):a.createElement(v,Object.assign({hexagonal:!0},e))};E.displayName="HexagonalAvatar";const j=E;var L=n(419925),O=n(955105),F=n(711676),x=n(647231);var w=n(367553);const z=(0,f.s)({teamAvatarBorder:{Bbmb7ep:["f1aa9q02","f16jpd5f"],Beyfa6y:["f16jpd5f","f1aa9q02"],B7oj6ja:["f1jar5jt","fyu767a"],Btl43ni:["fyu767a","f1jar5jt"]},teamHighContrastAvatarBorder:{icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],g2u3we:"fdli2b0",h3c5rm:["fewyrie","f5umq98"],B9xav0g:"fp6s13d",zhjwy3:["f5umq98","fewyrie"],B4j52fo:"ftac7j7",Bekrc4i:["f1w0yd9v","f1h0xgbp"],Bn0qgzm:"fdwcyh7",ibv6hh:["f1h0xgbp","f1w0yd9v"]}},{d:[".f1aa9q02{border-bottom-right-radius:var(--borderRadiusMedium);}",".f16jpd5f{border-bottom-left-radius:var(--borderRadiusMedium);}",".f1jar5jt{border-top-right-radius:var(--borderRadiusMedium);}",".fyu767a{border-top-left-radius:var(--borderRadiusMedium);}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".fdli2b0{border-top-color:white;}",".fewyrie{border-right-color:white;}",".f5umq98{border-left-color:white;}",".fp6s13d{border-bottom-color:white;}",".ftac7j7{border-top-width:2px;}",".f1w0yd9v{border-right-width:2px;}",".f1h0xgbp{border-left-width:2px;}",".fdwcyh7{border-bottom-width:2px;}"]});var V=n(90911),Q=n(263662);const R=(0,f.s)({avatarObjectFit:{st4lth:"f1ps3kmd"},avatarEmojiObjectFit:{st4lth:"f1plgu50"}},{d:[".f1ps3kmd{object-fit:cover;}",".f1plgu50{object-fit:none;}"]}),P=a.memo((e=>{var{simpleAvatarType:t}=e,n=(0,i.__rest)(e,["simpleAvatarType"]);const{enableFluentV9Avatar:r}=(0,M.NC)(N.J.People);return t?a.createElement(ne,Object.assign({enableFluentV9Avatar:!!r,simpleAvatarType:t},n)):a.createElement(B,Object.assign({},n))}));P.displayName="AvatarRenderer";const B=e=>{var{accessibilityLabel:t,alt:n,presenceUserId:r,profilePictureType:o,presenceSource:l,isPresencePrefetched:s,isEmergencyCallTarget:d,shouldAllowContextMenu:c,isFocusable:u,hexagonal:m,square:T,userId:v,isDoubleClickDisabled:I,narrateProfilePicture:C,callerInfo:b,statusSize:h,sharedChannelTelemetryInfo:f,draggable:k,isTeamHeaderEmblemExpanded:S,hidePersonaCard:U,v9ClassName:E,role:j,avatarUrl:L,cacheKey:O,isEmojiAvatar:F=!1}=e,x=(0,i.__rest)(e,["accessibilityLabel","alt","presenceUserId","profilePictureType","presenceSource","isPresencePrefetched","isEmergencyCallTarget","shouldAllowContextMenu","isFocusable","hexagonal","square","userId","isDoubleClickDisabled","narrateProfilePicture","callerInfo","statusSize","sharedChannelTelemetryInfo","draggable","isTeamHeaderEmblemExpanded","hidePersonaCard","v9ClassName","role","avatarUrl","cacheKey","isEmojiAvatar"]);const P=(0,A.w)("AvatarRenderer"),{isOnline:B}=(0,g.cJ)(),{themeType:W}=(0,V.LV)(),{msgEnableSelfChat:$}=(0,M.NC)(N.J.Host),[te,ne]=a.useState(!1),[ie,ae]=a.useState(L),[re,oe]=a.useState(!1),[le,se]=a.useState(!1),{entityCommanding:de,user:ce,scenarioFactory:ue,avatarImageCache:pe}=(0,g.SE)(),{allowUserChat:me,enableChatActionFromAvatar:ge}=(0,M.NC)(N.J.Messaging),Me=J(C,t),{enableFluentV9Avatar:Ne,enableFailedAvatarReloadOnNetworkReconnect:Te,enableFBSTelemetryForAvatarStatus:ve}=(0,M.NC)(N.J.People),Ie=a.useCallback((e=>{ne(e.isError),ae(e.currentUrl),oe(e.shouldReload)}),[]),ye=a.useRef(null),Ae=R(),De=(()=>{const{host:e}=(0,g.SE)(),{avatarDoubleClickDelayInMs:t}=(0,M.NC)(N.J.People),n=a.useRef(null),i=t||0,r=e=>{o(),null!==e&&null!==e.current&&e.current.dispatchEvent(new MouseEvent("click",{bubbles:!0}))},o=()=>{n.current&&e.clearTimeout(n.current),n.current=null};return a.useEffect((()=>()=>{n.current&&(e.clearTimeout(n.current),n.current=null)}),[e,n]),(t,a,l,s)=>{i>0&&!l?(t.preventDefault(),t.stopPropagation(),n.current?o():n.current=e.setTimeout((()=>{r(a),s&&s(t)}),i)):s&&s(t)}})(),Ce=z(),be=(0,y.z)((o===p.tS.Team||T)&&Ce.teamAvatarBorder,W===Q.f8.Contrast&&Ce.teamHighContrastAvatarBorder,E),he=ee(!!Te,te,B,re,L,o,d),fe=_(o,u,T),ke=Object.assign(Object.assign({},x.variables),fe),Se={callerInfo:b||"Not available",profilePictureType:o,imageUrl:he,isEmergencyCallTarget:d,logger:P,scenarioFactory:ue,avatarState:{currentUrl:ie,isError:te,shouldReload:re},isOnline:B,setAvatarState:Ie,sharedChannelTelemetryInfo:f},Ue=Ne?void 0:G(r,l,s,h),Ee=ve?ue.newScenario(D.RG.AvatarStatus):void 0,{onClick:je,onKeyDown:Le,onMouseEnter:Oe,onMouseLeave:Fe}=(0,w.z)({userId:v}),xe=!!m,we=Object.assign(Object.assign(Object.assign({},Z(!!u,he,n,k,t,F&&le?Ae.avatarEmojiObjectFit:Ae.avatarObjectFit)),{onError:e=>{q(Se,Ee)},onLoad:e=>{(e=>{try{const t=new URL(e);if("https:"!==t.protocol)return!1;const n=t.searchParams.get("size");if(null!==n&&n!==p.$D.Small)return!1}catch(e){return!1}return!0})(he)&&(null==pe||pe.add(O||he,he)),F&&se(!0),K(Se,Ee)},onContextMenu:e=>H(e,c),onDoubleClick:()=>X(I,me,ge,v,o,ce,de,$),onClickCapture:e=>De(e,ye,I,je)}),!U&&!xe&&{onKeyDown:Le,onMouseEnter:Oe,onMouseLeave:Fe}),ze=Object.assign({root:{isTeamHeaderEmblemExpanded:S},image:Object.assign(Object.assign(Object.assign({},Me),we),{variables:ke}),status:Ue?Object.assign(Object.assign({},Ue),{variables:ke}):Ue},x),Ve=ze["data-tid"],Qe=Me["aria-label"];return Y(r,l,ze,we,ye,be,fe,m,!!Ne,Ve,j,!!u,Qe)};B.displayName="AvatarRendererInner";const W=({hexagonal:e,presenceUserId:t,presenceSource:n,avatarRef:i,commonImgAttributes:r,v9AllStyles:o,dataTid:l,size:s,ariaLabel:d})=>{const u=(0,c.bE)(t,n);return e?a.createElement(j,{"aria-label":d,badgeProps:u,commonImgAttributes:r,className:o,size:(0,x.LA)(s)}):a.createElement(I.q,{"aria-label":d,badge:u,"data-tid":l,image:Object.assign({},r),ref:i,className:o,size:(0,x.LA)(s)})},Z=(e,t,n,i,a,r)=>Object.assign(Object.assign({alt:n,src:t,draggable:i},e&&{"data-is-focusable":!0,"aria-haspopup":!0,"aria-hidden":!1,"aria-label":a,tabIndex:0}),{className:r}),Y=(e,t,n,i,r,o,l,d,c,p,m,g,M)=>{const N=d?j:s.q;return a.createElement(a.Fragment,null,c?a.createElement(a.Fragment,null,e?a.createElement(W,{hexagonal:!!d,presenceUserId:e,presenceSource:t||u.W8Z.ups,avatarRef:r,commonImgAttributes:Object.assign(Object.assign({},i),{role:m||(g?"img":"presentation")}),v9AllStyles:o,dataTid:p,ariaLabel:M,size:null==n?void 0:n.size}):a.createElement(a.Fragment,null,d?a.createElement(j,{commonImgAttributes:i,className:o,size:(0,x.LA)(null==n?void 0:n.size)}):a.createElement(I.q,{"data-tid":p,image:Object.assign({},i),ref:r,className:o,size:(0,x.LA)(null==n?void 0:n.size),role:m||(g?"img":"presentation")}))):a.createElement(N,Object.assign({},n,{variables:Object.assign(Object.assign({},null==n?void 0:n.variables),l),ref:r})))},G=(e,t,n,i)=>e?{children:(r,o)=>{const l=i?{size:i}:{};return a.createElement(c.Rq,Object.assign({userId:e,ProvidedStatus:r,presenceSource:t,isPresencePrefetched:n},o,l))}}:void 0,J=(e,t)=>{const n={};return"boolean"==typeof e&&(n["aria-hidden"]=!e),t&&(n["aria-label"]=t),n},H=(e,t)=>{t||(e.preventDefault(),e.stopPropagation())},X=(e,t,n,a,r,o,l,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){!e&&t&&n&&a&&!(0,F.y)(a)&&r===p.tS.User&&(s||(null==o?void 0:o.id)!==a)&&(yield l.chat.chatWithUsers({userIds:[a],entityCommand:{stateTransition:L.su.new,visibilityState:L.fe.show,correlation:{source:O.D.Avatar}}}))})),_=(e,t,n)=>Object.assign(Object.assign({},(e===p.tS.Team||n)&&{isTeamProfilePicture:!0}),t&&{hasCursorPointer:!0}),K=(e,t)=>{e.avatarState.isError?e.isOnline&&e.avatarState.shouldReload?e.setAvatarState(Object.assign(Object.assign({},e.avatarState),{isError:!1,shouldReload:!1})):e.logger.debug("Avatar onLoad. Returning without triggering state change."):(t&&t.stop({caller:e.callerInfo,numericType:e.profilePictureType,sharedChannelTelemetryInfo:e.sharedChannelTelemetryInfo}),e.setAvatarState(Object.assign(Object.assign({},e.avatarState),{isError:!1})))},q=(e,t)=>e.avatarState.isError?e.avatarState.shouldReload?void e.setAvatarState({currentUrl:(0,x.WJ)(e.profilePictureType,e.isEmergencyCallTarget),isError:!0,shouldReload:!1}):(e.logger.debug("Avatar onError. Returning without triggering state change"),!1):(e.logger.warn("Avatar load failed. Handling onError by setting currentUrl in state to default image."),$(e,t),e.setAvatarState({currentUrl:"",isError:!0,shouldReload:!e.isOnline}),!1),$=(e,t)=>{const n={caller:e.callerInfo,numericType:e.profilePictureType,sharedChannelTelemetryInfo:e.sharedChannelTelemetryInfo};if(te(e.imageUrl))return void(null==t||t.cancel(n));(t||e.scenarioFactory.newScenario(D.RG.AvatarStatus)).stop(n,"failure")},ee=(e,t,n,i,a,r,o)=>{let l=a;if(t&&(!e||!n||!i)){l=(0,x.WJ)(r,o)}return l},te=e=>{const t=(e=>{const t=new URLSearchParams(e.slice(e.indexOf("?")));return t.get("displayName")||t.get("displayname")||""})(e);return/^[^\p{Letter}]/u.test(t)},ne=e=>{var{simpleAvatarType:t,enableFluentV9Avatar:n}=e,r=(0,i.__rest)(e,["simpleAvatarType","enableFluentV9Avatar"]);if(n)return a.createElement(I.q,Object.assign({className:r.v9ClassName,size:(0,x.LA)(r.size)},r.label&&{initials:{children:a.createElement(a.Fragment,null,r.label)}},r.v9Icon&&{icon:r.v9Icon},r.name&&{name:r.name},r.avatarUrl&&{image:{src:r.avatarUrl}}));{const{variables:e}=r;return a.createElement(s.q,Object.assign({variables:e,size:r.size},r.label&&{label:{children:a.createElement(a.Fragment,null,r.label)}},r.icon&&{icon:r.icon},r.name&&{name:r.name},r.avatarUrl&&{image:{src:r.avatarUrl}}))}};ne.displayName="SimpleAvatar";var ie=n(275742),ae=n(491821),re=n(665538);const oe={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"msaProfileAvatarChangedEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isSelfProfileAvatar"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaProfileAvatarChangedEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"isSelfProfileAvatar"},value:{kind:"Variable",name:{kind:"Name",value:"isSelfProfileAvatar"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"updateType"}},{kind:"Field",name:{kind:"Name",value:"updatedTime"}}]}}]}}]};var le=n(898071),se=n(52704),de=n(243334),ce=n(466094),ue=n(111587);var pe=n(180637),me=n(926045),ge=n(522067);const Me=[p.tS.User,p.tS.Group,p.tS.Team],Ne=(e,t=p.$D.Small,n,i,a,r,o,l)=>{const{avatarImageCache:s}=(0,g.SE)(),{enableAvatarUrlCacheLookup:d}=(0,M.NC)(N.J.ImageCache);if(!d||!s||l)return null;const c=(0,x.HA)(n,i,a,r,o||!1,void 0,void 0,void 0,e);if(!Me.includes(c))return null;const u=[t];if((e=>"id"in e&&!!e.id)(e))u.push("user"),u.push(e.id),u.push(e.displayName),u.push(e.imageUri);else if((e=>Array.isArray(e))(e)&&e.length>1)u.push("group"),u.push(e.map((e=>`${e.id}-${e.displayName}`)).slice(0,ge.Ww).join("-"));else{if(!(e=>"groupId"in e&&!!e.groupId)(e))return null;u.push("team"),u.push(e.groupId),u.push(e.displayName),u.push(e.pictureETag)}const m=u.filter(Boolean).join("-");return{cacheKey:m,cachedUrl:null==s?void 0:s.getUrl(m)}},Te=e=>{var{simpleAvatarType:t,avatarUrl:n}=e,r=(0,i.__rest)(e,["simpleAvatarType","avatarUrl"]);return t?a.createElement(P,Object.assign({simpleAvatarType:t,avatarUrl:n||"",profilePictureType:p.tS.Simple},r)):a.createElement(ve,Object.assign({avatarUrl:n},r))};Te.displayName="AvatarContainer";const ve=e=>{var t,{users:n,team:a,showPresence:r,hidePersonaCard:o,isFocusable:l,profilePictureSize:s,isEmergencyCallTarget:d,shouldAllowContextMenu:c,isDoubleClickDisabled:u,showDefaultAvatar:p,conversationId:m,hostTenantId:T,isSharedChannel:v,statusSize:I,connectorSenderGuid:y,onBehalfOfId:D,square:C,requesterObjectId:h,baseImageUrl:f,skipAvatarQuery:k,showMergedAvatarForGroup:S,showUpdatedGroupAvatar:U,role:E,avatarUrl:j}=e,L=(0,i.__rest)(e,["users","team","showPresence","hidePersonaCard","isFocusable","profilePictureSize","isEmergencyCallTarget","shouldAllowContextMenu","isDoubleClickDisabled","showDefaultAvatar","conversationId","hostTenantId","isSharedChannel","statusSize","connectorSenderGuid","onBehalfOfId","square","requesterObjectId","baseImageUrl","skipAvatarQuery","showMergedAvatarForGroup","showUpdatedGroupAvatar","role","avatarUrl"]);const O=(0,A.w)("AvataContainer"),F=((e,t)=>{if(!e&&t&&1===t.length&&t[0].id){const e=t[0].id;return e!==me.xw&&e!==me.HE}return!1})(a,n),w=F&&n?n[0].id:void 0,z=(e=>{const t=(0,A.w)("AvatarContainer"),n=(0,le.dL)(),i=(0,se.ii)(),a=(0,se.x2)(),r=(0,b.x)(),{user:o,authenticationUser:l,scenarioFactory:s}=(0,g.SE)(),d=!!(0,ue.WD)(de.nh.POST_CRITICAL),{customViewBots:c}=(0,M.NC)(N.J.Calling),u=!!(c&&c.length>0),p=(null==o?void 0:o.id)===e,m=(null==l?void 0:l.type)===ce.Ch.Anonymous,T=(null==l?void 0:l.type)===ce.Ch.Msa||(null==l?void 0:l.type)===ce.Ch.MsaLife,v=null==l?void 0:l.id,{enableMSAProfilePicture:I,enableMsaSelfProfileAvatarUpdateSubscription:y,enableCachedAvatarCheck:D,enableProfilePicturesWithObjectId:C,enableSampleAvatarFetch:h,enableAvatarUrlQuery:f,enableFBSTelemetryForAvatarStatus:k}=(0,M.NC)(N.J.People),{enableConnectorsProfileInChannels:S}=(0,M.NC)(N.J.Extensibility);return{appPhaseAtLeastPostCritical:d,baseImageUrl:i||"",canSubscribeForAvatarUpdate:p&&!!y,client:r,customViewBots:c||[],enableCachedAvatarCheck:!!D,enableConnectorsProfileInChannels:!!S,enableMSAProfilePicture:!!I,enableMsaSelfProfileAvatarUpdateSubscription:!!y,enableFBSTelemetryForAvatarStatus:!!k,i18n:n,isAnonymousAccount:m,isCustomViewBots:u,isImageAuthCookieValid:a,isSelfProfileAvatar:p,isTflUser:T,logger:t,user:o,scenarioFactory:s,currentUserOid:v,isProfilePictureWithObjectIdEnabled:!!C,enableSampleAvatarFetch:!!h,enableAvatarUrlQuery:!!f}})(w),{appPhaseAtLeastPostCritical:V,user:Q}=z,R=(e=>{const t=(0,A.w)("MsaProfileAvatarSubscription"),{data:n,loading:i,error:a}=(0,re.m)(oe,{skip:!e,variables:{isSelfProfileAvatar:e}});return(a||!i&&!n&&e)&&t.error("msa profile avatar subscription failed"),null==n?void 0:n.msaProfileAvatarChangedEvent})(!!z.canSubscribeForAvatarUpdate),P=(0,x.sq)(R,Q,w),B=Ie(F,a,n),W=(0,x.NO)(a,F);z.currentUserOid=h||z.currentUserOid,z.baseImageUrl=f||z.baseImageUrl;const Z=(0,x.vn)(j||(null===(t=null==n?void 0:n[0])||void 0===t?void 0:t.avatarUrl),s,F),Y=(null==a?void 0:a.groupId)||(null==a?void 0:a.teamThreadId),{cacheKey:G,cachedUrl:J}=Ne(B,s,w,m,Y,z.enableMSAProfilePicture,S,z.isSelfProfileAvatar)||{};k&&O.log(`Generating URL via hook is skipped for caller: ${L.callerInfo}`);const H=Object.assign({userId:w,conversationId:m,teamId:Y,entity:B,profilePictureSize:s,isEmergencyCallTarget:d,generator:W,isSharedChannel:v,hostTenantId:T,avatarEtag:P,showMergedAvatarForGroup:S,showUpdatedGroupAvatar:U,onBehalfOfId:D,skipAvatarQuery:k||!!Z||!!J},z),X=(0,ae.Ou)(H,L.callerInfo),{customViewBots:_,isCustomViewBots:K}=z,q=K?_[0]:{},$=!!w&&(0,x.Gt)(F,w,r),ee=V&&$?W.getPresenceUserId(B):void 0,te=Ae(F,n);return ye(Object.assign({accessibilityLabel:L.accessibilityLabel,generator:W,hidePersonaCard:o,isEmergencyCallTarget:d,isFocusable:l,presenceUserId:ee,role:E,shouldAllowContextMenu:c,userId:w,customViewBotIds:q,isDoubleClickDisabled:u,statusSize:I,conversationId:m,hostTenantId:T,isSharedChannel:v,avatarUrl:Z||J||X,draggable:!1,isTflUser:z.isTflUser,connectorSenderGuid:y,onBehalfOfId:D,displayName:te,square:C,isBotAvatar:(0,x.oG)(F?null==n?void 0:n[0]:void 0),cacheKey:G},L))};ve.displayName="AvatarContainerInner";const Ie=(e,t,n)=>t||(n?e?n[0]:n:[]),ye=e=>{var{accessibilityLabel:t,avatarUrl:n,generator:c,hidePersonaCard:u,isEmergencyCallTarget:p,isFocusable:m,presenceUserId:g,role:T,shouldAllowContextMenu:v,userId:I,customViewBotIds:y,isDoubleClickDisabled:A,statusSize:D,isSharedChannel:C,conversationId:b,hostTenantId:h,draggable:f,isTflUser:k,connectorSenderGuid:S,onBehalfOfId:U,displayName:E,isBotAvatar:j,square:L,cacheKey:O}=e,F=(0,i.__rest)(e,["accessibilityLabel","avatarUrl","generator","hidePersonaCard","isEmergencyCallTarget","isFocusable","presenceUserId","role","shouldAllowContextMenu","userId","customViewBotIds","isDoubleClickDisabled","statusSize","isSharedChannel","conversationId","hostTenantId","draggable","isTflUser","connectorSenderGuid","onBehalfOfId","displayName","isBotAvatar","square","cacheKey"]);const{vars:w}=(0,l.L)(),z=Array.isArray(F.variables)?F.variables:[],V=a.useMemo((()=>(0,r.v4)()),[]),{enableEntityMoreInfo:Q}=(0,M.NC)(N.J.Core,["enableEntityMoreInfo"]);if(F.isMeetingChat)return a.createElement(s.q,{icon:a.createElement(d.Q,{circular:!0,outline:!0}),variables:w("search",(0,ie.merge)(["meetingChatAvatar"],z))});const R=a.createElement(P,Object.assign({accessibilityLabel:t,presenceUserId:g,profilePictureType:c.profilePictureType,role:T||(m?"button":"presentation"),shouldAllowContextMenu:v,isEmergencyCallTarget:p,isFocusable:m,hexagonal:!L&&j&&!(0,x.sB)(I,y),square:L,userId:I,isDoubleClickDisabled:j&&k||A,statusSize:D,avatarUrl:n,draggable:f,sharedChannelTelemetryInfo:{isXtapUserUrl:(0,x.AZ)(n),isSharedChannel:C},hidePersonaCard:u,cacheKey:O},F)),B=u||Q||!I?R:a.createElement(pe.Im,{userId:I,key:I,isSharedChannel:C,hostConversationId:b,hostTenantId:h,disableAccessibilityDefaults:!0,externalAppSessionCorrelationId:V,displayName:E,callerInfo:F.callerInfo,"data-tid":"avatar"},R);return u||!I||!(0,x.B4)(I)&&j?!u&&I&&j?a.createElement(o.W_,{botIdOrAppId:I,key:I,connectorSenderGuid:S,conversationId:b,onBehalfOfId:U,displayName:E,renderTriggerAsLink:!1,nonFocusableTrigger:!0},R):R:B},Ae=(e,t)=>{var n,i;return e&&(null===(n=null==t?void 0:t[0])||void 0===n?void 0:n.displayName)?null===(i=t[0])||void 0===i?void 0:i.displayName:void 0}},308292:(e,t,n)=>{"use strict";n.d(t,{zw:()=>i,dA:()=>a,P7:()=>r,Az:()=>o,dH:()=>l,SX:()=>s,WW:()=>d,Rq:()=>c,uj:()=>u,zD:()=>p,ap:()=>m,Uw:()=>g});const i="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9IiM5NDk0OTQiIHg9Ii02IiB5PSItNiIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSI+PC9yZWN0PjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMCAyQzcuNzkwODYgMiA2IDMuNzkwODYgNiA2QzYgOC4yMDkxNCA3Ljc5MDg2IDEwIDEwIDEwQzEyLjIwOTEgMTAgMTQgOC4yMDkxNCAxNCA2QzE0IDMuNzkwODYgMTIuMjA5MSAyIDEwIDJaTTcgNkM3IDQuMzQzMTUgOC4zNDMxNSAzIDEwIDNDMTEuNjU2OSAzIDEzIDQuMzQzMTUgMTMgNkMxMyA3LjY1Njg1IDExLjY1NjkgOSAxMCA5QzguMzQzMTUgOSA3IDcuNjU2ODUgNyA2Wk01LjAwODczIDExQzMuOTAzMTUgMTEgMyAxMS44ODY5IDMgMTNDMyAxNC42OTEyIDMuODMyODEgMTUuOTY2MyA1LjEzNDk5IDE2Ljc5NjZDNi40MTY5NyAxNy42MTQgOC4xNDUyNiAxOCAxMCAxOEMxMS44NTQ3IDE4IDEzLjU4MyAxNy42MTQgMTQuODY1IDE2Ljc5NjZDMTYuMTY3MiAxNS45NjYzIDE3IDE0LjY5MTIgMTcgMTNDMTcgMTEuODk1NiAxNi4xMDQ1IDExIDE1IDExTDUuMDA4NzMgMTFaTTQgMTNDNCAxMi40NDY3IDQuNDQ3ODYgMTIgNS4wMDg3MyAxMkwxNSAxMkMxNS41NTIyIDEyIDE2IDEyLjQ0NzggMTYgMTNDMTYgMTQuMzA4OCAxNS4zNzc3IDE1LjI4MzcgMTQuMzI3NCAxNS45NTM0QzEzLjI1NjggMTYuNjM2IDExLjczNTEgMTcgMTAgMTdDOC4yNjQ4OSAxNyA2Ljc0MzE4IDE2LjYzNiA1LjY3MjYyIDE1Ljk1MzRDNC42MjIyNiAxNS4yODM3IDQgMTQuMzA4OCA0IDEzWiIvPjwvc3ZnPg==",a="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9IiM5NDk0OTQiIHg9Ii02IiB5PSItNiIgaGVpZ2h0PSIxMDAlIiB3aWR0aD0iMTAwJSIvPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMi40NzQ3IDguMDE0MzFDMTIuOTg3NiA4LjAxNDMxIDEzLjQxMDIgOC40MDAzNSAxMy40NjggOC44OTc2OUwxMy40NzQ3IDkuMDE0MzFWMTMuMzgxN0MxMy40NzQ3IDE1LjMwNiAxMS45MTQ4IDE2Ljg2NiA5Ljk5MDQ0IDE2Ljg2NkM4LjEzMDI3IDE2Ljg2NiA2LjYxMDU2IDE1LjQwODMgNi41MTEzMSAxMy41NzI4TDYuNTA2MTYgMTMuMzgxN1Y5LjAxNDMxQzYuNTA2MTYgOC41MDE0OCA2Ljg5MjIgOC4wNzg4IDcuMzg5NTQgOC4wMjEwNEw3LjUwNjE2IDguMDE0MzFIMTIuNDc0N1pNMTIuNDc0NyA5LjAxNDMxSDcuNTA2MTZWMTMuMzgxN0M3LjUwNjE2IDE0Ljc1MzcgOC42MTg0MSAxNS44NjYgOS45OTA0NCAxNS44NjZDMTEuMzA3NiAxNS44NjYgMTIuMzg1MyAxNC44NDA5IDEyLjQ2OTQgMTMuNTQ1TDEyLjQ3NDcgMTMuMzgxN1Y5LjAxNDMxWk01Ljc3NDA3IDguMDEzNzJDNS42MzIwOCA4LjI1ODk3IDUuNTQwNjkgOC41MzcxOCA1LjUxNDE3IDguODM0MDZMNS41MDYxNiA5LjAxNDMxSDMuMDE2ODVWMTIuNzUzNEMzLjAxNjg1IDEzLjc3ODYgMy44NDc5MyAxNC42MDk3IDQuODczMTIgMTQuNjA5N0M1LjE0NDMzIDE0LjYwOTcgNS40MDE5NiAxNC41NTE1IDUuNjM0MjEgMTQuNDQ3QzUuNzEzNDcgMTQuNzc1NiA1LjgzMDA1IDE1LjA5MDcgNS45Nzg1IDE1LjM4NzFDNS42Mzg4NyAxNS41MzA3IDUuMjY1MjIgMTUuNjA5NyA0Ljg3MzEyIDE1LjYwOTdDMy4zNTE5OCAxNS42MDk3IDIuMTA4NTcgMTQuNDIwNiAyLjAyMTY5IDEyLjkyMTJMMi4wMTY4NSAxMi43NTM0VjkuMDE0MzFDMi4wMTY4NSA4LjUwMTQ4IDIuNDAyODkgOC4wNzg4IDIuOTAwMjIgOC4wMjEwNEwzLjAxNjg1IDguMDE0MzFMNS43NzQwNyA4LjAxMzcyWk0xNC4yMDY4IDguMDEzNzJMMTYuOTkxMiA4LjAxNDMxQzE3LjUwNCA4LjAxNDMxIDE3LjkyNjcgOC40MDAzNSAxNy45ODQ0IDguODk3NjlMMTcuOTkxMiA5LjAxNDMxVjEyLjc1NDJDMTcuOTkxMiAxNC4zMzEyIDE2LjcxMjcgMTUuNjA5NyAxNS4xMzU3IDE1LjYwOTdDMTQuNzM0OCAxNS42MDk3IDE0LjM1MzIgMTUuNTI3MSAxNC4wMDY5IDE1LjM3NzlDMTQuMTU1MSAxNS4wODAzIDE0LjI3MDkgMTQuNzY0OCAxNC4zNTAzIDE0LjQzNTFDMTQuNTg4NyAxNC41NDczIDE0Ljg1NDkgMTQuNjA5NyAxNS4xMzU3IDE0LjYwOTdDMTYuMTExNiAxNC42MDk3IDE2LjkxMTYgMTMuODU2MiAxNi45ODU2IDEyLjg5OTJMMTYuOTkxMiAxMi43NTQyVjkuMDE0MzFIMTQuNDc0N0wxNC40NjkyIDguODY1MDVDMTQuNDQ2NSA4LjU1NjU0IDE0LjM1MzcgOC4yNjc0OSAxNC4yMDY4IDguMDEzNzJaTTkuOTg4NTcgMi45ODkyNkMxMS4yMTg3IDIuOTg5MjYgMTIuMjE1OSAzLjk4NjQ4IDEyLjIxNTkgNS4yMTY2MkMxMi4yMTU5IDYuNDQ2NzYgMTEuMjE4NyA3LjQ0Mzk4IDkuOTg4NTcgNy40NDM5OEM4Ljc1ODQzIDcuNDQzOTggNy43NjEyMSA2LjQ0Njc2IDcuNzYxMjEgNS4yMTY2MkM3Ljc2MTIxIDMuOTg2NDggOC43NTg0MyAyLjk4OTI2IDkuOTg4NTcgMi45ODkyNlpNMTQuOTc1NyAzLjYxNzM5QzE2LjAzMjQgMy42MTczOSAxNi44ODkgNC40NzQgMTYuODg5IDUuNTMwNjlDMTYuODg5IDYuNTg3MzcgMTYuMDMyNCA3LjQ0Mzk4IDE0Ljk3NTcgNy40NDM5OEMxMy45MTkxIDcuNDQzOTggMTMuMDYyNCA2LjU4NzM3IDEzLjA2MjQgNS41MzA2OUMxMy4wNjI0IDQuNDc0IDEzLjkxOTEgMy42MTczOSAxNC45NzU3IDMuNjE3MzlaTTUuMDE3MTcgMy42MTczOUM2LjA3Mzg2IDMuNjE3MzkgNi45MzA0NyA0LjQ3NCA2LjkzMDQ3IDUuNTMwNjlDNi45MzA0NyA2LjU4NzM3IDYuMDczODYgNy40NDM5OCA1LjAxNzE3IDcuNDQzOThDMy45NjA0OSA3LjQ0Mzk4IDMuMTAzODggNi41ODczNyAzLjEwMzg4IDUuNTMwNjlDMy4xMDM4OCA0LjQ3NCAzLjk2MDQ5IDMuNjE3MzkgNS4wMTcxNyAzLjYxNzM5Wk05Ljk4ODU3IDMuOTg5MjZDOS4zMTA3MiAzLjk4OTI2IDguNzYxMjEgNC41Mzg3NyA4Ljc2MTIxIDUuMjE2NjJDOC43NjEyMSA1Ljg5NDQ3IDkuMzEwNzIgNi40NDM5OCA5Ljk4ODU3IDYuNDQzOThDMTAuNjY2NCA2LjQ0Mzk4IDExLjIxNTkgNS44OTQ0NyAxMS4yMTU5IDUuMjE2NjJDMTEuMjE1OSA0LjUzODc3IDEwLjY2NjQgMy45ODkyNiA5Ljk4ODU3IDMuOTg5MjZaTTE0Ljk3NTcgNC42MTczOUMxNC40NzEzIDQuNjE3MzkgMTQuMDYyNCA1LjAyNjI5IDE0LjA2MjQgNS41MzA2OUMxNC4wNjI0IDYuMDM1MDkgMTQuNDcxMyA2LjQ0Mzk4IDE0Ljk3NTcgNi40NDM5OEMxNS40ODAxIDYuNDQzOTggMTUuODg5IDYuMDM1MDkgMTUuODg5IDUuNTMwNjlDMTUuODg5IDUuMDI2MjkgMTUuNDgwMSA0LjYxNzM5IDE0Ljk3NTcgNC42MTczOVpNNS4wMTcxNyA0LjYxNzM5QzQuNTEyNzcgNC42MTczOSA0LjEwMzg4IDUuMDI2MjkgNC4xMDM4OCA1LjUzMDY5QzQuMTAzODggNi4wMzUwOSA0LjUxMjc3IDYuNDQzOTggNS4wMTcxNyA2LjQ0Mzk4QzUuNTIxNTcgNi40NDM5OCA1LjkzMDQ3IDYuMDM1MDkgNS45MzA0NyA1LjUzMDY5QzUuOTMwNDcgNS4wMjYyOSA1LjUyMTU3IDQuNjE3MzkgNS4wMTcxNyA0LjYxNzM5WiIvPjwvc3ZnPg==",r="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iI0U4RUJGQSIgZD0iTTAgMzJWMGgzMnYzMkgwWiIvPjxwYXRoIGZpbGw9IiM0RjUyQjIiIGQ9Ik0xNS41IDEyLjUwMmEuNS41IDAgMSAxIDEgMHYxLjAwMmEuNS41IDAgMCAxLTEgMHYtMS4wMDJabTMuMzUuOTQxYS41LjUgMCAwIDAtLjcwNyAwbC0uNzA4LjcwOWEuNS41IDAgMCAwIC43MDcuNzA3bC43MDktLjcwOWEuNS41IDAgMCAwIDAtLjcwN1ptLTQuOTk4IDBhLjUuNSAwIDAgMC0uNzA3LjcwN2wuNzA4LjcwOWEuNS41IDAgMSAwIC43MDctLjcwN2wtLjcwOC0uNzA5Wk0xNiA4YzMuMzE0IDAgNiAyLjU5NyA2IDUuOCAwIDEuNjc3LS43NDUgMy4yMTYtMi4yMDQgNC41OTRhLjU5OS41OTkgMCAwIDAtLjE0NS4yMTNsLS4wMjYuMDgxLS45MzYgMy45MTdjLS4xODQuNzcxLS44NjUgMS4zMy0xLjY3IDEuMzlsLS4xNDQuMDA1aC0xLjc1Yy0uODE5IDAtMS41MzUtLjUxNi0xLjc3Ni0xLjI2MmwtLjAzOC0uMTMzLS45MzUtMy45MTZhLjU5Ni41OTYgMCAwIDAtLjE3LS4yOTVjLTEuMzktMS4zMTItMi4xMzMtMi43Ny0yLjItNC4zNTVMMTAgMTMuOGwuMDAzLS4xOTFDMTAuMTA4IDEwLjQ5NCAxMi43NTMgOCAxNiA4Wm0tMi4wNDUgMTMgLjMxOSAxLjMzNC4wMjYuMDk2Yy4wOTcuMy4zNzYuNTIyLjcxMi41NjNsLjExNC4wMDdoMS43MTJsLjEwNi0uMDAzYS44NTYuODU2IDAgMCAwIC43NDEtLjUyNWwuMDMyLS4xLjMyOC0xLjM3MmgtNC4wOVpNMTYgOWMtMi42MzIgMC00Ljc4OCAxLjk1My00Ljk4NSA0LjQxNGwtLjAxMi4yMTItLjAwMy4xNTMuMDA0LjIxN2MuMDU2IDEuMzA0LjY3NCAyLjUyNSAxLjg4OCAzLjY3MS4xODguMTc4LjMzLjM5OC40MTQuNjRsLjA0My4xNS4zNjcgMS41NDNIMTUuNXYtNC41MDNhLjUuNSAwIDEgMSAxIDBWMjBoMS43ODVsLjM4Ny0xLjYxNS4wNTEtLjE1Yy4wODYtLjIxNS4yMTgtLjQwOS4zODYtLjU2OEMyMC4zODIgMTYuNDY1IDIxIDE1LjE4IDIxIDEzLjhjMC0yLjY0My0yLjIzMS00LjgtNS00LjhaIi8+PC9zdmc+",o="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9Im1lZGl1bXR1cnF1b2lzZSIgeD0iLTYiIHk9Ii02IiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjwvcmVjdD48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMTAgMkM3Ljc5MDg2IDIgNiAzLjc5MDg2IDYgNkM2IDguMjA5MTQgNy43OTA4NiAxMCAxMCAxMEMxMi4yMDkxIDEwIDE0IDguMjA5MTQgMTQgNkMxNCAzLjc5MDg2IDEyLjIwOTEgMiAxMCAyWk03IDZDNyA0LjM0MzE1IDguMzQzMTUgMyAxMCAzQzExLjY1NjkgMyAxMyA0LjM0MzE1IDEzIDZDMTMgNy42NTY4NSAxMS42NTY5IDkgMTAgOUM4LjM0MzE1IDkgNyA3LjY1Njg1IDcgNlpNNS4wMDg3MyAxMUMzLjkwMzE1IDExIDMgMTEuODg2OSAzIDEzQzMgMTQuNjkxMiAzLjgzMjgxIDE1Ljk2NjMgNS4xMzQ5OSAxNi43OTY2QzYuNDE2OTcgMTcuNjE0IDguMTQ1MjYgMTggMTAgMThDMTEuODU0NyAxOCAxMy41ODMgMTcuNjE0IDE0Ljg2NSAxNi43OTY2QzE2LjE2NzIgMTUuOTY2MyAxNyAxNC42OTEyIDE3IDEzQzE3IDExLjg5NTYgMTYuMTA0NSAxMSAxNSAxMUw1LjAwODczIDExWk00IDEzQzQgMTIuNDQ2NyA0LjQ0Nzg2IDEyIDUuMDA4NzMgMTJMMTUgMTJDMTUuNTUyMiAxMiAxNiAxMi40NDc4IDE2IDEzQzE2IDE0LjMwODggMTUuMzc3NyAxNS4yODM3IDE0LjMyNzQgMTUuOTUzNEMxMy4yNTY4IDE2LjYzNiAxMS43MzUxIDE3IDEwIDE3QzguMjY0ODkgMTcgNi43NDMxOCAxNi42MzYgNS42NzI2MiAxNS45NTM0QzQuNjIyMjYgMTUuMjgzNyA0IDE0LjMwODggNCAxM1oiLz48L3N2Zz4=",l="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjMjkzODRGIi8+CjxwYXRoIGQ9Ik0xMS45OTAyIDMuMjVDMTIuNTgyNyAzLjI1IDEzLjE0OTEgMy4zMjgxMiAxMy42ODk1IDMuNDg0MzhDMTQuMjI5OCAzLjYzNDExIDE0LjczMTEgMy44NDU3IDE1LjE5MzQgNC4xMTkxNEMxNS42NTU2IDQuMzkyNTggMTYuMDcyMyA0LjcyNDYxIDE2LjQ0MzQgNS4xMTUyM0MxNi44MjEgNS41MDU4NiAxNy4xNDMyIDUuOTM1NTUgMTcuNDEwMiA2LjQwNDNDMTcuNjc3MSA2Ljg3MzA1IDE3Ljg4MjIgNy4zODA4NiAxOC4wMjU0IDcuOTI3NzNDMTguMTY4NiA4LjQ2ODEgMTguMjQwMiA5LjAzMTI1IDE4LjI0MDIgOS42MTcxOUMxOC40MjkgOS42ODIyOSAxOC41OTgzIDkuNzczNDQgMTguNzQ4IDkuODkwNjJDMTguOTA0MyAxMC4wMDc4IDE5LjAzNDUgMTAuMTQ0NSAxOS4xMzg3IDEwLjMwMDhDMTkuMjQ5MyAxMC40NTA1IDE5LjMzNCAxMC42MTk4IDE5LjM5MjYgMTAuODA4NkMxOS40NTc3IDEwLjk5MDkgMTkuNDkwMiAxMS4xNzk3IDE5LjQ5MDIgMTEuMzc1VjEzLjg3NUMxOS40OTAyIDE0LjEyODkgMTkuNDQxNCAxNC4zNjk4IDE5LjM0MzggMTQuNTk3N0MxOS4yNDYxIDE0LjgyNTUgMTkuMTA5NCAxNS4wMjczIDE4LjkzMzYgMTUuMjAzMUMxOC43NjQzIDE1LjM3MjQgMTguNTY1OCAxNS41MDU5IDE4LjMzNzkgMTUuNjAzNUMxOC4xMSAxNS43MDEyIDE3Ljg2OTEgMTUuNzUgMTcuNjE1MiAxNS43NUgxNi4zNjUyQzE2LjE5NiAxNS43NSAxNi4wNDk1IDE1LjY4ODIgMTUuOTI1OCAxNS41NjQ1QzE1LjgwMjEgMTUuNDQwOCAxNS43NDAyIDE1LjI5NDMgMTUuNzQwMiAxNS4xMjVWMTAuMTI1QzE1Ljc0MDIgOS45NDkyMiAxNS43ODI2IDkuODE5MDEgMTUuODY3MiA5LjczNDM4QzE1Ljk1MTggOS42NDMyMyAxNi4wNTYgOS41ODEzOCAxNi4xNzk3IDkuNTQ4ODNDMTYuMzAzNCA5LjUwOTc3IDE2LjQzNjggOS40OTM0OSAxNi41ODAxIDkuNUMxNi43Mjk4IDkuNSAxNi44NjY1IDkuNSAxNi45OTAyIDkuNUMxNi45OTAyIDguODA5OSAxNi44NTY4IDguMTYyMTEgMTYuNTg5OCA3LjU1NjY0QzE2LjMyOTQgNi45NTExNyAxNS45NzE0IDYuNDIzODMgMTUuNTE1NiA1Ljk3NDYxQzE1LjA2NjQgNS41MTg4OCAxNC41MzkxIDUuMTYwODEgMTMuOTMzNiA0LjkwMDM5QzEzLjMyODEgNC42MzM0NiAxMi42ODAzIDQuNSAxMS45OTAyIDQuNUMxMS4zMDAxIDQuNSAxMC42NTIzIDQuNjMzNDYgMTAuMDQ2OSA0LjkwMDM5QzkuNDQxNDEgNS4xNjA4MSA4LjkxMDgxIDUuNTE4ODggOC40NTUwOCA1Ljk3NDYxQzguMDA1ODYgNi40MjM4MyA3LjY0Nzc5IDYuOTUxMTcgNy4zODA4NiA3LjU1NjY0QzcuMTIwNDQgOC4xNjIxMSA2Ljk5MDIzIDguODA5OSA2Ljk5MDIzIDkuNUg3LjI3MzQ0QzcuMzg0MTEgOS41IDcuNDk4MDUgOS41MDY1MSA3LjYxNTIzIDkuNTE5NTNDNy43MzI0MiA5LjUyNjA0IDcuODM2NTkgOS41NTIwOCA3LjkyNzczIDkuNTk3NjZDOC4wMTg4OCA5LjYzNjcyIDguMDkzNzUgOS42OTg1NyA4LjE1MjM0IDkuNzgzMkM4LjIxMDk0IDkuODY3ODQgOC4yNDAyMyA5Ljk4MTc3IDguMjQwMjMgMTAuMTI1VjE1LjEyNUM4LjI0MDIzIDE1LjMwMDggOC4xOTc5MiAxNS40MzQyIDguMTEzMjggMTUuNTI1NEM4LjAyODY1IDE1LjYxIDcuOTI0NDggMTUuNjcxOSA3LjgwMDc4IDE1LjcxMDlDNy42NzcwOCAxNS43NDM1IDcuNTQwMzYgMTUuNzU5OCA3LjM5MDYyIDE1Ljc1OThDNy4yNDc0IDE1Ljc1MzMgNy4xMTM5MyAxNS43NSA2Ljk5MDIzIDE1Ljc1VjE3Ljk3NjZDNi45OTAyMyAxOC4xMzI4IDcuMDM5MDYgMTguMjYzIDcuMTM2NzIgMTguMzY3MkM3LjI0MDg5IDE4LjQ2NDggNy4zNzEwOSAxOC41NDYyIDcuNTI3MzQgMTguNjExM0M3LjY5MDEgMTguNjc2NCA3Ljg2OTE0IDE4LjcyNTMgOC4wNjQ0NSAxOC43NTc4QzguMjU5NzcgMTguNzkwNCA4LjQ1NTA4IDE4LjgxNjQgOC42NTAzOSAxOC44MzU5QzguODQ1NyAxOC44NDkgOS4wMjc5OSAxOC44NTg3IDkuMTk3MjcgMTguODY1MkM5LjM2NjU0IDE4Ljg2NTIgOS41MDMyNiAxOC44NjUyIDkuNjA3NDIgMTguODY1MkM5LjY3OTA0IDE4LjY4MjkgOS43NzM0NCAxOC41MTY5IDkuODkwNjIgMTguMzY3MkMxMC4wMDc4IDE4LjIxNzQgMTAuMTQxMyAxOC4wODcyIDEwLjI5MSAxNy45NzY2QzEwLjQ0NzMgMTcuODY1OSAxMC42MTY1IDE3Ljc4MTIgMTAuNzk4OCAxNy43MjI3QzEwLjk4MTEgMTcuNjU3NiAxMS4xNjk5IDE3LjYyNSAxMS4zNjUyIDE3LjYyNUgxMS45OTAyQzEyLjI0NDEgMTcuNjI1IDEyLjQ4NSAxNy42NzM4IDEyLjcxMjkgMTcuNzcxNUMxMi45NDA4IDE3Ljg2OTEgMTMuMTM5MyAxOC4wMDU5IDEzLjMwODYgMTguMTgxNkMxMy40ODQ0IDE4LjM1MDkgMTMuNjIxMSAxOC41NDk1IDEzLjcxODggMTguNzc3M0MxMy44MTY0IDE5LjAwNTIgMTMuODY1MiAxOS4yNDYxIDEzLjg2NTIgMTkuNUMxMy44NjUyIDE5Ljc1MzkgMTMuODE2NCAxOS45OTQ4IDEzLjcxODggMjAuMjIyN0MxMy42MjExIDIwLjQ1MDUgMTMuNDg0NCAyMC42NTIzIDEzLjMwODYgMjAuODI4MUMxMy4xMzkzIDIwLjk5NzQgMTIuOTQwOCAyMS4xMzA5IDEyLjcxMjkgMjEuMjI4NUMxMi40ODUgMjEuMzI2MiAxMi4yNDQxIDIxLjM3NSAxMS45OTAyIDIxLjM3NUgxMS4zNjUyQzEwLjk2MTYgMjEuMzc1IDEwLjYwMDMgMjEuMjYxMSAxMC4yODEyIDIxLjAzMzJDOS45NjIyNCAyMC43OTg4IDkuNzM0MzggMjAuNDkyOCA5LjU5NzY2IDIwLjExNTJDOS4zNTAyNiAyMC4xMDg3IDkuMDgwMDggMjAuMDk5IDguNzg3MTEgMjAuMDg1OUM4LjUwMDY1IDIwLjA3MjkgOC4yMTQxOSAyMC4wNDY5IDcuOTI3NzMgMjAuMDA3OEM3LjY0MTI4IDE5Ljk2MjIgNy4zNjQ1OCAxOS44OTcxIDcuMDk3NjYgMTkuODEyNUM2LjgzNzI0IDE5LjcyMTQgNi42MDYxMiAxOS41OTc3IDYuNDA0MyAxOS40NDE0QzYuMjAyNDcgMTkuMjc4NiA2LjAzOTcxIDE5LjA4MDEgNS45MTYwMiAxOC44NDU3QzUuNzk4ODMgMTguNjA0OCA1Ljc0MDIzIDE4LjMxNTEgNS43NDAyMyAxNy45NzY2VjE1LjYzMjhDNS41NTc5NCAxNS41Njc3IDUuMzg4NjcgMTUuNDc2NiA1LjIzMjQyIDE1LjM1OTRDNS4wNzYxNyAxNS4yNDIyIDQuOTQyNzEgMTUuMTA4NyA0LjgzMjAzIDE0Ljk1OUM0LjcyNzg2IDE0LjgwMjcgNC42NDMyMyAxNC42MzM1IDQuNTc4MTIgMTQuNDUxMkM0LjUxOTUzIDE0LjI2MjQgNC40OTAyMyAxNC4wNzAzIDQuNDkwMjMgMTMuODc1VjExLjM3NUM0LjQ5MDIzIDExLjE3OTcgNC41MTk1MyAxMC45OTA5IDQuNTc4MTIgMTAuODA4NkM0LjY0MzIzIDEwLjYxOTggNC43Mjc4NiAxMC40NTA1IDQuODMyMDMgMTAuMzAwOEM0Ljk0MjcxIDEwLjE0NDUgNS4wNzYxNyAxMC4wMDc4IDUuMjMyNDIgOS44OTA2MkM1LjM4ODY3IDkuNzczNDQgNS41NTc5NCA5LjY4MjI5IDUuNzQwMjMgOS42MTcxOUM1Ljc0MDIzIDkuMDMxMjUgNS44MTE4NSA4LjQ2ODEgNS45NTUwOCA3LjkyNzczQzYuMDk4MzEgNy4zODA4NiA2LjMwMzM5IDYuODczMDUgNi41NzAzMSA2LjQwNDNDNi44MzcyNCA1LjkzNTU1IDcuMTU2MjUgNS41MDU4NiA3LjUyNzM0IDUuMTE1MjNDNy45MDQ5NSA0LjcyNDYxIDguMzI0ODcgNC4zOTI1OCA4Ljc4NzExIDQuMTE5MTRDOS4yNDkzNSAzLjg0NTcgOS43NTA2NSAzLjYzNDExIDEwLjI5MSAzLjQ4NDM4QzEwLjgzMTQgMy4zMjgxMiAxMS4zOTc4IDMuMjUgMTEuOTkwMiAzLjI1Wk0xMS4zNjUyIDE4Ljg3NUMxMS4xOTYgMTguODc1IDExLjA0OTUgMTguOTM2OCAxMC45MjU4IDE5LjA2MDVDMTAuODAyMSAxOS4xODQyIDEwLjc0MDIgMTkuMzMwNyAxMC43NDAyIDE5LjVDMTAuNzQwMiAxOS42NjkzIDEwLjgwMjEgMTkuODE1OCAxMC45MjU4IDE5LjkzOTVDMTEuMDQ5NSAyMC4wNjMyIDExLjE5NiAyMC4xMjUgMTEuMzY1MiAyMC4xMjVIMTEuOTkwMkMxMi4xNTk1IDIwLjEyNSAxMi4zMDYgMjAuMDYzMiAxMi40Mjk3IDE5LjkzOTVDMTIuNTUzNCAxOS44MTU4IDEyLjYxNTIgMTkuNjY5MyAxMi42MTUyIDE5LjVDMTIuNjE1MiAxOS4zMzA3IDEyLjU1MzQgMTkuMTg0MiAxMi40Mjk3IDE5LjA2MDVDMTIuMzA2IDE4LjkzNjggMTIuMTU5NSAxOC44NzUgMTEuOTkwMiAxOC44NzVIMTEuMzY1MlpNNi4zNjUyMyAxMC43NUM2LjE5NTk2IDEwLjc1IDYuMDQ5NDggMTAuODExOCA1LjkyNTc4IDEwLjkzNTVDNS44MDIwOCAxMS4wNTkyIDUuNzQwMjMgMTEuMjA1NyA1Ljc0MDIzIDExLjM3NVYxMy44NzVDNS43NDAyMyAxNC4wNDQzIDUuODAyMDggMTQuMTkwOCA1LjkyNTc4IDE0LjMxNDVDNi4wNDk0OCAxNC40MzgyIDYuMTk1OTYgMTQuNSA2LjM2NTIzIDE0LjVINi45OTAyM1YxMC43NUg2LjM2NTIzWk0xNi45OTAyIDEwLjc1VjE0LjVIMTcuNjE1MkMxNy43ODQ1IDE0LjUgMTcuOTMxIDE0LjQzODIgMTguMDU0NyAxNC4zMTQ1QzE4LjE3ODQgMTQuMTkwOCAxOC4yNDAyIDE0LjA0NDMgMTguMjQwMiAxMy44NzVWMTEuMzc1QzE4LjI0MDIgMTEuMjA1NyAxOC4xNzg0IDExLjA1OTIgMTguMDU0NyAxMC45MzU1QzE3LjkzMSAxMC44MTE4IDE3Ljc4NDUgMTAuNzUgMTcuNjE1MiAxMC43NUgxNi45OTAyWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==",s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAACxKAAAsSgF3enRNAAAEuElEQVR42u2cwUsjVxzHv9tVKZs9uJTEg5cY0JaNI97W4DFpb41eWjbrYVkQ/4bSRSjI9r50T9arG+iyVNNrAr1I0ps467JViLmkkJHSHHakNND2sEzIrskaWzVvZj6fk5igM/M+83vv++a9ufbF3R//EYSWD7gECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAg2bIpIPJpOPKpONKTIwG8mJXj5oqlmoqlmrGHNM1E14WHYkMa/XhfGAbvpsIa4925LotugBJoWp8SUpMjGr14TxjAK/sh6nxOyXIpOMIkLozHtoBGAJI2szvy7aPQ9f4tn2s9e93GQR6WFZUK8uzGotFAt3wDcfV0/xLlSt1UkA3FrKTWsxOKRIZDlzjb+b3VSzVjBj9GyuAFwuXckkj+sgLK/cbu2o4rnHHNnABLCvacwxgWVEt5ZK+TQlnlfv3nftVcT05ffebQR7Ak8ef6datD/Xq19/Vav391meOc6JiqaY/mn/qk48/0sjIdV+V+/WNXVWPml0r3IP7M3pwf0bPnr8a6HEaMRWcSceVmhvXVuFA24XDU58XSzWVK3UtZqe0kJ30dbk3bYxjzLOAzn5/fWP3VGl03VZ7ELWyPCvLivqu3JuYcoZMu4PGYhGtfj3f805qOK7Wvt1Ram5c93K3B35BXbfVs3J552OisMYK0HnHfPf4057RqVypq1ypD7Sklit1Pc2/7FruI5FhZdJxLeWSRndZQzKcpVxSi9mptgjvsl04VKXymxayk1cWG6tHzffOYHoN74e5DOMF8O6mleVZpe6Ma+ung1MXvuG4Wt/YVfmX+qXGxrPKvWVFtfj5lLHl3rcCdF5gy4qqWKppM79/qluw7WN9Zf98Kd1Cr//57gDWbwzJh5wVG7cLhyqWahcSG237WJv5/a553sRYFwoBzhMby5U33cJ5y7JfY11oBOg3NlaPmueKjf3Eunu520rNBWMdw5ACQj+xcc92lEnHe5bs7cKhtgoHPft5P8S60ArQT2x03VY7NnbexcVSTduFw57Tt5l0XAvZyUCuVRj408Af8ouX9rdt+7hrbOws515/343ExOh/Gj+chy9zW1SAQcXGXg0ftPUIoRWg39gYpFiHAH3ERm+eoBNTHi4hwBXExpXlWS3lkqpW30zuJBKjobnjQy9AZ0Xw05z9ZcHuYAQABAAEGBQmrpUP07kPXIAw7gs06dyN2Bxq0lapq8J7XB16AVy3pbVHO6HqChqOa8wbQozZG+g9bg3yNKy31sCkDaJGbg713hqSmhv3vQyu21K5Um+/IMo0jBSgk8TEaHuqdmY6ptjYDWPn6xuOK6dxor0Xjly3pWq12XMtIQJcgBiRm8O6GRlRLHaj/fuZ6dhb3/s/wngN2sneC6f9s+Oc6LX7l9zXLeMbOnACQEBSACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAPwL3XwvzOsJdhMAAAAASUVORK5CYII=",d="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwNiAzMDY7IiB2aWV3Qm94PSIwIDAgMzA2IDMwNiIgeD0iMHB4IiB5PSIwcHgiIHhtbG5zOnhtbD0iaHR0cDovL3d3dy53My5vcmcvWE1MLzE5OTgvbmFtZXNwYWNlIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICA8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgogICAgLnN0MHtmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtmaWxsOnJnYigyMTksIDQxLCA1Myk7fQogICAgLnN0MXtlbmFibGUtYmFja2dyb3VuZDpuZXc7fQogICAgLnN0MntmaWxsOnJnYigyNTUsIDI1NSwgMjU1KTt9CiAgPC9zdHlsZT4KICA8Zz4KICA8Zz4KICAgIDxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0gMTUzIDAgTCAxNTMgMCBjIDg0LjUgMCAxNTMgNjguNSAxNTMgMTUzIGwgMCAwIGMgMCA4NC41IC02OC41IDE1MyAtMTUzIDE1MyBsIDAgMCBDIDY4LjUgMzA2IDAgMjM3LjUgMCAxNTMgbCAwIDAgQyAwIDY4LjUgNjguNSAwIDE1MyAwIFoiLz4KICAgIDxnIGNsYXNzPSJzdDEiPgogICAgPHBhdGggY2xhc3M9InN0MiIgZD0iTSAxNTQuOCA4My42IGMgMi42IDAgNS4xIDAuNyA3LjUgMi4xIGMgMi4zIDEuNCA0LjEgMy4zIDUuNCA1LjYgbCA1MS45IDk2LjQgYyAxLjIgMi4yIDEuOCA0LjUgMS44IDYuOSBjIDAgMiAtMC40IDMuOSAtMS4yIDUuNiBjIC0wLjggMS44IC0xLjggMy4zIC0zLjIgNC42IGMgLTEuMyAxLjMgLTIuOSAyLjQgLTQuNiAzLjIgYyAtMS44IDAuOCAtMy43IDEuMiAtNS42IDEuMiBIIDEwMi44IGMgLTIgMCAtMy44IC0wLjQgLTUuNiAtMS4yIGMgLTEuOCAtMC44IC0zLjMgLTEuOSAtNC42IC0zLjIgYyAtMS4zIC0xLjMgLTIuNCAtMi45IC0zLjIgLTQuNiBjIC0wLjggLTEuOCAtMS4yIC0zLjYgLTEuMiAtNS42IGMgMCAtMi40IDAuNiAtNC43IDEuOCAtNi45IGwgNTEuOSAtOTYuNCBjIDEuMyAtMi4zIDMuMSAtNC4yIDUuNCAtNS42IEMgMTQ5LjcgODQuMyAxNTIuMiA4My42IDE1NC44IDgzLjYgWiBNIDE1NC44IDkzLjMgYyAtMSAwIC0xLjkgMC4zIC0yLjYgMC44IGMgLTAuNyAwLjYgLTEuNCAxLjIgLTEuOSAyLjEgYyAtMC42IDAuOCAtMSAxLjcgLTEuNCAyLjYgYyAtMC40IDAuOSAtMC44IDEuOCAtMS4yIDIuNSBjIC0wLjggMS41IC0yIDMuOSAtMy44IDcuMiBjIC0xLjggMy40IC0zLjkgNy4zIC02LjQgMTEuNyBjIC0yLjUgNC41IC01LjIgOS4zIC04LjEgMTQuNiBjIC0yLjkgNS4zIC01LjggMTAuNiAtOC43IDE1LjkgcyAtNS43IDEwLjUgLTguNCAxNS41IGMgLTIuNyA1IC01LjEgOS41IC03LjIgMTMuNiBjIC0yLjEgNCAtMy44IDcuMyAtNSA5LjkgYyAtMS4yIDIuNiAtMS45IDQuMiAtMS45IDQuOCBjIDAgMS4zIDAuNSAyLjUgMS40IDMuNCBjIDEgMSAyLjEgMS40IDMuNCAxLjQgaCAxMDMuOSBjIDEuMyAwIDIuNSAtMC41IDMuNCAtMS40IGMgMSAtMSAxLjQgLTIuMSAxLjQgLTMuNCBjIC0xLjUgLTMuNyAtMy4xIC03LjIgLTUgLTEwLjYgYyAtMS45IC0zLjQgLTMuNyAtNi45IC01LjUgLTEwLjQgYyAtMi40IC00LjUgLTQuNyAtOSAtNyAtMTMuNCBjIC0yLjMgLTQuNSAtNC43IC05IC03IC0xMy40IGMgLTIuNCAtNC42IC00LjkgLTkuMiAtNy4zIC0xMy43IGMgLTIuNCAtNC41IC00LjkgLTkuMSAtNy4zIC0xMy43IGMgLTEuOCAtMy4yIC0zLjUgLTYuNSAtNS4zIC05LjcgYyAtMS44IC0zLjIgLTMuNiAtNi40IC01LjQgLTkuNiBjIC0wLjQgLTAuNyAtMC44IC0xLjQgLTEuMiAtMi4xIGMgLTAuNCAtMC43IC0wLjkgLTEuMyAtMS40IC0xLjkgYyAtMC42IC0wLjcgLTEuMiAtMS4zIC0xLjggLTEuOCBDIDE1Ni42IDkzLjYgMTU1LjggOTMuMyAxNTQuOCA5My4zIFogTSAxNTQuOCAxNzcuNiBjIDEgMCAxLjkgMC4yIDIuNyAwLjYgYyAwLjkgMC40IDEuNiAxIDIuMyAxLjYgcyAxLjIgMS41IDEuNiAyLjMgYyAwLjQgMC45IDAuNiAxLjggMC42IDIuNyBjIDAgMSAtMC4yIDEuOSAtMC42IDIuNyBjIC0wLjQgMC45IC0xIDEuNiAtMS42IDIuMyBzIC0xLjUgMS4yIC0yLjMgMS42IGMgLTAuOSAwLjQgLTEuOCAwLjYgLTIuNyAwLjYgYyAtMSAwIC0xLjkgLTAuMiAtMi43IC0wLjYgYyAtMC45IC0wLjQgLTEuNiAtMSAtMi4zIC0xLjYgcyAtMS4yIC0xLjUgLTEuNiAtMi4zIGMgLTAuNCAtMC45IC0wLjYgLTEuOCAtMC42IC0yLjcgYyAwIC0xIDAuMiAtMS45IDAuNiAtMi43IGMgMC40IC0wLjkgMSAtMS42IDEuNiAtMi4zIHMgMS41IC0xLjIgMi4zIC0xLjYgQyAxNTIuOSAxNzcuOCAxNTMuOCAxNzcuNiAxNTQuOCAxNzcuNiBaIE0gMTU5LjcgMTcwLjIgaCAtOS44IHYgLTQ4LjggaCA5LjggViAxNzAuMiBaIi8+CiAgICA8L2c+CiAgPC9nPgogIDwvZz4KPC9zdmc+",c="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ0IiBoZWlnaHQ9IjE0NCIgdmlld0JveD0iMCAwIDE0NCAxNDQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgo8Y2lyY2xlIGN4PSI3MiIgY3k9IjcyIiByPSI3MiIgZmlsbD0idXJsKCNwYXR0ZXJuMCkiLz4KPGNpcmNsZSBjeD0iNzIiIGN5PSI3MiIgcj0iNzIiIGZpbGw9IiNEMTM0MzgiLz4KPHBhdGggZD0iTTQ1LjEyMTQgODdDMzkuMTIyIDg3IDM1IDgzLjI5ODcgMzUgNzguMzc3M0g0MC42NzI5QzQwLjcxMzcgODAuMzcwMyA0Mi42NzI3IDgyLjAzNzkgNDUuMjg0NyA4Mi4wMzc5QzQ3LjgxNSA4Mi4wMzc5IDQ5LjQ4ODMgODAuNjU1IDQ5LjQ4ODMgNzguNjYyQzQ5LjQ4ODMgNzcuMTE2NCA0OC4zNDU2IDc2LjAxODIgNDUuOTM3NyA3NS4yODYxTDQyLjUwOTQgNzQuMzFDMzYuMzQ2OCA3Mi42ODMgMzUuMjQ0OSA2OC45ODE4IDM1LjI0NDkgNjYuNDZDMzUuMjQ0OSA2MS40NTcyIDM5LjU3MSA1OCA0NC45NTgyIDU4QzUwLjI2MzggNTggNTQuMzQ1IDYxLjIxMzIgNTQuMzQ1IDY2LjU0MTRINDguNjcyMUM0OC42NzIxIDY0LjU0ODQgNDcuMjg0NSA2My4wMDI4IDQ0LjgzNTcgNjMuMDAyOEM0Mi42MzE5IDYzLjAwMjggNDAuOTU4NiA2NC40NjcgNDAuOTU4NiA2Ni4zMzhDNDAuOTU4NiA2Ny4wMjk1IDQxLjE2MjYgNjguNDUzIDQ0LjEwMTEgNjkuMzA3Mkw0Ny4yNDM3IDcwLjIwMkM1MS40ODgxIDcxLjQ2MjggNTUuMjAyMSA3My42MTg1IDU1LjIwMjEgNzguMzc3M0M1NS4yMDIxIDgzLjk0OTUgNTAuNDI3IDg3IDQ1LjEyMTQgODdaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNzIuOTE1OCA4N0M2NC45MTY2IDg3IDU4LjYzMTYgODAuNDUxNiA1OC42MzE2IDcyLjUyMDNDNTguNjMxNiA2NC41NDg0IDY0LjkxNjYgNTggNzIuOTE1OCA1OEM4MC44NzQyIDU4IDg3LjI0MDkgNjQuNTQ4NCA4Ny4yNDA5IDcyLjUyMDNDODcuMjQwOSA4MC40NTE2IDgwLjg3NDIgODcgNzIuOTE1OCA4N1pNNzIuOTE1OCA4MS42NzE4Qzc3LjkzNTcgODEuNjcxOCA4MS41MjcyIDc3LjU2MzggODEuNTI3MiA3Mi41MjAzQzgxLjUyNzIgNjcuNDc2OSA3Ny45MzU3IDYzLjMyODIgNzIuOTE1OCA2My4zMjgyQzY3Ljg1NTEgNjMuMzI4MiA2NC4zMDQ0IDY3LjQ3NjkgNjQuMzA0NCA3Mi41MjAzQzY0LjMwNDQgNzcuNTYzOCA2Ny44NTUxIDgxLjY3MTggNzIuOTE1OCA4MS42NzE4WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEwMC45MTkgODdDOTQuOTIgODcgOTAuNzk4IDgzLjI5ODcgOTAuNzk4IDc4LjM3NzNIOTYuNDcwOUM5Ni41MTE3IDgwLjM3MDMgOTguNDcwNyA4Mi4wMzc5IDEwMS4wODMgODIuMDM3OUMxMDMuNjEzIDgyLjAzNzkgMTA1LjI4NiA4MC42NTUgMTA1LjI4NiA3OC42NjJDMTA1LjI4NiA3Ny4xMTY0IDEwNC4xNDQgNzYuMDE4MiAxMDEuNzM2IDc1LjI4NjFMOTguMzA3NCA3NC4zMUM5Mi4xNDQ4IDcyLjY4MyA5MS4wNDI4IDY4Ljk4MTggOTEuMDQyOCA2Ni40NkM5MS4wNDI4IDYxLjQ1NzIgOTUuMzY4OSA1OCAxMDAuNzU2IDU4QzEwNi4wNjIgNTggMTEwLjE0MyA2MS4yMTMyIDExMC4xNDMgNjYuNTQxNEgxMDQuNDdDMTA0LjQ3IDY0LjU0ODQgMTAzLjA4MiA2My4wMDI4IDEwMC42MzQgNjMuMDAyOEM5OC40Mjk4IDYzLjAwMjggOTYuNzU2NSA2NC40NjcgOTYuNzU2NSA2Ni4zMzhDOTYuNzU2NSA2Ny4wMjk1IDk2Ljk2MDYgNjguNDUzIDk5Ljg5OTEgNjkuMzA3MkwxMDMuMDQyIDcwLjIwMkMxMDcuMjg2IDcxLjQ2MjggMTExIDczLjYxODUgMTExIDc4LjM3NzNDMTExIDgzLjk0OTUgMTA2LjIyNSA4NyAxMDAuOTE5IDg3WiIgZmlsbD0id2hpdGUiLz4KPGRlZnM+CjxwYXR0ZXJuIGlkPSJwYXR0ZXJuMCIgcGF0dGVybkNvbnRlbnRVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giIHdpZHRoPSIxIiBoZWlnaHQ9IjEiPgo8dXNlIHhsaW5rOmhyZWY9IiNpbWFnZTBfODA2N18yMjc5NzkiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMDI1KSIvPgo8L3BhdHRlcm4+CjxpbWFnZSBpZD0iaW1hZ2UwXzgwNjdfMjI3OTc5IiB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFaQUFBQUdRQ0FZQUFBQ0F2emJNQUFBQldHbERRMUJKUTBNZ1VISnZabWxzWlFBQUtKRnRrRUZMQWxFVWhjK1laYVJSUkxzYUdGcEV4Q1JsQnUzQ0RDeHlNVTBHRmtHTm8ya3dUcS9uUkFqOWlQYlJyaDhSMHFKZEJPNkNJbWlieXphQkJDWFRmVTZsVmc4dTUrTnczdVZ5QUYrdndaamxCMUMwSGE0bkZwWDA1cFlTcUNFSUdRUHdZY3d3U3l5bWFVbUs0RnM3WC8wZWt0QzdLYkZyNTdsblpsSk5MTnltNWF0YTlXWGtiNzdqOVdWekpaUDBneVpzTXU0QWtrcXNIVHRNOEFueE1LZWppRThGNXoyK0VKengrTEtaU2VseDRpcnhvRmt3c3NSUHhHcW16YyszY2RFNk1yOXVFTmVIY3ZiR091a1F6U2lTU0VEQk1wYWdrMGF4U3YzOG40ODI4M0VjZ0tFTWpuM2tVWUJEdjJMa01GaklFYS9BaG9rd1ZPSUlwbWtpb3VmZi9iVzg4Z013djBhdzNmSlNqMEJGQTRKbkxXOWlIT2pmQlc3bW1NR05uMWFsdXIrME54dnhPTVNCN2pmWGZaV0JRQVZvY05kOVAzZmRCblhZUlR1dkR6OEIwTzloQ0xDY1g0UUFBQUE0WlZoSlprMU5BQ29BQUFBSUFBR0hhUUFFQUFBQUFRQUFBQm9BQUFBQUFBS2dBZ0FFQUFBQUFRQUFBWkNnQXdBRUFBQUFBUUFBQVpBQUFBQUFPUGxOOWdBQVB4MUpSRUZVZUFIdG5WdVFGY2VaNTdPcVc3dGN0SFNmdG9VdE5ERTYzWUIyck81WkkyNStHR1Exc3VCQkY0UTlJZkNUUUx6SURpbFdXRHUyTi9aQmdOL0dudFVsd2hySjh5QkEreUpRaEhXeDVJaXhKdFF0SVQ4c1lJSFgzZkpZWExxSk1DZ0VOdFhJeldWWG5GUDdmVVZYYy9yMHVWUmxaVlZsWmY0ekFrNmRPcFczWCtZNS8vN3l5NHNqRUVEQUlBSmpudGROMWVtK0trVFpwMzljTlg1MVhMZmJkWnl1OEgzdzZ2dGxmZzJETS9WOCtMN1pLNlUzSG41R2NTYUU0MHhNdlovZzkxWGZ2K0JYcTN3OVRzOU91UFNQWDIrZzk3MmxVdmhzbUFSZVFhQ3dCS2lQSTRCQWNRaVFRSlQvbnhETHFPTjJzekIwZEhUY3lxOCtpUUhmbzVyd1A5M0RVUllkRnBoS3BYS0tYL2xmNXpXQkdkZTk4Q2dmQ0lRRXFOOGlnSUJlQk5pSytKeEVnVXExVExqdU1zZHhiaVdCWU5IZ2V6WUVGcGh4cXZNcHNtU0cyWUloY1RrSzY4V0dwaTlXSFNFZ3hXb3Y0MG9iV2hTZHJudHIxWEVHTFJPS3VPMFpDRXUxVXZrdGljb3dSQ1V1UGp5dm1nQUVSRFZScE5lVUFGc1c1SnRZNXJydVZ5RVdUVEhGK29DK3dPTys0eHgxZlgrNFdxMytGcUlTQ3g4ZVRrZ0FBcElRSUtJM0o4Q0NRZjZLUVhKZ0QxSkh1NHVlWE5iOGFYeWlrTUJSOGd1OXg4TmYvNEVzRlF4OUtTU0xwR1lRZ0lETXdJRTNTUWhBTUpMUVN6VXVCQ1ZWdlBZbURnR3h0KzJWMVB5WTV3Mkt6czY3aE84UEJ2K1VwSXBFVWlYZ09NTTA1UFY2cFZwOTc3WlM2V2lxZVNGeG93bEFRSXh1WHZXVkMvMFl2dXR1cE02emhYSW93clJaOVNBTVNaSGFjSnhtZkEzVGRPSTMvbk9wOUxvaDFVSTFNaUlBQWNrSWRKR3pZZEdnYWJVYm5ZNk9MV1Jsc0I4RG9sSGtCbTFWZHNkNW5YNFVYdThnUVlIdnBCVW9mTVlFSUNEb0J3MEoxSW5HWU1PSGNOTnNBbVNaMEEvRUhvaUoyYzJjcEhZUWtDVDBESXNiRGsrSmpvNGRzRFFNYTl5azFTSExoTmFmN01Vd1YxS1Fac1dIZ0pqVm5sSzFZVWM0ZkJwUzZLeUxSRDhZZ2MvRUp6RlpXaW9OV3djQUZaNUJBQUl5QTRjOWJ3SnJvN1B6Q1ZHdGJxUmFzMThEQVFSaUVhRFY4R08waUhFWERYRzlSLzZTOFZpUjhiQVJCQ0FnUmpSajlFb0UwMjZ2RFZFTlJvK0ZKMEdnTlFIYXIyd1BySkxXakV6OEZBSmlZcXZXMVltdGphcnJicWtLc1pVK2dyVlJ4d2R2MVJHQVZhS09aUkZTZ29BVW9aVWt5MGpDVWY3Y2RiZFRJMk85aGlSRFJKTW1NRUZXQ1U4SDNvWGhMV21HMmtlRWdHamZSUEVMaUdHcStNd1FJejBDR041S2oyM2VLVU5BOG00QmhmbERPQlRDUkZKcEVEaENZdkxja2dVTDlxYVJPTkxNbmdBRUpIdm15blA4MlBPMjBoYnBPMmdIMXJMeXhKRWdDQ2dtRVBwSklDU0t3ZWFRSEFRa0IraXFzb1J3cUNLSmRQSWdBQ0hKZzdyYVBDRWdhbmxta2hxRUl4UE15Q1FqQWhDU2pFQ25rQTBFSkFXb2FTVUo0VWlMTE5MVmdRQ0VSSWRXaUZjR0NFZzhYcms4SFRqSFhmY1p5aHhyT0hKcEFXU2FKUUVJU1phMGsrVUZBVW5HTDlYWW1GV1ZLbDRrcmorQkkzUXM3elljZXFWdlEwRkFOR3diWGdCWTZlaDR4dmQ5M3FjS0FRU3NKc0RyU0xBZ1VjOHVBQUhScUYxcU5qamNUc1hxMXFob0tBb0k1RTNBRjY2N2EvTHExZWZ1S0pVbThpNE04cjlHQUFLaVNVOWdCN2x6emM4QjRkQ2tUVkFNL1FqQVA2SlhtMEJBY200UEVvNWxkRlRzTTNTQTAyRE9SVUgySUZBa0FrYzZxOVZ2WVordGZKc01BcElULzZuaHFoMTBIZ2NQVnlHQUFBaklFSENjWnlZcmxSOWhXRXNHWHZJNEVKRGtER09ud0xPcmFMaHFON1llaVkwT0VVQmdGZ0VNYTgxQ2t0a05DRWhtcU9uNE5wcGRkYldqWXplR3F6S0VqcXlzSVlEWld0azNOWWszUWhZRVRreE9QbkhWZFk5QVBMS2dqVHhzSkVEVDNyZlN3V252SHYvc016Ny9CaUVEQXJCQVVvWU1xeU5sd0VnZUJCb1FvTFBhWDd1aFVua1NUdllHY0JUZWdnV2lFR1o5VXJBNjZvbmdQUWhrUThEeC9XL0NHa21mTlN5UUZCZ0hNNnc2T2w3RGNGVUtjSkVrQ01Ra0FOOUlUR0F4SG9lQXhJQVY1ZEdwalE5Zm8yZXhJREFLTUR3REFoa1F3RXl0ZENCRFFCUnh4Ym9PUlNDUkRBaWtTWURXalN4ZHNPREpOTE93S1cwSWlJTFdaa2Q1eFhXSHNLNURBVXdrQVFJcEUyQnJ4SzFXNzRhRFBUbG9PTkVUTWd3ZDVSQ1BoQ0FSSFFReUlsQVZvcGVtMUgvNDc1NkhYU0FTTW9jRklna1FRMWFTNEJBTkJIUWlnSzFRRXJVR0JFUUNINGFzSktBaENnaG9TZ0JEV3ZJTmd5R3NtT3lPVDA1dTRSWGxHTEtLQ1E2UGc0Q21CTUloTGF4Z2o5OUFFSkFZekk3OTVTODcvRXBsRDBYQkZOMFkzUEFvQ0JTQVFJbTJRdG5OMy9FQ2xGV2JJbUlJSzBKVEJQNE9MQXlNUUFxUGdFRHhDV0FibE9odENBRnB3d3IramphQThERUlHRWdBZnBGb2pZb2hyQmFjZUZVNS9CMHRBT0VqRURDVVFPZ1grWVBuYlRTMGlrcXFCUUZwZ3BIWGR3aGFIRWdmdzkvUmhCRnVnNERoQkVxdTYvNGNmcEhtclF3QmFjQ0dPMHkxVW5tMndVZTRCUUlnWUJjQmg0NmQzZ0VSYWR6bzhJSFVjR0ZuK2VjZEhjL1FWdEJiYTI3akVnUkFBQVNFY0p6ZGRQNzZremgvL1hwbmdJQk1zV0JuT2ZrN2VCZmRaZGZ4NEFvRVFBQUVaaEE0MGxtdGZndjdhRjFqQWdFaERwaHBOZU1MZ2pjZ0FBSXRDR0NHMW5VNDFnc0l4T042WjhBVkNJQkFOQUlRa1d1Y3JIYWlmK3g1eXpCTk45b1hCaytCQUFoY0o4RFRmUG5JWFA0TnVYN1h2aXRyTFJCdWVBZlRkTzNyOGFneENLZ2w0UGwwdHNodHBkSlJ0Y2tXSXpVckxSRGVFSkhFNHdnMVVYY3htZ21sQkFFUTBKUkFpWDVMUHJSMUkwYnJMQkFXajZrTkVUWHRqeWdXQ0lCQUFRblFGbHJPSTBzV0xOaGJ3TEpMRjlrcUFZRjRTUGNUUkFRQkVHaFB3RG9Sc1VaQUlCN3RleitlQUFFUVNFekFLaEd4UWtBZ0hvbS9GRWdBQkVBZ09nRnJSTVI0QVlGNFJPLzFlQklFUUVBWkFTdEV4R2dCZ1hnbyt6SWdJUkFBZ2ZnRWpCY1JZd1ZrYXAwSFQ5VkZBQUVRQUlHOENQaTBUbVM1cWV0RWpGd0hVck5JTUs5T2czeEJBQVJBZ0FrNHRFN0UyQlhyeGxrZzJOc0szMW9RQUFFTkNYaTBpKzl5MDNieE5jb0NnWGhvK0xWQmtVQUFCSmhBaWZmTzR0OG9rM0FZWTRGQVBFenFscWdMQ0poSmdQNWlIM05wN3l4VExCRWpMQkFTajI0K0RNb1hvbXhtdDBPdFFBQUVUQ0RBdS9qU2I5WFBqOUJ2bGduMU1VSkErQmhhYWd5cnQxVTJvVE9pRGlCZ0NZRTdidXpvZU5xRXVoWmVRUGl3ZTV4aGJrSlhSQjFBd0NJQ3ZyK1ZmN3VLWHVOQyswQ0NCcWhXZHhhOUVWQitFQUFCS3duNGxXcjF5YjhwbFo0dGF1MExLeUIvOEx5Tkx2azlpZ29lNVFZQkVBQUJJdUFMY3FvdkxaV0dpMGlqa0FMQ002NzRLRm9DYm9RanFvZ2RCMlVHQVJCUVJxQ3dhMFFLNXdNSnArdFMwMEU4bFBWZkpBUUNJSkFqZ1dDTlNCRm5aaFZPUUNvMDR3clRkWFBzNnNnYUJFQkFPUUdlM2tzenMzNnVQT0dVRXl5VWdMRFQzUGY5alNrelFmSWdBQUlna0QwQjN4OHMyc3lzd3ZoQWFJUEVyYlFwMmU3c1d4VTVnZ0FJZ0VCbUJBcTFCWHdoQkFSTzg4dzZMeklDQVJESW4wQmhuT3JhRDJIeE5pVVYxeDJpTm9YVFBQK09qUktBQUFpa1Q2QXdUblh0QmVScVorY09PTTNUNzdISUFRUkFRQjhDVTA3MXAvUXBVZU9TYUMwZ0p5WW5uNkJGTnRzYkZ4MTNRUUFFUU1CZ0FyNi8vZDg5VCt2ZlAyMTlJUEI3R1B6RlFOVkFBQVNpRXREYUg2S3RCUUsvUjlUK2hlZEFBQVFNSnFDMVAwUkxBYUc1MEZnc2FQQTNBbFVEQVJDSVRrQm5mNGgyUTFoWTd4RzlZK0ZKRUFBQmF3aG91ZW1pVmdJUzduT0ZXVmZXZkNsUVVSQUFnZWdFdk1scXRlK09VbWtpZXBSMG45UnFDT3R6MTkwSjhVaTN3WkU2Q0lCQVlRbVVkTnN2U3hzQkNZYXVoTmhTMktaRndVRUFCRUFnYlFLMFg1Wk9VM3UxR01MQzBGWGF2UTdwZ3dBSUdFUkFtNm05V2xnZzJLTGRvSzZOcW9BQUNLUk5vSFMxbytPbHRET0prbjd1QXNKRFY5aWlQVXBUNFJrUUFBRVFtQ0tneVZCV3JrTllHTHJDMXdFRVFBQUVwQW5rUHBTVnF3V0NXVmZTSFFjUlFRQUVRS0QwZVVmSDAzbGl5TTBDd1lMQlBKc2RlWU1BQ0JoQ0lOY0ZocmtJQ0ExZDhSa2ZSN0RtdzVBdWpHcUFBQWprUm9DR2tjWStxMWFYNTdIQU1KY2hMSnp4a1Z0ZlE4WWdBQUtHRWNoenI2ek1MUkIybkY5MTNUSEQyaERWQVFFUUFJRThDZmcrV1NHM2xVcEhzeXhFNWhZSWljZHJXVllRZVlFQUNJQ0FCUVFjSndlSGVxWUN3bzV6YXNobEZqUW1xZ2dDSUFBQzJSS2d0U0hIUC9zczArMmdNaHZDd3BxUGJQc1NjZ01CRUxDU1FLWTc5blptaFpnYzUxdm9mUE55VnZraEh4Qm9SdURpNWN0aTlNUkpjZmI4ZVhITzg4UlorbmZ1dkNmNGZ2RHZ5cFVaVWVmUG1TUG16NTByYnVvcEJmZDdGeTBTTjVWS29uekxJc0hYL0JrQ0NHaENvRFJQQ0Q1SGZXY1c1Y25FQW9IalBJdW1SQjdOQ0xCQUhQemRpQmo3NUJQeDBmRVRnV0EwZTFibS9zSXBNVm5kM3kvNkYvZUpoVDA5TXNrZ0RnaW9JcERaQ3ZWTUJPVGpDeGYyVUVhWmpzMnBhZ21rVTB3Q1kyZk9pSU1qbytJUS9lUHJMQU5iSlN3azk5MjVCbUtTSlhqa05VM0FkNXpYYmx1dzRGdlROMUs2U0YxQXlIRyt6S0ZGZ3ltVkg4bUN3RFFCSG40YU9uUllIQndkRFlhb3BqL0k4WUxGaElWazlVQS9ocnB5YkFjTHM4NWtoWHJxQW5Mc3dnVVdEOHk4c3JBSFoxVmxGbzYzRG53ZzNuNy9nTGhZNTcvSXFnenQ4dUZocnY3Rmk4V205ZmZBS21rSEM1K3JJZUE0UTBzWExMaGJUV0tOVTBsVlFMRGZWV1BvdUt1R1FCR0VvMUZOMTY1Y0NTRnBCQWIzVkJOSTNRcEpWVUNPWDdndzVndFJWazBGNmRsTm9LakNVZHRxYkpFTXJsb3BOcTlmVjNzYjF5Q2dtc0NScFYxZHkxVW5HcWFYbW9EQStnZ1I0MVVsZ1pFVEo4VHpyK3hYUHBOS1pSbmpwTVZDOHNpREQ1Q1BaQ0JPTkR3TEFsRUprRC9kZVdUSmdnVjdvMGFJODF4cUFnTHJJMDR6NE5sMkJOanEyUGVyZDhUYjVPc3dNZkN3RmdzSjFwU1kyTHI1MW9tMkd4bGIzTlhWbDBZcFVoRVFXQjlwTkpXOWFZNmRQaTErdk9kbFk2eU9aaTNKMXNpdTd6NEtKM3N6UUxndlN5QTFLeVFWQVlIMUlkdk9pRmRQNEswREI4VHVOMzVSZjl2bzk1dklMd0xmaU5GTm5IbmwwckpDS0YyMWdhMFBPTTdWTXJVMXRaZmVlTk02OGVDMjNrOURkYnVwN2dnZ29Jb0FuUmxTVG1PalJlVVdDS3dQVlUxdWJ6cVQ1Ty80OFo2OTJpd0d6S3NsK21nUjRrNGEwb0pmSks4V01DdmZOS3dRcFJZSXJBK3pPbHdldGZtVU5qamMrY0xQckJjUFpuK1N0bUQ1aDZlZkRUWjl6S010a0tkWkJOS3dRcFJhSUxBK3pPcHdXZGNtRkEvZS9EQ3J3STVyM2xWM1lhbUhkdGp0bnY1clA5d1E4ZUxsUzdSRDc1WEFnWCtKWHNmT25BNnVlZmZlckFLYzYxbVJOajhmMVZhSU1nSEJ6Q3Z6TzErYU5jeEtQT2JOblNQdVhybUt0aFhwcFg5TFNERG1TRldMUldYMHhISGFzUEVqTVhMeVJMQWR2RlJDRVNOOWlZVHVKMDl1bnhhNGlOSHdHQWpVRTFDNk9sMlpnR0RQcS9wMnd2dW9CQ1l2WFJZN1gveFphcnZtaHFLeGV1RDJZRCtxcU9XSzh4eWZMOEliT2FZcEp2Q0p4R2tSUE51VWdNSTlzcFFJeURIUEd4U3VPOVMwd1BnQUJGb1ErT2tyKzhUUTRkKzBlRUx1SXo0QTZ2NDFhOFRhVmF1a0xRMlpuRmxJOXIzelRpcFd5ZHBWSzhUam16ZkxGQXR4UUNBa29Nd0tVU0lnT084amJCZTh4aVhBVTFaNWhibkt3QmJIdGcwYlNEaFdxa3cyZGxwcENRbldpY1J1Q2tTb0o2RElDa2tzSURodHNMNWw4RDRxZ2Y5Tmh6M3hkRjJWNFg0NmUyUFQrdldaV2h5dHlzOWJzUEQySzZwRmtsZXNEOUQyOEFnZ0lFbkE3NnhXKzNwTHBYSEorRUcweE5ONFAzZmRuVWtLZ0xoMkVtQ24rUjZGaStWNHVPcWZ2cmVkOXBQYW9JMTRjTXZ5R2c2MkdQNzVmL3ozNlRQVlZiVDRUM2hyRjJLSUFBS1NCSnpQaFhoQ011NTB0RVFXeUpUMXdRZEdkVStuaUFzUWFFT0FkaW9RTzE1NFVkbGFEOTJzam1iVloydUVoK3o0OENzVmdZL04vZEYzdjZNaUthUmhKd0Z2a3F5UU8wcWxDZG5xSjdKQVNNRUdLV09JaHl4OVMrTzlUZnRiOGF3bEZXRWJXUnk2V1IzTjZzWFdDSmRWMVQ1WHpGQ1ZHRFVyTSs0YlRhQjdyaEJiazlRd2tZQzRycnNqU2VhSWF4OEJIcnJhLzYvSm5lYnNLUC9oMWkzQmVlTkZvOGhEV2ovWStyRGdPaVFOcjVKRmc2R3NwQlN0amU5MHVPN0RTV292TFNBOGRSZWJKaVpCYjJkYy9zRkxlbTQ1Ly9EKzZEdmZvVU9ZK2dzTDhXdDBnTlF1R241S0tpSzhiOWp1TiszYXJiaXdqYTVud1pjRnl6QWt5eVl0SUw3cmJwWE1FOUVzSmNCN095VmQ3OEZPT3hhUFh0cCtwT2lCRndheWlDUU5CMmsyRzUvVWlBQUNFZ1FjMGRIeGxFUzhJSXFVZ0xEem5MN0lXMlF6UlR6N0NQaGtydkpSdEVuRFk5L2VaSVI0aEJ4WVJCN2Z2Q2w4Sy8zS3pua0VFSkFpNFB1RFJ6eFB5cGN0SlNCVHpuT3BzaUtTblFTR0R4OFc0MlNCSkFuc08rQ2pYMDBMdk9BeHFXT2RIZXF3UWt6ckdablZ4NWtueEhhWjNLUUVCTTV6R2RUMnhpSGpnNGF1RGljQ3NMcS9QL0dQYktJQ3BCejVJUkpIbnBhYkpNQUtTVUxQN3JqMG03NUJoa0JzQVlIelhBYXozWEg0citNazAzWjVrU0JQZnpVNXNHL25CMXVTemN5Q0ZXSnlEMG05YmxMTzlOZ0NBdWQ1NmcxcFhBYkRodzRscXRQbWRldkVRaElSMDhPTjgrWWw5b2ZBQ2pHOWw2UldQNGRHQ2g2TW0zcHNBYUVJZDhYTkJNL2JTNERYZlNTWmVjVStqN3czUmN5eTlWYlQ5TjRrUTFrZmtiWEhLOTRSUUNBdUFjZDF0OFIxcHNjU2tPT2V0NUZVcWh5M1lIamVYZ0w4Z3lZYmVGaUhIZWMyQmE3ell3bG1aYkcvQ2F2VGJlb3hTdXZhZmFNUXkrS2tHRXRBYUw3d2xqaUo0MW03Q2ZEVTNTUS9ab05rZmRnd2RGWGZTNzdVMDVOb3dzQW8xb1RVSThYN2FBUmlyd21KTENDMDlxUGI5LzJOMGNxQnAwQkEwTm5oNTZXbjd0cG9mZFQybVh2WC9KMzBLblcyK3JJOFY3NjIzTGd1T0FIZlh4Wm5HQ3V5Z05EYUQ0aEh3ZnRHMXNVL05Eb3FuYVd0MWtjSWpCM3FYK3NmQ04vR2V1VmhMRjZkamdBQ0VnUzY1OGY0clk4c0lBNkdyeVRhd3Q0b1BId2wreVBtT0k2NDcrdHI3SVUzVmZNa2t3Y09qb3hZenc4QXBBZzQ5RnNmZVlQRlNBTEN3MWVDbHJ0TEZRZVJyQ1J3OGZJbDZiVWY1VVUzaTE3YTRzUDJjRHN0TEpTZGtZWFpXTGIzbmdUMWo3RzFTU1FCd2ZCVmdzYXdOT3I0bVUra2E4N0RWd2hDc0I5STl0aGFIc1lhUzdoMUROckFYZ0pSaDdFaUNZamIwUkY3Z1ltOTZGRnpKakJ5VW03NkxnOWY4YllsQ05jSTNMVnloVFNLSkNJdW5Ta2lta0FnOGpCV0pBSEI3Q3NUK2tTMmRUaDFXbTdqeFBLaUwxczVkYmRaNnl3c2xRVC9rd2xKdG8rUnlROXhEQ0lRY1RaV1d3SGh4WU1HWVVGVk1pREFEblRaYWFTOU45K1NRUW1Ma3dWYlpLc2tEODRhUDMyNk9CVkZTWFVqRUdsUllWc0JxYm91QkVTM3B0VytQTDcwK285VkE3ZHJYN3VzQ3lnN29lQ2M1MkZiazZ3Ynk1ejhJdTJOMVZaQTZJRzd6R0dDbW1SQllFeHkrSXFkeGpmUktteUVtUVI0TnBac1NIcDhzR3kraUZkOEFydzNWcnRhdEJRUW1yNjdqRVlqeXUwU3dlY2dVRXZnMHBVcnRXK2pYOU53amV4ZjI5RXpLZDZUc2o0USt1NEtER01WcjcwMUtuRjN1L1BTV3dySVZTRUdOYW9NaWxJUUFyTCtqL0xOWHk1SURiTXZwcXlJWEx3c0tlYlpWeEU1NmtmQXFiYlJnSllDUXBzbll2cXVmbzJxZllsNDdGMG16Sjg3VnlhYStYSElNdU5EdFdTQ3JKakw1SVU0NWhHZ0pSeGZiMVdycGdLQzFlZXRzT0d6TkFqTW0wc25NeVBNSWdEZjBDd2t1SkVWZ1RhcjBwc0tTS1dONlpKVitaRlA4UWpJSG1nMGIrNmM0bFZXOHhKZnd1RlNtcmVRL3NXN3NhT2o2VVNxcGdMU2J1eEwvMnFqaEhrUndNeWZ2TWpQem5kU2RrTEQ3S1J3eDA0Q2psK3BERGFyZWxNQm9TbGNUVlduV1dLNER3SWdBQUlnWUJpQkZsclFVRURJLzFFbUJNc013NERxWkVSZy9od01SV1dFdW0wMk42SXQyakxDQTYwSmtBK3U2U0ZURFFXRS9COFFqOVpNOFdrTEFwaE4xUUtPNUVlWExsMldpamtQTTl1a3VDSFNUQUxOL0NBTkJRVCtqNW53OEM0YkF1Zk9uODhtbzRMbHdnc0NMMTZSRTVDQ1ZSWEYxWk5BVXo5SVF3R0IvMFBQVml4S3FXUVh2WjA3TDdkK3BDaGNwTXRKQ2lLN0lGQzJMYVRMaW9obUVtamlCNWtsSU1INkR3eGhtZGtKTXFyVmZNbnB1T2NtSmpJcVlkR3lrZCtjVW5ZQll0RUlvYnpwRW1qbUI1a2xJTFI5Q2Z3ZjZiYUY4YW5mS25zY0xlMERqNVhUczd0SGtzMHA0WSthelJOMzVBamMyRUFiWmdrSUpRMEJrZU9MV0ZNRVpHZGg4VmovNlBFVDRGaEg0SnduNlJ2QzVwUjFKUEUyQ1lGR2s2dG1DWWpUWXRWaGtzd1IxeDRDL0ZldjdOajdPTTd4bnRWUkRvMStOT3RlbEJ0OHVpTUNDQ2dpUUgrT3pEN2FZNWFBQ0RyS1VGR0dTTVpTQW55S1hsbHlHT3ZneUtpbDFCcFhtNDZURnJKSDB5NHNmYUZ4b3JnTEFoSUVPbDMzcS9YUlpnZ0lMeUNrWVlSeS9VTjREd0p4Q2ZRdjZZc2JKWGllZC9LRkgrUTZ1ck0wdFZtV3g2MkxicjZlRUs1QUlDRUJXdDVSUHVKNTNiWEp6QkFRY3FDWGF6L0VOUWpJRXVoZEpIZTJPZnRCaGc0ZGxzM1d1SGdIUitVdHN2NEVKeGthQnhJVlVrS2dma0hoREFIQkFrSWxqSkVJRWJnMXdlRlFveWZnU09kT3hNTlh3NGMvbE9wUFBJeUkweDJsMENGU0N3S1ZTcVczOXVNWkF0TFIwVEZyakt2MllWeURRRlFDOCtmTkU3Si9BZk9ZL3doRVJQRDBYZGxKQmYxOXZRSlRlS1AyVmp3WGtjQXNSL29NQWFHL2VNb1JFOEpqSU5DU0FNM1lFS3NIK2xzKzArckQ0VU8vYWZXeDhaL3hVTjdiSDN3Z1hjOVZBd1BTY1JFUkJKb1JxSGVrVHdzSVZxQTNRNGI3c2dSVzljc0x5Q0VhKzVjOW1FcTJ2RHJGTy92blA5UHdsWnlJOHZEVjZnVHNkZUtBc3VoRm9ONlJQaTBnV0lHdVYwT1pVSnFGUFQzU3cxaVRkSkxlV3dmay93SXZNaisyUHZhLzgyL1NWU2pUN0t1RmttZW9TMmVLaU5ZUW1GOHoyV3BhUUdqSVljYjBMR3Rvb0tLcEVlQmhySUhGaTZYVGYvVlg3d2lleG1wYlNHSjlNS3Y3MXF5eERSbnFteTJCNmJXQzB3S0NHVmpadG9BdHVkMjc1dStrcThwL2lmOTAzMzdwK0VXTXlET3ZrbGdmUEh6Vm4wQzBpOGdNWmM2VUFQOWRPRDNaYWxwQTNJNk9Xek10QmpLemdrQ1MyVmdNaUdkazJiUTZuZGZBeVBvK21OZmFsU3N4Zk1VZ0VGSWpRSC9ZbGNQRXB3VUVNN0JDSkhoVlNZRC9YTm04Zm4yaUpKOG5LOFFHaC9xbjVEaC9OWUh2ZzYyUHUxWXVUOFFha1VHZ0hZSGFtVmpUQWtLUnBzZTEyaVdBejBFZ0RvSGJhVVcwN0pvUXpvY2Q2dis0WjIrY0xBdjNMQTlkN1huekxlbHRTN2pDekRpSno2bHcwRkRnWEFqd1RLd3c0MEJBZms5N1lJVTM4QW9DcWdtb3NFSjRLR3NmT2RWTkRJSGZnK3FXWk5zU1pqeTRZb1dKZUZBbkRRbUVtaEVJU0dlTm9taFlWaFRKQUFKSnJSQkdzSjkrWkljT203ZFAxbHNIRGlSeW5ET2IzbHR1RVd0WHJlUkxCQkJJblVEbjFLNGxnWURVT2tWU3p4a1pXRWxBaFJYQzRKNS9aYi8wOWg0NmdqLzV4ejhHUTFkSnlzYStqOGMyUDVRa0NjUUZnVmdFL0VxbHhCRWdJTEd3NGVFa0JIaU1Qc24ySnB3M1QrMTk2b1dmR1NFaUxCNDdYL3lYSkVpRHVEenpTdmI4bGNTWkl3RWJDVGloMFJFSUNCRW8yMGdCZGM2ZXdOWU5HOFM4dVhNU1pjd3pzbGhFaWpxOWwwWHczVU9IQXZHNGVPVktJaFlMdjlBakhscDNUNkkwRUJrRTRoSndIZWV2T1U0Z0lGZ0RFaGNmbnBjbDhDWGFZbVB6dW1UVGVqbHZGaEdlbVZVMHh6bzd6Tjk2LzMzeC9MNVhSVkx4NEdIQkIyalZPYll0a2UyTmlKZUFRSm5qWHJOQWZCL2JtQ1FnaWFqeENOejM5VFdKcHZYVzVzYU85ZDF2dkNrbUwxMnV2YTNsOWVTbFMrSWxLaXRQMTFVUitwY3NGdmZlaVcxTFZMQkVHdkVJa0FWUzVoamhFQmJXZ0RBTmhFd0k4Ri9PajIzZW5IZ29LeXdzYjdyNC9XZWVGWjlxdW04V0QxbXh2K1A3enp3bmZ2bkJyOE5pSjNybG9hdkhObTFLbEFZaWc0QXNBVm9MRWhnZERtL2pmdFYxUGRtRUVBOEVaQW53Mm82blhuaFJObnJEZUp2V3J3czJFN3h4M3R5R24yZDlrNjBPSG1aVEpSeGNmcDUxOVlNdER5ZWVrSkExQytSbkZBRi9zbHJ0WVFGWlJnSnl4S2lxb1RLRkljQkRVS3I5R0F0TEpjRkNNcmh5UmZCam13Y005blh3dmxaNzN2eEZZbDlIYmZuWmV1TzY4VDhFRU1pUmdIKzFXdTF6am5uZW9IRGRvUndMZ3F3dEovRFRWL2JSQWtHNXc1TmFvY3REU05qaVlPRmdpK09zcDk2d3Y1c1dDejYyR1VOWHJkb2RuMlZDd0JmVjZ0M09jYy9iNkx2dWE1bGtpVXhBb0FFQjN1dHFSNHByTzFoSWVJdnp3VlVyUkg5Zm4zS3JoSzBOUHNQOTBNaG9zSk51MHRsVkRSQUZ0M3IvNmhheDY5Rkg2YXp6Wk5PZ202V1AreUFRZzREdlY2dmJuSTg5YjZ2anVydGpSTVNqSUtDY0FJdklQNUFqL054NTlYKzExeFkyRkJOZTBIZ3JuOXhINGtLS0luaG9LR3Bnd2VCcHhPekRHU1hoNE8zWDB4S05zRXpzTkdmeHdKVGRrQWhlY3lad1RVRCs0SGs3WGRmZGtYTmhrRDBJMEN3cVQreDQ4Y1hVUmFRV05RdklUYlEycFhmUklwb1ZOamNRRkg0TkZqdVNVUHpKbXdnZVo0SDdFdzFKOGJEVStPa3pxUXhQMVphcjlocmlVVXNEMTdvUXFGYXJ1OWdDZVpZc2tDZDBLUlRLWVRlQlBFUkVaK0k4YlBXRGh4K0c1YUZ6STFsYU5ockNldGFsT2VwWVJHaHBCOUN4MnJ4Uy9aKyt0eDE3TzFIakROQkNRUXhiNmRoTFVTWW1RTlBKdTJnWGs0NHU0QUFCblFqY1NFTkkvL1BKN2VKK1MxZFo4enFQQjJpMS9xN3Z3R0d1VTc5RVdXWVNvSDdxZE1JQ21Ra0Y3L1FoOE1pREcyakcwZHpnSEJEcXAxWUVGbzl0R3g3QUZpVld0SGF4SzBtVFNXNTFqbjMyMlpEdy9jRmlWd1dsTjVtQUxYNFJkcGF6djZQM2xrVW1OeWZxWmdvQjN4OXlqbDI0Y0lUcWc3MndUR2xVUSt2QjAyWjUxVHJ2ZTJWYVlLdmovalYvSng1YXZ4NXJQRXhyWElQclF4c3Bqam5ITDF3WW8rR0Jzc0gxUk5VTUluQndaRVM4Uk51RHBMMWVKQ3RrYkhVOHZ1bWhZS0ZqVm5raUh4QlFRUUFDb29JaTBzaUZBRnNqNzlMNTZFVVZrdm0wMlNPZjVYSHZuWGZDNnNpbEJ5SFRwQVFnSUVrSkluNnVCTTdTd2tNV2ttRVNrcUk0MlNFY3VYWVpaSzZRUUNBZzVBTXB5bmRQWWRXUmxFa0VRaUVaT1hsQ1c0c0V3bUZTajBOZHBnajQ3RVNIZ0tBL0dFSGc0dVVyZEU3NlNPQm9QM1htVE81V0NUdkgrL3Q2eGFyK2ZyRjIxU29NVlJuUnkxQ0pHZ0lRa0JvWXVEU0lBRnNsYjlPTUxkNGxOMHN4WWRFbzB5YU5xMGswZU1QR011MnhoUUFDaGhLQWdCamFzS2hXRFFFV0U5NDE5K0RvcUJnankrUlA5SjZEQ3RPYkJZTTNaTHg5Y1o4bzMwekM4YmNEMTNiNHJja2ZseUJnS0FFSWlLRU5pMnExSU1CRFhlTWtKR09uVDR0enROdnVXZTk4c0QwN3oraTZlT1d5dUhUbC84Nkl6VHZ6M3ZnZjU0aDVOSE1xMkwyMzFDTnVLblVIR3h6MkwxNkNvYWtadFBER0lnSVFFSXNhRzFVRkFSQUFBWlVFZkpxSmhRQUNJQUFDSUFBQzhRbEFRT0l6UXd3UUFBRVFBQUVpQUFGQk53QUJFQUFCRUpBaUFBR1J3b1pJSUFBQ0lBQUNyaVBFT0RDQUFBaUFBQWlBUUJ3Q1pIMk13d0tKUXd6UGdnQUlnQUFJVEJPQWdFeWp3QVVJZ0FBSWdFQWNBaENRT0xUd0xBaUFBQWlBUUVDZ0lzU0U2enZPT0hpQUFBaUFBQWlBUUJ3Q2p1OVB3QUtKUXd6UGdnQUlnQUFJVEJOd3E1WEtxZWwzdUFBQkVBQUJFQUNCQ0FTcXZuOEJGa2dFVUhnRUJFQUFCRUJnSmdIWGNieE9XZ2N5TWZNMjNvSEFiQUlxdGo2Zm5TcnU2RWFBZmc4UVFDQVNBWjhza0U3NllaaEFwNG5FeTRxSHFGUFE5dWFlK09qRXllQ1Zyem1jTzMvZWl2cmJYc241YytlS2VmU1B0NjN2cGNPd2J1b3BCZWVjOExrbkNDQlFTNEMxZ3kyUThkcWJ1TGFQQUl2R3lNbVQ0dkRJcUJnNmRKak94TGhpSHdUVXVDa0JGcFAreFl2RjRLb1ZkRVJ2bjRDWU5FVmwwd2MrYWNjcDUyUFAyK3E0N202YmFvNjZYaU13ZWVtU2VQdURYNHUzM3o4QTBVQ25pRVNBeFdUVCtuWEJDWXhmNnVtSkZBY1BHVW5BcDc4a3Z1a2M4N3hCNGJwRFJsWVJsV3BJZ0F3T0VvNERZdisvdmdQaGFFZ0lOOXNSQ0lWa2NPVUtXQ1R0WUpuNXVTK3ExYnVkMzN0ZXVkTjF4OHlzSTJwVlQrQWtIZVA2ei90ZURjNEdyLzhNNzBFZ0xnRVdrcDNmZlZUQUdvbExydkRQKzM2MXV0d1o4N3p1cTY1N3pWTmErRHFoQXEwSXZIVUFWa2NyUHZoTW5zQWpEMjRROTkrNVJqNEJ4Q3dhQVgreVd1MEpwbFljdTNDQkJhUzdhRFZBZWFNVDJQK3JkOFErK29jQUFta1JZTi9JWnZxSFlBVUJmMmxYbDl2SlZTVVZtYUJoY1FpSW9lMyswMWYyaWFIRHZ6RzBkcWlXTGdUNGo1UkxseThMdGtZUXpDWkFlbkdVYXhpc1JNZUdpdVkyTm4rcElSN210cTl1Tlh2cndBZXdkSFZybEJUS3d4c3BjcktCZ0dBL3JCUUlhNUFraHEwMGFBUUxpOEQ5am9VRXdXZ0M0MXk3Y0MrczRBM2ZRRENEd0tlMGNodytEelBhc29pMTJQM0dtMkxreElraUZoMWxqa0NBTmxJOHhZOEZBa0kra1BFSWNmQklnUWpzZk9GbkJTb3RpbW9pZ2VkZjJTOHVrazhFd1RnQ3dTcDBybFVnSVBSZk1KNWxYRFV0clJBUElZUjdXRm1LQU5YV2dBRDNRUXhsYWRBUUtSUWhORG9DQWZsOHlxT2VRajVJTW1NQ1p6RjBsVEZ4Wk5lS3dDL0pGd0lycEJXaFluNTJkV3JVS3BqRys1VlNhWnpXZ2hTekppajFEQUpzZmFnSzlGZUdLTit5U054S3U3SWkyRUdBcCtHZVBlK0pVMmZPQ0pxcW1UaE1VbnBzaFdCOVNHS1VXaVhBbXNFRkNnU0VMOWdrb1E1VDVtdUVZaEpnNjBQRmxOMzVjK2ZRcXVJN3hYMzBqNjhSN0NQQUlqSjgrTEI0bC82ZG8rc2tnYTBRWHFYT1c4VWpGSjlBdUFhRWF6SXRJTFFqMmxIaCsrWGlWOC9lR296U0dSNUp3MXJhSE8rUkJ4K0VjQ1FGV2ZENEMra2NFRjVaUHJoeXBXQ3Jkb2lFUkRhd0ZjSi8yR0NyRTFtQ2VzV2pQYkJPaFNVS2ZDRDhCbXRCUWlURmZVM3lKZWRhOHcvRzQ5L2VEUEVvYmhkUVhuSVdrc2UvdlNueEVOVEJrUkhsWlVPQytSRGcwYW93NTJrQm9SdkIwdlR3QTd3V2l3QVBYeVd4UUxDUFViSGFPK3ZTY3Y5SVlrSHdDWmR3cG1mZGFxbms1enNkSGNOaHl0TUNjZ01FSkdSU3lOZHhjbnJLQmo2MkZFNU9XWHIyeE51NllZTW9TMDZvWUlmOFFUcnhFc0VBQXBYSzlJeXJhUUdoYW8wYlVEVnJxekNTd1AreGVSMTJVTFcyNDhTb09CK0x2aTNCUm9sSi9zaUpVVXc4bWpLQnlScGpZMXBBZWt1bGlkcXhyWlRMZ09RVkU1RDljckwxc1hiVlNzV2xRWEttRXJpOXIxZndJVkl5NGF5SDljb3kzSFNLd3pPdzdpQ3RDTXMwTFNEQkRaNkpoVkJJQWhjdlg1RXE5OWY2KzZYaUlaS2RCQnd5UTFZTnlQV1pVM1FhSmtLeENkVE93T0thekJBUXYxSjVyOWpWczdmMFo3M3pVcFh2WDl3bkZRK1I3Q1V3SU5sbkxsNlIreVBIWHRKYTFueUdrVEZEUURDRXBXV0RSU3JVSlVrTFpCNFdkMFhpaTRldUUvaGlxZWY2bXhoWEVKQVlzUFI4MUNmQm1HRmt6QkNRRGlHRzlTdzNTcFVXZ1lVOWNqOEdhWlVINmVwUEFMc1Q2TjlHYVpXdzFvSE9lY3dRRURqUzA4S09kRUVBQkVDZzJBVElnVDVlNjBEbjJzd1FrS0I2Y0tRWHU1VlJlaEFBQVJCSWdRQTUwSDlibit3c0FZRWp2UjRSM29NQUNNd2d3S3NDRVd3ajRGT3pEOWRYZXBhQTBBTXp2T3oxRWZBZUJFREFiZ0xZa3NUTzlpY2ZlWHNMaExibmhZQlkxRDk0RHkwRUVJaEQ0QkttNDhiQlpjeXo5UTUwcnRnc0M0UWQ2WFFmSWxLd1pwZGRIY3dIQ0NHQVFCd0NGeTlmaXZQNDlMTUx1N3VucjNGUkxBTDFLOUREMHM4U0VQNkFuQ1V6NXZxR0QrUFZQQUxZWHNLOE5rMjdSbWNuK0cvTStHRWVEaWVMRDAyWEdFMDBvYUdBME0xaFhjcU5ja1FqSUx0TDZsaUNYWHlqbFF4UG1VWkE5b1JDbkVoWTJKN0FXN2dQTlNwOVF3SEJnc0pHcVBTK04yK2UzSEdoNDlpZlNPK0cxYXgwUHMzRmtUMTNSdmFQSE0wUVdGbWN5VXJsL1VZVmJ5Z2c4SU0wUXFYM3ZkNUZOMHNWY1B6TUp6am9SNHFjblpGNEJwYjh6cy9ZOWFDSXZhYVovNFByMGxCQStBUDRRWmhDY1VMdm9sdWtDNHVEZnFUUldSY3hTVjhwUy82Ull4MWszU3JjeFAvQnhXd3FJUFRCc0c3MVFIbWFFMGp5NVV4NmxucnpVdUVUa3dqd1NySkRveDlKVlltM2dlK1ZQTTFRS2tORVVrV2dxZitETTJncUlQQ0RxT0tmVFRyc29KUWRZOFl3VmpadFZQUmN6cDcvc3pnNEtuY3NiWG5SbHdXYzZNWHNBYzM4SDF5YnBnSVMrRUVjWjdpWVZiYXoxTEpuZS9DNDlsc0hQckFUR21vZG1ZQ3M4NXd6R09oYkhEa2ZQS2dSQWQ4ZnJ0OUFzYlowVFFXRUg2cmlnS2xhVnRwZmYyMWdRTHFNYjVPQVlJc0thWHpHUitUWlY2Kys4MjlTOWFSemhzUkt5Vk1NcFRKRUpGVUUvSXJ2djlFcXNaWUNRaDhPdDRxTXovUWl3SDRRMmNWYXNFTDBha3ZkU2pOOCtEZmlyT2RKRldzK1RURWZXQXdMUkFwZXpwRklBMW91S204cElFdExwV0Vxdjl5eTA1d3JibVAyUE1hOGR1Vks2YXJEQ3BGR1ozVEVULy84WjdIL1YrOUkxM0Yxdjd4bExKMHBJaVltUUhNbXhtOHJsVnB1YTlWU1FMZ0VOSjEzYitLU0lJSE1DQ1FaeG1JckpNa1BSV2FWUkVhWkVtRC9tS3oxd2NOWGQ2MWNubWw1a1prYUFnNzVQOXFsMUZaQXFBTzgzaTRSZks0UEFYYWt5ODdHNGxyd2o4WElpUlA2VkFnbHlaVUFXeCsvL09EWDBtVzQ2UXM5R0w2U3BwZHJSRis0YnR2Zi9yWUNNclc5TzRheGNtM0xlSm12WGJVaVhvUzZwNTkvWlQ4YzZuVk1iSHc3ZWVtUzJQbml2eVNxK3FaNzdra1VINUh6STdCMHdZSTMyK1hlVmtDbXB2TzJIQWRybHdrK3o1WUErMEZrbmVsY1VoNnV3RkJXdG0ybVcyNDg2Mm9mK1Qxa2g2NjRQZ3ZKK2xpN1N0NG5weHNUbThwVHJWWmJ6cjRLV2JRVkVINlFqcm1GSHlRa1ZvQlhkcVkvY09lZGlVcktRMWxZRzVJSVlXRWprL00wK0FNaXlkQVZWeDdXUjNHN1FJZnJ2aGFsOUpFRTVBYjRRYUt3MU9xWisrNWNrOGdLNGNyc2Z1Tk44VHY0UTdScTF5d0tNM0w4dU5ndnVlWWpMQitzajVCRU1WLy9VcTIySGI3aW1rVVNFS3hLTDE0bllDdGs4N3IxaVF2K2t6MHZTKysrbWpoekpKQTVnWk4vL0tQZ05rOGFZSDBrSlpoai9EYXJ6MnRMRmtsQU9BS0dzV3F4RmVQNi9xK3ZFYkxibTRRMTVLbTkvN2g3ci9nVVo2ZUhTSXg5NVJsWFA5bjd2OFRGaEdlZXcvb29kQmZ4YWVQTFBWRnJFRmxBcG9heE1Cc3JLbGxObnR1OFBya1Z3bzdVblMvOERDS2lTWnVtVVF5MlBIakdWUktuT1plTGQ5M2Q5ZWlqYVJRUmFXWkVJT3J3RlJjbnNvQmdObFpHcmFjNEc3WkE3aWQvU05MQVB5emZmK1k1REdjbEJhbGgvTitSejBPRmVIRFZOcTI3Unl6c0tXbFlTeFFwQ2dHZWZkVnE4OFQ2TkNJTFNCQ3hVdGxWbndEZTYwOWcwL3AxaVJZWGhqWGs0YXovOXZTem1KMFZBakhnOVJmdnZ4K0lSOUpoSzBiQlExZmMxeEFLUzhCM096cDJ4eWw5TEFIQm9zSTRhUFY1bGgzcVA5eTZKZkdzckxCR1BEdUwxd2p3ZEUrRVloTGdkUjR2VVR2dWVmTXRKUlhnRFJNeGRLVUVaVzZKOE41WFVSWVAxaFl3bG9Ed01CYjJ4cXJGVjV4ckhsWlFNU3NyckRFdk5Oenh3b3Z3aTRSQUN2VEt6dklkTC81TThPYVpLZ0w3UGI2OWJoMkdybFRBekRHTktIdGYxUmN2bG9Cd1pPeU5WWSt3T085NVZwWUtmMGhZWXo1Z2lKM3JRNGNPaDdmd3FqRUJQcEtXL1Izc3kwcHlPRlI5RmRudmNhOENQMXQ5dW5pZktRRmYrUDdMY1hNa1BZZ2ZqbDI0Y0lSaUxZc2ZFekYwSVBBVVdRNHFmMEM0VHJ4OXlrUHI3eEZmNnVuUm9Zb29ReDBCM3RlS2h4MlRyaTZ2UzFZTUxGa3NkbjBIczY3cXVSVHRQZjF0TVhaYlYxZGYzSExIdGtBNGc2ajdwTVF0REo3UGhnRDdRMjVTUEZObTZQQmhXQ1BaTkYrc1hOalhFVm9kcXNXRG5lWS8yTElsVm5ud3NKWUVmQktDblRJbGs3SkF4anl2KzZycnloMVBKbE5LeEZGTzRPeDVUenoxNG92aUhMMnFEckJHVkJPVlM0OTlIYy92ZjFXNXRjbWxZZkZncHptbTdNcTFqV2F4L0t2VmF0OVhTcVh4dU9XU0VoRE81TmhubnczUm1ObGczQXp4dkQ0RTBoUVJyaVg3VzNoc0hNTmEyYlk1RDFmeFJwaXlaNWkzS3kzRW94MmhnbjN1Kzd1WGRuZHZreW0xdklCNDNpQWRPRElra3luaTZFTWdiUkZaV0NxSlFkclNlM0RsQ2doSnlzMGVDc2N2U1R4VXJPdG9WRnlJUnlNcWhiN25rMC9pN3FuankyTlhSRnBBT0NjNDAyUHoxakpDMmlMQ2xZYVFwTmYwV1FoSDBJWVl0a3F2RVhOS1dkWjVIaFkzbVlCNDNuYXlRcDRKRThOcmNRbXdpUHg0ejE0eGR1Wk1xcFdZUDJlT1dEMHdnQmxiQ1NtemMvd3NiWEE1ZFBnM0lrMkxJeXhtNzEvZEV2Zzg1cytkRTk3Q2EvRUorQ1FBVzVkMGRiMHNXNVZFQWpMbFRCK2p6THRsQzRCNGVoSGdWZVpaSFNTMWVxQS9tUDY3cXYvMllCTSt2VWpvV1JvV0RqNnpudjBicXFkaU42b3gvMER3cVlKYk4yd1FFSTlHaEFwOXp5UG4rWElaNTNsWTYwUUN3b2w4N0huUE9xNzdSSmdnWG90UGdGZVo4NXFCckFJUGIvVXZYaHhZSlF0TFBTUW1XZVZjakh4QzBXREJ5TUxhQ0tud0NuTmVKSWo5clVJaWhyMG1jSjZISkJKL1ZYL3ZlZVZPMTJVckJNRWdBZ2RIUnNSTGIvNGlsV20rclREMUxsb1VPTnhYa1hYQ3dzSS9ZamFHWUlpS2RrRG1JYXFQeU9MSXd0cW81Y3g3Vy8xd3k4T0JzTmZleDdVeEJLU243dFlTVVBMdHhKVGVXcVRtWEdmbEYybEdqQVdFaDdsWVRQcjcrdml3Q2Q1S3g4aEF6a3c2dGUzYThOU2hrVkZ4YVBTanhHZHp5SUJpdnYyMHV2eXhUWnV3eGtNR1lGSGlLTEErdUtwS3ZvL0hNS1czS04xR3FwdzhwTVgvZ2g4NXFSU1NSMkxuZS9tV1JXSjFmMy93V25SQnFSV004ZE5ueEtHUFBoTDhtdGIwMnlndHdOYmV0ZzBQWUYrcktMQ0svVXlpcWJ1MVZWY2lJSndnckpCYXJPWmRmMHF6dEhha3RISmRobFlvS0R6a3hmNFQzcHFsZlBQTldsb3BaRmhRb0ZsVE5DVEZRMUduYUtZYnozYkxXekJxdWZNc3E4Y2Vla2owa2tnam1FMkF1dU1SMnZkcXVZcGFxaE1RV0NFcTJrUDdOSFN3UnBwQkNrV0Z6ejhwazdEd1A1NDV4TUxDOTRLUXdqQllhRTF3K256b0ZndkZxVE9maUVtNkh2L2tFM0dLTEF1ZWNwdW5kWEd0OHJQL1oxL0hBMnZXMEFRR0hBUTFtNDZSZHhKUDNhMmxva3hBT05HUEwxd1lvd1RMdFJuZzJqd0M3QnRoSWVFTkZJc1UyS2ZDbGdxTHlUejZ4Kzg1aEs5OHpmZm4xYTUxSVBQaFQ5NEVmeFFFRm90ekpCRGhLOTg4UitMQWU0cXhlT2dvRWtIQjYvN2o0YXJiKzNyRjQ1czN3OWRSeDhia3Q5UnZwWGJkYmNaRXJZQjQzbGFhMHJ1N1dXYTRieFlCUGdkazN6dnZaRDVUeXl5SzJkZUd0eU41Zk5ORG1HR1ZQZnE4YzFScWZYQmxsQW9JSndncmhDbllGU0FreFdodkhxN2lrd054K0ZNeDJrdDFLVlZiSDF3KzlRSUNLMFIxdXhjbVBRaUpuazBWK2pudXZmTk9yQ2JYczRteUtKVnk2NE1MclZ4QU9GRllJVXpCM2dBaDBhUHRJUng2dElNT3BVakQrdUI2cFNNZ3NFSjA2RE81bHlFVWtqK1JnNWs2TUVJR0JOZzUzcis0VHd5dVdCRnNXb245cXpLQXJuOFdxVmdmWE8xVUJJUVRoaFhDRkJDWUFLOTlZREVacGxsYkVKSjAra1FvSEx4M0ZhK0xRUUNCa0VCYTFnZW5uNTZBd0FvSjJ3K3ZVd1I0K3U4bzdldkVNN2RnbFNUdkZvRm8wRlRjQVJJTStEZVM4elEwaGRTc0QrYVZtb0J3NG5UZzFJZjBjZ2RmSTRCQUxRRmVpZjMyK3grSWtaTW5JQ2ExWU5wYzh4ZDJIczJtdW52RlN0b2o3SFpZRzIxNDJmNXhtdFlIczAxWFFMQTYzZmIrRzZuKzRSQVh4S1F4THJZMGdvMGxhUjh3aUVaalJyamJrRUNxMWdmbm1LcUFjQWJZSTRzcElFUWx3SmJKNlBFVDR1RG9xUGpvNUZpd1E2MXRmcFBReXVpbExWaFdrV2lzL3R1QkdhdmxvN0xFYzVZVDhQMFBsM1ozcjBpVFF2b0NBaXNremZZelBtMjJUdmdFUHZhZG1Db290WUxCRG5DZVJWVmVkQXZXYkJqZnUxT3RvSkx6UHRxVk1IVUI0UUljLyt5em45TUJPZDlzVnhoOERnTHRDTENnakowK0xjWnBzMEsyVms3UlpvVjhqa1pSckpUZ0MwZERVdVZGTjEvYjhKR3NERDUvZzNjVlJnQUJaUVFVbmZmUnJqeVpDTWpVcVlWSHFEQTRPNzFkaStEejJBUllTSGhEd3pFU2xYRzY1dGxlNTd6ejR0TGxLOU5wWlNrd29Vandwb3pzdStCZGdXK2kxK0NhdGt1SFdFdzNDeTdTSVpDSjljRkZ6MFJBT0tNL2VONU8xM1YzOERVQ0NHUkI0Q0lKeU5rcEllSHQxSG1iZFJhVnlTdVhBOEhoTXZCMFlnNHNNT2NtcnUrNkc5eXMrMjloOTlUZlAyUkJmTEhVSFh4NXZ0alRJMjZjYzIwSFh4WUlYcmgzRTkzanM5MnhpSzhPSU41bVFZQVBpOXExdEZUYWxVVm1tUW5JbU9kMVgzWGRrMVNwYTN0b1oxRTc1QUVDSUFBQ0ZoR2dQNFRHTGxhcnkrOG9sVnIvTmFTSWlhc29uYmJKOUZLRi9HcjF5YllQNGdFUUFBRVFBQUVaQWo3OW9PL01Tank0Z0psWklDRU5tdGI3TGprOTE0YnY4UW9DSUFBQ0lLQ0FRQWJUZHV0TG1aa0ZFbWJzVnlxd1FrSVllQVVCRUFBQk5RVDhxNzcvOTJxU2lwNUs1Z0p5VzZsMGxKdzh6MFl2SXA0RUFSQUFBUkJvUWNBbjk4QnpYeW1WeGxzOGs4cEhtUXNJMTZKVGlGM3M3RW1sUmtnVUJFQUFCQ3dpUUwrbDR4ZnBOeldQS3VjaUlPeFFkNnJWYlhsVUdIbUNBQWlBZ0VFRU1uZWMxN0xMUlVDNEFEUlBlVmc0emxCdFlYQU5BaUFBQWlBUW1RQnR3ZUR2V2RMVjlYTGtHSW9mekUxQXVCNVhLeFcyUXE2dDVGSmNNU1FIQWlBQUFpWVQ0S0VyY3B6L0tNODY1aW9nZ2RPbldzMFZRSjd3a1RjSWdBQUlTQklJaHE3eWNKelhsamZ6ZFNDMW1ZZlhXQnNTa3NBckNJQUFDTFFsRUF4ZDBWYnRQSUtUYThqVkFnbHJqcUdza0FSZVFRQUVRS0ExQVIyR3JzSVNhaUVnR01vS213T3ZJQUFDSU5DU2dCWkRWMkVKdFJqQ0NndURvYXlRQkY1QkFBUkFZQllCYllhdXdwSnBZWUdFaGVtc1ZMNUYxNWlWRlFMQkt3aUFBQWhNRWRCcDZDcHNGSzBFaEJjWTBqWW5MQ0lJSUFBQ0lBQUMxd2xvTlhRVkZrc3JBZUZDQlFzTXNWZFcyRDU0QlFFUUFJRmdyNnM4Rnd3MmF3S3RmQ0JoSWZud3FjOWQ5ME1xWEc5NEQ2OGdBQUlnWUNNQkdybzZlVnRYMTJJZDY2NmRCY0tRZUNpclVxM2VUWmZ3aCtqWWExQW1FQUNCckFoNDlGdjRqYXd5aTV1UGxnTENsY0RVM3JoTmllZEJBQVFNSThCRFY3dnlYbTNlaXFtMkFzS0ZKbi9Jc3pnN3BGWHo0VE1RQUFGRENRUitEem8vNlRtZDY2ZTFnREE0bkIyaWMvZEIyVUFBQk5JZ1FINlBzYnpPK0loVEgrMEZCUDZRT00ySlowRUFCQXdnRVBnOTd1QmxEWm9IN1FXRStmRVlJSTBGNGl4MXpUc1RpZ2NDSUpDWWdFK3pUN2ZyN1Blb3JXRWhCSVFMVEdPQmU4Z2ZzcXUyOExnR0FSQUFBWU1JK1B3YnArTjZqMmFNU2V5S0ZiQmZWckhhQzZVRkFSQ0lSc0R4L2RlV2RIY1hhaWVPd2xnZ1lSUHdmbG5zWUFyZjR4VUVRQUFFaWs2QWY5TSs5LzNDRGRNWHpnTGhqdko3enl0MzBrcDF1aXdWdmVPZy9DQUFBdFlUOEs1V3E4dUw0dmVvYmEzQ1dTQmMrQUQwdFUwWFNiZ1JRQUFFUUtDd0JIeGFhZjVJRWNXRGlSZFNRTGpnVTVzdUZzN2s0N0lqZ0FBSWdBQVJDSnptZjFNcXZWRlVHb1VWRUFZK3RWSWRNN09LMnZ0UWJoQ3dsMEFnSHZRYlZ1amZyMEw2UU9yNzNNY1hMdXltaW15dHY0LzNJQUFDSUtBaEFkNm1aQzh0VFhoRXc3TEZLbEtoTFpDd3BqZFVxOStqNnlQaGU3eUNBQWlBZ01ZRWp0STJKZnliVmZoZ2hBWENyY0F6c3pwYzkxMnFVRy9oV3dVVkFBRVFNSklBVDlmbG95cUs2alN2YnhSakJJUXJCaEdwYjE2OEJ3RVEwSVdBYWVMQlhJMFNFSzRRMW9nd0JRUVFBQUdkQ0pnb0hzelhDQjlJYlVkaDA1QWNWSGZUUFp4bVdBc0cxeUFBQW5rUk9FOTdYSDNMbEdHcldvakdXU0JoNVQ3MnZHWE90ZFhxeHRZeHJDdGVRUUFFdENYQU02NlcwNHlybzlxV01FSEJqTE5BUWhiY1lOUncyK2c5VnF1SFVQQUtBaUNRSlFIZm9WWG1wb29IZ3pUK3IzT3lSTGFTSmZLU0RYWE44cHVCdkVBQUJGb1NDTVJqU2FtMHQrVlRCZi9RZUFIaDlvR0lGTHlYb3ZnZ1VDd0NWb2dITjRrVkFzSVZoWWd3QlFRUUFJR1VDVmdqSHN6UkdnSGh5a0pFbUFJQ0NJQkFTZ1NzRWc5bWFKV0FjSVVoSWt3QkFRUkFRREVCNjhTRCtWa25JRnhwaUFoVFFBQUJFRkJFd0VyeFlIWldDZ2hYbkVTRTE0bThTNWM0MVpDQklJQUFDTWdRT0UvTEJiNWg4bFRkVmxDTVhRZlNxdEw4MmRRNmtidDVpNEYyeitKekVBQUJFR2hBd0dyeFlCN1dXaUJoWjhBR2pDRUp2SUlBQ0VRbFlPcmVWbEhySHo1bnZZQXdDSWhJMkIzd0NnSWcwSTRBeE9NNklXdUhzSzRqRUlJM09lTTkrdWtlRHFXcUJZTnJFQUNCV2dLa0hlS0lTZWQ1MUZaTzVob0NNa1dOUmFTVFJJUjZ5QjRaa0lnREFpQmdOSUhnR05wSmd3NkRVdEZhR01KcVFQR1k1KzBVcnJ1andVZTRCUUlnWUI4Qm43WmozN1cwVk5wbFg5VmIxeGdDMG9UUGxJZzhSUitEVVJOR3VBMENGaEJneStON05HdnpPUXZxR3J1SytIRnNnZXk0NTIzMHIrM2tpN1VpTFRqaEl4QXdsQUFmQlBYM1pIa01HMXEveE5XQ2dMUkJpQmxhYlFEaFl4QXdrQUQ1UWsrU3Mvd2JKcDRpcUxLNTRFUnZRek9jb2VVNHptdHRIc1hISUFBQ3hTZmdDOThmdWxpdHJvQjR0RzlNV0NEdEdVMC9BYi9JTkFwY2dJQ0pCT0FzajltcUVKQ1l3S1kyWW55YW9zRXZFcE1kSGdjQmpRbDRkUHpzOTB3L1FWQTFmd2lJQkZINFJTU2dJUW9JNkVuQUozL0hHUHdkY28wREg0Z0VOeDRidmFGYVhVNHpOSjZsNk5UL0VFQUFCQXBJZ0tmb1BnZC9oM3pMd1FLUlp4ZkVKTC9JZGxwMHlPdEZNS1NWa0NXaWcwQ0dCRHdTajExWTM1R01PQVFrR2I4Z05vYTBGRUJFRWlDUURRRU1XU25rakNFc0JUQjVTT3UycnE0K0RHa3BnSWtrUUNBOUFoaXlVc3dXRm9oaW9EeExpNGUwQ0d5djRxU1JIQWlBZ0R3QnJDcVhaOWMwSml5UXBtamtQcUF4MVQyODNUT05yKzZoRk9CZ2w4T0lXQ0NnaWtDd01KQjIwVjJNTFVsVUliMmVEaXlRNnl5VVg4RWFVWTRVQ1lKQUhBSndsTWVoSmZFc0JFUUNXcHdvN0dDL3dYR2U5aDFuSThVRDd6anc4Q3dJeUJGZ3EyUDRxdTl2dzNZa2NnQ2p4c0lQV2xSU0NaK0ROWklRSUtLRFFEUUNzRHFpY1ZMeUZBUkVDY1pvaVFUVGZZWFk0Ymp1Rm9vQjl0R3c0U2tRaUVMQWQzei85Yzk5LzBsWUhWRndxWGtHUDJKcU9NWktCZFpJTEZ4NEdBUmFFZUIxSGVPMGo5VTJPTWxiWVVybk04ekNTb2RyeTFSNXBoYTJRbW1KQ0IrQ1FCUUM0YnFPNVJDUEtMalVQd01MUkQzVFdDbnlzRmFuNi82Y0lpMmpmMmlQV1BUd3NLVUVBaWU1VDhOVjlNZllVVXNaYUZGdC9HQnAwUXhDWUZoTGs0WkFNWFFtd091cUp1aEhhL3VTcnE2WGRTNm9MV1dEZ0dqVTBvRTFJa1N3a3AyS2hiYlJxRzFRbE53SmVMUlYwSE9UUWp4M1I2azBrWHRwVUlDQUFINmtOT3dJbUsybFlhT2dTSGtSd095cXZNaEh5QmNDRWdGU1hvL0FQNUlYZWVTckFZSEF6MEVMQW44RUI3a0dyZEdrQ0JDUUptQjB1bDNqSHlsVHVkQm1PalVPeXFLYUFQczVqdEp3MVpNUUR0Vm8xYWVISHlQMVRGTkxFVUtTR2xva25EK0JZRDBIclN2WUNRZDUvbzBSdFFRUWtLaWtOSG9PUXFKUlk2QW9TUWxBT0pJU3pERStCQ1JIK0VtemhwQWtKWWo0T1JLQWNPUUlYMVhXRUJCVkpITk1CMEtTSTN4a0haY0FoQ011TVkyZmg0Qm8zRGh4aThaQzRqak9meFdPZzFYdGNlSGgrYlFKWUZaVjJvUnpTQjhDa2dQMHRMTTg1bm1ETkpWbEMzYjlUWnMwMG85QUFNSVJBVkpSSDRHQUZMWGxJcFM3WmtIaWcvUjROLzFEZTBmZ2hrY1NFd2kySEtGam5mZFdhT1U0dGxkUHpGUGJCUENEb20zVHFDdllsSkFNQ3RkOWlocThUQ21qM2RYaFJVclhDYkMxY1pTR1VmZjhwVnA5R1Z1T1hBZGo2aFYrU0V4dDJTYjFxaHZlNHFmUUI1cXd3dTNJQkRCTUZSbVZXUS9peDhPczlveGNHMWdsa1ZIaHdjWUVBbXVETEk0M3NNRmhZMEEyM0lXQTJOREtiZW9ZV2lVMHhIVVhkWWd5UFk1KzBZYVpwUjlQK3phb2c3eUJyVVlzN1FVMTFjWVBSUTBNWEFweDNQTTIwalRnaDMzSDJUakZBMzNFN280UmlBYjdObmhqUTdJMmpzSzNZWGVIcUswOWZoeHFhZUI2bXNBUnordWVMOFJHY29nK1RJSXlPUFVCK3NzMElhTXZwa1dqNnZ0N0w1RzFBZEV3dXIybEs0Y2ZCR2wwOWtRTXhjUjFuQTJ3VEl4dGQ0aUdzVTJiWHNVZ0lPbXhOVFpsSHVhcUN2RmdqYytFNjRxK1ZMd1duK0hUd1BCVThSb3c3eExqUzU5M0N4UThmOW8rWlZrSE9kOXBxT05CREhWcDM1Z3NHSUo4R2NQMDd6MjZlZytPOElBSS9wTWtBQUdSQklkb3N3bndVTmQvRW1LUXJKTzd5SGR5MTlTZVhQd2crdGxzWEZuY0NRWGpxRStDUVkwd1RGYkdlL0JuWklIZWpqend4YmFqblhPcFpRdEI0ZktnNzZsdGxXdGl3V25TakNrSWhscTRTSzB4QVh5SkczUEIzUlFJc0tEY0tNUXkxM1cvU2o5d2QxVnAxMkRxZ09XcHJOQVhvek9mRmd2aU9FNm4rQjBsYTIrWTlwNzZQL0JqUkllSUo1TVR3SmMyT1VPa2tJQkFLQ28wN0RYWTRUai9oWDRaeXpWRFg1eXk3WDIwbVZpY3duQlVnbzZIcUVvSTJQN2xWQUlSaWFnbEVJb0tkYzV1OXFmUTlPRmJHd2dMWjJwSy81MFdDYTVVYUZYUXhJUlQ5TUZScXVSdkx3b3hEdDhGMDBIUWlZQXBYMENkbUtJc0tSSVk4N3p5VmJKU1dGRDRING5MWDFOMlpmclhYV2U1MUpZaXIzNCtReGltQ2pSQkFqRkJCUnFuOStNc0VuUjlpb2FoSmpwSUxIcExKYjZQQUFLRklKRFhGNnNRY0ZESTRoRmc2NFZXMEplcFkzZnpQN0pndWxsbzZMcUxab1oxOFQxNnoyZWpjS2k5SnYxeHlueXpYV0FMb2ZZWlNqTjhIN3pTNXhjb0R4YUpVL3djZjk1Si95Ym9IcXdJSm9KZ0NvSC9EM1krcjcrNVEwQ3RBQUFBQUVsRlRrU3VRbUNDIi8+CjwvZGVmcz4KPC9zdmc+",u="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSItNiAtNiAzMiAzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMCIgY3k9IjEwIiByPSIxNiIgZmlsbD0iI0UxREZERCIvPjxwYXRoIGZpbGw9IiM2MDVlNWMiIGQ9Ik0xMCAyQzcuNzkwODYgMiA2IDMuNzkwODYgNiA2QzYgOC4yMDkxNCA3Ljc5MDg2IDEwIDEwIDEwQzEyLjIwOTEgMTAgMTQgOC4yMDkxNCAxNCA2QzE0IDMuNzkwODYgMTIuMjA5MSAyIDEwIDJaTTcgNkM3IDQuMzQzMTUgOC4zNDMxNSAzIDEwIDNDMTEuNjU2OSAzIDEzIDQuMzQzMTUgMTMgNkMxMyA3LjY1Njg1IDExLjY1NjkgOSAxMCA5QzguMzQzMTUgOSA3IDcuNjU2ODUgNyA2Wk01LjAwODczIDExQzMuOTAzMTUgMTEgMyAxMS44ODY5IDMgMTNDMyAxNC42OTEyIDMuODMyODEgMTUuOTY2MyA1LjEzNDk5IDE2Ljc5NjZDNi40MTY5NyAxNy42MTQgOC4xNDUyNiAxOCAxMCAxOEMxMS44NTQ3IDE4IDEzLjU4MyAxNy42MTQgMTQuODY1IDE2Ljc5NjZDMTYuMTY3MiAxNS45NjYzIDE3IDE0LjY5MTIgMTcgMTNDMTcgMTEuODk1NiAxNi4xMDQ1IDExIDE1IDExTDUuMDA4NzMgMTFaTTQgMTNDNCAxMi40NDY3IDQuNDQ3ODYgMTIgNS4wMDg3MyAxMkwxNSAxMkMxNS41NTIyIDEyIDE2IDEyLjQ0NzggMTYgMTNDMTYgMTQuMzA4OCAxNS4zNzc3IDE1LjI4MzcgMTQuMzI3NCAxNS45NTM0QzEzLjI1NjggMTYuNjM2IDExLjczNTEgMTcgMTAgMTdDOC4yNjQ4OSAxNyA2Ljc0MzE4IDE2LjYzNiA1LjY3MjYyIDE1Ljk1MzRDNC42MjIyNiAxNS4yODM3IDQgMTQuMzA4OCA0IDEzWiIvPjwvc3ZnPg==",p="data:image/png;base64,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",m="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmlld0JveD0iMCAwIDQ1IDQ1Ij4KPHBhdGggZmlsbD0iI2E3MjAzNyIgc3Ryb2tlPSIjZmZmIiBkPSJNMjIuNSw0NC41YzEyLjE1LDAsMjItOS44NSwyMi0yMlMzNC42NSwuNSwyMi41LC41LC41LDEwLjM1LC41LDIyLjVzOS44NSwyMiwyMiwyMloiLz4KPHBhdGggY2xhc3M9ImNscy0zIiBkPSJNMjAuOTMsMzAuNDJsMy41Ni0xLjUxYy4xMywuODgtLjM0LDEuNzctMS4yLDIuMTQtLjg2LC4zNi0xLjgzLC4wOC0yLjM3LS42MlptNS40My0xNy44M2MyLjA5LDEuMTQsMy42NSwyLjYsNC42OCw0LjM5LDEuMDMsMS43OCwxLjUxLDMuODcsMS40Niw2LjI1LDAsLjQxLS4zNSwuNzQtLjc3LC43My0uNDEsMC0uNzQtLjM1LS43My0uNzcsLjA1LTIuMTEtLjM3LTMuOTMtMS4yNi01LjQ2LS44OS0xLjU0LTIuMjUtMi44MS00LjEtMy44Mi0uMzYtLjItLjUtLjY1LS4zLTEuMDIsLjItLjM2LC42NS0uNSwxLjAyLS4zWm0tOS4xNSw0LjQyYzIuODYtMS4yNyw2LjItLjA3LDcuNiwyLjc1bC4xLC4yMSwxLjI5LDIuODksMS43LDEuNDdjLjA5LC4wOCwuMTcsLjE3LC4yNywuMzJsLjA2LC4xMWMuMjgsLjYzLDAsMS4zNy0uNjQsMS42NWwtMTAuMzMsNC41N2MtLjE2LC4wNy0uMzMsLjExLS41MSwuMTEtLjY5LDAtMS4yNS0uNTYtMS4yNS0xLjI1di0yLjM0cy0xLjI0LTIuNzktMS4yNC0yLjc5Yy0xLjMxLTIuOTUsMC02LjM5LDIuOTUtNy43Wm0tMS41OCw3LjA5bDEuMzcsMy4wOHYyLjI4czkuNjItNC4yNiw5LjYyLTQuMjZsLTEuNjUtMS40My0xLjQyLTMuMTgtLjA4LS4xOGMtMS4wMy0yLjA4LTMuNTEtMi45Ny01LjY0LTIuMDMtMi4xOSwuOTctMy4xNywzLjUyLTIuMTksNS43MlptMTAuNS03LjkxYy45NywuNTMsMS43NCwxLjI5LDIuMzIsMi4yOSwuNTcsLjk5LC44NSwyLjA1LC44MiwzLjE1LS4wMSwuNDEtLjM1LC43NC0uNzcsLjczLS40MS0uMDEtLjc0LS4zNS0uNzMtLjc3LC4wMi0uODItLjE5LTEuNi0uNjItMi4zNi0uNDQtLjc2LTEuMDEtMS4zMy0xLjc0LTEuNzItLjM2LS4yLS41LS42NS0uMy0xLjAyLC4yLS4zNiwuNjUtLjUsMS4wMi0uM1oiLz4KPHBhdGggZmlsbD0iI2ZmZiIgZD0iTTIwLjkzLDMwLjQybDMuNTYtMS41MWMuMTMsLjg4LS4zNCwxLjc3LTEuMiwyLjE0LS44NiwuMzYtMS44MywuMDgtMi4zNy0uNjJabTUuNDMtMTcuODNjMi4wOSwxLjE0LDMuNjUsMi42LDQuNjgsNC4zOSwxLjAzLDEuNzgsMS41MSwzLjg3LDEuNDYsNi4yNSwwLC40MS0uMzUsLjc0LS43NywuNzMtLjQxLDAtLjc0LS4zNS0uNzMtLjc3LC4wNS0yLjExLS4zNy0zLjkzLTEuMjYtNS40Ni0uODktMS41NC0yLjI1LTIuODEtNC4xLTMuODItLjM2LS4yLS41LS42NS0uMy0xLjAyLC4yLS4zNiwuNjUtLjUsMS4wMi0uM1ptLTkuMTUsNC40MmMyLjg2LTEuMjcsNi4yLS4wNyw3LjYsMi43NWwuMSwuMjEsMS4yOSwyLjg5LDEuNywxLjQ3Yy4wOSwuMDgsLjE3LC4xNywuMjcsLjMybC4wNiwuMTFjLjI4LC42MywwLDEuMzctLjY0LDEuNjVsLTEwLjMzLDQuNTdjLS4xNiwuMDctLjMzLC4xMS0uNTEsLjExLS42OSwwLTEuMjUtLjU2LTEuMjUtMS4yNXYtMi4zNHMtMS4yNC0yLjc5LTEuMjQtMi43OWMtMS4zMS0yLjk1LDAtNi4zOSwyLjk1LTcuN1ptOC45MS0uODJjLjk3LC41MywxLjc0LDEuMjksMi4zMiwyLjI5LC41NywuOTksLjg1LDIuMDUsLjgyLDMuMTUtLjAxLC40MS0uMzUsLjc0LS43NywuNzMtLjQxLS4wMS0uNzQtLjM1LS43My0uNzcsLjAyLS44Mi0uMTktMS42LS42Mi0yLjM2LS40NC0uNzYtMS4wMS0xLjMzLTEuNzQtMS43Mi0uMzYtLjItLjUtLjY1LS4zLTEuMDIsLjItLjM2LC42NS0uNSwxLjAyLS4zWiIvPgo8L3N2Zz4=",g="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMCAyMCI+DQogIDxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0iI2ZhZWNlYiIvPg0KICA8cGF0aCBmaWxsPSIjYmMyZjMyIiBkPSJNMi44NTM1NSAyLjE0NjQ2QzIuNjU4MjkgMS45NTEyIDIuMzQxNzEgMS45NTEyIDIuMTQ2NDUgMi4xNDY0NkMxLjk1MTE4IDIuMzQxNzIgMS45NTExOCAyLjY1ODMxIDIuMTQ2NDUgMi44NTM1N0wyLjkwOTM0IDMuNjE2NDZDMi4zNTI3MiA0LjA4NzA1IDIgNC43ODU3OSAyIDUuNTY1ODJWMTIuMjc2NEMyIDEzLjY5MzUgMy4xNjQwNiAxNC44NDIzIDQuNiAxNC44NDIzSDUuMTk5MzdMNS4yIDE3LjAxMzNDNS4yIDE3LjIyNjIgNS4yNjk4OSAxNy40MzM1IDUuMzk5MjEgMTcuNjA0MkM1LjczIDE4LjA0MDYgNi4zNTY2OCAxOC4xMjk4IDYuNzk4OTUgMTcuODAzNEwxMC44MSAxNC44NDIzSDE0LjEzNTFMMTcuMTQ2NCAxNy44NTM2QzE3LjM0MTcgMTguMDQ4OCAxNy42NTgzIDE4LjA0ODggMTcuODUzNiAxNy44NTM2QzE4LjA0ODggMTcuNjU4MyAxOC4wNDg4IDE3LjM0MTcgMTcuODUzNiAxNy4xNDY1TDE1LjU0NTQgMTQuODM4M0MxNS41NDU0IDE0LjgzODMgMTUuNTQ1NCAxNC44MzgzIDE1LjU0NTQgMTQuODM4M0wzLjgyMzUgMy4xMTYzOEMzLjgyMzUgMy4xMTYzOCAzLjgyMzUxIDMuMTE2MzggMy44MjM1IDMuMTE2MzhMMi44NTM1NSAyLjE0NjQ2Wk0xMy4xMzUxIDEzLjg0MjNIMTAuNDgwOUw2LjIwNTAyIDE2Ljk5ODhMNi4yMDM0NiAxNi45OTk3TDYuMiAxN0w2LjE5OTA4IDEzLjg0MjNINC42QzMuNzAzODMgMTMuODQyMyAzIDEzLjEyODggMyAxMi4yNzY0VjUuNTY1ODJDMyA1LjA2NzE0IDMuMjQwOTMgNC42MTU5OSAzLjYyMDM0IDQuMzI3NDZMMTMuMTM1MSAxMy44NDIzWiIvPg0KICA8cGF0aCBmaWxsPSIjYmMyZjMyIiBkPSJNMTcgMTIuMjc2NEMxNyAxMi45NjU4IDE2LjUzOTYgMTMuNTY0NCAxNS44ODk0IDEzLjc2OEwxNi42NDg4IDE0LjUyNzVDMTcuNDU0MSAxNC4wOTE1IDE4IDEzLjI0NjkgMTggMTIuMjc2NFY1LjU2NTgyQzE4IDQuMTQ4NzYgMTYuODM1OSAzIDE1LjQgM0g1LjEyMTM0TDYuMTIxMzQgNEgxNS40QzE2LjI5NjIgNCAxNyA0LjcxMzQ4IDE3IDUuNTY1ODJWMTIuMjc2NFoiLz4NCjwvc3ZnPg0K"},522067:(e,t,n)=>{"use strict";n.d(t,{Ww:()=>c,YP:()=>u,W9:()=>g,cU:()=>M});var i=n(136209),a=n(405501),r=n(308292),o=n(275742),l=n(711676),s=n(926045),d=n(708375);const c=3,u={profilePictureType:i.tS.User,generateUrl(e,t,n,o,l=i.$D.Small,s,d,c,u,g,M,N,T){if(s)return r.WW;if((0,a.EG)(e.id))return r.Az;let v="";const I=u&&!g&&e.id?e.id.split("|")[0]:e.id,y=I&&I.indexOf("#")>=0?encodeURIComponent(I):I,A=e.displayName?encodeURIComponent(e.displayName):"";return v=""===e.id||M?"beta/users/defaultProfilePictureV2?displayName={displayName}".replace("{displayName}",A):g?m(A,y,d,c,n,o):p(A,y,n,o),v=`${v}&size=${l}`,N&&T&&!M&&(v=`${v}&ETag=${T}`),`${t}${v}`},getPresenceUserId:e=>e.id},p=(e,t,n,i)=>{let a="";return a=n&&i&&!(0,o.isEmpty)(i)?"beta/users/{currentUserObjectId}/profilepicturev2/{id}?displayname={displayname}".replace("{currentUserObjectId}",i).replace("{id}",t).replace("{displayname}",e):"beta/users/{id}/profilepicturev2?displayname={displayname}".replace("{id}",t).replace("{displayname}",e),a},m=(e,t,n,i,a,r)=>{let l="";return l=a&&r&&!(0,o.isEmpty)(r)?"beta/users/{currentUserObjectId}/profilePictureV2ForSharedChannel/{id}?displayName={displayName}&conversationId={conversationId}&hostTenantId={hostTenantId}".replace("{currentUserObjectId}",r):"beta/users/{id}/profilePictureV2ForSharedChannel?displayName={displayName}&conversationId={conversationId}&hostTenantId={hostTenantId}",n&&i?l=l.replace("{id}",t).replace("{displayName}",e).replace("{conversationId}",n||"").replace("{hostTenantId}",i||""):(l=a&&r&&!(0,o.isEmpty)(r)?"beta/users/{currentUserObjectId}/profilePictureV2ForSharedChannel/{id}?displayName={displayName}".replace("{currentUserObjectId}",r):"beta/users/{id}/profilePictureV2ForSharedChannel?displayName={displayName}",l=l.replace("{id}",t).replace("{displayName}",e)),l},g={profilePictureType:i.tS.Group,generateUrl(e,t,n,d,u=i.$D.Small){let p="";const m=(e.length>c?e.slice(0,c):e).map((e=>({userId:e.id,displayName:e.displayName}))),g=(e=>{if(1===e.length){const t=e[0].id;if(t===s.HE)return{shouldUseProjectGroupImage:!0,shouldUseDefaultGroupImage:!1};if(t===s.xw)return{shouldUseProjectGroupImage:!1,shouldUseDefaultGroupImage:!0}}return{shouldUseProjectGroupImage:!1,shouldUseDefaultGroupImage:!1}})(e);let{shouldUseDefaultGroupImage:M}=g;const{shouldUseProjectGroupImage:N}=g;for(const e of m){if(M||N)break;((0,o.isEmpty)(e.displayName)||!(0,l.lp)(e.userId)||(0,l.y)(e.userId)||(0,a.EG)(e.userId))&&(M=!0)}if(M||(0,o.isEmpty)(m))return r.dA;if(N)return r.P7;p=encodeURIComponent(JSON.stringify(m));let T="";return T=n&&d&&!(0,o.isEmpty)(d)?"beta/users/{currentUserObjectId}/mergedProfilePicturev2?usersInfo={usersArray}&size={size}".replace("{currentUserObjectId}",d).replace("{usersArray}",p).replace("{size}",u):"beta/users/mergedProfilePicturev2?usersInfo={usersArray}&size={size}".replace("{usersArray}",p).replace("{size}",u),`${t}${T}`},getPresenceUserId(){}},M={profilePictureType:i.tS.Team,generateUrl(e,t,n,i){const{displayName:a,groupId:r,pictureETag:o}=e;return(0,d.RJ)(t,a,o||"",r,n,i)},getPresenceUserId(){}}},5505:(e,t,n)=>{"use strict";n.d(t,{rh:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaGroupProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MsaGroupProfilePictureInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaGroupProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"msaGroupInfo"},value:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}]}]}}]}},491821:(e,t,n)=>{"use strict";n.d(t,{E$:()=>f,Ou:()=>h});var i=n(850402),a=n(265858),r=n(136209);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"user"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"imageUri"}},{kind:"Field",name:{kind:"Name",value:"selfAvatarLastupdatedTime"}}]}}]}}]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"connectorProfile"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"integrationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorProfile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"integrationId"},value:{kind:"Variable",name:{kind:"Name",value:"integrationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}}]},s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarCommunityProfilePictureQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"imageUri"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"community"},arguments:[{kind:"Argument",name:{kind:"Name",value:"threadId"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"profilePictureUrl"},arguments:[{kind:"Argument",name:{kind:"Name",value:"imageUri"},value:{kind:"Variable",name:{kind:"Name",value:"imageUri"}}}]}]}}]}}]},d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaUserProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"imageUri"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"renderInitials"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"imageUri"},value:{kind:"Variable",name:{kind:"Name",value:"imageUri"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}},{kind:"Argument",name:{kind:"Name",value:"renderInitials"},value:{kind:"Variable",name:{kind:"Name",value:"renderInitials"}}}]}]}}]};var c=n(5505);const u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarIsSharedChannelQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isShared"}},{kind:"Field",name:{kind:"Name",value:"substrateGroupId"}}]}}]}}]},p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarGetUsersQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriOrEmailArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}}},{kind:"Argument",name:{kind:"Name",value:"isMailAddress"},value:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}}]},m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarChatQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}}]};var g=n(647231),M=n(516909),N=n(275742);const T={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"isTenantVerifiedDomain"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"domain"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isTenantVerifiedDomain"},arguments:[{kind:"Argument",name:{kind:"Name",value:"domain"},value:{kind:"Variable",name:{kind:"Name",value:"domain"}}}]}]}}]};var v=n(994593),I=n(491465),y=n(571096),A=n(401717),D=n(369398),C=n(738646);const b={throttleTimeInMS:36e5,maxThrottleCount:5,resetThrottleTime:72e5,throttleCount:0,lastThrottleTime:0},h=(e,t="avatar-container-hook")=>{const{userId:n,conversationId:r,teamId:o,entity:l,profilePictureSize:s,isEmergencyCallTarget:d,client:c,generator:u,baseImageUrl:p,isImageAuthCookieValid:m,logger:M,enableMSAProfilePicture:N,showMergedAvatarForGroup:T,isAnonymousAccount:v,isTeamsApp:I,isUnresolvedEmail:y,sharedChannelId:A,skipAvatarQuery:D}=e,C=(0,g.HA)(n,r,o,N,T||!1,I,y,A,l),b=(0,g.WJ)(C,d),[h,k]=a.useState(b),S=a.useRef(!1);return a.useEffect((()=>(S.current=!0,()=>{S.current=!1}))),a.useEffect((()=>{if(D)return;let n="";(0,i.__awaiter)(void 0,void 0,void 0,(function*(){n=yield f(e,C,t),S.current&&n&&k(n)}))}),[n,r,l,s,d,c,M,u,p,C,e,t,m,S,v,D]),h},f=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{baseImageUrl:i,isEmergencyCallTarget:a,isImageAuthCookieValid:o,enableCachedAvatarCheck:l,isAnonymousAccount:s,logger:d,enableSampleAvatarFetch:c,enableAvatarUrlQuery:u}=e,p=(0,g.WJ)(t,a);let m;if(u&&(m=yield B(e,t,n)),(0,N.isEmpty)(m)){const a=(0,N.isEmpty)(i)&&!o?"baseImageUrlisImageAuthCookieValidFailed":o?"baseImageUrlFailed":"isImageAuthCookieValidFailed",r={callerInfo:n,profilePictureType:t,isSelfProfileAvatar:!!e.isSelfProfileAvatar,errorMessage:a};if(((0,N.isEmpty)(i)||!o)&&(k(b,e.scenarioFactory,r,!!e.enableFBSTelemetryForAvatarStatus),d.error(`AvatarContainer: caller:${r.callerInfo} numericType:${r.profilePictureType} isSelf:${r.isSelfProfileAvatar} errorMessage:${r.errorMessage}`),(0,N.isEmpty)(i)))return p;m=yield S(e,t,n)}if(!m)return p;if(o||s||t===r.tS.Initials)return o&&((e,t,n)=>{e&&v(t,{method:"GET",credentials:"include",headers:{"x-ms-client-caller":n}}).catch((()=>{}))})(!!c,m,n),m;if(l){if(yield U(m))return m}return p})),k=(e,t,n,i=!1)=>{e.throttleCount++;const a=Date.now();if(e.throttleCount<=e.maxThrottleCount&&a-e.lastThrottleTime>e.throttleTimeInMS){if(e.lastThrottleTime=a,i){const e=t&&t.newScenario(C.RG.AvatarStatus);e&&e.fail(n)}}else a-e.lastThrottleTime>e.resetThrottleTime&&(e.throttleCount=0)},S=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,a,o,l;const{userId:s,conversationId:d,entity:c,client:u,logger:p,profilePictureSize:m,isSelfProfileAvatar:g,showUpdatedGroupAvatar:M,enableConnectorsProfileInChannels:N,onBehalfOfId:T,scenarioFactory:v}=e;let I;switch(t){case r.tS.Communities:I=yield P(c,u,p,M);break;case r.tS.Connector:const t=yield Q(u,d,s,p,N);I=null===(a=null===(i=null==t?void 0:t.data)||void 0===i?void 0:i.connectorProfile)||void 0===a?void 0:a.avatarUrl;break;case r.tS.OutgoingWebhook:I=yield R(u,d,p,T,v);break;case r.tS.App:case r.tS.Bot:const y=yield V(u,s,p,n);I=null===(l=null===(o=null==y?void 0:y.data)||void 0===o?void 0:o.user)||void 0===l?void 0:l.imageUri;break;case r.tS.MsaUser:case r.tS.MsaGroup:I=yield O(s,d,m||r.$D.Small,c,u,p,g,M);break;case r.tS.User:case r.tS.Group:case r.tS.Team:case r.tS.SharedChannelInviteeTeam:I=yield E(e,u,n);break;case r.tS.MergedGroup:I=yield z(e);break;case r.tS.Initials:I=yield w(e)}return I})),U=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{return yield v(e,{method:"GET",mode:"same-origin",cache:"only-if-cached",credentials:"include",headers:{"x-ms-client-caller":t||"image-cache-check"}}),!0}catch(e){return!1}})),E=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,a,r,l,s,d;const{entity:c,profilePictureSize:p,isEmergencyCallTarget:m,generator:g,baseImageUrl:M,logger:N,isSelfProfileAvatar:T,avatarEtag:v}=e;let I,y=v;const{conversationId:A}=e;if(!Array.isArray(c)){const e=c;I=e.upn,e&&!e.displayName&&N.warn(`Avatar without display name, callerInfo: ${n}`)}if(e.isSharedChannel&&A){const{data:r}=yield t.query({query:u,variables:{convId:A},context:{callerInfo:"avatar-url-shared-channel"}});if((null===(i=null==r?void 0:r.channelByID)||void 0===i?void 0:i.substrateGroupId)||(null===(a=null==r?void 0:r.channelByID)||void 0===a?void 0:a.isShared))return j(I,e,t,n)}if(T&&!y){const e=c,i=yield t.query({query:o,variables:{userId:e.id},context:{callerInfo:n}});(null===(l=null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.user)||void 0===l?void 0:l.selfAvatarLastupdatedTime)&&(y=null===(d=null===(s=null==i?void 0:i.data)||void 0===s?void 0:s.user)||void 0===d?void 0:d.selfAvatarLastupdatedTime)}return g.generateUrl(c,M||"",!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,p,m,void 0,void 0,void 0,void 0,void 0,T,y)})),j=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entity:i,profilePictureSize:r,isEmergencyCallTarget:o,generator:l,baseImageUrl:s,logger:d}=t;if(e){const a=!(yield L(n,e));return l.generateUrl(i,s||"",!!t.isProfilePictureWithObjectIdEnabled,t.currentUserOid,r,o,t.conversationId,t.hostTenantId,!0,a,void 0)}return d.warn(`Avatar: upn not provided for sharedChannel, callerInfo: ${a}`),l.generateUrl(i,s||"",!!t.isProfilePictureWithObjectIdEnabled,t.currentUserOid,r,o,t.conversationId,t.hostTenantId,!0,!0,void 0)})),L=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n=t.substring(t.indexOf("@")+1);try{const{data:t}=yield e.query({query:T,variables:{domain:n}});return t&&t.isTenantVerifiedDomain}catch(e){return!1}})),O=(e,t,n,a,r,o,l=!1,s=!1)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,d,c,u,p;const m=(0,y.UL)(t);let g;if(e&&t||m){const{data:e}=yield r.query({query:I.vh,variables:{convId:t},context:{callerInfo:"get-msa-avatar-url"}});if(m&&(null===(i=null==e?void 0:e.chat)||void 0===i?void 0:i.picture))return e.chat.picture;g=(null===(d=null==e?void 0:e.chat)||void 0===d?void 0:d.chatType)===M.z_3.Chat&&!(null===(c=null==e?void 0:e.chat)||void 0===c?void 0:c.isOneOnOne)}if(e&&!g){const t=yield F(r,e,a.displayName,n,o,l);return null===(u=null==t?void 0:t.data)||void 0===u?void 0:u.msaUserProfilePicture}if(t){const e=[],n=a;Array.isArray(n)&&n.forEach((t=>{e.push({userId:t.id,displayName:t.displayName?t.displayName:""})}));const i=yield x(r,t,e,o,s);return null===(p=null==i?void 0:i.data)||void 0===p?void 0:p.msaGroupProfilePicture}})),F=(e,t,n,a,r,o,l)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{return yield e.query({query:d,variables:{userId:t,displayName:n,callerInfo:"avatar-container",profilePictureSize:a,renderInitials:l},fetchPolicy:o?"network-only":"cache-first"})}catch(e){return void r.error(`msaUserProfilePictureQuery failed for msa user: ${e.message}`)}})),x=(e,t,n,a,r)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){n.forEach((e=>{e&&(0,N.isEmpty)(e.displayName)&&t&&a.warn(`Avatar without display name for conversationId: ${t}`)}));try{const i={conversationId:t,pictureReadyUsers:n};return yield e.query({query:c.rh,variables:{msaGroupInfo:i,callerInfo:"avatar-container"},fetchPolicy:r?"network-only":"cache-first"})}catch(e){return void a.error(`msaGroupProfilePictureQuery failed for conversationId:  ${t}`)}})),w=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entity:t,profilePictureSize:n,isEmergencyCallTarget:i,generator:a,baseImageUrl:r}=e;return a.generateUrl(t,r,!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,n,i,void 0,void 0,!1,!1,!0)})),z=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entity:t,profilePictureSize:n,isEmergencyCallTarget:i,generator:a,baseImageUrl:r}=e;return a.generateUrl(t,r,!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,n,i,void 0,void 0,!1,!1,!0)})),V=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{return yield e.query({query:o,variables:{userId:t},context:{callerInfo:a}})}catch(e){return void n.error(`userQuery failed: ${e.message}`)}})),Q=(e,t,n,a,r)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{if(r&&t&&n){return yield e.query({query:l,variables:{convId:t,integrationId:n}})}return}catch(e){return void a.error(`connectors query failed for conversationId: ${t}`)}})),R=(e,t,n,a,r)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(r&&a&&t)try{const i=yield(0,D.RD)(e,t);return(yield(0,A.xJ)(e,n,r,a,!0,"outgoing-webhook-avatar-url",{conversation:{scope:M.qi6.Team,id:i||""}}))[0].definition.largeImageUrl}catch(e){n.error(`installed apps query failed for conversationId: ${t}`)}})),P=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,r,o,l;const d=e.teamThreadId||"",c=e.pictureETag;if(c)try{const e=yield t.query({query:s,variables:{threadId:d,imageUri:c},fetchPolicy:a?"network-only":"cache-first"});return null===(o=null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.community)||void 0===o?void 0:o.profilePictureUrl}catch(e){return void(null===(l=n.errorToTelemetry)||void 0===l||l.call(n,`community profile picture query failed for this : ${d}`,"community_profile_picture_query_failed"))}else null===(i=n.infoToTelemetry)||void 0===i||i.call(n,`getCommunitiesAvatarUrl function returned undefined for this threadId : ${d}, and imageUri: ${c}`,"get_communities_avatar_url_returned_undefined",void 0,!0)})),B=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,a;const{client:o,profilePictureSize:l}=e;if(t===r.tS.User&&e.userId){const{data:t}=yield o.query({query:p,variables:{mriOrEmailArray:[e.userId]},context:{callerInfo:n}});return(0,g.vn)(null===(i=t.getUsers)||void 0===i?void 0:i[0].avatarUrl,l,!0)}if(t===r.tS.Group&&e.conversationId){const{data:t}=yield o.query({query:m,variables:{convId:e.conversationId},context:{callerInfo:n}});return null===(a=t.chat)||void 0===a?void 0:a.avatarUrl}}))},362136:(e,t,n)=>{"use strict";n.d(t,{ku:()=>i,LZ:()=>y,WG:()=>C});var i,a=n(850402),r=n(265858),o=n(814423),l=n(50805),s=n(814616),d=n(427662),c=n(554694),u=n(898071),p=n(628556),m=n(80719),g=n(760005),M=n(275742),N=n(516909),T=n(915929),v=n(811075),I=n(738646);!function(e){e.InitialConfig="config",e.ReConfig="reconfig"}(i||(i={}));const y=(e,t)=>{var n,i;if(null===(i=null===(n=e.bots)||void 0===n?void 0:n[0])||void 0===i?void 0:i.configuration){if(t===N.qi6.Team)return A(e)?e.bots[0].configuration.team:null;if(t===N.qi6.GroupChat)return D(e)?e.bots[0].configuration.groupChat:null}return null},A=e=>{var t,n,i,a;return null!==(null===(a=null===(i=null===(n=null===(t=e.bots)||void 0===t?void 0:t[0])||void 0===n?void 0:n.configuration)||void 0===i?void 0:i.team)||void 0===a?void 0:a.fetchTask)},D=e=>{var t,n,i,a;return null!==(null===(a=null===(i=null===(n=null===(t=e.bots)||void 0===t?void 0:t[0])||void 0===n?void 0:n.configuration)||void 0===i?void 0:i.groupChat)||void 0===a?void 0:a.fetchTask)},C=()=>{const{enableBotConfiguration:e}=(0,o.NC)(l.J.Extensibility),{scenarioFactory:t}=(0,d.SE)(),n=(0,c.w)("BotConfigLauncher"),i=r.useContext(u.OO),{entityCommanding:a}=(0,d.SE)(),s=(0,v.b)();return r.useCallback(((r,o,l,d)=>{const c=t.newScenario(I.RG.ExtBotConfig),u=l&&y(l,o);e&&u&&(c.appendEventData({configEntryPoint:d}),b(l,u,r,i,n,a,o,s,c))}),[e,n,a,s,i,t])},b=(e,t,n,i,r,o,l,s,d)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var a;const c=h(e,n,i,t);if(t&&c)try{const t=(0,T.v4)();o.platform.launchTaskModule(t,{taskModuleOptions:{input:c,launchContext:l===N.qi6.GroupChat?Object.assign(Object.assign({type:p.p.chat,parentMessageId:s.replyChainId},s),{chatId:n,launchId:t}):{type:p.p.channel,channelId:s.channelId,parentMessageId:s.replyChainId,teamId:n,launchId:t}}}).subscribe({complete:()=>{var t;r.log(`task module complete for entrypoint ${c.entryPoint}`),d.stop({"App.Id":e.id,"Bot.Id":null===(t=e.bots)||void 0===t?void 0:t[0].id})},error:t=>{var n,i;const a=`error launching task module for entry point ${c.entryPoint}. errorCode: ${t.ErrorCode}, errorName: ${t.name}, innerErrorCode: ${null===(n=t.innerError)||void 0===n?void 0:n.code}`;r.error(`${a} Error:`,t),d.fail({"App.Id":e.id,"Bot.Id":null===(i=e.bots)||void 0===i?void 0:i[0].id,errors:a})}})}catch(t){r.log("error","Error while launching task module",t),d.fail({"App.Id":e.id,"Bot.Id":null===(a=e.bots)||void 0===a?void 0:a[0].id,errors:"Error in launching task module with bot config entry point"})}})),h=(e,t,n,i)=>{var a,r,o;return{appName:e.name||"",appIcon:e.largeImageUrl||"",appId:e.id,isFullScreenApp:e.isFullScreenApp||!1,isFullTrustApp:e.isFullTrustApp||!1,validDomains:e.validDomains||[],tenantId:e.tenantId||"",entryPoint:m.gV.BotConfig,botInvokeParams:{threadId:t,botMri:(null===(a=(0,M.first)(e.bots))||void 0===a?void 0:a.id)?`${g.at.BotPrefix}${null===(r=(0,M.first)(e.bots))||void 0===r?void 0:r.id}`:""},fetchTask:(null==i?void 0:i.fetchTask)||!1,taskInfo:null!==(o=(0,s.Un)(n,null==i?void 0:i.taskInfo))&&void 0!==o?o:{},isMicrosoftOwned:e.isMicrosoftOwned||!1,externalId:e.externalId||""}}},90911:(e,t,n)=>{"use strict";n.d(t,{_r:()=>r,LV:()=>o});var i=n(265858);const a=i.createContext({});a.displayName="CoreThemeContext";const r=i.memo((({children:e,setCoreThemeType:t,themeType:n,themeOptions:r})=>{const o=i.useMemo((()=>({setCoreThemeType:t,themeType:n,themeOptions:r})),[t,n,r]);return i.createElement(a.Provider,{value:o},e)}));r.displayName="CoreThemeContextProvider";const o=()=>i.useContext(a)},537181:(e,t,n)=>{"use strict";n.d(t,{Fh:()=>d,y3:()=>M,IH:()=>N,I6:()=>p,Jd:()=>I,sb:()=>v,rt:()=>g,t:()=>m});var i=n(850402),a=n(915929),r=n(125098),o=n(50805),l=n(591968);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsCortexTopicsSdkAuthenticationAcquireTokenQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]},d="https://substrate.office.com",c=new Map,u=6e4;function p(e){return(0,r.I6)(e)}function m(e,t,n,a,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{lokiTokenResourceUrl:i,enableSilentLokiAuthTokenRetrieval:s}=a.get(o.J.People),{enableCallKMApiDirectly:c}=a.get(o.J.Messaging),u=p(n);return u?(yield N(t,n,c?d:i||l.s$,s||void 0,u),e(u)):r?r():void 0}))}function g(e,t,n,i,a){const{enableSilentLokiAuthTokenRetrieval:r,lokiTokenResourceUrl:s}=i.get(o.J.People),{enableCallKMApiDirectly:c}=i.get(o.J.Messaging),u=p(n);return u?(N(t,n,c?d:s||l.s$,r||void 0,u),e(u)):a?a():void 0}function M(e){const t=(0,a.v4)();return(n,a)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(c.has(T(e))){const i=c.get(T(e));(null==i?void 0:i.token)&&n(i.token,t)}else a("No token in Reference",t)}))}function N(e,t,n,a,r){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;r||(r=p(t));const l=c.get(T(t));if(l){if(Date.now()-l.lastRefreshTime<u)return}r&&(i=r.createQosEvent("Cortex.TopicAnnotations.RenewToken.Execute"));try{let r;if(e){const{data:l}=yield e.query({query:s,variables:{resource:n,acquireTokenOptions:{silent:a}},fetchPolicy:"network-only"});r={token:null===(o=null==l?void 0:l.authenticationToken)||void 0===o?void 0:o.token,lastRefreshTime:Date.now()},r.token?(c.set(T(t),{token:r.token,lastRefreshTime:r.lastRefreshTime}),null==i||i.logSuccess()):null==i||i.logUnexpectedFailure("NoTokenReceived")}else null==i||i.logUnexpectedFailure("NoApolloClient")}catch(e){null==i||i.logUnexpectedFailure("ErrorThrowRetrievingToken",e)}}))}function T(e){var t,n;return`${null!==(t=e.userAadObjectId)&&void 0!==t?t:""}_${null!==(n=e.tenantAadObjectId)&&void 0!==n?n:""}`}function v(e,t,n,i){const{enableCortexTopicsAuthRefactor:a}=n.get(o.J.Messaging),r=p(t);return a&&i?g(e,i,t,n):r?e(r):void 0}function I(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableCortexTopicsAuthRefactor:i}=n.get(o.J.Messaging),r=p(t);return i&&a?m(e,a,t,n):r?e(r):void 0}))}},367553:(e,t,n)=>{"use strict";var i;n.d(t,{z:()=>p,F7:()=>m,p6:()=>g});var a=n(265858),r=n(814423),o=n(50805),l=n(727523),s=n(363592),d=n(767588);const{useCallback:c,useMemo:u}=i||(i=n.t(a,2)),p=({userId:e,displayName:t,personaType:n,hostConversationId:i,ariaLabel:a,tabIndex:p})=>{const{enableEntityMoreInfo:m}=(0,r.NC)(o.J.Core,["enableEntityMoreInfo"]),g=(0,s.JQ)(),M=c(((e,{userId:t,ariaLabel:n,tabIndex:i,displayName:a,personaType:r,hostConversationId:o})=>{if(t){const{left:s,top:d,width:c,height:u}=e.target.getBoundingClientRect();g.bubble({event:l.U3.requestPersonMoreInfo({eventType:e.type,height:u,left:s,top:d,width:c,userId:t,displayName:a,personaType:r,hostConversationId:o,ariaLabel:n,tabIndex:i}),reactEvent:e})}}),[g]),N=c((r=>{m&&M(r,{userId:e,ariaLabel:a,tabIndex:p,displayName:t,personaType:n,hostConversationId:i})}),[m,M,e,a,p,t,n,i]),T=(0,d.K)(N,500),v=c((r=>{T.cancel(),m&&M(r,{userId:e,ariaLabel:a,tabIndex:p,displayName:t,personaType:n,hostConversationId:i})}),[m,T,M,e,a,p,t,n,i]),I=c((n=>{!m||"Enter"!==n.key&&" "!==n.key||M(n,{userId:e,ariaLabel:a,tabIndex:p,displayName:t})}),[m,M,e,a,p,t]),y=c((e=>{T.cancel()}),[T]);return u((()=>({onClick:v,onKeyDown:I,onMouseEnter:T,onMouseLeave:y})),[v,I,T,y])},m=({userId:e,displayName:t,ariaLabel:n,tabIndex:i})=>{const{enableEntityMoreInfo:a}=(0,r.NC)(o.J.Core,["enableEntityMoreInfo"]),d=(0,s.JQ)(),p=c(((e,{userId:t,ariaLabel:n,tabIndex:i,displayName:a})=>{if(t){const{left:r,top:o,width:s,height:c}=e.target.getBoundingClientRect();d.bubble({event:l.U3.requestPersonMoreOrgInfo({eventType:e.type,height:c,left:r,top:o,width:s,userId:t,displayName:a,ariaLabel:n,tabIndex:i}),reactEvent:e})}}),[d]),m=c((r=>{a&&p(r,{userId:e,ariaLabel:n,tabIndex:i,displayName:t})}),[a,p,e,n,i,t]),g=c((r=>{!a||"Enter"!==r.key&&" "!==r.key||p(r,{userId:e,ariaLabel:n,tabIndex:i,displayName:t})}),[a,p,e,n,i,t]);return u((()=>({onClick:m,onKeyDown:g})),[m,g])},g=({userId:e,ariaLabel:t,tabIndex:n,topicId:i})=>{const{enableEntityMoreInfo:a}=(0,r.NC)(o.J.Core),d=(0,s.JQ)(),p=c(((e,{userId:t,ariaLabel:n,tabIndex:i,topicId:a})=>{if(t){const{left:r,top:o,width:s,height:c}=e.target.getBoundingClientRect();d.bubble({event:l.U3.requestTopicMoreInfo({eventType:e.type,height:c,left:r,top:o,width:s,userId:t,ariaLabel:n,tabIndex:i,topicId:a}),reactEvent:e})}}),[d]),m=c((r=>a?p(r,{userId:e,ariaLabel:t,tabIndex:n,topicId:i}):void 0),[a,p,e,t,n,i]),g=c((r=>{!a||"Enter"!==r.key&&" "!==r.key||p(r,{userId:e,ariaLabel:t,tabIndex:n,topicId:i})}),[a,p,e,t,n,i]),M=c((r=>a?p(r,{userId:e,ariaLabel:t,tabIndex:n,topicId:i}):void 0),[a,p,e,t,n,i]);return u((()=>({onClick:m,onKeyDown:g,onMouseEnter:M})),[m,g,M])}},591968:(e,t,n)=>{"use strict";n.d(t,{s$:()=>s,EG:()=>l,Vf:()=>d});var i=n(850402),a=n(915929),r=n(793377);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationToken"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]},l=(e,t)=>{if("df"===t)return"Df";if("msit"===t)return"Msit";switch(e){case r.s.prod:case r.s.life:return"Prod";case r.s.gcc:return"GccModerate";case r.s.gcchigh:return"GccHigh";case r.s.dod:return"DoD";case r.s.ag08:return"AG08";case r.s.ag09:return"AG09";case r.s.gallatin:return"Gallatin";default:return"Unknown"}},s="https://unknownregion.loki.delve.office.com",d=(e,t,n)=>{const r=(0,a.v4)();return(a,l)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,s;try{let d;e.current?d=null===(s=null===(i=(yield e.current.query({query:o,variables:{resource:t,acquireTokenOptions:{silent:n}},fetchPolicy:"network-only"})).data)||void 0===i?void 0:i.authenticationToken)||void 0===s?void 0:s.token:l("Error no apollo client to retrieve token",r),d?a(d,r):l("No auth token found",r)}catch(e){l("Error retrieving auth token",r)}}))}},331389:(e,t,n)=>{"use strict";n.d(t,{p3:()=>u,Lk:()=>p});var i=n(265858),a=n(257201),r=n(236511);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"lpcState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}},{kind:"Field",name:{kind:"Name",value:"lastLoggedInUserMri"}}]}}]}}]};var l=n(237628),s=n(275742);const d=i.createContext({IsLivePersonaCardInitialized:!1,LastLoggedInUserMri:void 0}),c=e=>{const t={IsLivePersonaCardInitialized:e.IsLivePersonaCardInitialized,LastLoggedInUserMri:e.LastLoggedInUserMri};return i.createElement(d.Provider,{value:(0,l.Q)(t,s.isEqual)},e.children)},u=(0,r.C)((e=>i.createElement(a.A,{query:o},(({data:t,loading:n,error:a})=>{const r=!n&&!a&&!!t&&!!t.lpcState&&t.lpcState.isLivePersonaCardInitialized;return i.createElement(c,{children:e.children,IsLivePersonaCardInitialized:r,LastLoggedInUserMri:null==t?void 0:t.lpcState.lastLoggedInUserMri})})))),p=()=>i.useContext(d)},180637:(e,t,n)=>{"use strict";n.d(t,{Im:()=>A});var i=n(850402),a=n(275742),r=n(265858),o=n(424600),l=n(111587),s=n(427662),d=n(554694),c=n(663945),u=n(50805),p=n(243334),m=n(537181),g=n(819438),M=n(481106),N=n(331389),T=n(365076);const v=(0,n(606395).s)({defaultPersona:{mc9l5x:"fau6ura",Bqenvij:"f3052tw"}},{d:[".fau6ura{display:initial;}",".f3052tw{height:fit-content;}"]});var I=n(501197);const y=e=>{const t=(0,l.WD)(p.nh.POST_CRITICAL),n=(0,N.Lk)(),y=(0,T.x)(),{host:{LivePersonaCardHoverTargetV2:A},coreSettings:D}=(0,s.SE)(),C=((e,t,n,a)=>{var l,s,d,c,u;const[p,m]=r.useState(!0),g=r.useRef(!1),{userId:M,hostConversationId:N,hostTenantId:T,isSharedChannel:v}=e,{data:y}=(0,o.W)(["meetingDetails","meetingRole"]),A=!!(null===(d=null===(s=null===(l=null==y?void 0:y.call)||void 0===l?void 0:l.meetingDetails)||void 0===s?void 0:s.meetingCapability)||void 0===d?void 0:d.maskIdentitiesForRole),D=null!==(u=null===(c=null==y?void 0:y.call)||void 0===c?void 0:c.meetingRole)&&void 0!==u?u:"";return r.useEffect((()=>(g.current=!0,(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const e=yield(0,I.nv)(M,A,D,!!v,N,T,t,n,a);g.current&&m(e)})),()=>{g.current=!1})),[n,t,a,M,A,D,N,T,v]),p})(e,D,y,(0,d.w)("PersonaInner")),b=(e=>{const{host:t,userBiService:n,coreSettings:a,authenticationUser:o}=(0,s.SE)(),l=(0,d.w)("PersonaRenderer"),p=(0,T.x)(),{topicId:M,personaType:N}=e,v=r.useCallback((()=>{t.document.dispatchEvent(new MouseEvent("mousemove"))}),[t]),{ariaLabel:y,behavior:A,disableAccessibilityDefaults:D,externalAppSessionCorrelationId:C,hostConversationId:b,hostTenantId:h,isSharedChannel:f,tabIndex:k,userId:S,displayName:U,module:E,source:j,highlightedText:L}=e,O=r.useCallback((()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(t.document.addEventListener("mouseleave",v),"Topic"===N&&M){const e=(0,m.I6)({userAadObjectId:null==o?void 0:o.profile.objectId,tenantAadObjectId:null==o?void 0:o.profile.tenantId});null==e||e.logEvent(g.z.TopicCardOpen,{topicId:M,module:null!=E?E:"",source:null!=j?j:""})}const e=yield(0,I.rH)(S,n,p),i={panelRegion:c.Ai.popover,panelType:c.wh.LivePersonaCard,dataBag:e};n.recordPanelView(i,l)}))),[o,t,v,l,n,p,M,N,E,j,S]),F=r.useCallback((()=>{t.document.removeEventListener("mouseleave",v);const e={actionGesture:c.uS.mouseleave,actionOutcome:c.$K.closePanel,actionScenarioType:c.Yu.people,actionScenario:c.Tk.closePanel,moduleName:c.rA.lpcClose,panelRegion:c.Ai.popover,panelType:c.wh.LivePersonaCard};n.recordPanelAction(e,l)}),[t,n,l,v]),x=!!a.get(u.J.People).isInIframe,w=r.useMemo((()=>(0,I.g3)({ariaLabel:y,behavior:A,disableAccessibilityDefaults:D,externalAppSessionCorrelationId:C,hostConversationId:b,hostTenantId:h,isSharedChannel:f,tabIndex:k,userId:S,handleOnCardOpen:O,handleOnCardClose:F,personaType:N,topicId:M,shouldDeferCardOpenToParentWindow:x,displayName:U,module:E,source:j,highlightedText:L})),[y,A,D,C,b,h,f,k,S,O,F,M,N,x,U,E,j,L]);return r.useEffect((()=>()=>{t.document.removeEventListener("mouseleave",v)}),[t,v]),w})(e),{enableEntityMoreInfo:h}=D.get(u.J.Core),{enableFluentV9Avatar:f}=D.get(u.J.People),k=v(),S={"data-tid":e.callerInfo};return!h&&t&&!(0,a.isEmpty)(e.userId)&&C&&(null==n?void 0:n.IsLivePersonaCardInitialized)&&A?r.createElement(M.S,{fallbackUI:r.createElement(r.Fragment,null,e.children),loggerName:"PersonaInner"},r.createElement(A,Object.assign({},b),f?r.createElement("div",Object.assign({className:e.classNames||k.defaultPersona},S),e.children):e.children)):r.createElement(r.Fragment,null,e.children)},A=r.memo((e=>y(e)));A.displayName="Persona"},501197:(e,t,n)=>{"use strict";n.d(t,{mf:()=>g,nv:()=>M,rH:()=>y,g3:()=>p,NH:()=>v,n$:()=>m});var i=n(850402);const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getUsersForConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isShortProfileRequested"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"peoplePickerFilters"}},type:{kind:"NamedType",name:{kind:"Name",value:"PeoplePickerFiltersInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isSharedChannel"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hostTenantId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsersForConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriArray"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"isShortProfileRequested"},value:{kind:"Variable",name:{kind:"Name",value:"isShortProfileRequested"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}},{kind:"Argument",name:{kind:"Name",value:"peoplePickerFilters"},value:{kind:"Variable",name:{kind:"Name",value:"peoplePickerFilters"}}},{kind:"Argument",name:{kind:"Name",value:"isSharedChannel"},value:{kind:"Variable",name:{kind:"Name",value:"isSharedChannel"}}},{kind:"Argument",name:{kind:"Name",value:"hostTenantId"},value:{kind:"Variable",name:{kind:"Name",value:"hostTenantId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userProfileData"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userProfileData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"companyName"}},{kind:"Field",name:{kind:"Name",value:"tenantName"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"userType"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"xtapUser"}}]}}]}.definitions]};var r=n(793377),o=n(451567),l=n(982346),s=n(50805),d=n(405501);const c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPersonaUserTypeQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"userType"}},{kind:"Field",name:{kind:"Name",value:"profileType"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]},u="Topic",p=e=>{const{ariaLabel:t,behavior:n,disableAccessibilityDefaults:i,externalAppSessionCorrelationId:a,hostConversationId:r,hostTenantId:o,isSharedChannel:l,tabIndex:s,userId:d,handleOnCardOpen:c,handleOnCardClose:p,personaType:m,topicId:g,contextId:M,highlightedText:N,shouldDeferCardOpenToParentWindow:T,displayName:v}=e,y=m===u?{contextId:M,highlightedText:N,hideEntityAndContextQuestion:!0}:void 0;return{cardParameters:{disableAccessibilityDefaults:!!i,personaInfo:{identifiers:{PersonaType:m||"NotResolved",HostAppPersonaId:I({userId:d,isSharedChannel:!!l,hostTenantId:o,hostConversationId:r}),TeamsMri:m!==u?d:void 0,TopicId:g},topicMetadata:y,displayName:v},behavior:Object.assign({onCardOpen:c,onCardClose:p,disableHover:!1,cardPlacementMode:"AnchorSide",shouldDeferCardOpenToParentWindow:!!T},n),externalAppSessionCorrelationId:a,ariaLabel:t,clientScenario:"MicrosoftTeams_MultiWindow",cardOpenTime:Date.now()},tabIndex:s}},m=(e,t,n)=>{e.LPC.openCard(t,Object.assign({},p(n).cardParameters))},g=(e,t)=>{e.LPC.dismissCard((()=>{}),t)},M=(e,t,n,r,l,d,c,u,p)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{enableTflSms:i}=c.get(s.J.Messaging),{showPersonCardForSMSUser:m,showPersonCardForXTapUser:g}=c.get(s.J.People),{disablePstnPersonaCard:M,disablePersonaCard:I}=c.get(s.J.Calling),{enableFlyoutInlineChat:y,enableSimplifiedFeaturesInFlyoutChat:A}=c.get(s.J.Flyout);if(I||y&&A)return!1;if(e&&o.eo.isTFLSmsMri(e))return!!i&&!!m;if(e&&o.eo.isTFLOffNetworkUser(e))return!1;if(t&&"attendee"===n&&o.eo.isAnonymousTfwUser(e))return!1;if(N(e,c))return!1;if(T(!!M,e))return!1;if(r&&!g){const t=v(e,l||"",d,p,r);if(!t)return p.warn("xTap profile Query variables are not defined for a shared channel"),!1;const{data:n}=yield u.query({query:a,variables:t,context:{callerInfo:"lpc-persona-container"}});if(!n||!n.getUsersForConversation)return p.warn("xTap profile Query returned null data"),!1;const i=n.getUsersForConversation,s=!!(i.length>0&&i[0]&&o.eo.isFederatedUser(i[0])&&i[0].xtapUser);return!s||!!g&&s}return!0})),N=(e,t)=>{const n=t.get(s.J.Metadata).environment===r.s.life,i=t.get(s.J.PhonelinkSms).enablePhonelinkSms||!1,a=t.get(s.J.HostCapabilities).phoneLinkingBlocked||!1,o=i&&!a;return e&&(0,d.EG)(e)&&n&&o},T=(e,t)=>e&&(0,d.EG)(t);function v(e,t,n,i,a){if(!t&&a)return void i.warn("Host conversation Id is not defined for a shared channel");return{mriArray:[e],conversationId:a?t:"",isShortProfileRequested:!1,peoplePickerFilters:void 0,isSharedChannel:a,hostTenantId:n}}const I=({userId:e,isSharedChannel:t,hostTenantId:n,hostConversationId:i})=>JSON.stringify({userId:e,isSharedChannel:t,hostTenantId:n,hostConversationId:i});const y=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const{data:a}=yield n.query({query:c,variables:{userId:e},context:{callerInfo:"lpc-persona-container:on-hover"}}),{user:r}=a,{userType:s,profileType:d,type:u}=r||{},p=o.eo.isMTOUser({profileType:d})?l.vf.MTOUser:o.eo.isB2BMember({profileType:d,userType:s})?l.vf.B2BMember:o.eo.isAcsUserMri(e)?l.vf.ACSUser:o.eo.isAnonymousTfwUser(e)?l.vf.anonymousUser:s||u,m=null===(i=t.createDatabag)||void 0===i?void 0:i.call(t);let g;return s&&(g=o.eo.getTfwExtendedDirectoryMembership({mri:e,userType:s})),m&&(m.isEDUser=!!g,m.EDUserState=g,m.userTypeSelected=p),m}))},637088:(e,t,n)=>{"use strict";n.d(t,{Y:()=>v});var i=n(850402),a=n(427662),r=n(50805),o=n(419925),l=n(955105),s=n(90586),d=n(401717),c=n(516909),u=n(365076),p=n(275742),m=n(265858),g=n(814423),M=n(841931),N=n(915929),T=n(494470);const v=()=>{const e=(0,u.x)(),{entityCommanding:t}=(0,a.SE)(),{enableAppDetailsToChatNavigation:n}=(0,g.NC)(r.J.Extensibility),p=(0,T.V)();return m.useCallback(((a,r)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,u,m;const g=yield(0,d.yx)(e,a),T=null===(u=null===(i=g.bots)||void 0===i?void 0:i[0])||void 0===u?void 0:u.id,v=y(T),{isM365BotPostInstallNavEnabled:C,navigateToM365BotChat:b}=p(a,v);if(I(g))r?C()?yield b(!1):t.platform.launchPersonalPlatformApp(a,!1):t.platform.launchPersonalApp({appId:a,botMri:v,isNewlyInstalled:!1});else if(A(c.qi6.Personal,g.messageExtensions)){const i=t.platform.launchAppDetailsTutorial({appName:null!==(m=g.name)&&void 0!==m?m:"",isFirstInstallation:!1,hasCommandBoxCapability:D(g,c.ht_.Commandbox),hasComposeCapability:D(g,c.ht_.Compose)}).subscribe({next:i=>{var r;i.containerState&&i.containerState===o.oq.Confirmed&&(n?t.chat.default({correlation:{source:l.D.PlatformAppDetailsDialog},stateTransition:o.su.flush,visibilityState:o.fe.show}).then((()=>{e.mutate({mutation:M.K,variables:{input:{appId:a,id:(0,N.v4)(),capability:s.dB.MessagingExtension}}})})):t.platform.appDetailsPostInstall({name:"navigateToLastChatState",appCapability:s.dB.MessagingExtension,appId:a,externalId:null!==(r=g.externalId)&&void 0!==r?r:""}).then((()=>{e.mutate({mutation:M.K,variables:{input:{appId:a,id:(0,N.v4)(),capability:s.dB.MessagingExtension}}})})))},complete:()=>{i.unsubscribe()}})}else;}))),[e,p,t.platform,n,t.chat])},I=e=>{var t,n,i,a,r,o;const l=(null!==(i=null===(n=null===(t=e.meetingExtensionDefinition)||void 0===t?void 0:t.scenes)||void 0===n?void 0:n.length)&&void 0!==i?i:0)>0,s=(null!==(o=null===(r=null===(a=e.meetingExtensionDefinition)||void 0===a?void 0:a.filters)||void 0===r?void 0:r.length)&&void 0!==o?o:0)>0;return A(c.qi6.Personal,e.staticTabs)||A(c.qi6.Personal,e.bots)||l||s},y=e=>{if(e){return(null==e?void 0:e.startsWith("28:"))?e:`28:${e}`}},A=(e,t)=>(0,p.some)(t,(t=>(0,p.includes)(t.scopes,e))),D=(e,t)=>{var n,i;return null!==(i=null===(n=e.messageExtensions)||void 0===n?void 0:n.some((e=>{var n;return null===(n=e.commands)||void 0===n?void 0:n.some((e=>e.context?e.context.some((e=>e===t)):t===c.ht_.Commandbox||c.ht_.Compose))})))&&void 0!==i&&i}},494470:(e,t,n)=>{"use strict";n.d(t,{V:()=>T});var i=n(850402),a=n(265858),r=n(516909),o=n(427662),l=n(554694),s=n(419925),d=n(955105),c=n(814423),u=n(50805),p=n(365076),m=n(804837);const g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPlatformSharedHooksGetConversationForBotIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScope"},value:{kind:"Variable",name:{kind:"Name",value:"installedScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"conversationForBot"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]},M={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPlatformSharedHooksGetPinnedChatIdsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pinnedChats"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ChatListChannelConversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]}}]}}]},N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsPlatformSharedHooksSetChatPinnedMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pinned"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setChatPinned"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"pinned"},value:{kind:"Variable",name:{kind:"Name",value:"pinned"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConversationPinnedUpdate"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"convId"}},{kind:"Field",name:{kind:"Name",value:"pinned"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SetChatPinnedMaxLimitReachedError"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"maxPinnedChats"}}]}}]}}]}}]},T=()=>{const e=(0,p.x)(),{entityCommanding:t}=(0,o.SE)(),{enableM365BotPostInstallNavigation:n,m365ChatBotIds:T}=(0,c.NC)(u.J.Messaging),[v]=(0,m.D)(N),I=(0,l.w)("useLaunchBizChatNavigation");return a.useCallback(((a,o="")=>({isM365BotPostInstallNavEnabled:()=>{const e=[...T||[]];return n&&e.includes(o)},navigateToM365BotChat:n=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,o,l,c,u;try{const{data:u}=yield e.query({query:g,variables:{appId:a,installedScope:r.qi6.Personal},fetchPolicy:"no-cache"});if(null===(o=null===(i=u.installedApp)||void 0===i?void 0:i.conversationForBot)||void 0===o?void 0:o.id){let i=!1;const r=u.installedApp.conversationForBot.id;try{const{data:t}=yield e.query({query:M});i=!!(null==t?void 0:t.pinnedChats.edges.some((e=>e.node.id===r)))}catch(e){null===(l=I.errorToTelemetry)||void 0===l||l.call(I,"failed to get pinned chat ids for bot post install navigation.","platform_userlifecycle_details_dialog_event",{appId:a,conversationId:r})}if(n&&!i)try{yield v({variables:{convId:u.installedApp.conversationForBot.id,pinned:!0}})}catch(e){null===(c=I.errorToTelemetry)||void 0===c||c.call(I,"failed to set chat pinned for bot post install navigation.","platform_userlifecycle_details_dialog_event",{appId:a,conversationId:r})}yield t.chat.chatById(u.installedApp.conversationForBot.id,{entityCommand:{stateTransition:s.su.forceFlush,visibilityState:s.fe.show,correlation:{source:d.D.PlatformAppDetailsDialog}}})}}catch(e){throw null===(u=I.errorToTelemetry)||void 0===u||u.call(I,`failed to grab the conversation id from the installed app. appId: ${a}`,"platform_userlifecycle_details_dialog_event",{appId:a}),e}}))})),[e,n,t.chat,I,T,v])}},919876:(e,t,n)=>{"use strict";n.d(t,{Rq:()=>V,Tq:()=>E,en:()=>w,oO:()=>F,bE:()=>x});var i=n(850402),a=n(516909),r=n(265858),o=n(665538),l=n(857521),s=n(27220),d=n(155537),c=n(898071),u=n(660985);const p="Disabled",m={[a.cS$.InAConferenceCall]:{backgroundImage:u.F.OnThePhone,title:"status_inACall"},[a.cS$.InACall]:{backgroundImage:u.F.OnThePhone,title:"status_inACall"},[a.cS$.Presenting]:{backgroundImage:u.F.DoNotDisturb,title:"status_presenting"},[a.cS$.OffWork]:{backgroundImage:u.F.Offline,title:"status_offline"},[a.cS$.InAMeeting]:{backgroundImage:u.F.Busy,title:"status_inAMeeting"},[a.cS$.Available]:{backgroundImage:u.F.Online,title:"status_online"},[a.cS$.Inactive]:{backgroundImage:u.F.Away,title:"status_away"},[a.cS$.Busy]:{backgroundImage:u.F.Busy,title:"status_busy"},[a.cS$.DoNotDisturb]:{backgroundImage:u.F.DoNotDisturb,title:"status_doNotDisturb"},[a.cS$.BeRightBack]:{backgroundImage:u.F.BeRightBack,title:"status_beRightBack"},[a.cS$.Away]:{backgroundImage:u.F.Away,title:"status_away"},[a.cS$.OutOfOffice]:{backgroundImage:u.F.Away,title:"status_away"},[a.cS$.Offline]:{backgroundImage:u.F.Offline,title:"status_offline"},[a.cS$.UrgentInterruptionsOnly]:{backgroundImage:u.F.DoNotDisturb,title:"status_doNotDisturb"},[a.cS$.PresenceUnknown]:{backgroundImage:u.F.Unknown,title:"status_unknown"},[a.a8y.AvailableIdle]:{backgroundImage:u.F.Idle,title:"status_away"},[a.a8y.BusyIdle]:{backgroundImage:u.F.Idle,title:"status_away"},[a.kz6.OnShift]:{backgroundImage:u.F.OnShift,title:"status_onShift"},[a.kz6.OffShift]:{backgroundImage:u.F.OffShift,title:"status_offShift"},[p]:{backgroundImage:u.F.Disabled,title:"status_disabled"}},g={status_inACall:"inACall",status_presenting:"presenting",status_offline:"offline",status_inAMeeting:"inAMeeting",status_online:"online",status_away:"away",status_Busy:"busy",status_doNotDisturb:"doNotDisturb",status_beRightBack:"beRightBack",status_unknown:"unknown",status_onShift:"onShift",status_offShift:"offShift",status_disabled:"disabled",status_blocked:"blocked"},M={[a.cS$.InAConferenceCall]:{backgroundImage:u.F.OnThePhoneOof,title:m[a.cS$.InAConferenceCall].title},[a.cS$.InACall]:{backgroundImage:u.F.OnThePhoneOof,title:m[a.cS$.InACall].title},[a.cS$.Presenting]:{backgroundImage:u.F.DoNotDisturbOof,title:m[a.cS$.Presenting].title},[a.cS$.InAMeeting]:{backgroundImage:u.F.BusyOof,title:m[a.cS$.InAMeeting].title},[a.cS$.Busy]:{backgroundImage:u.F.BusyOof,title:m[a.cS$.Busy].title},[a.cS$.DoNotDisturb]:{backgroundImage:u.F.DoNotDisturbOof,title:m[a.cS$.DoNotDisturb].title},[a.a8y.Available]:{backgroundImage:u.F.OnlineOof,title:m[a.a8y.Available].title},[a.a8y.Busy]:{backgroundImage:u.F.BusyOof,title:m[a.a8y.Busy].title},[a.a8y.DoNotDisturb]:{backgroundImage:u.F.DoNotDisturbOof,title:m[a.a8y.DoNotDisturb].title}},N=e=>{const t=(0,c.Cq)(),{siteVariables:n}=(0,s.L)(),i=n,{status:{backgroundImage:a,title:o,subTitle:l},ProvidedStatus:u,size:p,styles:m,userId:M,variables:N}=e,T=t.stringTranslate("messaging",o),v={id:`presence-pill-${M}`,title:l?`${T}, ${t.stringTranslate("messaging",l)}`:T,style:{backgroundImage:`url('${a}')`,backgroundColor:i.colorScheme.default.background},styles:m,size:p,variables:N},I=g[o]||"presence";return u?r.createElement(u,Object.assign({},v,{"data-tid":"presence","data-pstatus":I})):r.createElement(d.q,Object.assign({},v,{"data-tid":"presence","data-pstatus":I}))};N.displayName="PresenceRenderer";var T=n(427662),v=n(243334),I=n(232312);const y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ComponentsPresenceSubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PresenceSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presenceUpdateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userPresenceData"}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}}]}}]}},...I.OY.definitions]},A={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ComponentsPresenceLegacySubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PresenceSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presenceUpdateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userPresenceData"}}]}}]}},...I.OY.definitions]};var D=n(760005),C=n(814423),b=n(50805);const h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"blockedContactChangedEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blockedContactChangedEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}}]}}]}}]};var f=n(111587),k=n(290023);const S={backgroundImage:u.F.Unknown,title:"status_unknown"},U={backgroundImage:u.F.Blocked,title:"status_blocked"},E=e=>{if(!e)return S;const{isOutOfOffice:t,flwPresence:n,isFocus:i}=e;if(j(e)){const{isBlocked:t,isDisabled:n}=e;if(n)return m[p];if(t)return U}const r=e.activity,o=e.availability;if(!n||n===a.kz6.None)return i&&(r===a.cS$.DoNotDisturb||!r&&o===a.a8y.DoNotDisturb)?(e=>{const t="status_focusing";return e?{backgroundImage:u.F.FocusingOof,title:t,subTitle:"out_of_office_title"}:{backgroundImage:u.F.Focusing,title:t}})(t):t?((e,t)=>{const n=e?M[e]:M[t],i="out_of_office_title";return n?Object.assign(Object.assign({},n),{subTitle:i}):{backgroundImage:u.F.OutOfOffice,title:i}})(r,o):r?m[r]:m[o];if(n===a.kz6.OffShift)return m[a.kz6.OffShift];if(!r)return o===a.a8y.Busy?m[o]:m[a.kz6.OnShift];switch(r){case a.cS$.InAConferenceCall:case a.cS$.InACall:case a.cS$.InAMeeting:case a.cS$.Presenting:case a.cS$.Busy:return m[r];default:return m[a.kz6.OnShift]}},j=e=>!!e&&("isBlocked"in e||"isDisabled"in e),L=(e,t)=>{const{data:n}=(0,o.m)(y,{variables:{userId:e,source:t}});return E(null==n?void 0:n.presenceUpdateEvent)},O=(e,t)=>{var n,i;const{isSideLoadingInteractionEnabled:r}=(0,C.NC)(b.J.Extensibility),s=e.startsWith(D.at.BotPrefix),d=e.substr(D.at.BotPrefix.length),{data:c}=(0,l.a)(k.r6,{variables:{options:{botId:d}},skip:!s||Boolean(r)}),u=0===(null===(n=null==c?void 0:c.appDefinitions)||void 0===n?void 0:n.length),{data:g}=(0,o.m)(A,{variables:{userId:e,source:t},skip:s}),{data:M}=(0,o.m)(h,{variables:{userId:e},skip:s});if(s)return u?m[p]:m[a.a8y.Available];if(null===(i=null==M?void 0:M.blockedContactChangedEvent)||void 0===i?void 0:i.isBlocked)return U;return E(null==g?void 0:g.presenceUpdateEvent)},F=(e,t)=>{const{enableUsePresenceV2:n}=(0,C.NC)(b.J.Presence);return(e=>e?L:O)(r.useRef(!!n).current)(e,t)},x=(e,t)=>{const n=(e=>{const{title:t,backgroundImage:n}=e,i={status:"unknown",outOfOffice:!1};switch(t){case"status_online":i.status="available";break;case"status_busy":case"status_inAMeeting":case"status_inACall":i.status="busy";break;case"status_presenting":case"status_doNotDisturb":case"status_focusing":i.status="do-not-disturb";break;case"status_away":case"status_beRightBack":i.status="away";break;case"status_offline":i.status="offline";break;case"out_of_office_title":i.status="out-of-office";break;case"status_blocked":case"status_disabled":i.status="blocked";break;case"status_unknown":i.status="unknown"}switch(n){case u.F.OutOfOffice:case u.F.OnThePhoneOof:case u.F.DoNotDisturbOof:case u.F.BusyOof:case u.F.OnlineOof:i.outOfOffice=!0}return i})(F(e,t));return n.id=`presence-pill-${e}`,n},w=(e,t,n,i)=>!(!e||n&&n===i||"status_unknown"!==t.title&&"status_offline"!==t.title),z=e=>{const{userId:t,presenceSource:n}=e,{enableHideOfflinePresenceInTFL:o}=(0,C.NC)(b.J.Presence),{user:l}=(0,T.SE)(),s=F(t||"",n||a.W8Z.ups),{ProvidedStatus:d}=e,c=(0,i.__rest)(e,["ProvidedStatus"]);return w(!!o,s,t,null==l?void 0:l.id)?null:r.createElement(N,Object.assign({status:{backgroundImage:s.backgroundImage,title:s.title,subTitle:s.subTitle},ProvidedStatus:d,userId:t||""},c))},V=e=>(0,f.WD)(v.nh.POST_CRITICAL)?r.createElement(z,Object.assign({},e)):null;V.displayName="PresenceContainerV2"},660985:(e,t,n)=>{"use strict";n.d(t,{F:()=>k});var i=n(333239),a=n.n(i),r=n(508776),o=n.n(r),l=n(191628),s=n.n(l),d=n(121982),c=n.n(d),u=n(156354),p=n.n(u),m=n(17826),g=n.n(m),M=n(822585),N=n.n(M),T=n(855573),v=n.n(T),I=n(144238),y=n.n(I),A=n(152937),D=n.n(A),C=n(764859),b=n.n(C),h=n(88077),f=n.n(h);const k={Online:a(),OnShift:a(),DoNotDisturb:o(),Focusing:o(),Busy:s(),OnThePhone:s(),Away:c(),Idle:c(),BeRightBack:c(),Offline:p(),OffShift:p(),OutOfOffice:g(),Unknown:N(),OnlineOof:v(),BusyOof:y(),OnThePhoneOof:y(),DoNotDisturbOof:D(),FocusingOof:D(),Disabled:b(),Blocked:f()}},121982:(e,t,n)=>{e.exports=n.p+"133bf0a0b104ec3dfc5b9ab207e54873.svg"},88077:(e,t,n)=>{e.exports=n.p+"c52bdfa460d7b878541ff0d9833e3c7b.svg"},191628:(e,t,n)=>{e.exports=n.p+"93bf1cc8b8b8092aab2c385d85d22c8d.svg"},144238:(e,t,n)=>{e.exports=n.p+"79f07ba26ed583574678b31546848509.svg"},764859:(e,t,n)=>{e.exports=n.p+"33c8b3e3c8d71273ed9abc4d1bec9bcc.svg"},508776:(e,t,n)=>{e.exports=n.p+"5d07fdf28991f39897b8734021141a6f.svg"},152937:(e,t,n)=>{e.exports=n.p+"0d10d16cedc7b8262d0863ae455bb683.svg"},156354:(e,t,n)=>{e.exports=n.p+"774888c01ebff051c2cad178c17079b3.svg"},333239:(e,t,n)=>{e.exports=n.p+"36fd037c0c6525c9044c5c8ef757c740.svg"},855573:(e,t,n)=>{e.exports=n.p+"5066e146579e847ea9f2d818aab586bb.svg"},17826:(e,t,n)=>{e.exports=n.p+"7aa4c2455abe8a0c8cfa1e8e4b93494c.svg"},822585:(e,t,n)=>{e.exports=n.p+"e0420569cdac40ed7e659a1dae697de8.svg"},987745:(e,t,n)=>{"use strict";n.d(t,{Zb:()=>i});n(275742);const i={chat:0,channel:0}},90586:(e,t,n)=>{"use strict";var i,a,r;n.d(t,{dB:()=>i,em:()=>a,Fi:()=>r}),function(e){e.Bot="Bot",e.Connector="Connector",e.MessagingExtension="MessagingExtension",e.Tab="Tab"}(i||(i={})),function(e){e.None="None",e.Files="Files",e.Links="Links",e.Location="Location",e.People="People",e.Photos="Photos",e.Pinned="Pinned",e.Search="Search",e.Tasks="Tasks",e.TimeZone="TimeZone",e.Highlights="Highlights"}(a||(a={})),function(e){e.ORG="org",e.PROJECT="project"}(r||(r={}))},793377:(e,t,n)=>{"use strict";var i;n.d(t,{s:()=>i}),function(e){e.ag08="ag08",e.ag09="ag09",e.dod="dod",e.gallatin="gallatin",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod"}(i||(i={}))},841931:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DataClientPlatformUpdateInContextStoreLaunchInstalledAppResultMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"InContextStoreLaunchInstalledAppInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateInContextStoreLaunchInstalledAppResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},232312:(e,t,n)=>{"use strict";n.d(t,{OY:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userPresenceData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Presence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"statusNote"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"}},{kind:"Field",name:{kind:"Name",value:"publishTime"}},{kind:"Field",name:{kind:"Name",value:"expiry"}}]}},{kind:"Field",name:{kind:"Name",value:"flwPresence"}},{kind:"Field",name:{kind:"Name",value:"flwShifts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"previousShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}},{kind:"Field",name:{kind:"Name",value:"currentShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}},{kind:"Field",name:{kind:"Name",value:"nextShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isFocus"}}]}}]}},315338:(e,t,n)=>{"use strict";n.d(t,{oU:()=>p,oD:()=>M,QO:()=>N,Mw:()=>T,ON:()=>v,Rp:()=>I,wM:()=>A,s4:()=>D,Hb:()=>C,DB:()=>b,fb:()=>h,HS:()=>S,MN:()=>U,V3:()=>E,oj:()=>j,cM:()=>w});var i=n(760005),a=n(628063),r=n(711676),o=n(74346),l=n(88204),s=n(81837);const d="default",c="CallableChannelOboCall",u="callParkService",p="delegates",m="call-log",g="sla-call-history",M=";",N=e=>{switch(e){case"default":return l.FT.Default;case"screenSharing":case"ScreenSharing":return l.FT.ScreenSharing;case"emergencyGroupCall":return l.FT.EmergencyGroupCall;default:return l.FT.Unknown}},T=e=>e?Object.assign(Object.assign({},e),{type:e.type||d}):void 0,v=e=>({type:e.type,configId:e.configId,onBehalfOf:e.onBehalfOf&&Object.assign(Object.assign({},e.onBehalfOf),{type:d}),details:e.details&&Object.assign(Object.assign({},e.details),{type:d})}),I={displayName:"Unknown",id:"28:unknown",type:d},y=(e,t,n="value")=>{var i;if(!e)return"";const a=`${n}="`,r=null===(i=e.find((e=>e.indexOf(t)>=0)))||void 0===i?void 0:i.match(new RegExp(`${n}="(.*?)"`,"g"));return r?r[0].substr(a.length,r[0].length-a.length-1):""},A=(e,t,n,a,r)=>{let o,l,s,d,c=(new Date).toISOString();if(r===i.Cs.CallTranscript){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,"")));return{callId:e.callId,userParticipantId:e.originatorParticipantId,transcriptMsg:{scopeId:e.scopeId}}}catch(t){return void e.error("failed to parse transcription content.",t)}})(e,n);if(!t)return;o=t.callId,l=t.userParticipantId,s=t.transcriptMsg}else if(r===i.Cs.CallLogTranscript){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,""))),{CallId:n,UserParticipantId:i,ThreadId:a,MessageId:r}=e;return{callId:n,userParticipantId:i,transcriptMsg:{linkedMessage:{conversationId:a,messageId:r}}}}catch(t){return void e.error("failed to parse transcription content.",t)}})(e,n);if(!t)return;o=t.callId,l=t.userParticipantId,s=t.transcriptMsg}else if(r===i.Cs.CallLogRecording){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,""))),{CallId:n,UserParticipantId:i,ThreadId:a,MessageId:r}=e;return{callId:n,userParticipantId:i,recordingMsg:{linkedMessage:{conversationId:a,messageId:r}}}}catch(t){return void e.error("failed to parse recording message content.",t)}})(e,n);if(!t)return;o=t.callId,l=t.userParticipantId,d=t.recordingMsg}else if(r===i.Cs.CallRecording){const e=((e,t)=>{if(!e)return;const n=e.match(/<.*?>/g),a=y(n,'<Id type="callId"');if("Transcript"===y(n,"<RecordingContent contentTypes=","contentTypes"))return;const r=y(n,'<Id type="OriginatorParticipantId"'),o=y(n,"<RecordingInitiatorId ");return{callId:a,userParticipantId:r,recordingMsg:{conversationId:i.wS,messageId:t||"",initiatorId:o,content:e}}})(n,a);if(!e)return;o=e.callId,l=e.userParticipantId,d=e.recordingMsg}else o=t.callId,l=null==t?void 0:t.userParticipantId,c=t.startTime;return{callId:null!=o?o:"",userParticipantId:l,transcript:s,recordings:d&&[d]||[],startTime:null!=c?c:""}},D=(e,t)=>"-1"===e?t:e,C=({skypeMessage:e,loggerFactory:t})=>{var n;const i=e.conversationid,r=e.messagetype,d=e.content,{callHistoryInput:c,isSlaCallHistory:u}=h(e.properties),p=D(e.id,e.clientmessageid);if(F(c,i))return;const m=t.newLogger("CallHistoryHelper","data-resolvers-calling");try{const i=x(c),{callDirection:g,callState:y,callType:D,callPhoneLineType:C,connectTime:b,endTime:h,isDeleted:F,originatorParticipant:z,participantList:V,sessionType:Q,sharedCorrelationId:R,targetParticipant:P,threadId:B,spamProperties:W,callAttributes:Z,forwardingInfo:Y,transferInfo:G,sharedLineAppearanceParticipantList:J,targetDelegator:H}=i,X=w(i),_=A(m,i,d,p,r);if(!_)return;let K=T(z);K||(K=I,m.warn(`Could not parse valid participant from ${c}`));const q=(e=>"private"===e?s.Eg.private:null)(C),$=(e=>{switch(e){case"missed":return l.Qv.Missed;case"accepted":return l.Qv.Accepted;case"declined":return l.Qv.Declined;case"acceptedElsewhere":return l.Qv.AcceptedElsewhere;default:return l.Qv.Unknown}})(y),ee=(e=>"incoming"===e?l.kw.Incoming:"outgoing"===e?l.kw.Outgoing:l.kw.Unknown)(g),te=U(V,null==P?void 0:P.type,null==z?void 0:z.type,null===(n=null==Z?void 0:Z.transferor)||void 0===n?void 0:n.type,null==G?void 0:G.parkType),ne=O(m,i),{validTargetParticipant:ie,forwarderParticipant:ae,forwardedTargetParticipant:re}=f($,P,Y,Z,u,!!ne.isSharedLineAppearanceActivated,H),{transferorParticipant:oe,transferTargetParticipant:le}=k(Z,G,te),se=(e=>"twoParty"===e?l.Bd.TwoParty:"multiParty"===e?l.Bd.MultiParty:l.Bd.Unknown)(D),de=X&&v(X),{isCallQueue:ce}=(0,o.$Z)({callType:se,applicationContent:de}),ue=ee===l.kw.Outgoing,pe=ee===l.kw.Incoming,me=ee===l.kw.Incoming&&$===l.Qv.Missed,ge=$===l.Qv.Declined,Me=$===l.Qv.AcceptedElsewhere,Ne=Q===l.FT.EmergencyGroupCall&&(null==V?void 0:V.length)>1,Te=(0,o.r4)({endTime:h,connectTime:b,targetParticipant:P}),ve=e.originalarrivaltime;return Object.assign(Object.assign(Object.assign(Object.assign({id:`${p}${M}${_.callId}`,callStartTime:new Date(_.startTime).getTime(),applicationContent:de,callDirection:ee,originalArrivalTime:ve,isMissed:me,isIncoming:pe,isOutgoing:ue,isDeclined:ge,isAcceptedElsewhere:Me,isEmergencyGroupCall:Ne,isCallQueue:ce,callState:$,callType:se,callPhoneLineType:q,durationInMs:Te,connectTime:b,endTime:h,isDeleted:F,messageId:p,messageType:(0,a.DE)(t,r,e.properties),originatorParticipant:K,participantList:V?V.map(T):[],targetParticipant:ie,threadId:B,sessionType:N(Q),sharedCorrelationId:null!=R?R:"",spamRiskLevel:W?W.riskLevel:null},_),{transferorParticipant:oe,transferTargetParticipant:le,transferTime:null==G?void 0:G.transferTime,transferStatus:(null==G?void 0:G.transferStatus)&&S(G.transferStatus),forwarderParticipant:ae,forwardedTargetParticipant:re,forwardedTargetType:j(null==Y?void 0:Y.forwardingDestinationType),forwardingType:E(null==Y?void 0:Y.forwardingType)}),u?L(m,i):ne),{sharedLineAppearanceParticipantList:J?J.map(T):[],sharedLineAppearanceCallActionList:[]})}catch(e){m.warn(`UnhandledException in message transformation: ${e}`)}},b=({targetParticipant:e,originatorParticipant:t,applicationContent:n},i,a)=>{var r,o;return e&&t&&i?a?null===(r=null==n?void 0:n.onBehalfOf)||void 0===r?void 0:r.id:(null===(o=null==n?void 0:n.details)||void 0===o?void 0:o.id)||null:null},h=e=>{const t={callHistoryInput:void 0,isSlaCallHistory:!1};return e&&(e[g]?(t.callHistoryInput=e[g],t.isSlaCallHistory=!0):e[m]&&(t.callHistoryInput=e[m])),t},f=(e,t,n,i,a,r,o)=>{let s,d,c=t&&T(t);return e===l.Qv.Accepted&&(null==n?void 0:n.acceptedBy)&&(s=a?o&&T(o):c,c=T(n.acceptedBy)),(null==i?void 0:i.forwardedFrom)&&(s=T(i.forwardedFrom)),(e===l.Qv.AcceptedElsewhere||a||r)&&(null==n?void 0:n.acceptedBy)&&(d=T(n.acceptedBy)),(null==i?void 0:i.delegator)&&(s=T(i.delegator)),{validTargetParticipant:c,forwarderParticipant:s,forwardedTargetParticipant:d}},k=(e,t,n)=>{let i,a;return n||((null==e?void 0:e.transferor)&&(i=T(e.transferor)),(null==t?void 0:t.transferor)&&(i=T(t.transferor)),(null==t?void 0:t.transferTarget)&&(a=T(t.transferTarget))),{transferorParticipant:i,transferTargetParticipant:a}},S=e=>{switch(e){case"transferred":return l.hy.Transferred;case"transferAccepted":return l.hy.TransferAccepted;case"transferFailed":return l.hy.TransferFailed;case"transferSucceeded":return l.hy.TransferSucceeded;default:return l.hy.Unknown}},U=(e,t,n,i,a)=>{const r=a&&"none"!==a&&"Unknown"!==a;return r||r&&!!(null==e?void 0:e.find((e=>e.type&&e.type===u)))||t===u||n===u||i===u},E=e=>{switch(e){case"immediate":return l.Io.Immediate;case"simultaneous":return l.Io.Simultaneous;default:return}},j=e=>{switch(e){case"user":return l.Ry.SingleTarget;case"group":return l.Ry.Group;case"delegates":return l.Ry.MyDelegates;case"voicemail":return l.Ry.Voicemail;default:return}},L=(e,t)=>{const{sharedLineAppearanceForwardType:n,originatorDelegator:i,targetDelegator:a}=t;return e.log("[toCallHistoryItem] This is an SLA Call created as part of Shared History"),{isSharedLineAppearanceCallHistory:!0,forwardingType:E(n),originatorDelegator:i&&T(i),targetDelegator:a&&T(a)}},O=(e,t)=>{var n;const{callAttributes:i,forwardingInfo:a,sharedLineAppearanceActivated:o}=t,l=(null===(n=null==i?void 0:i.onBehalfOf)||void 0===n?void 0:n.id)&&(0,r.lp)(i.onBehalfOf.id);return e.log("[toCallHistoryItem] This is an SLA Call created as part of Personal History"),{isSharedLineAppearanceActivated:!!(o||(null==i?void 0:i.delegator)||l||(null==a?void 0:a.forwardingDestinationType)===p),originatorDelegator:l&&(null==i?void 0:i.onBehalfOf)?T(i.onBehalfOf):void 0,targetDelegator:(null==i?void 0:i.delegator)?T(i.delegator):void 0}},F=(e,t)=>void 0===t?!e:t!==i.wS,x=e=>e?JSON.parse(e):{},w=e=>{var t,n,i;const{applicationContent:a,callAttributes:r,onBehalfOfContext:o}=e;let l;return l=o&&!a?{type:c,configId:o.id||"",onBehalfOf:{type:(null===(t=null==r?void 0:r.onBehalfOf)||void 0===t?void 0:t.type)||c,id:(null===(n=null==r?void 0:r.onBehalfOf)||void 0===n?void 0:n.id)||"",displayName:(null===(i=null==r?void 0:r.onBehalfOf)||void 0===i?void 0:i.displayName)||""}}:a,l}},81837:(e,t,n)=>{"use strict";var i;n.d(t,{Eg:()=>i}),function(e){e.private="private"}(i||(i={}))},785014:(e,t,n)=>{"use strict";n.d(t,{Nd:()=>l,nq:()=>s,NF:()=>d,gS:()=>c});var i=n(516909),a=n(760005),r=n(500396),o=n(876661);const l=e=>{if(e)switch(e){default:case"Success":return i.OQk.Success;case"SendFailure":return i.OQk.SendFailure;case"SendFailureCanRetry":return i.OQk.SendFailureCanRetry;case"EditFailure":return i.OQk.EditFailure;case"EditFailureCanRetry":return i.OQk.EditFailureCanRetry;case"DeleteSingleFailure":return i.OQk.DeleteSingleFailure;case"DeleteSingleFailureCanRetry":return i.OQk.DeleteSingleFailureCanRetry;case"DeleteAllFailure":return i.OQk.DeleteAllFailure;case"DeleteAllFailureCanRetry":return i.OQk.DeleteAllFailureCanRetry}},s=e=>!(!e||!/^\[[^\]]+\]$/gi.test(e)),d=e=>{if(!e||!(0,o.J6)(e))return null;if((0,o.qo)(e)===r.xu.Standard){return(e=>{if(!e)return null;let t,n;try{n=e[a.Q5.ChannelSettings]&&JSON.parse(e[a.Q5.ChannelSettings])}catch(e){return null}if(!n)return null;switch(null==n?void 0:n.allowReplies){case r.yt.Moderators:t=i.ytf.Moderators;break;case r.yt.Everyone:default:t=i.ytf.Everyone}return t})(e.threadProperties)}return null},c=e=>{var t;return e?!0===(null===(t=e.memberProperties)||void 0===t?void 0:t.isModerator)||!1:null}},571096:(e,t,n)=>{"use strict";n.d(t,{b6:()=>J,NP:()=>G,xA:()=>q,FX:()=>$,Hi:()=>K,Rx:()=>ee,NL:()=>Jt,AY:()=>lt,pR:()=>qe,xr:()=>Le,Gt:()=>ke,q7:()=>fe,qJ:()=>zt,MB:()=>Ut,fN:()=>Ge,H4:()=>Ie,dx:()=>Ae,Qq:()=>nt,vI:()=>tt,I6:()=>it,eY:()=>Ot,zT:()=>et,Dy:()=>en,Er:()=>tn,D1:()=>kt,nI:()=>Bt,YD:()=>Rt,rP:()=>wt,UL:()=>Vt,Eu:()=>Gt,wm:()=>Pt,nm:()=>nn,oQ:()=>$t,im:()=>ht,AK:()=>Qt,fM:()=>Wt,GE:()=>Yt,Go:()=>Et,wX:()=>Re,Ey:()=>ye,bv:()=>we,lg:()=>Mt,yU:()=>Ue,aw:()=>xt,x6:()=>mt,_$:()=>pt,ph:()=>vt,O5:()=>yt,Hl:()=>gt,J$:()=>Fe,CH:()=>Oe,sf:()=>Be,TK:()=>be,b_:()=>$e,FH:()=>Ke,nF:()=>dt,Th:()=>Ce,eN:()=>Dt,l0:()=>ft,Lr:()=>ut,it:()=>Ne,YX:()=>bt,ob:()=>Pe,eH:()=>ae,is:()=>de,YU:()=>Me,_S:()=>Nt,t4:()=>Tt,zK:()=>De,ac:()=>Ee,_V:()=>Ft,iB:()=>he,RU:()=>Lt,OB:()=>re,xT:()=>jt,Pi:()=>St,SX:()=>qt});var i=n(850402),a=n(50805),r=n(663945),o=n(181620),l=n(533464),s=n(522456),d=n(711676),c=n(760005),u=n(628063),p=n(592153),m=n(114881),g=n(500396),M=n(876661),N=n(708975),T=n(303065),v=n(614658),I=n(863553),y=n(558632),A=n(878652),D=n(905581),C=n(132756),b=n(275742),h=n(315338),f=n(516909),k=n(951296),S=n(205480),U=n(32552),E=n(451567);const j=e=>{if(!e)return[];const t="meeting.scheduledMeetingInfo";let n=F(e,["startTime","endTime","eventType"],t);const{eventRecurrenceRange:i,eventRecurrencePattern:a}=e;return n=[...n,...L(i,t),...O(a,t)],n},L=(e,t)=>F(e,["startDate"],`${t}.eventRecurrenceRange`),O=(e,t)=>{let n=[];if(e){const{daily:i,weekly:a,monthly:r,yearly:o,relativeMonthly:l,relativeYearly:s}=e;n=[...F(e,["patternType"],`${t}.eventRecurrencePattern`),...F(i,["interval"],`${t}.eventRecurrencePattern.daily`),...F(a,["interval","daysOfTheWeek"],`${t}.eventRecurrencePattern.weekly`),...F(r,["interval","dayOfMonth"],`${t}.eventRecurrencePattern.monthly`),...F(o,["month","dayOfTheMonth"],`${t}.eventRecurrencePattern.yearly`),...F(l,["interval","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeMonthly`),...F(s,["month","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeYearly`)],a&&a.daysOfTheWeek&&a.daysOfTheWeek.some((e=>(0,b.isNil)(e)))&&n.push(`${t}.eventRecurrencePattern.weekly.daysOfTheWeek`)}return n},F=(e,t,n)=>{const i=[];return(0,b.isNil)(e)||t.forEach((t=>{(0,b.isNil)(e[t])&&i.push(`${n}.${t}`)})),i};var x=n(38613),w=n(431506),z=n(785014);function V(e){return!!e&&(e.messageType&&(t=e.messageType,[c.Cs.AddMember,c.Cs.Call,c.Cs.CallRecording,c.Cs.CallLocalRecording,c.Cs.CallTranscript].indexOf(t)>=0)||function(e){return!!e.deleteTime}(e));var t}const Q=(e,t)=>{var n;return(null==e?void 0:e.from)!==t&&!!(null===(n=null==e?void 0:e.mentions)||void 0===n?void 0:n.some((e=>"everyone"===e.mentionType)))};var R=n(745834),P=n(816037);const B=(e,t,n)=>{var i,a,r,o,l;if(!t||!t.vivaTopicsAnnotations)return{contentWithAnnotations:void 0,vivaTopicsAnnotations:null};const s=null!==(i=(e=>{try{const t=(0,R.T)(e);return(0,P.E)(t)}catch(e){return}})(t.vivaTopicsAnnotations))&&void 0!==i?i:null;if(!n)return{contentWithAnnotations:void 0,vivaTopicsAnnotations:s};let d="",c=0;if((null===(a=null==s?void 0:s.entityAnnotation)||void 0===a?void 0:a.sectionMatches)&&e){let t=null!==(o=null===(r=s.entityAnnotation.sectionMatches[0])||void 0===r?void 0:r.entityMatches)&&void 0!==o?o:[];t=t.filter((e=>null!=e)).sort(((e,t)=>{var n,i;return(null!==(n=null==e?void 0:e.startPos)&&void 0!==n?n:-1)-(null!==(i=null==t?void 0:t.startPos)&&void 0!==i?i:-1)}));for(const n of t)if(n&&n.startPos&&n.length&&n.entities&&n.entities[0]){e.slice(n.startPos,n.startPos+n.length).toLowerCase()===(null===(l=n.highlightedName)||void 0===l?void 0:l.toLowerCase())&&(d+=`${e.slice(c,n.startPos)}<span itemtype="http://schema.skype.com/Topic" highlight itemid="${n.entities[0].id}">${e.slice(n.startPos,n.startPos+n.length)}</span>`,c=n.startPos+n.length)}d+=e.slice(c)}return{contentWithAnnotations:d,vivaTopicsAnnotations:s}},W="http://schema.skype.com",Z=`${W}/StarredMessage`,Y=`${W}/Mention`,G=`${W}/File`,J=2,H=I.F,X=new Map([["sms",f.F6r.SMS],["email",f.F6r.Email],["call",f.F6r.Call],["teamscall",f.F6r.TeamsCall],["etnp",f.F6r.ETNP]]),_=new Set(["RichText/Media_LocalRecording","RichText/Media_CallRecording","RichText/Media_CallTranscript","Event/Call"]);var K;!function(e){e.FAMILY="family",e.FRIENDS="friends",e.PROJECT="projectCoord",e.WORKPLACE="company",e.TRIP_PLANNING="tripPlanning",e.GET_TOGETHER="getTogether",e.LOCAL_COMMUNITY="localCommunity",e.HOLIDAY_PLANNING="holidayPlanning"}(K||(K={}));const q="preview-",$="newchat",ee="welcomePage",te=(e,t,n=!1)=>{if(!(null==e?void 0:e.emotions))return null;const i=e.emotions.map((({key:e,users:t})=>({key:e,users:t.map((({mri:e,time:t,value:n})=>({id:H(e),time:t,value:n}))).sort(((e,t)=>e.time-t.time))})));return n&&i.sort(((e,n)=>{var i,a,r,o,l,s;return(null!==(r=null!==(a=null===(i=null==t?void 0:t.emotions)||void 0===i?void 0:i[n.key])&&void 0!==a?a:n.users.length)&&void 0!==r?r:0)-(null!==(s=null!==(l=null===(o=null==t?void 0:t.emotions)||void 0===o?void 0:o[e.key])&&void 0!==l?l:e.users.length)&&void 0!==s?s:0)})),i},ne=e=>{if(!e||!e.emotions)return null;const t=e.emotions;return Object.keys(t).map((e=>({key:e,count:t[e]})))},ie=e=>{if(!e||!e.escalations)return null;return JSON.parse(e.escalations).map((({key:e,users:t})=>({key:X.get(e),users:t.map((({mri:e,time:t,value:n})=>({mri:H(e),time:t,value:n})))})))},ae=(e,t,n)=>e&&e.mentions?le(e.mentions,t,n):null,re=(e,t,n)=>e&&e.onbehalfof?le(e.onbehalfof,t,n):null,oe=(e,t)=>{if(!t||!t.atp)return null;const n=t.atp;try{return"string"==typeof n?JSON.parse(n):n}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toAtpSharepointData: ${t}`),null}},le=(e,t,n)=>{var i;try{if("string"==typeof e&&(0,d.lp)(e))return null;const n="string"==typeof e?JSON.parse(e):e;return(null==n?void 0:n.length)?n.map((({itemid:e,mri:n,displayName:i,mentionType:a})=>({id:`${t}_${e}_${n}`,userId:n,itemId:e,displayName:i,mentionType:a}))):null}catch(e){const a=null==n?void 0:n.newLogger("Chat Helper","data-resolvers-common");return null===(i=null==a?void 0:a.errorToTelemetry)||void 0===i||i.call(a,`UnhandledException in messageId: ${t}, processMentions - errorcode: ${e.errorcode}, error: ${e.error}`,"process_mentions_parse_error"),null}},se=(e,t,n,i)=>{var a,r,o;if(!t||!t.files)return null;const l=e.newLogger("Chat Helper","data-resolvers-common");try{let e=JSON.parse(null==t?void 0:t.files),o=0;return e=e.filter((e=>"deeplink"===e.type)),o=e.length,e=e.filter((e=>e)),o!==e.length&&(null===(a=null==l?void 0:l.errorToTelemetry)||void 0===a||a.call(l,`toDeepLinks::Files contains falsy value. Filtered out.::id=${n}::conversationId=${i}`,"process_deeplink_parse_error"),o=e.length),e=e.filter((e=>e.id)),o!==e.length&&(null===(r=null==l?void 0:l.errorToTelemetry)||void 0===r||r.call(l,`toDeepLinks::Files contains object without id field which should be a required field. Filtered out.::id=${n}::conversationId=${i}`,"process_deeplink_parse_error")),e.map((({id:e,title:t,fileInfo:n,channelId:i,state:a})=>({id:e,title:t,state:a,serverRelativeUrl:n.serverRelativeUrl,channelId:i,siteUrl:n.siteUrl,objectUrl:n.fileUrl})))}catch(e){return null===(o=null==l?void 0:l.errorToTelemetry)||void 0===o||o.call(l,`toDeepLinks::errorcode=${e.errorcode}::error=${e.error}::id=${n}::conversationId=${i}`,"process_deeplink_parse_error"),null}},de=e=>e&&JSON.stringify((0,b.map)(e,(e=>{var{content:t}=e,n=(0,i.__rest)(e,["content"]);return Object.assign(Object.assign({},n),{content:JSON.parse(t)})}))),ce=(e,t)=>{if(!e||!e.links)return{urlPreview:null,embeddedLinks:null};try{const t=["http","https"],n=JSON.parse(e.links),i=[],a=[];return n.forEach((e=>{ue(e,i,t),pe(e,a,t)})),{urlPreview:a.length>0?a[0]:null,embeddedLinks:i}}catch(e){return t.newLogger("Chat Helper","data-resolvers-common").log(`Failed to parse message link properties: ${e}`),{urlPreview:null,embeddedLinks:null}}},ue=(e,t,n)=>{const{url:i,fileShareUrlMeta:a,title:r,description:o}=e,l=(0,y.Nm)(i,n);a&&t.push({objectUrl:l,title:r,description:o,fileShareUrlMeta:a})},pe=(e,t,n)=>{const{url:i,preview:a,previewenabled:r}=e,{previewurl:o,previewmeta:l,title:s,description:d}=a||{},c=(0,y.Nm)(i,n);t.push({url:c,thumbnail:(0,y.Nm)(o,n),title:s,description:d,previewEnabled:r,thumbnailMeta:l?{width:l.width,height:l.height}:null})},me=(e,t,n,i)=>{let a=i&&i.policyViolation;const r=i&&i.genericStreamMetadata;if(!a&&!r)return null;const o={};if("string"==typeof a)try{a=JSON.parse(a)}catch(n){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing PolicyViolation in message: ${t}. Error: ${n}`)}a&&(o.policyViolation=a);let l=r&&r.policyTip;if("string"==typeof r)try{l=JSON.parse(r).policyTip}catch(n){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing policy tip in message: ${t}. Error: ${n}`)}if(l){const e=i&&i.subject;o.dlpData={id:t,content:n,policyTip:l,subject:e}}return o},ge=e=>{if(!e.scheduledmeetinginfo||(0,b.isNil)(e.scheduledmeetinginfo.eventType))return null;const t=e.scheduledmeetinginfo,{iCalUid:n}=t,a=(0,i.__rest)(t,["iCalUid"]);return Object.assign({iCalUID:n},a)},Me=e=>{const{itemId:t,meetingTitle:n,meetingActionType:a,scheduledMeetingInfo:r}=e,o=(0,i.__rest)(e,["itemId","meetingTitle","meetingActionType","scheduledMeetingInfo"]),l=Object.assign(Object.assign(Object.assign({},o),(e=>{const{iCalUID:t}=e,n=(0,i.__rest)(e,["iCalUID"]);return{scheduledmeetinginfo:Object.assign(Object.assign({},n),{iCalUid:t})}})(r)),{itemid:t,meetingtitle:n,"@type":a});return JSON.stringify(l)},Ne=(e,t)=>{if(!t||!t.meeting)return null;try{const e=JSON.parse(t.meeting),{organizerId:n,tenantId:i,meetingJoinUrl:a,location:r,itemid:o,meetingtitle:l,rsvpTo:s,body:d}=e;return(e=>{const{scheduledMeetingInfo:t}=e,n=j(t);if(n.length)throw(0,D.Tr)(C.w5.DataLayerClient,C.jK.MissingParameter,`validate Meeting schema failed. Missing required prop(s): ${n.join(", ")}`);return e})({meetingActionType:e[c.BM.MeetingType],organizerId:n,tenantId:i,meetingJoinUrl:a,location:r,itemId:o,meetingTitle:l,rsvpTo:s,body:d,scheduledMeetingInfo:ge(e)})}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toMeeting: ${t}`),null}},Te=(e,t,n,i)=>{const a=t||n;if(a)return a;if(i&&_.has(e)){const e=i.match(/<id type="callId"[^>]*?\svalue="([^"]+?)"/i);return e&&e[1]||null}return null},ve=(e,t)=>"-1"===e?t:e,Ie=(0,s.Z)((e=>new Intl.Collator(e,{numeric:!1,sensitivity:"accent"}))),ye=(e,t)=>{if(e.length<=1)return e;const n=Ie(t),i=[...e];return i.sort(((e,t)=>n.compare(e.displayName||"",t.displayName||""))),i},Ae=(e,t,n)=>{const i=ye(e,n),a=[],r=[];return(0,b.forEach)(i,(e=>{const{id:n,displayName:i}=e;if(n!==t&&!E.eo.isTFLOffNetworkUser(n)&&i){if(r.push(i),20===r.length)return!1;a.length<3&&a.push(e)}return!0})),{membersLimited:a,memberDisplayNamesLimited:r}},De=(e,t,n,i,a,r,l,s,c=!1)=>{var u,p,m;if(!(null==e?void 0:e.id))return;const g=Ce(e,t,i,a,n,!!r),{id:M,messagetype:N,properties:T,callId:v,skypeguid:I,composetime:y,content:A,conversationid:D,draftDetails:C,crossPostData:b}=e,f=(0,d.kw)(C),k=(0,w.xJ)(t,null==T?void 0:T.languageStamp,null==l?void 0:l.targetLanguageCode,null==A?void 0:A.length,s),S=(0,w.R4)(l,k,g.translatedContent,g.translationStatus),{vivaTopicsAnnotations:U,contentWithAnnotations:E}=B(null!==(u=g.content)&&void 0!==u?u:void 0,T,c);return Object.assign(Object.assign({},g),{content:U&&E?E:g.content,__typename:"Message",interopDeliveryState:Kt(null==T?void 0:T.deliveryState),smsDeliveryReports:T&&T.smsDeliveryReports?T.smsDeliveryReports:null,announcement:we(T),escalations:ie(T),notification:Ht(t,T),notifications:_t(t,T),meeting:Ne(t,T),onBehalfOf:re(T,M,t),callId:Te(N,v,I||T&&T.skypeguid,A),callLog:T&&(0,h.Hb)({skypeMessage:e,loggerFactory:t}),skypeguid:I,composeTime:y,isCallStartedMessage:(0,o.LY)(A,N),replyPermission:null!==(p=null==T?void 0:T.replyPermission)&&void 0!==p?p:null,atpSharepointData:oe(t,T),isDeletedByAdmin:(null==T?void 0:T.adminDelete)||!1,suggestedActions:(null==T?void 0:T.suggestedActions)||null,scheduledSendTime:f?new Date(f).toISOString():null,draftId:(null==T?void 0:T.draftId)||(f?null==g?void 0:g.id:null),forwardedMessageContext:xe(T,A),conversationId:D,vivaTopicsAnnotations:U,crossPostStatus:b?(0,z.Nd)(b.status):void 0,crossPostFailedChannels:null==b?void 0:b.failedChannels,isWrittenInPreferredLanguage:!S,sourceLanguageCode:null!==(m=null==k?void 0:k.code)&&void 0!==m?m:null})},Ce=({id:e,content:t,originalarrivaltime:n,from:i,messagetype:a,annotationsSummary:r,userHasStarred:o,properties:l,clientmessageid:s,version:d,prioritizeimdisplayname:c,imdisplayname:p,translation:m,conversationid:g,conversationLink:M},N,T,v,I,y=!1)=>{var A;let D=t;T&&(D=T);const C=(0,u.le)(N,l,v),b=(0,w.cC)(m),h=(null==b?void 0:b.translationStatus)===f.C14.Done?(0,x.MX)()[0].toString():d,S=(0,w.xJ)(N,null==l?void 0:l.languageStamp);return Object.assign(Object.assign(Object.assign({id:ve(e,s),content:D,originalArrivalTime:n,from:H(i),messageType:(0,u.DE)(N,a,l),isImportant:(0,k.wU)(null==l?void 0:l.importance),importance:(0,k.gy)(null==l?void 0:l.importance),emotionsSummary:ne(r),emotions:te(l,r,y),mentions:ae(l,e,N),cards:C,files:(0,u.jz)(N,l),deeplinks:se(N,l,e,g||M)},ce(l,N)),{deleteTime:null==l?void 0:l.deletetime,editTime:null==l?void 0:l.edittime,version:h,userHasSaved:o,renamedDisplayName:c?p:null,imDisplayName:p,clientMessageId:s,dlpContext:me(N,e,t,l),atpSharepointData:oe(N,l),status:I||f.rJC.Delivered,hardDeleteReason:null==l?void 0:l.hardDeleteReason,hardDeleteTime:null==l?void 0:l.hardDeleteTime,onBehalfOf:re(l,e,N),sourceLanguageCode:null!==(A=null==S?void 0:S.code)&&void 0!==A?A:null}),b)},be=({content:e,id:t,messageType:n,originalArrivalTime:i,type:a,version:r})=>({__typename:"Message",content:e,id:t,messageType:n,originalArrivalTime:new Date(i).toISOString(),type:a,version:r}),he=(e,t,n,i,a=!1)=>{const r=De(e,t,Ft(e.state),void 0,void 0,!!(null==n?void 0:n.shouldSortReactions),i,null==n?void 0:n.translationLanguageStampingTunerSettings,a);if(!r)throw(0,D.Tr)("ChatHelpers",C.jK.Undefined,"toNewMessageSchema",{resource:e},"Bad shaped NewMessage");let o=null;if(e&&e.conversationLink){const t=(0,d.P5)(e);o=t===r.id?null:t}return{convId:e.conversationid||(0,d.o_)(e),replyChainId:o,threadType:e.threadtype,threadTopic:e.threadtopic,message:r}};function fe(e,t){return{__typename:"LastMessage",content:"",preview:"",messageType:"Text",id:e,originalArrivalTime:t,imDisplayName:null,from:null,deleteTime:null,files:null,cards:null,embeddedLinks:null,callId:null,replyPermission:null,onBehalfOf:null,atpSharepointData:null,deeplinks:null,version:null,importance:null,interopDeliveryState:null,smsDeliveryReports:null,suggestedActions:null,emotions:null,emotionsSummary:null,escalations:null,mentions:null,status:null,clientMessageId:e,urlPreview:null,dlpContext:null,editTime:null,userHasSaved:null,isSystemMessage:!1,canShowEveryoneMentionBadge:!1}}function ke(e,t){return{__typename:"ConsumptionHorizon",id:e,originalArrivalTime:t,timeStamp:t,clientMessageId:(0,U.K)()}}const Se=()=>({members:[],membersLimited:[],activeCallsCount:null,canBeDiscarded:null,canBeFavorited:null,canBeHidden:null,botMembers:null,canBeLeft:null,canBeMuted:null,canBePinned:null,canBotBeBlocked:null,canManageApps:null,canPopOut:null,canTagContact:null,chatSubType:null,isDisabled:!1,isOneOnOne:!1,isOneOnOneBotChat:!1,isRead:!0,datatid:null,displayName:null,hasActions:null,hasActiveCalls:null,hasFailedMessages:null,isBotBlocked:null,isBotUser:null,isContactTagged:null,isFederated:!1,isHidden:null,isHighImportance:null,isLastMessageFromMe:null,isLastMessageText:null,isMeeting:!1,isMuted:null,isNewChat:!0,isSfB:!1,isUrgentImportance:null,isUserMember:!0,creator:null,meetingInformation:null,userConsumptionHorizon:null,consumptionHorizonBookmark:null,lastMessageTime:null,lastContentMessageTime:null,longTitle:null,messagePreview:null,messagePreviewAria:null,otherMemberMris:null,pictureGroup:null,pictureUpn:null,pinnedIndex:null,plGroupKey:null,presenceSource:null,showAtMention:null,showMarkers:null,tooltipTitle:null,substrateGroupId:null});function Ue(e){const t=new Date,n=t.toISOString(),i=t.getTime().toString();return Object.assign(Object.assign({},Se()),{__typename:"Conversation",id:e,memberIds:[],memberDisplayNamesLimited:[],nonTeamsFederatedUserLimitedNames:[],hasFederatedUser:!1,chatHistoryHiddenTime:null,hasTflConsumerUser:!1,hasEnterpriseUser:!1,hasUnknownConsumerUser:!1,hasUnknownEnterpriseUser:!1,hasTflSmsUnverifiedUser:!1,hasTflSmsVerifiedUser:!1,tflOffNetworkUser:null,cfet:!1,consumerGroupId:null,tenantId:null,title:"",hasBotMember:!1,hasUnresolvedFederatedUser:!1,isChatDisabledForRecipients:!1,typingUsers:[],isPrivateChatPolicyDefinedScenario:null,meetingChatPolicy:null,me:null,tflOffNetworkUserLength:null,nonTeamsFederatedUsers:[],nonTeamsFederatedUsersLength:0,chatType:f.z_3.Chat,type:f.z_3.Chat,lastMessage:fe(i,n),consumptionHorizon:ke(e,n),addedBy:null,addedByTenantId:null,sensitivityLabel:null})}const Ee=(e,t,n,a,r)=>{var o,l,s,{annotationsSummary:d,id:c,from:p,messageType:m,properties:g,version:M}=e,N=(0,i.__rest)(e,["annotationsSummary","id","from","messageType","properties","version"]);if(void 0===a&&(a=!1),void 0===r&&(r=!1),!c)return null;try{const{vivaTopicsAnnotations:e,contentWithAnnotations:i}=B(null!==(o=N.content)&&void 0!==o?o:void 0,g,r);return Object.assign(Object.assign(Object.assign({__typename:"Message",id:c,from:p,messageType:(0,u.DE)(n,m,g),version:(0,b.isNumber)(M)?M.toString():void 0,isImportant:(0,k.wU)(g&&g.importance),importance:(0,k.gy)(g&&g.importance),interopDeliveryState:Kt(null==g?void 0:g.deliveryState),smsDeliveryReports:(null==g?void 0:g.smsDeliveryReports)||null,emotions:te(g,d,a),emotionsSummary:ne(d),announcement:we(g),escalations:ie(g),mentions:ae(g,c,n),onBehalfOf:re(g,c,n),cards:(0,u.le)(n,g),files:(0,u.jz)(n,g),deeplinks:se(n,g,c,t)},ce(g,n)),{deleteTime:g&&g.deletetime,editTime:g&&g.edittime,isDeletedByAdmin:g&&g.adminDelete,scheduledSendTime:(null==g?void 0:g.sendAt)||null,draftId:(null==g?void 0:g.draftId)||null,forwardedMessageContext:xe(g,N.content||""),hardDeleteTime:g&&g.hardDeleteTime,hardDeleteReason:g&&g.hardDeleteReason,suggestedActions:(null==g?void 0:g.suggestedActions)||null,status:f.rJC.Delivered,dlpContext:me(n,c,N.content,g),meeting:Ne(n,g),callId:g&&g.skypeguid,callLog:g&&(0,h.Hb)({skypeMessage:{properties:g,id:c,conversationid:t,messagetype:m,content:N.content,originalarrivaltime:N.originalArrivalTime},loggerFactory:n}),sourceLanguageCode:null!==(s=null===(l=(0,w.xJ)(n,null==g?void 0:g.languageStamp))||void 0===l?void 0:l.code)&&void 0!==s?s:null,vivaTopicsAnnotations:e,content:e&&i?i:N.content}),N)}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message transformation: ${e}`),Object.assign({id:c,from:p,messageType:(0,u.DE)(n,m,g),isImportant:null,emotions:null,mentions:null,files:null,announcement:null,urlPreview:null,deleteTime:null,status:null},N)}},je=({originalArrivalTime:e,timeStamp:t,clientMessageId:n})=>({originalArrivalTime:new Date(e).toISOString(),timeStamp:new Date(t).toISOString(),clientMessageId:n}),Le=(e,t,n)=>Oe({id:e,properties:{[c.Ff.ConsumptionHorizon]:(0,p.A1)(n)},type:t}),Oe=e=>Object.assign({id:e.id},je((0,p.bf)(e))),Fe=e=>Object.assign({id:e.id},je((0,p.BU)(e))),xe=(e,t)=>{if(!e||!e.originalMessageContext)return null;const n=t.indexOf(m.mU.ForwardedContentStart),i=t.lastIndexOf(m.mU.ForwardedContentEnd),a=t.slice(n,i+m.mU.ForwardedContentEnd.length),r="string"==typeof e.originalMessageContext?JSON.parse(e.originalMessageContext):e.originalMessageContext;return{originalSenderMri:r.originalSender,originalArrivalTime:r.originalSentTime,originalMessageId:r.messageId,originalMessageContent:a,originalThreadId:r.originalThreadId}},we=e=>{const t={title:"",originalImageUrl:null,croppedImageUrl:null,colorTheme:null};if(!(null==e?void 0:e.cards))return t;const n="string"==typeof e.cards?JSON.parse(e.cards):e.cards;if(!n||0===n.length)return t;const i=n.find((e=>"application/vnd.microsoft.teams.messaging-announcementBanner"===e.contentType));if(!i)return t;const a=ze(i);return{title:e.title?e.title:"",originalImageUrl:a.originalImageUrl,croppedImageUrl:a.croppedImageUrl,colorTheme:a.colorTheme,croppedImageHeight:a.croppedImageHeight,croppedImageWidth:a.croppedImageWidth,croppedImageAltText:a.croppedImageAltText,isTeamsIllustration:a.isTeamsIllustration}},ze=e=>{let t=(0,b.get)(e,"content.imageData.origImage.src",null),n=(0,b.get)(e,"content.imageData.croppedImage.src",null);const i=(0,b.get)(e,"content.imageData.croppedImage.imageHeight",null),a=(0,b.get)(e,"content.imageData.croppedImage.imageWidth",null),r=(0,b.get)(e,"content.imageData.croppedImage.imageAltText",null),o=(0,b.get)(e,"content.imageData.isTeamsIllustration",null);let l=(0,b.get)(e,"content.imageData.colorTheme",null)||(0,b.get)(e,"content.colorTheme",null);return t=void 0===t?null:t,n=void 0===n?null:n,l=void 0===l?null:l,{originalImageUrl:t,croppedImageUrl:n,croppedImageHeight:i,croppedImageWidth:a,croppedImageAltText:r,colorTheme:l,isTeamsIllustration:o}},Ve=(e,t,n)=>{try{const n=Qe(t),i=null==n?void 0:n.map((t=>({activityReplyToId:t.replyToId,activityTimestamp:t.timestamp,convId:e,suggestedReplies:t.suggestedActions.actions.filter((e=>{var t,n;return(null===(t=null==e?void 0:e.channelData)||void 0===t?void 0:t.id)&&(null===(n=null==e?void 0:e.channelData)||void 0===n?void 0:n.utcTime)})).map((e=>{var n,i;const a={targetMessageId:(null===(n=null==e?void 0:e.channelData)||void 0===n?void 0:n.targetMessageId)||t.replyToId,type:(null===(i=null==e?void 0:e.channelData)||void 0===i?void 0:i.type)||"reply"};return{suggestionChannelData:Object.assign(Object.assign({},null==e?void 0:e.channelData),a),value:e.value||e.title,title:e.title,whisperId:t.id}}))})));return i&&0!==i.length?{suggestedRepliesCollections:i}:null}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").error(`formatQuickReplyAugmentationFromObject: Exception in parsing quick reply augmentation. Error: ${e}`),null}},Qe=e=>{const t=e&&e.suggestedActivities&&e.suggestedActivities.filter((e=>{var t,n,i;return(null==e?void 0:e.type)===c.uV&&(null===(t=null==e?void 0:e.from)||void 0===t?void 0:t.id)===c.ZI&&(null==e?void 0:e.timestamp)&&(null===(i=null===(n=null==e?void 0:e.suggestedActions)||void 0===n?void 0:n.actions)||void 0===i?void 0:i.some((e=>e.type===c.qC||e.type===c.DC)))}));return t&&0!==t.length?t:null},Re=(e,t,n)=>{const i=t&&t[c.Ff.SmartReplies];return i&&"string"==typeof i?((e,t,n)=>{try{const i=JSON.parse(t);return Ve(e,i,n)}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").error(`formatQuickReplyAugmentationFromString: Exception in parsing quick reply augmentation. Error: ${e}`),null}})(e,i,n):null},Pe=e=>{switch(e){case g.wJ.None:return f.wJZ.Unknown;case g.wJ.Adhoc:return f.wJZ.Adhoc;case g.wJ.Scheduled:return f.wJZ.Scheduled;case g.wJ.Recurring:return f.wJZ.Recurring;case g.wJ.Broadcast:return f.wJZ.Broadcast;case g.wJ.MeetNow:return f.wJZ.MeetNow}},Be=e=>e&&e.map((e=>({id:e.id,originalArrivalTime:e.consumptionhorizon,messageVisibilityTime:e.messageVisibilityTime})))||null;function We(e,t){if(!e||!t)return!1;return(0,M.hu)(e,t)>0}function Ze(e,t,n,i,a,r=!1,o=!1,l,s){const c=(0,u.C)(e,n),p=e.find((({id:e})=>e===t))||null,m=Lt(e),g=(0,d.iK)(e,a,[]).members||[];return Object.assign(Object.assign(Object.assign(Object.assign({memberIds:g.map((({id:e})=>e))},Ae(g,t,i)),qe(c)),lt(t,g)),{me:p,isUserMember:!!p,tflOffNetworkUser:(0,b.first)(m),tflOffNetworkUserLength:m.length,hasBotMember:g.some((({id:e})=>(0,d.bl)(e))),hasFederatedUser:!!c.length||r,hasTflConsumerUser:nt(g)||o,hasEnterpriseUser:ot(g),hasUnknownEnterpriseUser:rt(g),hasUnknownConsumerUser:at(g),hasUnresolvedFederatedUser:c.some(E.eo.isUnknownUser),hasTflSmsUnverifiedUser:tt(g),hasTflSmsVerifiedUser:it(g),isRetentionHorizonSet:We(s,l)})}const Ye=e=>"string"==typeof e?"true"===e.toLowerCase():e,Ge=e=>{const t=Object.keys(null!=e?e:{}).filter((e=>e.includes(c.Q5.Liveness))).map((t=>({key:t,value:String(e[t])})));return(0,b.isEmpty)(t)?null:t};function Je(e,t,n,i,r,o,l,s,u){var p,m,I,y,A,D,C,h,f;const{id:k,lastMessage:S}=e,U=function(e,t,n){if(e&&!(0,b.isEmpty)(e))return ut(De(e,t,void 0,void 0,void 0,n))}(S,i,!!(null===(m=null===(p=null==n?void 0:n.get(a.J.Messaging).expandedReactionsConfigs)||void 0===p?void 0:p.chat)||void 0===m?void 0:m.enableSend)),E=(null==o?void 0:o.id)||"",j=Vt(k),L=!!(0,M.YP)(e),O=(0,z.NF)(e),F=(0,z.gS)(e);let x=null;if(U){let a=null!==(I=null==S?void 0:S.preview)&&void 0!==I?I:"";if("string"!=typeof a&&!a){const o=(0,b.keyBy)(t,"id");n&&s&&(a=(0,T.t)({conversation:e,profilesMap:o,coreSettings:n,i18n:s,loggerFactory:i,currentUserMri:E,currentUserTenantId:null!=r?r:"",addSenderName:!0}))}const o=function(e,t){var n;return!!(null===(n=null==e?void 0:e.mentions)||void 0===n?void 0:n.some((e=>e.userId===t)))}(U,E);x=Object.assign(Object.assign({},U),{preview:a,clientMessageId:j?Date.now().toString():null==U?void 0:U.clientMessageId,originalArrivalTime:j?e.clientArrivalTime:null==U?void 0:U.originalArrivalTime,isSystemMessage:V(U),hasMention:o,canShowEveryoneMentionBadge:Q(U||void 0,E)&&!o})}const w=Ze(t,E,r,l,e.threadProperties,null===(y=e.usersProps)||void 0===y?void 0:y.hasFederatedUser,null===(A=e.usersProps)||void 0===A?void 0:A.hasConsumerUser,n,e),R=function(e,t,n){const{id:i,properties:a,threadProperties:r}=e,o=Fe(e);return{chatSubType:vt(r.threadType),chatType:yt(r.threadType),consumptionHorizon:Oe(e),consumptionHorizonBookmark:o,quickReplyAugmentation:Re(i,a,t),creator:r[c.Q5.Creator],importState:ct(r[c.Q5.ImportState]),isDisabled:kt(r.isDisabled),disabledReason:dt(r.disabledReason),isLastMessageFromMe:r.isLastMessageFromMe,meetingInformation:vt(r.threadType)===g.k2.Channel?void 0:Et(i,r[c.Q5.Meeting]),sensitivityLabel:r[c.Q5.SensitivityLabelId]?{id:r[c.Q5.SensitivityLabelId],isCopyBlocked:r[c.Q5.SensitivityLabelIsCopyBlocked]}:void 0,tenantId:r[c.Q5.TenantId],title:r.topic,userConsumptionHorizon:o,interopConversationStatus:Dt(a[c.Ff.InteropConversationStatus]),gapDetectionEnabled:Ye(r.gapDetectionEnabled),cfet:et(r.cfet),consumerGroupId:r[c.Q5.ConsumerGroupId],guardianChatInfo:r[c.Q5.GuardianChatInfo],groupTemplate:Zt(r[c.Q5.GroupTemplate]),themeId:r[c.Q5.ThemeId],picture:r[c.Q5.Picture],addedBy:(null==a?void 0:a.addedBy)||null,addedByTenantId:(null==a?void 0:a.addedByTenantId)||null,meetingChatPolicy:bt(r[c.Q5.MeetingChatPolicy]),chatScheduleSuggestionSuppressUntil:null==a?void 0:a.chatScheduleSuggestionSuppressUntil,isCommentStream:(0,N.Bu)(r,n,e.id),createdAt:r[c.Q5.CreatedAt],lastJoinAt:r[c.Q5.LastJoinAt],commentStreamPolicy:bt(r.liveChatPolicy)}}(e,i,n),P=e.properties.historyHiddenTime,B=(0,M.dO)(e,n).toString(),W=(0,M.ln)(e);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),w),R),Xe(e.memberProperties)),{shortTitle:null===(D=e.chatTitle)||void 0===D?void 0:D.shortTitle,longTitle:null===(C=e.chatTitle)||void 0===C?void 0:C.longTitle,id:k,isRead:$t(e,(null==o?void 0:o.id)||""),isHidden:(0,v.n)(P,null==U?void 0:U.originalArrivalTime,B),isMuted:null!==(h=(0,M.tl)(e))&&void 0!==h?h:!!(0,d.e9)(k)&&u,isOneOnOne:L,isOneOnOneBotChat:L&&w.hasBotMember,isBotBlocked:He(null===(f=e.threadProperties)||void 0===f?void 0:f.messagingdisabled),isModerator:F,isFederated:(0,d.eX)(k),isMeeting:(0,d.e9)(k),isSfB:(0,N.Jn)(k),lastMessage:x,awarenessLiveState:Ge(e.threadProperties),members:[],clearHistoryTime:B,chatHistoryHiddenTime:P,type:null}),jt(e.threadProperties.pinnedItems)),{quarantineCounter:W,replyPermission:O||null})}const He=e=>"string"==typeof e?"true"===e.toLowerCase():Boolean(e),Xe=e=>{const t=null==e?void 0:e[c.e0.RelationshipState];return{extendedDirectoryRedemptionRequired:null==t?void 0:t.edRedemptionRequired}},_e=(e,t)=>(0,b.map)(t,(t=>e[t.id]||function(e){return(0,S.ne)(Object.assign(Object.assign({},e),{mri:e.id,objectId:"",type:"",userPrincipalName:"",isMuted:e.isReader,displayName:e.friendlyName}))}(t))),Ke=(e,t,n,i,a,r,o,l,s)=>{try{return Je(e,_e(t,e.members),n,i,a,r,o,l,s)}catch(t){return i.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toConversationSchemaFromSkypeConversationLocal transformation: ${t}`),Object.assign(Object.assign({},e),{id:e.id,isUserMember:!1,members:[],membersLimited:[],memberDisplayNamesLimited:[],type:null,lastMessage:null})}},qe=e=>{const t=e.filter((e=>{var t;return!E.eo.isUnknownUser(e)&&(null===(t=e.featureSettings)||void 0===t?void 0:t.coExistenceMode)!==l.hN.TeamsOnly&&!!e.displayName}));return{nonTeamsFederatedUserLimitedNames:t.slice(0,2).map((({displayName:e})=>e||"")),nonTeamsFederatedUsersLength:t.length}},$e=(e,t,n)=>{var i;const a=e.threadProperties.tenantid,r=null!==(i=(0,A.D)(e.threadProperties.meeting).meetingJoinUrl)&&void 0!==i?i:"";try{const n=_e(t,e.members);return((e,t,n,i)=>({id:e,members:t,tenantId:n,meetingJoinUrl:i}))(e.id,n,a,r)}catch(t){return n.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toConversationMembersSchemaFromSkypeConversationLocal transformation: ${t}`),Object.assign(Object.assign({id:e.id,members:[]},a&&{tenantId:a}),r&&{meetingJoinUrl:r})}},et=e=>"string"==typeof e?"true"===(null==e?void 0:e.toLowerCase()):!!e,tt=e=>e.some((({id:e})=>(0,d.MR)(e))),nt=e=>e.some((e=>E.eo.isTFLConsumerUser(e))),it=e=>e.some((e=>E.eo.isTFLSmsVerifiedMri(null==e?void 0:e.id))),at=e=>e.some((e=>(0,d.Nl)(e.id)&&E.eo.isUnknownUser(e))),rt=e=>e.some((e=>E.eo.isEnterpriseUserMri(e.id)&&E.eo.isUnknownUser(e))),ot=e=>e.some((e=>E.eo.isEnterpriseUserMri(e.id))),lt=(e,t)=>{let n=!0;const i=t&&t.some((t=>{if(!t.isFederated&&t.id!==e&&t.featureSettings){const e=t.featureSettings.isPrivateChatEnabled;return null==e?(n=!1,!0):!e}return!1}));return{isPrivateChatPolicyDefinedScenario:n,isChatDisabledForRecipients:i}},st={opted_out:f.Rdl.OptedOut,claimed:f.Rdl.Claimed,deprovisioned:f.Rdl.Deprovisioned},dt=e=>{if(!e)return;const t=(0,A.D)(e);return{newlyCreatedUserId:t.userId,code:st[t.code]}},ct=e=>{if(e)return f.B1J[e]},ut=e=>Object.assign(Object.assign({},e),{preview:"",isSystemMessage:!1,canShowEveryoneMentionBadge:!1,__typename:"LastMessage"}),pt=(e,t,n,a,r)=>{var o,{id:l,members:s,consumptionHorizon:d,userConsumptionHorizon:u,lastMessage:p,creator:m,meetingInformation:g,isDisabled:M,disabledReason:N,importState:T,isMuted:v,isLastMessageFromMe:I,isRead:y,isOneOnOne:A,isOneOnOneBotChat:D,isSticky:C,isExternal:h,consumerGroupId:k,templateType:U,chatType:E,historyHiddenTime:j,createdAt:L,interopConversationStatus:O,quickReplyAugmentation:F,meetingPolicy:x,addedBy:w,addedByTenantId:z,sensitivityLabel:V}=e,Q=(0,i.__rest)(e,["id","members","consumptionHorizon","userConsumptionHorizon","lastMessage","creator","meetingInformation","isDisabled","disabledReason","importState","isMuted","isLastMessageFromMe","isRead","isOneOnOne","isOneOnOneBotChat","isSticky","isExternal","consumerGroupId","templateType","chatType","historyHiddenTime","createdAt","interopConversationStatus","quickReplyAugmentation","meetingPolicy","addedBy","addedByTenantId","sensitivityLabel"]);try{const e=(0,b.map)(s,(e=>(0,S.ne)(e))),i=p&&ut(Ee(p,l,t)),j=g&&{id:l,subject:g.subject,startTime:g.startTime,scenario:g.scenario,endTime:g.endTime,iCalUid:g.iCalUid,location:g.location,exchangeId:g.exchangeId,meetingType:g.meetingType?Pe(g.meetingType):f.wJZ.Unknown,resolvedSensitivityLabelId:g.resolvedSensitivityLabelId,isCopyRestrictionEnforced:g.isCopyRestrictionEnforced,templateDetails:g.templateDetails,meetingJoinUrl:g.meetingJoinUrl},L=!(!A&&!C&&U!==c.Q5.ImmutableRoster),R=V&&V.id?{id:V.id,isCopyBlocked:(null===(o=V.protectTeamsLabelAction)||void 0===o?void 0:o.isCopyRestrictionEnforced)||!1}:void 0;return Object.assign(Object.assign(Object.assign({__typename:"Conversation"},Ze(e,(null==a?void 0:a.id)||"",n,r)),Q),{id:l,consumptionHorizon:d&&Object.assign({__typename:"ConsumptionHorizon"},Le(l,c.i1.Chat,d)),consumptionHorizonBookmark:u&&Object.assign({__typename:"ConsumptionHorizonBookmark"},Le(l,c.i1.Chat,u)),userConsumptionHorizon:u&&Object.assign({__typename:"ConsumptionHorizonBookmark"},Le(l,c.i1.Chat,u)),lastMessage:i,members:[],creator:m,meetingInformation:j,isDisabled:!!M,disabledReason:dt(N),importState:ct(T),isMuted:v,isLastMessageFromMe:!!I,isRead:y,isOneOnOne:L,cfet:h,consumerGroupId:k,isOneOnOneBotChat:!!D,chatType:yt(E),interopConversationStatus:Dt(O),quickReplyAugmentation:F&&Ve(l,F,t),addedBy:w,addedByTenantId:z,meetingChatPolicy:bt(x),sensitivityLabel:R})}catch(e){t.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${e}`);return Object.assign(Object.assign({},Q),{id:l,isUserMember:!1,consumptionHorizon:null,consumptionHorizonBookmark:null,userConsumptionHorizon:null,lastMessage:null,memberIds:[],members:[],membersLimited:[],chatHistoryHiddenTime:j,memberDisplayNamesLimited:[],creator:null,meetingInformation:null,chatType:null})}},mt=({id:e,members:t,tenantId:n,meetingInformation:i},a)=>{var r;try{const a=(0,b.map)(t,(e=>(0,S.ne)(e))),o=null!==(r=null==i?void 0:i.meetingJoinUrl)&&void 0!==r?r:"";return{__typename:"ConversationMembers",id:e,tenantId:n=null!=n?n:"",meetingJoinUrl:o,members:a}}catch(t){a.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${t}`);return{id:e,members:[]}}},gt=(e,t,n,i,a)=>({node:pt(e,t,n,i,a),cursor:e.createdAt||e.id}),Mt=e=>({activities:e.activities,callLogs:e.callLogs,chats:e.chats,total:e.total});function Nt(e){return JSON.stringify((0,b.map)(e,(e=>{const t=e.mentionType,n=e.displayName;return{"@type":Y,itemid:e.itemId,mri:e.userId,mentionType:t,displayName:n}})))}function Tt(e){return!e||e.length<1?null:JSON.stringify(e.map((e=>{const t=e.mentionType,n=e.displayName;return{itemid:e.itemId,mri:e.userId,mentionType:t,displayName:n}})))}const vt=e=>{if(e)return"space"===e||"topic"===e?g.k2.Channel:"meeting"===e?g.k2.Meeting:g.k2.None},It=new Map([["chat",f.z_3.Chat],["phonechat",f.z_3.PhoneChat],["phonelink1on1chat",f.z_3.Phonelink1on1Chat],["phonelinkgroupchat",f.z_3.PhonelinkGroupChat],["meeting",f.z_3.Meeting],["sfbinteropchat",f.z_3.SfBInteropChat]]),yt=e=>{let t=null;return null==e||(t=It.get(e),void 0===t&&(t=null)),t},At=new Map([["AcceptPending",f.uI5.AcceptPending],["ExtendedDirectoryAcceptPending",f.uI5.ExtendedDirectoryAcceptPending],["Accepted",f.uI5.Accepted],["Blocked",f.uI5.Blocked],["Quarantined",f.uI5.Quarantined]]),Dt=e=>e&&At.get(e)||null,Ct=new Map([["ChatEnabled",f.UOl.ChatEnabled],["ChatDisabled",f.UOl.ChatDisabled],["InMeeting",f.UOl.InMeeting],["ChatEnabledAnonymousDisabled",f.UOl.ChatEnabledAnonymousDisabled],["InMeetingAnonymousDisabled",f.UOl.InMeetingAnonymousDisabled]]),bt=e=>e&&Ct.get(e)||null,ht=e=>!!e&&e===f.z_3.PhoneChat,ft=e=>{if(!e)return!1;switch(typeof e){case"string":e="true"===e.toLowerCase();case"boolean":return e;default:return!1}},kt=e=>(0,b.isString)(e)?"true"===e.toLowerCase():e||!1,St=({id:e,conversationid:t,imdisplayname:n,from:i,composetime:a},r)=>e&&{"@type":Z,mri:H(i),imdisplayname:n,messageId:e,parentMessageId:null!=r?r:e,threadId:t,isUnresolvedEmailUser:!1,originalComposeTime:a},Ut=(e,t,n)=>{const i=n.find((n=>{try{const i=JSON.parse((n.properties||{}).starred),a=i&&i["@type"]===Z&&i.threadId===t?i.messageId:void 0;return e===a}catch(e){return!1}}));return i&&i.id},Et=(e,t)=>{if(!t)return;const n=JSON.parse(t);return Object.keys(t).length?Object.assign(Object.assign({id:e},n),{meetingJoinUrl:n.meetingJoinUrl||n.meetingJoinURL,meetingType:n.meetingType?Pe(g.wJ[n.meetingType]):f.wJZ.Unknown}):void 0},jt=e=>{if(e)try{const t=JSON.parse(e);return{pinnedConversationItems:t.reduce(((e,t)=>(t.itemType===f.Voh.Message&&e.push({__typename:"Message",id:t.itemId}),e)),[])}}catch(e){return}},Lt=e=>e.filter((({id:e})=>E.eo.isTFLOffNetworkUser(e))),Ot=(e,t,n)=>{const i=te(n.properties);return!!i&&i.some((n=>n.key===e&&!!n.users&&n.users.some((e=>e.id===t))))},Ft=e=>{let t;switch(e){case m.iv.Error:t=f.rJC.Error;break;case m.iv.Sending:t=f.rJC.Sending;break;default:t=f.rJC.Delivered}return t},xt=({resourceType:e,resource:t},n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if("ThreadUpdate"===e)try{const{id:e="",members:i}=t,a=i?yield n(i,e):[];return{__typename:"ConversationMembers",id:e,members:a}}catch(e){a.newLogger("toChatMembersEvent","data-resolvers-common").error(`Failed getting thread members: ${e}`)}})),wt=e=>(0,N.Jn)(e)||(0,d.eX)(e)||(0,M.Bl)(e),zt=(e,t)=>(0,b.filter)(e,(0,b.omit)(t,"__typename")),Vt=e=>!!e&&-1!==e.indexOf(q),Qt=e=>!!(null==e?void 0:e.startsWith("tfl:preview-")),Rt=e=>!!e&&(-1!==e.indexOf(c.X2)||-1!==e.indexOf(c.At)),Pt=e=>e===$,Bt=e=>Pt(e)||Vt(e),Wt=e=>{switch(e){case K.FAMILY:case K.FRIENDS:case K.PROJECT:case K.WORKPLACE:case K.TRIP_PLANNING:case K.GET_TOGETHER:case K.LOCAL_COMMUNITY:case K.HOLIDAY_PLANNING:return!0}return!1},Zt=e=>{const t=e&&(0,A.D)(e).id;return Wt(t)?t:void 0},Yt=e=>!!e&&-1!==e.indexOf(":tflfed:preview-"),Gt=e=>!!e&&e.includes("meeting"),Jt=(e,t,n,i,a,o,l,s)=>{if(!e)return;const d=t===f.z_3.Phonelink1on1Chat,c=t===f.z_3.PhonelinkGroupChat,u=n?r.Th.Meeting:i?a?r.Th.Botchat:ht(t)?r.Th.SMSOneOnOneChat:(0,M.Bl)(e)?r.Th.SfcInteropChat:(0,N.Jn)(e)?r.Th.SfbInteropChat:o?r.Th.NativeFederatedChat:l?r.Th.FederatedChat:(0,M.j8)(e)&&d?r.Th.Phonelink1on1Chat:r.Th.OneOnOneChat:(0,M.mB)(e)?r.Th.StreamOfNotes:(0,M.j8)(e)&&c?r.Th.PhonelinkGroupChat:(e=>!!e&&e===g.k2.Channel)(s)?r.Th.Channel:r.Th.GroupChat;return u},Ht=(e,t)=>{if(!t||!t.notification)return null;try{const e=t.notification;return{alertInMeeting:e.alertInMeeting,externalResourceUrl:e.externalResourceUrl}}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in chat message notification transformation: ${t}`),null}},Xt=e=>{if((0,b.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,b.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},_t=(e,t)=>{if(!t||!t.notifications)return null;try{const e="string"==typeof t.notifications?JSON.parse(t.notifications):t.notifications;return e&&e.map((({surface:e,contentType:t,content:n})=>{var i,a,r,o,l,s,d,c,u;return{surface:e,contentType:t,content:{value:{height:null!==(a=Xt(null===(i=n.value)||void 0===i?void 0:i.height))&&void 0!==a?a:void 0,width:null!==(o=Xt(null===(r=n.value)||void 0===r?void 0:r.width))&&void 0!==o?o:void 0,title:null!==(s=null===(l=n.value)||void 0===l?void 0:l.title)&&void 0!==s?s:"",url:null!==(c=null===(d=n.value)||void 0===d?void 0:d.url)&&void 0!==c?c:""},actions:null!==(u=n.actions)&&void 0!==u?u:[]}}}))}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message notifications parsing: ${t}`),null}};function Kt(e){if(e)return"string"==typeof e?e:e.state}const qt=(e,t,n)=>{const i=n.get(a.J.Messaging).commCopilotSummarizationRequestConfig;return i?{gptVersion:i.gptVersion,summaryMode:i.summaryMode,input:{type:i.threadType,id:e,lookbackperiod:t},promptSetting:{temperature:"1.0"}}:null},$t=(e,t)=>(0,p.uy)(e,t),en=e=>e.chatSubType===g.k2.Channel,tn=e=>{var t,n;if(en(e)){const i=null===(t=e.threadProperties)||void 0===t?void 0:t[c.Q5.SpaceTypes],a=i?parseInt(i,10):0;return!!!(null===(n=e.threadProperties)||void 0===n?void 0:n[c.Q5.SubstrateGroupId])&&a!==g.tG.Private}return!1};function nn(e,t,n){if(!e.members)return!1;const i=e.members.find((e=>e.id!==n));return!!i&&(e.source===m.vO.PutConversationLie&&2===e.members.length&&!!t[i.id])}},32552:(e,t,n)=>{"use strict";n.d(t,{w:()=>d,K:()=>c,su:()=>u});var i=n(38613),a=n(607586),r=n(50805),o=n(486070);const l=e=>e&&e.startsWith(a.V.Bot),s=e=>l(e)?e.slice(3):e.slice(e.includes("_")?41:8),d=(e,t)=>{let n=[];return n=l(e)&&!l(t)?[s(t),s(e)]:!l(e)&&l(t)?[s(e),s(t)]:[s(e),s(t)].sort(),`19:${n[0]}_${n[1]}@unq.gbl.spaces`};function c(){const[e,t]=(0,i.MX)(2);return`${e}${t}`.substr(0,19)}function u(e){const{ageGroup:t}=e.get(r.J.AgeConsent);return t===o.zH.MinorWithMsaParentalConsent||t===o.zH.MinorWithoutMsaParentalConsent}},951296:(e,t,n)=>{"use strict";n.d(t,{IF:()=>a,wU:()=>o,vA:()=>l,jY:()=>s,gy:()=>d});var i,a,r=n(516909);!function(e){e[e.Standard=0]="Standard",e[e.Important=2]="Important",e[e.Urgent=3]="Urgent"}(i||(i={})),function(e){e.Standard="",e.Important="high",e.Urgent="urgent"}(a||(a={}));const o=e=>d(e)===r.Ntc.Important,l=e=>d(e)===r.Ntc.Urgent,s=e=>a[e]||a.Standard,d=e=>{switch(e){case a.Important:case i.Important:return r.Ntc.Important;case a.Urgent:case i.Urgent:return r.Ntc.Urgent;case a.Standard:case i.Standard:default:return r.Ntc.Standard}}},926045:(e,t,n)=>{"use strict";n.d(t,{xw:()=>i,HE:()=>a,OB:()=>o});const i="suggested-org-group-chat",a="suggested-project-group-chat",r=[i,a];function o(e){return r.includes(e)}},708375:(e,t,n)=>{"use strict";n.d(t,{c4:()=>l,zf:()=>s,Bd:()=>d,RJ:()=>c,FL:()=>u});var i=n(500396),a=n(876661),r=n(516909),o=n(275742);const l=e=>{switch(e){case i.m1.Moderate:return r.m1e.Moderate;case i.m1.NoRestriction:return r.m1e.NoRestriction;case i.m1.Strict:default:return r.m1e.Strict}},s=(e,t,n,i)=>c(t,e.threadProperties.spaceThreadTopic,e.threadProperties.pictureETag,e.threadProperties.groupId,n,i),d=(e,t,n,i,a)=>c(n,e.threadProperties.topicThreadTopic,null==t?void 0:t.threadProperties.pictureETag,null==t?void 0:t.threadProperties.groupId,i,a),c=(e,t,n,i,a,r)=>{const l=encodeURIComponent(t);return a&&r&&!(0,o.isEmpty)(r)?e+"beta/users/{objectId}/profilepicturev2/teams/{teamGroupId}?etag={etag}&displayName={displayName}&voidCache=true".replace("{objectId}",r).replace("{teamGroupId}",i||"").replace("{etag}",n||"").replace("{displayName}",l):e+"beta/teams/{teamGroupId}/profilepicturev2?etag={etag}&displayName={displayName}&voidCache=true".replace("{teamGroupId}",i||"").replace("{etag}",n||"").replace("{displayName}",l)};function u(e,t,n,i){const r=n?"Parent team":"Channel";return(0,a.uY)(e)?{isDiscarded:!0,reasonToDiscard:`${r} is deleted`}:(0,a.Il)(e)&&!(0,a.Dq)(e)&&t?{isDiscarded:!0,reasonToDiscard:`${r} is archived and not favorite`}:i&&(0,a.Il)(e)?{isDiscarded:!0,reasonToDiscard:`${r} is cross post channel selection and archived`}:n&&!(0,a.hP)(e)?{isDiscarded:!0,reasonToDiscard:"User is not member of the parent team"}:(0,a.pi)(e)&&!(0,a.hP)(e)?{isDiscarded:!0,reasonToDiscard:"User is not member of private channel"}:{isDiscarded:!1,reasonToDiscard:"None"}}},431506:(e,t,n)=>{"use strict";n.d(t,{Hj:()=>i,pK:()=>c,dA:()=>p,oj:()=>m,Cv:()=>N,PQ:()=>T,xJ:()=>v,R4:()=>I,cC:()=>A});var i,a=n(850402),r=n(690344),o=n(915929),l=n(500396),s=n(516909),d=n(309303);!function(e){e.HIGH="HIGH",e.MEDIUM="MEDIUM",e.LOW="LOW"}(i||(i={}));const c=new RegExp("https?://[^\\s]+","i"),u="-",p=e=>{if(0===(e=e.toLowerCase()).lastIndexOf("zh-",0))switch(e){case"zh-cht":case"zh-hant":case"zh-hk":case"zh-tw":return"zh-cht";default:return"zh-chs"}let t=e.indexOf(u,1);if(-1===t)return e;let n=e.indexOf(u,t+1);return-1===n&&(n=e.length),n-t==5&&(t=n),e.substring(0,t)},m=e=>{const t=e?p(e):"",n=(0,r.get)("tcurlang")||t;return{targetLanguage:n,knownLanguages:[n]}},g=(e,t)=>(e=>{switch(e){case l.AO.Success:return s.C14.Done;case l.AO.MessageNotFound:return s.C14.MessageNotFound;case l.AO.VersionNotFound:return s.C14.VersionNotFound;case l.AO.LanguageDetectionFailed:return s.C14.LanguageDetectionFailed;case l.AO.SkipTranslation:case l.AO.ContentIsEmpty:return s.C14.TranslationNotNeeded;default:return s.C14.UnknownError}})(((e,t)=>{const n=l.AO[e];return void 0!==n?n:(null==t||t.error(`Unable to parse translation result code: ${e}`),l.AO.UnknownError)})(e,t)),M=(e,t,n,i,r,o,s,d,c)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){try{return yield e.translateMessages(t,n,i,r,o,s,c)}catch(e){return d.error(`Failed to translate ${s}: ${e}`),o.map((({id:e,version:t})=>({id:e,version:t||"",detectedLanguage:{languageId:"",score:0},resultCode:l.AO[l.AO.UnknownError],translatedContent:"",translatedSubject:"",translatedTitle:""})))}})),N=(e,t,n,i,r,l,s)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const{targetLanguage:a,knownLanguages:d}=n,c=(0,o.v4)(),u=r.map((({messageId:e,version:t})=>t?{id:e,version:t}:{id:e})),p=yield M(e,i,t,a,d,u,c,l,s);return{convId:i,targetLangCode:a,correlationId:c,translations:p.map((e=>{var t;return{messageId:e.id,content:e.translatedContent||"",sourceLangCode:(null===(t=e.detectedLanguage)||void 0===t?void 0:t.languageId)||"",resultCode:g(e.resultCode,l),version:e.version}}))}})),T=(e,t,n)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){try{return(yield e.getSupportedTranslationLanguages(t)).map((({languageTag:e,languageName:t})=>({languageCode:e,languageName:t})))}catch(e){return n.error(`Unable to retrieve languages: ${e}`),[]}})),v=(e,t,n,a,r)=>{var o,l,s,c;if("string"!=typeof t)return null;try{const e=(0,d.d)(t),u=null===(l=null===(o=e.languages)||void 0===o?void 0:o.split(";"))||void 0===l?void 0:l.map((e=>{const[t,n]=e.split(":");return{code:t,score:parseInt(n,10)}})),p=u[0].code;if("null"===p)return null;const m=JSON.parse(null!=r?r:"{}").settingsData,g=null==m?void 0:m.find((t=>t.detector===e.detector));if(!(g&&n&&a&&g.minConfidence))return{code:p,confidenceLevel:i.HIGH};const M=((e,t)=>{var n,i,a,r;const o=e.minCharMap,l=e.minCharMapOverrides,s=new Map([["ar","arabic"],["fa","arabic"],["ku","arabic"],["ru","cyrillic"],["uk","cyrillic"],["bg","cyrillic"],["sr","cyrillic"],["sr-cyrl","cyrillic"],["sr-latn","latin"],["mk","cyrillic"],["uz","cyrillic"],["zh","han"],["zh-chs","han"],["zh-cht","han"],["ja","han"],["ko","han"],["vi","latin"],["en","latin"],["de","latin"],["fr","latin"],["es","latin"],["it","latin"],["pt","latin"],["ca","latin"],["nl","latin"],["pl","latin"],["tr","latin"],["sv","latin"],["cs","latin"],["da","latin"],["hu","latin"],["no","latin"],["nb","latin"],["ro","latin"],["fi","latin"],["ms","latin"],["sk","latin"],["et","latin"],["hr","latin"],["lt","latin"],["sl","latin"],["id","latin"],["lv","latin"],["gl","latin"],["is","latin"],["sq","latin"],["nn","latin"],["cy","latin"],["af","latin"],["mt","latin"],["ga","latin"],["eo","latin"],["so","latin"],["sw","latin"],["bs","latin"],["eu","latin"],["az","latin"],["ht","latin"],["la","latin"],["za","latin"]]);return null!==(r=null!==(a=null!==(n=null==l?void 0:l[t])&&void 0!==n?n:null==o?void 0:o[null!==(i=s.get(t))&&void 0!==i?i:""])&&void 0!==a?a:null==o?void 0:o.others)&&void 0!==r?r:5})(g,p),N=null!==(s=g.minConfidence)&&void 0!==s?s:70,T=null===(c=u.find((e=>e.code===n)))||void 0===c?void 0:c.score;if(n!==p){if(a<M)return{code:p,confidenceLevel:i.LOW};if(T&&T>=N)return{code:n,confidenceLevel:i.LOW}}return{code:p,confidenceLevel:i.HIGH}}catch(n){return e.newLogger("toSourceLanguageCode","data-resolvers-common").error(`Failed to calculate source language code from language stamp: ${t}.`),null}},I=(e,t,n,a)=>{const r=null==t?void 0:t.code;if(!e||!r||(null==t?void 0:t.confidenceLevel)===i.LOW)return!1;const o=e.knownLanguages;if(r===e.targetLanguageCode||o.includes(r))return!1;switch(e.translationMode){case s.Lps.SUGGEST_TRANSLATION:return!0;case s.Lps.ALWAYS_TRANSLATE:if(n&&a===s.C14.ShowOriginalMessage)return!0}return!1},y=(e,t)=>{if(!e)return s.C14.ShowOriginalMessage;if(!t)return s.C14.Done;switch(t){case l.AO.Success:return s.C14.Done;case l.AO.SkipTranslation:return s.C14.TranslationNotNeeded;case l.AO.MessageNotFound:return s.C14.MessageNotFound;case l.AO.VersionNotFound:return s.C14.VersionNotFound;case l.AO.LanguageDetectionFailed:return s.C14.LanguageDetectionFailed;case l.AO.UnsupportedSourceLanguage:return s.C14.UnsupportedSourceLanguage;default:return s.C14.UnknownError}},A=e=>{const{body:t,subject:n,title:i,toggled:a,detectedLanguageName:r,sourceLanguageCode:o,targetLanguageCode:l,isOnDemandTranslation:d,isInProgress:c,error:u}=e||{};if(c)return{translationStatus:s.C14.InProcess};return(void 0!==t||void 0!==u)&&r&&o&&l?{translationStatus:y(!!a,u),translatedSubject:n,translatedContent:t,translatedTitle:i,isOnDemandTranslation:d,sourceLanguageName:r,sourceLanguageCode:o}:void 0}},205480:(e,t,n)=>{"use strict";n.d(t,{ne:()=>s,cx:()=>d,zP:()=>N});var i=n(982346),a=n(451567),r=n(405501),o=n(711676),l=n(275742);const s=(e,t,n,i)=>{const r=a.eo.getRequestCount(e),{accountEnabled:o,mri:l,objectId:s,displayName:d,givenName:g,surname:N,type:v,jobTitle:I,userPrincipalName:y,email:A,tenantId:D,sipProxyAddress:C,mobile:b,telephoneNumber:h,tenantName:f,decoratedDisplayName:k,cid:S,description:U,externalCalendarEmailAddress:E,homeMri:j,homeTenantId:L,profileType:O}=e,F={__typename:"User",accountEnabled:o,id:T(e),objectId:s,mri:l,displayName:d,givenName:g,surname:N,type:v,jobTitle:I,userPrincipalName:y,email:A,tenantId:n||D||null,sipProxyAddress:C,mobile:b,telephoneNumber:h,requestCount:r,preferredUserName:t,tenantName:f||null,decoratedDisplayName:k||null,cid:S,description:U,externalCalendarEmailAddress:E,emailForQuery:i,homeMri:j,homeTenantId:L,profileType:O};return function(e,t){const n=e.department;n&&(t.department=n)}(e,F),m(e,F),p(e,F),c(e,F),u(e,F),M(F),F},d=e=>{const{id:t,displayName:n,description:i,email:a,phone:r,mri:o,requestCount:l,syncSource:s}=e;return{__typename:"User",id:t,mri:o,objectId:o,displayName:n,userPrincipalName:o,givenName:n,surname:n,description:i,email:a,mobile:r,telephoneNumber:r,requestCount:l,syncSource:s}},c=(e,t)=>{var n;if(function(e){var t;const n=e;return void 0!==n.isFederated||void 0!==n.isAnonymousB2bUser||"federated"===(null===(t=n.type)||void 0===t?void 0:t.toLowerCase())}(e)){const{isFederated:i,fetchErrorCode:a,isAnonymousB2bUser:r}=e;t.isFederated=i||"federated"===(null===(n=e.type)||void 0===n?void 0:n.toLowerCase()),t.fetchErrorCode=a,t.isAnonymousB2bUser=r}else t.isFederated=null,t.fetchErrorCode=null,t.isAnonymousB2bUser=null},u=(e,t)=>{e.featureSettings&&(t.featureSettings=e.featureSettings),e.isBlocked&&(t.isBlocked=e.isBlocked),e.cid&&(t.cid=e.cid),e.isIbBarred&&(t.isInfoBarrierSet=e.isIbBarred),e.isAnonymousUser&&(t.isAnonymousUser=e.isAnonymousUser),e.phonesInfo&&(t.phonesInfo=(0,l.cloneDeep)(e.phonesInfo)),e.emailsInfo&&(t.emailsInfo=(0,l.cloneDeep)(e.emailsInfo)),e.xtapUser&&(t.xtapUser=e.xtapUser),e.companyName&&(t.companyName=e.companyName),e.tenantName&&(t.tenantName=e.tenantName),e.imageUri&&(t.imageUri=e.imageUri),e.selfAvatarLastupdatedTime&&(t.selfAvatarLastupdatedTime=e.selfAvatarLastupdatedTime),e.avatarUrl&&(t.avatarUrl=e.avatarUrl),t.isShortProfile=e.isShortProfile},p=(e,t)=>{(function(e){return void 0!==e.userType}(e)||function(e){const t=e;return t.type?t.type===i.t.botType:(0,o.bl)(e.mri)}(e)||function(e){var t,n;return"aduser"===(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())||"aduser"===(null===(n=e.$$subType)||void 0===n?void 0:n.toLowerCase())}(e))&&(t.userType=e.userType,t.description=e.description,t.isUnified=e.isUnified,t.securityEnabled=e.securityEnabled,t.featureSettings=e.featureSettings,t.imageUri=e.imageUri,t.userLocation=e.userLocation)},m=(e,t)=>{const n=e.phones;n&&(t.phones=n.map((e=>g(e))))},g=e=>({number:e.number,type:e.type}),M=e=>{const{mri:t}=e;if((0,r.EG)(t)&&!e.displayName){const n=(0,r.Ol)(t);e.displayName=n,e.givenName=n}else if(t&&(0,o.MR)(t)&&!e.displayName){const n=(0,o.vq)(t);e.displayName=n,e.givenName=n}else e.displayName||(e.displayName="Unknown User");return e},N=e=>!!e&&!("string"!=typeof e||!a.eo.isTFLSmsVerifiedMri(e)),T=e=>e.mri||e.objectId||e.concatenatedId},727523:(e,t,n)=>{"use strict";n.d(t,{uS:()=>a,U3:()=>r});const i="EntityMoreInfo",a={requestPersonMoreInfo:"requestPersonMoreInfo",requestPersonMoreOrgInfo:"requestPersonMoreOrgInfo",requestTopicMoreInfo:"requestTopicMoreInfo"},r={requestPersonMoreInfo:e=>({originator:i,type:a.requestPersonMoreInfo,data:()=>Object.assign({},e)}),requestPersonMoreOrgInfo:e=>({originator:i,type:a.requestPersonMoreOrgInfo,data:()=>Object.assign({},e)}),requestTopicMoreInfo:e=>({originator:i,type:a.requestTopicMoreInfo,data:()=>Object.assign({},e)})}},73578:(e,t,n)=>{"use strict";n.d(t,{bj:()=>s,A3:()=>d,Fh:()=>c,M0:()=>u,jm:()=>m,KD:()=>g,DP:()=>M,xV:()=>N,SI:()=>v,X1:()=>y});var i=n(760005),a=n(876661),r=n(275742),o=n(711676),l=n(919567);function s(e){const[t,n,a]=function(e){const t=3,n=e.split(";");return n&&n.length===t&&n[0]&&!isNaN(Number(n[0]))&&n[1]&&!isNaN(Number(n[1]))&&n[2]&&!(0,r.isNil)(Number(n[2]))?n:i.Mp.split(";")}(e),o=Number(n)||0;return{originalArrivalTime:Number(t)||0,timeStamp:o,clientMessageId:a}}const d=(e,t)=>{const n=(0,a.iX)(Object.assign(Object.assign({},t),{version:0,messages:""})),i=(0,a.J6)(Object.assign(Object.assign({},t),{version:0,messages:""}));return n?e.chat:i?e.channel:void 0};function c(e,t){const n=s(e.properties&&e.properties[i.Ff.ConsumptionHorizon]||i.Mp);if(t){const i=d(t,e)||-1;n.originalArrivalTime=Math.max(n.originalArrivalTime,i)}return n}function u(e,t){let n=s(p(e.properties)||i.Mp);if(t){(d(t,e)||-1)>=n.timeStamp&&(n={originalArrivalTime:0,timeStamp:0,clientMessageId:"0"})}return n}const p=e=>(null==e?void 0:e.userConsumptionHorizon)||(null==e?void 0:e.consumptionHorizonBookmark)||null;function m(e){var t;let n=e.lastMessageTimeUtc;if((0,r.isNil)(n)){const i=null===(t=e.lastMessage)||void 0===t?void 0:t.originalarrivaltime;n=i&&new Date(i).getTime()||0}return n}const g=(e,t)=>{const n=c(e,t),i=u(e,t);return m(e)<=n.originalArrivalTime&&0===i.originalArrivalTime},M=(e,t,n)=>{if("newchat"===e.id||(e=>!!e&&-1!==e.indexOf("preview-"))(e.id))return!0;let i=N(e,t,n);if(!i&&(e=>!!e&&e.includes("meeting"))(e.id)&&e.lastContentMessageTime){const t=new Date(e.lastContentMessageTime).getTime(),a=c(e,n),r=u(e,n);i=t<=a.originalArrivalTime&&0===r.originalArrivalTime}return i},N=(e,t,n)=>{let i="";e.lastMessage&&((0,o.gs)(e.lastMessage)?i=T(e.lastMessage)||"":e.lastMessage.from&&(i=(0,r.last)(e.lastMessage.from.split("/"))||""));const a=u(e,n);return g(e,n)||-1!==i.indexOf(t)&&0===a.originalArrivalTime},T=e=>{let t="";if((0,o.gs)(e)&&e.content){const n=e.content.match(/<initiator>(.*?)<\/initiator>/i);n&&n[1]&&(t=n[1].trim())}return t},v=(e,t)=>{const{clientMessageId:n,originalArrivalTime:i}=u(e,t),a=new Date(i).toISOString();return!!n&&"0"!==n&&I(a)},I=e=>{e=null==e?void 0:e.toString();return 0!==new Date(e&&"0"!==e?e:l.vj).valueOf()},y=(e,t,n)=>{var a,r;const o=v(e,n);let s=!1;if((null===(a=e.lastMessage)||void 0===a?void 0:a.messagetype)===i.Cs.CallRecording){const t=new Date(e.lastContentMessageTime||l.vj),{originalArrivalTime:i}=c(e,n);s=t>new Date(i||l.vj)}else s=!g(e,n);const d=null===(r=e.lastMessage)||void 0===r?void 0:r.from,u=!!(d&&t&&(null==d?void 0:d.indexOf(t))>-1);return o||s&&!u}},592153:(e,t,n)=>{"use strict";n.d(t,{A1:()=>A,bf:()=>N,BU:()=>T,BT:()=>D,xk:()=>v,oV:()=>y,Fx:()=>m,xV:()=>u,uy:()=>I,Hs:()=>p});var i=n(275742),a=n(987745),r=n(89062);const o=()=>l.instance;class l{constructor(){this._enabled=!1,this._currentAppConsumptionHorizon={current:a.Zb,timestamp:void 0}}static get instance(){return l._instance||(l._instance=new l),l._instance}get isEnabled(){return this._enabled}setEnabled(e,{logger:t}){var n;this._enabled=e,null===(n=t.infoToTelemetry)||void 0===n||n.call(t,"Enabling appConsumptionHorizon singleton","cdl_appch_singleton",void 0,!0)}get currentAppConsumptionHorizon(){return this.isEnabled?this._currentAppConsumptionHorizon.current:a.Zb}get latestAppConsumptionHorizonUpdate(){return this._currentAppConsumptionHorizon}updateAppConsumptionHorizon(e,{logger:t}){var n,a;this.isEnabled?(this._currentAppConsumptionHorizon=(0,i.clone)(e),null===(a=t.infoToTelemetry)||void 0===a||a.call(t,`AppConsumptionHorizon updated to '${(0,r.u4)(e)}'.`,"cdl_appch_singleton",void 0,!0)):null===(n=t.warnToTelemetry)||void 0===n||n.call(t,`Tried updating appConsumptionHorizon while singleton was disabled '${(0,r.u4)(e)}'.`,"cdl_appch_singleton",void 0,!0)}}var s=n(73578),d=n(760005),c=n(876661);const u=e=>(0,s.KD)(e,M()?o().currentAppConsumptionHorizon:void 0),p=(e,t)=>(0,s.xV)(e,t,M()?o().currentAppConsumptionHorizon:void 0),m=e=>function(e){if(!e.properties)return!1;const t=e.properties[d.Ff.LastImportantImTime];return function(e){if(!e)return 0;const t=new Date(e);return t?t.getTime():0}(t)>Number(g(e).originalArrivalTime)}(e),g=e=>(0,i.isEmpty)(e.properties&&e.properties[d.Ff.ConsumptionHorizonBookmark])?N(e):T(e);function M(){return l.instance.isEnabled}const N=e=>(0,s.Fh)(e,M()?o().currentAppConsumptionHorizon:void 0),T=e=>(0,s.M0)(e,M()?o().currentAppConsumptionHorizon:void 0),v=(e,t)=>(0,s.X1)(e,t,M()?o().currentAppConsumptionHorizon:void 0),I=(e,t)=>(0,s.DP)(e,t,M()?o().currentAppConsumptionHorizon:void 0),y=e=>(0,s.SI)(e,M()?o().currentAppConsumptionHorizon:void 0),A=e=>{let t="";return e&&(t=[e.originalArrivalTime,e.timeStamp,e.clientMessageId].join(";")),t};function D(e,t){var n;if((0,c.iX)(e)&&(0,s.DP)(e,t,void 0))return{updatedConsumptionHorizon:void 0,updatedConsumptionHorizonBookmark:void 0};if((0,c.J6)(e)&&!(0,s.X1)(e,t,void 0))return{updatedConsumptionHorizon:void 0,updatedConsumptionHorizonBookmark:void 0};const i=(0,s.A3)(o().currentAppConsumptionHorizon,e),a=(0,s.M0)(e,void 0),r=(0,s.jm)(e),l=A({originalArrivalTime:r,timeStamp:Date.now().valueOf(),clientMessageId:(null===(n=e.lastMessage)||void 0===n?void 0:n.clientmessageid)||"0"});let u;return i&&(0,s.SI)(e,void 0)&&i>=a.timeStamp&&(u=d.Mp),{updatedConsumptionHorizon:l,updatedConsumptionHorizonBookmark:u}}},303065:(e,t,n)=>{"use strict";n.d(t,{t:()=>M});var i=n(863553),a=n(760005);const r=/^([^(（]+)[(（]?/;function o(e,t){const n=function(e){var t,n,i;let a="";if(!(null==e?void 0:e.displayName))return a;const o=null!==(t=e.displayName)&&void 0!==t?t:"",l=null!==(n=e.givenName)&&void 0!==n?n:"",s=null!==(i=e.surname)&&void 0!==i?i:"",d=null!==l&&o.startsWith(l),c=null!==s&&o.startsWith(s);if(null!==l&&d&&!c)a=l;else if(c&&!d){const e=r.exec(o);e&&e.length>1&&(a=e[1].trim())}return a=a||o,a||""}(t);return n||(e?e.split(" ")[0]:"")}var l=n(50805),s=n(793377),d=n(711676),c=n(876661),u=n(628063);const p=(e,t,n)=>{const{enableGroupChatInviteFlow:i}=n.get(l.J.Messaging),a=(0,u.rh)(e);return!!i&&!t&&!a},m=(e,t,n,i,a)=>{var r;if(i)return!1;const o=!!(0,d.eX)(e.id);return((e,t,n)=>{const i=(0,c.Bl)(e);return!(!t||!n||i)})(e.id,n,!!(null===(r=e.usersProps)||void 0===r?void 0:r.hasConsumerUser))||((e,t,n,i,a)=>{var r;const o=[];null===(r=e.members)||void 0===r||r.forEach((e=>{const t=i[e.id];t&&o.push(t)}));const l=(0,u.C)(o,a);return(0,d._K)(e.id,t,n,!!l.length||t,o.map((e=>e.id)))})(e,o,n,t,a)||(l=e.id,(0,c.Bl)(l));var l};var g=n(690250);const M=e=>{var t,n,r;const{conversation:d,profilesMap:M,coreSettings:N,i18n:T,loggerFactory:v,currentUserMri:I,currentUserTenantId:y,addSenderName:A=!1}=e,D=!!(0,c.YP)(d),C=(0,i.F)(null!==(n=null===(t=null==d?void 0:d.lastMessage)||void 0===t?void 0:t.from)&&void 0!==n?n:""),b=M[C],h=((e,t,n,i,r,o,d)=>{var c;let u;const{environment:g}=n.get(l.J.Metadata),M=g===s.s.life;switch(null===(c=e.properties)||void 0===c?void 0:c.interopconversationstatus){case a.uI.ExtendedDirectoryAcceptPending:u=i.stringTranslate("people","tfl_invite_free_chat_notification_title",{displayName:(null==d?void 0:d.displayName)||i.stringTranslate("peoplePicker","unknown_user")});break;case a.uI.AcceptPending:u=p(e.id,r,n)||m(e,t,r,M,o)?i.stringTranslate("messaging","tmp_group_chat_invite_flow_chat_list_preview"):i.stringTranslate("people","tfl_invite_free_chat_notification_title",{displayName:(null==d?void 0:d.displayName)||i.stringTranslate("peoplePicker","unknown_user")});break;case a.uI.Blocked:u=i.stringTranslate("people","blocked_sfc_chat_preview_message")}return u})(d,M,N,T,D,y,b);if(h)return h;const f=d.lastMessage;if(!f){return(0,c.xb)(d.id)?T.stringTranslate("messaging","chats_messageDraftPreview_default"):""}if(null===(r=f.properties)||void 0===r?void 0:r.deletetime)return T.stringTranslate("messaging","chats_messagePreview_lastMessage_deleted");const k=(0,u.DE)(v,f.messagetype,f.properties);let S=function(e,t,n,i){var r,o;const s=(null===(r=e.lastMessage)||void 0===r?void 0:r.content)||"";switch(n){case a.Cs.MediaCard:return s||t.stringTranslate("messaging","chats_messagePreview_sent_a_card");case a.Cs.CallLocalRecording:case a.Cs.CallRecording:return"";case a.Cs.AddMember:return t.stringTranslate("messaging","chats_messagePreview_user_added");case a.Cs.CallTranscript:return t.stringTranslate("messaging","chats_messagePreview_call_transcript");case a.Cs.Collaborate:return"";case a.Cs.PhonelinkMms:return t.stringTranslate("messaging","chats_messagePreview_phonelink_mms");case a.Cs.Call:if((null===(o=null==i?void 0:i.get(l.J.Messaging))||void 0===o?void 0:o.enableGroupChatAudioDropin)&&(0,c.Xg)(e)&&function(e){const t=-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e);return!(!/<partlist/.test(e)||t)&&-1!==e.indexOf("<name>")}(s))return t.stringTranslate("messaging","chats_messagePreview_audio_drop_in_call_started")}return/^<img\b[^>]*>$/.test(s)?t.stringTranslate("messaging","chats_messagePreview_sent_an_image"):(d=s,/^<video[^>]*>[^<>]*<\/video>$/.test(d)?t.stringTranslate("messaging","chats_messagePreview_sent_an_inline_video"):s);var d}(d,T,k,N);if(""===S.trim()&&(S=function(e,t,n){const i=(0,u.jz)(n,e.properties),a=(0,u.le)(n,e.properties);return(null==i?void 0:i.length)?t.stringTranslate("messaging","chats_messagePreview_sent_a_file"):(null==a?void 0:a.some((e=>e.contentType===g.s.Audio)))?t.stringTranslate("messaging","recent_conversations_sent_an_voice_message"):(null==a?void 0:a.some((e=>"bfb101ece45946be988be560a74322f2"===e.cardClientId)))?t.stringTranslate("messaging","recent_conversations_sent_a_location_message"):""}(f,T,v)),!S)return"";if(!A)return S;const U=C===I,E=function(e,t,n,i,r){if(e===a.Cs.Call||e===a.Cs.AddMember||e===a.Cs.CallRecording||e===a.Cs.CallLocalRecording||e===a.Cs.CallTranscript||r&&!i)return{key:"chats_messagePreview_withoutDisplayName"};if(i)return{key:"chats_messagePreview_fromSelf"};const l=o(t,n);return l?{key:"chats_messagePreview_withDisplayName",displayName:l}:{key:"chats_messagePreview_withoutDisplayName"}}(k,f.imdisplayname,b,U,!!D);return S=T.stringTranslate("messaging",E.key,{message:S,displayName:E.displayName}),S}},614658:(e,t,n)=>{"use strict";n.d(t,{n:()=>i});const i=(e,t,n)=>{const i=e?parseInt(e,10):null,a=t?new Date(t).getTime():0,r=n?parseInt(n,10):null;return!!(r&&r>=a)||!!i&&!(a&&i<a)}},628063:(e,t,n)=>{"use strict";n.d(t,{le:()=>d,DE:()=>c,jz:()=>g,rh:()=>M,C:()=>N});var i=n(516909),a=n(558632),r=n(905581),o=n(132756),l=n(275742),s=n(760005);const d=(e,t,n)=>{if(!t||!t.cards||"string"!=typeof t.cards&&!n)return null;try{let e=String(t.cards);n&&(e=n);return JSON.parse(e).map((({appIcon:e,appId:t,appName:n,cardClientId:i,content:a,contentType:r,locale:o,userSpecificContent:l})=>Object.assign({appIcon:e,appId:t||"",appName:n,cardClientId:i,content:JSON.stringify(a),contentType:r,locale:o},!!l&&{userSpecificContent:l})))}catch(t){return e.newLogger("Conversation Last Message Processing","services-io-chat").log("UnhandledException in toCards."),null}},c=(e,t,n)=>{if(t===s.Cs.HTML){if(((e,t)=>{const n=d(e,t);if(!n)return!1;const i=(0,l.find)(n,(e=>"application/vnd.microsoft.card.fluid"===e.contentType));return!!i&&!!JSON.parse(i.content).componentUrl})(e,n))return s.Cs.Collaborate;if(((e,t)=>{const n=d(e,t);if(!n)return!1;const i=(0,l.find)(n,(e=>"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType));return!!i&&!!JSON.parse(i.content).componentUrl})(e,n))return s.Cs.Embed}return t};var u;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(u||(u={}));const p=(e,t)=>{try{const t=JSON.parse(e);if(!t||!t.code)return;const n=(e=>{switch(e){case i.mFJ.BOX:return i.mFJ.BOX;case i.mFJ.DROPBOX:return i.mFJ.DROPBOX;case i.mFJ.EGNYTE:return i.mFJ.EGNYTE;case i.mFJ.GOOGLEDRIVE:return i.mFJ.GOOGLEDRIVE;case i.mFJ.SHAREFILE:return i.mFJ.SHAREFILE;default:throw new Error("Invalid provider code")}})(t.code);return{code:n,type:(e=>{switch(e){case u.Sharepoint:return i.RWp.Sharepoint;case u.WOPI:return i.RWp.WOPI;case u.Google:return i.RWp.Google;case u.OneDrive:return i.RWp.OneDrive;case u.Recent:return i.RWp.Recent;case u.Aggregate:return i.RWp.Aggregate;case u.FileSystem:return i.RWp.FileSystem;case u.Search:return i.RWp.Search;case u.AllFiles:return i.RWp.AllFiles;case u.SharedWithMe:return i.RWp.SharedWithMe;default:throw new Error("Not a valid provider type")}})(parseInt(t.type,10))}}catch(e){return void t.newLogger("Conversation Last Message Processing","services-io-chat").log(`Failed to parse provider data: ${e}`)}},m=(e,t)=>{{const n=2,l=["http","https"],{filePreview:s,chicletBreadcrumbs:d,fileInfo:c,anchorFileId:u,progressComplete:m,isUploadError:g,fileChicletState:M,providerData:N}=e,{shareUrl:T,shareId:v,itemId:I}=c,y=s||{},A=null==M?void 0:M.serviceName,{id:D,baseUrl:C,objectUrl:b,type:h,title:f,state:k}=((e,t)=>{var n;const{version:i}=e;let{id:a,baseUrl:l,objectUrl:s,type:d,title:c,state:u}=e;if(i!==t&&(({itemid:a,fileName:c,fileType:d,fileInfo:{fileUrl:s,siteUrl:l}}=e),u=null===(n=e.fileChicletState)||void 0===n?void 0:n.state),"string"!=typeof a)throw(0,r.Tr)("ChatHelpers",o.jK.Undefined,"toFiles",{id:a,version:i,type:d},"File id is missing");return{id:a,baseUrl:l,objectUrl:s,type:d,title:c,state:u}})(e,n),S="active"!==k&&"hidden"!==k,U=p(N,t);return Object.assign({id:D,itemId:I,chicletBreadcrumbs:d,baseUrl:(0,a.Nm)(C,l),objectUrl:(0,a.Nm)(b,l),shareId:v,shareUrl:T,type:h,title:f,fileId:D,isReferencedFile:S,anchorFileId:u,progressComplete:m&&parseInt(m,10)||null,serviceName:A&&i.a4b[A],state:k&&i.cj1[k],hasUploadFailed:g,providerDataV2:U},y)}},g=(e,t)=>{if(!t||!t.files||"string"!=typeof t.files)return null;try{let n=JSON.parse(t.files);n=n.filter((e=>"deeplink"!==e.type));return(0,l.map)(n,(t=>m(t,e)))}catch(e){return null}},M=e=>!!e&&e.includes(s.IX),N=(e,t)=>e.filter((({tenantId:e,isFederated:n})=>n||t&&e&&e!==t))},708975:(e,t,n)=>{"use strict";n.d(t,{lF:()=>P,wT:()=>p,io:()=>S,lj:()=>Q,oy:()=>R,MQ:()=>F,dk:()=>k,Xc:()=>x,Bu:()=>U,gw:()=>z,_T:()=>O,R8:()=>C,c_:()=>M,GS:()=>g,_2:()=>I,Iy:()=>D,re:()=>h,mO:()=>f,x:()=>E,X5:()=>j,vJ:()=>b,Ut:()=>m,LQ:()=>y,Jn:()=>A,nN:()=>V,B8:()=>v,$n:()=>L,DA:()=>w});var i=n(50805),a=n(760005),r=n(681145),o=n(275742),l=n(114881),s=n(711676),d=n(516909),c=n(919567);var u=n(500396);const p=({isActionToAccept:e,isUserBlocked:t,isInQuarantine:n,quarantineCounter:r,creator:o,currentUserMri:l},s)=>{let d=a.uI.Accepted;if(e){if(t){const e=o===l,{maxInviteFreeQuarantineCounter:t}=s.get(i.J.People),c=r>=(t||0);n&&!e?d=a.uI.AcceptPending:e&&c&&(d=a.uI.Quarantined)}}else d=a.uI.Blocked;return d},m=e=>!!(null==e?void 0:e.startsWith(a.at.PhonelinkSmsPrefix)),g=(e,t)=>M(e.id,t)&&I(e,t),M=(e,t)=>{if(!T(e))return!1;const{overrideThreadTypeForPrivateFeeds:n}=t.get(i.J.Sync);return(!(0,s.dV)(e)||!n)&&!m(e)},N=/^\d+[:]{1}.+/,T=e=>!(0,o.isUndefined)(e)&&e!==a.kK&&e!==a.Ov&&!m(e)&&!e.includes(a.YP)&&!e.includes(a.BQ)&&N.test(e),v=e=>e.startsWith(a.IK)?"MRI conv id":e,I=(e,t)=>!(y(e)&&!function(e){const{msgEnableSfbCloudFromBVD:t}=e.get(i.J.Messaging),{isSfbCloud:n,isSipEnabled:a,isSfbCloudInBVD:r,isSipEnabledInBVD:o}=e.get(i.J.UserResources);return!!(t?o&&r:a&&n)}(t));function y(e){return((0,o.isString)(e)?e:e.id).endsWith(a.GQ)}const A=e=>!!e&&y(e),D=e=>{var t;const n=null===(t=e.memberProperties)||void 0===t?void 0:t[a.e0.RelationshipState];return!!(null==n?void 0:n.edRedemptionRequired)},C=e=>{var t;const n=null===(t=e.memberProperties)||void 0===t?void 0:t[a.e0.RelationshipState];return!!(null==n?void 0:n.blockTime)};const b=e=>{var t;return!!(null===(t=e.memberProperties)||void 0===t?void 0:t[a.e0.IsModerator])},h=e=>e.threadProperties&&!!e.threadProperties[a.Q5.ParentSpaces],f=e=>e.threadProperties&&e.threadProperties[a.Q5.ThreadType]===r.T.Team&&h(e),k=e=>{var t,n;if(e.threadProperties&&(null===(t=e.threadProperties)||void 0===t?void 0:t[a.Q5.ParentSpaces]))try{const t=JSON.parse(null===(n=e.threadProperties)||void 0===n?void 0:n[a.Q5.ParentSpaces]);return t&&t.linkedSpaceInfoItems&&t.linkedSpaceInfoItems[0]&&t.linkedSpaceInfoItems[0].spaceThreadId&&t.linkedSpaceInfoItems[0].spaceThreadId.length>0}catch(e){return!1}return!1},S=e=>{if(e.threadProperties)try{const t=e.threadProperties.meeting,n=t?JSON.parse(t):void 0;return n?n.meetingType:void 0}catch(e){return}},U=(e,t,n)=>{if(t){const{enableStreamChatFeature:e,forceCommentStreamForConversations:a}=t.get(i.J.Calling);if(!e)return!1;if(n&&(null!=a?a:[]).includes(n))return!0}if(e&&void 0!==e.isLiveChatEnabled)return function(e){switch(typeof e){case"boolean":return e;case"number":return 1===e;case"string":const t=e.toLowerCase();return"true"===t||"on"===t||"1"===t}return!1}(e.isLiveChatEnabled)},E=e=>j(e.type),j=e=>!!e&&e.toLowerCase&&e.toLowerCase()===a.i1.Meeting.toLowerCase(),L=e=>{let t;if(E(e)&&e.threadProperties.meeting)try{const n=JSON.parse(e.threadProperties.meeting);n.subject&&(t=n.subject)}catch(e){return t}return t},O=e=>e===a.Cs.Text||e===a.Cs.RichText||e===a.Cs.HTML,F=e=>{var t;return!!(null===(t=e.members)||void 0===t?void 0:t.some((e=>(0,s.Nl)(e.id))))},x=e=>{var t;return e.id===l.VS.CallLogConversationId||(0,s.u5)(null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)},w=e=>{if(e===a.Me)return!1;const t=1209600*c.kg*.5;if(!e||isNaN(e))return!0;return e-Date.now()<t},z=e=>(null==e?void 0:e.threadProperties)&&((null==e?void 0:e.threadProperties[a.Q5.ThreadType])===r.T.Community||(null==e?void 0:e.threadProperties[a.Q5.SpaceType])===a.Q5.SpaceType_Community),V=e=>(null==e?void 0:e.threadProperties)&&(null==e?void 0:e.threadProperties[a.Q5.ThreadType])===r.T.SubCommunity,Q=e=>e.threadProperties&&e.threadProperties[a.Q5.SubstrateGroupId]||"",R=e=>{var t,n;const i=null===(n=null===(t=e.threadProperties)||void 0===t?void 0:t[a.Q5.ThreadSubType])||void 0===n?void 0:n.toLowerCase();return i||u.YF.Unknown},P=e=>{const t=e.threadProperties&&e.threadProperties[a.Q5.ThreadType];return B(t)},B=e=>{if(e)return"space"===e||"topic"===e?d.k2e.Channel:"meeting"===e?d.k2e.Meeting:d.k2e.None}},876661:(e,t,n)=>{"use strict";n.d(t,{MJ:()=>u,K6:()=>p,Du:()=>m,ut:()=>g,uY:()=>M,pl:()=>N,ky:()=>T,Fz:()=>v,zb:()=>I,s6:()=>y,rt:()=>A,xb:()=>D,eb:()=>C,s0:()=>h,Gp:()=>f,Xm:()=>k,HU:()=>S,X3:()=>U,Dq:()=>j,SQ:()=>L,iX:()=>O,S5:()=>F,nV:()=>x,$V:()=>w,JJ:()=>z,J6:()=>V,sL:()=>Q,pi:()=>R,Cd:()=>P,hk:()=>B,rj:()=>W,Fv:()=>Z,hu:()=>Y,dO:()=>G,BL:()=>J,jo:()=>H,nZ:()=>X,iE:()=>_,hP:()=>K,qo:()=>q,CB:()=>$,au:()=>ee,ZY:()=>te,T7:()=>ne,Xg:()=>ie,YP:()=>ae,Zg:()=>re,j8:()=>le,cW:()=>se,tq:()=>de,W7:()=>ce,is:()=>ue,dG:()=>Me,Lg:()=>Ne,Su:()=>Te,rP:()=>ve,As:()=>Ie,nL:()=>ye,Bl:()=>Ae,mB:()=>De,wB:()=>Ce,Eu:()=>be,hC:()=>he,DZ:()=>fe,qN:()=>ke,Ud:()=>Se,me:()=>Ue,BU:()=>Ee,Ii:()=>je,$c:()=>Le,tl:()=>Oe,Ts:()=>Fe,wU:()=>xe,jM:()=>Ve,Il:()=>Qe,rf:()=>Re,cu:()=>Pe,ln:()=>Be,iK:()=>We,y5:()=>Ze,Ti:()=>Ye,ok:()=>Ge,zx:()=>Je,xm:()=>He});var i=n(114881),a=n(275742),r=n(50805),o=n(711676),l=n(760005),s=n(681145),d=n(500396),c=n(708975);var u;!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO"}(u||(u={}));const p=e=>{const t=C(e);return(0,c.LQ)(e)?t:t||(0,c.Jn)(e)},m=e=>{var t;return(null===(t=e.threadProperties)||void 0===t?void 0:t[l.Q5.Creator])||null},g=e=>e.threadProperties&&e.threadProperties[l.Q5.CreatedAt]?e.threadProperties[l.Q5.CreatedAt]:null,M=e=>{if(!e)throw new Error("Invalid conversation passed to isDeleted()");if(!e.threadProperties)return!1;const t=e.threadProperties.isDeleted||e.threadProperties[l.Q5.IsDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},N=e=>{if(!e)throw new Error("Invalid conversation passed to isConversationDeleted()");if(!e.properties)return!1;const t=e.properties.isDeleted||e.properties[l.Ff.isDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},T=(e,t)=>{if(!e)throw new Error("Invalid conversation passed to shouldConversationDeletedByDeleteChat()");const n=G(e,t);return 0!==n&&(!(0,a.isNil)(e.lastMessageTimeUtc)&&n>=e.lastMessageTimeUtc)},v=e=>{var t;return!(!e.properties||!e.properties[l.Ff.Followed])&&"true"===(null===(t=e.properties[l.Ff.Followed])||void 0===t?void 0:t.toLowerCase())},I=e=>{var t;return!(!e.properties||!e.properties[l.Ff.Collapsed])&&"true"===(null===(t=e.properties[l.Ff.Collapsed])||void 0===t?void 0:t.toLowerCase())},y=e=>-1===e.detailsVersion?-1===e.threadVersion:0===e.threadVersion,A=e=>y(e)||!K(e);function D(e){return e.includes(l.YP)||e.includes(l.BQ)||e===l.kK}const C=e=>{var t;return(0,o.Q5)(e.id,null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)&&D(e.id)},b="lwgChannelLie-",h=e=>`${b}${e}`,f=e=>e.startsWith(b),k=e=>V(e)&&e.properties&&!!e.properties.isLie,S=e=>e.threadProperties&&(e.threadProperties[l.Q5.ThreadType]===s.T.Team||e.threadProperties[l.Q5.ThreadType]===s.T.Community)&&!(0,c.re)(e),U=e=>R(e)?Ue(e)||"":ne(e)||"";function E(e){return!!e.threadProperties&&e.threadProperties[l.Q5.ThreadType]===s.T.Team}const j=e=>{var t;if(e.properties){if(e.properties[l.Ff.Favorite])return"true"===(null===(t=e.properties[l.Ff.Favorite])||void 0===t?void 0:t.toLowerCase());if(E(e))return!0}return!1},L=e=>{var t;return!e.properties||!e.properties[l.Ff.GeneralChannelFavorite]||"true"===(null===(t=e.properties[l.Ff.GeneralChannelFavorite])||void 0===t?void 0:t.toLowerCase())},O=(e,t=!1)=>F(e.type,t),F=(e,t=!1)=>!(0,a.isNil)(e)&&(e.toLowerCase()===l.i1.Chat.toLowerCase()||e.toLowerCase()===l.i1.PhoneChat.toLowerCase()||e.toLowerCase()===l.i1.Phonelink1on1Chat.toLowerCase()||e.toLowerCase()===l.i1.PhonelinkGroupChat.toLowerCase()||e.toLowerCase()===l.i1.OneOnOne.toLowerCase()||e.toLowerCase()===l.i1.StreamOfNotes.toLowerCase()||!t&&(0,c.X5)(e)),x=e=>e.type===l.i1.RCC,w=e=>{var t;return e.id===i.VS.NotificationConversationId||(0,o.j6)(null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)},z=e=>e===i.VS.AnnotationsConversationId,V=e=>e.type===l.i1.Team||e.type===l.i1.Topic,Q=e=>q(e)===d.xu.Shared,R=e=>(0,c.mO)(e)&&(0,c.dk)(e)&&q(e)===d.xu.Private,P=e=>S(e)&&!!e.memberProperties&&!!e.memberProperties[l.e0.ChannelOnlyMember],B=e=>{if(!(0,c.x)(e))return!1;const t=(0,c.io)(e);return!!t&&t===l.wJ.MeetNow},W=e=>{if(!(0,c.x)(e))return!1;const t=(0,c.io)(e);return!!t&&t===l.wJ.Scheduled},Z=(e,t)=>e.from.substring(e.from.indexOf("/")+1)===(-1===t.indexOf(l.rK)?l.rK+t:t),Y=(e,t)=>{if(!e.threadProperties)return 0;const{enableRetentionHorizonBasedPruning:n}=t.get(r.J.Sync),i=n||Q(e)?e.threadProperties.retentionHorizonV2:0;return i&&isFinite(Number(i))?Number(i):0},G=(e,t)=>{if(!e.properties)return 0;if(N(e))return e.lastMessageTimeUtc?e.lastMessageTimeUtc+1:864e13;const n=(!t||!!t.get(r.J.Messaging).enableDeleteChat)&&O(e)?e.properties.clearHistoryTime:0;return n&&isFinite(Number(n))?Number(n):0},J=e=>!!e.mruEvictedTime&&e.mruEvictedTime>0,H=(e,t,n)=>{const i=Y(t,n);return!isNaN(Number(e))&&!isNaN(i)&&Number(e)<i},X=(e,t,n)=>{const i=G(t,n),a=Number(e);return!isNaN(a)&&!isNaN(i)&&a<i},_=(e,t,n=!1)=>{var i;if((0,o.Q5)(e.id,null===(i=null==e?void 0:e.threadProperties)||void 0===i?void 0:i.threadType)&&!y(e)){if(e.memberProperties&&n)return e.memberProperties[l.e0.ExpirationTime];if(e.members&&t){const n=(0,a.find)(e.members,(e=>e&&e.id===t));return n&&n.memberExpirationTime}return e.memberProperties&&e.memberProperties[l.e0.ExpirationTime]}},K=(e,t)=>{var n;return!(0,o.Q5)(e.id,null===(n=null==e?void 0:e.threadProperties)||void 0===n?void 0:n.threadType)||!y(e)&&!M(e)&&((0,a.isArray)(e.members)&&t?(0,a.some)(e.members,(e=>e&&e.id===t)):!(e.threadProperties&&V(e)&&!e.threadProperties[l.Q5.LastLeaveAt]&&!e.threadProperties[l.Q5.LastJoinAt])&&!(e.threadProperties&&e.threadProperties[l.Q5.LastLeaveAt]&&(!e.threadProperties[l.Q5.LastJoinAt]||e.threadProperties[l.Q5.LastJoinAt]<e.threadProperties[l.Q5.LastLeaveAt])))};function q(e){if(!e||!V(e))return;const t=e.threadProperties[l.Q5.SpaceTypes],n=t?parseInt(t,10):0,i=!!e.threadProperties[l.Q5.SubstrateGroupId],a=(0,c.oy)(e);return i?a===d.YF.PrivateChannel?d.xu.Private:d.xu.Shared:(n&d.tG.Private)===d.tG.Private?d.xu.Private:d.xu.Standard}const $=(e,t)=>{var n;if(!!e.threadProperties.isLastMessageFromMe)return!0;const i=null===(n=e.lastMessage)||void 0===n?void 0:n.from;if(!i)return!1;return t===(0,a.last)(i.split("/"))},ee=(e,t)=>(0,a.reduce)(e.members,((e,n)=>{const i=n.id;return i&&i!==t&&e.push(i),e}),[]),te=(e,t,n)=>{let i;const r=!e.members||!!e.members&&(0,a.some)(e.members,(e=>!e));if(n&&!r){const a=ee(e,t);i=C(e)&&1===a.length?n[a[0]]:n[e.id]}return i},ne=e=>{if(!e)throw new Error("Invalid conversation passed to topicName");if(e.threadProperties){if(O(e)){let t=e.threadProperties.topic;if(t&&-1!==t.indexOf(":")&&(t=void 0),!t&&(0,c.x)(e)){const n=(0,c.$n)(e);n&&(t=n)}return t}if(E(e)&&Me(e)){const t=Ue(e);if(t&&t.trim())return t}else{const t=e.threadProperties.topic,n=e.threadProperties[l.Q5.TopicThreadTopic];if(t&&t.trim())return t;if(n&&n.trim())return n}}return""},ie=(e,t=!1)=>O(e,!0)&&!ae(e,t),ae=(e,t=!1)=>{var n;const i=e.members&&e.members.length<=2;return O(e,!0)&&i&&(ue(e)||C(e)||ge(e)||!t&&me(e)||oe(e))&&!(null===(n=e.members)||void 0===n?void 0:n.some((e=>(0,o.$i)(e.id))))},re=e=>{var t;return ae(e)&&(null===(t=e.members)||void 0===t?void 0:t.some((({id:e})=>(0,o.bl)(e))))},oe=e=>e.members&&e.members.length<=2&&pe(e)&&(e.type===l.i1.PhoneChat||e.threadProperties&&e.threadProperties[l.Q5.ThreadType]===s.T.PhoneChat),le=e=>(0,c.Ut)(e),se=e=>le(e.id),de=e=>!!e&&((0,o.EG)(e)||(0,o.MR)(e)||(0,o.Jl)(e)||(0,o.yj)(e)),ce=e=>e.type===l.i1.PhonelinkGroupChat,ue=e=>e.type===l.i1.Phonelink1on1Chat,pe=e=>(0,a.some)(e.members,(e=>!!e.id&&e.id.startsWith(l.at.Pstn))),me=e=>O(e,!0)&&e.members&&2===e.members.length&&!(0,a.isNil)(e.threadProperties)&&parseInt(e.threadProperties[l.Q5.CreatedAt],10)<l.Yv,ge=e=>{var t,n;return!!e.id&&e.id.indexOf(l.B3)>-1||"true"===(null===(n=null===(t=e.threadProperties[l.Q5.P2PChatUniqueRosterThread])||void 0===t?void 0:t.toString())||void 0===n?void 0:n.toLowerCase())||we(e)},Me=e=>e.threadProperties&&e.threadProperties[l.Q5.ThreadType]===s.T.Topic||R(e)||Q(e)||(0,c.nN)(e)||k(e),Ne=e=>(0,c.Jn)(e),Te=e=>Ae(e&&e.id),ve=e=>Ne(e)||(e=>Ie(e))(e)||Te(e),Ie=e=>{const t=(0,a.isString)(e)?e:e.id;return(0,a.endsWith)(t,l.M9)||(0,a.endsWith)(t,l.IS)||(0,a.startsWith)(t,l.X2)},ye=e=>Ie(e)||xe(e),Ae=e=>!!e&&((0,a.endsWith)(e,l.RS)||(0,a.startsWith)(e,l.QV)),De=e=>e===l.Z,Ce=e=>!(e.id!==l.Z||e.lastMessage||e.threadProperties.retentionHorizonV2&&0!==e.threadProperties.retentionHorizonV2),be=e=>{const t=(0,a.endsWith)(e,l.M9)||(0,a.endsWith)(e,l.IS)||(0,a.startsWith)(e,l.X2),n=e.endsWith(l.GQ),i=Ae(e);return t||n||i},he=e=>{const t=_(e),n=t&&t<Date.now();return K(e)&&!n},fe=e=>{if(e.threadProperties&&e.threadProperties[l.Q5.Topics]){const t=e.threadProperties[l.Q5.Topics];if("["!==t.substr(0,1))return t.split("|").map((e=>({id:e,name:"Unknown"})));try{return JSON.parse(t)}catch(e){return[]}}return[]},ke=(e,t)=>{var n;const i=fe(e);for(const e of i)if(e.id===t)return null!==(n=e.isShared)&&void 0!==n&&n;return!1},Se=e=>!!(null==e?void 0:e.some((e=>(0,o.bl)(e)))),Ue=e=>{if(e.threadProperties){if(e.threadProperties[l.Q5.XTeamName])return e.threadProperties[l.Q5.XTeamName];if(e.type===l.i1.Team&&e.threadProperties.topic)return e.threadProperties.topic}},Ee=e=>{const t=fe(e),n=Ue(e);return t.map((t=>{const i={},a=t.name;return i[l.Q5.CreatedAt]=parseInt(t.createdat,10),i[l.Q5.Picture]=t.picture,i[l.Q5.IsDeleted]=t.isdeleted,i[l.Q5.XTeamName]=t.isShared?a:n,i.topic=a,i[l.Q5.TopicThreadTopic]=a,{threadProperties:i,id:t.id,members:[],messages:"",properties:{},version:0,type:l.i1.Topic,threadVersion:0,detailsVersion:-1,oldConsumptionHorizonKeys:[],teamId:e.id,lastMessageTimeUtc:0,isPending:void 0,memberProperties:{},mruEvictedTime:0,rosterVersion:0,rosterSummary:void 0,botMembers:[],lastSeenSkipRosterState:void 0,lastMessage:void 0,localClientId:"",isUserMember:!1,source:e.source}}))},je=e=>{if(e.parentId)return e.parentId;if((0,c.re)(e))try{const t=JSON.parse(e.threadProperties[l.Q5.ParentSpaces]),n=t.linkedSpaceInfoItems[0].spaceThreadId;if(!(0,a.isEmpty)(n))return n}catch(e){return}},Le=e=>{const t=e.threadProperties&&e.threadProperties[l.Q5.SpaceId];return(S(e)?e.id:(0,c.re)(e)?je(e):t)||e.teamId},Oe=e=>{var t;const n=e.properties?null===(t=e.properties[l.Ff.Alerts])||void 0===t?void 0:t.trim().toLowerCase():void 0;return"true"!==n&&("false"===n||void 0)},Fe=e=>e.threadProperties&&((0,a.isBoolean)(e.threadProperties[l.Q5.GapDetectionEnabled])?e.threadProperties[l.Q5.GapDetectionEnabled]:"true"===(0,a.lowerCase)(e.threadProperties[l.Q5.GapDetectionEnabled])),xe=e=>{const t=Ve(e);return t&&!Ie(e)&&ae(e)&&(0,a.some)(e.members,(e=>e.tenantId&&e.tenantId!==t))||ze(e.id)||ze(e.localClientId||"")},we=e=>{var t,n;return!(0,a.isNil)(e.threadProperties)&&(e.threadProperties[l.Q5.TemplateType]===l.Q5.ImmutableRoster||"true"===(null===(n=null===(t=e.threadProperties[l.Q5.IsStickyThread])||void 0===t?void 0:t.toString())||void 0===n?void 0:n.toLowerCase()))},ze=e=>(0,a.startsWith)(e,l.At),Ve=e=>e.threadProperties&&e.threadProperties[l.Q5.TenantId],Qe=e=>{const t=e.threadProperties[l.Q5.ArchivalLevel],n=S(e)&&!!t&&t.toLowerCase()===l.C8.Space.toLowerCase(),i=V(e)&&!!t&&(t.toLowerCase()===l.C8.Topic.toLowerCase()||t.toLowerCase()===l.C8.Space.toLowerCase());return n||i},Re=e=>{if(!e||!e.properties)return!1;const t=e.properties[l.Ff.isPinned];return!!t&&("boolean"==typeof t?t:"string"==typeof t&&"true"===t.toLowerCase())},Pe=e=>{var t;const n=null===(t=e.memberProperties)||void 0===t?void 0:t[l.e0.RelationshipState];return!!(null==n?void 0:n.inQuarantine)},Be=e=>{var t;const n=null===(t=e.memberProperties)||void 0===t?void 0:t[l.e0.RelationshipState];return"number"==typeof(null==n?void 0:n.quarantineCounter)?null==n?void 0:n.quarantineCounter:0},We=e=>{var t;return!!(null===(t=e.memberProperties)||void 0===t?void 0:t[l.e0.ExplicitlyAdded])},Ze=e=>{var t;return(null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.suppressLastMessageUpdate)===l.Zt.Sender},Ye=e=>{var t;return ae(e)&&!(null===(t=e.usersProps)||void 0===t?void 0:t.hasFederatedUser)&&(0,a.every)(e.members,(e=>{var t;return null===(t=e.id)||void 0===t?void 0:t.startsWith(l.rK)}))||!1},Ge=e=>{var t;return!(!S(e)||parseInt(null===(t=e.threadProperties)||void 0===t?void 0:t[l.Q5.SpaceTypes],10)!==d.tG.TenantWide)},Je=(e,t)=>!!(t&&""!==t&&e.threadProperties&&e.threadProperties[l.Q5.TenantId]&&e.threadProperties[l.Q5.TenantId]!==t),He=(e,t)=>!(!S(e)||Je(e,t)||Ge(e)||M(e)||!K(e)||P(e))},663555:(e,t,n)=>{"use strict";var i,a,r;n.d(t,{TS:()=>i,Cb:()=>a,H8:()=>r,zt:()=>o,GM:()=>l,rh:()=>s,Tj:()=>d}),function(e){e.addToCall="addToCall",e.addToChat="addToChat",e.addToMeeting="addToMeeting",e.addToMeetingForSharedChannel="addToMeetingForSharedChannel",e.addToSpeedDialOrContacts="addToSpeedDialOrContacts",e.addContacts="addContacts",e.addToTeam="addToTeam",e.atMention="atMention",e.callForwardGroupSelection="callForwardGroupSelection",e.calendarPeoplePicker="calendarPeoplePicker",e.callRouting="callToRouting",e.delegationSelection="delegationSelection",e.meetingSchedule="meetingSchedule",e.newChat="newChat",e.orgChart="orgChart",e.presenceSettings="presenceSettings",e.priorityContactsSelection="priorityContactsSelection",e.searchResults="searchResults",e.searchPeopleFilter="searchPeopleFilter",e.searchSuggestions="searchSuggestions",e.shareToTeams="shareToTeams",e.shareContact="shareContact",e.taggedContactsSelection="taggedContactSelection",e.transfer="transfer",e.escalateMessage="escalateMessage",e.addToSharedChannel="addToSharedChannel",e.allFalse="allFalse",e.allTrue="allTrue",e.meetingRoomCall="meetingRoomCall",e.voicemailTransferTarget="voicemailTransferTarget",e.exceptionHandlingPerson="exceptionHandlingPerson",e.exceptionHandlingVoiceapp="exceptionHandlingVoiceapp",e.custom="custom",e.externalSuggestedContacts="externalSuggestedContacts"}(i||(i={})),function(e){e.AADTenant="AADTenant",e.Bot="Bot",e.CallQandAA="CallQandAA",e.DisabledUser="DisabledUser",e.DL="DL",e.Federated="Federated",e.FederatedConsumer="FederatedConsumer",e.Guest="Guest",e.ModernGroup="ModernGroup",e.PersonalContact="PersonalContact",e.Pstn="Pstn",e.Room="Room",e.UserDefinedGroup="UserDefinedGroup",e.TeamTags="TeamTags",e.PstnNonE164="PstnNonE164",e.LetterMapNumbers="LetterMapNumbers",e.GroupChats="GroupChats",e.Meetings="Meetings",e.Xtap="Xtap",e.TflOffNetworkEmails="TflOffNetworkEmails",e.TflOffNetworkPhones="TflOffNetworkPhones",e.TflConsumer="TflConsumer",e.TflSmsName="TflSmsName",e.ImplicitContacts="ImplicitContacts",e.ImplicitContactsForSMBSuggestions="ImplicitContactsForSMBSuggestions",e.ExtendedDirectoryUsers="ExtendedDirectoryUsers",e.MTOUsers="MTOUsers",e.Tfl2WaySmsUsers="Tfl2WaySmsUsers",e.B2BMembers="B2BMembers"}(a||(a={})),function(e){e.AAD="AAD",e.IndexedDb="IndexedDB",e.MiddleTier="MT",e.Substrate="3S",e.TopNCache="TopNCache",e.Memory="Memory",e.TFLZeroState="TFLZeroState"}(r||(r={}));const o={IDBFedBot:"IDB-FedBot",IDBPeopleGroup:"IDB-PeopleGroup",TeamTag:"TeamTag",Memory:"Memory",MT:"MT"},l={EntityActionTaken:"EntityActionTaken",EntityClicked:"EntityClicked",MouseHover:"MouseHover"},s={OpenContactCard:"OpenContactCard",Remove:"Remove"},d={Vertical:"vertical"}},597293:(e,t,n)=>{"use strict";n.d(t,{a:()=>p,B:()=>u});var i=n(663555);const a=[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.PersonalContact,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA,i.Cb.Room,i.Cb.TeamTags,i.Cb.GroupChats,i.Cb.Xtap,i.Cb.TflOffNetworkEmails,i.Cb.TflOffNetworkPhones,i.Cb.TflConsumer,i.Cb.ImplicitContacts],r=[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA,i.Cb.Room,i.Cb.TeamTags,i.Cb.GroupChats,i.Cb.Xtap,i.Cb.TflOffNetworkEmails,i.Cb.TflOffNetworkPhones,i.Cb.TflConsumer,i.Cb.ImplicitContacts],o=[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA,i.Cb.Room,i.Cb.TeamTags,i.Cb.GroupChats,i.Cb.Xtap,i.Cb.TflOffNetworkEmails,i.Cb.TflOffNetworkPhones,i.Cb.TflConsumer,i.Cb.ImplicitContacts],l=[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA,i.Cb.Room,i.Cb.GroupChats,i.Cb.Xtap,i.Cb.Meetings,i.Cb.TflSmsName],s=(i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.PersonalContact,i.Cb.UserDefinedGroup,i.Cb.Pstn,{[i.TS.callForwardGroupSelection]:[i.Cb.AADTenant,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.allTrue]:a,[i.TS.meetingRoomCall]:r,[i.TS.searchSuggestions]:l,[i.TS.addToMeetingForSharedChannel]:o,[i.TS.calendarPeoplePicker]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.DisabledUser,i.Cb.PersonalContact,i.Cb.ModernGroup,i.Cb.DL],[i.TS.searchResults]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.addToTeam]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.Pstn],[i.TS.newChat]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.TeamTags,i.Cb.Room,i.Cb.TflSmsName,i.Cb.ExtendedDirectoryUsers],[i.TS.transfer]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.addToCall]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.PersonalContact,i.Cb.CallQandAA,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.ImplicitContacts,i.Cb.TflConsumer,i.Cb.Xtap],[i.TS.addToChat]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.DisabledUser,i.Cb.TeamTags,i.Cb.Room,i.Cb.ExtendedDirectoryUsers],[i.TS.searchPeopleFilter]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.Pstn,i.Cb.TeamTags],[i.TS.callRouting]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.delegationSelection]:[i.Cb.AADTenant,i.Cb.B2BMembers],[i.TS.presenceSettings]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Pstn],[i.TS.addToMeeting]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.DL,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn],[i.TS.meetingSchedule]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.DL,i.Cb.ModernGroup,i.Cb.Pstn],[i.TS.addToSpeedDialOrContacts]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.CallQandAA],[i.TS.addContacts]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.CallQandAA,i.Cb.Pstn],[i.TS.atMention]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Bot,i.Cb.Pstn],[i.TS.orgChart]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Pstn],[i.TS.shareContact]:[i.Cb.AADTenant],[i.TS.priorityContactsSelection]:[i.Cb.AADTenant,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Pstn],[i.TS.taggedContactsSelection]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.DL],[i.TS.shareToTeams]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.DisabledUser,i.Cb.UserDefinedGroup],[i.TS.escalateMessage]:[i.Cb.AADTenant],[i.TS.voicemailTransferTarget]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.B2BMembers,i.Cb.Bot,i.Cb.DisabledUser,i.Cb.ModernGroup,i.Cb.UserDefinedGroup,i.Cb.Pstn,i.Cb.CallQandAA],[i.TS.addToSharedChannel]:[i.Cb.AADTenant,i.Cb.Xtap],[i.TS.externalSuggestedContacts]:[i.Cb.ImplicitContactsForSMBSuggestions],[i.TS.exceptionHandlingPerson]:[i.Cb.AADTenant],[i.TS.exceptionHandlingVoiceapp]:[i.Cb.CallQandAA],[i.TS.allFalse]:[],[i.TS.custom]:[]});var d=n(275742);const c=(e,t)=>(0,d.flatten)(e.filter((([e,n])=>e===t)).map((([e,t])=>t))),u={[i.H8.Substrate]:[i.Cb.AADTenant,i.Cb.Guest,i.Cb.GroupChats,i.Cb.DL,i.Cb.ModernGroup,i.Cb.Room,i.Cb.ExtendedDirectoryUsers,i.Cb.PersonalContact,i.Cb.MTOUsers,i.Cb.CallQandAA],[i.H8.AAD]:[i.Cb.Guest],[i.H8.IndexedDb]:[i.Cb.Federated,i.Cb.FederatedConsumer,i.Cb.Bot,i.Cb.Pstn],[i.H8.MiddleTier]:[],[i.H8.TopNCache]:[],[i.H8.Memory]:[],[i.H8.TFLZeroState]:[]};class p{constructor(e,t){this.includeFeatures=e,this.name=t,this.includeAADTenant=!1,this.includeGuest=!1,this.includeFederated=!1,this.includeFederatedConsumer=!1,this.includeBot=!1,this.includeDisabledUser=!1,this.includeDL=!1,this.includeModernGroup=!1,this.includePersonalContact=!1,this.includeUserDefinedGroup=!1,this.includePstn=!1,this.includeCallQandAA=!1,this.includeRoom=!1,this.includeTeamTags=!1,this.includeGroupChats=!1,this.includeMeetingChats=!1,this.includeXtap=!1,this.includeOffNetworkEmails=!1,this.includeOffNetworkPhones=!1,this.includeTflConsumer=!1,this.includeTflSmsName=!1,this.includeImplicitContacts=!1,this.includeImplicitContactsForSMBSuggestions=!1,this.includeExtendedDirectoryUsers=!1,this.includeMTOUsers=!1,this.includeTfl2WaySmsUsers=!1,this.includeB2BMembers=!1,this.includeAADTenant=(0,d.includes)(e,i.Cb.AADTenant),this.includeGuest=(0,d.includes)(e,i.Cb.Guest),this.includeFederated=(0,d.includes)(e,i.Cb.Federated),this.includeFederatedConsumer=(0,d.includes)(e,i.Cb.FederatedConsumer),this.includeBot=(0,d.includes)(e,i.Cb.Bot),this.includeDisabledUser=(0,d.includes)(e,i.Cb.DisabledUser),this.includeDL=(0,d.includes)(e,i.Cb.DL),this.includeModernGroup=(0,d.includes)(e,i.Cb.ModernGroup),this.includePersonalContact=(0,d.includes)(e,i.Cb.PersonalContact),this.includeUserDefinedGroup=(0,d.includes)(e,i.Cb.UserDefinedGroup),this.includePstn=(0,d.includes)(e,i.Cb.Pstn),this.includeCallQandAA=(0,d.includes)(e,i.Cb.CallQandAA),this.includeRoom=(0,d.includes)(e,i.Cb.Room),this.includeTeamTags=(0,d.includes)(e,i.Cb.TeamTags),this.includeGroupChats=(0,d.includes)(e,i.Cb.GroupChats),this.includeMeetingChats=(0,d.includes)(e,i.Cb.Meetings),this.includeXtap=(0,d.includes)(e,i.Cb.Xtap),this.includeOffNetworkEmails=(0,d.includes)(e,i.Cb.TflOffNetworkEmails),this.includeOffNetworkPhones=(0,d.includes)(e,i.Cb.TflOffNetworkPhones),this.includeTflConsumer=(0,d.includes)(e,i.Cb.TflConsumer),this.includeTflSmsName=(0,d.includes)(e,i.Cb.TflSmsName),this.includeImplicitContacts=(0,d.includes)(e,i.Cb.ImplicitContacts),this.includeImplicitContactsForSMBSuggestions=(0,d.includes)(e,i.Cb.ImplicitContactsForSMBSuggestions),this.includeExtendedDirectoryUsers=(0,d.includes)(e,i.Cb.ExtendedDirectoryUsers),this.includeMTOUsers=(0,d.includes)(e,i.Cb.MTOUsers),this.includeTfl2WaySmsUsers=(0,d.includes)(e,i.Cb.Tfl2WaySmsUsers),this.includeB2BMembers=(0,d.includes)(e,i.Cb.B2BMembers)}}p.fromName=(e,t=[])=>{if(!(e in s))throw new TypeError("Invalid `name` attribute passed. Please make sure it exists in PEOPLE_FILTER_NAME_CONFIG.");const n=c(t,!0),i=c(t,!1),a=d.without.apply(null,[(0,d.concat)(s[e],n),...i]);return new p(a,e)},p.createFrom=(e,t,n)=>new p(t||e.includeFeatures,n||e.name),p.includesAll=(e,t)=>(0,d.every)(t,(t=>(0,d.includes)(e.includeFeatures,t))),p.includesAny=(e,t)=>(0,d.some)(t,(t=>(0,d.includes)(e.includeFeatures,t)))},982346:(e,t,n)=>{"use strict";n.d(t,{MD:()=>i,t:()=>a,vf:()=>r,p_:()=>o,cT:()=>l});const i={saveUnknownUser:"unknown_user_profile_generated",unknownUserFromDB:"unknown_user_from_index_db"},a={botType:"BOT"},r={member:"Member",guest:"Guest",anonymousUser:"AnonymousUser",voiceApp:"ADVoiceApp",DistributionList:"Group",Bot:"Bot",person:"Person",federated:"Federated",skypeConsumer:"SkypeConsumer",tflUser:"TFLUser",tflOffNetwork:"TFLOffNetwork",personalContactUser:"PersonalContactUser",tflConsumer:"TflConsumer",pstn:"pstn",extendedDirectoryUser:"EDUser",PendingOrgContact:"PendingOrgContact",OrgContact:"OrgContact",MTOUser:"MTOUser",B2BMember:"B2BMember",ADUser:"ADUser",ACSUser:"ACSUser"},o={MTOUser:64,B2BMember:32},l={showWarningBannerMinimumThreshold:20,type:{team:"team",channel:"channel",person:"person",webhook:"webhook",bot:"BOT",addABot:"addABot",app:"app"},hintElement:"ts-hint"}},451567:(e,t,n)=>{"use strict";n.d(t,{M:()=>p,T0:()=>m,wo:()=>v,DS:()=>I,Im:()=>y,S4:()=>A,Rb:()=>D,yN:()=>C,$V:()=>h,$l:()=>f,eo:()=>k});var i,a=n(663555),r=n(50805),o=n(793377),l=n(982346),s=n(275742),d=n(597293),c=n(589585),u=n(405501);const p="unknown_email_address@invalid.teams.ms",m="4:",g="8:tfloffnetwork:",M=`${g}email:`,N=`${g}phone:`,T="50:sms:",v="50:smsunverified:",I="unknown user",y="8:teamsvisitor:",A="8:guest:",D=4,C="28:orgid:",b=["live","sip_profile","myspace","c2c","sms"],h="TflContacts";var f;!function(e){e.NotResolved="NotResolved",e.External="External",e.User="User",e.DistributionList="DistributionList"}(f||(f={}));class k{static isUnknownUser(e){return e.email===p||"unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e.email}static getUnknownUserEmail(){return p}static getRequestCount(e){return e&&e.requestCount||e.$$requestCount||0}static getUserDisplaynamePostFix(e,t,n,i,a,l,s,d,c,u){if(!t)return null;const{enableLabelingUsersByTrustLevel:p}=i.get(r.J.People),m=i.get(r.J.Metadata).environment===o.s.life;return m&&this.isAnonymousTflUser(e)?t=k.checkAndAddGuestTag(t,a):!m&&this.isAnonymousTfwUser(e)?t=(null==c?void 0:c.isCcmUser)?k.checkAndAddExternalTag(t,a):p?u!==e?k.checkAndAddUnverifiedTag(t,a):t:k.checkAndAddGuestTag(t,a):!m&&(n||l||c&&k.isFederatedUser(c))?t=k.checkAndAddExternalTag(t,a):p&&((null==c?void 0:c.isAnonymousB2bUser)||k.isAcsUserMri(e))?t=k.checkAndAddUnverifiedTag(t,a):c&&k.isGuestUser(c)?t=k.checkAndAddGuestTag(t,a):s||d?t=k.checkAndAddExternalTag(t,a):!m&&this.isConsumerUserMri(e)&&this.isAnonymousTfwUser(u)&&p&&(t=k.checkAndAddUnverifiedTag(t,a)),t}static checkAndAddGuestTag(e,t){const n=this.getDefaultGuestDisplayName(t),i=this.getGuestUserTag(t);let a=e;return e.includes(i)||e===n||(a+=` ${i}`),a}static checkAndAddExternalTag(e,t){const n=this.getDefaultExternalDisplayname(t),i=this.getExternalTag(t);let a=e;return e.includes(i)||e===n||(a+=` ${i}`),a}static checkAndAddUnverifiedTag(e,t){const n=this.getDefaultUnverifiedDisplayname(t),i=this.getUnverifiedTag(t);let a=e;return e.includes(i)||e===n||(a+=` ${i}`),a}static getDefaultGuestDisplayName(e){return e.stringTranslate("peoplePicker","default_guest_displayname",{defaultValue:"Guest"})}static getGuestUserTag(e){return e.stringTranslate("peoplePicker","guest_user_postfix",{defaultValue:"(Guest)"})}static getDefaultExternalDisplayname(e){return e.stringTranslate("peoplePicker","default_external_displayname",{defaultValue:"External"})}static getDefaultUnverifiedDisplayname(e){return e.stringTranslate("peoplePicker","default_unverified_displayname",{defaultValue:"Unverified"})}static getExternalTag(e){return e.stringTranslate("peoplePicker","external_user_postfix",{defaultValue:"(External)"})}static getUnverifiedTag(e){return e.stringTranslate("peoplePicker","unverified_user_postfix",{defaultValue:"(Unverified)"})}static applyFeatureFlagSettings(e,t){let n=e.includeFeatures;const i=Boolean(t.get(r.J.Messaging).enableConsumerConversations);switch(e.name){case a.TS.addToMeeting:{const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:o}=t.get(r.J.Federated);o||(n=(0,s.difference)(n,[a.Cb.Federated])),e&&(n=(0,s.difference)(n,[a.Cb.Bot])),n=i?(0,s.difference)(n,[a.Cb.Federated]):(0,s.difference)(n,[a.Cb.TflConsumer]);break}case a.TS.allTrue:{const{enableTflTfwFederation:e,enableTfwTflFederation:o}=t.get(r.J.Host);i?e&&(n=(0,s.difference)(n,[a.Cb.Federated])):o&&(n=(0,s.difference)(n,[a.Cb.TflConsumer]));break}case a.TS.meetingSchedule:const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:o}=t.get(r.J.Federated);o||(n=(0,s.difference)(n,[a.Cb.Federated])),e&&(n=(0,s.difference)(n,[a.Cb.Bot]));break;case a.TS.addToChat:const{enableFederatedUsersInAddToChat:l}=t.get(r.J.Federated),{enableTfwFederationOnTfl:d,enableTfwTflFederation:c}=t.get(r.J.Host);i?d||(n=(0,s.difference)(n,[a.Cb.Federated])):(l||(n=(0,s.difference)(n,[a.Cb.Federated])),c||(n=(0,s.difference)(n,[a.Cb.TflConsumer])));const{enableDLsInAddToChat:u}=t.get(r.J.DistributionLists);u||(n=(0,s.difference)(n,[a.Cb.DL]));break;case a.TS.addToTeam:const{enableFederatedUsersInAddToTeam:p}=t.get(r.J.Federated);p||(n=(0,s.difference)(n,[a.Cb.Federated]));break;case a.TS.addToSpeedDialOrContacts:const{enableFederatedUsersInAddToSpeedDialOrContacts:m}=t.get(r.J.Federated);m||(n=(0,s.difference)(n,[a.Cb.Federated]))}return d.a.createFrom(e,n)}static filterSearchResults(e,t,n){let i=t;return(e=k.applyFeatureFlagSettings(e,n)).includeFederated||(i=i.filter((e=>!(k.isFederatedUser(e)||k.isSfcUser(e)||k.isTFLConsumerUser(e))))),e.includeGuest||(i=i.filter((e=>!k.isGuestUser(e)))),e.includeBot||(i=i.filter((e=>!k.isBot(e)))),e.includeDL||(i=i.filter((e=>!k.isDistributionList(e)))),e.includePstn||(i=i.filter((e=>!k.isPSTNUser(e)))),e.includeAADTenant||(i=i.filter((e=>!k.isInTenantUser(e)))),e.includeCallQandAA||(i=i.filter((e=>!k.isCallQorAAUser(e)))),e.includeTflConsumer||(i=i.filter((e=>!k.isTFLConsumerUser(e)))),e.includeTflSmsName||(i=i.filter((e=>!k.isTFLSmsFriendlyNameUser(e)))),e.includeMTOUsers||(i=i.filter((e=>!k.isMTOUser(e)))),e.includeTfl2WaySmsUsers||(i=i.filter((e=>!k.isTFLSmsVerifiedMri((null==e?void 0:e.mri)||"")))),e.includeB2BMembers||(i=i.filter((e=>!k.isB2BMember(e)))),i}static isMixedChatUser(e,t){const n=!e&&k.isFederatedUser({type:t})||e&&k.isTFLConsumerUser({type:t})||e&&k.isSfcUser({type:t});return Boolean(n)}static isSfCUserPrefix(e){return-1!==b.indexOf(e)}static matchEmailAliasInMeProfile(e,t){return!(0,s.isEmpty)(t)&&(0,s.some)(t,(t=>{var n;return e.toLowerCase()===(null===(n=t.address)||void 0===n?void 0:n.toLowerCase())}))}static matchPhoneAliasInMeProfile(e,t){return!(0,s.isEmpty)(t)&&(0,s.some)(t,(t=>e===t.number))}static generatePstnProfile(e,t,n,i,a,o,d){var p;let g;const{enableExternalTagForPSTNUsers:M,enableLabelingUsersByTrustLevel:N}=null!==(p=null==o?void 0:o.get(r.J.People))&&void 0!==p?p:{};if(i&&n){const a=e.slice(m.length),r=(0,u.gx)(a),o=(0,c.un)(r,n,i,!0);g={mri:e,displayName:(0,s.isEmpty)(t)?o.display:t,givenName:o.display,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:l.vf.pstn}}else g={mri:e,displayName:t,givenName:t,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:l.vf.pstn};return a&&M&&(g.decoratedDisplayName=N&&!d?k.checkAndAddUnverifiedTag(g.displayName||t,a):k.checkAndAddExternalTag(g.displayName||t,a)),g}static convertStringToBlobFile(e){const t=e.split(",")[1];if((0,s.isEmpty)(t))return;const n=atob(t),i=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(n.length),r=new Uint8Array(a);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);return new Blob([r],{type:i})}static getPhoneNumbers(e){let t=[];return(null==e?void 0:e.telephoneNumber)&&t.push(e.telephoneNumber),(null==e?void 0:e.phones)&&e.phones.length>0&&(t=t.concat(e.phones.map((e=>e.number)))),t}static getExtendedDirectoryPhoneNumber(e){return k.getPhoneNumbers(e)[0]}static isPartialSCContext(e,t){return!!(e&&!t||!e&&t)}static getFederationType(e,t){let n;const i={type:t};return e?k.isTFLUser(i)?n="tflWithTfl":k.isFederatedUser(i)&&(n="tflWithTfw"):k.isSfcUser(i)?n="tfwWithSfc":k.isTFLConsumerUser(i)?n="tfwWithTfl":k.isFederatedUser(i)&&(n="tfwWithTfwFederated"),n}static getTfwExtendedDirectoryMembership(e,t={}){const{mri:n,userType:i}=e,{excludeOffNetwork:a=!0}=t;return!a&&this.isTFLOffNetworkUser(n)?"offNetwork":this.isPEUPUser(i)?"pending":this.isEUPUser(i)?"accepted":void 0}static getTflExtendedDirectoryMembership(e){return!0===e?"pending":!1===e?"accepted":void 0}static determineM365PersonaType(e){if(!e)return f.NotResolved;const{type:t,userType:n}=e;if(!t)return f.NotResolved;switch(t){case"Federated":case"TflConsumer":case"SkypeConsumer":case l.vf.pstn:return f.External;case"person":case"ADUser":return n&&"Guest"===n?f.NotResolved:f.User;case"Group":return f.DistributionList;default:return f.User}}}i=k,k.isFederatedUser=e=>{var t;return!!e.isFederated||(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())===l.vf.federated.toLowerCase()},k.isGuestUser=e=>e.type===l.vf.guest||e.userType===l.vf.guest,k.isPersonalContactUser=e=>e.type===l.vf.personalContactUser||e.userType===a.Cb.PersonalContact,k.isTFLUser=e=>e.type===l.vf.tflUser,k.isTFLConsumerUser=e=>e.type===l.vf.tflConsumer,k.isTFLSmsUser=e=>e.id&&k.isTFLSmsMri(e.id),k.isTFLSmsFriendlyNameUser=e=>e.id&&k.isTFLSmsMri(e.id)&&e.friendlyName,k.isInTenantUser=e=>{var t;return!((null===(t=e.type)||void 0===t?void 0:t.toLowerCase())!==l.cT.type.person.toLowerCase()&&e.type!==l.vf.ADUser||k.isGuestUser(e)||e.isFederated)},k.isBot=e=>{var t;return(null===(t=e.type)||void 0===t?void 0:t.toUpperCase())===l.t.botType},k.isDistributionList=e=>!(e.type!==l.vf.DistributionList&&e.userType!==l.vf.DistributionList||e.objectType&&e.objectType!==l.vf.DistributionList),k.isPSTNUser=e=>e.mri&&0===e.mri.indexOf(m),k.isSfcUser=e=>e.type===l.vf.skypeConsumer,k.isMTOUser=e=>e.profileType===l.p_.MTOUser||e.userType===l.vf.MTOUser,k.isB2BMemberMTOUser=e=>k.isMTOUser(e)&&(e.type===l.vf.ADUser||e.type===l.vf.person),k.isFederatedMTOUser=e=>k.isMTOUser(e)&&k.isFederatedUser(e),k.isB2BMember=e=>e.profileType===l.p_.B2BMember||e.userType===l.vf.B2BMember,k.isB2BGuest=e=>e.userType===l.vf.guest,k.isExtendedDirectoryUser=e=>k.isPEUPUser(e.userType)||k.isEUPUser(e.userType)||e.type===l.vf.extendedDirectoryUser,k.isPEUPUser=e=>e===l.vf.PendingOrgContact,k.isEUPUser=e=>e===l.vf.OrgContact,k.isSfBUser=e=>Boolean(e.mri&&-1!==e.mri.indexOf("sfb:")),k.isCallQorAAUser=e=>e.type===l.vf.voiceApp,k.isAnonymousTfwUser=e=>null==e?void 0:e.startsWith(y),k.isAnonymousTflUser=e=>null==e?void 0:e.startsWith(A),k.isAnonymousPstn=e=>null==e?void 0:e.startsWith("4:anonymous"),k.isAcsUserMri=e=>null==e?void 0:e.startsWith("8:acs:"),k.isTFLOffNetworkUser=e=>0===(null==e?void 0:e.indexOf(g)),k.isTFLOffNetworkPhoneUser=e=>0===(null==e?void 0:e.indexOf(N)),k.isTFLOffNetworkEmailUser=e=>0===(null==e?void 0:e.indexOf(M)),k.isTFLSmsUnVerifiedMri=e=>0===(null==e?void 0:e.indexOf(v)),k.isTFLSmsVerifiedMri=e=>0===(null==e?void 0:e.indexOf(T)),k.isTFLSmsMri=e=>0===(null==e?void 0:e.indexOf(T))||0===(null==e?void 0:e.indexOf(v)),k.isTFLSmsOrOffNetworkPhoneMri=e=>k.isTFLOffNetworkPhoneUser(e)||k.isTFLSmsMri(e),k.isTflSmsUnverifiedOrOffNetworkPhoneMri=e=>k.isTFLSmsUnVerifiedMri(e)||k.isTFLOffNetworkPhoneUser(e),k.isEnterpriseUserMri=e=>0===(null==e?void 0:e.indexOf("8:orgid:")),k.isConsumerUserMri=e=>{if(!e||!e.startsWith("8:"))return!1;const t=e.split(":");return!!(2===t.length||3===t.length&&i.isSfCUserPrefix(t[1]))},k.isDisplayNameUnknownUser=e=>(null==e?void 0:e.toLowerCase())===I||"unknown"===(null==e?void 0:e.toLowerCase()),k.isConversationItem=e=>{var t;return 0===(null===(t=e.id)||void 0===t?void 0:t.indexOf("19:"))},k.isTag=e=>"Tag"===e.type,k.getPhoneNumberFromMri=e=>e&&k.isTFLSmsUnVerifiedMri(e)?e.slice(v.length):""},309303:(e,t,n)=>{"use strict";function i(e){const t=e.startsWith("?")||e.startsWith("#");e=t?e.substring(1):e;const n={};return e.split("&").forEach((e=>{const[t,i]=e.split("=");n[t]=decodeURIComponent((i||"").replace(/^.+?(=)/,""))})),n}n.d(t,{d:()=>i})},519036:(e,t,n)=>{"use strict";n.d(t,{LP:()=>m,kf:()=>N,Ji:()=>T,sR:()=>v,HM:()=>I});var i=n(915534),a=n(558632),r=n(765923),o=n(734625);const l=new RegExp("media.*\\.giphy\\.com$","i"),s=new RegExp([".*\\.asm\\.skype\\.com$",".*\\.asyncgw\\.teams\\.microsoft\\.com$",".*\\.ams\\.gcc\\.teams\\.microsoft\\.com$",".*\\.ams\\.gov\\.teams\\.microsoft\\.us$",".*\\.ams\\.dod\\.teams\\.microsoft\\.us$",".*\\.asyncgw\\.teams\\.microsoft\\.scloud$",".*\\.asyncgw\\.teams\\.eaglex\\.ic\\.gov$",".*\\.asyncgw\\.teams\\.microsoftonline\\.cn$","\\urlp\\.sfbassets\\.com$","statics\\.gov\\.teams\\.microsoft\\.us$","statics\\.dod\\.teams\\.microsoft\\.us$","statics\\.teams\\.microsoft\\.com$","statics\\.teams\\.cdn\\.office\\.net$","staticsint\\.teams\\.cdn\\.office\\.net$","statics-dev\\.teams\\.cdn\\.office\\.net$","statics\\.teams\\.cdn\\.live\\.net$","staticsint\\.teams\\.cdn\\.live\\.net$","statics-dev\\.teams\\.cdn\\.live\\.net$","statics-cn\\.teams\\.cdn\\.office\\.net$","statics\\.teams\\.eaglex\\.ic\\.gov$","statics\\.teams\\.microsoft\\.scloud$","media.*\\.giphy\\.com$","local\\.teams\\.(?:office|live)\\.com$"].join("|"),"i"),d=new RegExp([".*\\logout*"].join("|"),"i"),c=/^\/asm\/[a-z]+/i,u="/urlp/v1/url/content",p="/urlp/v1/url/image/Favicon",m=e=>`data:${g(e)};base64,${e}`,g=e=>{const t=(0,i.v)(e);let n;return n=255===t[0]&&216===t[1]?"image/jpg":137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]?"image/png":71===t[0]&&73===t[1]&&70===t[2]?"image/gif":66===t[0]&&77===t[1]?"image/bmp":"image/unknown",n},M=e=>{const t=(0,r.J)().location.origin;if((0,a.nz)(e,t))return!0;const n=(0,a.Lp)(e).toLowerCase(),i=(0,a.DW)(e).toLowerCase();return s.test(n)||"teams.microsoft.com"===n&&c.test(i)},N=e=>M(e)&&(e=>{const t=(0,a.DW)(e).toLowerCase();return!d.test(t)})(e)||e.startsWith("data:image"),T=e=>{const t=(0,a.Lp)(e).toLowerCase();return l.test(t)};function v(e){return e.endsWith("/middletier/getGif/giphy.gif")}function I(e,t){try{const n=new URL(e);return M(e)&&!(0,o.$O)(e)&&!(0,a.nz)(e,t)&&(n.pathname===u||n.pathname===p)}catch(e){return!1}}},734625:(e,t,n)=>{"use strict";n.d(t,{hA:()=>I,w2:()=>y,KD:()=>A,a:()=>D,$O:()=>C,jo:()=>b,Pg:()=>h,Q3:()=>f,fY:()=>E,DP:()=>j,Ky:()=>L,yf:()=>O});var i=n(850402),a=n(558632);const r="asm.skype.com",o="api.ams.gcc.teams.microsoft.com",l="api.ams.gov.teams.microsoft.us",s="api.ams.dod.teams.microsoft.us",d="api.asyncgw.teams.microsoft.scloud",c="api.asyncgw.teams.microsoftonline.cn",u="api.asyncgw.teams.eaglex.ic.gov",p="asyncgw.teams.microsoft.com",m="/v1/objects",g="/views/video",M="/ams",N="teams.microsoft.com",T=/^\/asm\/[a-z]+/i,v=/^\/asm\/[a-z]+\/v1\/objects/i;var I,y;function A(e){if(e&&C(e)){const t=new RegExp(`${m}/([\\w|\\-]+)`,"i"),n=e.match(t);return n&&n[1]||""}return""}function D(e){const t=(0,a.Lp)(e).toLowerCase(),n=(0,a.DW)(e);return t.endsWith(r)||t===o||t===l||t===s||t===d||t===c||t===u||t.endsWith(p)||t===N&&T.test(n)}function C(e){if(j(e))return!0;const t=(0,a.DW)(e);return D(e)&&(t.startsWith(m)||v.test(t))}function b(e){if(!e)return!1;const t=(0,a.DW)(e);return!(!j(e)||!t.endsWith(g))||D(e)&&t.endsWith(g)}function h(e){return b(e)?y.Video:C(e)?y.Image:y.None}function f(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=e instanceof Blob?new Uint8Array(yield null===(t=e.arrayBuffer)||void 0===t?void 0:t.call(e)):e;if(!n||n.length<6)return!1;if(71!==n[0]||73!==n[1]||70!==n[2])return function(e){if(!e)return!1;let t=-1,n=-1;for(let i=0;i<e.length-4;i++)if(97===e[i]&&99===e[i+1]&&84===e[i+2]&&76===e[i+3]&&(n=i),73===e[i]&&68===e[i+1]&&65===e[i+2]&&84===e[i+3]){t=i;break}return n>=0&&t>n}(n);let i=0;for(let e=0;e<n.length-9&&!(k(n,e)&&(S(n,e+8)||U(n,e+8))&&(i++,i>1));e++);return i>1}))}function k(e,t){return 33===e[t]&&249===e[t+1]&&4===e[t+2]}function S(e,t){return 44===e[t]}function U(e,t){return 33===e[t]&&255===e[t+1]&&11===e[t+2]}function E(e,t){if(!e||!C(e)||!t||e.startsWith(t))return e;return[t,new URL(e).pathname.substring(1)].join("")}function j(e){return(0,a.DW)(e).toLowerCase().startsWith(M+m)}function L(e){return e>20971520}function O(e){if(!e||"image/*"===e)return"";const t=e.match(/^image\/([^*]+)$/);return t?t[1]:e}!function(e){e[e.IMAGE_SIZE_TOO_LARGE=10001]="IMAGE_SIZE_TOO_LARGE",e[e.UNSUPPORTED_IMAGE_FORMAT=10002]="UNSUPPORTED_IMAGE_FORMAT"}(I||(I={})),function(e){e.None="None",e.Image="Image",e.Video="Video"}(y||(y={}))},74346:(e,t,n)=>{"use strict";n.d(t,{aW:()=>s,Pd:()=>d,uL:()=>I,$o:()=>y,B4:()=>k,$Z:()=>S,r4:()=>U,Sz:()=>L});var i=n(88204),a=n(760005),r=n(711676),o=n(607586);const l="The row was removed for this reason -";var s;!function(e){e.Default="default",e.Voicemail="voicemail",e.CallParkService="callParkService",e.OriginalEmergencyCallParticipant="originalEmergencyCallParticipant"}(s||(s={}));const d=({messages:e,callLogsBlacklistedMRIs:t,currentUserMri:n,logger:i,options:{enableRichCallHistory:a,enableRichCallHistoryExtension:r,enableSLACallHistory:o,enableSLACallHistoryFromPersonalHistory:l,currentTabDelegatorId:s,isLogMergedWithSharedCorrelationId:d,enableRecordingAndTranscribingInCallsAppV2:I},tableType:y,callQueueId:D,keepTranscriptMessages:C})=>{const b=o?e.filter((({callLog:e})=>e&&e.isSharedLineAppearanceCallHistory)):[],h=o?e.filter((({callLog:e})=>e&&e.isDeleted)):[],f=o?e.filter((({callLog:e})=>!(e&&e.isSharedLineAppearanceCallHistory))):[],k=e.filter((e=>{if(e.callLog){const d=j(S(e.callLog,D).isCallQueue,e.callLog);return!(c(e.callLog,i)||u(e.callLog,t,i)||p(e.callLog,h,i)||m(e.callLog,i,a)||g(e.callLog,n,i)||M(e.callLog,i)||N(e.callLog,i,a)||T(e.callLog,n,b,i,o,l,s)||v(e.callLog,n,r)||d)}return!1}));return A({allValidMessages:k,personalHistoryMessages:f,enableRecordingAndTranscribingInCallsAppV2:!!I,logger:i,isLogMergedWithSharedCorrelationId:d,tableType:y,callQueueId:D,keepTranscriptMessages:C})},c=(e,t)=>{const n=!!e.sessionType&&e.sessionType===i.FT.ScreenSharing;return n&&t.log(`[isScreenSharingSession] ${l} it is tied to a screensharing session`,e),n},u=(e,t,n)=>{const i=!!e.targetParticipant&&t.indexOf(e.targetParticipant.id)>-1;return i&&n.log(`[isTargetBlacklisted] ${l} it is part of the blacklisted MRIs`,e),i},p=(e,t,n)=>{const i=e.isDeleted||t.find((t=>{var n;return(null===(n=t.callLog)||void 0===n?void 0:n.callId)===e.callId}));return i&&n.log(`[isCallHistoryDeleted] ${l} it is deleted`,e),i},m=(e,t,n)=>{var i;const a=!e.targetParticipant&&(null===(i=e.participantList)||void 0===i?void 0:i.length)&&!n;return a&&t.log(`[isGroupCallToBeDisabled] ${l} it is a group call that is hidden because enableRichCallHistory is disabled`,e),a},g=(e,t,n)=>{if(!e.participantList)return!1;const i=!e.targetParticipant&&1===e.participantList.length&&e.participantList[0].id===t;return i&&n.log(`[isGroupCallDeclinedByAllParticipants] ${l} it is an outgoing group call with no target to display because the call was unanswered/declined by all parties`,e),i},M=(e,t)=>{var n;const a=e.callDirection===i.kw.Outgoing&&!e.targetParticipant&&!(null===(n=e.participantList)||void 0===n?void 0:n.length);return a&&t.log(`[isOutgoingCallWithNoTarget] ${l} it is an outgoing 1:1 call that does not have target participant to display`,e),a},N=(e,t,n)=>{var i;if(!n)return!1;const a=s.CallParkService.toString(),r=(null===(i=e.targetParticipant)||void 0===i?void 0:i.type)===a;return r&&t.log(`[isCallHistoryWithCallParkBot] ${l} it is a parked call with the Call Park service bot`,e),r},T=(e,t,n,i,a,r,o)=>{var s;const{isSharedLineAppearanceCallHistory:d,isSharedLineAppearanceActivated:c,targetDelegator:u,originatorDelegator:p}=e;if(!a&&d)return i.log(`[slaCallHistoryFiltering] ${l} it is an SLA call history from shared history and enableSLACallHistory is disabled`,e),!0;if((null===(s=e.recordings)||void 0===s?void 0:s.length)||e.transcript)return!1;const m=d||c&&r;if(o){const t=!m||!u&&!p||u&&u.id!==o||p&&p.id!==o;return t&&i.log(`[slaCallHistoryFiltering] ${l} it is an SLA call history that is not to be displayed on the current delegator's tab. [currentTabDelegatorId=${o}]`,e),t}{const a=m&&(u&&u.id!==t||p&&p.id!==t),r=!d&&n.find((t=>{var n;return(null===(n=t.callLog)||void 0===n?void 0:n.callId)===e.callId})),o=a||r;return o&&i.log(`[slaCallHistoryFiltering] ${l} it is an SLA call history that is not to be displayed on the personal tab. [isSlaCallHistoryForDelegatorTab=${a}] [isSlaCallHistoryDuplicateOnPersonalTab=${r}]`,e),o}},v=(e,t,n)=>!n&&I(e,t)&&e.forwardingType===i.Io.Immediate,I=(e,t)=>{const{forwarderParticipant:n,forwardedTargetParticipant:i}=e;return!!(!n&&i||n&&n.id===t)},y=({callType:e,threadId:t,participantList:n})=>e===i.Bd.MultiParty&&(n&&n.length>1||!!t),A=({allValidMessages:e,personalHistoryMessages:t,enableRecordingAndTranscribingInCallsAppV2:n,logger:i,isLogMergedWithSharedCorrelationId:a,tableType:r,callQueueId:o,keepTranscriptMessages:l})=>{const s=D(e,t,!!n,i,l);return a&&C(r)?b(s,i,o):s},D=(e,t,n,i,r)=>{if(!n)return e.filter((e=>{const t=e.callLog.messageType!==a.Cs.CallTranscript&&e.callLog.messageType!==a.Cs.CallRecording&&e.callLog.messageType!==a.Cs.CallLogTranscript&&e.callLog.messageType!==a.Cs.CallLogRecording;return t||i.log(`[mergeMessagesWithRecordingsAndTranscript] ${l} it is a call tied to transcript/recording that is filtered because enableRecordingAndTranscribingInCallsAppV2 is disabled`,e.callLog),t}));const o=new Map,s=new Map,d=new Map;e.forEach((e=>{var n;if(!e.callLog)return;let i=`${e.callLog.callId}-${e.callLog.userParticipantId}`;if((e.callLog.messageType===a.Cs.CallTranscript||e.callLog.messageType===a.Cs.CallLogTranscript)&&d.set(i,e),(e.callLog.messageType===a.Cs.CallRecording||e.callLog.messageType===a.Cs.CallLogRecording)&&s.set(i,[...s.get(i)||[],e]),e.callLog.messageType===a.Cs.HTML){if(e.callLog.isSharedLineAppearanceCallHistory){const a=t.find((t=>{var n,i;return(null===(n=t.callLog)||void 0===n?void 0:n.callId)===(null===(i=e.callLog)||void 0===i?void 0:i.callId)}));i=`${e.callLog.callId}-${null===(n=null==a?void 0:a.callLog)||void 0===n?void 0:n.userParticipantId}`}o.set(i,e)}}));const c=[];return o.forEach(((e,t)=>{const n=d.get(t);return n&&d.delete(t),c.push(f(e,i,n,s.get(t)))})),r&&d.forEach((e=>c.push(e))),c},C=e=>e===i.o8.CallsApp,b=(e,t,n)=>{const i=[],a=new Map;return e.forEach((e=>{if(!e.callLog)return void t.warn(`[mergeMessageWithSharedCorrelationId] Did not receive a call log property or invalid messageId [messageId=${e.id}]`);if(!e.callLog.sharedCorrelationId)return void i.push(e);if(e.callLog.targetParticipant&&e.callLog.targetParticipant.id.startsWith(o.V.Bot))return void(k(e.callLog.targetParticipant.id)?i.push(e):t.log(`[mergeMessageWithSharedCorrelationId] ${l} the target participant is a bot that isn't the VoiceApp bot`,e.callLog));const r=a.get(e.callLog.sharedCorrelationId),s=S(e.callLog,n).isCallQueue;if(!r)return void a.set(e.callLog.sharedCorrelationId,{callLog:e.callLog,id:e.callLog.messageId,isCq:s,duration:U(e.callLog)});t.log(`[mergeMessageWithSharedCorrelationId] ${l} This call history row was merged into another because they share the same correlation id [sharedCorrelationId=${e.callLog.sharedCorrelationId}]`,e.callLog);const d=s===r.callLog.startTime<e.callLog.startTime?e.callLog:r.callLog,c=s?U(d):U(e.callLog)+r.duration,u=`${r.id}_${e.callLog.messageId}`;a.set(e.callLog.sharedCorrelationId,{callLog:d,id:u,isCq:s,duration:c})})),a.forEach((({isCq:e,id:t,callLog:n,duration:a})=>{let r=n;e||(r=n.cloneWithConnectAndEndTime?n.cloneWithConnectAndEndTime(Object.assign(Object.assign({},h(n.startTime,a)),{messageId:t})):Object.assign(Object.assign(Object.assign({},n),h(n.startTime,a)),{messageId:t})),i.push({callLog:r,id:t})})),i},h=(e,t)=>{const n=new Date(e);return{connectTime:e,endTime:new Date(n.valueOf()+t).toISOString()}},f=(e,t,n,i)=>{var a,r,o;let l=Object.assign({},e);const s=(e=>{const t=[];return e&&e.forEach((e=>{var n,i;(null===(i=null===(n=e.callLog)||void 0===n?void 0:n.recordings)||void 0===i?void 0:i.length)&&t.push(e.callLog.recordings[0])})),t})(i),d=null===(a=null==n?void 0:n.callLog)||void 0===a?void 0:a.transcript;return(d||s.length)&&(l.callLog.cloneWithTranscriptAndRecording?l.callLog=l.callLog.cloneWithTranscriptAndRecording({callId:l.callLog.callId,userParticipantId:l.callLog.userParticipantId,transcript:d,recordings:s}):l=Object.assign(Object.assign({},e),{callLog:Object.assign(Object.assign({},e.callLog),{transcript:d,recordings:s})})),(l.callLog.transcript||l.callLog.recordings.length)&&t.log(`[toCallHistoryRows] ${l.callLog.transcript?"1 transcript row & ":""} ${(null===(r=l.callLog.recordings)||void 0===r?void 0:r.length)?`${null===(o=l.callLog.recordings)||void 0===o?void 0:o.length} recording row(s)`:""} were merged into this row`,l.callLog),l},k=e=>!!e&&(0,r.B4)(e,a.f0),S=({callType:e,applicationContent:t},n)=>{const a={isCallQueue:!1,isForCurrentCallQueue:!1,callQueueType:null};if((null==t?void 0:t.type)===i.G_.HuntGroup){switch(e){case i.Bd.TwoParty:a.callQueueType=i.Fk.transfer;break;case i.Bd.MultiParty:a.callQueueType=i.Fk.conference}a.isCallQueue=void 0!==a.callQueueType,a.isForCurrentCallQueue=E(n,t.configId)}else(null==t?void 0:t.type)===i.G_.CallableChannelOboCall&&(a.isCallQueue=!0,a.isForCurrentCallQueue=E(n,t.configId));return a},U=({endTime:e,connectTime:t,targetParticipant:n})=>{let i=0;if(t&&e&&(null==n?void 0:n.type)!==s.Voicemail.toString()){const n=new Date(e),a=new Date(t);i+=Math.round(n.getTime()-a.getTime())}return i},E=(e,t)=>!!e&&!!t&&e===t,j=(e,t)=>e&&t.callDirection===i.kw.Incoming&&t.callState!==i.Qv.Accepted,L=e=>{let t;return t="string"!=typeof e?"":e.includes(";ext=")?e:e.split(";")[0],t}},88204:(e,t,n)=>{"use strict";var i,a,r,o,l,s,d,c,u,p,m;n.d(t,{FT:()=>i,Bd:()=>a,Qv:()=>r,kw:()=>o,hy:()=>l,Io:()=>s,Ry:()=>d,Fk:()=>c,o8:()=>p,G_:()=>m}),function(e){e.Default="Default",e.ScreenSharing="ScreenSharing",e.EmergencyGroupCall="EmergencyGroupCall",e.Unknown="Unknown"}(i||(i={})),function(e){e.MultiParty="MultiParty",e.TwoParty="TwoParty",e.Unknown="Unknown"}(a||(a={})),function(e){e.Accepted="Accepted",e.AcceptedElsewhere="AcceptedElsewhere",e.Declined="Declined",e.Missed="Missed",e.Unknown="Unknown"}(r||(r={})),function(e){e.Outgoing="Outgoing",e.Incoming="Incoming",e.Unknown="Unknown"}(o||(o={})),function(e){e.Transferred="Transferred",e.TransferAccepted="TransferAccepted",e.TransferFailed="TransferFailed",e.TransferSucceeded="TransferSucceeded",e.Unknown="Unknown"}(l||(l={})),function(e){e.Immediate="Immediate",e.Simultaneous="Simultaneous",e.Unanswered="Unanswered"}(s||(s={})),function(e){e.Voicemail="Voicemail",e.SingleTarget="SingleTarget",e.MyDelegates="MyDelegates",e.DoNothing="DoNothing",e.Group="Group"}(d||(d={})),function(e){e.transfer="transfer",e.conference="conference"}(c||(c={})),function(e){e.Hold="Hold",e.Resume="Resume",e.Barge="Barge"}(u||(u={})),function(e){e.CallsApp="CallsApp",e.CallableChannel="CallableChannel",e.QueuesApp="QueuesApp"}(p||(p={})),function(e){e.HuntGroup="HuntGroup",e.CallableChannelOboCall="CallableChannelOboCall"}(m||(m={}))},690250:(e,t,n)=>{"use strict";var i;n.d(t,{s:()=>i}),function(e){e.Adaptive="application/vnd.microsoft.card.adaptive",e.AnnouncementHeader="application/vnd.microsoft.teams.messaging-announcementBanner",e.Audio="application/vnd.microsoft.card.audio",e.CodeSnippet="application/vnd.microsoft.card.codesnippet",e.FileConsent="application/vnd.microsoft.teams.card.file.consent",e.Hero="application/vnd.microsoft.card.hero",e.Keyboard="application.vnd.microsoft.keyboard",e.List="application/vnd.microsoft.teams.card.list",e.O365connector="application/vnd.microsoft.teams.card.o365connector",e.O365connectorAlias="application/vnd.microsoft.card.o365connector",e.Profile="application/vnd.microsoft.teams.card.profile",e.Receipt="application/vnd.microsoft.card.receipt",e.Signin="application/vnd.microsoft.card.signin",e.Thumbnail="application/vnd.microsoft.card.thumbnail"}(i||(i={}))},89062:(e,t,n)=>{"use strict";n.d(t,{Uw:()=>r,XC:()=>o,n:()=>l,LQ:()=>d,u4:()=>c});var i=n(275742),a=n(905581);function r(e,t,n){return e=s(e,t,n=n||o),1===t.length&&"object"==typeof t[0]&&(e=s(e,t[0],n)),e}function o(e){if(null===e)return"null";if(void 0===e)return"undefined";const t=typeof e;if("string"===t)return e;if("number"===t||"boolean"===t)return String(e);if("function"===t)return"";if((0,i.isDate)(e))return e.toISOString();try{return JSON.stringify(e)}catch(t){return c(e)}}function l(e,t){let n=`[errorType=${typeof e}]`;return n+=e?"object"==typeof e?`[errorName=${e.name}][errorMessage=${e.message}][errorStack=${e.stack}]`:`[error=${e.toString()}]`:`[error=Undefined ${t} Error]`,(0,a._S)(n)}function s(e,t,n){for(const i in t)t.hasOwnProperty(i)&&(e=e.replace(`{${i}}`,n(t[i])));return d(e)}function d(e){return null==e||0===e.length?e:` ${e}`.substr(1)}function c(e,t){const n=new WeakSet;return JSON.stringify(e,((e,t)=>{if(!n.has(t)){if(t&&"object"==typeof t){if(n.add(t),t instanceof Map||t instanceof Set)return Array.from(t);if(t instanceof Error)return`${t.name}: ${t.message}`;if(t.constructor&&t.constructor!==Object&&t.constructor!==Array||t.prototype)return}return t}}),t)}},878652:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});const i=(e,t={},n)=>{let i;try{if(void 0===e)throw new Error('"undefined" is not valid JSON');i=JSON.parse(e)}catch(e){i=t,null==n||n(e)}return i}},607586:(e,t,n)=>{"use strict";var i;n.d(t,{V:()=>i}),function(e){e.User="8:orgid:",e.Pstn="4:",e.Bot="28:",e.GcchUser="8:gcch:",e.DodUser="8:dod:",e.AcsUser="8:acs:",e.PstnExtension=";ext="}(i||(i={}))},589585:(e,t,n)=>{"use strict";n.d(t,{un:()=>d,jg:()=>N,xi:()=>T,PN:()=>v,iE:()=>A});var i=n(850402),a=n(275742),r=n(607586),o=n(954938),l=n(50805),s=n(405501);const d=(e,t,n,i)=>{let a={normalized:e,diallable:e,display:e};const{logger:r,userLocale:o,isDialPlansEnabled:l,allowNonE164Mri:d,phoneNumberUtil:u,phoneNumberFormat:g}=n;if(!u||!g)return r.warn(`[formatPhoneNumber] Invalid config: isPhoneNumberUtilDefined=${!!u}, isPhoneNumberFormatDefined=${!!g}`),a;if(!e)return r.warn(`[formatPhoneNumber] No phone number provided from: ${t}`),a;if(r.log(`[formatPhoneNumber] Received phoneNumber: ${e} from: ${t}`),!i){const t=(0,s.bR)(e),i=c(t,n);if(r.log("[formatPhoneNumber] cleaned_formatting"),l){if(a=I(i,n),r.log(`[formatPhoneNumber] isInternalExtension? ${a.isInternalExtension}`),a.isInternalExtension)return a}else r.log("[formatPhoneNumber] Dialplan not enabled, not applying normalization rules"),a.normalized=i;d||(a.normalized=p(a.normalized,g.E164,n,!0),r.log("[formatPhoneNumber] NonE164 mri are not allowed"))}a=Object.assign(Object.assign({},a),m(a.normalized,n));try{const e=u.getInstance().parseAndKeepRawInput(a.normalized,o);a.display=u.getInstance().formatInOriginalFormat(e,g.INTERNATIONAL),a.isValid=u.getInstance().isPossibleNumber(e)&&u.getInstance().isValidNumber(e)}catch(e){r.error(`[formatPhoneNumber] ${e}`),a.display=a.normalized,a.isValid=!1}return r.log(`[formatPhoneNumber] isValid? ${a.isValid}`),a},c=(e,t)=>{if(!t.phoneNumberUtil)return t.logger.warn(`[convertPhoneNumberToAlpha] Invalid config: isPhoneNumberUtilDefined=${!!t.phoneNumberUtil}`),e;const n=u(e,t),i=e.substring(n.length);return t.phoneNumberUtil.convertAlphaCharactersInNumber(n)+i},u=(e,t)=>{if(!t.phoneNumberUtil)return t.logger.warn(`[getPhoneNumberWithoutExtension] Invalid config: isPhoneNumberUtilDefined=${!!t.phoneNumberUtil}`),e;const n=t.phoneNumberUtil.EXTN_PATTERN_,i=e.search(n);return i>=0?e.substring(0,i):e},p=(e,t,n,i,a)=>{const{userLocale:r,logger:o,phoneNumberUtil:l,phoneNumberFormat:s}=n;if(!l||!s)return o.warn(`[parseAndFormatNumber] Invalid config: isPhoneNumberUtilDefined=${!!l}, isPhoneNumberFormatDefined=${!!s}`),e;const d=t||s.INTERNATIONAL,c=v(e,n,"parseAndFormatNumber");if(!T(c,n,a))return c;try{if(i){const e=l.getInstance().parse(c,r);return l.getInstance().format(e,d)}{const e=l.getInstance().parseAndKeepRawInput(c,r);return l.getInstance().formatInOriginalFormat(e,d)}}catch(e){return o.error("[parseAndFormatNumber] Failed to parse and format a phone number",e),c}},m=(e,t)=>{const{enableFormattingFixForExtension:n}=t;return{diallable:u(e,t),extension:n?M(e,t):g(e,t)}},g=(e,t)=>{const n=v(e,t,"getExtension");return M(n,t)},M=(e,t)=>{const{enablePstnWithExtnFix:n,enableFixForDtmfTone:i,logger:a,userLocale:r,phoneNumberUtil:o}=t;if(!o)return a.warn(`[getExtensionFromNormalizedNumber] Invalid config: isPhoneNumberUtilDefined=${!!o}`),"";if(!n&&!i&&!T(e,t))return a.warn(`[getExtension] Received an invalid phone number: ${e}`),"";try{return o.getInstance().parse(e,r).getExtension()||""}catch(e){return a.error("Failed to parse and format a phone number",e),""}},N=(e,t,n,i)=>{const{logger:a}=t;let o=`${r.V.Pstn}${e}`;return n&&(o+=`${r.V.PstnExtension}${n}`),a.log(`[generateMriForPstn] context: ${i} Generated MRI: ${o} for dialOutNumber: ${e} ${n?`and extension: ${n}`:""}`),o},T=(e,t,n)=>{const{userLocale:i,logger:a,phoneNumberUtil:r}=t;if(!r)return a.warn(`[isStandardFormatNormalized] Invalid config: isPhoneNumberUtilDefined=${!!r}`),!1;if(!e)return!1;try{const a=v(e,t,"isStandardFormatNormalized"),o=r.getInstance().parse(a,i),l=r.getInstance().isPossibleNumber(o);return n?l:l&&r.getInstance().isValidNumber(o)}catch(e){return a.error("[isStandardFormatNormalized] error:",e),!1}},v=(e,t,n)=>{const{isDialPlansEnabled:i,logger:a}=t;a.log(`[normalizePstnNumber] Received phoneNumber: ${e} from: ${n}`);const r=(0,s.bR)(e);return i?I(r,t).normalized:r},I=(e,t)=>{const{normalizationRules:n,logger:i,coreSettings:a,ituCountryPrefix:r}=t,l={normalized:e,diallable:e,display:e};if(!n.length)return l;const s=new o.E(n,r,i,a).normalize(e);return l.normalized=s.phoneNumber,l.diallable=null==s?void 0:s.phoneNumber,l.display=null==s?void 0:s.phoneNumber,l.isInternalExtension=null==s?void 0:s.isInternalExtension,l.isValid=s.isNormalized,l},y=(e,t,n,i,r)=>{let o;if(!(0,a.isEmpty)(e)){const t=null==i?void 0:i.getInstance().getRegionCodeForCountryCode(Number(e));if(t)return o=t.toLowerCase(),n.log(`Setting locale based on dial plan to ${o}`),o}const l=(null==r?void 0:r())||t||"en-US";return l?(o=l.substring(l.indexOf("-")+1).toLowerCase(),n.log(`Setting locale based on teams locale to ${o}`),o):(n.warn("localizationService failed to get locale. Falling back to 'us' locale"),"us")},A=(e,t,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var r,o,s;const d=e.get(l.J.Calling);let c;try{c=yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t;let i;try{i=yield n.e(29311).then(n.t.bind(n,68475,23))}catch(n){return null===(t=e.errorToTelemetry)||void 0===t||t.call(e,`[getLibPhoneNumber] Failed to load @microsoft/google-libphonenumber. ${null==n?void 0:n.message}`,"utilities_normalization_getlibphonenumber",void 0,!0),Promise.reject(`Failed to load @microsoft/google-libphonenumber : ${null==n?void 0:n.message}`)}return i})))(a)}catch(e){return a.error(`[getConfig] Failed to load @microsoft/google-libphonenumber. ${e}`),Promise.reject({error:"Failed to load @microsoft/google-libphonenumber",message:e})}return{allowNonE164Mri:!!d.allowNonE164Mri,isDialPlansEnabled:!!d.enableDialPlans,enablePstnWithExtnFix:!!d.enablePstnWithExtnFix,normalizationRules:(null===(r=d.dialPlanPolicy)||void 0===r?void 0:r.normalizationRules)||[],ituCountryPrefix:(null===(o=d.dialPlanPolicy)||void 0===o?void 0:o.ituCountryPrefix)||"",enableFormattingFixForExtension:!!d.enableFormattingFixForExtension,userLocale:y((null===(s=d.dialPlanPolicy)||void 0===s?void 0:s.ituCountryPrefix)||"",t,a,c.PhoneNumberUtil),enableFixForDtmfTone:!!d.enableFixForDtmfTone,logger:a,phoneNumberUtil:c.PhoneNumberUtil,phoneNumberFormat:c.PhoneNumberFormat,coreSettings:e}}))},954938:(e,t,n)=>{"use strict";n.d(t,{E:()=>r});var i=n(50805),a=n(405501);class r{constructor(e,t,n,i){this.iTUCountryPrefix=t,this.logger=n,this.coreSettings=i,this.invalidRules=[],this.normalizeRules=[],this.setRules(e)}normalize(e){var t,n,o,l,s,d,c;let u=r.removeFormatCharacters(e);u=r.removeGuid(u);const p=null===(t=this.coreSettings)||void 0===t?void 0:t.get(i.J.Calling);if(null===(n=this.logger)||void 0===n||n.log(`[normalize] Feature flag: stopNormalizationOnPlus=${null==p?void 0:p.stopNormalizationOnPlus}`),(null==p?void 0:p.stopNormalizationOnPlus)&&u.startsWith("+"))return null===(o=this.logger)||void 0===o||o.log(`[normalize] ${e} starts with plus. Stopping normalization.`),{phoneNumber:u,isNormalized:!0};let m=1;for(const t of this.normalizeRules){const{pattern:n,translation:i,isInternalExtension:a}=t;if(n.test(u)){const t=u.replace(n,i);return null===(l=this.logger)||void 0===l||l.log(`[normalize] [${e}] was normalized into [${t}] using rule ${m} of ${this.normalizeRules.length}: ruleExpression=[${n}] translation=[${i}] isInternalExtension=[${a}].`),{phoneNumber:t,isInternalExtension:a,isNormalized:!0}}m++}if(null===(s=this.logger)||void 0===s||s.log(`[normalize] No normalization rule matched. [addCountryCodeDuringNormalization=${null==p?void 0:p.addCountryCodeDuringNormalization}].`),(null==p?void 0:p.addCountryCodeDuringNormalization)&&!u.startsWith("+")&&(0,a.TE)(u)){const t=this.iTUCountryPrefix||(null===(d=p.dialPlanPolicy)||void 0===d?void 0:d.ituCountryPrefix),n=t?`+${t}`:"",i=`${n}${u}`;return null===(c=this.logger)||void 0===c||c.log(`[normalize] [${e}] was normalized into [${i}] by adding country code [${n}].`),{phoneNumber:i,isNormalized:!!n}}return{phoneNumber:u}}getInvalidRules(){return this.invalidRules}getITUCountryPrefix(){return this.iTUCountryPrefix}static removeFormatCharacters(e){return e.replace(/[\s\(\)\-_\/]+/g,"")}static removeGuid(e){return e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,"")}setRules(e){if(e)for(const t of e)try{this.normalizeRules.push({pattern:new RegExp(t.pattern),translation:t.translation,isInternalExtension:t.isInternalExtension})}catch(e){this.invalidRules.push(t.pattern)}}}},405501:(e,t,n)=>{"use strict";n.d(t,{EG:()=>a,em:()=>r,of:()=>d,_7:()=>c,Ol:()=>u,DI:()=>p,gx:()=>m,bR:()=>g,TE:()=>M});var i=n(607586);const a=e=>Boolean(e&&e.startsWith(i.V.Pstn)),r=e=>!(!e||!e.startsWith(i.V.AcsUser)),o=/4:[^-_]*-[^-_]*-[^-_]*-[^-_]*-.*/,l=/^\+?\d*[ ]*(\([ ]*\d+[ ]*\))?[0-9 -]+((?:;ext=([0-9]{1,7})|[  \t,]*(?:e?xt(?:ensi(?:ó?|ó))?n?|ｅ?ｘｔｎ?|[,xｘ#＃~～]|int|anexo|ｉｎｔ)[:\.．]?[  \t,-]*([0-9]{1,7})#?|[- ]+([0-9]{1,5})#))?$/i,s=e=>e.indexOf("_"),d=e=>{if(!a(e))return!1;const t=e.slice(i.V.Pstn.length);return-1!==s(t)},c=(e,t)=>o.test(e)&&t,u=e=>{let t=e.slice(i.V.Pstn.length);const n=s(t);return-1!==n&&(t=t.slice(0,n)),t},p=e=>e?`4:${e.replace(/-/g,"").replace(/\s/g,"")}`:"",m=e=>e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,""),g=e=>{const t=(e=>e.replace(/[ \(\)\-_\/]+/g,""))(m(e));return t},M=e=>l.test(null==e?void 0:e.trim())},38613:(e,t,n)=>{"use strict";function i(e=1){const t=new Uint32Array(e),i=n.g;if(i.msCrypto)i.msCrypto.getRandomValues(t);else if(i.crypto)i.crypto.getRandomValues(t);else{let n=e;for(;n--;){const e=4294967296;t[n]=Math.floor(Math.random()*e)}}return Array.from(t)}function a(e){return 0===(t=1/e,Math.floor(Math.random()*t));var t}n.d(t,{MX:()=>i,uE:()=>a})},533464:(e,t,n)=>{"use strict";n.d(t,{hN:()=>i,jE:()=>r,mo:()=>c,PI:()=>u,Xn:()=>p,BN:()=>M,Np:()=>N,mW:()=>T,Qz:()=>v,zG:()=>I,cE:()=>y,MV:()=>A,Wg:()=>D,_Y:()=>C,cI:()=>h,t_:()=>f,gC:()=>U});var i,a,r,o=n(760005),l=n(711676),s=n(275742),d=n(982346);!function(e){e.TeamsOnly="TeamsOnly",e.SfBOnly="SfBOnly",e.SfBWithTeamsCollab="SfBWithTeamsCollab",e.SfBWithTeamsCollabAndMeetings="SfBWithTeamsCollabAndMeetings",e.Islands="Islands",e.IslandsWithTempInterop="IslandsWithTempInterop",e.IslandsWithVoipDeepLinking="IslandsWithVoipDeepLinking"}(i||(i={})),function(e){e[e.Islands=1]="Islands",e[e.IslandsWithTempInterop=2]="IslandsWithTempInterop",e[e.IslandsWithVoipDeepLinking=3]="IslandsWithVoipDeepLinking",e[e.SfBOnly=4]="SfBOnly",e[e.SfBWithTeamsCollab=5]="SfBWithTeamsCollab",e[e.SfBWithTeamsCollabAndMeetings=6]="SfBWithTeamsCollabAndMeetings",e[e.TeamsOnly=7]="TeamsOnly",e[e.Legacy=8]="Legacy"}(a||(a={})),function(e){e[e.Teams=0]="Teams",e[e.SfB=1]="SfB",e[e.Federated=2]="Federated",e[e.NativeFederated=3]="NativeFederated"}(r||(r={}));const c=e=>!!(e&&e.coExistenceMode&&i[e.coExistenceMode]),u=e=>!(e!==i.TeamsOnly),p=e=>!(-1===[i.Islands,i.IslandsWithTempInterop,i.IslandsWithVoipDeepLinking].indexOf(e)),m=e=>!(-1===[i.SfBOnly,i.SfBWithTeamsCollab,i.SfBWithTeamsCollabAndMeetings].indexOf(e)),g=(e,t,n=!1)=>{const i=[o.Jq,o.Dr,o.iO,o.TO,o.pk,o.P_],a=e.split(":");return i.some((e=>{const i=a.findIndex((t=>t===e.slice(0,-1)));return i>=0&&(n?a.splice(i+1,1):a.splice(i+1,0,t.slice(0,-1)),!0)})),a.join(":")},M=e=>!!e&&!(0,s.startsWith)(o.at.SkypeSpacesUser+o.pW,e)&&e.includes(o.pW),N=e=>!e||M(e)?e:e.includes(o.at.SkypeSpacesUser)?g(e,o.pW):void 0,T=e=>!!e&&!(0,s.startsWith)(o.at.SkypeSpacesUser+o.m_,e)&&e.includes(o.m_),v=e=>!!e&&!(0,s.startsWith)(o.at.SkypeSpacesUser+o.U0,e)&&e.includes(`:${o.U0}`),I=e=>!e||v(e)?e:e.includes(o.at.SkypeSpacesUser)?g(e,o.U0):void 0,y=e=>!e||T(e)?e:e.includes(o.at.SkypeSpacesUser)?g(e,o.m_):void 0,A=e=>!e||(e=>!!e&&!e.startsWith(o.at.SkypeSpacesUser+o.fe)&&e.includes(o.fe))(e)?e:e.includes(o.at.SkypeSpacesUser)?g(e,o.fe):void 0,D=e=>{if(e){if(M(e))return g(e,o.pW,!0);if(T(e))return g(e,o.m_,!0)}return e},C=e=>e?v(e)?g(e,o.U0,!0):void 0:e,b={isAllowed:!1},h=(e,t,n,i,a,r,o,l)=>{const s=o&&o.coExistenceMode,d=r&&r.coExistenceMode;if(!s||!d)return{isAllowed:!0};if(i){const i=((e,t,n,i,a,r,o)=>{const l=o.newLogger("sfb-interop","services-utilities-sfb-interop");return r.isFederated?!i&&n?(l.log("Chat Disabled: current user is not provisioned on Sfb online"),b):r.coExistenceMode&&a.coExistenceMode?e&&n&&u(a.coExistenceMode)&&u(r.coExistenceMode)?{isAllowed:!1,mri:y(r.mri||"")}:n||t||!p(a.coExistenceMode)&&!p(r.coExistenceMode)?!n&&m(r.coExistenceMode)?{isAllowed:!1,toInterop:!0,mri:r.mri||""}:{isAllowed:!0}:{isAllowed:!1,toInterop:!0,mri:r.mri}:(l.log("Chat Enabled: TeamsUpgradePolicy is not defined for both users"),{isAllowed:!0}):(l.log("Federated Chat Disabled: recipient user is not federated"),(e=>({isAllowed:!1,toInterop:!1,mri:e.mri}))(r))})(e,t,n,a,r,o,l);if(!i.isAllowed)return i}else{const e=((e,t)=>t.coExistenceMode?e&&u(t.coExistenceMode)?{isAllowed:!1,mri:D(t.mri||"")}:!e&&m(t.coExistenceMode)?{isAllowed:!1,mri:N(t.mri||""),toInterop:!0}:{isAllowed:!0}:{isAllowed:!0})(n,o);if(!e.isAllowed)return e}return{isAllowed:!0}},f=e=>{const t=T(e);return k(e)||M(e)||t?t?e.replace(o.m_,""):e.replace(o.pW,"").replace(o.zt,""):e},k=e=>!!e&&!(0,s.startsWith)(o.at.SkypeSpacesUser+o.zt,e)&&e.includes(o.zt),S=(e,t,n,i)=>{const r=e.isFederated,o=(l=e.mri||"",(0,s.endsWith)(l,"@sfbonprem.unq.gbl.spaces"));var l;if(t&&r&&!o&&e.coExistenceMode){const t=a[e.coExistenceMode],r=n===a.TeamsOnly&&t===a.TeamsOnly;return r||i.log(`isNativeFederationMode is false - currentUserMessagingPolicyMode:${a[n]} recipientCoexistenceMode:${a[t]}`),r}return i.log(`isNativeFederationMode is false - enableNativeP2PFederatedChats:${t} isFederated:${r} isOnPremFederated:${o} coExistenceMode:${e.coExistenceMode}`),!1},U=(e,t,n,i,o,s)=>{if(!(e&&e.mri&&e.userType!==d.vf.guest&&e.type!==d.vf.skypeConsumer&&e.type!==d.vf.tflUser&&(0,l.eZ)(e.mri)))return n.log("getUserChatMode - Defaulting to teams chat mode as user profile is undefined or Guest or TFL user or is not a real user mri"),r.Teams;if(e.isFederated)return n.log(`getUserChatMode - federated user - mri: ${e.mri}, coExistenceMode: ${e.coExistenceMode}`),S(e,o,s,n)?r.NativeFederated:r.Federated;const c=((e,t,n)=>{const i=e.coExistenceMode,o=a[i];if(n.log(`getCoexistenceChatMode - caller: ${t}, mri: ${e.mri}, isShortProfile: ${e.isShortProfile}, coExistenceMode: ${a[o]}, MT coExistenceMode: ${i}`),a[o]!==i&&n.error(`getUserChatMode - Mapping error - coExistenceMode : ${a[o]}, MT coExistenceMode: ${i}`),o){const e=[a.SfBOnly,a.SfBWithTeamsCollab,a.SfBWithTeamsCollabAndMeetings],t=[a.TeamsOnly,a.Islands,a.IslandsWithVoipDeepLinking];if(e.includes(o))return r.SfB;if(t.includes(o))return r.Teams;n.warn(`getUserChatMode - unknown coExistenceMode ${a[o]}`)}else e.isShortProfile||n.warn(`getUserChatMode - full profile has no coExistenceMode for mri ${e.mri}`)})(e,t,n);if(c)return c;const u=M(e.mri),p=e.isSkypeTeamsUser,m=(e=>!(!e.isFederated&&void 0!==e.isPrivateChatEnabled)||e.isPrivateChatEnabled)(e);return n.log(`getUserChatMode - caller: ${t}, mri: ${e.mri}, isSfbMri: ${u}, isTeamsChatEnabled: ${m}, hasLoggedInToTeams: ${p}, isSipDisabled: ${e.isSipDisabled}, isSfBEligible: ${i}`),!u&&p&&m||e.isSipDisabled||!i?r.Teams:r.SfB}},923270:(e,t,n)=>{"use strict";n.d(t,{L:()=>i,R:()=>a});const i="vdi-occlusion",a={Rectangular:"vdi-occlusion",Popover:"popover",Circle:"vdi-circle-occlusion",Dynamic:"vdi-dynamic-occlusion",Donut:{Parent:"vdi-donut-occlusion",Child:"vdi-donut-child-occlusion"},Frame:"vdi-frame-occlusion"}},816037:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});const i=e=>{const{ApiVersion:t,EntityAnnotation:n,TraceId:i,ClientRequestId:a}=e,{SectionMatches:r}=n;return{apiVersion:t,entityAnnotation:{sectionMatches:r.map((e=>{const{EntityMatches:t,SectionId:n}=e;return{entityMatches:t.map((e=>{const{Entities:t,HighlightedName:n,Length:i,StartPos:a,OccurrenceIndex:r,TotalOccurrences:o,Relevance:l}=e;return{entities:t.map((e=>{const{DisplayName:t,Id:n,RelevanceScore:i,Source:a,Type:r}=e;return{displayName:t,id:n,relevanceScore:i,source:a,type:r}})),highlightedName:n,length:i,startPos:a,occurrenceIndex:r,totalOccurrences:o,relevance:{annotationScore:l.AnnotationScore}}})),sectionId:n}}))},traceId:i,clientRequestId:a}}}}]);