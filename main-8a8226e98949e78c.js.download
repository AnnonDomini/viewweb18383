(()=>{var e,t,i,n,a,s,o,r,c,l={454809:(e,t,i)=>{"use strict";i.d(t,{c:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"recordAppUsage"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recordAppUsage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appsUsageFields"}}]}}]}},...i(103360).o.definitions]}},387586:(e,t,i)=>{"use strict";i.d(t,{vb:()=>s,c6:()=>o});var n=i(265858);const a=n.createContext(""),s=n.memo((e=>{const{children:t,joinId:i}=e;return n.createElement(a.Provider,{value:i},t)})),o=()=>n.useContext(a);s.displayName="JoinContext"},523635:(e,t,i)=>{"use strict";i.d(t,{Bb:()=>s,YD:()=>o,_T:()=>r,l0:()=>c});var n=i(516909);const a={producer:n.tf6.Producer,contributor:n.tf6.Contributor,attendee:n.tf6.Attendee},s=e=>void 0===e||null==e?n.tf6.None:a[e.toLowerCase()]?a[e.toLowerCase()]:n.tf6.None,o=(e,t)=>!!(t&&t.indexOf(e)>=0),r=(e=!1,t)=>!!t.find((e=>e.streamStatuses.main.isAvailable))||e,c=(e,t,i,n)=>{if(!(e&&t&&i&&n))return"";return[e,t,i,n].join("__")}},46845:(e,t,i)=>{"use strict";i.d(t,{l:()=>u,S:()=>r});var n=i(782243),a=i(697337);const s="ðŸ“· GIF",o=e=>!!e&&e.split("giphy.com").length>1;function r(e,t){(0,n.addHook)("uponSanitizeElement",l),(0,n.addHook)("uponSanitizeElement",c),t&&(0,n.addHook)("uponSanitizeElement",d);const i=(0,n.sanitize)(e,{ALLOWED_TAGS:[]});return(0,n.removeHooks)("uponSanitizeElement"),i}function c(e){"BR"===e.tagName&&e.replaceWith(" ")}function l(e){"BLOCKQUOTE"===e.tagName&&e.remove()}function d(e){var t;if("IMG"!==e.tagName)return;const i=null!==(t=e.getAttribute("src"))&&void 0!==t?t:"";if(o(i))return void e.replaceWith(s);const n=e.getAttribute("alt");if(!n)return;switch(e.getAttribute("itemtype")){case a.T.emoji:e.replaceWith(n);break;case a.T.customEmoji:e.replaceWith(`(${n})`)}}function u(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')}},927168:(e,t,i)=>{"use strict";i.d(t,{i:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"newChatIntentId"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"newChatIntentId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}]}]}}]}},289931:(e,t,i)=>{"use strict";i.d(t,{i1:()=>n,t3:()=>r,tT:()=>c,BN:()=>l,vc:()=>d});var n,a=i(814423),s=i(50805),o=i(500396);function r(e){const{allowUserChat:t,messagingPolicy:i}=e;return"boolean"==typeof t||!!i?t?n.Enabled:n.Disabled:n.Unknown}function c(){const e=(0,a.NC)(s.J.Messaging);return e.enableComposeDisabledBasedOnPolicy?r(e):n.Enabled}function l(e){const t=c();return e===o.k2.Meeting||e===o.k2.Channel?n.Enabled:t}function d(e,t){const i=l(e),{enablePinMessageToChat:o}=(0,a.NC)(s.J.Messaging);return t&&!!o&&i!==n.Disabled}!function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.Unknown="Unknown"}(n||(n={}))},842422:(e,t,i)=>{"use strict";i.d(t,{Id:()=>a,yx:()=>o,Cs:()=>r});var n=i(265858);const a={isCallModeStreaming:()=>!1,isFullScreenButtonDisabled:()=>!1,isInEmbedContext:()=>!1,isTestUser:()=>!1,getCallId:()=>{},getCorrelationId:()=>"",getForceAttendeeStreaming:()=>{},getEnablePlayerControlsForStreamingMode:()=>{},getParticipantId:()=>{},getStreamDetails:()=>{},getStreamingMode:()=>!1,getTelemetryData:()=>{},getThreadId:()=>"",getUiLanguagePreference:()=>{},getCallMode:()=>{},getMeetingRole:()=>{},setFullScreenButton:()=>{},setStreamDetails:()=>{},sendConveneError:()=>{},sendDataLoadError:()=>{},sendHeartbeat:()=>{},sendMetadata:()=>{},sendData:()=>{},sendServerError:()=>{},createBroadcastEndEventListener:()=>{},createCallDataUpdateEventListener:()=>{},createStreamUpdateEventListener:()=>{},createCaptionsToggleEventListener:()=>{},destroyCaptionsToggleEventListener:()=>{},createSubtitleTrackChangeEventListener:()=>{},destroySubtitleTrackChangeEventListener:()=>{},destroyBroadcastEndEventListener:()=>{},destroyCallDataUpdateEventListener:()=>{},destroyStreamUpdateEventListener:()=>{},sendReadyToRecieveBroadcastEndNotification:()=>{},sendReadyToRecieveCallDataUpdateNotification:()=>{},sendReadyToRecieveStreamUpdatesNotification:()=>{},validateEmbedStreamDetailsArray:()=>({isSuccessful:!0})},s=n.createContext(null),o=n.memo((e=>{const{conveneHostMessaging:t,children:i}=e,o={conveneHostMessaging:t||Object.assign({},a)};return n.createElement(s.Provider,{value:o},i)}));o.displayName="ConveneHostMessagingContextProvider";const r=()=>n.useContext(s)},916553:(e,t,i)=>{"use strict";i.d(t,{H:()=>n});class n{constructor(){this.registerAppPhase=({phase:e,signals:t,timeout:i})=>{const n=this._phasesMap.get(e);this._phasesMap.set(e,Object.assign(Object.assign({},n),{signals:t,timeout:i}))},this._phasesMap=new Map}get appPhases(){return{phases:this._phasesMap}}}},208569:(e,t,i)=>{"use strict";i.d(t,{c:()=>n});const n=e=>t=>t.reduce(((t,i)=>(t[i]=e[i],t)),{})},356088:(e,t,i)=>{"use strict";i.d(t,{FU:()=>n,ZG:()=>s});var n,a=i(419925);!function(e){e.DEFAULT="default",e.HEADER_AT_BOTTOM="header_at_bottom",e.HYER="hyer"}(n||(n={}));class s{constructor({layoutKey:e=n.DEFAULT,layoutMode:t,layoutTemplatesPerLayoutMode:i}){var s;this.getTemplate=({layoutKey:e=n.DEFAULT,layoutMode:t,slots:i,slotsDimensionsOverrides:a={}})=>{const s=this._layoutTemplates[t][this._getKeyFromSlotNameArray(e,i)];return"function"==typeof s?s(a):s},this._getKeyFromSlotNameArray=(e=n.DEFAULT,t)=>[e,...[...t].sort()].join("-"),this._layoutTemplates={[a.lO.focus]:{},[a.lO.minimal]:{},[a.lO.standard]:{},[a.lO.minimode]:{}},null===(s=i[t])||void 0===s||s.forEach((i=>{(i.layoutKey||n.DEFAULT)===e&&this._registerTemplates(Object.assign({layoutMode:t},i))}))}_registerTemplates({layoutKey:e=n.DEFAULT,layoutMode:t,responsiveTemplates:i,slots:a}){const s=this._getKeyFromSlotNameArray(e,a);if(void 0!==this._layoutTemplates[t][s])throw new Error(`You can't have two templates with same slots for same layoutMode, slots: ${s} layoutMode: ${t}`);this._layoutTemplates[t][s]="function"==typeof i?i:()=>i}}},347601:(e,t,i)=>{"use strict";i.d(t,{Z:()=>g});var n,a=i(850402),s=i(318198),o=i(265858),r=i(952445),c=i(905581),l=i(132756),d=i(332507),u=i(738646);null===(n=null===performance||void 0===performance?void 0:performance.mark)||void 0===n||n.call(performance,"resolve-main-imports-end");const m=()=>Promise.all([i.e(958828),i.e(247364),i.e(923731),i.e(244738),i.e(428421),i.e(814199),i.e(446977),i.e(395303),i.e(873428),i.e(236315),i.e(189185),i.e(193183),i.e(153907),i.e(92464),i.e(680562),i.e(888923),i.e(579735),i.e(498871),i.e(939110),i.e(127919),i.e(511576),i.e(910360),i.e(802054)]).then(i.bind(i,62201));class g{constructor(e){this._activationOptions=e,this._mounted=!1,this._logger=this._activationOptions.coreServices.loggerFactory.newLogger("CoreReactRenderer","components-core-layout")}activate(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){this.deactivate();try{return this._activateRoot()}catch(e){const t=(0,c.Tr)("Experience",l.jK.Undefined,"activate",e);return this._logger.errorToTelemetry&&this._logger.errorToTelemetry(t.message,"webclient_framework_foundation_components_core_react_renderer",void 0,!0),this._activationOptions.coreServices.errorState.error=t,Promise.reject(t)}}))}deactivate(){this._mounted&&(s.unmountComponentAtNode(this._activationOptions.rootElement),this._mounted=!1)}_activateRoot(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{window:t,rootElement:i,coreServices:{altScenarioService:n,scenarioFactory:a}}=this._activationOptions,{RootRenderer:c}=yield(0,d.mT)(m,"core-essentials",a);return null===(e=null==n?void 0:n.altScenario)||void 0===e||e.mark(u.ck.CoreEssentialsChunkLoad),new Promise((e=>{s.render(o.createElement(c,Object.assign({},this._activationOptions)),i,(()=>{this._mounted=!0,t&&(0,r.rx)(t.document,i),e()}))}))}))}}},952445:(e,t,i)=>{"use strict";i.d(t,{rx:()=>n});const n=(e,t)=>{((e,t)=>{const i=e.getElementById("splash-screen");i&&(i.setAttribute("aria-hidden","true"),e.body.removeChild(i),t&&(t.style.display="block"))})(e,t),(e=>{const t=e.getElementsByClassName("preload-title-bar-trim")[0];t&&e.body.removeChild(t)})(e)}},437210:(e,t,i)=>{"use strict";i.d(t,{o:()=>f});var n=i(850402),a=i(50805),s=i(332507),o=i(929778),r=i(347601),c=i(265858),l=i(318198),d=i(827748),u=i(143384);const m=()=>c.createElement(u.e,{client:{}},c.createElement("div",null));class g extends c.PureComponent{constructor(){super(...arguments),this.divRef=c.createRef(),this.siblingEl=c.createRef()}componentDidMount(){const{document:e}=this.props.mainWindow,t=e.createElement("div");this.divRef.current&&(this.divRef.current.appendChild(t),t.dispatchEvent(new MouseEvent("mouseout",{bubbles:!0,cancelable:!0,relatedTarget:this.siblingEl.current})))}render(){return c.createElement("div",{ref:this.divRef},c.createElement("div",{ref:this.siblingEl,onMouseEnter:()=>{}}))}}class h extends c.PureComponent{constructor(){super(...arguments),this.state={mounted:!1}}componentDidMount(){this.setState({mounted:!0})}render(){return c.createElement("div",null)}}const p=e=>{(e=>{e.document.body.dispatchEvent(new MouseEvent("click",{bubbles:!0}))})(e)};var v=i(738646);const f=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const s=yield b(t);return e.pipe((0,o.j)((({id:e,window:n,context$:a})=>((e,t,i,n,a,s)=>{if(!e)return null;const o=e.document.getElementById("app");if(!o){const e=a.loggerFactory.newLogger("entry","components-core-layout");return e.errorToTelemetry&&e.errorToTelemetry("element with ID 'app' not found on the document.","webclient_framework_foundation_components_render_windows",void 0,!0),null}a.scenarioFactory.startStep(v.RG.ExperienceReady,v.ck.RenderProviders);const c=new r.Z({context$:t,coreServices:a,getExperienceProps:i,reactDiagnosticsService:s,rootElement:o,windowId:n,window:e});return c.activate(),{coreRenderer:c,host:e,windowId:n}})(n,a,i,e,t,s)),(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(!e)return;const{host:i,coreRenderer:s,windowId:o}=e;p(i),s.deactivate();const r=t.windowProvider;yield(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.document,i=t.body,n=t.createElement("div");n.setAttribute("id","memory-cleanup");const a=i.appendChild(n);yield(0,d._)(0),l.render(c.createElement(c.Fragment,null,c.createElement(m,null),c.createElement(g,{mainWindow:e}),c.createElement(h,null)),a),l.unmountComponentAtNode(a),i.removeChild(a)})))(r);const{dataCleanupService:u,dataEvictionService:v,coreSettings:f}=t;u.markDataForWindowAsInactive(o);const{enableSingleApolloCoreCache:b}=f.get(a.J.Core);b&&(null==v||v.evict())}))),(({id:e})=>e))).subscribe()})),b=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{enableReactDiagnostics:t,enableReactDiagnosticsConsoleLog:n,enableReactDiagnosticsDisplayNameFix:o}=e.coreSettings.get(a.J.Diagnostics);if(t)try{const{initReactDiagnostics:t,ReactDiagnosticsService:a}=yield(0,s.mT)((()=>Promise.all([i.e(680562),i.e(887171),i.e(127919),i.e(582271)]).then(i.bind(i,588746))),"react-diagnostics",e.scenarioFactory),r=new a(!!n,!!o);return t(r),r}catch(t){const i=e.loggerFactory.newLogger("react-diagnostics","components-core-layout");i.errorToTelemetry&&i.errorToTelemetry(`Failed to load react-diagnostic ${t}`,"webclient_framework_foundation_components_render_windows",void 0,!0)}}))},143012:(e,t,i)=>{"use strict";i.d(t,{pQ:()=>d,ei:()=>u,JW:()=>m,Pq:()=>g,PO:()=>h,ox:()=>p,Jj:()=>v});var n=i(956255),a=i(419925),s=i(955105),o=i(554404),r=i(549571),c=i(738646);const l="_djb2_msteams_prefix_",d="tab::",u=2,m=(e,t)=>(null==t?void 0:t.startsWith(l))?t:`${l}${(0,r.E)(`${e}:${null==t?void 0:t.replace(/\+/g," ")}`)}`,g=(e,t,i,r,c,l,d,u,m,g,h)=>{var p,v;return{entity:{type:n.py.extensions,id:JSON.stringify({appId:e,tabEntityId:l,subEntityId:u}),action:n.uk.view},command:{visibilityState:null!==(p=null==d?void 0:d.visibilityState)&&void 0!==p?p:a.fe.show,stateTransition:t?a.su.new:null!==(v=null==d?void 0:d.stateTransition)&&void 0!==v?v:a.su.flush,correlation:{source:null!=c?c:s.D.Unknown,startTimestamp:Date.now()}},entityOptions:{entryPoint:r?o.mQ.activityFeed:o.mQ.personalApp,isMultiWindow:t,subEntityId:u,isAppSelected:m,source:c,originalDeeplink:g||void 0,reloadTrigger:i,isFromActivityFeed:r,skipAppCacheRemoveOnReload:h}}},h=(e,t,i,r,c,l,d)=>{var u,g;return{entity:{type:n.py.extensions,id:JSON.stringify({appId:t,threadId:i||r,tabId:null,tabEntityId:m(t,c)}),action:n.uk.view,linkedEntity:{id:i?JSON.stringify({channelId:i}):r,type:i?n.py.channels:n.py.chats,action:n.uk.view}},command:{visibilityState:null!==(u=null==l?void 0:l.visibilityState)&&void 0!==u?u:a.fe.show,stateTransition:null!==(g=null==l?void 0:l.stateTransition)&&void 0!==g?g:a.su.forceFlush,correlation:{source:s.D.PlatformTabDeepLink,startTimestamp:Date.now()}},entityOptions:{entryPoint:i?o.mQ.channelTab:o.mQ.chatTab,source:s.D.PlatformTabDeepLink,subEntityId:d,originalDeeplink:e}}},p={files:"files",photos:"photos",attendancereport:"attendancereport",recordingsandtranscripts:"recordingsandtranscripts",recap:"recap",breakoutrooms:"breakoutrooms",coachReport:"coachReport"},v=(e,t,i,r,l,d,u)=>{var m,g;null===(m=null==u?void 0:u.findScenario(c.RG.PlatformTabDeeplinkHandling))||void 0===m||m.cancel();const h=null==u?void 0:u.newScenario(c.RG.PlatformTabDeeplinkHandling);h&&(null===(g=null==u?void 0:u.hoistScenarioToCore)||void 0===g||g.call(u,h)),null==h||h.appendEventData({"PlatformTabDeeplink.pathname":i.pathname,"PlatformTabDeeplink.search":i.search}),null==h||h.mark("create_deeplink_command");const v="files"===d,f=(e=>{switch(e){case p.files:return n.py.file;case p.photos:return n.py.gallery;case p.attendancereport:return n.py.meetinganalytics;case p.recordingsandtranscripts:return n.py.transcriptcontent;case p.recap:return n.py.meetingrecap;case p.breakoutrooms:return n.py.breakoutrooms;case p.coachReport:return n.py.coachreport;default:return n.py.extensions}})(d),b={entityCommand:{entity:{type:f,action:v?n.uk.list:n.uk.view,id:f===n.py.extensions?JSON.stringify({appId:null,threadId:e||t,tabId:d,tabEntityId:null}):null,linkedEntity:{id:e?JSON.stringify({channelId:e}):t,type:e?n.py.channels:n.py.chats,action:n.uk.view}},command:{visibilityState:a.fe.show,stateTransition:a.su.flow},entityOptions:Object.assign({subEntityId:null==l?void 0:l.subEntityId,entryPoint:e?o.mQ.channelTab:o.mQ.chatTab,source:s.D.PlatformTabDeepLink,deeplinkStartedTime:Date.now(),originalDeeplink:i},f===n.py.coachreport&&{threadId:t})},metadata:{allowAnonymous:!1,tenantId:r}};return null==h||h.mark("return_deeplink_command"),null==h||h.appendEventData({"PlatformTabDeeplink.generatedCommand":b.toString()}),Promise.resolve(b)}},548996:(e,t,i)=>{"use strict";i.d(t,{W8:()=>n,xT:()=>a,fk:()=>s});const n=e=>{const{removeUrl:t,contentUrl:i,websiteUrl:n,entityId:a,baseInfo:s}=e||{};return{removeUrl:t||void 0,contentUrl:i||"",websiteUrl:n||void 0,entityId:a||void 0,suggestedDisplayName:(null==s?void 0:s.displayName)||void 0}},a=(e,t,i)=>{var n,a,s,o;const r=e=>e&&String(e);let c;return c=i?{contentUrl:r(e.contentUrl)||(null==t?void 0:t.contentUrl)||"",websiteUrl:null!==(n=r(e.websiteUrl))&&void 0!==n?n:null==t?void 0:t.websiteUrl}:{contentUrl:r(e.contentUrl)||(null==t?void 0:t.contentUrl)||"",removeUrl:null!==(a=r(e.removeUrl))&&void 0!==a?a:null==t?void 0:t.removeUrl,websiteUrl:null!==(s=r(e.websiteUrl))&&void 0!==s?s:null==t?void 0:t.websiteUrl,entityId:null!==(o=r(e.entityId))&&void 0!==o?o:null==t?void 0:t.entityId,suggestedDisplayName:r(e.suggestedDisplayName)||(null==t?void 0:t.suggestedDisplayName)},c},s=(e,t,i,n,a,s)=>{if(i)return e.log("app is not supported because appId not found in the current thread"),i;const o=null==n?void 0:n.includes(t);if(o)return e.log("app is not supported because appId is found in the disabledTabAppIds blocklist"),o;if(t&&a){const i=a.includes(t);if(s){if(!i)return e.log("app is not supported because appId is not present in the appIdlist whitelist"),!i}else if(i)return e.log("app is not supported because appId is  present in the appIdlist blocklist"),i}return!1}},426762:(e,t,i)=>{"use strict";i.d(t,{UN:()=>g,Te:()=>h});var n=i(265858),a=i(554694),s=i(363592),o=i(979176),r=i(365076);const c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsWebFloatingMonitorNavigateToCallScreenMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"navigateToCallScreen"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamsCallId"},value:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}}}]}]}}]};var l;!function(e){e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden",e[e.Closed=2]="Closed"}(l||(l={}));const d=[l.Hidden,l.Visible],u=n.createContext({setIntentIdOverride:()=>{},mounted:()=>{},hide:()=>Promise.resolve(),unhide:()=>Promise.resolve(),close:()=>Promise.resolve(),showCallWindow:()=>Promise.resolve()}),m=new Map,g=e=>{const t=(0,s.JQ)(),i=(0,r.x)(),[g,h]=n.useState(e.intentIdOverride),p=n.useCallback((()=>{const e=Array.from(m.values());return 0===e.length?l.Closed:e.includes(l.Visible)?l.Visible:l.Hidden}),[]),v=n.useCallback(((e,t)=>(t in d?m.set(e,t):m.delete(e),p())),[p]),f=n.useCallback((e=>{switch(e){case l.Visible:return t.generateEvent({event:o.U3.unhideMonitor()});case l.Hidden:return t.generateEvent({event:o.U3.hideMonitor()});case l.Closed:return t.generateEvent({event:o.U3.closeMonitor()})}}),[t]),b=n.useCallback((e=>{m.get(e)!==l.Hidden&&v(e,l.Visible)}),[v]),y=n.useCallback(((e,t)=>{const i=p(),n=v(e,t);return i!==n?f(n):Promise.resolve()}),[v,p,f]),k=n.useCallback((e=>y(e,l.Hidden)),[y]),S=n.useCallback((e=>y(e,l.Visible)),[y]),w=n.useCallback((e=>y(e,l.Closed)),[y]),j=(0,a.w)("WebFloatingMonitorContextProvider"),C=n.useCallback((e=>null==i?void 0:i.mutate({mutation:c,variables:{teamsCallId:e}}).then((e=>{var t;(null===(t=e.data)||void 0===t?void 0:t.navigateToCallScreen)||j.error("Failed to navigate to call screen via navigateToCallScreen mutation")})).catch((e=>j.error(`Failed to navigate to call screen via navigateToCallScreen mutation: ${e.message}`)))),[i,j]),_=n.useMemo((()=>({intentIdOverride:g,setIntentIdOverride:h,mounted:b,hide:k,unhide:S,close:w,showCallWindow:C})),[g,b,k,S,w,C]);return n.createElement(u.Provider,{value:_},e.children)},h=()=>n.useContext(u)},165690:(e,t,i)=>{"use strict";i.d(t,{Hj:()=>o,_u:()=>c,Rb:()=>l,Bw:()=>d,fg:()=>u,tO:()=>m,Xf:()=>h,iG:()=>p,A4:()=>v});var n=i(118418),a=i(466149);const s=[a.Tk.Transferring,a.Tk.TransferFailed,a.Tk.TransferSucceeded],o=e=>s.includes(e),r=[a.Tk.Parking,a.Tk.ParkFailed,a.Tk.ParkSucceeded],c=e=>r.includes(e),l=e=>(e=>e===n.OX.LocalHold)(e)||(e=>e===n.OX.RemoteHold)(e),d=e=>e===n.OX.Disconnected,u=e=>!(!e||e!==n.Fz.Park),m=(e,t)=>e===n.OX.Observing&&t,g=[n.OX.Notified,n.OX.EarlyMedia,n.OX.None],h=e=>!(v(e)||g.includes(e.state))||o(e.extendedCallState)||c(e.extendedCallState),p=[n.OX.Connected,n.OX.Connecting,n.OX.Staging],v=e=>p.includes(e.state)},703793:(e,t,i)=>{"use strict";i.d(t,{N:()=>r});var n=i(850402),a=i(186921);let s;class o{constructor(e){this.serializeCacheKey=e=>{var t;const{typeName:i,user:n,key:a}=e;return`tmp.auth.v1.${null!==(t=null==n?void 0:n.id)&&void 0!==t?t:"GLOBAL"}.${i}.${a?a.toUpperCase():i}`},this._indexedDbProvider=e}getValue(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const t=this.serializeCacheKey(e);return yield this._indexedDbProvider.getValue(t)}catch(e){return void a.q.log(`getValue:${e}`)}}))}put(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const i=this.serializeCacheKey(e);return yield this._indexedDbProvider.put(i,t),!0}catch(e){return a.q.log(`put:${e}`),!1}}))}del(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const t=this.serializeCacheKey(e);return yield this._indexedDbProvider.del(t),!0}catch(e){return a.q.log(`delete:${e}`),!1}}))}}const r=e=>s||(s=new o(e),s)},535059:(e,t,i)=>{"use strict";i.d(t,{zF:()=>p,db:()=>v,l_:()=>f,o8:()=>b,mM:()=>y,kh:()=>k,lj:()=>S,BZ:()=>w,VT:()=>j});var n=i(850402),a=i(466094),s=i(765053),o=i(278593),r=i(588470),c=i(136613),l=i(804589),d=i(186921),u=i(928665),m=i(942209),g=i(206083),h=i(959078);const p=(e,t)=>{let i;if(t){const n=r.Jt.getAllOfType("User").filter((e=>e.profile.tid===t&&e.type!==a.Ch.Anonymous));if(n.length>1){const t=r.Jt.getValue(c.Jl.globalUser);if(i=!!e&&n.find((t=>t.id===e))||n.find((e=>e.id===t.id)),i)return i;throw{message:"Multiple users found in cache with same tenantId",errorCode:l.SM.MultipleUsersPresentWithSpecifiedIdentifier}}return n[0]}if(e){const t=r.Jt.getAllOfType("User");i=null==t?void 0:t.filter((t=>t.id===e))[0]}else i=r.Jt.getValue(c.Jl.globalUser);return i},v=e=>{if(!e)return[];return r.Jt.getAllOfType("User").filter((t=>t.id!==e&&t.homeAccountId===e))||[]},f=(e,t)=>{if(!e||!t)return;return v(e).find((e=>e.profile.tid===t))},b=(e,t)=>{if(!e||!t)return!1;return e.some((e=>e.cloud!==t&&!e.id.startsWith("dummy-user")))},y=(e,t,i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){null==i||i.addScenarioMark("auth_get_encryption_key_start");const n=r.Jt.getValue(c.Jl.encryptionKey);if("object"==typeof n)return null==i||i.addScenarioMark("auth_get_encryption_key_stop"),n;let o,l;null==i||i.addScenarioMark("auth_get_exported_key_start");try{if(a&&(0,g.n)(e)){const e=yield t.loadModule(s.nM.Auth);o=(yield e.acquireEncryptionKey({correlationId:(null==i?void 0:i.correlation.id)||(0,u.pW)()})).result}else{const e=r.Jt.getValue(c.Jl.exportedEncryptionKey);o=null==e?void 0:e.exportedKey}}catch(e){return null==i||i.addScenarioMark("auth_get_exported_key_stop",{error:e,reason:"Acquiring the exported key failed."},"failure"),null==i||i.addScenarioMark("auth_get_encryption_key_stop"),null}if(!o)return null==i||i.addScenarioMark("auth_get_exported_key_stop",{reason:"No exported encryption key."}),void(null==i||i.addScenarioMark("auth_get_encryption_key_stop"));try{l=yield e.crypto.subtle.importKey("raw",(0,m.k)(o),{name:"AES-CBC"},!0,["encrypt","decrypt"]),r.Jt.put(c.Jl.encryptionKey,l),null==i||i.addScenarioMark("auth_get_exported_key_stop")}catch(e){null==i||i.addScenarioMark("auth_get_exported_key_stop",{error:e,reason:"Importing the key failed"},"failure"),l=null}return null==i||i.addScenarioMark("auth_get_encryption_key_stop"),l})),k=(e,t,i)=>{const n=a.JE[o.j[e]],s=p(t,void 0);if(!s)return void d.q.warn(`[AuthState] Account ${t} not found when attempting to write userAuthState`);const l=(0,h.Xx)(s),m=(0,u.u4)(null==i?void 0:i.reason)||n;r.Jt.put((0,c.VF)(l).userAuthState,{state:n,reason:m,customError:i?{errorCode:i.errorCode||i.code,message:i.message,isExpected:i.isExpected,context:i.context,subContext:i.subContext,correlationId:i.correlationId}:null}),i?d.q.warn(`[AuthState] UserAuthState updated - ${t} : ${n} errorCode: ${i.errorCode} isExpected: ${i.isExpected} correlationId: ${i.correlationId}`):d.q.log(`[AuthState] UserAuthState updated - ${t} : ${n}`)},S=()=>r.Jt.getValue(c.Jl.logoutState),w=()=>r.Jt.getValue(c.Jl.previousSignInProgressState),j=()=>r.Jt.del(c.Jl.previousSignInProgressState)},588470:(e,t,i)=>{"use strict";i.d(t,{Jt:()=>u,ky:()=>b});var n=i(850402),a=i(804589),s=i(186921),o=i(928665),r=i(959078),c=i(136613);const l=[a.aw,a.ZU,a.Fz],d={KeyVersion:"v1",UseAccountIdKey:!0};let u;const m=e=>d.UseAccountIdKey?(null==e?void 0:e.id)||"":e?JSON.stringify({tenantId:e.tenantId,oid:e.oid,accountType:e.accountType,userName:e.userName}):JSON.stringify(void 0),g=(e,t,i)=>`tmp.auth.${d.KeyVersion}.${e}.${t}.${i}`,h=e=>{const{typeName:t,user:i}=e;return{user:e.user?m(i):"GLOBAL",typeName:t,key:e.key?e.key.toUpperCase():t}},p=(e,t)=>({storageKey:d.UseAccountIdKey?g(t.user,t.typeName,t.key):`$[${t.user}][${t.typeName}][${t.key}]`,loggingKey:g(e.user?`${e.user.id}`:t.user,t.typeName,t.key)});class v{constructor(e){this._expireOffsetSeconds=a.rF.SECONDS_FIVE_MINUTES,this._expireOffsetSecondsMin=a.rF.SECONDS_PER_MINUTE,this.internalCache={GLOBAL:{User:{},Token:{},MsalAccount:{}}},this._initializeCacheForCacheItem=(e,t)=>{void 0===this.internalCache[t]?(this.internalCache[t]={},this.internalCache[t][e]={}):void 0===this.internalCache[t][e]&&(this.internalCache[t][e]={})},this._addToExternalCache=(e,t)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){let i=t;t.item.encryptedToken&&(i=this._deepCopyEncryptedToken(t));const n=h(e),{storageKey:a,loggingKey:r}=p(e,n);try{this._storage.setItem(a,(0,o.u4)(i))}catch(e){s.q.error(`error in putting key [${r}] in storage, error - [${(0,o.VK)(e)}]`)}})),this._deepCopyEncryptedToken=e=>{const t=e.item,i=Object.assign({},t);return i.skypeToken?i.skypeToken="":i.token="",{item:i,hitCount:e.hitCount,shouldRefresh:e.shouldRefresh}},this._deleteFromExternalCache=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=h(e),{storageKey:i,loggingKey:n}=p(e,t);try{this._storage.removeItem(i)}catch(e){s.q.error(`error in deleting key [${n}] in storage, error - [${(0,o.VK)(e)}]`)}})),this._flushExternalCache=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const t={};Object.keys(this._storage).forEach((i=>{l.forEach((e=>{if(-1!==i.indexOf(e)){const e=this._storage.getItem(i);e&&(t[i]=e)}})),(!e&&0===i.indexOf("$[")||!e&&0===i.indexOf("tmp.auth")||e&&(-1!==i.indexOf(e.oid)||e.id&&-1!==i.indexOf(e.id)))&&this._storage.removeItem(i)})),Object.keys(t).forEach((e=>{this._storage.setItem(e,t[e])}))}catch(e){s.q.error(`error in clearing storage, error - [${(0,o.VK)(e)}]`)}})),this._isGlobalUser=e=>{var t,i;let n=null===(i=null===(t=this.internalCache.GLOBAL)||void 0===t?void 0:t.User)||void 0===i?void 0:i.User;return n||(n=this.get(c.Jl.globalUser)),n&&(0,r.FG)((0,r.Xx)(n.item),e)},this._putGlobalUserInCache=(e,t)=>{var i,n;if((null===(n=null===(i=this.internalCache.GLOBAL)||void 0===i?void 0:i.User)||void 0===n?void 0:n.User)&&e.user&&!this._isGlobalUser(e.user))return;const a=e.user?"GLOBAL":m((0,r.Xx)(t.item));this._initializeCacheForCacheItem("User",a),this.internalCache[a].User.User=t;const s=d.UseAccountIdKey?g(a,"User","User"):`$[${a}][User][User]`;this._storage.setItem(s,JSON.stringify(t))},this._validateValue=(e,t)=>{var i,n;if(!("Token"!==e.typeName||"object"==typeof t&&t.token&&t.expires))throw new Error("Invalid value for Token.");if(!("Discover"!==e.typeName||e.key!==a.rz||"object"==typeof t&&t.skypeToken&&t.expiration))throw new Error("Invalid value for Skype token.");if("User"!==e.typeName)return;const s=t;if(!(s.userName&&s.type&&s.role&&s.profile&&void 0!==s.isAuthenticated))throw new Error(`Invalid value for user. userName exists: [${!!s.userName}], type: [${s.type}], role: [${s.role}], profile exists: [${!!s.profile}],isAuthenticated: [${s.isAuthenticated}]`);const o=null===(n=null===(i=this.internalCache.GLOBAL)||void 0===i?void 0:i.User)||void 0===n?void 0:n.User,c=(0,r.Xx)(s);if(o&&!e.user&&!this._isGlobalUser(c))throw new Error("there is already global user in auth cache")},this._storage=e.localStorage,s.q.info("auth_cache initialized")}updateSetting(e,t){s.q.log(`Updating authCache setting ${e} from ${d[e]} to ${t}.`),"KeyVersion"===e&&(t!==d.KeyVersion&&(this.internalCache={}),d.KeyVersion=t),"UseAccountIdKey"===e&&(t!==d.UseAccountIdKey&&(this.internalCache={}),d.UseAccountIdKey=t)}setExpiryOffset(e,t){e&&(this._expireOffsetSeconds=e),t&&(this._expireOffsetSecondsMin=t)}put(e,t){var i,n;f(e),this._validateValue(e,t);const{typeName:a,key:s,user:o}=h(e);("Token"===a||"Discover"===a&&"SKYPE-TOKEN"===s)&&(t.fromCache=!0);let r=null===(n=null===(i=this.internalCache[o])||void 0===i?void 0:i[a])||void 0===n?void 0:n[s];return r?(r.hitCount=0,r.item=t):r={item:t,shouldRefresh:!1,hitCount:0},"User"===a&&this._putGlobalUserInCache(e,r),this._initializeCacheForCacheItem(a,o),this.internalCache[o][a][s]=r,this._addToExternalCache(e,r),!0}updateGlobalUser(e){const t="GLOBAL",i={item:e,shouldRefresh:!1,hitCount:0};return this._initializeCacheForCacheItem("User",t),this.internalCache[t].User.User=i,this._addToExternalCache(c.Jl.globalUser,i),!0}get(e){var t,i,n;f(e);const a=h(e),{storageKey:r,loggingKey:c}=p(e,a),{typeName:l,key:d,user:u}=a;let m=null===(i=null===(t=this.internalCache[u])||void 0===t?void 0:t[l])||void 0===i?void 0:i[d];const g=!!m;if(!m)try{const e=null===(n=this._storage)||void 0===n?void 0:n.getItem(r);e&&(m=JSON.parse(e))}catch(e){s.q.error(`value for key [${c}] throw error. ${(0,o.VK)(e)}`)}if(m)return this._initializeCacheForCacheItem(l,u),this.internalCache[u][l][d]=m,("Token"===l||"Discover"===l&&"SKYPE-TOKEN"===d)&&(m.shouldRefresh=this._shouldRefresh(m.item,l),m.hitCount++,this.internalCache[u][l][d]=m,this._addToExternalCache(e,m)),void 0===m.shouldRefresh?(s.q.info(`cacheItem '[${r}]' need to refresh`),void this.del(e)):(s.q.info(`returning cacheItem '[${r}]' from cache. In memory:${+g} found: [${+!!m}]`),m);s.q.info(`value for key [${c}] not found in memory or storage`)}getValue(e){const t=this.get(e);return t?this._value(t):void 0}getAllOfType(e){const t=[],i=[];return Object.keys(this.internalCache).forEach((n=>{"GLOBAL"!==n&&Object.keys(this.internalCache[n][e]||{}).forEach((a=>{const{storageKey:s}=p({},{user:n,typeName:e,key:a});i.push(s),t.push(this.internalCache[n][e][a].item)}))})),Object.keys(this._storage).forEach((n=>{var a;if(-1===i.indexOf(n)&&-1===n.indexOf(".GLOBAL.")&&-1!==n.indexOf(`.${e}.`))try{const e=this._storage.getItem(n);e&&t.push(null===(a=JSON.parse(e))||void 0===a?void 0:a.item)}catch(e){s.q.error(`value for key [${n}] throw error. ${(0,o.VK)(e)}`)}})),t}del(e){var t,i,n,a;if(!e)return s.q.error(`Invalid cacheKey: ${e}`),!1;if(!e.typeName)return s.q.error(`Invalid cacheKey type: ${e.typeName}`),!1;if("User"===e.typeName)return this.flush(e.user),!0;const o=h(e),{loggingKey:r}=p(e,o),{typeName:c,key:l,user:d}=o;(null===(i=null===(t=this.internalCache[d])||void 0===t?void 0:t[c])||void 0===i?void 0:i[l])&&s.q.info(`Value of key: [${r}] exists before deletion]`);const u=(null===(a=null===(n=this.internalCache[d])||void 0===n?void 0:n[c])||void 0===a?void 0:a[l])&&delete this.internalCache[d][c][l],m=this._deleteFromExternalCache(e);return s.q.info(`deleted from local auth-cache. key: [${r}], done - local: [${u}], storage: [${m}]`),u}delTokensWithError(e,t){var i,n,a,s;const{user:o,typeName:r}=h({user:e,typeName:"Token"});if(null===(i=this.internalCache[o])||void 0===i?void 0:i[r]){const i=this.internalCache[o][r];for(const o in i)(null===(s=null===(a=null===(n=i[o])||void 0===n?void 0:n.item)||void 0===a?void 0:a.error)||void 0===s?void 0:s.errorCode)===t&&this.del({user:e,typeName:r,key:o})}}deleteType(e,t){var i;const{user:n,typeName:a}=h({user:e,typeName:t});if(null===(i=this.internalCache[n])||void 0===i?void 0:i[a]){let t;if("Token"===a)t=this.internalCache[n][a];else{if("Discover"!==a)return;t=this.internalCache[n][a]}for(const i in t)i&&this.del({user:e,typeName:a,key:i})}}flush(e){var t,i;if(!e){s.q.info("no user provided, flushing global user from cache");const n=null===(i=null===(t=this.internalCache.GLOBAL)||void 0===t?void 0:t.User)||void 0===i?void 0:i.User;if(!n)return;e=(0,r.Xx)(n.item)}s.q.info("flushing user data from cache");const n=m(e);this.internalCache[n]={},this._flushExternalCache(e),this._isGlobalUser(e)&&(this.internalCache.GLOBAL={},this._storage.removeItem("$[GLOBAL][User][User]"),this._storage.removeItem("tmp.auth.v1.GLOBAL.User.User")),s.q.info("flushing completed")}_value(e){return e.item}_shouldRefresh(e,t){const i="Token"===t?null==e?void 0:e.expires:null==e?void 0:e.expiration,n=Math.round(Date.now()/a.rF.MILLI_PER_SECOND);let s;if(s="Discover"===t?Math.round(i/a.rF.MILLI_PER_SECOND):"Token"===t?i:void 0,e&&s){const e=s-this._expireOffsetSeconds;if(n<=s-this._expireOffsetSecondsMin)return n>=e}}}const f=e=>{if(!(-1===["Token","Discover"].indexOf(e.typeName)||e.key&&e.user))throw new Error(`key/user cannot be empty for type [${e.typeName}]: key: ${e.key}, user: ${+!!e.user}`)},b=e=>{var t;return u||(u=new v(e),(null===(t=e.localStorage)||void 0===t?void 0:t.getItem("localDebug"))&&e.loader&&(e.loader.authCache=u),u)}},136613:(e,t,i)=>{"use strict";i.d(t,{VF:()=>a,px:()=>s,Jl:()=>o});var n=i(804589);const a=e=>({userDetail:{user:e,typeName:"Discover",key:"discover-user-details"},regionGtm:{user:e,typeName:"Discover",key:"discover-region-gtm"},skypeToken:{user:e,typeName:"Discover",key:"skype-token"},user:{user:e,typeName:"User"},tenants:{user:e,typeName:"Tenants"},loginValidation:{user:e,typeName:"LoginValidation"},userAuthState:{user:e,typeName:"UserAuthState"},meetingDetails:{user:e,typeName:"MeetingDetails"},telemetryInfo:{user:e,typeName:"TelemetryInfo"}}),s=(e,t,i)=>({user:e,typeName:"Token",key:`${t}${i?`-external-${i}`:""}`}),o={logoutState:{typeName:n.ZU},authSessionId:{typeName:n.Fz},globalUser:{typeName:"User"},primaryUserId:{typeName:"PrimaryUserId"},encryptionKey:{typeName:"EncryptionKey"},exportedEncryptionKey:{typeName:"ExportedEncryptionKey"},initializationVector:{typeName:"InitializationVector"},previousSignInProgressState:{typeName:"PreviousSignInProgressState"}}},608989:(e,t,i)=>{"use strict";i.d(t,{gA:()=>p,Zl:()=>v,fG:()=>f,MD:()=>b,SH:()=>y,Ri:()=>k,$R:()=>S,et:()=>w,Wh:()=>C,bO:()=>_});var n=i(466094),a=i(765053),s=i(738646),o=i(932289),r=i(7269),c=i(804589),l=i(186921),d=i(959078),u=i(928665),m=i(588470),g=i(136613),h=i(535059);const p=(e,t,i)=>{var n,a,s,o,r,c;const l=b(e,t,i);return Object.assign(Object.assign({},l),{message:l.message,stack:l.stack,errorMetaData:{accountId:null===(a=null===(n=null==t?void 0:t.result)||void 0===n?void 0:n.profile)||void 0===a?void 0:a.id,name:null===(o=null===(s=null==t?void 0:t.result)||void 0===s?void 0:s.profile)||void 0===o?void 0:o.displayName,email:null===(c=null===(r=null==t?void 0:t.result)||void 0===r?void 0:r.profile)||void 0===c?void 0:c.email}})},v=(e,t)=>{var i,a;const s=(null==t?void 0:t("buildCloud"))||"",o=null===(i=e.extraQueryParameters)||void 0===i?void 0:i.tenantId,r=I(o,e.domainHint||s,t),c=(null===(a=e.extraQueryParameters)||void 0===a?void 0:a.accountType)||n.Ch.Aad;return{correlation:e.correlation,silent:e.silent,extraQueryParameters:Object.assign(Object.assign({},e.extraQueryParameters),{authority:r}),userIdentifier:{accountType:c,tenantId:o,id:e.accountId||"",userName:"",oid:""}}},f=e=>{var t;return e.accountId&&(null===(t=e.extraQueryParameters)||void 0===t?void 0:t.tenantId)},b=(e,t,i)=>{var n,a;const s=t.isExpected||(null===(n=t.message)||void 0===n?void 0:n.includes("657rv"))||(null===(a=t.errorMessage)||void 0===a?void 0:a.includes("657rv"))||!1;return(0,o.Tr)({context:"authentication",subContext:e,errorCode:t.errorCode||"ErrorCodeMissing",message:(null==t?void 0:t.errorMessage)||t.message||"ErrorMessageMissing",isExpected:s,correlationId:i.id})},y=(e,t,i)=>{var n;const{accountId:s,correlation:o,prompt:r,loginHint:c,extraQueryParameters:l,windowId:u}=e,m=!!(null==i?void 0:i("enableRopcFlow")),g={accountId:s,correlationId:o.id,domainHint:(null==i?void 0:i("enableAad"))?(null==i?void 0:i("enableMultiCloud"))?void 0:a.nU.prod:a.nU.life,extraQueryParameters:(0,d.nW)(l),loginHint:c,silent:"none"===r,windowId:u,useRopcFlow:m};return t.addEventData([`nativeArgs:{domainPresent:${g.domainHint}`,`extraParams:${null===(n=g.extraQueryParameters)||void 0===n?void 0:n.length}`,"idPresent:"+ +!!g.accountId,"loginHintPresent:"+ +!!g.loginHint,`silent:${g.silent}`,`useRopcFlow:${g.useRopcFlow}}`]),g},k=(e,t,i,n)=>{var a,s;const o=S(t.userIdentifier);if(!(null===(a=t.extraQueryParameters)||void 0===a?void 0:a.authority)&&(null==n?void 0:n("enableSetAuthorityAlways"))){const e=t.tenantId||o.tenantId,i=(null==n?void 0:n("buildCloud"))||"",a=I(e,i,n);t.extraQueryParameters=t.extraQueryParameters||{},t.extraQueryParameters.authority=a}const r={resource:e,correlationId:t.correlation.id,accessTokenToRenew:t.accessTokenToRenew,claim:t.claim,silent:null!==(s=t.silent)&&void 0!==s?s:"login"!==t.prompt,userIdentifier:o,tenantId:t.tenantId,extraQueryParameters:(0,d.nW)(t.extraQueryParameters),windowId:t.windowId};return i.addEventData(["nativeArgs:{","accessTokenPresent:"+ +!!r.accessTokenToRenew,"claimPresent:"+ +(0,d.WD)(t.claim),"idPresent:"+ +!!(null==o?void 0:o.id),`silent:${r.silent}`,"userToUse:"+ +!!o,"externalTenant:"+ +!!r.tenantId,"}"]),r},S=e=>({id:e.id,tenantId:e.tenantId,oid:e.oid,upn:e.userName}),w=(e,t,i)=>{var a,s;let o;l.q.info("Getting user profile");const r=null===(a=e.extendedProperties)||void 0===a?void 0:a.find((e=>"acct"===e.name));let c;r&&(o=+r.value);try{c=e.profile.id||(e.profile.oid.startsWith("000")?e.profile.oid.replace(/[0-]/g,""):e.profile.oid)}catch(t){c=e.profile.oid}const u=null===(s=e.extendedProperties)||void 0===s?void 0:s.find((e=>"isCrossCloudUser"===e.name)),h=T(e,null==u?void 0:u.value),p={tenantId:e.profile.tenantId,oid:e.profile.oid,accountType:(0,d.QG)(e.profile.tenantId),userName:e.userName,id:c};m.Jt.put((0,g.VF)(p).telemetryInfo,{isCrossCloudUser:h});const v=j(e,!!(null==t?void 0:t("enableMTO")),!!(null==t?void 0:t("enableCCM")));let f=1===o?n.w4.Guest:n.w4.Member;v===n.Yf.Ccm&&(f=n.w4.Anonymous);const b=e.profile.isHomeAccount?c:(0,d.vt)(e);return{id:c,userName:e.userName||e.profile.email,profile:{acct:o,altsecid:"",amr:[],aud:"",exp:-1,email:e.profile.email,family_name:"",given_name:e.profile.displayName,iat:1,iss:"",name:e.profile.displayName,preferred_username:e.userName||e.profile.email,nbf:-1,nonce:"",oid:e.profile.oid,onprem_sid:"",sub:"",tid:e.profile.tenantId,unique_name:e.profile.displayName,upn:e.profile.email,ver:"1.0",isHomeAccount:e.profile.isHomeAccount},isAuthenticated:!1,type:(0,d.QG)(e.profile.tenantId),cloud:(0,d.nL)(e,t,i,c,b),homeAccountId:b,role:f,subType:v}},j=(e,t,i)=>{var a;let o=n.Yf.Default;if(t||i){const l={id:(0,u.pW)(),scenarioName:s.RG.AuthGetUserSubType,source:"core-auth::getUserSubType"},[d,m]=(0,r.OU)({options:{correlation:l},subContext:"auth-helper::getUserSubType",scenarioName:s.RG.AuthGetUserSubType,source:"core-auth::getUserSubType"}),g=null===(a=e.extendedProperties)||void 0===a?void 0:a.find((e=>e.name===c.GA));if(g){const e=t&&g.value.indexOf(c.f)>-1,a=i&&g.value.indexOf(c.u1)>-1;e?o=n.Yf.Mto:a&&(o=n.Yf.Ccm)}m({reason:"Extended properties wids claim check done.",userSubType:o},"success")}return l.q.log(`User subType set to ${o}, enableMTO: ${t}`),o},C=e=>({token:e.result.token,expires:e.result.expires,fromCache:!1,account:e.result.account}),_=e=>e.errorCode===c.wK.ApiContractViolation&&e.message.includes(c.wK.UiAlreadyShowing),T=(e,t)=>{if(!e.homeAccountId)return!1;if(e.profile.id===e.homeAccountId)return!1;const i=(0,h.zF)(e.homeAccountId,void 0);return(!i||e.profile.sovereignty!==n.ym.gcc||i.cloud!==n.G7.prod)&&"1"===t},I=(e,t,i)=>`${(0,d.M_)(t,i)}${e}`},206083:(e,t,i)=>{"use strict";i.d(t,{n:()=>n});const n=e=>{var t;return!!(null===(t=null==e?void 0:e.chrome)||void 0===t?void 0:t.webview)}},959078:(e,t,i)=>{"use strict";i.d(t,{wm:()=>v,b6:()=>f,yI:()=>b,B$:()=>y,vt:()=>k,LP:()=>S,QG:()=>w,M_:()=>j,nL:()=>C,Ig:()=>T,Xx:()=>F,qv:()=>x,nW:()=>D,aS:()=>A,Kv:()=>M,FG:()=>P,fM:()=>O,jV:()=>R,PU:()=>L,dW:()=>U,au:()=>$,S1:()=>W,NL:()=>B,WD:()=>z,_Z:()=>H,ps:()=>q,Fr:()=>Q,N3:()=>X,qL:()=>ee,x7:()=>te});var n,a=i(850402),s=i(275742),o=i(466094),r=i(287474),c=i(186921),l=i(804589),d=i(588470),u=i(932289),m=i(928665),g=i(136613),h=i(535059),p=i(608989);function v(e,t,i){return void 0!==i&&(t!==i&&e===o.w4.Member)}!function(e){e.Otp="mail",e.GFed="google.com"}(n||(n={}));const f=e=>(c.q.info(`[returnTokenForAnonUser][${e}] empty token return for anonymous user`),{token:"",expires:Math.floor((new Date).setMinutes(l.uI.FIFTEEN)/l.rF.MILLI_PER_SECOND),fromCache:!0}),b=(e,t)=>{if(!e)return"";const i=null==t?void 0:t("instanceUrl"),n=i?`${i}${null!=e?e:"common"}`:"";return c.q.log(`[getAuthorityFromCloud] Get Authority from cloud type - ${n}`),n},y=(e,t,i,n)=>{const a=(null==t?void 0:t.profile.tid)||i||(null==e?void 0:e.tenantId);if(a&&(t||n||(null==e?void 0:e.isAnonEligible)&&(null==e?void 0:e.isAnonRestrictionSatisfied)))return S(a,void 0,t)},k=e=>{const t=e.homeAccountId,i=null==t?void 0:t.split(".")[0];return(null==i?void 0:i.startsWith("00000000-0000-0000"))?i.replace("00000000-0000-0000-","").replace("-",""):i},S=(e,t,i,n)=>{var a;c.q.info("Anon flow - anonymous user created");const s=`anon.${t=t||(e===l.zP?o.G7.life:o.G7.prod)}.${e}.${n}`;return{id:s,isAuthenticated:!0,userName:(null==i?void 0:i.userName)||"anonymous",profile:{oid:x(s),tid:e,upn:(null===(a=null==i?void 0:i.profile)||void 0===a?void 0:a.upn)||"",puid:""},role:o.w4.Anonymous,type:o.Ch.Anonymous,homeAccountId:s,cloud:(null==i?void 0:i.cloud)||t,subType:o.Yf.Default}},w=e=>e===r.e0?o.Ch.MsaLife:o.Ch.Aad,j=(e,t)=>{var i,n;if(!e)return l._V;return(null===(n=(null!==(i=null==t?void 0:t("cloudAuthorityMap"))&&void 0!==i?i:l.fL).find((t=>t.cloud.toString()===e)))||void 0===n?void 0:n.authority)||l._V},C=(e,t,i,n,a)=>{if(w(e.profile.tenantId)===o.Ch.MsaLife)return o.G7.life;if(!(null==t?void 0:t("enableMTMAAuthDataInMaglevStorage"))){const t=e.profile.sovereignty;return _(t)}{const s=e.profile.sovereignty;if(a===n)return _(s);if(i)return i;switch(e.profile.environment){case o.sm.prod:return o.G7.prod;case o.sm.gallatin:return o.G7.gallatin;case o.sm.gov:return null==t?void 0:t("buildCloud");default:return o.G7.prod}}},_=e=>{switch(e){case o.ym.prod:case o.ym.gcc:return o.G7.prod;case o.ym.gcch:return o.G7.gcch;case o.ym.dod:return o.G7.dod;case o.ym.ag08:return o.G7.airgap08;case o.ym.ag09:return o.G7.airgap09;case o.ym.gallatin:return o.G7.gallatin;default:return o.G7.prod}},T=(e,t,i,n)=>{var a;return(null==t?void 0:t.subType)===o.Yf.Ccm?t:!t||(0,s.isEmpty)(t.profile)||t.role===o.w4.Anonymous||t.userRole===l.uI.TWO||!t.isAuthenticated&&e.isAnonEligible||!t.isAuthenticated&&n?(c.q.info("checking anon flow"),y(e,t,i,n)):(t.role=t.role===o.w4.Guest||1===(null===(a=t.profile)||void 0===a?void 0:a.acct)?o.w4.Guest:o.w4.Member,I(t),N(t),E(t))},I=e=>{var t,i,a,s,c;if((null===(t=e.profile)||void 0===t?void 0:t.tid)===r.e0)return void(e.type=o.Ch.MsaLife);if(e.type&&-1!==[o.Ch.Msa,o.Ch.Otp,o.Ch.GFed].indexOf(e.type))return;let l=0===(null===(a=null===(i=e.profile)||void 0===i?void 0:i.altsecid)||void 0===a?void 0:a.indexOf("1:"))?o.Ch.Msa:o.Ch.Aad;(null===(s=e.profile)||void 0===s?void 0:s.idp)&&(null===(c=e.profile)||void 0===c?void 0:c.iss)!==e.profile.idp&&(l=e.profile.idp===n.Otp?o.Ch.Otp:l,l=e.profile.idp===n.GFed?o.Ch.GFed:l),e.type=l},N=e=>{e.type!==o.Ch.MsaLife?e.cloud&&e.cloud!==o.G7.prod||(e.cloud=o.G7.prod):e.cloud=o.G7.life},E=e=>(e.profile.oid=e.profile.oid||x(e.profile.tid),!e.profile.hasOwnProperty("upn")&&e.hasOwnProperty("userName")&&(e.profile.upn=e.userName||""),e.subType||(e.subType=o.Yf.Default),c.q.log(`User role = [${e.role}], type = [${e.type}], cloud = [${e.cloud}]`),e),F=e=>{if(!e)throw new Error("getUserIdentifier: User cannot be null");return{tenantId:e.profile.tid,oid:e.profile.oid,accountType:e.type,userName:e.userName,id:e.id}},x=e=>`8:defaultOid:${e}`,D=e=>{const t=[];for(const i in e)Object.hasOwnProperty.call(e,i)&&e[i]&&t.push({name:i,key:i,value:"string"==typeof e[i]?e[i]:(0,m.u4)(e[i])});return t},A=(e,t)=>{var i;t.addEventData(["update-global-user:t"]),t.addScenarioMark("auth_update_global_user_start");const n=(0,h.zF)(e,void 0);if(n)return t.addScenarioMark("auth_update_global_user_foundUser"),d.Jt.updateGlobalUser(n);throw t.addScenarioMark("auth_update_global_user_noUserFound"),a=null===(i=t.correlation)||void 0===i?void 0:i.id,(0,u.Tr)({context:"core-auth-base",subContext:"getUserFromAccountId",correlationId:a,errorCode:l.SM.UserNotFoundError,message:"Cannot update global user ude to missing user"});var a},M=e=>e?(null==e?void 0:e.id)?null==e?void 0:e.id:`${null==e?void 0:e.oid}-${null==e?void 0:e.tenantId}`:"unknown user",P=(e,t)=>!!e&&!!t&&((e.id||t.id)&&e.id===t.id||e.tenantId===t.tenantId&&e.oid===t.oid&&e.userName===t.userName),O=(e,t,i)=>{var n;const a=new CustomEvent(t,{detail:i});null===(n=null==e?void 0:e.dispatchEvent)||void 0===n||n.call(e,a)},R=(e,t,i,n,a)=>{const s=T(e,t,n,a);return s&&(c.q.info(`[auth-helper][getMappedUserAndSetItToCache][${i}] put user in cache.`),d.Jt.put((0,g.VF)(F(s)).user,s)),s},L=(e,t,i,n)=>{if(l.s9(e))throw n.addEventData(["scope_invalid:1"]),c.q.warn(`[core-auth-base][acquireToken][${i.source}][${i.id}] invalid scope. resource: [${e}]`),(0,u.Tr)({context:"core-auth-base",subContext:"acquireToken",message:`request with [${null==t?void 0:t.id}-${null==t?void 0:t.oid}-${null==t?void 0:t.tenantId}] sent from invalid resource: ${e}`,errorCode:l.SM.InvalidScopeResource,isExpected:!0,correlationId:i.id})},U=(e,t,i,n,a)=>(n.push("user_missing"),(0,u.Tr)({context:"core-auth-base",subContext:e,errorCode:l.SM.UserNotFoundError,isExpected:i,message:`request sent with [${t}] failed as user not found`,innerError:new Error("User Null or empty"),correlationId:a})),$=(e,t,i,n)=>(0,u.Tr)({context:"core-auth-base",subContext:e,errorCode:l.SM.UnsupportedParameter,isExpected:i,message:`${t} parameter is not currently supported`,innerError:new Error(`${t} parameter is not currently supported`),correlationId:n});const W=(e,t,i,n,a,s)=>{var o,r;null==n||n.push(`errorCode:${(null==t?void 0:t.errorCode)||"undefined"},errorMessage:${(null==t?void 0:t.message)||"undefined"}`),n&&n.length>0&&n.push("$");const d=function(e,t,i="",n,a){return{contentType:i,context:"core-auth-base",correlationId:null==t?void 0:t.correlationId,endpointUrl:a||"unset",errorCode:(null==t?void 0:t.errorCode)||"AcquireToken Error",innerError:t,isExpected:null==t?void 0:t.isExpected,message:(0,m.VK)(t),reason:(null==n?void 0:n.join(";"))||"",subContext:e}}(e,t,a,n,s),u=d.errorCode.includes(l.SM.InvalidScopeResource)||(null===(o=d.message)||void 0===o?void 0:o.includes(l.SM.InvalidScopeResource))||d.isExpected||(null===(r=d.innerError)||void 0===r?void 0:r.isExpected);return u?c.q.warning(`Error found ${(0,m.VK)(t)}`):c.q.error(`Error found ${(0,m.VK)(t)}`),u?null==i||i.incomplete(d):null==i||i.fail(d),d},B=JSON.stringify({access_token:{xms_cc:{values:["CP1"]}}}),z=e=>!(!e||e===B),H=(e,t,i,n,a)=>{var s,o,r,l;return i.tflClaim&&(i.accessTokenToRenew=i.tflClaim),void 0===i.prompt&&void 0===i.silent&&(!i.accessTokenToRenew&&!z(i.claim)||(null==n?void 0:n("disablePromptFor401"))&&!((e,t)=>{const i=(null==t?void 0:t("enablePromptResourcesFor401"))||[];return!(!e||!i)&&Array.isArray(i)&&i.findIndex((t=>e.includes(t)))>-1})(e,n)?(i.prompt="none",i.silent=!0):(i.prompt="login",i.silent=!1)),a&&!i.accessTokenToRenew&&(i.forceRenew||!1===i.silent||"login"===i.prompt)&&(c.q.info("[core-auth-base][acquireToken] force renewing."),i.accessTokenToRenew=a.item.token),t.addEventData(["cacheToken:"+ +!!a,"tflClaim:"+ +!!i.tflClaim,"accessTokenToRenew:"+ +!!i.accessTokenToRenew,"forceRenew:"+ +!!i.forceRenew,`prompt: ${i.prompt}`,"silent:"+ +!!i.silent]),(null===(o=null===(s=null==a?void 0:a.item)||void 0===s?void 0:s.error)||void 0===o?void 0:o.errorCode)&&t.addEventData([`errorInToken:[${(null===(l=null===(r=null==a?void 0:a.item)||void 0===r?void 0:r.error)||void 0===l?void 0:l.errorCode)||""}]`]),i},q=(e,t,i,n,s,r)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const a=null==r?void 0:r("buildCloud"),l=null==r?void 0:r("enableMultiCloud"),u=null==r?void 0:r("enableCCM");if(c.q.log(`starting cloud misMatch check. Env: ${i}, buildCloud: ${a}, user tid: ${e.profile.tid}, user cloud: ${e.cloud}`),!e.cloud||!a||e.cloud===a&&e.subType!==o.Yf.Ccm)return c.q.log("No cloud mismatch detected."),t.addEventData(["cloudMismatch:0"]),e;const m=((e,t)=>{const i=null==t?void 0:t("enableMSAGuest"),n=null==t?void 0:t("enableTFLOnT21");return i&&!n&&e.cloud===o.G7.life})(e,r);if(t.addEventData(["cloudMismatch:1","isMsaGuest:"+ +!!m,"enableCCM:"+ +!!u,"meetingDetails:"+ +!!s.meetingDetails]),m){t.addScenarioMark("msa_flow_start");const i=yield V(e,s,n,t,a,r);if(i)return i}if(u&&s.meetingDetails){t.addScenarioMark("ccm_flow_start");const i=yield G(e,s,n,t,a,s.meetingDetails,r);if(i)return i}if(l){t.closeScenario({reason:`_checkForCloudMismatchAndReboot. Env: ${i}, enableMultiCloud: ${l}, buildCloud: ${a}, user tid: ${e.profile.tid}, user cloud: ${e.cloud}`});const o=yield Y(e,s.correlation,n);return Promise.reject(o)}throw d.Jt.del({user:F(e),typeName:"User"}),t.closeScenario({reason:`_checkForCloudMismatchAndReboot. Env: ${i}, buildCloud: ${a}, user tid: ${e.profile.tid}, user cloud: ${e.cloud}`}),new Error("cloud mis-match... reboot required")})),V=(e,t,i,n,s,r)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){try{const a=yield J(e,t,i,l._6.services,s,r),c=K(a,r);if(n.addEventData(["msa-account:"+ +!!c]),n.addScenarioMark("msa_flow_end"),c){const e=yield ee(c,n.correlation,i);return d.Jt.put((0,g.VF)(F(c)).userAuthState,{state:o.JE.Unknown,customError:{errorCode:e.errorCode,isExpected:e.isExpected,message:e.message,context:e.context,subContext:e.subContext,correlationId:e.correlationId,errorMetadata:e.errorMetaData},reason:"MsaUserNotAllowed"}),c.type=o.Ch.Msa,c.homeAccountId=c.id,c}}catch(e){n.addScenarioMark("ccm_flow_end",e)}})),G=(e,t,i,n,s,r,c)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){if(e.subType===o.Yf.Ccm)return Z(e,n,r,e.profile.name);try{const a=yield J(e,t,i,r.tenantId,s,c),l=K(a,c);if(n.addEventData(["account:"+ +!!l,`sub:${null==l?void 0:l.subType}`]),l)return l.subType===o.Yf.Ccm?Z(l,n,r,e.profile.name):(n.addEventData(["ccgaUser:1"]),l);n.addScenarioMark("ccm_flow_end")}catch(e){n.addScenarioMark("ccm_flow_end",e)}})),J=(e,t,i,n,s,o)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const a=`${j(s,o)}${n}`,c=(null==o?void 0:o("mtResource"))||r.O_.MT;return yield i.acquireToken(c,{correlation:t.correlation,silent:t.silent,userIdentifier:F(e),extraQueryParameters:{authority:a}})})),K=(e,t)=>e&&e.account?(0,p.et)(e.account,t):void 0,Q=(e,t,i)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){return new Promise((n=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){if(e.length<=0)return n({count:0,failure:[]});let a=0;const s=[];for(const o of e){a++;try{const i=t(o);yield i,a>=e.length&&n({count:a,failure:s})}catch(t){s.push(a),null==i||i(t,a,o),a>=e.length&&n({count:a,failure:s})}}}))))})),Y=(e,t,i)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var n;const a=(yield null===(n=i.getUserImage)||void 0===n?void 0:n.call(i,{id:e.id,correlation:t}))||"",s={cloud:e.cloud,accountId:e.id,email:e.profile.email,name:e.profile.name,pictureBlob:a};return(0,u.MD)({errorMetaData:s,authSubErrorCode:"MultiCloudMismatch",name:l.SM.CloudMismatch,message:"Cloud Mismatch Detected",context:"Login",correlationId:t.id,errorCode:l.SM.CloudMismatch,subContext:"checkForCloudMismatch",isExpected:!0})})),X=(e,t,i,n)=>{z(i)&&e.addEventData([`isSameToken: ${n===t.token}`]);const a=(e=>{const t=(e-Math.floor((new Date).getTime()/l.rF.MILLI_PER_SECOND))*l.rF.MILLI_PER_SECOND/l.rF.ONE_MINUTE;return Math.floor(t)})(t.expires);e.addEventData([`tokenLifeTime: ${a}`,`fromCache: ${t.fromCache}`])},Z=(e,t,i,n)=>(t.addEventData(["ccmUser:1"]),e.id=`${e.id}_${i.conversationId}`,e.type=o.Ch.Anonymous,e.profile.name=n,d.Jt.put((0,g.VF)(F(e)).meetingDetails,i),t.addScenarioMark("ccm_flow_end"),e),ee=(e,t,i)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var n;const a=(yield null===(n=i.getUserImage)||void 0===n?void 0:n.call(i,{id:e.id,correlation:t}))||"",s={cloud:e.cloud,accountId:e.id,email:e.profile.email,name:e.profile.name,pictureBlob:a};return(0,u.MD)({errorMetaData:s,authSubErrorCode:"MsaUserNotAllowed",name:l.SM.CloudMismatch,message:"msa user Detected",context:"Login",correlationId:t.id,errorCode:l.SM.MsaUserNotAllowed,subContext:"msaUserNotAllowedError",isExpected:!0})})),te=e=>{var t,i,n,a,s,r,c,l,d;return{id:`dummy-user-${null===(t=e.profile)||void 0===t?void 0:t.tid}-${e.homeAccountId}`,userName:e.userName,profile:{acct:1,altsecid:"",amr:[],aud:"",exp:-1,email:null===(i=e.profile)||void 0===i?void 0:i.email,family_name:"",given_name:null===(n=e.profile)||void 0===n?void 0:n.given_name,iat:1,iss:"",name:null===(a=e.profile)||void 0===a?void 0:a.name,preferred_username:e.userName||(null===(s=e.profile)||void 0===s?void 0:s.email),nbf:-1,nonce:"",oid:`dummy-user-${null===(r=e.profile)||void 0===r?void 0:r.tid}`,onprem_sid:"",sub:"",tid:null===(c=e.profile)||void 0===c?void 0:c.tid,unique_name:null===(l=e.profile)||void 0===l?void 0:l.unique_name,upn:null===(d=e.profile)||void 0===d?void 0:d.email,ver:"1.0",isHomeAccount:!1},homeAccountId:e.homeAccountId||e.id,isAuthenticated:!1,type:o.Ch.Aad,cloud:e.cloud,role:e.role}}},942209:(e,t,i)=>{"use strict";i.d(t,{z:()=>a,k:()=>s});var n=i(913911);const a=e=>n.Buffer.from(e).toString("base64"),s=e=>n.Buffer.from(e,"base64")},924732:(e,t,i)=>{"use strict";function n(e){const t={};return(i,...n)=>{try{let a=t[i];return a||(a=t[i]=e(...n).then((e=>(delete t[i],e))).catch((e=>{throw delete t[i],e}))),a}catch(e){throw e}}}i.d(t,{k:()=>n})},565697:(e,t,i)=>{"use strict";i.d(t,{K_:()=>c,dt:()=>l,P0:()=>d,t8:()=>u,MH:()=>m,oO:()=>g,Kf:()=>h,TT:()=>p,jP:()=>v});var n=i(466094),a=i(535059),s=i(588470),o=i(136613),r=i(959078);const c=e=>s.Jt.getValue((0,o.VF)((0,r.Xx)(e)).userAuthState),l=e=>{if(!e)return;const t=(0,a.zF)(e,void 0);if(!t||!t.homeAccountId||t.homeAccountId===t.id)return t;return(0,a.zF)(t.homeAccountId,void 0)},d=(e,t)=>{if(!e||!t)return;return s.Jt.getAllOfType("User").find((i=>i.homeAccountId===e&&i.profile.tid===t))},u=()=>{var e,t;return null===(t=null===(e=s.Jt.getAllOfType("User"))||void 0===e?void 0:e.filter((e=>h(e)&&!g(e))))||void 0===t?void 0:t[0]},m=e=>{let t=(0,a.zF)(e,void 0);if(e||!t)return t;if(t.homeAccountId!==t.id){t=(0,a.zF)(t.homeAccountId,void 0)||t}return t},g=e=>!(!e||!e.homeAccountId||e.homeAccountId===e.id),h=e=>e.type!==n.Ch.Anonymous&&!e.id.startsWith("dummy-user-"),p=e=>{var t,i;const n=null===(i=null===(t=s.Jt.getAllOfType("User"))||void 0===t?void 0:t.filter(Boolean))||void 0===i?void 0:i.filter((t=>h(t)&&t.cloud===e)),a=null==n?void 0:n.filter((e=>!g(e)));return(null==a?void 0:a[0])||(null==n?void 0:n[0])},v=e=>({message:`user for id: '${e}' not found. if id is undefined, global user should return`,errorCode:"NoAccountFoundForLogout",isExpected:!0,context:"get-user-utilities",subContext:"getUserForLogout",correlationId:"",name:"NoAccountFoundForLogout"})},849960:(e,t,i)=>{"use strict";i.d(t,{g:()=>p});var n=i(850402),a=i(466094),s=i(932289),o=i(928665),r=i(959078),c=i(804589),l=i(186921),d=i(688834),u=i(275742);let m,g,h;function p(e,t,i,n){if(Object.getOwnPropertyDescriptor(Window,"mockApi")||Object.defineProperty(Window,"mockApi",{value:{enable:()=>{h=!0},disable:()=>{h=!1},setConfig:v}}),function(e,t){m||(m={});m[t]=e}(e,t),h=n,h){try{g="string"==typeof i?Object.assign(Object.assign({},g),JSON.parse(decodeURIComponent(i))):Object.assign(Object.assign({},g),i)}catch(e){l.q.warning(`[MOCK-API] cannot parse config: ${i}`)}f(e,t)}else g={}}function v(e,t={}){g||(g={}),g[e]=t;const i=e.split(".")[0];f(null==m?void 0:m[i],i)}function f(e,t){Object.getOwnPropertyNames(g).filter((e=>e.startsWith(`${t}.`))).map((e=>e.replace(`${t}.`,""))).forEach((i=>{var a,s;const o=(null===(a=Object.getOwnPropertyDescriptor(e,i))||void 0===a?void 0:a.value)||(null===(s=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),i))||void 0===s?void 0:s.value),r=null==g?void 0:g[`${t}.${i}`];r&&r.delay&&r.delay>0?Object.defineProperty(e,i,{configurable:!0,value:(...a)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){if(h){if(l.q.warning(`[MOCK-API] returning delayed mocked response for ${t}.${i}`),r&&r.delay){const e=void 0!==r.delay?r.delay:0;yield new Promise((t=>(0,u.delay)(t,e)))}return b(t,i)||o.apply(e,a)}return o.apply(e,a)}))}):Object.defineProperty(e,i,{configurable:!0,value:(...n)=>h?(l.q.warning(`[MOCK-API] returning mocked response for ${t}.${i}`),b(t,i)||o.apply(e,n)):o.apply(e,n)})}))}function b(e,t){var i;const n=null==g?void 0:g[`${e}.${t}`];if(n&&n.error)throw function(e,t,i){return(0,s.MD)({name:(null==e?void 0:e.name)||"",context:(null==e?void 0:e.context)||t,subContext:(null==e?void 0:e.subContext)||i,reason:null==e?void 0:e.reason,errorCode:(null==e?void 0:e.errorCode)||"ErrorCodeNotFound",correlationId:(null==e?void 0:e.correlationId)||(0,o.pW)(),isExpected:(null==e?void 0:e.isExpected)||!1,message:(null==e?void 0:e.message)||`[MockApi][${t}][${i}]`,authSubErrorCode:null==e?void 0:e.authSubErrorCode,errorMetaData:null==e?void 0:e.errorMetaData,serverResponse:null==e?void 0:e.serverResponse})}(n.error,e,t);if(n&&n.success){const e=function(e){switch(e){case"aquireToken":return k;case"user":return y();case"hostMachineUsers":return[S];case"users":return[y()];case"emptyList":return[]}return{}}(n.success.defaultValue);return Array.isArray(e)?n.success.returnValue?Array.isArray(n.success.returnValue)?[...e,...n.success.returnValue]:[...e,n.success.returnValue]:e:Object.assign(Object.assign({},e),null===(i=n.success)||void 0===i?void 0:i.returnValue)}}const y=()=>(0,r.Ig)(new d.N("https://test.msft.com"),{userName:"TestUserName@email.com",role:a.w4.Member,profile:{name:"Test",oid:(0,r.qv)("123456789"),tid:"123456789"}}),k={token:"TestToken",expires:Date.now()+c.rF.SECONDS_FIVE_MINUTES,fromCache:!1},S={accountType:"Aad",id:"TestHostMachineUserId",displayName:"Test User",emailPhone:"test@email.com",picture:""}},688834:(e,t,i)=>{"use strict";i.d(t,{N:()=>s,j:()=>l});var n=i(804589),a=i(186921);class s{constructor(e){this._hash="",this._search="",this._pathname="",this._isAnonEligible=!1,this._isAnonRestrictionSatisfied=!1,this._tid=void 0,this._queryStrings={},this._parse=e=>{let t=Object.create(null);return"string"!=typeof e?t:(e=e.trim().replace(/^[?#&]/,""))?(e.split("&").forEach((e=>{const i=e.replace(/\+/g," ").split("=");let n=i.shift();const s=i.length>0?decodeURIComponent(i.join("=")):null;if(n){if(n=decodeURIComponent(n),"context"===n&&0===(null==s?void 0:s.indexOf("{")))try{const e=JSON.parse(s);for(const t in e)!e.hasOwnProperty(t)||"tid"!==t.toLowerCase()&&"tenantid"!==t.toLowerCase()||(this._tid=e[t]);t=Object.assign(Object.assign({},t),e)}catch(e){a.q.error(e)}if(Object.prototype.hasOwnProperty.call(t,n))Array.isArray(t[n])?t[n].push(s):t[n]=[t[n],s];else{t[n]=s;const e=n.toLowerCase();!s||"tid"!==e&&"tenantid"!==e||(this._tid=s)}}})),t):t};try{this._currenttUrl=Object.freeze(new URL(e))}catch(t){throw new Error(`[TeamsUrl::ctor] - error - ${t} url ${e}`)}if(this._currenttUrl.hash&&-1!==this._currenttUrl.hash.indexOf("#/")){const e=this._currenttUrl.href.substring(this._currenttUrl.origin.length),t=e.indexOf("#");t>=0&&(this._hash=e.substr(t),this._pathname=e.substr(0,t));const i=this._hash.indexOf("?");i>=0&&(this._search=this._hash.substr(i))}this._queryStrings=this._parse(this._search||this._currenttUrl.search);const t=o(this._currenttUrl);this._isAnonEligible=t[0],this._isAnonRestrictionSatisfied=t[1]}get href(){return this._currenttUrl.href}get isLocal(){return 0===this._currenttUrl.host.indexOf("local.teams.office.com")}get hash(){return this._hash||this._currenttUrl.hash}get pathname(){return this._pathname||this._currenttUrl.pathname}get search(){return this._search||this._currenttUrl.search}get origin(){return this._currenttUrl.origin}get searchParams(){return{get:e=>this._queryStrings[e]}}get queryStrings(){return this._queryStrings}get tenantId(){return 0===this._currenttUrl.host.indexOf("teams.live.")?n.zP:this._tid}get isAnonEligible(){return this._isAnonEligible}get isAnonRestrictionSatisfied(){return this._isAnonRestrictionSatisfied}get alternateUrl(){const e=new URL(this._currenttUrl.href);return this.isLocal?(e.port?e.port="":e.port="8080",e.href):(0===e.host.indexOf("teams.live.")?e.host="teams.microsoft.com":e.host="teams.live.com",e.href)}}const o=e=>{if(!c)return[!1,!1];for(const t of c)if(t.anonUrlMatch&&e.href.indexOf(t.anonUrlMatch)>-1)return[!0,r(t,e.href)];return[!1,!1]},r=(e,t)=>{if(!e.restrictions||0===e.restrictions.length)return!0;for(const i of e.restrictions)if(t.indexOf(i)>-1)return!0;return!1};let c=[];const l=e=>{e&&(c=e)}},278593:(e,t,i)=>{"use strict";var n,a;i.d(t,{j:()=>n,Q:()=>a}),function(e){e.Up="Up",e.InteractionRequired="InteractionRequired",e.AADReconnecting="AADReconnecting",e.SkypeReconnecting="SkypeReconnecting",e.LicenseError="LicenseError",e.SignInRestriction="SignInRestriction"}(n||(n={})),function(e){e.Failure="Failure",e.InteractionRequired="InteractionRequired",e.Success="Success",e.LicenseError="LicenseError",e.SignInRestriction="SignInRestriction",e.Unknown="Unknown"}(a||(a={}))},765053:(e,t,i)=>{"use strict";var n,a,s,o,r;i.d(t,{oo:()=>n,nU:()=>a,O3:()=>o,nM:()=>r}),function(e){e.SUCCESS="SUCCESS",e.CANCELLED="CANCELLED",e.FAILED="FAILED",e.TIMEOUT="TIMEOUT"}(n||(n={})),function(e){e.prod="prod",e.life="life",e.dod="dod",e.gcch="gcch",e.gallatin="gallatin",e.airgap08="airgap08",e.airgap09="airgap09"}(a||(a={})),function(e){e.Aad="Aad",e.MsaLife="MsaLife"}(s||(s={})),function(e){e.AADReconnecting="AADReconnecting",e.Failure="Failure",e.InteractionRequired="InteractionRequired",e.SignInRestriction="SignInRestriction",e.SkypeReconnecting="SkypeReconnecting",e.Up="Up"}(o||(o={})),function(e){e.UserDataXCloud="userdataxcloud",e.Auth="auth"}(r||(r={}))},287474:(e,t,i)=>{"use strict";var n,a,s,o,r;i.d(t,{hO:()=>n,Zw:()=>a,in:()=>s,s_:()=>o,O_:()=>r,e0:()=>c}),function(e){e.POP="pop",e.BEARER="Bearer"}(n||(n={})),function(e){e[e.Skype=0]="Skype",e[e.AAD=1]="AAD",e[e.CAE=2]="CAE"}(a||(a={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(s||(s={})),function(e){e.ag08="ag08",e.ag09="ag09",e.dod="dod",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod"}(o||(o={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT="https://api.spaces.skype.com",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read",e.CSA_PHONELINK_AUTH_URL="https://chatsvcagg-tfl.teams.microsoft.com/user_impersonation"}(r||(r={}));const c="9188040d-6c67-4c5b-b112-36a304b66dad"},27149:(e,t,i)=>{"use strict";var n;i.d(t,{dX:()=>n}),function(e){e.authWarmLaunch="authWarmLaunch",e.authWarmLaunchAfterLoginValidation="authWarmLaunchAfterLoginValidation",e.authAnonLaunch="authAnonLaunch",e.authLoginSsoComplete="authLoginSsoComplete",e.authDisableSsoLaunch="authDisableSsoLaunch",e.authAfterLogoutLaunch="authAfterLogoutLaunch",e.authLoginPage="authLoginPage",e.authMtoUser="authMtoUser",e.authHasMtoTenant="authHasMtoTenant"}(n||(n={}))},194232:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n,n:()=>a});const n=e=>{const t=e.requestWindowId?`:${e.requestWindowId}`:"";return`${e.requestRendererId}${t}:${e.requestId}`},a=e=>({correlationId:e.correlationId,contextId:e.requestRendererId,context:e.hostRendererId,operationName:e.operationName,operationType:e.operationType,windowId:e.requestWindowId,queryId:e.requestId,commandSource:e.callerInfo,origin:e.component})},587592:(e,t,i)=>{"use strict";var n;i.d(t,{k:()=>n}),function(e){e.auth="auth",e.appService="appService",e.appState="appState",e.control="control",e.database="database",e.diagnostics="diagnostics",e.endpointHealth="endpointHealth",e.graphql="graphql",e.networkState="networkState",e.supportedResolvers="supportedResolvers",e.syncEngine="syncEngine",e.tenantSwitch="tenantSwitch",e.telemetry="telemetry"}(n||(n={}))},451249:(e,t,i)=>{"use strict";i.d(t,{B$:()=>j,_A:()=>C,V5:()=>_,eU:()=>T,Ig:()=>I,k6:()=>F,aJ:()=>x,U8:()=>D,sW:()=>M,mH:()=>O,Wn:()=>R,ok:()=>L,z5:()=>U,cC:()=>$,vL:()=>W,TA:()=>B,CQ:()=>z,fr:()=>H,fZ:()=>q,bY:()=>V});var n,a=i(850402),s=i(275742),o=i(466094),r=i(50805),c=i(8122),l=i(974509),d=i(955105),u=i(778452),m=i(827748),g=i(448850),h=i(905581),p=i(132756),v=i(287474),f=i(738646),b=i(804589),y=i(747741),k=i(932289),S=i(7269);!function(e){e.Otp="mail",e.GFed="google.com"}(n||(n={}));const w="9188040d-6c67-4c5b-b112-36a304b66dad",j=(e,t,i,n=!1)=>{var a,s,r;let c={};try{c=(0,u.s)().state.getSearchState()}catch(e){}const l=(null===(a=null==i?void 0:i.profile)||void 0===a?void 0:a.tid)||c.tid||c.Tid||c.tenantId||c.tenantid;if(i||e[0]&&e[1]){if(l){t.log("Anon flow - anonymous user created");const e=l===w?o.G7.life:o.G7.prod;return{isAuthenticated:!0,userName:(null==i?void 0:i.userName)||"anonymous",profile:{oid:`8:anon:${l}`,tid:l,upn:(null===(s=null==i?void 0:i.profile)||void 0===s?void 0:s.upn)||"",puid:""},role:o.w4.Anonymous,type:o.Ch.Anonymous,cloud:(null==i?void 0:i.cloud)||e}}if(n)return t.log("Anon flow - anonymous user created without tid"),{isAuthenticated:!0,userName:(null==i?void 0:i.userName)||"anonymous",profile:{oid:"8:anon:",tid:"",upn:(null===(r=null==i?void 0:i.profile)||void 0===r?void 0:r.upn)||"",puid:""},role:o.w4.Anonymous,type:o.Ch.Anonymous,cloud:(null==i?void 0:i.cloud)||o.G7.prod}}t.log("non anon flow - user undefined")},C=(e,t,i,n)=>{const{getTenantsServiceUrl:a,enableMTO:s}=(null==n?void 0:n.get(r.J.Auth))||{};return{method:t,url:`${a||"https://teams.microsoft.com/api/mt/part/dogfood/beta/users/tenantsv2"}?invalidate=${+new Date(Date.now())}`,serviceName:c.E.Auth,authOptions:{accountId:e,source:"core-auth-base"},apiName:i,headers:s?{"content-type":"application/json","x-ms-client-capabilities":"x-ms-mto-enabled"}:{"content-type":"application/json"}}},_=e=>!!e&&e.status===l.qb.NOT_AUTHORIZED&&"SkypeToken"===e.headers["x-invalid-token"],T=(e,t,i,n,a,s)=>{var o,r;if("True"!==(null===(o=null==t?void 0:t.headers)||void 0===o?void 0:o[b.kI])||e!==b.ej.IC3_GATEWAY_CAE_KEY&&e!==b.ej.IC3_GATEWAY_AAD_KEY)return e;if(!i)return null==a||a.addEventData(["missingWwwAuthHeader"]),e;if(!(0,y.ce)(i))return null==a||a.addEventData(["missingStmHeader"]),e;const c=t.authOptions||{};null==a||a.addEventData([`source:${null==c?void 0:c.source}`]);const l=(0,y.Ay)(i);switch(null==a||a.addEventData([`highestProtocol:${l}`]),e){case b.ej.IC3_GATEWAY_CAE_KEY:if(l===v.Zw.CAE)return e;break;case b.ej.IC3_GATEWAY_AAD_KEY:if(l===v.Zw.AAD||l===v.Zw.CAE)return e}if(l===v.Zw.AAD)return(null==c?void 0:c.source)&&(0,y.Qk)(n,c.source,v.Zw.AAD),null==a||a.appendScenarioEventData({tokenFallbackType:"CAE_to_AAD"}),null==a||a.addEventData([`stmResource:${b.ej.IC3_GATEWAY_AAD_KEY}`,"stmFallbackWithAadToken"]),b.ej.IC3_GATEWAY_AAD_KEY;if(l===v.Zw.Skype){(null==c?void 0:c.source)&&(0,y.Qk)(n,c.source,v.Zw.Skype),null==a||a.appendScenarioEventData({tokenFallbackType:(e===b.ej.IC3_GATEWAY_CAE_KEY?"CAE":"AAD")+"_to_Skype"}),null==a||a.addEventData(["stmResource:skype"]);const i={context:"auth-helper",subContext:"getRetryResourceForStMigration",errorCode:b.SM.FallbackWithSkypeToken,message:"Highest protocal is Skype, retry with skypeToken",correlationId:null===(r=null==t?void 0:t.headers)||void 0===r?void 0:r.correlationId,isExpected:!0};throw null==s||s({error:Object.assign(Object.assign({},i),{name:"authError"})}),(0,k.Tr)(i)}return e},I=(e,t,i,n=!1,a=!1)=>{var r;return e.subType===o.Yf.Ccm?e:(0,s.isEmpty)(e.profile)||!e.profile.oid&&n||e.role===o.w4.Anonymous||e.userRole===o.jh.Anonymous||!e.isAuthenticated&&t[0]?(i.log("checking anon flow"),j(t,i,e,a)):(e.role=e.role===o.w4.Guest||1===(null===(r=e.profile)||void 0===r?void 0:r.acct)?o.w4.Guest:o.w4.Member,N(e),E(e),e.profile.oid=e.profile.oid||`8:defaultOid:${e.profile.tid}`,!e.profile.hasOwnProperty("upn")&&e.hasOwnProperty("userName")&&(e.profile.upn=e.userName||""),e.userRole===o.jh.CrossCloudMeeting&&(e.role=o.w4.Anonymous,e.type=o.Ch.Anonymous),i.log(`User role = [${e.role}], type = [${e.type}], cloud = [${e.cloud}]`),e)},N=e=>{var t,i,a,s,r;if((null===(t=e.profile)||void 0===t?void 0:t.tid)===w)return void(e.type=o.Ch.MsaLife);if(e.type&&-1!==[o.Ch.Msa,o.Ch.Otp,o.Ch.GFed].indexOf(e.type))return;let c=0===(null===(a=null===(i=e.profile)||void 0===i?void 0:i.altsecid)||void 0===a?void 0:a.indexOf("1:"))?o.Ch.Msa:o.Ch.Aad;(null===(s=e.profile)||void 0===s?void 0:s.idp)&&(null===(r=e.profile)||void 0===r?void 0:r.iss)!==e.profile.idp&&(c=e.profile.idp===n.Otp?o.Ch.Otp:c,c=e.profile.idp===n.GFed?o.Ch.GFed:c),e.type=c},E=e=>{e.type!==o.Ch.MsaLife?e.cloud&&e.cloud!==o.G7.prod||(e.cloud=o.G7.prod):e.cloud=o.G7.life},F=(e,t)=>{if(!e.anon||!t)return[!1,!1];t=decodeURIComponent(t);for(const i of e.anon)if(i.anonUrlMatch&&t.indexOf(i.anonUrlMatch)>-1)return[!0,A(i,t)];return[!1,!1]},x=(e,t)=>{const i=new Error("Tenant is has not completed redemption");return Object.assign(i,{context:"global-auth",subContext:"handleGetTenants",reason:"",errorCode:e,serverResponse:"",correlationId:t,isExpected:!0,innerError:""})},D=e=>{const t=new Error("Tenant is has not completed redemption");return Object.assign(t,{context:"global-auth",subContext:"handleGetTenants",reason:"",errorCode:b.SM.MissingRequiredFields,serverResponse:"",correlationId:e,isExpected:!0,innerError:""})},A=(e,t)=>{if(!e.restrictions||0===e.restrictions.length)return!0;for(const i of e.restrictions)if(t.indexOf(i)>-1)return!0;return!1},M=(e,t)=>{const{maxRetries:i,retryWindow:n,backoffTime:s,shouldRetry:o}=t,r=e=>n-(Date.now()-e);return(...t)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const n=Date.now();let a=0,c=r(n),l="";for(;a++<=i&&c>0;)try{return yield Promise.resolve(e.apply(e,t))}catch(e){if(o&&!o(e))throw e;if(e&&o&&o(e)&&a>=i){const t=`;All retries elapsed or retryWindow expired, RetryCount: ${a}, RemainingTime: ${c}`;throw(0,h.Tr)(e.context,e.code,e.subContext?e.subContext:"",e.reason,e.message+t,e.serverResponse)}if(a>=i||r(n)<=0){l=null==e?void 0:e.message;break}yield(0,m._)(s),c=r(n)}throw P(a,l,r(n))}))},P=(e,t,i)=>(0,h.Tr)("AuthRetryWithBackoff",p.jK.MaxLimitReached,"elapsed",void 0,`${t}; All retries elapsed or retryWindow expired, RetryCount: ${e}, RemainingTime: ${i}`);var O;!function(e){e.WWW_AUTHENTICATE_HEADER="www-authenticate",e.ERROR_PREFIX="error=",e.CLAIMS_PREFIX="claims=",e.INSUFFICIENT_CLAIMS="insufficient_claims"}(O||(O={}));const R=(e,t)=>{const i={error:void 0,claims:void 0},n=null==e?void 0:e[O.WWW_AUTHENTICATE_HEADER];if(!n)return i;const a=n.split(",").filter(Boolean).map((e=>e.trim()));for(const e of a){const n=e.split('"');if(3===n.length)switch(n[0].toLocaleLowerCase()){case O.ERROR_PREFIX:i.error=n[1];break;case O.CLAIMS_PREFIX:i.claims=t?n[1]:(0,g.G)(n[1])}}return i},L=e=>{var t;return{id:e.id,tenantId:e.profile.tenantId,oid:e.profile.objectId,userName:null!==(t=e.loginUserName)&&void 0!==t?t:"",accountType:e.type}},U=(e,t)=>{if((null==e?void 0:e.isPartialContent)&&(null==t?void 0:t.length)>0){return t.filter((e=>e.tenantRelationship===b.Tv.MTO)).concat(e.tenants)}return e.tenants},$=(e,t)=>{var i;const{enableRenderingCrossCloudTenant:n,buildCloud:a}=null!==(i=null==t?void 0:t.get(r.J.Auth))&&void 0!==i?i:{};return e.cloudType!==a&&!n},W=(e,t,i)=>{const n=(e=>e&&"string"==typeof e?{claim:e}:e||{})(i),[a,s]=(0,S.OU)({options:n,source:e,scenarioName:f.RG.AcquireToken,subContext:t,startWithoutScenario:!0});return[n,a,s]},B=(e,t)=>({id:`dummy-user-${e.tenantId}-${t.homeAccountId}`,userName:t.userName,profile:{acct:1,altsecid:"",amr:[],aud:"",exp:-1,email:t.profile.email,family_name:"",given_name:t.profile.given_name,iat:1,iss:"",name:t.profile.name,preferred_username:t.userName||t.profile.email,nbf:-1,nonce:"",oid:`dummy-user-${e.tenantId}`,onprem_sid:"",sub:"",tid:e.tenantId,unique_name:t.profile.unique_name,upn:t.profile.email||t.profile.upn,ver:"1.0",isHomeAccount:!1},homeAccountId:t.homeAccountId||t.id,isAuthenticated:!1,type:e.tenantId===v.e0?o.Ch.MsaLife:o.Ch.Aad,cloud:e.cloudType,role:o.w4.Guest}),z=e=>{switch(e){case o.zC.prod:case o.zC.gcc:return o.G7.prod;case o.zC.dod:return o.G7.dod;case o.zC.gcch:return o.G7.gcch;case o.zC.gallatin:return o.G7.gallatin;default:return o.G7.prod}},H=(e,t,i,n,a)=>{const s=a?f.RG.AuthorizeRequest:f.RG.AcquireToken;i.correlation.scenarioName=s;const[o,r]=(0,S.OU)({options:i,source:"auth-service-module",scenarioName:s,subContext:e,timeoutMs:!1===i.silent?b.rF.ONE_HOUR:void 0,scenarioEventData:{isSilent:i.silent,endpointUrl:t,stmSource:n.source},eventData:["silent:"+(void 0===i.silent?-1:+!!i.silent),"uid:"+ +!!n.userIdentifier,`scheme:${n.scheme}`],startWithoutScenario:!0,isBatch:a});return[o,r]},q=(e,t)=>{const i=e.newLogger("AuthContextChange","create-auth-task-cross-tab-callbacks");let n;return{contextChangePost:()=>{var e;return null===(e=i.debugToTelemetry)||void 0===e||e.call(i,"Sent auth context changed cross tab message","auth_context_change_cross_tab_post_message",void 0,!0),null==t?void 0:t.postMessage("RefreshForAuthContextChange")},contextChangeSubscribe:e=>(n=null==t?void 0:t.subscribeToMessage("RefreshForAuthContextChange",(t=>{var a;return null===(a=i.debugToTelemetry)||void 0===a||a.call(i,"Recieved auth context changed cross tab message","auth_context_change_cross_tab_subscription",void 0,!0),null==n||n(),e.authentication.showRefreshModal(d.D.Authentication)})),n)}},V=e=>{const t=[];for(let i=0;i<e.length;i++){e.charCodeAt(i)>b.uI.TWO_HUNDRED_FIFTY_FIVE&&t.push(e.charAt(i))}return t}},935232:(e,t,i)=>{"use strict";i.d(t,{_i:()=>l,rt:()=>d});var n=i(109062),a=i(354571),s=i(706007),o=i(433728),r=i(701129),c=i(586335);let l;const d=(e,t)=>(l||(l=new u(e,t)),l);class u{constructor(e,t){this._hostStateProvider=e,this._networkStateProvider=t}observeMachineOnline(){return this._networkStateProvider.observe().pipe((0,s.x)()).pipe((0,o.U)((e=>e===n.G.Online))).pipe((0,r.h)((e=>!0===e)))}observeMachineAwake(){return this._hostStateProvider.observe().pipe((0,c.g)("suspendedState")).pipe((0,o.U)((e=>e.suspendedState===a.V9.Resumed))).pipe((0,r.h)((e=>!0===e)))}isMachineAwake(){return this._hostStateProvider.getState().suspendedState===a.V9.Resumed}isMachineOnline(){return this._networkStateProvider.getState()===n.G.Online}}},462410:(e,t,i)=>{"use strict";i.d(t,{q:()=>d});var n,a,s=i(850402),o=i(974509),r=i(132756),c=i(905581),l=i(275742);!function(e){e[e.clean=0]="clean",e[e.registrationToken=1]="registrationToken",e[e.skypeToken=2]="skypeToken"}(n||(n={})),function(e){e.orgid="orgid",e.teamsvisitor="teamsvisitor",e.live="live",e.guest="guest"}(a||(a={}));class d{constructor(e){this.discover=e,this._getSkypeIdType=()=>(0,s.__awaiter)(this,void 0,void 0,(function*(){var e;const t=yield this.discover.skypeid(),i=null===(e=null==t?void 0:t.split(":"))||void 0===e?void 0:e[1];return a[i]}))}authorizeRequest(e,t="Authentication"){return(0,s.__awaiter)(this,void 0,void 0,(function*(){let i,n;const r=(e,a)=>(0,s.__awaiter)(this,void 0,void 0,(function*(){const s=Object.assign({},e.headers);if(this.registrationToken)s.RegistrationToken=this.registrationToken;else{i=n;const o=performance.now(),r=yield this._validateSkypeToken({invalidSkypeToken:n,forceRenew:a});n=r.skypeToken,yield this.validateAndThrowIfTokensAreSameOrInvalid("Skype::authorizeRequest",n,i,a),e.authPerformanceLogs=Object.assign(Object.assign({},e.authPerformanceLogs),{skypeTokenDelta:performance.now()-o,skypeTokenFromCache:r.fromCache}),s[t]=this.formatAuthHeader(t,n)}return e.headers=s,e}));return{request:yield r(e),resolver:(e,t)=>(0,s.__awaiter)(this,void 0,void 0,(function*(){const{status:n,headers:{"set-registrationtoken":s}}=e;if(n===o.qb.NOT_AUTHORIZED){const e=yield this._getSkypeIdType(),n=this.discover.shouldSkipTokenRefreshForAnon&&this.discover.shouldSkipTokenRefreshForAnon();if(e===a.teamsvisitor&&n)return;if(this.registrationToken&&delete this.registrationToken,!i)return r(t,!0)}else s&&n!==o.qb.NOT_FOUND&&this.parseToken(s)}))}}))}authorize(e,t="Authentication"){return i=>(0,s.__awaiter)(this,void 0,void 0,(function*(){let s,r,c=!1,l=n.clean;for(let d=0;d<=2;++d){const d=Object.assign({},i.headers),u=this.registrationToken;if(u)d.RegistrationToken=u;else{const e=performance.now(),n=yield this._validateSkypeToken({invalidSkypeToken:s,forceRenew:c});yield this.validateAndThrowIfTokensAreSameOrInvalid("Skype::authorize",null==n?void 0:n.skypeToken,s,c),s=n.skypeToken,i.authPerformanceLogs=Object.assign(Object.assign({},i.authPerformanceLogs),{skypeTokenDelta:performance.now()-e,skypeTokenFromCache:n.fromCache}),d[t]=this.formatAuthHeader(t,s)}i.headers=d,r=yield e(i);const{status:m,headers:{"set-registrationtoken":g}}=r;if(m===o.qb.NOT_AUTHORIZED){const e=yield this._getSkypeIdType(),t=this.discover.shouldSkipTokenRefreshForAnon&&this.discover.shouldSkipTokenRefreshForAnon();if(e===a.teamsvisitor&&t)break;if(u){if(u===this.registrationToken&&delete this.registrationToken,l===n.clean){s=void 0,l=n.registrationToken;continue}}else if(!c&&l!==n.skypeToken){c=!0,l=n.skypeToken;continue}}return g&&m!==o.qb.NOT_FOUND&&this.parseToken(g),r}return this.validateResponse(r)}))}validateAndThrowIfTokensAreSameOrInvalid(e,t,i,n){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const a=t===i;if(this.discover.getSettingToDisableSkypeTokenValidation&&this.discover.getSettingToDisableSkypeTokenValidation(n,a))return;const s=this.discover.shouldThrowErrorIfSkypeTokenIsEmpty&&this.discover.shouldThrowErrorIfSkypeTokenIsEmpty(),o=!t||(0,l.isEmpty)(t.trim());if(a||s&&o){const i=yield this._getSkypeIdType();throw(0,c.Tr)("Discover",r.jK.FailedToUpdate,e,void 0,`Failed to update token. skypeId startsWith: ${i}, new token: ${+!!t}, isTokenSame: ${a}, isNewTokenEmptyOrUndefined: ${o}, forceRenew: ${n}`)}}))}_validateSkypeToken(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){return this.discover.validateSkypeTokenV2?this.discover.validateSkypeTokenV2(e):{skypeToken:yield this.discover.validateSkypeToken(e)}}))}validateResponse(e){if(!e)throw(0,c.Tr)(r.w5.Authentication,r.jK.UndefinedGlobalError,"",void 0,"Failed to authenticate response");return e}formatAuthHeader(e,t){return"Authentication"===e?`skypetoken=${t}`:"x-skypetoken"===e?t:`skype_token ${t}`}parseToken(e){const t=(0,l.fromPairs)(e.split(";").map((e=>e.split("=",2).map((e=>e.trim()))))),{expires:i}=t,n=(0,s.__rest)(t,["expires"]);n.endpointId&&(this.registrationToken=(0,l.toPairs)(n).map((e=>e.join("="))).join("; "))}}},961614:(e,t,i)=>{"use strict";i.d(t,{R:()=>n,u:()=>r});var n,a=i(824303),s=i(50805),o=i(275742);!function(e){e.Active="Active",e.Inactive="Inactive",e.LongInactive="LongInactive"}(n||(n={}));class r{constructor(e,t,i,s,c){this._host=e,this._activityCallback=s,this._trackDocumentVisibility=c,this.msUntilIdle=r.MsUntilIdleDefault,this.msUntilLongIdle=r.msUntilLongIdleDefault,this.handleMonitoredWindowEvent=(0,o.debounce)((()=>{this._idleStateBehaviorSubject.value!==n.Active&&this._idleStateBehaviorSubject.next(n.Active),this.restartIdleTimer(),this._activityCallback&&this._activityCallback()}),r.msDelayTime,{maxWait:this.msUntilIdle-r.msDelayTime*r.msMaxWaitTimeFactor,leading:!0}),this.handleIdleTimerTimeout=()=>{this._idleStateBehaviorSubject.next(n.Inactive),this._idleCountdownTimer=void 0,this.restartLongIdleTimer()},this.handleLongIdleTimerTimeout=()=>{this._idleStateBehaviorSubject.next(n.LongInactive),this._longIdleCountdownTimer=void 0},this.handleDocumentVisibilityChange=()=>{this._host.document.hidden?this._idleStateBehaviorSubject.next(n.Inactive):(this._idleStateBehaviorSubject.next(n.Active),this.restartIdleTimer())},this._idleStateBehaviorSubject=new a.X(n.Inactive),i&&this.setSettings(i),this.restartLongIdleTimer(),r.monitoredWindowEvents.forEach((t=>{e.addEventListener(t,this.handleMonitoredWindowEvent)})),c&&e.addEventListener("visibilitychange",this.handleDocumentVisibilityChange),t.newLogger("IdleTracker","core-services-client-state").log("Initialized")}observe(){return this._idleStateBehaviorSubject.asObservable()}getState(){return this._idleStateBehaviorSubject.value}createChildWindowIdleTracker(e,t,i){const n=this._activityCallback||this.handleMonitoredWindowEvent;return new r(e,t,i,n)}restartIdleTimer(){this.stopIdleTimers(),this._idleCountdownTimer=this._host.setTimeout(this.handleIdleTimerTimeout,this.msUntilIdle)}dispose(){this.stopIdleTimers(),r.monitoredWindowEvents.forEach((e=>{this._host.removeEventListener(e,this.handleMonitoredWindowEvent)})),this._trackDocumentVisibility&&this._host.removeEventListener("visibilitychange",this.handleDocumentVisibilityChange),this._idleStateBehaviorSubject.complete(),this.handleMonitoredWindowEvent.cancel()}setSettings(e){const{appIdleTimeoutInMs:t,appLongIdleTimeoutInMs:i}=e.get(s.J.Core);this.msUntilIdle=t||r.MsUntilIdleDefault,this.msUntilLongIdle=i||r.msUntilLongIdleDefault}restartLongIdleTimer(){void 0!==this._longIdleCountdownTimer&&(this._host.clearTimeout(this._longIdleCountdownTimer),this._longIdleCountdownTimer=void 0),this._longIdleCountdownTimer=this._host.setTimeout(this.handleLongIdleTimerTimeout,this.msUntilLongIdle)}stopIdleTimers(){void 0!==this._idleCountdownTimer&&(this._host.clearTimeout(this._idleCountdownTimer),this._idleCountdownTimer=void 0),void 0!==this._longIdleCountdownTimer&&(this._host.clearTimeout(this._longIdleCountdownTimer),this._longIdleCountdownTimer=void 0)}}r.monitoredWindowEvents=["scroll","DOMMouseScroll","mousewheel","touchstart","touchmove","mousemove","keydown"],r.msDelayTime=1e3,r.msMaxWaitTimeFactor=30,r.msUntilLongIdleDefault=12e5,r.MsUntilIdleDefault=3e5},469980:(e,t,i)=>{"use strict";var n,a;i.d(t,{t:()=>n,Y:()=>a}),function(e){e.Compose="Compose",e.MessagePane="MessagePane",e.DeeplinkedMessage="DeeplinkedMessage",e.DoNotMove="DoNotMove",e.PeoplePickerInput="people-picker-input"}(n||(n={})),function(e){e.LeftRailSelectedItem="LeftRailSelectedItem",e.DoNotMove="DoNotMove"}(a||(a={}))},56981:(e,t,i)=>{"use strict";var n;i.d(t,{Y:()=>n}),function(e){e.BottomLeft="BottomLeft",e.BottomRight="BottomRight",e.TopLeft="TopLeft",e.TopRight="TopRight"}(n||(n={}))},872177:(e,t,i)=>{"use strict";var n;i.d(t,{hO:()=>n,K$:()=>a,v4:()=>s,F_:()=>o}),function(e){e.POP="pop",e.BEARER="Bearer"}(n||(n={}));const a="https://api.spaces.skype.com",s="ForceFallbackToWebAuth",o="ForceReloadIfSkypeAuthFail"},845279:(e,t,i)=>{"use strict";var n;i.d(t,{l:()=>n,Q:()=>a}),function(e){e[e.UNKNOWN=-1]="UNKNOWN",e[e.ONLINE=1]="ONLINE",e[e.OFFLINE=0]="OFFLINE"}(n||(n={}));const a=["ChatSync","Presence","Files","OneNote","Groups","Video","MasterTab","IndexDb","AdalTokens","AdalLogin","AdalReauth","SkypeTokens","SkypeLicense","SupportedBrowser","MSAGuestLicense","AppSession","CSAStartup"]},246632:(e,t,i)=>{"use strict";i.d(t,{QC:()=>n,_1:()=>a,fl:()=>s,w8:()=>o,nx:()=>r});const n="cdl-worker-startup-status",a="cdl-worker-verbose-log",s="cdl-worker-aggregated-user-data",o="cdl-worker-aggregated-user-badge-data",r="cdl-worker-global-user-data"},238446:(e,t,i)=>{"use strict";var n;i.d(t,{B:()=>n}),function(e){e.Abandoned="Abandoned",e.AfterOnCommandReceived="AfterOnCommandReceived",e.AfterOnEventReceived="AfterOnEventReceived",e.AlreadyFocused="AlreadyFocused",e.ApplicationHookReceivedCommand="ApplicationHookReceivedCommand",e.ApplicationHookContinuedCommand="ApplicationHookContinuedCommand",e.BeforeOnCommandReceived="BeforeOnCommandReceived",e.BeforeOnEventReceived="BeforeOnEventReceived",e.Blanked="Blanked",e.ChunkLoadStarted="ChunkLoadStarted",e.ChunkLoadSucceeded="ChunkLoadSucceeded",e.Close="Close",e.CommandAfterGetAppViewEntitiesSucceeded="CommandAfterGetAppViewEntitiesSucceeded",e.CommandBeforeGetAppViewEntities="CommandBeforeGetAppViewEntities",e.CommandHandledByOnCommandReceived="CommandHandledByOnCommandReceived",e.CommandHandledPriorToResolution="CommandHandledPriorToResolution",e.CommandMetaDataAdded="CommandMetaDataAdded",e.CommandReceived="CommandReceived",e.CommandReportingTimedOut="CommandReportingTimedOut",e.CommandResolutionStarted="CommandResolutionStarted",e.CommandStart="CommandStart",e.DeeplinkReceived="DeeplinkReceived",e.DeeplinkParsed="DeeplinkParsed",e.DeeplinkParseByAppStarted="DeeplinkParseByAppStarted",e.DeeplinkParseByAppSucceeded="DeeplinkParseByAppSucceeded",e.DelegatedCommandReceived="DelegatedCommandReceived",e.EventBubbled="EventBubbled",e.EventHandled="EventHandled",e.Hidden="Hidden",e.IntentReceived="IntentReceived",e.IntentTransferredCrossCloud="IntentTransferredCrossCloud",e.OnBeforeIntentAuthenticatedStarted="OnBeforeIntentAuthenticatedStarted",e.OnBeforeIntentAuthenticatedCompleted="OnBeforeIntentAuthenticatedCompleted",e.OnLoadingScreenDisplayStarted="OnLoadingScreenDisplayStarted",e.OnLoadingScreenDisplayCompleted="OnLoadingScreenDisplayCompleted",e.WaitForUserContextStarted="WaitForUserContextStarted",e.WaitForUserContextCompleted="WaitForUserContextCompleted",e.WaitForUserContextFailed="WaitForUserContextFailed",e.OnAfterIntentAuthenticatedStarted="OnAfterIntentAuthenticatedStarted",e.OnAfterIntentAuthenticatedCompleted="OnAfterIntentAuthenticatedCompleted",e.IntentHookStarted="IntentHookStarted",e.IntentHookResolved="IntentHookResolved",e.IntentHookRejected="IntentHookRejected",e.IntentHookCompleted="IntentCompleted",e.IntentExecuted="IntentExecuted",e.Failure="Failure",e.Focus="Focus",e.Incomplete="Incomplete",e.LayoutRendered="LayoutRendered",e.LayoutRenderUpdated="LayoutRenderUpdated",e.NavigationCommandStart="NavigationCommandStart",e.NotHandled="NotHandled",e.Rendered="Rendered",e.RenderStarted="RenderStarted",e.ScenarioEventDataAppended="ScenarioEventDataAppended",e.ScenarioMarked="ScenarioMarked",e.SlotPhasedRenderingTimedOut="SlotPhasedRenderingTimedOut",e.Toggled="Toggled",e.UnmountStarted="UnmountStarted",e.WindowCreated="WindowCreated",e.WindowUpdated="WindowUpdated",e.WindowNotUpdated="WindowNotUpdated"}(n||(n={}))},218551:(e,t,i)=>{"use strict";var n,a,s;i.d(t,{yU:()=>n,FV:()=>a,c4:()=>s}),function(e){e.ActiveEntitiesResolved="active_entities_resolved",e.ActiveEntitiesDestroyed="active_entities_destroyed",e.AppSelectionChanged="app_selection_changed_resolved",e.ExperienceIdleStateChanged="experience_idle_state_changed",e.InitialDeeplinkResolved="initial_deep_link_resolved",e.NavigationIntentExecuted="navigation_intent_executed",e.UserAuthenticated="user_authenticated",e.UserConsentedToConsumeResources="user_consented_to_consume_resources"}(n||(n={})),function(e){e.LayoutRenderComplete="layout_render_complete",e.LayoutRenderCancelled="layout_render_cancelled",e.WindowStateChange="window_state_change",e.WindowOptionsChange="window_options_change"}(a||(a={})),function(e){e.Started="app_started",e.Initialized="app_initialized",e.ExperienceWarm="experience_warm",e.UserWarm="user_warm",e.ExperienceIdle="experience_idle",e.WindowWarm="window_warm"}(s||(s={}))},157930:(e,t,i)=>{"use strict";var n,a;i.d(t,{t:()=>n,H:()=>a}),function(e){e.HighMemoryUsage="HighMemoryUsage",e.CallingStackInitTimeoutOrFailure="CallingStackInitTimeoutOrFailure",e.GroupCallTimeoutOrFailure="GroupCallTimeoutOrFailure"}(n||(n={})),function(e){e.MeetingsAudio="1",e.MeetingsVideoOrScreenSharing="2",e.CallingCallDrops="3",e.MessagingOther="5",e.ActivityFeed="6",e.Crashing="7",e.Files="8",e.SearchSERPSearchResultsPage="9",e.SearchPowerbarAutosuggest="10",e.Other="11",e.MeetingsLiveCaptionsOrTranscript="14",e.TeamsChannelsMembership="15",e.Accessibility="17",e.Calendar="18",e.MeetingsOther="19",e.PlatformApps="20",e.PlatformBotsConnectors="21",e.PlatformTabs="22",e.TeamsChannelsCreateManageSettings="23",e.MessagingSync="25",e.PeopleProfiles="26",e.StatusPresence="27",e.TeamsChannelsPrivateAndSharedChannels="28",e.LocalizationTranslation="29",e.MeetingsAgendaNotes="30",e.MessagingCreateNewOrEdit="31",e.MessagingConversationWithExternalOrSkypeUsers="32",e.Tasks="34",e.Lists="35",e.Approvals="36",e.CallingOther="38",e.Performance="39",e.MessagingChatWindow="40",e.MessagingMissingOrDelayed="41",e.VivaLearning="42",e.MeetingsPowerPointLive="43",e.MeetingsChat="44",e.MeetingsRecording="45",e.MeetingsBreakoutRooms="46",e.MeetingsJoinExperience="47",e.MeetingsGalleryViews="48",e.CallingAudio="49",e.CallingVideoOrScreenSharing="50",e.VirtualAppointments="51",e.MeetingsSpeakerCoach="52",e.NotificationToasts="53",e.WebinarsVirtualEvents="54",e.MessagingVideo="55",e.MeetingsExcelLive="56",e.MeetingsWordLive="57",e.Avatars="58",e.ImmersiveSpace="59",e.MessagingLoopComponents="60",e.Discover="61",e.MeetingsMeetApp="62",e.Communities="63",e.Dashboard="64",e.Photos="65",e.Groups="66",e.InvitingJoiningTeams="67",e.Gaming="68",e.MessagingMessageCompose="70",e.MessagingMessagePaneScrolling="71",e.MessagingReactionsEmojisGIFsStickers="72",e.TeamsChannelsApp="73",e.UpdatesApp="74",e.MeetingsAttendanceReport="75",e.Devices="76",e.VideoFilters="77",e.AuthenticationOrSignIn="78",e.PerformanceMemory="79",e.DesktopAppLaunch="80",e.DesktopAppUpdate="81",e.TaskbarOrSystrayExperiences="82",e.Settings="83",e.AppSwitcherPreview="84",e.MeetingsRecap="86",e.FlyoutAndMinimode="87",e.MultiTenantMultiAccount="88",e.CallingCallNotifications="89",e.TagsChatMentions="90",e.TagsManagement="91",e.MeetingsCopilot="92",e.MessagingSMSIntegration="93",e.PlatformWorkflowsAndConnectors="94"}(a||(a={}))},598135:(e,t,i)=>{"use strict";var n;i.d(t,{P:()=>n}),function(e){e.UnableToCreateChat="UnableToCreateChat",e.UnableToCreateGuardianChatTFL="UnableToCreateGuardianChatTFL",e.UnableToCreateThrottledUserChatTFL="UnableToCreateThrottledUserChatTFL",e.UnableToAddParticipant="UnableToAddParticipant",e.UnableToAddParticipantGuardianChatTFL="UnableToAddParticipantGuardianChatTFL",e.UnableToRemoveParticipant="UnableToRemoveParticipant",e.UnableToRemoveParticipantGuardianChatTFL="UnableToRemoveParticipantGuardianChatTFL",e.UnableToLeaveChat="UnableToLeaveChat",e.UnableToLeaveGuardianChatTFL="UnableToLeaveGuardianChatTFL",e.UnableToDeleteChat="UnableToDeleteChat",e.UnableToViewChat="UnableToViewChat"}(n||(n={}))},646388:(e,t,i)=>{"use strict";var n;i.d(t,{i:()=>n}),function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Info=3]="Info",e[e.Debug=4]="Debug",e[e.Verbose=5]="Verbose",e[e.Max=6]="Max"}(n||(n={}))},699355:(e,t,i)=>{"use strict";i.d(t,{Hl:()=>n,TS:()=>a,n0:()=>s,fo:()=>o});const n=["/l/auth-callback","/convene/events","/convene/meet","/embed-client/chats","/l/app","/l/auth/google","/l/autoinstallnotification","/l/calendar/scheduling-form","/l/calendar/surface","/l/campaign/chat","/l/campaign/meeting","/l/channel-dashboard","/l/channel","/l/chat","/l/claim","/l/community/create-event","/l/community/events","/l/community/create-post","/l/community/create","/l/community/edit","/l/community/add-member","/l/community/invite","/l/community","/l/discover-teams","/l/entity","/l/file","/l/fileshare","/l/invite/","/l/manageApps","/l/manage-teams/myinvites","/l/meeting/new","/l/meeting/details","/l/meetingrecap","/l/meetup-join","/l/message","/l/meeting-share","/l/present","/l/share-email","/l/store","/l/task","/l/team-dashboard","/l/team","/l/trial/teamsPremiumLicenseRequest","/l/trial/teamsPremiumTrial","/l/teamsInsider","/meet","/notdefaultapp","/l/stage","/subscriptionmanagement","/l/copilot","/l/virtualevent/new","/l/virtualevent"];var a,s,o;!function(e){e[e.SourceWindowAccount=0]="SourceWindowAccount",e[e.MainWindowAccount=1]="MainWindowAccount",e[e.UserChoiceFallback=2]="UserChoiceFallback"}(a||(a={})),function(e){e.core="core",e.flyout="flyout",e.default="default"}(s||(s={})),function(e){e.mini="mini",e.main="main"}(o||(o={}))},793989:(e,t,i)=>{"use strict";var n;i.d(t,{vW:()=>n,o_:()=>a,Tf:()=>s}),function(e){e[e.Background=0]="Background",e[e.Macro=1]="Macro",e[e.RenderBlocking=2]="RenderBlocking",e[e.UserVisible=3]="UserVisible"}(n||(n={}));const a=-1;var s;!function(e){e[e.None=0]="None",e[e.Canceled=1]="Canceled",e[e.Received=2]="Received",e[e.Started=3]="Started",e[e.Complete=4]="Complete"}(s||(s={}))},888418:(e,t,i)=>{"use strict";var n;i.d(t,{V:()=>n}),function(e){e[e.None=0]="None",e[e.LoggedInConsole=1]="LoggedInConsole",e[e.AddedIntoDiagnostics=2]="AddedIntoDiagnostics",e[e.ThrottledForDiagnostics=4]="ThrottledForDiagnostics",e[e.SentToTelemetry=8]="SentToTelemetry"}(n||(n={}))},109062:(e,t,i)=>{"use strict";var n,a;i.d(t,{G:()=>n,T:()=>a}),function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online"}(n||(n={})),function(e){e.Offline="Offline",e.Online="Online",e.Unknown="Unknown",e.SuspectedOffline="Suspected Offline"}(a||(a={}))},328942:(e,t,i)=>{"use strict";var n,a;i.d(t,{Z:()=>n,d:()=>a}),function(e){e.AppUpdatedUsingServiceWorker="AppUpdatedUsingServiceWorker",e.AuthTokenForceRefresh="AuthTokenForceRefresh",e.ClearContainer="ClearContainer",e.CloudMismatchOnLogIn="CloudMismatchOnLogIn",e.ErrorPageReboot="ErrorPageReboot",e.ErrorPageSignOut="ErrorPageSignOut",e.RemoveAuthenticatedUser="RemoveAuthenticatedUser",e.RingSwitch="RingSwitch",e.LanguageSwitch="LanguageSwitch",e.HighMemory="HighMemory",e.TeamsInsiderSwitch="TeamsInsiderSwitch"}(n||(n={})),function(e){e.Auth="Auth",e.DeveloperSwitchersService="DeveloperSwitchersService",e.ReloadAppTask="ReloadAppTask",e.WebClientUpdateService="WebClientUpdateService",e.RemoveAuthenticatedUserResolver="RemoveAuthenticatedUserResolver",e.Core="Core"}(a||(a={}))},157867:(e,t,i)=>{"use strict";var n,a;i.d(t,{Q:()=>n,N:()=>a}),function(e){e.Unknown="unknown",e.Prod="prod"}(n||(n={})),function(e){e.MW="MW",e.Anglr="Anglr",e.ShareToTeams="ShareToTeams",e.Files="Files",e.Calendar="Calendar",e.MtgOpt="MtgOpt",e.EmbedClient="EmbedClient",e.LmsIntegration="LmsIntegration",e.CallingEmbed="CallingEmbed",e.ReactWebClient="ReactWebClient",e.Example="Example"}(a||(a={}))},719388:(e,t,i)=>{"use strict";i.d(t,{I:()=>a});const n="IntentPersistenceService";class a{constructor(e){this._localStorage=e}getAllStoredDeeplinks(){const e=this._localStorage.get(n,"Experience");return this.jsonParseSafe(e)||{}}storeDeeplink(e,t){const i=this.getAllStoredDeeplinks();i[e]=t.toString(),this.persist(i)}deleteDeeplink(e){const t=this.getAllStoredDeeplinks();delete t[e],this.persist(t)}clear(){this._localStorage.remove(n,"Experience")}persist(e){this._localStorage.set(n,JSON.stringify(e),"Experience")}jsonParseSafe(e){if(e)try{return JSON.parse(e)}catch(e){return}}}},428768:(e,t,i)=>{"use strict";var n,a;i.d(t,{f:()=>n,a:()=>a}),function(e){e.AssignedPriorityStatusToToast="AssignedPriorityStatusToToast",e.CallsActionTypeToNotificationActionFailed="CallsActionTypeToNotificationActionFailed",e.CallingToastActionMutationFailed="CallingToastActionMutationFailed",e.ChatActionTypeToNotificationActionFailed="ChatActionTypeToNotificationActionFailed",e.ChatTabsFetchFailed="ChatTabsFetchFailed",e.ChatToastActionMutationFailed="ChatToastActionMutationFailed",e.ChatToastEmoticonsQueryFailed="ChatToastEmoticonsQueryFailed",e.ChannelToastEmoticonsQueryFailed="ChannelToastEmoticonsQueryFailed",e.CollectionIdUndefined="CollectionIdUndefined",e.ConversionToHostEntityOptionsFailed="ConversionToHostEntityOptionsFailed",e.ConversationAlerts="ConversationAlerts",e.ConversationIsMuted="ConversationIsMuted",e.ConversationFetchFailed="ConversationFetchFailed",e.DateConversionFailed="DateConversionFailed",e.DefinedIfToastCanIgnoreConversationMuted="DefinedIfToastCanIgnoreConversationMuted",e.EmptyEvent="EmptyEvent",e.EventFromSelf="EventFromSelf",e.EventDiscarded="EventDiscarded",e.ExtractedSettings="ExtractedSettings",e.ImageFetchFailed="ImageFetchFailed",e.ImageUrlGenerationFailed="ImageUrlGenerationFailed",e.LogToastInfo="LogToastInfo",e.MappingCommandOptions="MappingCommandOptions",e.MappingOfToastInResolver="MappingOfToastInResolver",e.GraphItemToastUnhandledType="GraphItemToastUnhandledType",e.NoAutheticatedUserOrTrackingService="NoAutheticatedUserOrTrackingService",e.NotEnabled="NotEnabled",e.PriorityAssignmentSkipped="PriorityAssignmentSkipped",e.RequiredFieldMissing="RequiredFieldMissing",e.ReturningFetchedImage="ReturningFetchedImage",e.ReturningHardcodedImage="ReturningHardcodedImage",e.ReturningUserKeyForToastCollection="ReturningUserKeyForToastCollection",e.SkippingPriorityMessageFromLongpoll="SkippingPriorityMessageFromLongpoll",e.SubscriptionFailed="SubscriptionFailed",e.Subscribing="Subscribing",e.ToastCommandSent="ToastCommandSent",e.ToastEventIsAlreadyRead="ToastEventIsAlreadyRead",e.ToastEventReceivedInJob="ToastEventReceivedInJob",e.ToastEventReceivedInWorkerResolver="ToastEventReceivedInWorkerResolver",e.ToastImageAsDataUriIsUndefined="ToastImageAsDataUriIsUndefined",e.ToastNavigationDataNotFound="ToastNavigationDataNotFound",e.ToastSuppressedForWindowInFocus="ToastSuppressedForWindowInFocus",e.UnhandledType="UnhandledType",e.UnhandledSubtype="UnhandledSubtype",e.UpdateBlockingCacheWithOSDnD="UpdateBlockingCacheWithOSDnD",e.OSDnDBannerJobUserFetchFailed="OSDnDBannerJobUserFetchFailed",e.YieldingToastFromWorkerResolver="YieldingToastFromWorkerResolver",e.IsChannel="IsChannel",e.MentionHandledByActivityManager="MentionHandledByActivityManager",e.InvalidType="InvalidType",e.ToastDisabledByCoreSettings="ToastDisabledByCoreSettings",e.MissingConversationId="MissingConversationId",e.CommunityEvent="CommunityEvent",e.MappingException="MappingException",e.ProfileFetchFailed="ProfileFetchFailed",e.ToastThrottled="ToastThrottled"}(n||(n={})),function(e){e.PhonelinkSmsPrefix="phonelink:"}(a||(a={}))},500254:(e,t,i)=>{"use strict";i.d(t,{E:()=>r,z:()=>c});var n=i(850402),a=i(905581),s=i(132756);let o;const r=e=>t=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(!o)return e(t);return e(t).then((e=>(null==o||o.processResponse(e),e))).catch((e=>{throw null==o||o.processError(e),e}))}));function c(e,t){if(o){throw(0,a.Tr)(s.w5.Tasks,s.jK.AlreadyInitialized,"subscribeToSendNetworkTracking",void 0,"subscription exists")}o={processResponse:e,processError:t};return()=>{o=void 0}}},985937:(e,t,i)=>{"use strict";i.d(t,{Cu:()=>o,pf:()=>r,f2:()=>c,IA:()=>l,nU:()=>d,zj:()=>u,IY:()=>m,K4:()=>g});var n=i(486070);const a="prod",s="infer";function o(e){return e.includes("local")?"local":e.includes("-oncdn-")?"container":"production"}function r(e,t){var i,n,a;try{const t=c(e),n=null===(i=null==t?void 0:t.dataset)||void 0===i?void 0:i.config;return n?JSON.parse(decodeURIComponent(n)):{}}catch(e){const i=`Failed to parse head-data config with error: ${e}`;(null==t?void 0:t.errorToTelemetry)?null===(n=null==t?void 0:t.errorToTelemetry)||void 0===n||n.call(t,i,"webclient_framework_head_config",void 0,!0):null===(a=null==t?void 0:t.error)||void 0===a||a.call(t,i)}return{}}function c(e){const t=null==e?void 0:e.document.getElementsByTagName("head");if(t)return t[0]}function l(e){return-1!==((null==e?void 0:e.navigator.userAgent)||"").indexOf("maglev/")}function d(e){const t=e.navigator.userAgent.match(/maglev\/(\d+\.\d+\.\d+\.\d+)/);return t&&t.length>1?t[1]:void 0}function u(e,t){let i=(null==t?void 0:t.environment)||a;return i===s&&(i=function(e){return e.location.origin.includes("gov")?"gcchigh":e.location.origin.includes("dod")?"dod":e.location.origin.includes("live")?"life":"prod"}(e)),i}const m=e=>e===n.UF.UpgradeNonBlocking||e===n.UF.Warm;function g(e){var t,i;const n=null===(i=null===(t=e.navigator)||void 0===t?void 0:t.serviceWorker)||void 0===i?void 0:i.controller;return"activated"===(null==n?void 0:n.state)}},778452:(e,t,i)=>{"use strict";i.d(t,{I:()=>P,s:()=>O});var n,a,s=i(850402);!function(e){e.apps="apps",e.broadcasts="broadcasts",e.chats="chats",e.calls="calls",e.calendars="calendars",e.extensions="extensions",e.files="files",e.licenses="licenses",e.meetings="meetings",e.teamgallery="teamgallery"}(n||(n={})),function(e){e.list="list",e.create="create",e.join="join",e.error="error",e.view="view"}(a||(a={}));var o=i(424356),r=i(275742);const c=1e3,l=new Map,d=/^\/|\/$/g;function u(e,t){const i=t?":":"",n=e.id?`/${i}${e.id}`:"",a=e.action?`/${e.action}`:"";return`${e.resource}${n}${a}`}function m(e){const{descriptor:t,asPath:i,stem:n=""}=e,a=(0,s.__rest)(e,["descriptor","asPath","stem"]);let o=n;const r=t?t.resources:void 0;if(r&&r.length>0)for(const e of r)o=`${o}/${u(e,i)}`;return Object.assign(Object.assign({},a),{descriptor:t,asPath:i,stem:o})}function g(...e){return e.reduce(((e,t)=>(e.resources=e.resources.concat(t.resources),e.search=Object.assign(Object.assign({},e.search),t.search),e)),{resources:[],search:{}})}function h(e){return(0,r.flow)([m,b,y])(e).stem}function p(e){if(!e||0===e.length)return[];const t=l.get(e);if(t)return t;let i=[];const s=e.replace(d,"");if(0===s.length)return i;const o=s.split("/");try{const t=function(e){const t=[];let i=-1;for(const a of e){const e=a;n[e]&&(i++,t[i]=[]),i>=0&&t[i].push(e)}return t}(o);return t&&(i=t.map((e=>{let t;const i=2,n=3;switch(e.length){case n:t={resource:e[0],id:e[1],action:e[i]};break;case i:{const i=e[1];t=a[i]?{resource:e[0],action:e[1]}:{resource:e[0],id:e[1]};break}default:throw new Error("Invalid resource fragment format found, id or action is required.")}return t}))),l.size<c&&l.set(e,i),i}catch(e){throw new Error(`Unable to parse path into proper resources. ${e.message}`)}}function v(e){return(0,o.parse)(e||"")}function f(e){return(0,o.stringify)(e||{})}function b(e){const{context:t,asPath:i,stem:n=""}=e;let a=n;if(t){const e=t.router;if(!e)throw new Error("Cannot generate a relative path without a context. Verify a context was added provided");{const t=i?e.route.match.path:e.route.match.url;a="/"!==t?`${t}${a}`:a}}return Object.assign(Object.assign({},e),{stem:a})}function y(e){const{descriptor:t,asPath:i,stem:n=""}=e;let a=n;if(t){const e=f(t.search);e&&(a=`${a}${i?`/:${e}`:`?${e}`}`)}return Object.assign(Object.assign({},e),{stem:a})}function k(e){const{pathname:t,search:i}=e;return{resources:p(t),search:v(i)}}class S{constructor(e,t){this.history=t,this._logger=e.newLogger("Routing Service","core-services-routing")}navigate(e){const t=function(e){const{search:t}=e,i=(0,s.__rest)(e,["search"]),n=f(t);return{pathname:h({descriptor:i}),search:n}}(e);this.execute(t)}execute(e){this.history?this.history.push(e):this._logger.error("Unable to route using history. History initialized with undefined")}}class w{constructor(e,t,i){this._location=t,this._history=i,this._logger=e.newLogger("State Routing Service","core-services-routing")}getSearchState(){const e=this.getLocation();if(!e)return{};const t=e.search;return t!==this._previousSearch&&(this._previousSearch=t,this._currentState=v(t)),this._currentState||{}}getOrigin(){const e=this.getLocation();return e&&e.origin}getHost(){const e=this.getLocation();return e&&e.host}getPathname(){const e=this.getLocation();return e&&e.pathname}getLocation(){if(this._location||this._logger.error("Unable to execute on location. Location initialized with undefined"),this._location&&this._history&&this._history.location){const{search:e,pathname:t}=this._history.location;return Object.assign(Object.assign({},this._location),{search:e,pathname:t})}return this._location}}var j;!function(e){e.OrgChart="organization"}(j||(j={}));class C{constructor(e,t){this.routingService=e,this.rootRoutingService=t}toCreateChatWithUsers(e){this.routingService.navigate(this.createChatWithUsersDescriptor(e))}toChatById(e){this.routingService.navigate(this.chatByIdDescriptor(e))}toOrgChart(e){this.routingService.navigate(this.orgChartDescriptor(e))}toChatList(){this.routingService.navigate(this.chatListDescriptor())}chatByIdDescriptor(e){return this.concatToAppDescriptor({resources:[{resource:n.chats,id:e}]})}createChatWithUsersDescriptor(e){const t=JSON.stringify(e&&e.length>0?e.sort():[]);return this.concatToAppDescriptor({resources:[{resource:n.chats,action:a.create,id:t}]})}chatListDescriptor(){return this.concatToAppDescriptor({resources:[{resource:n.chats,action:a.list}]})}orgChartDescriptor(e){return g(this.createChatWithUsersDescriptor([e]),{resources:[{resource:n.extensions,id:j.OrgChart}]})}concatToAppDescriptor(e){return g(this.rootRoutingService.chatAppDescriptor(),e)}}class _{constructor(e,t){this.routingService=e,this.rootRoutingService=t}toCallById(e){this.routingService.navigate(this.callByIdDescriptor(e))}toCallList(){this.routingService.navigate(this.callsListDescriptor())}callByIdDescriptor(e){return this.concatToAppDescriptor({resources:[{resource:n.calls,id:e}]})}callsListDescriptor(){return this.concatToAppDescriptor({resources:[{resource:n.calls,action:a.list}]})}concatToAppDescriptor(e){return g(this.rootRoutingService.callingAppDescriptor(),e)}}class T{constructor(e){this._routingService=e}toAppById(e){this._routingService.navigate(this.appDescriptor(e))}chatAppDescriptor(){return this.appDescriptor("com.microsoft.teams.chat")}callingAppDescriptor(){return this.appDescriptor("com.microsoft.teams.calling")}meetingOptionsAppDescriptor(){return this.appDescriptor("com.microsoft.teams.meetingOptions")}fileAppDescriptor(){return this.appDescriptor("com.microsoft.teams.files")}appDescriptor(e,t){return{resources:[{resource:n.apps,id:e,action:t}]}}}var I;!function(e){e[e.Allow=0]="Allow",e[e.Block=1]="Block"}(I||(I={}));class N{constructor(){this._taps=[]}tap(e){return this._taps.push(e),()=>{this._taps=this._taps.filter((t=>t!==e))}}call(e){let t;for(const i of this._taps){const n=i({data:e,previousResult:t});void 0!==n&&(t=n)}return t}}class E{constructor(e){this._history=e,this.onNavigationBlocked=new N,this.onNavigationStart=new N,this.onNavigationSucceeded=new N,this._handleNavigationStart=e=>{if(!this._history||!this._history.location)return;const t=k(this._history.location),i=k(e);return this.onNavigationStart.call({from:t,to:i})===I.Block?(this.onNavigationBlocked.call({to:i}),!1):void 0},this._handleNavigationSuccess=e=>{const t=k(e);this.onNavigationSucceeded.call({to:t})},this._history&&this._history.block&&this._history.block(this._handleNavigationStart),this._history&&this._history.listen&&this._history.listen(this._handleNavigationSuccess)}}var F=i(905581),x=i(132756);class D{meetingOptionsPageDescriptor(e){const{tenantId:t,organizerId:i,threadId:a,messageId:s,additionalMessageId:o,search:r}=e;return{resources:[{resource:n.meetings,id:JSON.stringify({tenantId:t,organizerId:i,threadId:a,messageId:s,additionalMessageId:o})}],search:r}}meetingOptionsLicenseDescriptor(e){return{resources:[{resource:n.licenses,action:a.list}],search:e?e.search:void 0}}}class A{constructor(e,t){this._history=t,this._logger=e.newLogger("External Routing Service","core-services-routing")}serializeToPath(e){const{descriptor:t,exact:i}=e;let n="";return t&&(n=h({descriptor:t})),this._history?i||(n=this._history.createHref({pathname:n}).toString()):i&&this._logger.error("Unable to execute on history to generate absolute path. History initialized with undefined"),n}}let M;const P=(e,t,i)=>{const n=new S(e,t),a=new T(n),s={state:new w(e,i,t),root:a,call:new _(n,a),chat:new C(n,a),meeting:new D,external:new A(e,t),hooks:new E(t)};return M=s,M},O=()=>{if(!M)throw(0,F.Tr)("RoutingServices",x.jK.NotInitialized,"getInstance");return M}},368310:(e,t,i)=>{"use strict";i.d(t,{qo:()=>r,Q6:()=>s,bE:()=>o});var n=i(50805),a=i(275742);const s=e=>{const t=e.get(n.J.Host).enableSyncEngine;return(0,a.isNil)(t)?!!e.get(n.J.CdlWorker).enableSyncEngine:t},o=e=>{const t=e.get(n.J.Host).enableProfileManagerStore;return(0,a.isNil)(t)?!!e.get(n.J.People).enableProfileManagerStore:t},r=e=>{const{dataStoreMapType:t,disableDataStoreInMemoryProvider:i}=e.get(n.J.CdlWorker);return i?"none":t||"red-black-tree"}},656618:(e,t,i)=>{"use strict";i.d(t,{RT:()=>l,iI:()=>d,Y3:()=>u,u0:()=>m,JX:()=>g,xb:()=>h,mN:()=>y});var n=i(690344),a=i(563125),s=i(50805),o=i(143285);const r="99999999999",c="ringFinder",l="https://config.teams.microsoft.com",d="1.0.0.0",u="1415",m="MicrosoftTeams";function g(e){const t=Object.keys(o.z).filter((e=>isNaN(Number(e))));for(let i=0;i<t.length;i++)if(e===t[i])return i}function h({experienceName:e,coreSettings:t,platformService:i,user:a,locale:o,logger:r}){const g=function(e,t,i){const{primaryUserProfile:a}=e.get(s.J.Host);if(a)return{userId:a.oid,tenantId:a.tid};return i||function(e){try{const e=n.get(c);if(!e)return;const{oid:t,tid:i}=JSON.parse(decodeURIComponent(e));return{userId:t,tenantId:i}}catch(t){return void e.warn(`Error parsing ringFinder cookie when user not authenticated: ${t}`)}}(t)}(t,r,a),{ecsOverrides:h,config:{platformId:y,buildVersion:k,buildType:S,osPlatform:w}}=i,{ecsNamespaces:j,criticalEcsNamespaces:C,ecsEndpoint:_,enableEcsNativeRingResolution:T,disableSendOsVersionWithEcsRequest:I,enableUbrInOsVersion:N}=t.get(s.J.Core),E=function(e,t){const{environment:i="prod",ring:n,originalRing:a}=e,s={environment:i};t&&!a||(s.audienceGroup=n,s.teamsRing=n);return s}(h,T),{ecsHostUrl:F,electronVersion:x,windowsInsiderChannel:D,windowsInsiderRing:A}=t.get(s.J.Host),{deviceInfo:M}=t.get(s.J.Platform),P=h.hostUrl||F||_||l;return{version:`${y||u}_${d}`,domain:P,client:m,agents:j,criticalAgents:C,filters:Object.assign(Object.assign({},E),{experience:e,buildType:S,virtualization:f(t,i),osPlatform:w,wipChannel:D,wipRing:A,osVersion:I?void 0:p(M,!!N,r),id:null==g?void 0:g.userId,aaduserid:null==g?void 0:g.userId,tenantId:null==g?void 0:g.tenantId,experienceBuild:b(S,k),desktopVersion:v(t,i),electronVersion:x,teamsLocale:o})}}function p(e,t,i){var n;if(!e||!e.osVersion)return;let s=e.osVersion;if(t&&e.ubrVersion&&!isNaN(parseInt(e.ubrVersion,10))&&(s=`${e.osVersion}.${e.ubrVersion}`),(0,a.validate)(s))return s;null===(n=i.errorNoPii)||void 0===n||n.call(i,`osVersion parsed from deviceInfo is not a proper semver '${s}'.`)}function v(e,t){const{desktopVersion:i}=e.get(s.J.Host);if(i){const e=i.indexOf("/");return e>-1?i.substr(e+1):i}return t.host.hostAppVersion}function f(e,t){var i;const{virtualization:n}=e.get(s.J.Host);return null!=n?n:null===(i=t.config.vdi)||void 0===i?void 0:i.configFilter}function b(e,t){if("local"===e||"container"===e)return r;if(t){const e="1.0.0.20",i=6;if((t=`${t}`).startsWith(e)){const n=t.substring(e.length,e.length+i),a=t.substring(e.length+i);t=`${n}000${a}`}const n=parseInt(t,10);if(!isNaN(n))return n.toString()}}function y(e){if(!e)return;const t=e.getTime(),i=(new Date).getTime();return t<i?i-t:0}},412938:(e,t,i)=>{"use strict";i.d(t,{YK:()=>C,Lk:()=>E});var n,a=i(850402),s=i(50805),o=i(982190),r=i(974509),c=i(455572);!function(e){e.HEALTHY="healthy",e.UNHEALTHY="unhealthy",e.UNKNOWN="unknown"}(n||(n={}));var l=i(137021),d=i(89062),u=i(575644),m=i(781662),g=i(915929),h=i(905581);const p=3e4,v={headers:{sharePoint:{SPRequestGuid:"SPRequestGuid",SPClientServiceRequestDuration:"SPClientServiceRequestDuration",SPRequestDuration:"SPRequestDuration"}}},f="cache",b="cache-control",y="x-cache",k="electron";var S;!function(e){e.CDN="CDN",e.Shared="Shared",e.Browser="Browser",e.None="None"}(S||(S={}));let w="";function j(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{status:t,responseHeaders:i,requestHeaders:n,performance:s}=e,o=yield function(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){try{return yield(0,u.E)(e,p)}catch(e){return}}))}(s);return Object.assign(e,{requestHeaders:(r=n,T(["clientRequestId","x-ms-request-id"],r)),responseHeaders:N(t,i),performance:D(o)});var r}))}const C=(e,t,i,r="")=>{var c;const u=(null!==(c=t.get(s.J.Telemetry).httpnsDisabledServices)&&void 0!==c?c:[]).map((e=>e.toLowerCase()));return t=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const{serviceName:s,apiName:c,result:p,innerError:v,operationLogs:f}=t;if(v&&(0,h.Wc)(v))return;t.operationLogs=yield function(e){const t=e.map((e=>(0,a.__awaiter)(this,void 0,void 0,(function*(){const{type:t,duration:i,result:n,request:a}=e;return{type:t,duration:i,result:n,request:a&&(yield j(a))}}))));return Promise.all(t)}(f);const b=s.toLowerCase(),y=u.some((e=>e===b));w=r;const k=t.correlationId||(0,g.v4)(),S=P(s,c);i.log(`Data call ${S} is completed with ${p}. CorrelationId: ${k}`),y||t.operationLogs.forEach((t=>{if(t.request){const{name:i,method:n}=t.request;F(e,M(s,i||c,n),"EM",t,k)}})),function(e,t,i){var a,s;const{serviceName:r,apiName:c,createdTime:u,duration:g,parameters:h,result:p,innerError:v,operationLogs:f}=e,b=function(e,t){const i=(0,m.G)().getEndpointHealth(e,t);return void 0===i?n.UNKNOWN:i?n.HEALTHY:n.UNHEALTHY}(r,c);f.forEach((e=>{if(e.request){const{method:t}=e.request;!function(e,t,i,n,a,s,r){const c=t.request;if(c){const{duration:u,result:m}=t,{method:g,hostname:h,performance:p,responseHeaders:v,requestHeaders:f,dateTime:b,authPerformanceLogs:y}=c,k={apiName:n,serviceName:a,duration:u,result:_(m),correlationId:i,method:g,hostname:h,responseHeaders:(0,d.u4)(v),requestHeaders:(0,d.u4)(f),healthState:s,timestamp:b.toISOString(),hasInnerError:!!r};p&&(p.duration&&(k.perf_duration=p.duration.toString()),k.perf_details=(0,d.u4)(Object.assign(Object.assign({},p),y))),(0,l.P3)(o.x.Endpoint,e,k,void 0,void 0,void 0,w)}}(M(r,c,t),e,i,c,r,b,v)}}));const y={apiName:c,serviceName:r,duration:g,result:p,innerError:(0,d.u4)(v),correlationId:i,userAgent:t.navigator.userAgent,timestamp:u,operationLogs:(0,d.u4)(f),parameters:(0,d.u4)(h),ECT:null===(s=null===(a=t.navigator)||void 0===a?void 0:a.connection)||void 0===s?void 0:s.effectiveType,healthState:b},k=P(r,c);(0,l.P3)(o.x.Endpoint,k,y,void 0,void 0,void 0,w)}(t,e,k)}))};function _(e){let t;return e instanceof Error&&(t=e.innerException?`${e.reason} / ${(0,d.u4)(e.innerException)}`:e.reason),t||e||""}function T(e,t){const i={};return t&&e.forEach((e=>{t[e]&&(i[e]=t[e])})),i}function I(e=""){if(!e)return e;let t=0;return e.split(",").forEach((e=>{const i=e.split("/");t+=+i[0]+ +i[1]})),`${t}`}function N(e,t){return t?{contentLength:t["content-length"]||"-1",serverRequestId:t.contextid||t["x-serverrequestid"]||t["request-id"]||x(t),[f]:A(e,t),requestId:t["x-ms-request-id"],invalidToken:t["x-invalid-token"],afdCorrelationId:t["x-msedge-ref"],serverLatency:t["x-end2endlatencyms"],serviceOrigin:t["x-servicering"],cafeLatency:I(t["x-cafeproxylatency"])}:{}}const E=(e,t,i,n,a,s,o)=>{const c=o||r.qb[null==n?void 0:n.status]||"",l=function(e){const t={};if(e)for(const i of Object.keys(e.headers)){t[i.toLowerCase()]=e.headers[i]}return t}(n),{serviceName:d,apiName:u,method:m,authPerformanceLogs:g}=i;F(s,M(d,u,m),"SEND",{type:r.nz.Initial,duration:e,result:c,request:{name:u||"undefined",dateTime:t,method:i.method,hostname:n&&new URL(n.url).hostname,status:null==n?void 0:n.status,requestHeaders:i.headers||{},responseHeaders:l,performance:a,authPerformanceLogs:g}},i.correlationId)};const F=({navigator:e},t,i,n,a)=>{var s;const u=n.request;if(u){const{dateTime:m,method:g,hostname:h,status:p,requestHeaders:v,responseHeaders:b,performance:y,authPerformanceLogs:S}=u,j={ECT:null===(s=null==e?void 0:e.connection)||void 0===s?void 0:s.effectiveType,hostname:h,transport:i,requestCreatedTime:m.toISOString(),networkState:e.onLine?c.XR.ONLINE:c.XR.OFFLINE,method:g,resultCode:p,requestResult:_(n.result),contentLength:b["content-length"]||-1,serverRequestId:b.contextid||b["x-serverrequestid"]||b["request-id"]||x(b),correlationId:a,duration:n.duration,authPerformanceLogs:(0,d.u4)(S)};!function(e,t,i,n,a){const s=n&&n.clientRequestId,o=i["x-ms-request-id"]||n["x-ms-request-id"];e.requestId=o,s&&(e.clientRequestId=s);i["x-invalid-token"]&&(e.invalidToken=i["x-invalid-token"]);t!==r.qb.OK&&(e.afdCorrelationId=i["x-msedge-ref"]);e.hasClaims=!!a&&!!a.hasClaims}(j,p,b,v,S),j[f]=A(p,b),function(e,t,i){if(i){const n=i.domainLookupEnd-i.domainLookupStart,a=i.connectEnd-i.connectStart,s=i.redirectEnd-i.redirectStart;if(n>0&&(e.dns=n),a>0&&(e.tcp=a),s>0&&(e.redirect=s),e.size=i.transferSize,e.payload=i.encodedBodySize,e.start=i.startTime,e.reqStart=i.requestStart,e.respStart=i.responseStart,i.duration){const n=i.duration;(-1===t.userAgent.toLowerCase().indexOf(k)||e.duration&&n>e.duration)&&(e.duration=n)}}}(j,e,y),(0,l.P3)(o.x.Http,t,j,void 0,void 0,void 0,w)}};function x(e){let t=e[v.headers.sharePoint.SPRequestGuid.toLowerCase()]||"";return"[object String]"===Object.prototype.toString.call(t)&&t.length>0&&(t=[`${v.headers.sharePoint.SPRequestGuid}=${t}`,`${v.headers.sharePoint.SPClientServiceRequestDuration}=${e[v.headers.sharePoint.SPClientServiceRequestDuration.toLowerCase()]||""}`,`${v.headers.sharePoint.SPRequestDuration}=${e[v.headers.sharePoint.SPRequestDuration.toLowerCase()]||""}`].join(";")),t}function D(e){if(e){const{duration:t,domainLookupStart:i,domainLookupEnd:n,connectStart:a,connectEnd:s,redirectStart:o,redirectEnd:r,transferSize:c,encodedBodySize:l,startTime:d,requestStart:u,responseStart:m}=e;return{duration:t,dns:n-i,tcpHandshakeTime:s-a,redirectTime:r-o,transferSize:c,encodedBodySize:l,startTime:d,requestStart:u,responseStart:m}}return{}}function A(e,t){let i=S.None;if(t.hasOwnProperty(b)){const n=t[b];e===r.qb.NOT_MODIFIED?i=S.Browser:n.includes("no-store")||n.includes("no-cache")||(i=S.Browser,n.includes("public")&&(i+=", ".concat(S.Shared)))}else t.hasOwnProperty("expires")&&(i=S.Browser);if(t.hasOwnProperty(y)){t[y].toLowerCase().includes("hit")&&(i===S.None?i=S.CDN:i+=", ".concat(S.CDN))}return i}function M(e,t,i){return`${e}_${t||"undefined"}_${i}`}function P(e,t){return`${t}_${e}`}},907550:(e,t,i)=>{"use strict";i.d(t,{p:()=>c});var n=i(850402),a=i(974509),s=i(905581),o=i(132756),r=i(973730);function c(e){return t=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var i;try{return yield e(t)}catch(e){if(e instanceof TypeError&&(null===(i=e.message)||void 0===i?void 0:i.toLowerCase())===r.gZ){const i=t.headers&&t.headers.cache;if(i&&-1!==i.indexOf("only-if-cached"))return{status:a.qb.GATEWAY_TIMEOUT};e=(0,s.Tr)(o.w5.RejectHttpError,o.jK.RemoteOperationFailed,"rejectHttpError",void 0,e.message)}throw e}}))}},905493:(e,t,i)=>{"use strict";i.d(t,{Db:()=>h,tC:()=>p,j$:()=>v});var n=i(850402),a=i(974509),s=i(50805),o=i(486070),r=i(467452),c=i(756144);const l=10,d="",u=/\/api\/chatsvc\/.*?\//,m="teams.microsoft.com",g="teams.live.com";function h(e,t,i,s){let o=d;const r=s.newLogger("chat-service-redirect","core-services-transport");return s=>u=>(0,n.__awaiter)(this,void 0,void 0,(function*(){let n=0;for(;;){f(o)&&(o=yield v(t,i,r));const m=yield(0,c.G)(e(s),o)(Object.assign(Object.assign({},u),{headers:Object.assign(Object.assign({},u.headers),{BehaviorOverride:"redirectAs404"})})),{status:g,headers:{location:h}}=m;if(!h||g!==a.qb.NOT_FOUND)return g===a.qb.SERVICE_UNAVAILABLE||g===a.qb.BAD_GATEWAY?(o=d,m):m;if(n>=l)return m;if(o=p(h,r),o===d)return m;n+=1}}))}function p(e,t){let i;try{i=new URL(e)}catch(i){return t.error(`Location header ${e} is invalid: error message ${i.message}`),d}if(i.hostname===m||i.hostname===g){const n=i.pathname.match(u);return n&&n[0]?`${i.origin}${n[0]}`:(t.error(`No match of chatServiceAfd 404 location with regex, url is ${e}`),d)}return t.log("Url is a ATM Url, use previous parsing strategy."),new URL("/",e).href}function v(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{chatServiceHostOverrideUrl:n}=t.get(s.J.Test);if(n)return(a=n).endsWith("/")?a:`${a}/`;var a;if(function(e){var t,i;return null!==(i=null!==(t=e.get(s.J.Host).enableUseChatServiceAfd)&&void 0!==t?t:e.get(s.J.ChatService).useChatServiceAfd)&&void 0!==i?i:void 0}(t))try{return yield e(o.Pn.chatServiceAfd)}catch(t){if((0,r.B)(t))return i.warn("Flag useChatServiceAfd is set but chatServiceAfd was not found in the GTM table. Falling back to chatService."),e(o.Pn.chatService);throw t}return e(o.Pn.chatService)}))}function f(e){return e===d}},973730:(e,t,i)=>{"use strict";i.d(t,{EH:()=>n,gZ:()=>a,dX:()=>s});const n=3e4,a="failed to fetch",s="Request Timed Out"},787623:(e,t,i)=>{"use strict";i.d(t,{S:()=>r});var n=i(850402),a=i(974509),s=i(905581),o=i(132756);function r(e){return t=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield e(t);if(i.status>=a.qb.BAD_REQUEST)throw(0,s.Tr)(o.w5.RejectHttpError,o.jK.RemoteOperationFailed,"rejectHttpError",void 0,void 0,i);return i}))}},306179:(e,t,i)=>{"use strict";i.d(t,{Gg:()=>y,UZ:()=>f});var n=i(132756),a=i(922576),s=i(337625),o=i(318379),r=i(457333),c=i(568587),l=i(757738),d=i(170348),u=i(433728),m=i(875650),g=i(23474),h=i(352178);const p=([e,t])=>(t&&e.do((()=>{}),(e=>{throw e})),e),v=(e,t)=>{const i=e.pipe((0,o.R)(((e,i)=>e||!t(i)),!1)),n=e.pipe((0,r.P)(t),(0,c.V)(5e3));return(0,s.z)((0,l.i)(),(0,d.M)(i),(0,u.U)(p),(0,m.a)((e=>e.pipe((0,g.w)(n)))),(0,h.D)())};function f(e,t){return(...i)=>(0,a.P)((()=>e(...i))).pipe(v(t,k)).toPromise()}const b=e=>(e=>{switch(e){case n.eT.Disabled:case n.eT.Offline:return!1;default:return!0}})(e),y=e=>()=>b(e.getState()),k=e=>e},264011:(e,t,i)=>{"use strict";i.d(t,{s:()=>o,r:()=>r});var n=i(132756),a=i(614665),s=i(575644);function o(e,t){return i=>l((()=>e(i)),t)}function r(e,t){return i=>d(l((()=>e(i)),t),t)}const c=(e,t)=>{if(e.context===n.w5.RejectHttpError&&t.retryCount++<(t.policy.maxRetryCountForOffline||t.policy.maxRetryCount)&&t.policy.shouldRetryRejectHttpError)return t.policy.errorHandler(e,t);if(!e.serverResponse)throw e;const{serverResponse:{status:i}}=e;if(i&&t.retryCount++<t.policy.maxRetryCount&&t.policy.shouldRetry(i))return t.retriesTable[i]=(t.retriesTable[i]||0)+1,t.policy.errorHandler(e,t);throw e},l=(e,t)=>(0,a.X)(e,c)({policy:t,delay:t.createDelay(),retryCount:0,retriesTable:{}}),d=(e,t)=>(0,s.E)(e,t.retryMaxTimeMs)},535674:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var n=i(994593),a=i(575644),s=i(973730);const o=({url:e,method:t,body:i,headers:o,credentials:r,timeout:c=s.EH,skipHeaders:l=!1})=>{const d=new AbortController;return(0,a.E)(n(e,{method:t,headers:l?{}:o&&new Headers(o),body:i,credentials:r,signal:d.signal}),c,s.dX,d).then((e=>{const t={};return e.headers.forEach(((e,i)=>t[i]=e)),{status:e.status,headers:t,body:e,url:e.url}}))}},891772:(e,t,i)=>{"use strict";i.d(t,{l:()=>c});var n=i(500254),a=i(850402),s=i(412938);var o=i(535674),r=i(907550);const c=(0,n.E)(function(e){return t=>(0,a.__awaiter)(this,void 0,void 0,(function*(){let n,a;const o=performance.now(),r=new Date;try{return a=yield e(t),a}catch(e){throw n=e.code||e.message,a=e.serverResponse,e}finally{const e=performance.now();!function(e,t,n,a,o){const r=i.g;(0,s.Lk)(a,t,n,e,e&&function(e){const t=performance.getEntriesByName(e);if(t.length>0&&"resource"===t[t.length-1].entryType)return t[t.length-1];return}(e.url),r,o)}(a,r,t,e-o,n)}}))}((0,r.p)(o.A)))},71119:(e,t,i)=>{"use strict";i.d(t,{r:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataApolloClientTacoArchiveTeamInfoQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"archiveTeamResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"archiveSharepointSite"}}]}}]}}]}},628694:(e,t,i)=>{"use strict";i.d(t,{yL:()=>d,lY:()=>u,Gw:()=>m,kP:()=>g,fQ:()=>h});var n=i(516909),a=i(589857),s=i(701643),o=i(73480),r=i(281954),c=i(176992),l=i(919567);const d=(e,t,i,n,o)=>{if(t.from&&t.imDisplayName&&(i||t.attached))return t;const{fragment:r,fragmentTypeName:c,fragmentName:l}=m(o);try{const o=e.readFragment(i?{id:`${c}:${t.clientMessageId}`,fragment:r,fragmentName:l}:{id:`${(0,a.uG)(t)}`,fragment:s.xP,fragmentName:"replyMessage"});if(!o)return n&&n.warn(`getDataToWrite::No existing entry found in cache for ${i?"post":"reply"} with clientMessageId ${t.clientMessageId}. Returning given data.`),t;const d=i?void 0:o.attached;return Object.assign(Object.assign(Object.assign({},t),!i&&{attached:d}),{from:o.from,imDisplayName:o.imDisplayName})}catch(e){return n&&n.warn(`getDataToWrite::Failed to read ${i?"post":"reply"} fragment to replace existing lie for msg with clientMessageId ${t.clientMessageId}. Returning given data.`),t}};function u(e,t,i){const n=d(e,t,!1,i);try{const i=n.attached;e.writeFragment({id:`${(0,a.uG)(t)}`,fragment:s.xP,fragmentName:"replyMessage",data:Object.assign(Object.assign({},n),i&&{attached:i})})}catch(e){i&&i.error(`updateReplyChainSummariesWithReply::Failed writing replyChainMessage fragment to cache for clientMessageId ${t.clientMessageId}`)}}const m=e=>{switch(e){case n.hQF.Announcement:return{fragmentName:"announcementPostMessage",fragmentTypeName:"AnnouncementPostMessage",fragment:o.hb};case n.hQF.Guardians:return{fragmentName:"DataFragmentsCommonGuardiansPostMessageFragment",fragmentTypeName:"GuardiansPostMessage",fragment:c.N4};default:return{fragmentName:"standardPostMessage",fragmentTypeName:"StandardPostMessage",fragment:r.wZ}}},g=(e,t,i,o=n.hQF.Standard)=>t!==i?{id:(0,a.uG)({__typename:e,id:i}),fragmentName:"replyMessage",fragment:s.xP}:Object.assign({id:`${e}:${i}`},m(o)),h=(e,t)=>{let i;if(!t||t.deleteTime)return;if(e.from!==t.from)return;return p(e,t)?i=n.HBY.bottom:t.attached&&(i=n.HBY.top),i},p=(e,t)=>{if(e.messageType&&v(e.messageType)||t.messageType&&v(t.messageType))return!1;const i=t.originalArrivalTime&&new Date(t.originalArrivalTime),n=e.originalArrivalTime&&new Date(e.originalArrivalTime);return!(!n||!i)&&n.getTime()-i.getTime()<=5*l.A_},v=e=>!!e&&(/^(Event|Control|ThreadActivity)/.test(e)||"RichText/Media_CallRecording"===e||"RichText/Media_LocalRecording"===e)},73480:(e,t,i)=>{"use strict";i.d(t,{hb:()=>m});var n=i(370311),a=i(752412),s=i(684743),o=i(786541),r=i(830591),c=i(663193),l=i(4968),d=i(284688),u=i(752048);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"announcementPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnnouncementPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"announcement"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"originalImageUrl"}},{kind:"Field",name:{kind:"Name",value:"croppedImageUrl"}},{kind:"Field",name:{kind:"Name",value:"colorTheme"}},{kind:"Field",name:{kind:"Name",value:"croppedImageHeight"}},{kind:"Field",name:{kind:"Name",value:"croppedImageWidth"}},{kind:"Field",name:{kind:"Name",value:"croppedImageAltText"}},{kind:"Field",name:{kind:"Name",value:"isTeamsIllustration"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meeting"}}]}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}},...n.Uw.definitions,...a.w.definitions,...s.p.definitions,...o.S.definitions,...r.v.definitions,...c.w.definitions,...l.x.definitions,...d.I.definitions,...u.ev.definitions]}},154066:(e,t,i)=>{"use strict";i.d(t,{p:()=>m});var n=i(719840),a=i(281954),s=i(73480),o=i(114453),r=i(300624),c=i(613958),l=i(176992),d=i(701643),u=i(921983);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChannelReplyChainSummaryWithUserDetailsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainSummary"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"postMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"standardPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"announcementPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"emailPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"connectorPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonGuardiansPostMessageFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"previewMessageSet"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"replyMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingReplyMessage"}}]}},{kind:"Field",name:{kind:"Name",value:"mostRecentOverflowMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"totalReplies"}},{kind:"Field",name:{kind:"Name",value:"forceShowResponseSurface"}},{kind:"Field",name:{kind:"Name",value:"totalUsers"}},{kind:"Field",name:{kind:"Name",value:"recentUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}}]}},{kind:"Field",name:{kind:"Name",value:"recentUserDisplayNameHints"}},{kind:"Field",name:{kind:"Name",value:"creationTime"}},{kind:"Field",name:{kind:"Name",value:"updatedTime"}},{kind:"Field",name:{kind:"Name",value:"hasMention"}},{kind:"Field",name:{kind:"Name",value:"hasChannelMention"}},{kind:"Field",name:{kind:"Name",value:"hasImportance"}},{kind:"Field",name:{kind:"Name",value:"hasFiles"}},{kind:"Field",name:{kind:"Name",value:"hasCurrentUserMention"}},{kind:"Field",name:{kind:"Name",value:"hasUnreadPostMessage"}},{kind:"Field",name:{kind:"Name",value:"hasUnreadReplyMessage"}}]}},...n.T.definitions,...a.wZ.definitions,...s.hb.definitions,...o.tO.definitions,...r.z6.definitions,...c.zL.definitions,...l.N4.definitions,...d.xP.definitions,...u.SN.definitions]}},114453:(e,t,i)=>{"use strict";i.d(t,{tO:()=>m});var n=i(370311),a=i(752412),s=i(684743),o=i(786541);const r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"emailDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"from"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"sender"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"to"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"cc"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"emailLink"}},{kind:"Field",name:{kind:"Name",value:"totalRecipients"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"emailUser"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailUser"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"smtp"}}]}}]}.definitions]};var c=i(830591),l=i(663193),d=i(4968),u=i(284688);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"emailPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"emailDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailDetails"}}]}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}},...n.Uw.definitions,...a.w.definitions,...s.p.definitions,...o.S.definitions,...r.definitions,...c.v.definitions,...l.w.definitions,...d.x.definitions,...u.I.definitions]}},752048:(e,t,i)=>{"use strict";i.d(t,{ev:()=>n});const n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meeting"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Meeting"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"meetingTitle"}},{kind:"Field",name:{kind:"Name",value:"meetingActionType"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"scheduledMeetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"scheduledMeetingInfo"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"scheduledMeetingInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ScheduledMeetingInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"exchangeId"}},{kind:"Field",name:{kind:"Name",value:"iCalUID"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"eventRecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}}]}},{kind:"Field",name:{kind:"Name",value:"eventRecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patternType"}},{kind:"Field",name:{kind:"Name",value:"daily"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"weekly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"daysOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"monthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeMonthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"yearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheMonth"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeYearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}}]}}]}}]}}]}.definitions]}},300624:(e,t,i)=>{"use strict";i.d(t,{z6:()=>m});var n=i(752412),a=i(684743),s=i(786541),o=i(370311),r=i(752048),c=i(830591),l=i(663193),d=i(4968),u=i(284688);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meeting"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}},...n.w.definitions,...a.p.definitions,...s.S.definitions,...o.Uw.definitions,...r.ev.definitions,...c.v.definitions,...l.w.definitions,...d.x.definitions,...u.I.definitions]}},921983:(e,t,i)=>{"use strict";i.d(t,{SN:()=>m});var n=i(684743),a=i(786541),s=i(752412),o=i(830591),r=i(663193),c=i(370311),l=i(752048),d=i(4968),u=i(284688);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingReplyMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"isImportant"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meeting"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"attached"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}},...n.p.definitions,...a.S.definitions,...s.w.definitions,...o.v.definitions,...r.w.definitions,...c.Uw.definitions,...l.ev.definitions,...d.x.definitions,...u.I.definitions]}},701643:(e,t,i)=>{"use strict";i.d(t,{xP:()=>u});var n=i(370311),a=i(684743),s=i(786541),o=i(752412),r=i(830591),c=i(663193),l=i(284688),d=i(4968);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"replyMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}},{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"isImportant"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"attached"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}},...n.Uw.definitions,...a.p.definitions,...s.S.definitions,...o.w.definitions,...r.v.definitions,...c.w.definitions,...l.I.definitions,...d.x.definitions]}},281954:(e,t,i)=>{"use strict";i.d(t,{wZ:()=>u});var n=i(370311),a=i(752412),s=i(684743),o=i(786541),r=i(830591),c=i(663193),l=i(284688),d=i(4968);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"standardPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StandardPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}},...n.Uw.definitions,...a.w.definitions,...s.p.definitions,...o.S.definitions,...r.v.definitions,...c.w.definitions,...l.I.definitions,...d.x.definitions]}},572141:(e,t,i)=>{"use strict";i.d(t,{x:()=>s});var n=i(874303),a=i(914179);const s=(e,t,i,s,o,r=!1,c=!1,l,d)=>{i?((0,n.RT)(e,t,i,s,o,r,d),(0,a.mH)(e,t,i,s,r,d)):(0,n.vz)(e,t,s,o,r,c,l,d)}},914179:(e,t,i)=>{"use strict";i.d(t,{df:()=>k,YV:()=>y,mH:()=>v});var n=i(139679),a=i(719840),s=i(281954),o=i(73480),r=i(114453),c=i(300624),l=i(701643),d=i(921983),u=i(613958),m=i(176992);const g={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"replyChainMessageNodeLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessageNode"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"message"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"standardPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"announcementPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"emailPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"replyMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingReplyMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"connectorPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonGuardiansPostMessageFragment"}}]}}]}},...s.wZ.definitions,...o.hb.definitions,...r.tO.definitions,...c.z6.definitions,...l.xP.definitions,...d.SN.definitions,...u.zL.definitions,...m.N4.definitions]},h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"replyChainMessagesList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"channelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"replyChainId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"queryInput"}},type:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainQueryInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"last"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"before"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"replyChainMessages"},arguments:[{kind:"Argument",name:{kind:"Name",value:"channelId"},value:{kind:"Variable",name:{kind:"Name",value:"channelId"}}},{kind:"Argument",name:{kind:"Name",value:"replychainId"},value:{kind:"Variable",name:{kind:"Name",value:"replyChainId"}}},{kind:"Argument",name:{kind:"Name",value:"queryInput"},value:{kind:"Variable",name:{kind:"Name",value:"queryInput"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}},{kind:"Argument",name:{kind:"Name",value:"last"},value:{kind:"Variable",name:{kind:"Name",value:"last"}}},{kind:"Argument",name:{kind:"Name",value:"before"},value:{kind:"Variable",name:{kind:"Name",value:"before"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"pageInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startCursor"}},{kind:"Field",name:{kind:"Name",value:"endCursor"}},{kind:"Field",name:{kind:"Name",value:"hasNextPage"}},{kind:"Field",name:{kind:"Name",value:"hasPreviousPage"}}]}},{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"replyChainMessageNodeLie"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"parentMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}}]}},{kind:"Field",name:{kind:"Name",value:"metadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dataSource"}},{kind:"Field",name:{kind:"Name",value:"channelRosterSizeExceeded"}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinkedMessageState"}}]}}]}},...a.T.definitions,...g.definitions]};var p=i(628694);function v(e,t,i,n,a,s){var o,r,c;const l=a?(0,p.yL)(e,n,!1,s):n,d=b(e,t,i,s);if(!d)return void(s&&s.warn(`updateReplyChainMessagesWithReply::Failed getting replyChainMessage data for channel ${t} replyChainId ${i}`));let u=l.attached;if(!a){const e=null===(c=null===(r=null===(o=null==d?void 0:d.replyChainMessages)||void 0===o?void 0:o.edges)||void 0===r?void 0:r[0])||void 0===c?void 0:c.node;u=!(null==e?void 0:e.postType)?(0,p.fQ)(l,null==e?void 0:e.message):void 0}const m=w(a?n.id:n.clientMessageId||"",i),g={id:m,postType:null,message:Object.assign(Object.assign({},l),u&&{attached:u})};if(a){const e=S(m,d);if(-1===e)return void(s&&s.warn("updateReplyChainMessagesWithReply::replaceExisting::Could not find matching message to replace"));d.replyChainMessages.edges[e]={__typename:"ReplyChainMessagesEdge",node:Object.assign({__typename:"ReplyChainMessageNode"},g)}}else d.replyChainMessages.edges.unshift({__typename:"ReplyChainMessagesEdge",node:Object.assign({__typename:"ReplyChainMessageNode"},g)});f(e,t,i,d,s)}const f=(e,t,i,n,a)=>{try{e.writeQuery({query:h,variables:{channelId:t,replyChainId:i},data:n})}catch(e){return void(a&&a.error(`writeReplyChainMessageData::Failed writing replyChainMessageList query to cache for channel ${t} replyChainId ${i}`))}},b=(e,t,i,a)=>{try{const a=e.readQuery({query:h,variables:{channelId:t,replyChainId:i}});return(0,n.X)(a)}catch(e){return a&&a.error(`getReplyChainSummariesData::Failed to read replyChainSummariesQuery for channel ${t} replyChainId ${i}`),null}},y=(e,t,i,n,a)=>{let s=null;try{s=e.readFragment({id:`ReplyChainMessage:${n.id}`,fragment:l.xP,fragmentName:"replyMessage"})}catch(e){a&&a.error(`removeLieFromReplyChainMessages::Failed to read cache fragment for replyMessage id ${n.id} for channelId ${t} and replyChainId ${i}`)}const o=b(e,t,i,a);if(!o)return void(a&&a.warn(`removeLieFromReplyChainMessages::Failed to read from replyChainMessages cache for channel ${t}.`));const r=S(w(n.clientMessageId||"",i),o);-1!==r?(s?o.replyChainMessages.edges[r]={__typename:"ReplyChainMessagesEdge",node:{__typename:"ReplyChainMessageNode",id:w((null==s?void 0:s.id)||"",i),postType:null,message:Object.assign(Object.assign({},s),{__typename:"ReplyChainMessage"})}}:o.replyChainMessages.edges[r].node.message.id=n.id,f(e,t,i,o,a)):a&&a.warn(`removeLieFromReplyChainMessages::Message with id ${n.clientMessageId||""} not found in cache for channel ${t}`)},k=(e,t,i,n,a)=>{const s=b(e,t,i,a);if(!s)return void a.warn(`deleteFailedReplyLieFromReplyChainMessages::Failed to read from replyChainMessages cache for channel ${t}.`);const o=w(n||"",i);-1!==S(o,s)?(s.replyChainMessages.edges=s.replyChainMessages.edges.filter((e=>e.node.id!==o)),f(e,t,i,s,a)):a.warn(`deleteFailedReplyLieFromReplyChainMessages::Message with id ${n||""} not found in cache for channel ${t}`)},S=(e,t)=>t.replyChainMessages.edges.findIndex((t=>t.node.id===e)),w=(e,t)=>`${t}_${e}`},874303:(e,t,i)=>{"use strict";i.d(t,{tO:()=>C,CZ:()=>j,vz:()=>w,RT:()=>S});var n=i(516909),a=i(589857),s=i(139679),o=i(366773),r=i(701643),c=i(154066);const l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"standardPostLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StandardPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]},d={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingPostLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]},u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"emailPostMessageLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]},m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingPostMessageLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]},g={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"announcementPostMessageLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnnouncementPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]},h={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"guardiansPostMessageLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GuardiansPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]},p={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"replyLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"attached"}}]}}]},v={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingReplyLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"attached"}}]}}]},f={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"replyChainSummaryLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainSummary"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"postMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"standardPostLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingPostLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"emailPostMessageLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingPostMessageLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"announcementPostMessageLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"guardiansPostMessageLie"}}]}},{kind:"Field",name:{kind:"Name",value:"previewMessageSet"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"replyLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingReplyLie"}}]}},{kind:"Field",name:{kind:"Name",value:"creationTime"}}]}},...i(719840).T.definitions,...l.definitions,...d.definitions,...u.definitions,...m.definitions,...g.definitions,...h.definitions,...p.definitions,...v.definitions]},b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"replyChainSummaryList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"channelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"queryInput"}},type:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainSummaryQueryInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"last"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"before"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"replyChainSummaries"},arguments:[{kind:"Argument",name:{kind:"Name",value:"channelId"},value:{kind:"Variable",name:{kind:"Name",value:"channelId"}}},{kind:"Argument",name:{kind:"Name",value:"queryInput"},value:{kind:"Variable",name:{kind:"Name",value:"queryInput"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}},{kind:"Argument",name:{kind:"Name",value:"last"},value:{kind:"Variable",name:{kind:"Name",value:"last"}}},{kind:"Argument",name:{kind:"Name",value:"before"},value:{kind:"Variable",name:{kind:"Name",value:"before"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pageInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startCursor"}},{kind:"Field",name:{kind:"Name",value:"endCursor"}},{kind:"Field",name:{kind:"Name",value:"hasNextPage"}},{kind:"Field",name:{kind:"Name",value:"hasPreviousPage"}}]}},{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"replyChainSummaryLie"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"metadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dataSource"}},{kind:"Field",name:{kind:"Name",value:"channelRosterSizeExceeded"}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinkedMessageState"}}]}}]}},...f.definitions]};var y=i(628694);const k="updateReplyChainSummariesCache";function S(e,t,i,s,c,l,d){var u,m;const g=l?(0,y.yL)(e,s,!1,d):s;try{const t=g.attached;e.writeFragment({id:`${(0,a.uG)(s)}`,fragment:r.xP,fragmentName:"replyMessage",data:Object.assign(Object.assign({},g),t&&{attached:t})})}catch(e){return void(null===(u=null==d?void 0:d.errorToTelemetry)||void 0===u||u.call(d,`Failed to write replyMessageFragment for channelId: ${t}, replyChainId: ${i}, replaceExisting: ${l}`,"messaging_delete_message",{conversationId:t,operationType:k},!0))}if(!l){const a=_(e,t,d);if(!a)return void(null==d||d.warn(`updateReplyChainSummariesWithReply::No replyChainSummaries found in cache for channel ${t}`));const r=a.replyChainSummaries.edges.find((e=>e.node.replyChainId===i));if(!r)return void(null==d||d.warn(`updateReplyChainSummariesWithReply::ReplyChainSummary does not include post with replyChainId ${i}`));const{node:l}=r,u=[...l.previewMessageSet];u.length===o.up&&u.shift();let g=n.HBY.top;if(u.length){const e=u[u.length-1];g=(0,y.fQ)(s,e)||n.HBY.top}const h={__typename:s.__typename||"ReplyChainMessage",id:s.clientMessageId||"",clientMessageId:s.clientMessageId||"",from:c,originalArrivalTime:s.originalArrivalTime||"",version:"-1",attached:g};u.push(h);try{e.writeFragment({id:`ReplyChainSummary:${t}::${i}`,fragment:f,fragmentName:"replyChainSummaryLie",data:Object.assign(Object.assign({},l),{previewMessageSet:u})})}catch(e){return void(null===(m=null==d?void 0:d.errorToTelemetry)||void 0===m||m.call(d,`Failed to write replyChainSummaryLieFragment for channelId: ${t}, replyChainId: ${i}`,"messaging_delete_message",{conversationId:t,operationType:k},!0))}}}function w(e,t,i,a,s,o,r,l){var d,u;const m=s?(0,y.yL)(e,i,!0,l,r):i,g=Object.assign(Object.assign({},m),{__typename:i.__typename||"StandardPostMessage",clientMessageId:i.clientMessageId||"",originalArrivalTime:i.originalArrivalTime||"",from:a||m.from||"",version:"-1"}),{fragmentName:h,fragmentTypeName:p,fragment:v}=(0,y.Gw)(r),f=o?i.id:i.clientMessageId;try{e.writeFragment({id:`${p}:${f}`,fragment:v,fragmentName:h,data:g})}catch(e){return void(null===(d=null==l?void 0:l.errorToTelemetry)||void 0===d||d.call(l,`Failed to write ${p} for channelId: ${t}, messageId: ${f}, replaceExisting: ${s}, isEdit: ${o}`,"messaging_delete_message",{conversationId:t,operationType:k},!0))}if(!s){const a={__typename:"ReplyChainSummary",id:`${t}::${i.clientMessageId}`,channelId:t,replyChainId:i.clientMessageId||"",creationTime:i.originalArrivalTime||"",postType:r||n.hQF.Standard,postMessage:g,previewMessageSet:[],mostRecentOverflowMessage:null,totalReplies:0,totalUsers:0,recentUsers:[],recentUserDisplayNameHints:[],updatedTime:null,hasMention:!1,hasChannelMention:!1,hasImportance:!1,hasFiles:!1,forceShowResponseSurface:!1,hasCurrentUserMention:!1,hasUnreadPostMessage:null,hasUnreadReplyMessage:null,consumptionHorizon:{id:"lie_ch"}};try{e.writeFragment({id:`ReplyChainSummary:${t}::${f}`,fragment:c.p,fragmentName:"DataClientChannelReplyChainSummaryWithUserDetailsFragment",data:a})}catch(e){return void(null===(u=null==l?void 0:l.errorToTelemetry)||void 0===u||u.call(l,`Failed to write replyChainSummaryFragment for channelId: ${t}, messageId: ${f}, isEdit: ${o}`,"messaging_delete_message",{conversationId:t,operationType:k},!0))}const s=_(e,t,l);if(!s)return void(null==l||l.warn(`updateReplyChainSummariesWithPost::replyChainSummariesList is undefined for channel ${t}`));s.replyChainSummaries.edges.unshift({__typename:"ReplyChainSummaryEdge",node:a}),T(e,t,s,l)}}const j=(e,t,i,n,a,s)=>{const o=_(e,t,a);if(!o)return void(null==a||a.warn(`removePostClientLie::replyChainSummariesList is undefined for channel ${t}`));const r=o.replyChainSummaries.edges;let c;if(c=s?r.findIndex((e=>e.node.postMessage.clientMessageId===n)):r.findIndex((e=>e.node.id===`${t}::${n}`)),-1!==c){if(s)o.replyChainSummaries.edges=r.filter((e=>e.node.postMessage.clientMessageId!==n));else{const e=r[c].node;e.id=`${t}::${i}`,e.replyChainId=i,e.postMessage.id=i}T(e,t,o,a)}else null==a||a.warn(`removePostClientLie::Could not find matching ${t}::${n} node in replyChainSummaries.`)},C=(e,t,i,n,a)=>{const s=_(e,t,a);if(!s)return void a.warn(`deleteFailedReplyLieFromReplyChainSummaries::replyChainSummariesList is undefined for channel ${t}`);const o=s.replyChainSummaries.edges.find((e=>e.node.replyChainId===i));if(!o)return void a.warn(`deleteFailedReplyLieFromReplyChainSummaries::ReplyChainSummaries does not include post with replyChainId ${i}`);const r=o.node.previewMessageSet.findIndex((e=>e.clientMessageId===n));-1!==r?(o.node.previewMessageSet.splice(r,1),T(e,t,s,a)):a.warn("deleteFailedReplyLieFromReplyChainSummaries::Failed to delete reply lie for replyChainSummary.")},_=(e,t,i)=>{var n;try{const i=e.readQuery({query:b,variables:{channelId:t}});return(0,s.X)(i)}catch(e){return null===(n=null==i?void 0:i.errorToTelemetry)||void 0===n||n.call(i,`Failed to getReplyChainSummariesData for channelId: ${t}`,"messaging_delete_message",{conversationId:t,operationType:k},!0),null}},T=(e,t,i,n)=>{var a;try{e.writeQuery({query:b,variables:{channelId:t},data:i})}catch(e){null===(a=null==n?void 0:n.errorToTelemetry)||void 0===a||a.call(n,`Failed to writeReplyChainSummariesData for channelId: ${t}`,"messaging_delete_message",{conversationId:t,operationType:k},!0)}}},554836:(e,t,i)=>{"use strict";i.d(t,{h$:()=>E,sE:()=>T,lx:()=>I,Do:()=>F,gi:()=>N,xB:()=>x});var n=i(480389),a=i(516909);const s={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]},o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageFieldsForDeletedMessages"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"time"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}},{kind:"Field",name:{kind:"Name",value:"escalations"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"userHasSaved"}},{kind:"Field",name:{kind:"Name",value:"diagnosticInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"diagnosticErrorCode"}},{kind:"Field",name:{kind:"Name",value:"diagnosticMessage"}}]}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"FragmentSpread",name:{kind:"Name",value:"deletionInfo"}}]}},...s.definitions]},r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"deletedMessages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deletedMessages"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"message"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageFieldsForDeletedMessages"}}]}}]}}]}},...o.definitions]};var c=i(180023);const l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedReplyChainMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};c.lB.definitions,l.definitions;var d=i(421775);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedMeetingReplyMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};d.yM.definitions,u.definitions;var m=i(218692);const g={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedStandardPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StandardPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};m.w3.definitions,g.definitions;var h=i(352996);const p={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedAnnouncementPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnnouncementPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};h.Be.definitions,p.definitions;var v=i(782529);const f={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedEmailPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};v.E3.definitions,f.definitions;var b=i(290287);const y={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedMeetingPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};b.lU.definitions,y.definitions;var k=i(613958);const S={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedConnectorPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConnectorPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};k.zL.definitions,S.definitions;var w=i(176992);const j={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedGuardiansPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GuardiansPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};w.N4.definitions,j.definitions;var C=i(38613);const _="cacheDeletedMessages";function T(e,t){const{message:i}=A(e,t.id,t.clientMessageId,void 0,!(null==t?void 0:t.deleteTime)),n=i&&i.message&&i.message.importance===a.Ntc.Urgent;return{__typename:"DeletionInfo",showMessageAsDeleted:!!i,canBeUndeleted:!!i&&!n,deleteFailed:!1}}function I(e,t,i,n){var a;try{const{message:a}=A(e,t,i,n);if(a){const{message:i}=a,n=Object.assign(Object.assign({},i),{id:t}),s=`Message:${t}`;return e.writeFragment({id:s,fragmentName:"messageFieldsForDeletedMessages",fragment:o,data:n}),n}}catch(e){null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`Failed to recoverDeletedMessageInCache for messageId: ${t}`,"messaging_delete_message",{"Message.Id":t,operationType:_},!0)}}function N(e,t,i,n,a,o){var r;const{fragment:c,fragmentName:d}=function(e){switch(e){case"Message":default:return{fragment:s,fragmentName:"deletionInfo"};case"ReplyChainMessage":return{fragment:l,fragmentName:"DataClientChatDeletedReplyChainMessageFragment_deletionInfo"};case"MeetingReplyMessage":return{fragment:u,fragmentName:"DataClientChatDeletedMeetingReplyMessageFragment_deletionInfo"};case"StandardPostMessage":return{fragment:g,fragmentName:"DataClientChatDeletedStandardPostMessageFragment_deletionInfo"};case"AnnouncementPostMessage":return{fragment:p,fragmentName:"DataClientChatDeletedAnnouncementPostMessageFragment_deletionInfo"};case"EmailPostMessage":return{fragment:f,fragmentName:"DataClientChatDeletedEmailPostMessageFragment_deletionInfo"};case"MeetingPostMessage":return{fragment:y,fragmentName:"DataClientChatDeletedMeetingPostMessageFragment_deletionInfo"};case"ConnectorPostMessage":return{fragment:S,fragmentName:"DataClientChatDeletedConnectorPostMessageFragment_deletionInfo"};case"GuardiansPostMessage":return{fragment:j,fragmentName:"DataClientChatDeletedGuardiansPostMessageFragment_deletionInfo"}}}(i),m=`${i}:${t}`;try{const a=e.readFragment({id:m,fragment:c,fragmentName:d});a&&e.writeFragment({id:m,fragment:c,data:Object.assign(Object.assign({},a),{id:t,deleteTime:o,deletionInfo:{__typename:"Message"===i?"DeletionInfo":"MessageDeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:n},version:(0,C.MX)()[0].toString()})})}catch(e){null===(r=a.errorToTelemetry)||void 0===r||r.call(a,`Failed to updateCachedMessageForDelete for messageId: ${t}, fragmentName: ${d}, deleteFailed: ${n}`,"messaging_delete_message",{"Message.Id":t,operationType:_},!0)}}function E(e,t,i){var n;let a=[];try{if(a=D(e,i),a.find((e=>e.id===t)))return;const n=`Message:${t}`,s=e.readFragment({id:n,fragment:o,fragmentName:"messageFieldsForDeletedMessages"}),c=Object.assign(Object.assign({},s),{id:`${s.id}_deleted`}),l={id:t,message:c,__typename:"DeletedMessage"};return a=[l,...a],e.writeQuery({query:r,data:{deletedMessages:a}}),l}catch(e){null===(n=i.errorToTelemetry)||void 0===n||n.call(i,`Failed to addDeletedMessageToCacheForUndelete for messageId: ${t}`,"messaging_delete_message",{"Message.Id":t,operationType:_},!0)}}function F(e,t,i,n){var a;try{const a=D(e,n),{message:s,isDeletedLieMessage:c}=A(e,t,i,n,!1,a);if(s){const n=a.filter((e=>{var n;return c?(null===(n=e.message)||void 0===n?void 0:n.clientMessageId)!==i:e.id!==t})),l=Object.assign(Object.assign({},s.message),{id:t,deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!1},version:(0,C.MX)()[0].toString(),__typename:"Message"});e.writeQuery({query:r,data:{deletedMessages:n}});const d=`Message:${t}`;return e.writeFragment({id:d,fragment:o,data:l}),l}}catch(e){null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`Failed to removeDeletedMessageFromCacheForUndelete for messageId: ${t}`,"messaging_delete_message",{"Message.Id":t,operationType:_},!0)}}function x(e,t,i,s){var o;const r=n.Ps`
    fragment messageFieldsNeeded on Message {
      deleteTime
      importance
      deletionInfo {
        showMessageAsDeleted
        canBeUndeleted
        deleteFailed
      }
      version
    }
  `,c=`Message:${t}`;try{const t=e.readFragment({id:c,fragment:r});if(t){const n=t.importance===a.Ntc.Urgent;e.writeFragment({id:c,fragment:r,data:{deleteTime:i,importance:t.importance,deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!!i,canBeUndeleted:!!i&&!n,deleteFailed:!1},version:(0,C.MX)()[0].toString(),__typename:"Message"}})}}catch(e){null===(o=s.errorToTelemetry)||void 0===o||o.call(s,`Failed to updateCachedMessageForUndelete for messageId: ${t}`,"messaging_delete_message",{"Message.Id":t,operationType:_},!0)}}const D=(e,t)=>{var i;let n;try{n=e.readQuery({query:r})}catch(e){null===(i=null==t?void 0:t.errorToTelemetry)||void 0===i||i.call(t,"Failed to queryDeletedMessages","messaging_delete_message",{operationType:_},!0)}return n&&n.deletedMessages||[]},A=(e,t,i,n,a,s)=>{const o={message:null,isDeletedLieMessage:!1};if(!(s=s||D(e,n))||0===s.length)return o;if(!a){const e=s.find((e=>e.id===t));if(e)return{message:e,isDeletedLieMessage:!1}}const r=s.find((e=>e.message&&e.message.clientMessageId===i));return r?{message:r,isDeletedLieMessage:!0}:o}},790888:(e,t,i)=>{"use strict";i.d(t,{C:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"dlpDialogData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dlpDialogData"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isReport"}},{kind:"Field",name:{kind:"Name",value:"isOverride"}},{kind:"Field",name:{kind:"Name",value:"justification"}}]}}]}}]}},434217:(e,t,i)=>{"use strict";i.d(t,{v:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"smartReplyFileSuggestion"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"smartReplyFileSuggestion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileName"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}},403588:(e,t,i)=>{"use strict";i.d(t,{Om:()=>c,Ng:()=>l});var n=i(275742),a=i(50805);const s=[{predicate:e=>!!e.get(a.J.Presence).enablePresenceInWorker,resolvers:{query:["presence","presences"],mutation:["setPresence","setStatusNote","setCallStatePresence"],subscription:["presenceUpdateEvent","presenceUpdateEventBatch"]}},{predicate:e=>!!e.get(a.J.Host).enableEspInWorker||!!e.get(a.J.Esp).enableEsp,resolvers:{query:["espState","irisCampaign"],mutation:["recordEligibleSurface","recordDisplayedSurface","recordEspCompletedActions","triggerNotificationDisplay","triggerTfwNotificationDisplay"],subscription:["espTriggerEvent","espSurfaceShownEvent"]}},{predicate:e=>!!e.get(a.J.Guardians).enableMembersAndRelatedContactsWorkerResolver,resolvers:{query:["membersAndRelatedContacts"],mutation:[],subscription:[]}},{predicate:e=>!!e.get(a.J.Guardians).enableRelatedContactsWorkerResolver,resolvers:{query:["relatedContacts"],mutation:[],subscription:[]}},{predicate:e=>{var t,i;return!(!(null===(t=e.get(a.J.Host))||void 0===t?void 0:t.enableHybridDiscoverSurface)&&!(null===(i=e.get(a.J.DiscoverSurface))||void 0===i?void 0:i.enableHybridDiscoverSurface))},resolvers:{query:["feed"],mutation:["feedback","discoverSurfaceUserPreferenceForEntities","removeHasUpdatedItemsFlag","startPolling","stopPolling","userActionFeedbackLog","sendDiscoverFeedRenderAction"],subscription:["replyChainSummaryEvent","discoverFeedHasUpdatedItems","feedEvent"]}},{predicate:e=>!!e.get(a.J.WhatsNew).enableWhatsNew,resolvers:{query:["whatsNewState"],mutation:["recordWhatsNewDisplayedFeature","recordWhatsNewEntryPointPromotion","recordWhatsNewEntryPointUserAction"],subscription:[]}},{predicate:e=>!!e.get(a.J.People).enableBatchUsersByEmailsAndPhonesWorkerResolver,resolvers:{query:["batchUsersByEmailsAndPhones"],mutation:[],subscription:[]}}],o=[{predicate:e=>!!e.get(a.J.Host).enableOfflineActionsManager&&!!e.get(a.J.Host).msgEnableOfflineReactions,resolvers:{query:[],mutation:["updateMessageEmotion"],subscription:[]}},{predicate:e=>!!e.get(a.J.Messaging).msgEnableAutoSetConsumptionHorizonResolver,resolvers:{query:[],mutation:["setConsumptionHorizon"],subscription:[]}},{predicate:e=>!!e.get(a.J.Extensibility).enableAdaptiveAppletCacheFromCDL,resolvers:{query:[],mutation:["cardCacheOperation"],subscription:[]}}],r=()=>({query:[],mutation:[],subscription:[]});function c(e,t,i){const{experimentalResolvers:s,stableResolvers:c}=e.get(a.J.Cdl),l=c&&c.resolvers&&(0,n.pick)(c.resolvers,["query","mutation","subscription"])||r();if(t.log(`Supported operations from config: ${JSON.stringify(l,m)}`),c&&c.version&&s&&s.version&&c.version>=s.version){const e=s.resolvers&&(0,n.pick)(s.resolvers,["query","mutation","subscription"])||r();t.log(`Supported operations from ECS: ${JSON.stringify(e,m)}`),(0,n.mergeWith)(l,e,g)}h(l,o,e,t);const p=(0,n.mapValues)(l,(e=>e?new Set(e):new Set)),{dataLayerSettings:v}=e.get(a.J.Host),f=v&&(0,n.pick)(v,["query","mutation","subscription"]);return i?d(f,p,t,"Angular"):u(f,"supportedResolversFromMainWindow",p,"resolversFromConfiguration",t,"Angular")}function l(e,t,i,o){const c=function(e,t){var i;let a;try{if(!t)throw new Error("CDL Worker did not return supported operations");a=JSON.parse(t)}catch(t){null===(i=e.errorToTelemetry)||void 0===i||i.call(e,`getWorkerSupportedOperations: Failed to set CDL Worker supported operations: ${t&&t.message}`,"cdl_worker_manager_get_worker_supported_operations_error",void 0,!0),a={query:[],mutation:[],subscription:[]}}const s=(0,n.mapValues)(a,(e=>e?new Set(e):new Set));return(0,n.pick)(s,["query","mutation","subscription"])}(t,i),{supportedResolvers:l,activitySupportedResolvers:m,mtmaMissedNotificationsSupportedResolvers:p,calendarSupportedResolvers:v,chatSupportedResolvers:f,chatPartiallySupportedResolvers:b,phonelinkSmsSupportedResolvers:y,appsUsageResolvers:k,tabsUsageResolvers:S,peopleTargetingSupportedResolvers:w,tflFeaturedCommunitiesSupportedResolvers:j}=e.get(a.J.CdlWorker),C=function(e){const t=r();return e.forEach((e=>e&&(0,n.mergeWith)(t,e,g))),t}([l,m,p,v,f,b,y,k,S,w,j]),_=(0,n.pick)(C,["query","mutation","subscription"]);return h(_,s,e,t),o?d(_,c,t,"Worker"):u(_,"resolversFromConfiguration",c,"supportedOperationsFromCDLWorker",t,"Worker")}function d(e,t,i,a){if(!e)return{query:new Set,mutation:new Set,subscription:new Set};i.log(`Supported operations received from ${a}: ${JSON.stringify(e,m)}`);const s=(0,n.mapValues)(e,((e,i)=>new Set(e.filter((e=>t[i]&&t[i].has(e))))));return i.log(`Merged datalayer settings with config: ${JSON.stringify(s,m)}`),s}function u(e,t,i,n,a,s){const o=function(e,t,i){const n={query:{},mutation:{},subscription:{}};return Object.keys(n).forEach((a=>{const s=e[a];if(s)for(const e of s)n[a][e]={fieldName:e,active:i,configurationDescription:t}})),n}(i,n,!1);return e?(Object.keys(e).forEach((i=>{if(!o[i])return;const n=e[i];if(n)for(const e of n){const n=o[i][e];n?n.active=!0:o[i][e]={fieldName:e,active:!1,configurationDescription:t}}})),function(e,t,i){const n={};Object.keys(t).forEach((e=>{const i=t[e];Object.keys(i).forEach((t=>{const a=i[t];if(!a.active){const t=a.configurationDescription;n[t]||(n[t]={query:[],mutation:[],subscription:[]}),n[t][e].push(a.fieldName)}}))})),Object.keys(n).forEach((t=>{const a=n[t],s=a.query,o=a.mutation,r=a.subscription;if(s.length>0||o.length>0||r.length>0){const n=`GraphQL Link for ${e}: ${t} has unsupported resolvers: query= ${s.length}, mutation=${o.length}, subscription=${r.length}.`;i.log(n)}}))}(s,o,a),o):(a.log(`No supported resolvers for ${s}`),o)}const m=(e,t)=>"object"==typeof t&&t instanceof Set?Array.from(t):t,g=(e,t)=>(0,n.isArray)(e)?e.concat(t):void 0;function h(e,t,i,a){const s=r();t.forEach((({predicate:e,resolvers:t})=>{e(i)&&(0,n.mergeWith)(s,t,g)})),a.log(`Supported additional operations: ${JSON.stringify(s,m)}`),(0,n.mergeWith)(e,s,g)}},454029:(e,t,i)=>{"use strict";i.d(t,{zz:()=>l,nG:()=>c,Fj:()=>d});var n=i(905581),a=i(132756),s=i(275742),o=i(974016);const r=(e,t)=>{let i=null;try{i=e.readQuery({query:o.gv.currentFilesQuery,variables:{fileContainerId:t}})}catch(e){}return i||(i={currentFiles:[]}),i.currentFiles},c=(e,t,i)=>r(i,t).find((t=>t.id===e)),l=(e,t,i)=>{const n={currentFiles:[...r(t,i).map((t=>{const i=e.findIndex((e=>e.id===t.id));if(-1===i)return t;const n=e[i];e.splice(i,1);return(0,s.merge)({},t,n)})),...e]};t.writeQuery({query:o.gv.currentFilesQuery,variables:{fileContainerId:i},data:n})},d=(e,t,i)=>{const s=r(i,t),c=s.find((t=>t.id===e));if(!c)throw(0,n.Tr)("FileUploadResolver",a.jK.NotPresent,"removecachefile",{logErrorMessage:`File with id: ${e} not found  in the cache`});const l=s.filter((t=>t.id!==e));return i.writeQuery({query:o.gv.currentFilesQuery,variables:{fileContainerId:t},data:{currentFiles:l}}),c}},836666:(e,t,i)=>{"use strict";i.d(t,{g:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformAppDevicePermissionsUpdatedQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDevicePermissionsUpdated"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}}]}},315280:(e,t,i)=>{"use strict";i.d(t,{Q:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformAppsBadgeReadQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appsBadgeRead"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},2300:(e,t,i)=>{"use strict";i.d(t,{I:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformInContextStoreLaunchInstalledAppResultQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"inContextStoreLaunchInstalledAppResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"capability"}},{kind:"Field",name:{kind:"Name",value:"appDisplayName"}},{kind:"Field",name:{kind:"Name",value:"draftId"}}]}}]}}]}},612034:(e,t,i)=>{"use strict";i.d(t,{r:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformTabDeletionResultQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"channelMeetingMessageId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tabDeletionResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"threadId"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}},{kind:"Argument",name:{kind:"Name",value:"channelMeetingMessageId"},value:{kind:"Variable",name:{kind:"Name",value:"channelMeetingMessageId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"channelMeetingMessageId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}}]}}]}}]}},868521:(e,t,i)=>{"use strict";i.d(t,{F:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageExtensionsAppsState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageExtensionsAppsState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toggleRefetch"}}]}}]}}]}},511523:(e,t,i)=>{"use strict";i.d(t,{s:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"tabConfigurationResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tabConfigurationResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"tabId"}}]}}]}}]}},776806:(e,t,i)=>{"use strict";i.d(t,{S:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"webhookConfirmationResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webhookConfirmationResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},790997:(e,t,i)=>{"use strict";i.d(t,{w:()=>r});var n=i(58826),a=i(238446),s=i(275742);function o(e,t,i=!0,a){var o,r,c;let l=[];try{if(a.enableDecoupleCommandingFromApollo)l=a.getActiveWindows();else{const i=null===(o=e.readQuery({query:n.i8}))||void 0===o?void 0:o.activeWindows;i||null===(r=t.errorToTelemetry)||void 0===r||r.call(t,"cache.readquery has returned undefined or null for activeWindowsQuery","webclient_framework_foundation_core_services_entity_commanding",void 0,!0),l=i||[]}}catch(e){null===(c=t.errorToTelemetry)||void 0===c||c.call(t,"cache.readQuery failed for activeWindowsQuery","webclient_framework_foundation_core_services_entity_commanding",void 0,!0)}return i?(0,s.cloneDeep)(l):l}const r=()=>({Query:{activeWindows:(e,t,{cache:i,loggerFactory:n,activeWindowsService:a})=>o(i,n.newLogger("activeWindows-query","data-client-windows"),!1,a)},Mutation:{removeWindow(e,{windowId:t},{cache:i,loggerFactory:s,commandChangeReportingService:r,activeWindowsService:c}){const l=s.newLogger("removeWindow-mutation","data-client-windows"),d=o(i,l,!0,c),u=d.findIndex((e=>e.id===t));if(u>=0){const e=function(e,t,i,a){const s=e.splice(t,1);return a.enableDecoupleCommandingFromApollo?a.removeActiveWindowById(s[0].id):i.writeQuery({query:n.i8,data:{activeWindows:e}}),s[0]}(d,u,i,c);return r.report({type:a.B.Close,correlationId:e.correlation.id,context:{target:"remove-window-mutation"},userContextId:e.userContextId||void 0}),e}return l.warn(`Removing window that does not exist ${t}`),null}}})},273586:(e,t,i)=>{"use strict";i.d(t,{k:()=>a});var n=i(58826);function a(e){e.writeQuery({query:n.i8,data:{activeWindows:[]}})}},830591:(e,t,i)=>{"use strict";i.d(t,{v:()=>n});const n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"card"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Card"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"cardClientId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}},{kind:"Field",name:{kind:"Name",value:"userSpecificContent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"authBlockLastUsedOn"}}]}}]}}]}},613958:(e,t,i)=>{"use strict";i.d(t,{zL:()=>l});var n=i(370311),a=i(752412),s=i(684743),o=i(786541),r=i(830591),c=i(4968);const l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"connectorPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConnectorPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"connectorMetadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorSenderGuid"}},{kind:"Field",name:{kind:"Name",value:"providerAccountUniqueId"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}},...n.Uw.definitions,...a.w.definitions,...s.p.definitions,...o.S.definitions,...r.v.definitions,...c.x.definitions]}},352996:(e,t,i)=>{"use strict";i.d(t,{Be:()=>m});var n=i(370311),a=i(752412),s=i(684743),o=i(786541),r=i(830591),c=i(663193),l=i(4968),d=i(284688),u=i(119270);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonAnnouncementPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnnouncementPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"announcement"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"originalImageUrl"}},{kind:"Field",name:{kind:"Name",value:"croppedImageUrl"}},{kind:"Field",name:{kind:"Name",value:"colorTheme"}},{kind:"Field",name:{kind:"Name",value:"croppedImageHeight"}},{kind:"Field",name:{kind:"Name",value:"croppedImageWidth"}},{kind:"Field",name:{kind:"Name",value:"croppedImageAltText"}},{kind:"Field",name:{kind:"Name",value:"isTeamsIllustration"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}},...n.Uw.definitions,...a.w.definitions,...s.p.definitions,...o.S.definitions,...r.v.definitions,...c.w.definitions,...l.x.definitions,...d.I.definitions,...u.M3.definitions]}},663193:(e,t,i)=>{"use strict";i.d(t,{w:()=>n});const n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ATPSafelinksSharepointData"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"URL"}},{kind:"Field",name:{kind:"Name",value:"Xsdata"}},{kind:"Field",name:{kind:"Name",value:"Sdata"}}]}}]}},782529:(e,t,i)=>{"use strict";i.d(t,{E3:()=>m});var n=i(370311),a=i(752412),s=i(684743),o=i(786541);const r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"from"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"sender"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"to"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"cc"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"emailLink"}},{kind:"Field",name:{kind:"Name",value:"totalRecipients"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailUser"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"smtp"}}]}}]}.definitions]};var c=i(830591),l=i(663193),d=i(4968),u=i(284688);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonEmailPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"emailDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}},...n.Uw.definitions,...a.w.definitions,...s.p.definitions,...o.S.definitions,...r.definitions,...c.v.definitions,...l.w.definitions,...d.x.definitions,...u.I.definitions]}},176992:(e,t,i)=>{"use strict";i.d(t,{N4:()=>c});var n=i(752412),a=i(684743),s=i(786541),o=i(830591),r=i(4968);const c={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonGuardiansPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GuardiansPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"parentsAnnouncementsStatus"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}},...n.w.definitions,...a.p.definitions,...s.S.definitions,...o.v.definitions,...r.x.definitions]}},119270:(e,t,i)=>{"use strict";i.d(t,{M3:()=>n});const n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Meeting"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"meetingTitle"}},{kind:"Field",name:{kind:"Name",value:"meetingActionType"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"scheduledMeetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment_scheduledMeetingInfo"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment_scheduledMeetingInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ScheduledMeetingInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"exchangeId"}},{kind:"Field",name:{kind:"Name",value:"iCalUID"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"eventRecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}}]}},{kind:"Field",name:{kind:"Name",value:"eventRecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patternType"}},{kind:"Field",name:{kind:"Name",value:"daily"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"weekly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"daysOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"monthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeMonthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"yearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheMonth"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeYearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}}]}}]}}]}}]}.definitions]}},290287:(e,t,i)=>{"use strict";i.d(t,{lU:()=>m});var n=i(752412),a=i(684743),s=i(786541),o=i(370311),r=i(119270),c=i(830591),l=i(663193),d=i(4968),u=i(284688);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}},...n.w.definitions,...a.p.definitions,...s.S.definitions,...o.Uw.definitions,...r.M3.definitions,...c.v.definitions,...l.w.definitions,...d.x.definitions,...u.I.definitions]}},421775:(e,t,i)=>{"use strict";i.d(t,{yM:()=>m});var n=i(684743),a=i(786541),s=i(752412),o=i(830591),r=i(663193),c=i(370311),l=i(119270),d=i(4968),u=i(284688);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingReplyMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"isImportant"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"attached"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}},...n.p.definitions,...a.S.definitions,...s.w.definitions,...o.v.definitions,...r.w.definitions,...c.Uw.definitions,...l.M3.definitions,...d.x.definitions,...u.I.definitions]}},180023:(e,t,i)=>{"use strict";i.d(t,{lB:()=>u});var n=i(370311),a=i(684743),s=i(786541),o=i(752412),r=i(830591),c=i(663193),l=i(284688),d=i(4968);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonReplyMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}},{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"isImportant"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"attached"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}},...n.Uw.definitions,...a.p.definitions,...s.S.definitions,...o.w.definitions,...r.v.definitions,...c.w.definitions,...l.I.definitions,...d.x.definitions]}},218692:(e,t,i)=>{"use strict";i.d(t,{w3:()=>u});var n=i(370311),a=i(752412),s=i(684743),o=i(786541),r=i(830591),c=i(663193),l=i(284688),d=i(4968);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonStandardPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StandardPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}},...n.Uw.definitions,...a.w.definitions,...s.p.definitions,...o.S.definitions,...r.v.definitions,...c.w.definitions,...l.I.definitions,...d.x.definitions]}},284688:(e,t,i)=>{"use strict";i.d(t,{I:()=>n});const n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"dlpContext"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DlpContext"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policyViolation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"verdictDetails"}},{kind:"Field",name:{kind:"Name",value:"dlpAction"}},{kind:"Field",name:{kind:"Name",value:"genericStreamItemId"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"justificationText"}},{kind:"Field",name:{kind:"Name",value:"userAction"}},{kind:"Field",name:{kind:"Name",value:"violationType"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"policyTip"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"generalText"}},{kind:"Field",name:{kind:"Name",value:"complianceUrl"}},{kind:"Field",name:{kind:"Name",value:"matchedConditionDescriptions"}}]}}]}}]}}]}},684743:(e,t,i)=>{"use strict";i.d(t,{p:()=>n});const n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"emotions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Emotion"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"time"}}]}}]}}]}},786541:(e,t,i)=>{"use strict";i.d(t,{S:()=>n});const n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"emotionsSummary"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmotionSummary"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}}]}},370311:(e,t,i)=>{"use strict";i.d(t,{Uw:()=>n});const n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"files"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"File"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"chicletBreadcrumbs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sourceTeamName"}},{kind:"Field",name:{kind:"Name",value:"sourceChannelName"}}]}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}},{kind:"Field",name:{kind:"Name",value:"progressComplete"}},{kind:"Field",name:{kind:"Name",value:"hasUploadFailed"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"providerDataV2"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},752412:(e,t,i)=>{"use strict";i.d(t,{w:()=>n});const n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"mentions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Mention"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}}]}},4968:(e,t,i)=>{"use strict";i.d(t,{x:()=>n});const n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"translation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Translation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"fromLanguage"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"title"}}]}}]}},286795:(e,t,i)=>{"use strict";i.d(t,{g:()=>n});const n={M365Application:["M365HubApplication","M365PlatformApplication"],M365ApplicationIcon:["InternalIcon","RemoteImage"],M365ApplicationsUpdated:["M365ApplicationsBadgeUpdated","M365ApplicationsConnectionUpdated"],M365ApplicationBadge:["M365ApplicationNumericBadge","M365ApplicationDotBadge"],EventTrigger:["AppAcquisitionLink","AppSecondaryAction"],Node:["M365HubApplication","M365PlatformApplication","Conversation","Me","FullAccount","Cloud","ActiveTenant","InactiveTenant","MeInOtherTenant","Person","MePresence","PersonPresence","AvailabilityOption"],ConnectionEdge:["M365ApplicationEdge","AccountEdge","TenantEdge"],ConnectionEdgeWithCursorPagination:[],Connection:["M365ApplicationConnection","AccountConnection","TenantConnection"],ConnectionWithCursorPagination:[],MutationFailure:["PresenceMutationFailure","PresenceMutationFailureNetworkOffline"],BaseAccount:["FullAccount","Cloud"],Account:["FullAccount","Cloud"],Tenant:["ActiveTenant","InactiveTenant"],BaseTenant:["ActiveTenant","InactiveTenant"],Persona:["Me","MeInOtherTenant","Person"],Individual:["Me","MeInOtherTenant","Person"],Presence:["MePresence","PersonPresence"],PresenceExpiry:["PresenceExpiryPreDefined","PresenceExpiryCustom"],PresenceMutationResult:["PresenceMutationSuccess","PresenceMutationFailure","PresenceMutationFailureNetworkOffline"]}},651998:(e,t,i)=>{"use strict";i.d(t,{wf:()=>W,s_:()=>$});var n=i(850402),a=i(516909);const s=e=>e&&!!e.wamsStreamingUrl&&!!e.decryptionToken,o=(e,t,i)=>{var n,o,r,c;return{__typename:"Broadcast",id:e,admissionType:i.admissionType,type:t?a.G7F.Overflow:a.G7F.QuickStart,userRole:i.userRole||a.tf6.Attendee,correlationId:i.correlationId,title:i.subject,utcStart:i.utcStart||null,utcEnd:i.utcEnd||null,location:i.location||null,streamingDetails:l(e,i),qna:Object.assign(Object.assign({},i.qna),{isEnabled:(null===(n=i.qna)||void 0===n?void 0:n.isEnabled)||!1,attendeeUrl:(null===(o=i.qna)||void 0===o?void 0:o.attendeeUrl)||"",moderatorUrl:(null===(r=i.qna)||void 0===r?void 0:r.moderatorUrl)||"",iosAutodiscoverUrl:(null===(c=i.qna)||void 0===c?void 0:c.iosAutodiscoverUrl)||"",__typename:"BroadcastQnaMetadata"}),yammer:i.yammer&&{__typename:"BroadcastYammerMetadata",broadcastId:i.yammer.broadcastId,groupId:i.yammer.groupId,isEnabled:i.yammer.isEnabled,eventUrl:i.yammer.event}||null,meetingStatus:i.meetingStatus||(s(i.stream)||s(i.altStream)?a.ytK.Live:a.ytK.Created),supportUrl:i.supportUrl,sdn:u(i)||null,transcription:g(e,i),aesKey:Object.assign({__typename:"AESKey"},h(i)),aesKeyRefresh:i.aesKeyRefresh,error:i.error||null,signalR:Object.assign({__typename:"SignalRDetails"},p(i)),streamResource:v(i),broadcastRestartVersion:i.broadcastRestartVersion||0,odspVodShareUrl:i.odspVodShareUrl||null,access:f(i),byoe:(null==i?void 0:i.byoe)||null}},r=e=>({__typename:"BroadcastAttendeeStream",wamsStreamingUrl:null==e?void 0:e.wamsStreamingUrl,decryptionToken:null==e?void 0:e.decryptionToken}),c=e=>({__typename:"BroadcastStreamingInfo",wamsStreamingUrl:(null==e?void 0:e.wamsStreamingUrl)||null,wamsHlsStreamingUrls:null,decryptionToken:(null==e?void 0:e.decryptionToken)||null,decryptionKey:{key:null,value:null},setKeyAuthorizationCookieUri:null,keyAuthorizationToken:null,sdn:d(e)||null,deliveryPipelineType:"AMS"}),l=(e,t)=>({__typename:"BroadcastStreamingDetails",id:e,stream:c(t.stream),altStream:c(t.altStream)}),d=e=>e&&e.sdnName&&e.sdnPluginUrl&&{__typename:"SDNDetails",name:e.sdnName,playbackInfo:e.sdnPlaybackInfo||"",pluginUrl:e.sdnPluginUrl,sdkUrl:""}||void 0,u=e=>e.stream&&d(e.stream)||e.altStream&&d(e.altStream),m=e=>e/1e3,g=(e,t)=>{var i,n,a,s,o,r;return{__typename:"BroadcastTranscription",id:e,isEnabled:null===(i=t.transcription)||void 0===i?void 0:i.isEnabled,isSuppressed:null===(n=t.transcription)||void 0===n?void 0:n.isSuppressed,translationLanguages:null===(a=t.transcription)||void 0===a?void 0:a.translationLanguages,transcriptionLanguage:null===(s=t.transcription)||void 0===s?void 0:s.transcriptionLanguage,captionsOriginUrl:null===(o=t.transcription)||void 0===o?void 0:o.captionsOriginUrl,captionsCacheUrl:null===(r=t.transcription)||void 0===r?void 0:r.captionsCacheUrl}},h=e=>{var t,i,n,a;return{id:(null===(t=e.aesKey)||void 0===t?void 0:t.id)||"",iv:(null===(i=e.aesKey)||void 0===i?void 0:i.iv)||"",expiry:(null===(n=e.aesKey)||void 0===n?void 0:n.expiry)||"",key:(null===(a=e.aesKey)||void 0===a?void 0:a.key)||""}},p=e=>{var t,i,n,a,s;return{attendeeHubName:(null===(t=null==e?void 0:e.signalR)||void 0===t?void 0:t.attendeeHubName)||null,eventTeamHubName:(null===(i=null==e?void 0:e.signalR)||void 0===i?void 0:i.eventTeamHubName)||null,url:(null===(n=null==e?void 0:e.signalR)||void 0===n?void 0:n.url)||null,querystrings:(null===(a=null==e?void 0:e.signalR)||void 0===a?void 0:a.querystrings)||null,setCookieUrl:(null===(s=null==e?void 0:e.signalR)||void 0===s?void 0:s.setCookieUrl)||null}},v=e=>{var t,i;return{__typename:"StreamResource",attendeeEmbed:(null===(t=e.streamResource)||void 0===t?void 0:t.attendeeEmbed)||"",encoderSource:(null===(i=e.streamResource)||void 0===i?void 0:i.encoderSource)||null}},f=e=>{var t,i,n;return(null==e?void 0:e.access)&&{__typename:"BroadcastAccess",useLiveEventAuthorizationV2:null===(t=null==e?void 0:e.access)||void 0===t?void 0:t.useLiveEventAuthorizationV2,disableLobby:null===(i=null==e?void 0:e.access)||void 0===i?void 0:i.disableLobby,inInvitation:null===(n=null==e?void 0:e.access)||void 0===n?void 0:n.inInvitation,attendeeAuthorization:b(e)}||void 0},b=e=>{var t;return(null===(t=null==e?void 0:e.access)||void 0===t?void 0:t.attendeeAuthorization)&&{__typename:"BroadcastAttendeeAuthorization",errorCode:e.access.attendeeAuthorization.errorCode,subCode:e.access.attendeeAuthorization.subCode,details:e.access.attendeeAuthorization.details}||void 0};const y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"broadcast"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"roleHint"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"broadcast"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"roleHint"},value:{kind:"Variable",name:{kind:"Name",value:"roleHint"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"broadcastFragment"}}]}}]}},...i(362526)._L.definitions]},k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showInMeetingReport"}}]}}]}}]};var S=i(933736),w=i(738646),j=i(755083),C=i(905581);const _=e=>{const[t,i,n,s,o]=e.split("__");return{tenantId:t,organizerId:i,threadId:n,messageId:s,sessionId:o,roleHint:a.tf6.Attendee}},T=(e,t,i,a,s,r)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{const n=(0,j.G5)(t),c=e.readQuery({query:y,variables:{id:n}});if(c)return c.broadcast;{const c=yield i.getAttendeeMeeting(a),l=o(t,s,c);return I(e,r,n,l),l}}catch(e){throw r.error(e),e}})),I=(e,t,i,n)=>{const a={broadcast:n};try{e.writeQuery({query:y,variables:{id:i},data:a})}catch(e){t.error(e)}},N=(e,t,i,a,s,o,r,c,l,d,u)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n,m;if(E(e))return!1;const g=F(r,a,s,l,c,d),h=O(a,i);o.joinId=null===(m=null===(n=null==e?void 0:e.signalR)||void 0===n?void 0:n.querystrings)||void 0===m?void 0:m.joinid;const p=R(a,o,i,g,c,r,s,e.meetingStatus);try{const n=!s||u;return e.signalR&&e.signalR.url&&!e.error&&n?(yield t.subscribeToBroadcast(a,e.signalR,g,h,p),!0):!e.error&&(i.startPollingAttendeeMeeting(a,o,g,e.meetingStatus,!0),!0)}catch(t){return c.error(t),i.startPollingAttendeeMeeting(a,o,g,e.meetingStatus,!0),!0}})),E=e=>{var t;return e.meetingStatus===a.ytK.Stopped&&(null===(t=e.streamingDetails)||void 0===t?void 0:t.stream.wamsStreamingUrl)},F=(e,t,i,n,a,s)=>(r,c)=>{const d=x(s,t);let u="",m="";try{const s=(0,j.G5)(t),h=n.readQuery({query:y,variables:{id:s}}),p=null==h?void 0:h.broadcast;let v;if(p)if(v=Object.assign({},p),c===S.N.transcriptionStateUpdate)v.transcription=g(t,r),u="SignalR",m=S.N.transcriptionStateUpdate;else if(c===S.N.streamUpdateHubEvent){const e=l(t,r);if(D(e,p.streamingDetails))return void d.stop({broadcastData:"Duplicated update skipped"});v.streamingDetails=A(p,e),v.broadcastRestartVersion=r.broadcastRestartVersion,v.meetingStatus=M(p.broadcastRestartVersion,r.broadcastRestartVersion),u="SignalR",m=S.N.streamUpdateHubEvent}else v=Object.assign({},o(t,i,r)),u="Attendee Polling";else v=Object.assign({},o(t,i,r));const f=P(v);a.log(f),d.stop({broadcastData:JSON.stringify({updateSource:u,updateType:m,details:f})}),e.publish(`${S.V}-${t}`,{broadcastUpdatedEvent:v}),a.log(`New broadcast info successfully published for ${t}`),I(n,a,s,v)}catch(e){a.error(e),d.fail({broadcastData:`Error while processing broadcast update. updateSource: ${u}, updateType: ${m}`,broadcastError:e&&e.message})}},x=(e,t)=>{const i=e.newScenario(w.RG.BroadcastSubscriptionUpdate);return i.appendEventData({"Thread.Id":(0,j.G5)(t)}),i},D=(e,t)=>(null==e?void 0:e.stream.wamsStreamingUrl)===(null==t?void 0:t.stream.wamsStreamingUrl)&&(null==e?void 0:e.altStream.wamsStreamingUrl)===(null==t?void 0:t.altStream.wamsStreamingUrl),A=(e,t)=>{var i,n,a;return{__typename:"BroadcastStreamingDetails",stream:(null==t?void 0:t.stream)||(null===(i=e.streamingDetails)||void 0===i?void 0:i.stream),altStream:(null==t?void 0:t.altStream)||(null===(n=e.streamingDetails)||void 0===n?void 0:n.altStream),id:(null==t?void 0:t.id)||(null===(a=e.streamingDetails)||void 0===a?void 0:a.id)}},M=(e,t)=>(t=t||0)>(e=e||0)?a.ytK.Suspended:a.ytK.Created,P=e=>{var t,i,n,a,s,o,r,c;const l=e.broadcastRestartVersion,d=e.meetingStatus,u=null===(i=null===(t=e.streamingDetails)||void 0===t?void 0:t.stream)||void 0===i?void 0:i.wamsStreamingUrl,m=!!(null===(a=null===(n=e.streamingDetails)||void 0===n?void 0:n.stream)||void 0===a?void 0:a.decryptionToken),g=null===(o=null===(s=e.streamingDetails)||void 0===s?void 0:s.altStream)||void 0===o?void 0:o.wamsStreamingUrl,h=!!(null===(c=null===(r=e.streamingDetails)||void 0===r?void 0:r.altStream)||void 0===c?void 0:c.decryptionToken),p=e.transcription;return`broadcastRestartVersion: ${l}, meetingStatus: ${d}, stream: ${u}, isDecryptionTokenAvailable: ${m}, altStream: ${g}, isAltDecryptionTokenAvailable: ${h}, isTranscriptionEnabled: ${null==p?void 0:p.isEnabled}, isTranscriptionSuppressed: ${null==p?void 0:p.isSuppressed}`},O=(e,t)=>()=>{t.stopPollingAttendeeMeeting(e)},R=(e,t,i,n,a,s,o,r)=>c=>{if(!c){a.log("broadcast-subscripotion disconnect callback called not intentionally. Subscribing to attendee service polling.");try{i.startPollingAttendeeMeeting(e,t,n,r,!1)}catch(t){L(a,s,t.message,e,o)}}},L=(e,t,i,n,a)=>{e.error("Error while starting broadcast updates subscription");const s=o(n,a,{error:{errorMessage:i}});t.publish(`${S.V}-${n}`,{broadcastUpdatedEvent:s})};var U=i(50805);const $={Query:{broadcastAttendeeMeeting(e,{broadcastAttendeeMeetingParams:t},{cache:i,coreSettings:a,getBroadcastAttendeeService:s,loggerFactory:o}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=a.get(U.J.MeetingArtifacts);let n=!0;const c=o.newLogger("broadcastAttendeeMeetingQuery","data-resolvers-browser-broadcast-attendee"),{overflowAttendance:l}=e;if(t){if(l)try{n=((e,t)=>{var i;if("Disabled"===t)return!1;if("Enabled"===t)return!0;const n=!(!e||!e.userPreferences||"true"!==e.userPreferences.showInMeetingReport&&"false"!==e.userPreferences.showInMeetingReport);return"EnabledUserOverride"===t?!n||"false"!==(null===(i=null==e?void 0:e.userPreferences)||void 0===i?void 0:i.showInMeetingReport):"DisabledUserOverride"!==t||!!n&&"false"!==(null==e?void 0:e.userPreferences.showInMeetingReport)})(i.readQuery({query:k}),e.allowTrackingInReportPolicy)}catch(e){c.error("Failed to fetch allowTrackingInReportPolicy"),c.error(e)}return{__typename:"BroadcastAttendeeMeeting",id:(d=yield(yield s()).getAttendeeMeeting(Object.assign(Object.assign({},t),{allowTrackingInReport:n}))).correlationId,title:d.subject,stream:r(d.stream),altStream:r(d.altStream),qna:d.qna,yammer:d.yammer&&{__typename:"YammerMetadata",broadcastId:d.yammer.broadcastId,groupId:d.yammer.groupId,isEnabled:d.yammer.isEnabled,eventUrl:d.yammer.event},supportUrl:d.supportUrl}}return null;var d}))},broadcastCaptions(e,{id:t,broadcastId:i,culture:a,currentPlayerTime:s},{cache:o,getBroadcastCaptionsService:r,loggerFactory:c}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=c.newLogger("broadcastCaptionsQuery","data-resolvers-browser-broadcast-attendee");if(!t&&!i||!a)return e.error("Invalid params sent to broadcastCaptions Query"),Promise.reject("Invalid params sent to broadcastCaptions Query");e.log(`Fetching the captions for: ID: ${t}, Culture: ${a}, Time: ${s}`);const n=t||(0,j.G5)(i);try{const e=o.readQuery({query:y,variables:{id:n}});if(e&&e.broadcast.aesKey&&e.broadcast.transcription){const t={aesKey:e.broadcast.aesKey,aesKeyRefresh:e.broadcast.aesKeyRefresh,correlationId:e.broadcast.correlationId,transcription:e.broadcast.transcription},i=yield r();i.setCurrentCaptionLanguage(n,a);return(e=>{const t=[];for(const i of e){if(""===i.Text)continue;const e={__typename:"Captions",start:m(i.TimestampMs),text:i.Text,end:m(i.EndTimestampMs)};t.push(e)}return t})(yield i.getCaptions(s,n,t,a))}}catch(t){e.error("Failed to fetch captions"),e.error(t)}return Promise.resolve([])}))},broadcast(e,{id:t,roleHint:i,joinId:s},{getBroadcastAttendeeService:r,loggerFactory:c}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const[e,n,l,d,u]=t.split("__");if(!(e&&n&&l&&d)){const e=`Invalid Id: ${t}`;throw c.newLogger("broadcast","data-resolvers-browser-broadcast-attendee").error(e),new Error(e)}const m=!!u,g=m?a.G7F.Overflow:a.G7F.QuickStart,h=yield(yield r()).getAttendeeMeeting({tenantId:e,organizerId:n,threadId:l,messageId:d,sessionId:u,roleHint:i,broadcastType:g,joinId:s||void 0});return o(t,m,h)}))}},Mutation:{startLiveStreamCaptions(e,{id:t,liveStreamId:i,culture:s},{cache:o,getBroadcastCaptionsService:r,getLiveStreamRenderingService:c,loggerFactory:l}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=l.newLogger("liveStreamCaptionsMutation","data-resolvers-browser-broadcast-attendee");try{const n=o.readQuery({query:y,variables:{id:t}});if(!n)throw new Error("Could not find broadcast data");const l=yield c(),d=yield r(),u=()=>l.getDiagnosticData(i).then((t=>(e.log(`The times are: ${t.currentAbsoluteTime}, ${t.currentMediaTime}, ${t.currentPlayPosition}`),t.currentAbsoluteTime))),m=e=>{l.addCues(i,e)},g={aesKey:n.broadcast.aesKey,aesKeyRefresh:n.broadcast.aesKeyRefresh,correlationId:n.broadcast.correlationId,transcription:n.broadcast.transcription};d.startCaptionsForStream(i,t,g,s,!1,a.A49.AzureMediaPlayer,u,m)}catch(t){e.error("Failed to fetch captions"),e.error(t)}return null}))},stopLiveStreamCaptions(e,{liveStreamId:t},{getBroadcastCaptionsService:i,getLiveStreamRenderingService:a,loggerFactory:s}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=s.newLogger("liveStreamCaptionsMutation","data-resolvers-browser-broadcast-attendee");e.log(`Stopping captions for stream ${t}`);try{const e=yield i(),n=yield a();return e.stopCaptionsForStream(t),n.clearCues(t),!0}catch(i){return e.error(`Error while stopping captions for stream ${t}`),e.error(i),!1}}))},toggleLiveStreamCaptionButton(e,{liveStreamId:t,shouldShowButton:i},{getLiveStreamRenderingService:a,loggerFactory:s}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=s.newLogger("toggleLiveStreamCaptionButton","data-resolvers-browser-broadcast-attendee");e.log(`Setting the caption button visibility in the player to ${i} for stream ${t}`);try{return(yield a()).showCaptions(t,i),!0}catch(n){return e.error(`Error while setting the caption button to ${i} for stream ${t}`),!1}}))},subscribeToBroadcastUpdates(e,{id:t},{loggerFactory:i,getBroadcastAttendeeService:a,getBroadcastSignalRService:s,pubsub:o,cache:r,coreSettings:c,scenarioFactory:l}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield a(),d=yield s(),u=i.newLogger("broadcastSubscribe","data-resolvers-browser-broadcast-attendee"),{enableSignalrForOverflow:m}=c.get(U.J.Broadcast),g=yield((e,t,i,a,s,o,r,c)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=_(e),l=!!n.sessionId;try{const d=yield T(s,e,t,n,l,o);return d?(a.publish(`${S.V}-${e}`,{broadcastUpdatedEvent:d}),yield N(d,i,t,e,l,n,a,o,s,r,c)):(L(o,a,"Error subscribing to broadcast updates",e,l),!1)}catch(t){return o.error(t),L(o,a,(0,C.VK)(t),e,l),!1}})))(t,e,d,o,r,u,l,!!m);return g}))},unsubscribeFromBroadcastUpdates(e,{id:t},{getBroadcastAttendeeService:i,getBroadcastSignalRService:a,loggerFactory:s}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=s.newLogger("broadcastUnsubscribe","data-resolvers-browser-broadcast-attendee");e.log(`Stopping subscription for broadcast ${t}`);try{(yield i()).stopPollingAttendeeMeeting(t);return(yield a()).unsubscribeFromBroadcast(t),!0}catch(i){return e.error(`Error while unsubscribing from broadcast ${t}`),e.error(i),!1}}))}},Subscription:{broadcastQnaFeedStatusEvent:{subscribe:(e,{id:t},{pubsub:i})=>i.asyncIterator(t)},broadcastUpdatedEvent:{subscribe:(e,{broadcastId:t},{pubsub:i})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return i.asyncIterator(`${S.V}-${t}`)}))}}},W=()=>({Mutation:{updateBroadcastQnaFeedStatus:(e,{id:t,isQnaFeedLoaded:i,hasNewMessages:n},{pubsub:a})=>(null==n&&null==i||a.publish(t,{broadcastQnaFeedStatusEvent:{isQnaFeedLoaded:!!i,hasNewMessages:!!n}}),{__typename:"BroadcastQnaFeedStatus",isQnaFeedLoaded:!!i,hasNewMessages:!!n})}})},982459:(e,t,i)=>{"use strict";i.d(t,{w:()=>r});var n=i(275742),a=i(878652);const s="calendarv2",o=e=>{const t=e.get(s);return t?(0,a.D)(t):{}},r={Query:{calendarSettingsFromLocalStorage:(e,t,{localStorage:i})=>(({shouldGetDateRangeType:e,shouldGetWorkHours:t,shouldGetWorkWeekDays:i},n)=>{const a=o(n);return{__typename:"ICalendarSettings",dateRangeType:e&&a.dateRangeType||null,workHours:t&&a.workHours?Object.assign({__typename:"IWorkHours"},a.workHours):null,workWeekDays:i&&a.workWeekDays||null,isLeftRailExpanded:a.isLeftRailExpanded}})(t,i)},Mutation:{saveCalendarSettingsInLocalStorage:(e,t,{localStorage:i})=>((e,t)=>{const i=o(t);return(0,n.forOwn)(e,((e,t)=>{null!=e&&(i[t]=e)})),t.setSafe(s,JSON.stringify(i)),!0})(t,i)}}},19184:(e,t,i)=>{"use strict";i.d(t,{s:()=>Q});var n=i(850402),a=i(927168),s=i(545196),o=i(50805),r=i(793377),c=i(738646),l=i(571096),d=i(516909),u=i(402129),m=i(132756),g=i(905581),h=i(514958);const p=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=i.filter((e=>!e.shareUrl)).map((e=>e.id));if(0===n.length)return i;const a=yield e.shareDriveItems(n),s=new Map;a.forEach(((e,t)=>s.set(n[t],e)));const o=[];for(const e of i){const i=s.get(e.id);if(i){if(!i.link){const i=`ShareUrl (link.webUrl) is not present in createLink response for fileId: ${e.id}`,n={[h.z.internalErrorCode]:"ShareUrlIsMissingFromResponse",[h.z.logErrorMessage]:i};throw t.newLogger("ChatResolversUtilsFiles","data-resolvers-browser-chat").error(`${i}. ${JSON.stringify(n)}`),(0,g.Tr)(m.w5.AddShareUrlOnSendMessage,m.jK.Undefined,"",n,i)}o.push(Object.assign(Object.assign({},e),{shareUrl:i.link.webUrl,shareId:i.shareId}))}else o.push(e)}return o})),v=e=>{var t;return!!(null===(t=null==e?void 0:e.files)||void 0===t?void 0:t.length)},f=(e,t,i)=>{const n=e.newLogger("ChatResolversUtilsFiles","data-resolvers-browser-chat"),{reason:a}=i;if(a){const e={errorCode:a[h.z.internalErrorCode]||i.code||"ErrorCodeMissing",correlationId:a[h.z.correlationId],statusCode:a[h.z.httpCode],message:a[h.z.logErrorMessage]||"Log message is not present in reason bag",errors:a[h.z.logErrorMessage]};throw t.fail(e),n.error(`Failed to generate ShareUrl for files. ${JSON.stringify(e)}`),i}const s={errorCode:i.code||m.jK.Unknown,message:"thrown error is not an instance of IError. So not much data available",errors:`${i.context}_${i.subContext}`};throw t.fail(s),n.error(`Failed to generate ShareUrl for files and as well error is not instance of IError ${JSON.stringify(s)}`),i},b=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{return yield e()}catch(e){const n="Failed to lazy load drive item share service",a={[h.z.internalErrorCode]:e.code||"FailedToLazyLoadDriveItemShareService",[h.z.logErrorMessage]:n,innerError:e},s={errorCode:a[h.z.internalErrorCode],message:a[h.z.logErrorMessage]};i.fail(s);throw t.newLogger("ChatResolversUtilsFiles","data-resolvers-browser-chat").error(`Failed to get DriveItemShareService. error: ${JSON.stringify(s)}`),(0,g.Tr)(m.w5.AddShareUrlOnSendMessage,m.jK.FailedToLazyLoadService,"",a,n)}})),y=e=>!!(null==e?void 0:e.files)&&!!(null==e?void 0:e.files.find((e=>"deeplink"===e.type)));var k=i(788667),S=i(275742),w=i(455572),j=i(663945),C=i(248965),_=i(711676),T=i(760005),I=i(500396),N=i(697337),E=i(200770),F=i(115272);const x={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"optionalTelemetry"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"optionalTelemetry"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidCorrelationId"}},{kind:"Field",name:{kind:"Name",value:"fluidDataLossOccurred"}},{kind:"Field",name:{kind:"Name",value:"fluidDataLossPrevented"}},{kind:"Field",name:{kind:"Name",value:"hasLoopComponentAndContent"}},{kind:"Field",name:{kind:"Name",value:"embedLoopLinks"}}]}}]}}]};var D=i(451567),A=i(871538);const M=e=>{switch(e){case"Standard":return"NORMAL";case"Important":return"HIGH";case"Urgent":return"URGENT"}return null},P=e=>{var t;const i=null===(t=e.computed)||void 0===t?void 0:t.cards;if(!i)return!1;return!!(0,S.find)(i,(e=>"application/vnd.microsoft.card.fluid"===e.contentType||"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType))},O=e=>{var t;if($(e.content)>0)return!0;const i=null===(t=e.computed)||void 0===t?void 0:t.cards;return!!i&&i.some((e=>e.appName===A.SL))},R=e=>{var t;const i=null===(t=e.computed)||void 0===t?void 0:t.cards;if(i){const e=[];return i.forEach((t=>{e.push(t.appId)})),null==e?void 0:e.join(",")}return""},L=e=>{const t=new RegExp(N.T.reply,"g");return(e.match(t)||[]).length},U=(e,t)=>e.split(" ").filter((e=>e===`itemtype="${t}"`)).length,$=e=>e.split(" ").filter((e=>e===`type="${A.m7}"`)).length,W=e=>e?e.replace(/(<([^>]+)>)/gi,""):"",B=(e,t,i,n,a,s,o,r,c,l)=>{var u,m,g,h,p,v,f,b,y,k;return Object.assign(Object.assign({"DataBag.messagelength":W(e.content).length,"DataBag.size":e.content.length,"DataBag.importantflag":M(e.importance),"DataBag.messageType":r?c?"replyConversation":"newConversation":"Update"===t?"chatEdit":"newP2PMessage","DataBag.postType":"Announcement"===e.postType?"announcement":"normal","DataBag.richText":(k=e.messageType,"RichText/Html"===k),"DataBag.fluidCard":P(e),"DataBag.appId":R(e),"DataBag.sfbInteropMessage":(null==s?void 0:s.chatType)===d.z_3.SfBInteropChat,"DataBag.mricollection":(null===(m=null===(u=null==s?void 0:s.memberIds)||void 0===u?void 0:u.map((e=>(0,_.Q2)(e))))||void 0===m?void 0:m.join(" "))||"","DataBag.rostersize":(null===(g=null==s?void 0:s.memberIds)||void 0===g?void 0:g.length)||0,"DataBag.attachments":(null===(h=e.files)||void 0===h?void 0:h.length)||0,"DataBag.attachmentIds":(null===(v=null===(p=e.files)||void 0===p?void 0:p.map((e=>e.id)))||void 0===v?void 0:v.join(" "))||"","DataBag.fileTypeList":(null===(b=null===(f=e.files)||void 0===f?void 0:f.map((e=>e.type)))||void 0===b?void 0:b.filter((e=>!(0,S.isNil)(e))))||[],"DataBag.suggestedFile":null===(y=e.files)||void 0===y?void 0:y.some((e=>"smartReply"===e.context)),"DataBag.leftRailDirective":r?"channel-list":"chat-list","Messaging.messageChannelType":l,"DataBag.messageID":e.id!==e.clientMessageId?e.id:void 0,"DataBag.replyChainId":c,"DataBag.isNewChat":!!o,"DataBag.newChatIntentId":o,"DataBag.tflOffNetworkEmailCount":(null==s?void 0:s.memberIds)?s.memberIds.filter((e=>e.startsWith(T.b6))).length:0,"DataBag.tflOffNetworkOneWayPhoneCount":(null==s?void 0:s.memberIds)?s.memberIds.filter((e=>e.startsWith(T.EI))).length:0,"DataBag.tflSMSMembersCount":(null==s?void 0:s.memberIds)?s.memberIds.filter(_.yj).length:0,"DataBag.offNetworkContactsSelected":(null==s?void 0:s.memberIds)?s.memberIds.filter(_.$i).length:0,"DataBag.hasAADFederatedMembers":(null==s?void 0:s.hasFederatedUser)||!1,"DataBag.hasMSAFederatedMembers":(null==s?void 0:s.hasTflConsumerUser)||!1,"DataBag.quotedReplyCount":L(e.content),"DataBag.groupTemplateType":null==s?void 0:s.groupTemplate,"DataBag.chatType":z(s),"DataBag.GIF":U(e.content,N.T.giphy),"DataBag.Sticker":U(e.content,N.T.sticker),"Designer.containsImageFromDesigner":O(e),"DataBag.composeVersion":n?"Simplified":"Classic"},((e,t)=>{const i={};if(e&&(null==t?void 0:t.isOneOnOne)&&(null==t?void 0:t.hasFederatedUser)){const e=D.eo.getTflExtendedDirectoryMembership(null==t?void 0:t.extendedDirectoryRedemptionRequired);e&&(i["DataBag.TFLUserInED"]=!0,i["DataBag.TFLUserEDState"]=e)}return i})(i,s)),{"DataBag.lifeCycleFlavor":H(s),"DataBag.wasEdited":"Update"===t,"Messaging.additionalContentPresent":a?W(e.content).length>0:void 0,"Messaging.additionalContentLength":a?W(e.content).length:void 0})},z=e=>(null==e?void 0:e.guardianChatInfo)?w.Ml.GuardianChat:null,H=e=>(null==e?void 0:e.awarenessLiveState)?"sync":"async",q=(e,t)=>t===j.Th.Channel?C.Mv.team:(null==e?void 0:e.isOneOnOne)?C.Mv.personal:(null==e?void 0:e.isMeeting)?C.Mv.meeting:(null==e?void 0:e.isOneOnOneBotChat)||(null==e?void 0:e.isOneOnOne)?C.Mv.general:C.Mv.group,V=(e,t,i,n,a,s,o,r,c,u,m,g,h,p,v,f)=>{var b,y;const k=((e,t)=>{var i,n;if(!e||e.chatSubType===I.k2.Channel)return t?j.Th.Channel:void 0;const a=null!==(n=null===(i=e.memberIds)||void 0===i?void 0:i.map((e=>e)))&&void 0!==n?n:[],s=(0,_._K)(e.id,e.isFederated,e.isOneOnOne,e.hasFederatedUser,a);return(0,l.NL)(e.id,e.chatType,e.isMeeting,e.isOneOnOne,e.isOneOnOneBotChat,s,e.isFederated)})(u,h);let S={};k===j.Th.Botchat&&(S=((e,t)=>{var i,n,a;const s=null===(i=null==e?void 0:e.memberIds)||void 0===i?void 0:i.find(_.bl);if(s){const e=s.substring(T.at.BotPrefix.length);try{const i=t.readQuery({query:E.Cj,variables:{installedContext:{scope:d.qi6.Personal}}});if(i){const t=null===(n=i.installedAppsV2)||void 0===n?void 0:n.filter((t=>{var i,n,a;return(null===(a=null===(n=null===(i=null==t?void 0:t.definition)||void 0===i?void 0:i.bots)||void 0===n?void 0:n[0])||void 0===a?void 0:a.id)===e}));if(t&&t.length>0)return{id:null===(a=t[0])||void 0===a?void 0:a.id,capabilityId:e,scenarioCapability:C.Ky.bots}}}catch(e){}}return{}})(u,g));let w={};k!==j.Th.Channel&&k!==j.Th.Communities||(w=((e,t,i,n)=>{var a,s,o,r,c;let l;try{l=e.readQuery({query:F.h,variables:{conversationId:t}})}catch(e){n.error(`Failed to retrieve Team.Id and Team.OfficeGroupId from cache. Thread.Id: ${t}. Thread.Type: ${i}.`)}return{channelType:null==l?void 0:l.channelByID.channelType,teamId:null===(s=null===(a=null==l?void 0:l.channelByID)||void 0===a?void 0:a.owningTeam)||void 0===s?void 0:s.id,officeGroupId:null===(c=null===(r=null===(o=null==l?void 0:l.channelByID)||void 0===o?void 0:o.owningTeam)||void 0===r?void 0:r.teamSiteInformation)||void 0===c?void 0:c.groupId}})(g,e,k,s));const N=null!==(b=null==w?void 0:w.channelType)&&void 0!==b?b:null,x=function(e,t){let i=null;i=e?t?j.wh.discoverSurface:j.wh.Channel:j.wh.Chat;return i}(h,f),D=h?"channel":"chat",A=B(t,i,o,r,c,u,m,h,p,N);a.recordPanelAction({actionGesture:j.uS.click,actionOutcome:j.$K.submit,actionOutcomeNew:j.$K.submit,actionScenarioType:c?j.Yu.forwardMessage:j.Yu.composeMsg,actionScenario:j.Tk.composeSendMessage,appId:A["DataBag.appId"]||"",appScope:q(u,k).toString(),appScenarioCapability:void 0!==A["DataBag.appId"]?C.Ky.messaging.toString():"",moduleName:c?j.rA.forwardButton:j.rA.sendButton,moduleNameNew:c?j.rA.forwardButton:j.rA.sendButton,moduleType:j.PO.sendMessageButton,moduleTypeNew:j.PO.sendMessageButton,officeGroupId:null!=(null==w?void 0:w.officeGroupId)?null==w?void 0:w.officeGroupId:void 0,panelRegion:j.Ai.main,panelType:x,panelRegionNew:j.Ai.main,panelTypeNew:x,panelUri:c?"app.conversation":void 0,threadId:e,teamId:null!=v?v:null==w?void 0:w.teamId,threadMembers:null===(y=null==u?void 0:u.memberIds)||void 0===y?void 0:y.length,threadType:k,actionWorkload:h?j.sz.channelContent:j.sz.chatContent,actionSubworkload:j.eD.composeMsg,tabId:"",tabType:"conversations",tabIdNew:"",tabTypeNew:"conversations",tabOrdinal:1,appName:D,dataBag:{id:"",data:Object.assign(Object.assign(Object.assign({},n),A),G(g,f,p)),dispose:()=>{}},extensibilityData:S},s)};function G(e,t,i){var n,a,s,o,r;const c={};let l=null;try{l=e.readQuery({query:x})}catch(e){}const d=null==l?void 0:l.optionalTelemetry;return void 0!==(null==d?void 0:d.fluidDataLossOccurred)&&null!==(null==d?void 0:d.fluidDataLossOccurred)&&(c["DataBag.fluidDataLossOccurred"]=null===(n=null==l?void 0:l.optionalTelemetry)||void 0===n?void 0:n.fluidDataLossOccurred),void 0!==(null==d?void 0:d.fluidDataLossPrevented)&&null!==(null==d?void 0:d.fluidDataLossPrevented)&&(c["DataBag.fluidDataLossPrevented"]=null===(a=null==l?void 0:l.optionalTelemetry)||void 0===a?void 0:a.fluidDataLossPrevented),void 0!==(null==d?void 0:d.fluidCorrelationId)&&null!==(null==d?void 0:d.fluidCorrelationId)&&(c["Messaging.fluidCorrelationId"]=null===(s=null==l?void 0:l.optionalTelemetry)||void 0===s?void 0:s.fluidCorrelationId),void 0!==(null==d?void 0:d.embedLoopLinks)&&null!==(null==d?void 0:d.embedLoopLinks)&&(c["Messaging.embedLoopLinks"]=null===(o=null==l?void 0:l.optionalTelemetry)||void 0===o?void 0:o.embedLoopLinks),void 0!==(null==d?void 0:d.hasLoopComponentAndContent)&&null!==(null==d?void 0:d.hasLoopComponentAndContent)&&(c["Messaging.hasLoopComponentAndContent"]=null===(r=null==l?void 0:l.optionalTelemetry)||void 0===r?void 0:r.hasLoopComponentAndContent),t&&(c["DiscoverSurface.requestId"]=t,c["DataBag.messageID"]=i),c}var J=i(524243),K=i(76705);const Q={Mutation:{sendMessageWorker(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return Y(e,t)}))},sendMessage(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return Y(e,t)}))}}},Y=(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var i;const{convId:a,action:s,originalConvId:l,withChatNetworkFallback:m,searchSessionId:g,sendFromChannel_ToBeRefactored:h}=e,S=e.message,{cache:w,coreSettings:j,loggerFactory:C,offlineCacheManager:_,getDriveItemShareService:T,scenarioFactory:I,channelView:N,channelOrder:E,teamId:F,getPeopleService:x,requestId:D,authenticationUser:A}=t,{enableInstalledAppsV2:M,enableBotsFileSharing:P,enableAppsQueryOptimization:O,botFileInfoFetchTimeout:R}=j.get(o.J.Extensibility),{enableFilesShareLinksInvite:L,enableSharingByCreateLinkAPI:U,enableFilesShareLinksFetchFederatedUsersAPI:$,enableFilesShareLinksFetchTflConsumerUsersAPI:W,enableSendMessageLoggingForDebugging:B}=j.get(o.J.Files),{msgEnableChannelsV2:z}=j.get(o.J.Host),{enableScheduleMessage:H,enableSimplifiedCompose:q}=j.get(o.J.Messaging),G=!!q,{enableMeetingChatAttachmentsInMCO:Q,meetingChatAttachmentsMap:Y}=j.get(o.J.ArtifactsPlatform),{environment:ae}=j.get(o.J.Metadata),se=ae===r.s.life,oe=C.newLogger("chatMutationForwardResolvers","data-resolvers-browser-chat"),re=(0,u.qr)(s,S),ce=I.findScenario(re),le=yield(0,k.mb)(a,w,t,oe,C,m,null,null,void 0,l||"");null==ce||ce.mark(c.ck.ChatSendMessageGotChat);const de=Z(l,w,oe),ue=yield X(t);null==ce||ce.mark(c.ck.ChatSendMessageServicesLazyLoadComplete);const me=(0,k.Fb)(w,a,M,O),ge=(0,k.QD)(w),he=ee(t,oe);Q&&function(e,t,i,a,s,o,r,l){var u,m,g,h,p,v;(0,n.__awaiter)(this,void 0,void 0,(function*(){const{scenario:n}=(0,J.aN)(c.RG.AddAttachmentToMCO,s),f=null===(u=null==e?void 0:e.files)||void 0===u?void 0:u.length;try{if(f&&("Recurring"===(null===(m=null==t?void 0:t.meetingInformation)||void 0===m?void 0:m.meetingType)||"Scheduled"===(null===(g=null==t?void 0:t.meetingInformation)||void 0===g?void 0:g.meetingType))){const c=yield l(),u=(yield te((null===(h=null==t?void 0:t.meetingInformation)||void 0===h?void 0:h.organizerId)||"",c))||"",m=`${null===(p=t.me)||void 0===p?void 0:p.objectId}@${t.addedByTenantId}`,g=`${t.meetingInformation.organizerId}@${t.meetingInformation.tenantId}`,f=t.meetingInformation.iCalUid||"",b=e.files,y=[];let S="",w="",j=!1;if(b.forEach((e=>{var n,a;const s=(null==e?void 0:e.type)||"";for(const e of i||[])if(e.enabled){if(null===(n=e.fileType)||void 0===n?void 0:n.includes(s)){S=e.appType,w=e.appId,j=!0;break}(null===(a=e.fileType)||void 0===a?void 0:a.includes("all"))&&(j=!0)}if(j){const i=ne(e,t,S,w);y.push(i),S="",w="",j=!1}})),y.length>0){const e=(0,k.i$)(t,f,g,m,u);e?(null===(v=r.errorToTelemetry)||void 0===v||v.call(r,e,"cmd_meetings_collab_object_add_resources_to_collab_object_event"),n.fail({reason:e})):(0,K.A)(o,s,a,d.ceh.MeetingChat,f,f,g,m,y,ie(t,u))}}n.stop()}catch(e){(0,J.S3)(r,e,n,"cmd_meetings_collab_object_add_resources_to_collab_object_event","addAttachemntsToMCO failed with errorCode")}}))}(S,le,Y,C,I,t.getCollabObjectService,oe,x);const pe={"DataBag.searchSessionId":g,"DataBag.isChannelsV2":!!z,"DataBag.channelView":N,"Channels.channelOrder":E,"Compose.sendPostAsEmail":!!(null==S?void 0:S.sendPostAsEmail),"Messaging.isShadowMTOMember":(null==A?void 0:A.subType)===d.Yfn.Mto,"Messaging.isMTOMember":null,"Messaging.hasMTOMembers":null==le?void 0:le.hasFederatedMTOUser};let ve=yield(0,k.JB)(t,S,s,a,he,Object.assign(Object.assign({},ue),{cache:w,offlineCacheManager:_,telemetryDatabag:pe,convId:a,conversationMembers:null==le?void 0:le.memberIds,getInstalledMessageExtensionApps:me,getAppDefinitions:ge,authenticationUser:A}),ce,!!h,null!==(i=null==le?void 0:le.isCommentStream)&&void 0!==i&&i);return U&&S&&((0,k.Oc)(oe,"Adding share url to files payload pram- addShareUrlToFiles","send_message_forward_resolver",B),ve=yield((e,t,i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(v(a)){const n=t.newScenario(c.RG.FilesCreateShareLink),s=yield b(e,i,n);try{const e=yield p(s,i,a.files);return n.stop(),Object.assign(Object.assign({},a),{files:e})}catch(e){f(i,n,e)}}return Object.assign({},a)})))(T,I,C,ve)),(0,k.Oc)(oe,"calling updateFluidMessageShareUrl","send_message_forward_resolver",B),ve=yield(0,k.KE)(ve,oe,t),(0,k.Oc)(oe,"calling getBotDownloadUrlForFiles","send_message_forward_resolver",B),ve=yield(0,k.R_)(ue.botsPlatformService,ve,P,C,le,R),ve=(0,k.wX)(ve,le),(L||H)&&le&&(0,k.iX)(le)&&!y(ve)&&((0,k.Oc)(oe,"Creating Sharelinks if the files attached in Chat with no share url getMessageWithFileShareLinks","send_message_forward_resolver",B),ve=yield(0,k.Ju)(ve,le,t,oe,$,W)),(L||H)&&h&&!y(ve)&&((0,k.Oc)(oe,"Creating Sharelinks if the files attached in Channel with no share url getMessageWithFileShareLinksForChannel","send_message_forward_resolver",B),ve=yield(0,k.DE)(ve,w,a,oe,t)),((e,t,i,n,{loggerFactory:a,userBiService:s,cache:o},r,c,l,d,u,m,g,h,p)=>{const v=a.newLogger("sendMessageTelemetry","data-resolvers-browser-chat");s?V(e,t,i,n,s,v,r,c,l,d,u,o,m,g,h,p):v.warn("userBiService is null")})(a,ve,s,pe,t,se,G,(0,k.Cf)(S),le,de,h,null==S?void 0:S.replyChainId,F,D),Object.assign(Object.assign({},e),{message:ve})})),X=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{getAppBasedLinkService:t,getAsyncMediaService:i,getUrlPreviewService:n,getImageProxyService:a,getFilesReferenceService:s,getBotsPlatformService:o}=e,[r,c,l,d,u,m]=yield Promise.all([i(),a(),n(),s(),t(),o()]);return{asyncMediaService:r,imageProxyService:c,urlPreviewService:l,fileReferenceService:d,appBasedLinkService:u,botsPlatformService:m}})),Z=(e,t,i)=>{var n;let s=null;if((0,l.UL)(e))try{const i=t.readQuery({query:a.i,variables:{convId:e}});s=null!==(n=null==i?void 0:i.newChatIntentId)&&void 0!==n?n:null}catch(e){i.error("Failed to find newChatIntentId in cache")}return s},ee=(e,t)=>{var i;let n=!0;const{cache:a,coreSettings:r}=e,{enableConnectedExperiences:c}=r.get(o.J.Messaging);if(!c)return n;try{const e=a.readQuery({query:s.K});n="false"!==(null===(i=null==e?void 0:e.userPreferences)||void 0===i?void 0:i.controllerConnectedServicesEnabled)}catch(e){t.error("Failed to find userPreferences in cache")}return n},te=(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const i=`8:orgid:${e}`,n=(yield t.getPeopleProfilesByMris([i],"MeetingChat")).get(i);return null==n?void 0:n.userPrincipalName})),ie=(e,t)=>{var i;return{meetingUrl:(null===(i=e.meetingInformation)||void 0===i?void 0:i.meetingJoinUrl)||"https://teams.microsoft.com",threadId:e.id,messageId:"0",organizerUpn:t}},ne=(e,t,i,n)=>{var a;return{location:(null==e?void 0:e.objectUrl)||"",type:d.ceh.MeetingChat,subType:i||"",metadata:{appTitle:i||"",appId:n||"",userId:(null===(a=null==t?void 0:t.me)||void 0===a?void 0:a.objectId)||"",fileTitle:(null==e?void 0:e.title)||"",imageUrl:(null==e?void 0:e.previewUrl)||"",shareUrl:(null==e?void 0:e.shareUrl)||"",fileId:(null==e?void 0:e.id)||"",fileType:(null==e?void 0:e.type)||"",baseUrl:(null==e?void 0:e.baseUrl)||""}}}},788667:(e,t,i)=>{"use strict";i.d(t,{QD:()=>J,R_:()=>V,mb:()=>oe,i$:()=>le,Fb:()=>K,Ju:()=>X,DE:()=>Z,iX:()=>re,Cf:()=>q,Oc:()=>de,PJ:()=>H,JB:()=>B,wX:()=>ce,KE:()=>ie});var n=i(850402),a=i(275742),s=i(491465),o=i(738646),r=i(516909),c=i(664585),l=i(571096),d=i(974794);let u=class{transform(e,t){var i,n,s,o,r,c;if(e.parent&&1===e.parent.children.length&&"div"===(null===(i=e.parent.name)||void 0===i?void 0:i.toLowerCase())&&"root"===(null===(n=e.parent.parent)||void 0===n?void 0:n.type)){if((!e.children||0===e.children.length)&&"text"===e.type)return t.isPureText=!0,void(t.textContent=(0,a.unescape)(e.data));if("tag"===e.type&&"p"===(null===(s=e.name)||void 0===s?void 0:s.toLowerCase())&&1===(null===(o=e.children)||void 0===o?void 0:o.length)&&"text"===e.children[0].type)return t.isPureText=!0,void(t.textContent=(0,a.unescape)(null===(r=e.children)||void 0===r?void 0:r[0].data));if("tag"===e.type&&"p"===(null===(c=e.name)||void 0===c?void 0:c.toLowerCase()))return e.name="div",e}}};u=(0,n.__decorate)([(0,d.wx)({name:"BotMessageContentSerializer",filter:"*"})],u);var m=i(4902),g=i(539744),h=i(711676),p=i(876661),v=i(760005),f=i(113851),b=i(50805);var y=i(188143),k=i(871538),S=i(671168),w=i(575644),j=i(697337),C=i(2246),_=i(627997),T=i(549351);const I={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserChatAppDefinitionsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinitions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}}]}},...i(795820).Eb.definitions]};var N=i(115272),E=i(200770),F=i(902541);const x={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...F.W4.definitions]},D={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedApps"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApps"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScopes"},value:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...F.W4.definitions]};var A=i(38613);const M={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};let P=class{transform(e,t){if(e&&e.attribs&&C.zj.cacheKey in e.attribs&&e.attribs[C.zj.cacheKey]===t.cacheKey)return t.instancesReplaced++,void 0!==t.value?e.attribs[t.prop]=t.value:t.prop in e.attribs&&void 0===t.value&&delete e.attribs[t.prop],e}};P=(0,n.__decorate)([(0,d.wx)({name:"InlineVideoUpdater",filter:[{itemtype:j.T.amsVideo}]})],P);const O="external_tfw_tfl_users",R="external_tfw_users",L="external_tfl_users",U="internal_users",$=(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const i=e.loggerFactory.newLogger("postTransformationCleanup","data-resolvers-browser-chat");e.nonBlockingDeletableCacheKeys.length&&(i.log(`AsyncSendSerialization: Cleaning up ${e.nonBlockingDeletableCacheKeys.length} cached items.`),null==t||t.mark(o.ck.ChatSendMessageSerializationCacheCleanup));for(const t of e.nonBlockingDeletableCacheKeys)try{(yield e.offlineCacheManager.delete(t))||i.warn(`AsyncSendSerialization: Failed to delete cached image with key: ${t}`)}catch(e){i.warn(`AsyncSendSerialization: Failed to delete cache image with key: ${t}. Also, we experienced an error, which is being considered non blocking to ensure we do not cause a terminal send issue.`)}})),W=(e,t,i,a,s,r,c,l)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{cache:n,loggerFactory:u}=e,g=u.newLogger("chat-resolver-utils","data-resolvers-browser-chat"),h=(0,d.te)(m.bl,t,i);try{q(s)||(yield(0,T.yG)(n,e,a,s,r,h,i.messageProperties,l),null==c||c.mark(o.ck.ChatSendMessageOptimisticResponsePosted))}catch(e){g.error(`client lie generation failed for conversation: ${a} clientMessageId: ${s.clientMessageId} error: ${e}`)}return(0,d.zL)(m.Vf,h,Object.assign(Object.assign({},i),{videoMessageLieUpdater:(e,t,i)=>((e,t,i,n,a)=>{if(!t)throw Error("clientMessageId undefined");const s=`Message:${t}`;let o;try{o=e.readFragment({id:s,fragment:M})}catch(e){throw e}if(!o)throw Error(`Message lie ${s} not found.`);if(!o.content)throw Error(`Message lie ${s} has no content.`);const r={cacheKey:i,prop:n,value:a,instancesReplaced:0},c=(0,d.te)([P],o.content,r);if(1!==r.instancesReplaced)throw Error(`${r.instancesReplaced} instances found instead of 1`);{const i=(0,A.MX)()[0].toString();try{e.writeFragment({id:s,fragment:M,data:{__typename:"Message",id:t,content:c,version:i}})}catch(e){throw e}}})(n,s.clientMessageId,e,t,i)}),$)})),B=(e,t,i,a,s,r,c,l,d)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{content:u,computed:m,files:g,clientMessageId:h,deeplinks:p,title:v}=t,y=(0,n.__rest)(t,["content","computed","files","clientMessageId","deeplinks","title"]),{coreSettings:k,i18n:S,loggerFactory:w,scenarioFactory:j}=e,C=Object.assign(Object.assign({conversationId:a,connectedExperienceEnabled:s,existingLinks:(null==m?void 0:m.embeddedLinks)||[],messageProperties:m?Object.assign(Object.assign({},m),{embeddedLinks:[],mentions:m.mentions?[...m.mentions]:void 0,onBehalfOf:m.onBehalfOf?[...m.onBehalfOf]:void 0}):{},files:g?[...g]:[],coreSettings:k,loggerFactory:w,i18n:S,scenarioFactory:j,nonBlockingDeletableCacheKeys:[]},d&&{isLiteEmoticon:!0,disableBigEmoticons:!0}),r),_=w.newLogger("chat-resolver-utils","data-resolvers-browser-chat"),T=yield W(e,u,C,a,t,i,c,l),I=((e,t)=>{const{enableEntityConversationInMWTab:i}=e.get(b.J.Extensibility);if(!i)return[];const n=f.h.getInstance(),a=n.getSubEntityDeepLinkInfo();return a&&t&&n.getClientMessageId()===t?(n.setSubEntityDeepLinkInfo(void 0),n.setClientMessageId(void 0),[a]):[]})(k,h||void 0),{updatedTitle:N,updatedCards:E,updatedAmsReferences:F}=yield z(v||"",C);return _.log(`serialized message ${h}`),null==c||c.mark(o.ck.ChatSendMessageSerializationComplete),Object.assign({content:T,computed:Object.assign(Object.assign({},C.messageProperties),{cards:E,amsReferences:F}),files:C.files,deeplinks:I.length>0?I:p,clientMessageId:h,title:N},y)})),z=(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var i,n,a,s;let o=e,r=t.messageProperties.cards,c=t.messageProperties.amsReferences;if(null==r?void 0:r.length){const e=r.find((e=>e.appId===k.lq&&e.contentType===k.hY));if(e){let l=JSON.parse(e.content);if((null===(i=l.imageData)||void 0===i?void 0:i.origImage)&&(null===(s=null===(a=null===(n=l.imageData)||void 0===n?void 0:n.croppedImage)||void 0===a?void 0:a.src)||void 0===s?void 0:s.startsWith("blob:"))){const i=yield(0,S.Hk)(l.imageData.croppedImage.src),n="MicrosoftTeams-image.png",a=yield t.asyncMediaService.uploadItem(i,t.conversationId,"IMAGE",n,y.r1.Inline),s=a.inlineSizeUrl.replace("/imgo","/imgpsh_fullsize");l=Object.assign(Object.assign({},l),{imageData:Object.assign(Object.assign({},l.imageData),{croppedImage:Object.assign(Object.assign({},l.imageData.croppedImage),{id:a.objectId,src:s}),origImage:Object.assign(Object.assign({},l.imageData.origImage),{id:a.objectId,src:s})})}),c=(null==c?void 0:c.length)?[...c,a.objectId]:[a.objectId];const d=Object.assign(Object.assign({},e),{content:JSON.stringify(l)});r=r.map((e=>e.appId===k.lq&&e.contentType===k.hY?d:e)),o=""}}}return{updatedTitle:o,updatedCards:r,updatedAmsReferences:c}})),H=(e,t)=>{const{loggerFactory:i,offlineCacheManager:n}=e,a={logger:i.newLogger("chat-resolvers-utils","data-resolvers-browser-chat"),offlineCacheManager:n},s=(0,d.te)(m.D,t.content,a);return Object.assign(Object.assign({},t),{content:s})},q=e=>!!(null==e?void 0:e.forwardMessageId)&&!!(null==e?void 0:e.forwardMessageOriginalConvId),V=(e,t,i,a,s,o)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(!s||!i||!t.files||0===t.files.length)return t;if(!(null==s?void 0:s.isOneOnOneBotChat))return t;const n=a.newLogger("chat-resolver-utils","data-resolvers-browser-chat"),r=o||1e4,c=yield Promise.all(t.files.map((t=>G(t,e,n,r))));return Object.assign(Object.assign({},t),{files:c})})),G=(e,t,i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=e.objectUrl;if(n){let s;try{s=yield(0,w.E)(t.getBotFileDownloadUrl(n,i),a,"get bot downlaod url timed out")}catch(e){s=null,i.error("getBotDownloadUrlForFiles: failed to get file info")}if(s)return Object.assign(Object.assign({},e),{downloadUrl:s})}return e})),J=e=>()=>{var t;try{const i=e.readQuery({query:I,variables:{options:{capabilityFilter:[r.PwB.Messaging]}}});return null===(t=null==i?void 0:i.appDefinitions)||void 0===t?void 0:t.filter((e=>!!e))}catch(e){return}},K=(e,t,i,n)=>()=>{var s;try{if(i){const i=Q(e,t,n);return(0,a.compact)(null==i?void 0:i.filter((e=>{var t;return null===(t=null==e?void 0:e.definition)||void 0===t?void 0:t.messageExtensions})).map((e=>e&&Y(e)?e:null)))}{const i=e.readQuery({query:D,variables:{conversationId:t,installedScopes:[r.qi6.Personal,r.qi6.GroupChat],options:{capabilityFilter:[r.PwB.Messaging]}}});return(0,a.compact)(null===(s=null==i?void 0:i.installedApps)||void 0===s?void 0:s.map((e=>e&&Y(e)?e:null)))}}catch(e){return}},Q=(e,t,i)=>{var n;let a=null;try{a=e.readQuery({query:E.Cj,variables:{installedContext:{scope:r.qi6.Personal}}})}catch(e){a=null}let s=null;try{if(i){const i=e.readQuery({query:x,variables:{conversationId:t}});s=null==i?void 0:i.installedChatAppsWithPreCheck}else{const i=e.readQuery({query:E.Cj,variables:{installedContext:{conversationId:t,scope:r.qi6.GroupChat}}});s=null==i?void 0:i.installedAppsV2}}catch(e){s=null}const o=null!=s?s:[];return(null!==(n=null==a?void 0:a.installedAppsV2)&&void 0!==n?n:[]).concat(o)},Y=e=>(0,a.includes)([r.JMQ.Installed,r.JMQ.InstalledAndFavorited,r.JMQ.InstalledAndPermanent],e.installationState),X=(e,t,{getSharepointShareService:i,getPeopleService:a,discover:s,scenarioFactory:r},c,l,d)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n;if((null===(n=null==e?void 0:e.files)||void 0===n?void 0:n.length)&&!(null==t?void 0:t.isOneOnOneBotChat)){const n=r.newScenario(o.RG.FileSharelinkMessageSend),u=yield i(),m=yield a(),g=yield s.skypeid();let h=[];try{n.mark(o.ck.FetchingUserDetailsStarted);h=(yield se(t,m,n,c,l,d)).filter((e=>e.mri!==g)),n.mark(o.ck.ShareUrlInviteCallForChatStarted);const i=yield u.shareFiles(e.files,h,n);return n.stop(),Object.assign(Object.assign({},e),{files:i})}catch(e){throw ee(e,n,h.length),c.error("getMessageWithFileShareLinks: Failed to create the shareLink for Chat's message."),e}}return e})),Z=(e,t,i,a,{getSharepointShareService:s,scenarioFactory:r})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n,c;const l=te(t,i,a),{teamSiteInformation:d,smtpAddress:u}=(null===(n=null==l?void 0:l.channelByID)||void 0===n?void 0:n.owningTeam)||{},m=(null==d?void 0:d.sharepointSiteUrl)||null,g=(null==d?void 0:d.groupId)||null;if(m&&u&&g&&(null===(c=null==e?void 0:e.files)||void 0===c?void 0:c.length)&&e.files[0].baseUrl!==m){const t=r.newScenario(o.RG.FileSharelinkMessageSend);try{const i=yield s();t.mark(o.ck.ShareUrlInviteCallForChannelStarted);const n=[{id:g,smtpAddresses:[u],objectId:g}],a=yield i.shareFiles(e.files,n,t);return t.stop(),Object.assign(Object.assign({},e),{files:a})}catch(e){ee(e,t,1),a.error("getMessageWithFileShareLinksForChannel: Failed to create the shareLink for Channel's message")}}return e})),ee=(e,t,i)=>{var n,a,s,o;const r={errorCode:`${null===(n=null==e?void 0:e.serverResponse)||void 0===n?void 0:n.status}`,errors:JSON.stringify([null==e?void 0:e.code]),correlationId:null===(a=null==e?void 0:e.reason)||void 0===a?void 0:a.correlationId,errorMessage:null===(s=null==e?void 0:e.reason)||void 0===s?void 0:s.logErrorMessage,numOfUsers:i,reason:null===(o=null==e?void 0:e.reason)||void 0===o?void 0:o.reason};t.fail(r)},te=(e,t,i)=>{try{return e.readQuery({query:N.h,variables:{conversationId:t}})}catch(e){return i.error("getChannelFieldsForFileSharing: Failed to find channels related data"),null}},ie=(e,t,{getFluidService:i})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n,a;if(e&&e.content&&e.fluidUrlPermissionInfo&&e.fluidUrlPermissionInfo.grantPermissionVariables){const{siteUrl:s,driveId:o,itemId:r,queryParams:c,linkType:l,scope:d,recipientList:u,createShareLinkOptions:m}=e.fluidUrlPermissionInfo.grantPermissionVariables,h=yield i();try{const t=yield h.createShareLink(s,o,r,c,l,d,u,m),i=null===(n=null==t?void 0:t.link)||void 0===n?void 0:n.webUrl,p=null===(a=e.computed)||void 0===a?void 0:a.cards;if(p&&i){const t=p.find((e=>e.contentType===g.p.FluidEmbed||"fluid-card"===e.appId));if(t&&t.contentType===g.p.FluidEmbed){const n=t.cardClientId,a=JSON.parse(t.content).componentUrl,s=ne(t,i),o=ae(e.content,j.T.fluidEmbedLink,i,a,n);return Object.assign(Object.assign({},e),{content:o,computed:Object.assign(Object.assign({},e.computed),{cards:s})})}if(t&&"fluid-card"===t.appId){const n=ne(t,i);return Object.assign(Object.assign({},e),{computed:Object.assign(Object.assign({},e.computed),{cards:n})})}}}catch(e){t.warn(`Error creating fluid sharelink in chat resolvers: ${e}`)}}return e})),ne=(e,t)=>{const i=[],n=e.contentType===g.p.FluidEmbed?JSON.parse(e.content).sourceType:null,a=JSON.stringify({componentUrl:t,sourceType:n}),s=Object.assign(Object.assign({},e),{content:a});return i.push(s),i},ae=(e,t=j.T.fluidLink,i,n,a)=>{const s=_.N.parseDOM(e),o=_.N.DomUtils.findAll((e=>"a"===e.name&&_.N.DomUtils.getAttributeValue(e,C.zj.itemtype)===t&&!!_.N.DomUtils.getAttributeValue(e,"href")),s),r=_.N.DomUtils.getAttributeValue(s[1],"itemid"),c=_.N.DomUtils.getAttributeValue(o[0],"href");if((e=>e.length>=1)(o)&&o[0]&&r&&a&&c&&n&&i&&r===a&&c===n){return e.replace(/href="(.*?)"/,`href="${i}`)}return e},se=(e,t,i,s,r,l)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{const n=e.hasFederatedUser,s=e.hasTflConsumerUser,[d,u]=s?(0,a.partition)(e.memberIds,(t=>(0,h.Nl)(t)&&!(0,p.Bl)(e.id))):[[],e.memberIds];let m;r&&n?(i.mark(o.ck.FetchingFederatedUser),m=yield(0,c.a2)(u||[],t)):m=yield(0,c.Mv)(u||[],t);let g,v=[];return l&&s&&(i.mark(o.ck.FetchingTflConsumerUser),v=yield(0,c.LH)(d||[],t)),g=n&&s?O:n?R:s?L:U,i.mark(o.ck.FetchingUserDetailsCompleted,{message:g}),m.concat(v)}catch(e){throw s.error("getUsersForShareLink: Failed to fetch users from People Service(mt)."),e}})),oe=(e,t,i,a,o,r,c,d,u,m)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n,g;let h;try{h=null===(n=t.readQuery({query:s.vh,variables:{convId:e}}))||void 0===n?void 0:n.chat}catch(e){a.error("Failed to find chat in cache")}if(r&&!h){const t=yield i.getCSAService(),n=yield t.getChat(e);n&&(h=(0,l._$)(n,o,c,{id:d},u))}const p=(0,l.UL)(m)||(0,l.AK)(m);if(!h&&p&&m){e=m;try{h=null===(g=t.readQuery({query:s.vh,variables:{convId:e}}))||void 0===g?void 0:g.chat}catch(e){a.error("Failed to find chat in cache")}}return h})),re=({chatType:e})=>e===r.z_3.Chat||e===r.z_3.Meeting,ce=(e,t)=>{var i,n;const s=!(0,a.isEmpty)(null==t?void 0:t.botMembers),o=!!(null===(n=null===(i=e.computed)||void 0===i?void 0:i.mentions)||void 0===n?void 0:n.find((e=>"bot"===e.mentionType)));if(!((null==t?void 0:t.isOneOnOneBotChat)||s&&o))return e;const r={},c=(0,d.te)([u],e.content,r);return r.isPureText&&!(0,a.isNil)(r.textContent)?Object.assign(Object.assign({},e),{content:r.textContent,messageType:"BotMessageBack"===e.messageType?"BotMessageBack":v.Cs.Text}):Object.assign(Object.assign({},e),{content:c})},le=(e,t,i,n,a)=>{var s;let o="";return e||(o=o?o.concat(", Chat Object ( thus meetingUrl)"):o.concat("Missing Chat Object ( thus meetingUrl)")),t||(o=o?o.concat(", externalEntityKey"):o.concat("Missing externalEntityKey")),i||(o=o?o.concat(", organizer"):o.concat("Missing organizer")),n||(o=o?o.concat(", user"):o.concat("Missing user")),e&&!(null===(s=e.meetingInformation)||void 0===s?void 0:s.meetingJoinUrl)&&(o=o?o.concat(", meetingUrl"):o.concat("Missing meetingUrl")),a||(o=o?o.concat(", organizerUpn"):o.concat("Missing organizerUpn")),o||void 0},de=(e,t,i,n)=>{n&&e.log(t,i)}},549351:(e,t,i)=>{"use strict";i.d(t,{yG:()=>u,lD:()=>m,wr:()=>g});var n=i(850402),a=i(275742),s=i(255550),o=i(572141),r=i(628694),c=i(38613),l=i(871538),d=i(516909);const u=(e,t,i,a,r,c,{mentions:u,cards:m,onBehalfOf:g},v)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:n,discover:f,loggerFactory:b}=t,y=b.newLogger("Client Lie Helper","data-resolvers-browser-chat"),[{profile:{name:k}},S]=yield Promise.all([n.getUser(),f.skypeid()]),w=(0,l.VU)(c,a.subject||"",a.postType);let j=p(w,a,{mentions:u,cards:m,onBehalfOf:g});const{replyChainId:C}=a;j=Object.assign(Object.assign({},j),{from:S,imDisplayName:k});const _=r===d.xyM.Update;if(_){const{clientMessageId:e,id:t,originalArrivalTime:i,messageType:n}=a;t&&i&&n?j=Object.assign(Object.assign({},j),{id:t,originalArrivalTime:i,editTime:new Date(Date.now()).toISOString(),messageType:n}):y.error(`can't find id, originalArrivalTime, messageType for ${e}`)}const T=_||v&&!!a.id;v?(0,o.x)(e,i,C||void 0,h(j,a),S,T,_,(null==a?void 0:a.postType)||void 0,y):(0,s.zf)(e,i,null,[j],S,!0,y)})),m=e=>p(e.content,e,e.computed||{}),g=e=>h(m(e),e),h=(e,t)=>{var i;const n=!(null==t?void 0:t.replyChainId),a=(0,l.FT)((null==t?void 0:t.subject)||"",null==t?void 0:t.postType),s=(null==t?void 0:t.replyPermission)||null,o=n&&(null==t?void 0:t.postType)===d.hQF.Announcement?(0,l.JY)(t):void 0,{fragmentTypeName:c}=(0,r.Gw)(null==t?void 0:t.postType);return Object.assign(Object.assign({},e),{__typename:n?c:"ReplyChainMessage",id:e.id||"",isImportant:"Important"===e.importance,isPinned:!1,messageRenderType:d.Mem.Standard,subject:a||"",isLastRead:!1,isTimestampDividerNeeded:!1,isCrossPost:!1,crossPostId:null,postType:null!==(i=null==t?void 0:t.postType)&&void 0!==i?i:null,attached:null,translation:null,translatedSubject:null,translatedContent:null,translationStatus:null,isOnDemandTranslation:!1,softDeleteReason:null,sourceLanguageName:null,sourceLanguageCode:null,isWrittenInPreferredLanguage:!0,languageSeenBefore:!0,announcement:o,replyPermission:s,deletionInfo:{__typename:"MessageDeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!1},canUserReply:!0,parentsAnnouncementsStatus:null,fromUser:null})},p=(e,{clientMessageId:t,files:i,deeplinks:n,importance:a,messageType:s,scheduledSendTime:o},{mentions:r,cards:l,onBehalfOf:u})=>({__typename:"Message",id:t||"",clientMessageId:t||"",originalArrivalTime:new Date(Date.now()).toISOString(),version:(0,c.MX)()[0].toString(),importance:a||null,content:e,messageType:s||"RichText/Html",interopDeliveryState:null,smsDeliveryReports:null,emotionsSummary:null,emotions:null,escalations:null,mentions:v(r),onBehalfOf:v(u),cards:f(l),from:null,imDisplayName:null,renamedDisplayName:null,files:b(i),deeplinks:y(n),urlPreview:null,embeddedLinks:null,dlpContext:null,deleteTime:null,editTime:null,status:d.rJC.Sending,diagnosticInfo:null,deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!1},userHasSaved:!1,callId:null,replyPermission:null,translation:null,atpSharepointData:null,isDeletedByAdmin:null,meeting:null,hardDeleteTime:null,hardDeleteReason:null,translatedSubject:null,translatedContent:null,translationStatus:null,isOnDemandTranslation:!1,sourceLanguageName:null,sourceLanguageCode:null,isWrittenInPreferredLanguage:!0,languageSeenBefore:!0,forwardedMessageContext:null,scheduledSendTime:o||null,draftId:o?t||"":null,crossPostStatus:null,crossPostFailedChannels:null,vivaTopicsAnnotations:null}),v=e=>(0,a.map)(e,(e=>{var{itemId:t}=e,i=(0,n.__rest)(e,["itemId"]);return Object.assign({__typename:"Mention",id:t,itemId:t},i)})),f=e=>(0,a.map)(e,(e=>({__typename:"Card",appIcon:e.appIcon||null,appId:e.appId,appName:e.appName||null,cardClientId:e.cardClientId,content:e.content,contentType:e.contentType,locale:e.locale||null,userSpecificContent:null}))),b=e=>(0,a.map)(e,(e=>{var{chicletBreadcrumbs:t,title:i,type:a,objectUrl:s}=e,o=(0,n.__rest)(e,["chicletBreadcrumbs","title","type","objectUrl"]);return{__typename:"File",id:o.id,itemId:o.itemId||null,chicletBreadcrumbs:t?{__typename:"ChicletBreadcrumbs",sourceChannelName:t.sourceChannelName||null,sourceTeamName:t.sourceTeamName||null}:null,baseUrl:null,objectUrl:null!=s?s:"",shareId:null,shareUrl:null,type:a||null,title:i||null,previewUrl:null,previewHeight:null,previewWidth:null,progressComplete:null,hasUploadFailed:!1,serviceName:null,providerDataV2:null,state:null}})),y=e=>(0,a.map)(e,(e=>({__typename:"DeepLink",id:(0,n.__rest)(e,[]).id,channelId:null,title:null,siteUrl:null,objectUrl:null,serverRelativeUrl:null,state:null})))},115272:(e,t,i)=>{"use strict";i.d(t,{h:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserChatChannelIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"channelType"}},{kind:"Field",name:{kind:"Name",value:"owningTeam"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"smtpAddress"}},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}}]}}]}}]}}]}}]}},200770:(e,t,i)=>{"use strict";i.d(t,{Cj:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsV2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...i(902541).W4.definitions]}},810786:(e,t,i)=>{"use strict";i.d(t,{D:()=>a});var n=i(480389);const a={Mutation:{updateFilePermission(e,{updateFilePermissionInput:t},{cache:i}){if(!t)return!1;const{fileId:a,shareUrl:s,shareId:o,scope:r}=t,c=n.Ps`
  fragment filePermissionUpdate on FileUpload {
    id
    shareUrl
    shareId
    permissionScope
  }
`;let l;const d=`FileUpload:${a}`;try{l=i.readFragment({fragment:c,id:d})}catch(e){throw e}if(!l)throw new Error("Expected initial files to be populated before a command is executed");const u=Object.assign(Object.assign({},l),{shareUrl:s,shareId:o,permissionScope:r});return i.writeFragment({fragment:c,id:d,data:u}),!0},updatePermissionScopeInFileUpload(e,{updatePermissionScopeInput:t},{cache:i}){if(!t)return!1;const{fileId:a,scope:s}=t;if(!a)return!1;const o={permissionScope:s,__typename:"FileUpload"};try{i.writeFragment({fragment:n.Ps`
  fragment updatePermissionScope on FileUpload {
    permissionScope
  }
`,id:`FileUpload:${a}`,data:o})}catch(e){return!1}return!0}}}},524243:(e,t,i)=>{"use strict";i.d(t,{Uk:()=>r,S3:()=>l,o9:()=>o,aN:()=>c});var n=i(659726),a=i(74187);var s=i(915929);const o=e=>(0,n.A)(e)||"<scrubbed>",r=e=>e.map((e=>e.type)).sort().toString(),c=(e,t)=>{const i=t.newScenario(e);let n=i.id;return function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}(n)||(n=(0,s.v4)()),i.appendEventData({correlationId:n}),{scenario:i,correlationId:n}};function l(e,t,i,n,s){var o,r,c,l,d,u,m,g,h;const p={message:null===(o=t.reason)||void 0===o?void 0:o[a.zm.logErrorMessage],statusCode:null===(r=t.reason)||void 0===r?void 0:r[a.zm.httpStatusCode],errorCode:null===(c=t.reason)||void 0===c?void 0:c[a.zm.internalErrorCode],subError:null===(l=t.reason)||void 0===l?void 0:l[a.zm.subError],correlationId:null===(d=t.reason)||void 0===d?void 0:d[a.zm.correlationId],cmdRequestId:null===(u=t.reason)||void 0===u?void 0:u[a.zm.cmdRequestId],reportingService:null===(m=t.reason)||void 0===m?void 0:m[a.zm.reportingService]};!function(e,t,i,n){e.errorToTelemetry?e.errorToTelemetry(t,i,n,!0):e.error(t)}(e,`${s} ${null===(g=t.reason)||void 0===g?void 0:g[a.zm.internalErrorCode]}, errorMessage: ${null===(h=t.reason)||void 0===h?void 0:h[a.zm.logErrorMessage]}`,n,p),i.fail(p)}},76705:(e,t,i)=>{"use strict";i.d(t,{s_:()=>g,A:()=>h});var n=i(850402),a=i(132756),s=i(738646),o=i(74187),r=i(516909),c=i(905581),l=i(275742),d=i(524243);let u;const m=e=>u||(u=e.newLogger("meeting-artifacts-resolvers","data-resolvers-browser-meeting-artifacts")),g={Query:{meetingArtifacts(e,{meetingArtifactType:t,externalEntityKey:i,organizer:a,user:o},{getCollabObjectService:r,scenarioFactory:c,loggerFactory:l,callerApp:g}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:n}=(0,d.aN)(s.RG.ReadCollabObject,c),h=(0,d.o9)(i);e.appendEventData({externalEntityKey:h}),m(l),u.log(`Read collab object for ${h}`);try{const s=yield r(),c=yield s.readCollabObject(n,i,a,o,g),l=((null==c?void 0:c.resources)||[]).filter((e=>e.type.toLowerCase()===t.toLowerCase())).map((e=>({id:e.id,type:v(e.type),location:e.location,metadata:e.metadata})));u.log(`type of resources received after reading collabObject ${(0,d.Uk)(l)}`);const m={changeKey:null==c?void 0:c.changeKey,resources:l};return e.stop({message:(0,d.Uk)(l)}),m}catch(t){return(0,d.S3)(u,t,e,"cmd_meetings_collab_object_read_collab_object_event","get meetingArtifacts query failed with errorCode"),Promise.reject(t)}}))},allMeetingArtifacts(e,{externalEntityKey:t,organizer:i,user:a},{getCollabObjectService:o,scenarioFactory:r,loggerFactory:c,callerApp:l}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:n}=(0,d.aN)(s.RG.ReadCollabObject,r),g=(0,d.o9)(t);e.appendEventData({externalEntityKey:g}),m(c),u.log(`Read collab object to get all meeting artifacts for ${g}`);try{const s=yield o(),r=yield s.readCollabObject(n,t,i,a,l),c=((null==r?void 0:r.resources)||[]).filter((e=>f(e.type))).map((e=>Object.assign({id:e.id,type:v(e.type),location:e.location,subType:e.subType},e.metadata)));u.log(`type of resources received after reading collabObject to get all meeting artifacts are ${(0,d.Uk)(c)}`);const m={changeKey:null==r?void 0:r.changeKey,resources:c};return e.stop({message:(0,d.Uk)(c)}),m}catch(t){return(0,d.S3)(u,t,e,"cmd_meetings_collab_object_read_collab_object_event","get meetingArtifacts query failed with errorCode"),Promise.reject(t)}}))},allMeetingArtifactsBatch(e,{meetingArtifactsBatchInputList:t},{getCollabObjectService:i,scenarioFactory:a,loggerFactory:o}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:n}=(0,d.aN)(s.RG.ReadCollabObjectBatchRequest,a);m(o),u.log(`Read group of meeting artifacts for ${t.length} meetings start`);try{const a=yield i(),s=yield a.readCollabObjectBatchRequest(n,function(e){const t={collabIds:{}};return e.forEach((e=>{t.collabIds=Object.assign(Object.assign({},t.collabIds),{[e.iCalUid]:{smtp:e.organizer}})})),t}(t)),o=function(e){const t=[];if(null==e?void 0:e.collabMap){const i=e.collabMap;Object.keys(i).forEach((e=>{var n;const a={iCalUid:e,value:{resources:((null===(n=i[e].collab)||void 0===n?void 0:n.resources)||[]).filter((e=>f(e.type))).map((e=>Object.assign({id:e.id,type:v(e.type),location:e.location,subType:e.subType},e.metadata)))}};t.push(a)}))}return t}(s);return u.log(`Read group of meeting artifacts for ${o.length} meetings success`),e.stop(),o}catch(t){return(0,d.S3)(u,t,e,"cmd_meetings_collab_object_read_collab_object_batch_request_event","get meetingArtifacts batch request query failed with errorCode"),Promise.reject(t)}}))},reserveMeetingArtifact(e,{externalEntityKey:t,seriesExternalEntityKey:i,organizer:a,user:o,meetingParams:c},{getCollabObjectService:l,scenarioFactory:g,loggerFactory:h,callerApp:v}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:n}=(0,d.aN)(s.RG.ReserveResourceToCollabObject,g),f=(0,d.o9)(t),b=(0,d.o9)(i);e.appendEventData({externalEntityKey:f,seriesExternalEntityKey:b}),m(h),u.log(`Reserve meeting artifact for instance externalEntityKey: ${f}, series externalEntityKey: ${b}`);try{const s=r.ceh.Notes,d=yield l(),u=yield d.reserveResourceToCollabObject(n,function(e,t,i,n,a,s){return{type:e.toLowerCase(),externalEntityKey:t,seriesExternalEntityKey:i,meetingUrl:s.meetingUrl,threadId:s.threadId,messageId:s.messageId,organizerUpn:s.organizerUpn,organizer:n,user:a}}(s,t,i,a,o,c),v);if(null==u?void 0:u.collab){const t=p(s,u);return e.stop(),Object.assign(Object.assign({},u),{collab:{changeKey:null==u?void 0:u.collab.changeKey,resources:t}})}return e.stop(),u}catch(t){return(0,d.S3)(u,t,e,"cmd_meetings_collab_object_reserve_resource_to_collab_object_event","reserveMeetingArtifact query failed with errorCode"),Promise.reject(t)}}))},readAndOptionallyReserveMeetingArtifact(e,{externalEntityKey:t,organizer:i,user:a},{getCollabObjectService:o,scenarioFactory:c,loggerFactory:l,callerApp:g}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:n}=(0,d.aN)(s.RG.ReadAndOptionallyReserveResourceToCollabObject,c),h=(0,d.o9)(t);e.appendEventData({externalEntityKey:h}),m(l),u.log(`Read and Optionally Reserve meeting artifact for instance externalEntityKey: ${h}`);try{const s=r.ceh.Notes,c=yield o(),l=yield c.readAndOptionallyReserveResourceToCollabObject(n,function(e,t,i,n){return{type:e.toLowerCase(),externalEntityKey:t,organizer:i,user:n}}(s,t,i,a),g);if(null==l?void 0:l.collab){const t=p(s,l);return e.stop(),Object.assign(Object.assign({},l),{collab:{changeKey:null==l?void 0:l.collab.changeKey,resources:t}})}return e.stop(),l}catch(t){return(0,d.S3)(u,t,e,"cmd_meetings_collab_object_read_and_optionally_reserve_resource_to_collab_object_event","readAndOptionallyReserveMeetingArtifact query failed with errorCode"),Promise.reject(t)}}))}},Mutation:{addMeetingArtifacts(e,{externalEntityKey:t,seriesExternalEntityKey:i,organizer:a,user:s,meetingParams:o,meetingArtifacts:r},{getCollabObjectService:c,scenarioFactory:l,loggerFactory:d,callerApp:u}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return h(c,l,d,u,t,i,a,s,r,o)}))},commitMeetingArtifact(e,{externalEntityKey:t,seriesExternalEntityKey:i,organizer:a,user:c,secret:u,resourceUri:g,metadata:h},{getCollabObjectService:p,scenarioFactory:v,loggerFactory:f,callerApp:b}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=m(f),{scenario:n,correlationId:y}=(0,d.aN)(s.RG.CommitResourceToCollabObject,v);try{const s=yield p(),m=(0,d.o9)(t),v=(0,d.o9)(i);return e.log(`commit Meeting Artifact to instance externalEntityKey: ${m}, series externalEntityKey: ${v}`),n.appendEventData({externalEntityKey:m,seriesExternalEntityKey:v}),u?(yield s.commitResourceToCollabObject(y,function(e,t,i,n,a,s,o,r){var c;const d=null!==(c=r)&&void 0!==c?c:{};return{type:e.toLowerCase(),externalEntityKey:t,seriesExternalEntityKey:i,organizer:n,user:a,secret:s,resourceUri:o,metadata:(0,l.omitBy)(k(d),l.isEmpty)}}(r.ceh.Notes,t,i,a,c,u,g,h),b),n.stop(),!0):(e.error("commit Meeting Artifact API called without secret"),n.fail({errorCode:o.py.INVALID_SECRET.toString(),message:o.WK.INVALID_SECRET}),!1)}catch(t){return(0,d.S3)(e,t,n,"cmd_meetings_collab_object_commit_resource_to_collab_object_event","commit Meeting Artifact commit mutation failed with errorCode"),Promise.reject(t)}}))},updateMeetingArtifacts(e,{externalEntityKey:t,seriesExternalEntityKey:i,organizer:r,user:l,meetingParams:u,changeKey:g,meetingArtifacts:h},{getCollabObjectService:p,scenarioFactory:v,loggerFactory:f,callerApp:b}){var k;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=m(f),{scenario:n,correlationId:S}=(0,d.aN)(s.RG.UpdateResourcesOnCollabObject,v),w=(0,d.o9)(t),j=(0,d.o9)(i);e.log(`Update meeting artifacts for externalEntityKey: ${w} and seriesExternalEntityKey: ${j}`);try{const s=yield p(),m=null!==(k=h)&&void 0!==k?k:[];if(n.appendEventData({externalEntityKey:w,seriesExternalEntityKey:j,message:(0,d.Uk)(m)}),0===m.length){const t=(0,c.Tr)(a.w5.CmdArtifactsServiceClient,a.jK.InvalidInput,"meetingArtifactsResolver.updateMeetingArtifacts",{[o.zm.internalErrorCode]:o.py.EMPTY_INPUT,[o.zm.logErrorMessage]:o.WK.EMPTY_INPUT},o.WK.EMPTY_INPUT.toString());return(0,d.S3)(e,t,n,"cmd_meetings_collab_object_add_resources_to_collab_object_event","addMeetingArtifactsCalled with an empty array of meeting artifacts"),!1}return yield s.updateResourcesOnCollabObject(S,function(e,t,i,n,a,s,o){return{externalEntityKey:e,seriesExternalEntityKey:t,organizer:i,user:n,meetingUrl:a.meetingUrl,threadId:a.threadId,messageId:a.messageId,organizerUpn:a.organizerUpn,changeKey:s,resources:y(o)}}(t,i,r,l,u,g,m),b),n.stop(),!0}catch(t){return(0,d.S3)(e,t,n,"cmd_meetings_collab_object_update_resource_on_collab_object_event","UpdateMeetingArtifacts mutation failed"),Promise.reject(t)}}))}},MeetingArtifactV2Union:{__resolveType:e=>e.type===r.ceh.Transcript?"MeetingArtifactV2Transcript":e.type===r.ceh.TranscriptV2?"MeetingArtifactV2TranscriptV2":e.type===r.ceh.Recording?"MeetingArtifactV2Recording":e.type===r.ceh.Notes?"MeetingArtifactV2Notes":e.type===r.ceh.MeetingContent?"MeetingArtifactV2MeetingContent":"MeetingArtifactV2Default"}};function h(e,t,i,a,r,c,l,u,g,h){var p;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=m(i),{scenario:v,correlationId:f}=(0,d.aN)(s.RG.AddResourcesToCollabObject,t);v.appendEventData({callerApp:a});try{const t=yield e(),i=(0,d.o9)(r);n.log(`Adding meeting artifacts to externalEntityKey: ${i}`);const s=null!==(p=g)&&void 0!==p?p:[];return v.appendEventData({externalEntityKey:i,message:(0,d.Uk)(s)}),0===s.length?(n.error("addMeetingArtifacts called with and empty array of meeting artifacts"),v.fail({errorCode:o.py.EMPTY_INPUT.toString(),message:o.WK.EMPTY_INPUT}),!1):(yield t.addResourcesToCollabObject(f,function(e,t,i,n,a,s){return{externalEntityKey:e,seriesExternalEntityKey:t,organizer:i,user:n,meetingUrl:a.meetingUrl,threadId:a.threadId,messageId:a.messageId,organizerUpn:a.organizerUpn,resources:y(s)}}(r,c,l,u,h,s),a),v.stop(),!0)}catch(e){return(0,d.S3)(n,e,v,"cmd_meetings_collab_object_add_resources_to_collab_object_event","addMeetingArtifacts mutation failed with errorCode"),Promise.reject(e)}}))}const p=(e,t)=>{var i,n;return null===(n=null===(i=null==t?void 0:t.collab)||void 0===i?void 0:i.resources)||void 0===n?void 0:n.filter((t=>t.type.toLowerCase()===r.ceh[e].toLowerCase())).map((e=>Object.assign(Object.assign({},e),{id:e.id,type:v(e.type),location:e.location,metadata:e.metadata,subType:e.subType})))},v=e=>{for(const t of Object.keys(r.ceh))if(t.toLowerCase()===e.toLowerCase())return r.ceh[t];return e},f=e=>{for(const t of Object.keys(r.ceh))if(t.toLowerCase()===e.toLowerCase())return!0;return!1},b=e=>{var t,i;const n=null!==(t=e.metadata)&&void 0!==t?t:{};return{id:e.id,location:e.location,type:e.type,subType:null!==(i=null==n?void 0:n.appTitle)&&void 0!==i?i:"",metadata:k(n)}},y=e=>e.map(b),k=e=>(e=>{let t={};if(e.state){const i=t;t=Object.assign(Object.assign({},i),{state:e.state})}if(e.isShared){const i=t;t=Object.assign(Object.assign({},i),{isShared:e.isShared})}if(e.linkScope){const i=t;t=Object.assign(Object.assign({},i),{linkScope:e.linkScope})}if(e.hostClient){const i=t;t=Object.assign(Object.assign({},i),{hostClient:e.hostClient})}if(e.appId){const i=t;t=Object.assign(Object.assign({},i),{appId:e.appId})}if(e.appTitle){const i=t;t=Object.assign(Object.assign({},i),{appTitle:e.appTitle})}if(e.fileTitle){const i=t;t=Object.assign(Object.assign({},i),{fileTitle:e.fileTitle})}if(e.imageUrl){const i=t;t=Object.assign(Object.assign({},i),{imageUrl:e.imageUrl})}if(e.userId){const i=t;t=Object.assign(Object.assign({},i),{userId:e.userId})}if(e.shareUrl){const i=t;t=Object.assign(Object.assign({},i),{shareUrl:e.shareUrl})}if(e.fileId){const i=t;t=Object.assign(Object.assign({},i),{fileId:e.fileId})}if(e.fileType){const i=t;t=Object.assign(Object.assign({},i),{fileType:e.fileType})}if(e.baseUrl){const i=t;t=Object.assign(Object.assign({},i),{baseUrl:e.baseUrl})}if(e.objectUrl){const i=t;t=Object.assign(Object.assign({},i),{objectUrl:e.objectUrl})}if(e.meetingContentMetadataObject){const i=t;t=Object.assign(Object.assign({},i),{meetingContentMetadataObject:e.meetingContentMetadataObject})}if(e.thumbnailUrl){const i=t;t=Object.assign(Object.assign({},i),{thumbnailUrl:e.thumbnailUrl})}return t})(e)},748429:(e,t,i)=>{"use strict";i.d(t,{w:()=>o,s:()=>r});var n=i(850402),a=i(37117),s=i(561264);const o={Query:{meetingBotMetaInfo(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{getMeetingBotService:e}=i,t=yield e();return{meetingBotMri:yield t.getBotId(),__typename:"MeetingBotMetaInfo"}}))},meetingBotCalendarEvents(e,{start:t,end:i},a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield a.getMeetingBotService();return(yield e.fetchCalendarEvents(t,i)).filter((e=>!e.isAllDayEvent&&e.isOnlineMeeting)).map((e=>{var t;return{id:e.objectId,start:new Date(e.startTime).toUTCString(),end:new Date(e.endTime).toUTCString(),iCalUID:e.iCalUID,subject:e.subject,objectId:e.objectId,conversationId:null===(t=e.skypeTeamsDataObj)||void 0===t?void 0:t.cid,skypeTeamsMeetingUrl:e.skypeTeamsMeetingUrl,isCancelled:e.isCancelled,isAllDayEvent:e.isAllDayEvent}}))}))},meetingBotChatIdForCalendarEvent(e,{eventId:t},i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield i.getMeetingBotService()).fetchChatIdForCalendarEvent(t)}))}},Mutation:{postMeetingStarted(e,{absentAttendees:t,hasRecordingStarted:i,meetingId:s,isForced:o},r){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield r.getMeetingBotService();if(!o&&e.isMeetingEventSent(s,a.$.MeetingStart))return"absentAttendee checked";if(e.setMeetingEventSent(s,a.$.MeetingStart),t&&t.length>0){const n=yield e.postEventToBot({Scenario:a.$.MeetingStart,MeetingInfo:{HasRecordingStarted:i,AbsentAttendee:t}});return`${null==n?void 0:n.status}`}return"no absent attendees"}))},postGreetingToMeetingBot(e,{input:{meetingId:t,organizerId:i,recordingState:s,hasPresentedDeck:o,hasRecordingStarted:r,hasProactiveAction:c,absentAttendee:l,timeElapedSinceMeetingStartedInMinutes:d,hasNextMeeting:u,endTime:m,isRecurrent:g}},h){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield h.getMeetingBotService();if(e.isMeetingEventSent(t,a.$.InMeetingGreeting)||e.isMeetingEventSent(t,a.$.MeetingStart))return!1;e.setMeetingEventSent(t,a.$.InMeetingGreeting);return!!(yield e.postEventToBot({Scenario:a.$.InMeetingGreeting,MeetingInfo:{MeetingId:t,AbsentAttendee:l,OrganizerId:i,RecordingState:s,HasPresentedFile:o,HasProactiveAction:c,HasRecordingStarted:r,TimeElapedSinceMeetingStartedInMinutes:d,HasNextMeeting:u,EndTime:m,IsRecurrent:g,Subject:"Subject"}}))}))},tryStartMeetingBotPublisher(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{getMeetingBotService:e,loggerFactory:t}=i;t.newLogger("MeetingBot Resolver","data-resolvers-browser-meeting-artifacts").log("tryStartMeetingBotPublisher");const n=yield e();return yield n.startPublisher(),!0}))},sendActionStatus(e,{botAction:t,isActionSucess:i,nextMeetingName:s},o){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield o.getMeetingBotService();return yield e.postEventToBot({Scenario:a.$.InMeetingActionStatusUpdated,MeetingInfo:{InMeetingAction:t,IsActionSucceed:i,NextMeetingName:s}}),!0}))},sendRunningLateForNextMeetingNotification(e,{iCalUID:t,subject:i,objectId:s,conversationId:o},r){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield r.getMeetingBotService();return yield e.postEventToBot({Scenario:a.$.RunningLate,MeetingInfo:{CallId:t,ThreadId:o,Subject:i,MeetingUid:s}}),!0}))},removeCalendarEvent(e,{eventId:t},i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield i.getMeetingBotService();return yield e.removeCalendarEvent(t),"Message sent"}))},sendMeetingBotMessage(e,{text:t,conversationId:i},a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield a.getMeetingBotService()).sendMeetingBotMessage(t,i)}))},sendMeetingObjectId(e,{meetingObjectId:t},i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield i.getMeetingBotService();return yield e.postEventToBot({Scenario:a.$.InMeetingShareFile,MeetingInfo:{MeetingId:t}}),!0}))},reportUsageToMeetingBot(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield i.getMeetingBotService()).reportUsageToMeetingBot()}))},triggerBotAction(e,{conversationId:t,botAction:i,actionId:a},s){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield s.getMeetingBotService(),n=yield e.fetchChatIdForCalendarEvent(t);return s.pubsub.publish("meetingBotActionEvent",{meetingBotActionEvent:{conversationId:n,botAction:i,actionId:a},__typename:"meetingBotActionEvent"}),!0}))},sendMessageToConversation(e,{conversationId:t,message:i,files:a},s){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(a&&!a.length)return!1;const e=yield s.getMeetingBotService();return yield e.sendToConversation(t,i,a),!0}))}}},r={Subscription:{meetingBotActionEvent:{subscribe:(0,s.OF)(((e,t,{pubsub:i})=>i.asyncIterator(["meetingBotActionEvent"])),((e,t)=>t.conversationId===e.meetingBotActionEvent.conversationId))}}}},715953:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserMeetingRoomMeetingRoomFrontOfRoomCallPanelsStateQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingRoomFrontOfRoomCallPanelsState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamsCallId"},value:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"rightPanel"}}]}}]}}]}},331713:(e,t,i)=>{"use strict";i.d(t,{s:()=>c});var n=i(524686),a=i(715953);var s=i(850402);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserMeetingRoomWhiteboardWalkUpStateQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"whiteboardWalkUpState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};var r=i(516909);const c={Query:{meetingRoomFrontOfRoomCallPanelsState:(e,{teamsCallId:t},{cache:i})=>{let s=(0,n.n1)(t);try{const e=i.readQuery({query:a.Z,variables:{teamsCallId:t}}),n=null==e?void 0:e.meetingRoomFrontOfRoomCallPanelsState;s=null!=n?n:s}catch(e){}return s},whiteboardWalkUpState:(e,t,{cache:i,loggerFactory:n})=>{var a;try{const e=i.readQuery({query:o});return null!==(a=null==e?void 0:e.whiteboardWalkUpState)&&void 0!==a?a:r.Y14.Inactive}catch(e){const t=null==n?void 0:n.newLogger("whiteboardWalkUpState","data-resolvers-browser-meeting-room");null==t||t.error("failed to get data")}return r.Y14.Inactive}},Mutation:{setMeetingRoomFrontOfRoomCallPanelsState:(e,{teamsCallId:t,state:i},{cache:s,loggerFactory:o})=>{var r;const c=null==o?void 0:o.newLogger("setMeetingRoomFrontOfRoomCallPanelsState","data-resolvers-browser-meeting-room");let l=(0,n.n1)(t);try{const e=s.readQuery({query:a.Z,variables:{teamsCallId:t}});(null==e?void 0:e.meetingRoomFrontOfRoomCallPanelsState)&&(l=e.meetingRoomFrontOfRoomCallPanelsState)}catch(e){null==c||c.error("No data found in cache for meetingRoomFrontOfRoomCallPanelsState, using default value")}const d={__typename:"MeetingRoomFrontOfRoomCallPanelsState",id:l.id,rightPanel:null!==(r=i.rightPanel)&&void 0!==r?r:null};try{s.writeQuery({query:a.Z,variables:{teamsCallId:t},data:{meetingRoomFrontOfRoomCallPanelsState:d}})}catch(e){null==c||c.error("setMeetingRoomFrontOfRoomCallPanelsState to cache failed.")}return d},updateWhiteboardWalkUpState:(e,{state:t},{cache:i,loggerFactory:n})=>(0,s.__awaiter)(void 0,void 0,void 0,(function*(){const e=null==n?void 0:n.newLogger("updateWhiteboardWalkUpState","data-resolvers-browser-meeting-room");try{i.writeQuery({query:o,data:{whiteboardWalkUpState:t.whiteboardWalkUpState}})}catch(t){null==e||e.error("updateWhiteboardWalkUpState to cache failed.")}return!0}))}}},524686:(e,t,i)=>{"use strict";i.d(t,{n1:()=>a,vq:()=>s});var n=i(850402);const a=e=>({__typename:"MeetingRoomFrontOfRoomCallPanelsState",id:e,rightPanel:null}),s=({entrypointType:e,dataRequestContext:t,callback:i})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{getCallingService:n,loggerFactory:a,cancellationListener:s}=t,r=a.newLogger("invokeCallingApi","data-resolvers-browser-meeting-room"),c=yield n(e);return r.log(`Emitting meeting-room event request via api for endpoint: ${e}`),i(c,o(),s)})),o=()=>({hostRendererId:"",component:"Resolver"})},872494:(e,t,i)=>{"use strict";i.d(t,{k:()=>n});const n="payment-service"},216023:(e,t,i)=>{"use strict";i.d(t,{s:()=>o});var n=i(872494),a=i(923863);let s;const o={Mutation:{updatePaymentDetailsInCache:(e,{eventId:t,paymentDetails:i},{cache:o,loggerFactory:r})=>{var c;(e=>{s||(s=e.newLogger(n.k,"data-resolvers-browser-payment"))})(r);try{const e=(null===(c=o.readQuery({query:a.Z,variables:{eventId:t}}))||void 0===c?void 0:c.paymentDetails)||{},n=Object.assign(Object.assign(Object.assign({},e),i),{__typename:"PaymentDetails"});return o.writeQuery({query:a.Z,variables:{eventId:t},data:{paymentDetails:n}}),Object.assign(Object.assign({},n),{__typename:"PaymentDetails"})}catch(e){throw s.error("Payment client resolver failed to update payment details in cache",e),e}}}}},923863:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"paymentDetails"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"eventId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"paymentDetails"},arguments:[{kind:"Argument",name:{kind:"Name",value:"eventId"},value:{kind:"Variable",name:{kind:"Name",value:"eventId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"eventId"}},{kind:"Field",name:{kind:"Name",value:"paymentProvider"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"product"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"price"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"amount"}},{kind:"Field",name:{kind:"Name",value:"currency"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}}]}}]}}]}}]}}]}}]}},135103:(e,t,i)=>{"use strict";i.d(t,{w:()=>p});var n=i(850402),a=i(178608),s=i(516909),o=i(275742);function r(e,t){return t.isGeneral&&e.memberRole!==s.k_p.Admin&&function(e){return e.teamSettings&&e.teamSettings.generalChannelPosting===s.S1B.OwnersPost}(e)}function c(e,t){return e.isUserMuted?s.Jb0.MutedTeamMember:r(e,t)?s.Jb0.OnlyOwnersCanPost:s.Jb0.None}var l=i(802683);function d(e,t){var i,n;return{id:t.id,channelType:m(t.channelType),isGeneral:t.isGeneral||!1,displayName:t.displayName,disallowedToPostReason:c(e,t),consumptionHorizon:t.consumptionHorizon?Object.assign(Object.assign({},t.consumptionHorizon),{__typename:"ClientConsumptionHorizon"}):null,filesRelativePath:(null===(i=t.defaultFileSettings)||void 0===i?void 0:i.filesRelativePath)||null,memberRole:g(t.memberRole),isModerator:t.isModerator||!1,channelSettings:{__typename:"ChannelSettings",channelPostPermissions:h(null===(n=t.channelSettings)||void 0===n?void 0:n.channelPostPermissions)},sharepointSiteUrl:t.sharepointSiteUrl||null,team:{id:e.id,displayName:e.displayName,groupId:e.teamSiteInformation.groupId,sharepointSiteUrl:e.teamSiteInformation.sharepointSiteUrl||null,pictureETag:e.pictureETag||null,smtpAddress:e.smtpAddress,teamSettings:e.teamSettings,__typename:"ClientTeam"},isArchived:t.isArchived,isDeleted:t.isDeleted,__typename:"ChannelWithTeam"}}function u(e){return(0,o.flatMap)(e,(e=>e.filteredChannels.map(d.bind(void 0,e))))}function m(e){switch(e){case s.xuW.Standard:return s.kK_.Standard;case s.xuW.Private:return s.kK_.Private;case s.xuW.Shared:return s.kK_.Shared;default:return null}}const g=e=>{switch(e){case s.k_p.Admin:return s.k_p.Admin;case s.k_p.Guest:return s.k_p.Guest;case s.k_p.User:return s.k_p.User;case s.k_p.Undefined:default:return s.k_p.Undefined}},h=e=>{switch(e){case s.XIP.Moderators:return s.XIP.Moderators;case s.XIP.EveryoneButGuests:return s.XIP.EveryoneButGuests;case s.XIP.Everyone:default:return s.XIP.Everyone}},p={Query:{channelSearch:(e,{searchQuery:t},i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){let e=yield v(i);if(0===e.length)return{__typename:"ChannelSearchResults",resultsByChannelName:[],resultsByTeamName:[]};e=e.filter((e=>!e.isDeleted)).map((e=>Object.assign(Object.assign({},e),{channels:e.channels.filter((e=>!e.isDeleted))})));const n=new RegExp((0,o.escapeRegExp)(t.toLowerCase())),a=(0,o.cloneDeep)(e).filter((e=>n.test(e.displayName.toLowerCase()))).map((e=>(e.filteredChannels=e.channels,e)));return{__typename:"ChannelSearchResults",resultsByChannelName:u(e.map((e=>(e.filteredChannels=e.channels.filter((e=>n.test(e.displayName.toLowerCase()))),e)))),resultsByTeamName:u(a)}})),channel:(e,{channelId:t},i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const e=yield v(i);let n;return(0,o.forEach)(e,(e=>{const i=(0,o.find)(e.channels,{id:t});return!i||(n=d(e,i),!1)})),n}))}};function v(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,cache:i,coreSettings:n,localStorage:s,loggerFactory:o,scenarioFactory:r}=e;let c;try{({teams:c}=i.readQuery({query:a.TK}))}catch(e){o.newLogger("ClientResolvers","data-resolvers-browser-teams").warn("Cache error, returning empty data instead");const d=t&&(yield(0,l.Qp)(t,n,s,r));if(d){const e=d.map(l.uX);i.writeQuery({query:a.TK,data:{teams:e}})}c=d||[]}return c}))}},178608:(e,t,i)=>{"use strict";i.d(t,{TK:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"teamsList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teams"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"isDeleted"}},{kind:"Field",name:{kind:"Name",value:"isUserMuted"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"smtpAddress"}},{kind:"Field",name:{kind:"Name",value:"pictureETag"}},{kind:"Field",name:{kind:"Name",value:"teamSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"generalChannelPosting"}}]}},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"teamType"}},{kind:"Field",name:{kind:"Name",value:"channels"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"channelType"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"isDeleted"}},{kind:"Field",name:{kind:"Name",value:"isArchived"}},{kind:"Field",name:{kind:"Name",value:"isGeneral"}},{kind:"Field",name:{kind:"Name",value:"isShown"}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}}]}},{kind:"Field",name:{kind:"Name",value:"defaultFileSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesRelativePath"}}]}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"channelSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelPostPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"isModerator"}}]}}]}}]}}]}},802683:(e,t,i)=>{"use strict";i.d(t,{uX:()=>w,Qp:()=>N,xm:()=>A,GC:()=>P});var n=i(850402),a=i(275742),s=i(50805),o=i(738646),r=i(321748),c=i(876661),l=i(760005),d=i(500396),u=i(571096),m=i(765923),g=i(516909);const h=7,p=2,v="conversations",f="skypexspaces",b="Teams:conversation-manager",y="teams-list",k=7;function S(e){var t,i;return Object.assign(Object.assign(Object.assign({__typename:"Channel"},(0,a.defaults)((0,a.pick)(e,["id","channelType","displayName","isArchived","isDeleted","isGeneral","isModerator","isShown","memberRole"]),{channelType:null,isArchived:null,isDeleted:null,isModerator:null,memberRole:null})),{channelSettings:(0,a.defaults)(e.channelSettings,{__typename:"ChannelSettings",channelPostPermissions:null}),defaultFileSettings:{__typename:"DefaultFileSettings",filesRelativePath:(null===(t=e.defaultFileSettings)||void 0===t?void 0:t.filesRelativePath)||null},sharepointSiteUrl:e.sharepointSiteUrl||null}),(null===(i=e.consumptionHorizon)||void 0===i?void 0:i.id)?{consumptionHorizon:{__typename:"ConsumptionHorizon",id:e.consumptionHorizon.id,timeStamp:e.consumptionHorizon.timeStamp||null}}:{consumptionHorizon:null})}function w(e){return Object.assign(Object.assign({__typename:"Team"},(0,a.defaults)((0,a.pick)(e,["id","displayName","isDeleted","isUserMuted","memberRole","smtpAddress","pictureETag","teamType"]),{isUserMuted:null,pictureETag:null,smtpAddress:null,teamType:null})),{teamSettings:{__typename:"TeamSettings",generalChannelPosting:e.teamSettings.generalChannelPosting||null},teamSiteInformation:Object.assign({__typename:"TeamSiteInformation"},(0,a.defaults)((0,a.pick)(e.teamSiteInformation,["groupId","sharepointSiteUrl"]),{groupId:null,sharepointSiteUrl:null})),channels:(e.channels||[]).map(S)})}function j(e){try{return JSON.parse(e)}catch(e){return}}function C(e){if(!e||0===e.length)return;const t=new Map,i=new Map;e.filter((e=>e&&(0,c.HU)(e))).map((e=>t.set(e.id,function(e){var t;const i=e.threadProperties;return Object.assign({id:e.id,displayName:i[l.Q5.SpaceThreadTopic]||"",isDeleted:(0,c.uY)(e),memberRole:I((null===(t=e.memberProperties)||void 0===t?void 0:t.role)||l.nL.None),teamSiteInformation:{groupId:i[l.Q5.GroupId]||"",sharepointSiteUrl:i[l.Q5.SiteUrl]},smtpAddress:i[l.Q5.TeamSmtpAddress],pictureETag:i[l.Q5.PictureETag],isFavorite:(0,c.Dq)(e),channels:[]},function(e){const t=j(e.threadProperties[l.Q5.TeamAdminSettings]);return t?{teamSettings:t.userSettings,teamGuestSettings:t.guestSettings}:{teamSettings:{}}}(e))}(e)))),e.filter((e=>e&&(0,c.J6)(e)&&e.threadProperties)).map((e=>i.set(e.id,{teamId:e.threadProperties[l.Q5.SpaceId],channel:_(e)}))),i.forEach((e=>{const{teamId:i,channel:n}=e,a=i&&t.get(i);a&&(n.team=a,a.channels.push(n))}));const n=Array.from(t.values());return n.length>0?n:void 0}function _(e){const t=e.threadProperties,i=t[l.Q5.SpaceTypes]===d.tG.Private;return{id:e.id,displayName:(i?t[l.Q5.SpaceThreadTopic]:(0,c.T7)(e))||"",description:t[l.Q5.TopicDescription]||"",isDeleted:(0,c.uY)(e),isGeneral:(0,c.HU)(e),channelType:T(t[l.Q5.SpaceTypes]),tabs:[],isShown:(0,c.Dq)(e),isShownByDefault:"true"===t[l.Q5.FavDefault],sharepointSiteUrl:i?t[l.Q5.SiteUrl]:void 0,defaultFileSettings:{filesRelativePath:t[l.Q5.FolderRelativeUrl]},consumptionHorizon:(0,u.CH)(e)}}function T(e){switch(e){case d.tG.Private:return g.xuW.Private;case d.tG.Shared:return g.xuW.Shared;case d.tG.None:default:return g.xuW.Standard}}function I(e){switch(e){case l.nL.Admin:return g.k_p.Admin;case l.nL.Guest:return g.k_p.Guest;case l.nL.User:return g.k_p.User;case l.nL.None:default:return g.k_p.Undefined}}function N(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enableChannelLocalCache:n,channelLocalCacheMaxDays:o,enableChannelIndexedDBCache:r,disableChannelIndexedDBNextCache:c}=t.get(s.J.Search);let l,d=!1;if(r&&(l=yield A(e.profile.objectId,e.profile.tenantId,a,!!c),d=void 0!==l),n&&(function(e,t){const i=M(e),n=new Date(Date.now()),a=new Date((null==i?void 0:i.timestamp)||0);a.setDate(a.getDate()+t),a<n&&e.remove(y)}(i,d?0:o||k),!l)){const e=M(i);l=null==e?void 0:e.teams}return l}))}let E;const F=3e5;let x;const D=(0,m.J)();function A(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return E||(E=function(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const s=i.newScenario(o.RG.GetTeamsChannelsFromIndexedDB),c=a=>(0,n.__awaiter)(this,void 0,void 0,(function*(){try{return yield function(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=function(e,t,i){return i?`${b}:${t}:${e}`:`${f}-${e}`}(e,t,i),s=function(e){return e?p:h}(i);return(0,r.q8)(n,s,v,"",a,!0)}))}(e,t,a,i)}catch(e){return void s.appendEventData({errors:JSON.stringify(e)})}}));let l;if(a||(l=yield c(!0)),l||(l=yield c(!1)),l)try{const e=C(l);return s.stop({message:e?"Successfully fetched.":"Conversations store does not contain any teams or channels."}),e}catch(e){return void s.fail({errors:"Fails to convert conversations to teams."})}else s.fail({errors:"unable to read conversations from indexedbd"})}))}(e,t,i,a),x=D.setTimeout((()=>{E=void 0,D.clearTimeout(x),x=void 0}),F),E)}))}function M(e){const t=e.get(y);if(t)return j(t)}function P(e,t){e.setSafe(y,JSON.stringify({timestamp:Date.now(),teams:t}))}},808998:(e,t,i)=>{"use strict";i.d(t,{k:()=>n});const n="webinar-service"},324823:(e,t,i)=>{"use strict";i.d(t,{C:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"webinarImageQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"webinarId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webinarImage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"webinarId"},value:{kind:"Variable",name:{kind:"Name",value:"webinarId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"}}]}}]}}]}},873029:(e,t,i)=>{"use strict";i.d(t,{HY:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"webinar"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"webinarId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webinar"},arguments:[{kind:"Argument",name:{kind:"Name",value:"webinarId"},value:{kind:"Variable",name:{kind:"Name",value:"webinarId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"allWebinarFiels"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"allWebinarFiels"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Webinar"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"eventDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"accessPolicy"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"isFull"}},{kind:"Field",name:{kind:"Name",value:"privacyProfileStatementLink"}},{kind:"Field",name:{kind:"Name",value:"capacity"}},{kind:"Field",name:{kind:"Name",value:"price"}}]}},{kind:"Field",name:{kind:"Name",value:"speakerBios"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"speakerId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}},{kind:"Field",name:{kind:"Name",value:"questionnaire"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"questionId"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"isRequired"}},{kind:"Field",name:{kind:"Name",value:"isPredefined"}}]}},{kind:"Field",name:{kind:"Name",value:"isUserAlreadyRegistered"}},{kind:"Field",name:{kind:"Name",value:"joinLink"}},{kind:"Field",name:{kind:"Name",value:"participantRole"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"registrationId"}},{kind:"Field",name:{kind:"Name",value:"paymentTransactionId"}}]}}]}.definitions]}},168961:(e,t,i)=>{"use strict";i.d(t,{O:()=>a,a:()=>s});var n=i(873029);const a=(e,t)=>{try{const i=e.readQuery({query:n.HY,variables:{webinarId:t}});if(!i||!i.webinar)throw new Error("Invalid cached webinar data");return i.webinar}catch(e){throw e}},s=(e,t,i,s)=>{try{const s=a(i,e),o=Object.assign(Object.assign({},s),{questionnaire:t.map((e=>{var t,i,n;return Object.assign(Object.assign({},e),{name:null!==(t=e.name)&&void 0!==t?t:null,displayName:null!==(i=e.displayName)&&void 0!==i?i:null,options:null!==(n=e.options)&&void 0!==n?n:null,__typename:"WebinarQuestion"})}))});i.writeQuery({variables:{webinarId:e},query:n.HY,data:{webinar:o}})}catch(e){throw s.error("Webinar resolver fails to update webinar questions in cache."),e}}},107195:(e,t,i)=>{"use strict";i.d(t,{s:()=>l});var n=i(808998),a=i(873029),s=i(324823),o=i(168961);let r;const c=e=>r||(r=e.newLogger(n.k,"data-resolvers-browser-webinar")),l={Mutation:{updateWebinarDetails:(e,{webinarId:t,detailsInput:i},{cache:n,loggerFactory:s})=>{c(s);try{const e=(0,o.O)(n,t),s=Object.assign(Object.assign({},e),{eventDetails:Object.assign(Object.assign(Object.assign({},e.eventDetails),i),{__typename:"WebinarDetails"})});return n.writeQuery({variables:{webinarId:t},query:a.HY,data:{webinar:s}}),{_:!0,__typename:"Webinar"}}catch(e){throw r.error("Webinar resolver fails to update webinar details in cache."),e}},updateWebinarQuestions:(e,{webinarId:t,questionsInput:i},{cache:n,loggerFactory:a})=>(c(a),(0,o.a)(t,i,n,r),{_:!0,__typename:"Webinar"}),updateWebinarSpeakers:(e,{webinarId:t,speakersInput:i},{cache:n,loggerFactory:s})=>{c(s);try{const e=(0,o.O)(n,t),s=Object.assign(Object.assign({},e),{speakerBios:i.map((e=>Object.assign(Object.assign({},e),{__typename:"WebinarSpeakerBio"})))});return n.writeQuery({variables:{webinarId:t},query:a.HY,data:{webinar:s}}),{_:!0,__typename:"Webinar"}}catch(e){throw r.error("Webinar resolver fails to update webinar speakers in cache."),e}},updateWebinarImage:(e,{webinarId:t,webinarImageInput:i},{cache:n,loggerFactory:a})=>{c(a);try{return n.writeQuery({variables:{webinarId:t},query:s.C,data:{webinarImage:{image:i.image,__typename:"WebinarImage"}}}),{_:!0,__typename:"Webinar"}}catch(e){throw r.error("Webinar resolver fails to update webinar image in cache."),e}}}}},366773:(e,t,i)=>{"use strict";i.d(t,{kn:()=>n,JF:()=>a,up:()=>s,rS:()=>o});const n=3,a=3,s=3,o="MicrosoftTeams-EmailPost.eml"},664585:(e,t,i)=>{"use strict";i.d(t,{Mv:()=>o,kO:()=>r,a2:()=>l,LH:()=>d});var n=i(850402),a=i(275742),s=i(205480);function o(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return c(e,t)}))}function r(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return c(e,t,i)}))}function c(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=(0,a.uniqBy)(e,(e=>e)),o=(0,a.chunk)(n.map((e=>e)),t.MAX_PEOPLE_MRI_LIMIT),r=yield Promise.all(o.map((e=>t.getPeopleProfilesByMris(e,i,!0,!1,!0))));let c=[];return r.forEach((e=>{c=c.concat(Array.from(e.values(),(e=>(0,s.ne)(e))))})),c}))}function l(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=(0,a.uniqBy)(e,(e=>e)),o=(0,a.chunk)(n.map((e=>e)),t.MAX_PEOPLE_MRI_LIMIT);return(yield Promise.all(o.map((e=>t.getPeopleProfilesIncludeFederatedByMris(e,!0,!1,i))))).map((e=>Array.from(e.values(),(e=>(0,s.ne)(e))))).reduce(((e,t)=>e.concat(t)),[])}))}function d(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=(0,a.uniqBy)(e,(e=>e)),o=(0,a.chunk)(n.map((e=>e)),t.MAX_PEOPLE_MRI_LIMIT);return(yield Promise.all(o.map((e=>t.getTflConsumerProfilesByMris(e,i||null))))).map((e=>Array.from(e.values(),(e=>(0,s.ne)(e))))).reduce(((e,t)=>e.concat(t)),[])}))}},853644:(e,t,i)=>{"use strict";i.d(t,{F:()=>s});var n=i(850402),a=i(639533);function s(e){let t;const i=()=>t&&t.return&&t.return();return new a.y((a=>{try{e().then((e=>{if(e.next instanceof Function){if(t=e,a.closed)return void i();!function(e,t){var i,a,s,o;(0,n.__awaiter)(this,void 0,void 0,(function*(){const r={[Symbol.asyncIterator]:()=>e};try{try{for(var c,l=!0,d=(0,n.__asyncValues)(r);c=yield d.next(),!(i=c.done);){o=c.value,l=!1;try{const e=o;t.next(e)}finally{l=!0}}}catch(e){a={error:e}}finally{try{l||i||!(s=d.return)||(yield s.call(d))}finally{if(a)throw a.error}}t.complete()}catch(e){t.error(e)}}))}(e,a)}else a.next(e),a.complete()}),a.error.bind(a))}catch(e){a.error(e)}return i}))}},804654:(e,t,i)=>{"use strict";i.d(t,{g:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversConnectedCalendarShowHardDeleteSurfaceDialogQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldShowHardDeleteConnectedCalendarSurfaceDialog"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},69585:(e,t,i)=>{"use strict";i.d(t,{s:()=>s});var n=i(850402),a=i(804654);const s={Mutation:{setShouldShowHardDeleteConnectedCalendarSurfaceDialog:(e,{showDialog:t},{cache:i,loggerFactory:s})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{i.writeQuery({query:a.g,data:{shouldShowHardDeleteConnectedCalendarSurfaceDialog:t}})}catch(e){s.newLogger("setShouldShowHardDeleteConnectedCalendarSurfaceDialogMutation","data-resolvers-connected-calendar").error("Failed to write to client cache the show hard-delete connected calendar surface dialog mutation")}return t}))}}},735194:(e,t,i)=>{"use strict";i.d(t,{y:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"localizationSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"localizationSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentLocale"}}]}}]}}]}},593196:(e,t,i)=>{"use strict";i.d(t,{s:()=>r});var n=i(850402),a=i(735194),s=i(446652),o=i(899517);const r={Query:{localizationSettings(e,t,{hostCommunicationService:i,platformService:a,routingServices:r,i18n:c}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield d(r.state.getSearchState()||{});if(e)return{currentLocale:e};if(localStorage.getItem("localeCode"))return{currentLocale:localStorage.getItem("localeCode")};if(a.config.clientType===s.Bh.Web)return{currentLocale:c.locale};let t;try{const e=yield l(i);e?(t=(0,o.vw)(e).locale,yield c.setLocale(t)):t=c.locale}catch(e){t=c.locale}return{currentLocale:t}}))}},Mutation:{updateCurrentLocale(e,{newLocale:t},{cache:i,hostCommunicationService:o,loggerFactory:r,platformService:l,i18n:d}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const e={localizationSettings:{__typename:"LocalizationSettings",currentLocale:t}};return yield d.setLocale(t),localStorage.setItem("localeCode",t),i.writeQuery({query:a.y,data:e}),l.config.clientType!==s.Bh.Web&&(yield c(r,o,t)),{currentLocale:t}}catch(e){return{currentLocale:d.locale}}}))}}},c=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n;const a=e.newLogger("LocalizationSettingsResolvers","data-resolvers-localization-settings");try{const e=yield t.loadModule("osutils");(yield null===(n=null==e?void 0:e.setAppLocale)||void 0===n?void 0:n.call(e,{localeName:i}))||a.warn("hostingCommunicationService language set has failed")}catch(e){a.warn("hostingCommunicationService failed to load")}})),l=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var t;const i=yield e.loadModule("osutils"),n=yield null===(t=null==i?void 0:i.getAppLocale)||void 0===t?void 0:t.call(i);return null==n?void 0:n.localeName})),d=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(e.localeCode)return e.localeCode;if(e.language)return e.language.toLowerCase();if(!e.setting)return;const t=e.setting;let i;if(Array.isArray(t)){for(const e of t)if(e.startsWith("localeCode:")){i=e;break}}else t.startsWith("localeCode:")&&(i=t);return i?i.split(":")[1]:void 0}))},668096:(e,t,i)=>{"use strict";var n,a,s;i.d(t,{$p:()=>n,fg:()=>a,YQ:()=>s}),function(e){e.InviteJoined="InviteJoined",e.TeamsTasks="TeamsTasks",e.GroupMessage="GroupMessage",e.Message="Message",e.Follow="Follow",e.Reply="Reply",e.PersonalReply="PersonalReply",e.ReplyToReply="ReplyToReply"}(n||(n={})),function(e){e.joinInvite="joinInvite",e.teamsTasks="teamsTasks",e.communityFollow="communityFollow",e.communityReplyToReply="communityReplyToReply",e.communityReply="communityReply"}(a||(a={})),function(e){e.inviteeJoined="inviteeJoined",e.tFLPlanCreated="tFLPlanCreated",e.communityNewMessage="communityNewMessage",e.communityReplyMessage="communityReplyMessage"}(s||(s={}))},219418:(e,t,i)=>{"use strict";var n;i.d(t,{yH:()=>n,zc:()=>a,bJ:()=>s,uw:()=>o,V6:()=>r}),function(e){e.Chat="chat",e.Channel="channel",e.SyntheticNotification="syntheticNotification",e.Communities="communities",e.GraphItemToast="graphItemToast"}(n||(n={}));var a;!function(e){e.FILE="file",e.IMAGE="image",e.VOICE="voice",e.LOCATION="location",e.TEXT="text",e.VIDEO="video"}(a||(a={}));const s="giphy.com",o="emojione",r="bfb101ece45946be988be560a74322f2"},38641:(e,t,i)=>{"use strict";var n=i(850402);var a,s=i(824303),o=i(644049),r=i(337625),c=i(860638),l=i(433728),d=i(457333),u=i(701129),m=i(555462),g=i(135671),h=i(132756),p=i(660378);!function(e){e.DiagnosticsLogsMain="diagnostics-event-logs-main",e.DiagnosticsLogsWorker="diagnostics-event-logs-worker"}(a||(a={}));var v,f,b,y,k=i(955105),S=i(50805);!function(e){e.Cold="Cold",e.Warm="Warm",e.Rollback="Rollback",e.Update="Update",e.Local="Local",e.Container="Container",e.Unknown="Unknown"}(v||(v={})),function(e){e.SessionID="tmp.sessionId",e.DeviceID="tmp.deviceId",e.IsRelaunchFromOOPs="tmp.relaunchFromOOPs",e.PreAuthUserID="tmp.preAuthUserId",e.T2WebOptInSessionId="tmp.t2WebOptInSessionId",e.AttemptedWebBootCount="tmp.numT2WebBootAttempts"}(f||(f={})),function(e){e.IndexPageStart="execute-index-html-script",e.CoreModuleLoaded="exp_loader_core_module_loaded",e.NotifyDesktop="exp_loader_notified_desktop",e.ConfigLoaded="exp_loader_config_loaded",e.MainChunksLoadingStart="exp_loader_load_bundles_start",e.MainChunksLoadingStop="exp_loader_load_bundles_stop",e.IndexPageStop="exp_loader_index_stop",e.ClientStartStop="client_start_stop"}(b||(b={})),function(e){e.ExpLoaderFailure="ExpLoaderFailure",e.LoadBundlesFailure="LoadBundlesFailure",e.ParseIndexPageFailure="ParseIndexPageFailure",e.CoreStartTimeout="CoreStartTimeout"}(y||(y={}));var w=i(125386);const j="core_life_cycle_start_",C="core_task_end_",_="core_init_complete";var T,I=i(749531),N=i(486070),E=i(646388);!function(e){e.DIAGNOSTICSSERVICE="DiagnosticsService"}(T||(T={}));const F=e=>{let t;const i=[];return{newScenario:n=>{if(t)return t.newScenario(n);if(e&&i.length<20){const e=A(n,i);return i.push(e),e}},setScenarioFactory:e=>{t=e,x(i,t)}}},x=(e,t)=>{if(e.length>0)for(let i=e.length-1;i>=0;i--)D(e[i],t)&&e.splice(i,1)},D=(e,t,i)=>{var n;if(e.status){const n=t.newScenario(e.name,{startTime:e.time});if("failed"===e.status&&n.fail(Object.assign({cached:!0,overrideTimestamp:e.endtime},e.result)),"stopped"===e.status&&n.stop(Object.assign({cached:!0,overrideTimestamp:e.endtime},e.result)),i){const t=i.indexOf(e);t>=0&&i.splice(t,1)}return!0}return null===(n=e.setFactory)||void 0===n||n.call(e,t),!1},A=(e,t)=>{let i,n,a,s;const o={name:e,time:Date.now(),fail:e=>{n="failed",a=Date.now(),i=e,s&&D(o,s,t)},stop:e=>{n="stopped",a=Date.now(),i=e,s&&D(o,s,t)},get result(){return i},get status(){return n},get endtime(){return a},setFactory:e=>s=e};return o};var M=i(26618);class P{constructor(){this.eventsBufferArray=[],this.scheduledBufferArray=[],this.isForErrorLogs=!1,this.ALTCompleted=!1}addEvents(e,t=!1){e&&e.length>0&&e.forEach((e=>{this.addEvent(e,t)}))}getBufferedEvents(){return this.eventsBufferArray.concat(this.scheduledBufferArray).sort(((e,t)=>{const i="function"==typeof e.timeStamp.getTime?e.timeStamp:new Date(e.timeStamp),n="function"==typeof t.timeStamp.getTime?t.timeStamp:new Date(t.timeStamp);return i.getTime()-n.getTime()}))}setALTDone(){this.ALTCompleted=!0}fetchPersistedLogsFromLastSession(){var e;if(null===(e=this.host)||void 0===e?void 0:e.localStorage){const e=(0,M.yN)(this.userId,this.isForErrorLogs);try{(0,M.UL)(this,this.host.localStorage,e,!0)}catch(t){this.host.localStorage.removeItem(e);const i=`DiagnosticsService: Failed to load persisted logs from store with error: ${t}`;this.addEvent({message:i,isPiiFree:!0,level:E.i.Error,levelName:"error",timeStamp:new Date})}}}shiftBufferArray(){return 0===this.scheduledBufferArray.length?this.eventsBufferArray.shift():0===this.eventsBufferArray.length||this.scheduledBufferArray[0].timeStamp<this.eventsBufferArray[0].timeStamp?this.scheduledBufferArray.shift():this.eventsBufferArray.shift()}addIntoBufferArray(e,t){t?this.scheduledBufferArray.push(e):this.eventsBufferArray.push(e)}get bufferArraySize(){return this.eventsBufferArray.length+this.scheduledBufferArray.length}}class O extends P{constructor(e=!1,t,i,n){super(),this.isForErrorLogs=e,this.sessionId=t,this.host=i,this.maxCapacity=n,this.queueCapacity=this.maxCapacity||O.DEFAULT_QUEUE_CAPACITY}setCapacity(e){const t=e.bufferSize||0;t<1||this.queueCapacity===t||(this.queueCapacity=t,this.bufferArraySize>t&&(this.scheduledBufferArray.length>=t?(this.eventsBufferArray=[],this.scheduledBufferArray=this.scheduledBufferArray.slice(this.scheduledBufferArray.length-t)):this.eventsBufferArray=this.eventsBufferArray.slice(this.bufferArraySize-t)))}addEvent(e,t=!1){this.bufferArraySize<this.queueCapacity||this.shiftBufferArray(),this.addIntoBufferArray(e,t)}getAllEvents(e){return 0===e?Promise.resolve([]):e&&e<=this.bufferArraySize?Promise.resolve(this.getBufferedEvents().slice(this.bufferArraySize-e)):Promise.resolve(this.getBufferedEvents())}setScenarioFactory(e){}handleUserLogout(){var e;const t=(0,M.yN)(this.userId);return null===(e=this.host)||void 0===e||e.localStorage.removeItem(t),Promise.resolve()}setDBInfo(e,t,i){this.tId||(this.tId=e),this.oId||(this.oId=t),this.userId||(this.userId=i,this.fetchPersistedLogsFromLastSession())}persistLogs(){var e;if(this.eventsBufferArray.length>0&&(null===(e=this.host)||void 0===e?void 0:e.localStorage)){const e=(0,M.yN)(this.userId,this.isForErrorLogs);(0,M.RA)(this,this.host.localStorage,e,this.sessionId)}}}O.DEFAULT_QUEUE_CAPACITY=1e3;var R=i(765923),L=i(656690),U=i(89062);class ${constructor(e,t,i,n){this.opener=e,this.setTimeout=t,this.clearTimeout=i,this.diagnosticsEventsBuffer=[],this.flush=()=>{if(this.diagnosticsEventsBuffer.length>0)try{this.opener.postMessage(L.rY.ActivityEvent,{action:"er:rendererDiagnosticsEvents",data:[...this.diagnosticsEventsBuffer]})}catch(e){console.error("DiagnosticsBackupService failed to send a message")}this.reset()},this.backupTimeoutMs=n&&n>0?n:$.DefaultBackupTimeoutMs,this.reset()}pushDiagnosticsEvent(e){e&&(this.diagnosticsEventsBuffer.push(this.stringifyEvent(e)),this.diagnosticsEventsBuffer.length===$.BufferCapacity&&this.flush(),!this.backupTimer&&this.diagnosticsEventsBuffer.length>0&&this.startTimer())}dispose(){this.flush()}reset(){this.diagnosticsEventsBuffer.length=0,this.stopTimer()}stopTimer(){this.backupTimer&&(this.clearTimeout(this.backupTimer),this.backupTimer=void 0)}startTimer(){this.backupTimer=this.setTimeout(this.flush,this.backupTimeoutMs)}stringifyEvent(e){return(0,U.Uw)("{0} {1}\t{2}\r\n",[e.timeStamp,e.levelName.slice(0,3),e.message])}}$.BufferCapacity=50,$.DefaultBackupTimeoutMs=100;var W,B=i(275742),z=i(738646);!function(e){e[e.ecsSetting=0]="ecsSetting",e[e.clientPreference=1]="clientPreference",e[e.error=2]="error",e[e.beforeDeletingDB=3]="beforeDeletingDB"}(W||(W={}));var H=i(575644);const q=(e,t)=>{const i="function"==typeof e.timeStamp.getTime?e.timeStamp:new Date(e.timeStamp),n="function"==typeof t.timeStamp.getTime?t.timeStamp:new Date(t.timeStamp);return i.getTime()-n.getTime()};class V extends P{constructor(e,t,i,n){super(),this.host=e,this.experienceName=t,this.databaseName=i,this.sessionId=n,this.indexedDBVersion=1,this.storeName="LogsStore",this.timeIndexName="timeIdx",this.currentIDBItemIndex=-1,this.IDBManagementArray=[],this.IDBErrorCount=0,this.allowedIDBErrorCount=10,this.defaultAllowedBufferLength=2e3,this.defaultCountOfIDBObjects=10,this.defaultWorkerAllowedBufferLength=1e3,this.defaultWorkerMaxCountOfIndexDBObject=10,this.minBufferLength=1e3,this.maxBufferLength=5e3,this.minWorkerBufferLength=500,this.maxWorkerBufferLength=3e3,this.minCountOfIDBObjects=10,this.maxCountofIDBObjects=1e3,this.minWorkerCountOfIDBObjects=10,this.maxWorkerCountofIDBObjects=1e3,this.timeThrottlingInterval=6e4,this.lastPersistTimestamp=0,this.skippedEventsCount=0,this.disableIDBLogs=!1,this.ecsEnableIDBLogs=!1,this.isUserEnableIDBLogs=!1,this.fetchFromIDBTimeLimit=18e3,this.minFetchFromIDBTimeLimit=5e3,this.databaseName===a.DiagnosticsLogsWorker?(this.allowedCountOfIndexDBObject=this.defaultWorkerMaxCountOfIndexDBObject,this.allowedBufferLength=this.defaultWorkerAllowedBufferLength):(this.allowedCountOfIndexDBObject=this.defaultCountOfIDBObjects,this.allowedBufferLength=this.defaultAllowedBufferLength),this.scenarioFactory=F(!0)}setDBInfo(e,t,i){this.getDBName()||(this.tId=e,this.oId=t,this.userId=i,this.openIndexedDB(),this.fetchPersistedLogsFromLastSession())}setCapacity(e){if(void 0!==e.throttleTime&&e.throttleTime>=0&&(this.timeThrottlingInterval=1e3*e.throttleTime),e.bufferSize){const t=this.databaseName===a.DiagnosticsLogsMain?this.minBufferLength:this.minWorkerBufferLength,i=this.databaseName===a.DiagnosticsLogsMain?this.maxBufferLength:this.maxWorkerBufferLength;e.bufferSize>=t&&e.bufferSize<=i&&(this.allowedBufferLength=e.bufferSize)}const t=this.allowPersistIntoIDB;if(e.enableIndexedDB?this.ecsEnableIDBLogs=!0:!1===e.enableIndexedDB&&this.disablePersistIntoIDB(W.ecsSetting),e.clientEnableExtendedLogs?this.isUserEnableIDBLogs=!0:!1===e.clientEnableExtendedLogs&&this.disablePersistIntoIDB(W.clientPreference),e.IDBFetchingTimeoutMs&&e.IDBFetchingTimeoutMs>this.minFetchFromIDBTimeLimit&&(this.fetchFromIDBTimeLimit=e.IDBFetchingTimeoutMs),e.IDBObjectCount){const i=this.databaseName===a.DiagnosticsLogsMain?this.minCountOfIDBObjects:this.minWorkerCountOfIDBObjects,n=this.databaseName===a.DiagnosticsLogsMain?this.maxCountofIDBObjects:this.maxWorkerCountofIDBObjects;if(e.IDBObjectCount>=i&&e.IDBObjectCount<=n){if(t&&this.allowPersistIntoIDB&&this.IDBManagementArray.length>e.IDBObjectCount){const t=this.getToBeDeletedIDs(e.IDBObjectCount);this.deleteIDBItems(t)}this.allowedCountOfIndexDBObject=e.IDBObjectCount}}!t&&this.allowPersistIntoIDB&&this.openIndexedDB()}addEvent(e,t=!1){if(this.addIntoBufferArray(e,t),this.bufferArraySize>=this.allowedBufferLength)if(this.allowPersistIntoIDB&&this.db)if(this.shouldBeThrottled()){const e=this.shiftBufferArray();this.skippedEventsCount++,void 0===this.firstSkippedEventTime&&(this.firstSkippedEventTime=null==e?void 0:e.timeStamp),this.lastSkippedEventTime=null==e?void 0:e.timeStamp}else this.flushBufferIntoIndexedDB(!0);else this.allowPersistIntoIDB&&!this.ALTCompleted&&this.skippedEventsCount++,this.shiftBufferArray()}getAllEvents(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.db||e&&this.bufferArraySize>=e)return e&&this.bufferArraySize>e?Promise.resolve(this.getBufferedEvents().slice(this.bufferArraySize-e)):Promise.resolve(this.getBufferedEvents());{const t=this.getIDBStore(this.db,this.storeName,"readonly");if(t)try{const i=yield(0,H.E)(this.getAllEventsFromIDB(t,e),this.fetchFromIDBTimeLimit);return Promise.resolve(i)}catch(e){const t=this.getBufferedEvents();return t.push({message:`DiagnosticsService - fetching logs form IDB timedout with limit of ${this.timeIndexName} ms`,isPiiFree:!0,level:E.i.Error,levelName:"error",timeStamp:new Date}),Promise.resolve(t)}}return Promise.resolve(this.getBufferedEvents())}))}handleUserLogout(){const e=(0,M.yN)(this.userId);return this.host.localStorage.removeItem(e),this.allowPersistIntoIDB&&this.db?this.createDeleteUserDBPromise():Promise.resolve()}setScenarioFactory(e){this.scenarioFactory.setScenarioFactory(e)}setALTDone(){this.ALTCompleted||(this.skippedEventsCount>0&&this.addEvent({message:`DiagnosticsService - ${this.skippedEventsCount} logs skipped before client_start complete`,isPiiFree:!0,level:E.i.Info,levelName:"info",timeStamp:new Date}),this.ALTCompleted=!0,this.openIndexedDB())}persistLogs(){var e;if(this.bufferArraySize>0)if(this.allowPersistIntoIDB&&this.db)this.flushBufferIntoIndexedDB(!1);else if(null===(e=this.host)||void 0===e?void 0:e.localStorage){const e=(0,M.yN)(this.userId);(0,M.RA)(this,this.host.localStorage,e,this.sessionId)}}parseMaglevEventsFromIDB(e,t){let i="",n=[];return e.forEach((e=>{e.sessionId!==i&&""!==i&&this.addAnSeperateLogItem(n,i),i=e.sessionId,n=n.concat(e.logsArray)})),""!==i&&i!==this.sessionId&&this.addAnSeperateLogItem(n,i),n=n.concat(this.getBufferedEvents()),n.sort(q),t&&n.length>t&&(n=n.slice(n.length-t)),n}parseNonMaglevEventsFromIDB(e,t){const i=new Map;e.forEach((e=>{if(e.logsArray&&e.logsArray.length>0){const t=i.get(e.sessionId)||[];i.set(e.sessionId,t.concat(e.logsArray))}}));let n=i.get(this.sessionId);if(n?(n=n.concat(this.getBufferedEvents()),i.delete(this.sessionId)):n=this.getBufferedEvents(),i.forEach(((e,t)=>{e.sort(q),this.addAnSeperateLogItem(e,t)})),n.sort(q),t&&n.length>=t)return n.slice(n.length-t);let a=Array.from(i.values()).sort(((e,t)=>{const i="function"==typeof e[e.length-1].timeStamp.getTime?e[e.length-1].timeStamp:new Date(e[e.length-1].timeStamp),n="function"==typeof t[t.length-1].timeStamp?t[t.length-1].timeStamp:new Date(t[t.length-1].timeStamp);return i.getTime()-n.getTime()})).flat().concat(n);return t&&a.length>t&&(a=a.slice(a.length-t)),a}createDeleteUserDBPromise(){var e;const t=(null===(e=this.host)||void 0===e?void 0:e.indexedDB)||globalThis.indexedDB;if(t&&this.db){const e=this.getDBName();if(e)return this.disablePersistIntoIDB(W.beforeDeletingDB,"Deleting user IDB"),this.db.close(),new Promise((i=>{const n=this.scenarioFactory.newScenario(z.RG.DiagnosticsDeleteIDB),a=t.deleteDatabase(e);a.onblocked=()=>{this.addEvent({message:"DiagnosticsService - Deleting user diagnostics logs IDB blocked",isPiiFree:!0,level:E.i.Error,levelName:"error",timeStamp:new Date}),null==n||n.fail({reason:`Deleting DB blocked for ${a.error}`}),i()},a.onsuccess=()=>{null==n||n.stop(),i()},a.onerror=()=>{this.addEvent({message:"DiagnosticsService - Deleting user diagnostics logs IDB error",isPiiFree:!0,level:E.i.Error,levelName:"error",timeStamp:new Date}),null==n||n.fail({reason:`Deleting DB failed for ${a.error}`}),this.increaseIDBErrorCount(),i()}}))}return Promise.resolve()}flushBufferIntoIndexedDB(e){if(this.bufferArraySize>0){const t=this.getBufferedEvents();this.eventsBufferArray=[],this.scheduledBufferArray=[];const i=this.skippedEventsCount;this.updateThrottleInfo(t);const n=this.scenarioFactory.newScenario(z.RG.DiagnosticsSaveIDBItemMain);this.persistBufferIntoDB(this.getNextManagementItem(),t,!1,void 0,void 0,e),null==n||n.stop({skippedCount:i})}}updateThrottleInfo(e){var t;this.skippedEventsCount>0&&this.lastSkippedEventTime&&(e.unshift({message:`DiagnosticsService - skipped ${this.skippedEventsCount} event logs between ${null===(t=this.firstSkippedEventTime)||void 0===t?void 0:t.toISOString()} and ${this.lastSkippedEventTime.toISOString()} for logs throttle`,level:E.i.Info,levelName:"Info",isPiiFree:!0,timeStamp:this.lastSkippedEventTime}),this.skippedEventsCount=0,this.lastSkippedEventTime=void 0,this.firstSkippedEventTime=void 0),this.lastPersistTimestamp=Date.now()}openIndexedDB(){var e;if(this.allowPersistIntoIDB&&!this.db&&this.ALTCompleted){const t=(null===(e=this.host)||void 0===e?void 0:e.indexedDB)||globalThis.indexedDB;if(!t)return;const i=this.getDBName();if(i){const e=this.scenarioFactory.newScenario(z.RG.DiagnosticsOpenIDB),n=t.open(i,this.indexedDBVersion);n.onerror=()=>{this.addEvent({message:"DiagnosticsService - Open IndexedDB failed",isPiiFree:!0,level:E.i.Error,levelName:"error",timeStamp:new Date}),null==e||e.fail({reason:n.error}),this.increaseIDBErrorCount()},n.onupgradeneeded=()=>{this.createDataStores(n.result)},n.onsuccess=()=>{this.initializeManagementArray(n.result),null==e||e.stop()}}}}createDataStores(e){const t=this.scenarioFactory.newScenario(z.RG.DiagnosticsCreateIDBStore);try{e.createObjectStore(this.storeName,{autoIncrement:!0}).createIndex(this.timeIndexName,"timeStamp",{unique:!0}),null==t||t.stop()}catch(e){null==t||t.fail({reason:e}),this.addEvent({message:"DiagnosticService - Create objectStore failed",isPiiFree:!0,level:E.i.Error,levelName:"error",timeStamp:new Date})}}getDBName(){return this.tId&&this.oId&&this.experienceName&&this.sessionId?`Teams:${this.databaseName}:${this.experienceName}:${this.tId}:${this.oId}`:""}getIDBStore(e,t,i){if(e)try{const n=e.transaction(t,i);return null==n?void 0:n.objectStore(t)}catch(e){this.disablePersistIntoIDB(W.error,"getIDBStore failed")}}persistBufferIntoDB(e,t,i=!1,n,a,s=!1){if(0===t.length)return;if(e.isUpdating&&!i)return void this.disablePersistIntoIDB(W.error,"All diagnostics log indexedDB items are pending update");const o=this.getIDBStore(this.db,this.storeName,"readwrite");if(o){i||(e.isUpdating=!0,e.timeStamp=a||Date.now());const r={logsArray:t,sessionId:n||this.sessionId||"",timeStamp:e.timeStamp};let c,l;e.IDBId>0?(l=this.scenarioFactory.newScenario(z.RG.DiagnosticsUpdateIDBItem),c=o.put(r,e.IDBId)):(l=this.scenarioFactory.newScenario(z.RG.DiagnosticsAddLogsIntoIDB),c=o.add(r)),c.onsuccess=()=>{null==l||l.stop({context:this.userId,message:this.timeThrottleEnabled()?"throttle_enabled":"throttle_not_enabled",reason:s?"regular":"forced"}),t.length=0,this.isMaglev?(e.isUpdating=!1,e.IDBId=c.result):this.checkIDBItemCount()},c.onerror=()=>{null==l||l.fail({reason:`${s?"regular":"forced"} - error: ${c.error}`,retryCount:i?1:0,context:this.userId,message:this.timeThrottleEnabled()?"throttle_enabled":"throttle_not_enabled"}),i?(this.addEvent({message:`DiagnosticService - Failed adding event buffer into IDB after retry, lost ${t.length} events`,isPiiFree:!0,level:E.i.Error,levelName:"error",timeStamp:new Date}),t.length=0,e.isUpdating=!1,this.increaseIDBErrorCount()):(this.addEvent({message:"DiagnosticService - Failed adding event buffer into IDB, start retry",isPiiFree:!0,level:E.i.Error,levelName:"error",timeStamp:new Date}),this.persistBufferIntoDB(e,t,!0,n,a,s))}}}deleteIDBItems(e){if(e.length>0){const t=this.getIDBStore(this.db,this.storeName,"readwrite");t&&e.forEach((e=>{const i=this.scenarioFactory.newScenario(z.RG.DiagnosticsDeleteLogsInIDB),n=t.delete(e);n.onsuccess=()=>{null==i||i.stop()},n.onerror=()=>{null==i||i.fail({reason:n.error}),this.increaseIDBErrorCount()}}))}}clearDBStore(){const e=this.getIDBStore(this.db,this.storeName,"readwrite");if(e){const t=this.scenarioFactory.newScenario(z.RG.DiagnosticsClearIDBStore),i=e.clear();i.onsuccess=()=>{this.IDBManagementArray=[],this.currentIDBItemIndex=-1,null==t||t.stop()},i.onerror=()=>{null==t||t.fail({reason:i.error}),this.addEvent({message:"DiagnosticsService - Clear IDB store failed",isPiiFree:!0,level:E.i.Error,levelName:"error",timeStamp:new Date}),this.increaseIDBErrorCount()}}}getToBeDeletedIDs(e){const t=[];if(this.db&&e<this.IDBManagementArray.length){const i=this.IDBManagementArray.length-e;for(let e=0;e<i;e++){let e=0;this.currentIDBItemIndex<this.IDBManagementArray.length-1&&(e=this.currentIDBItemIndex+1);const i=this.IDBManagementArray[e];t.push(i.IDBId),this.IDBManagementArray.splice(e,1),0===e&&this.currentIDBItemIndex--}}return t}getNextManagementItem(){return this.isMaglev?(this.currentIDBItemIndex===this.IDBManagementArray.length-1?this.IDBManagementArray.length<this.allowedCountOfIndexDBObject?(this.addNewManagementItem(),this.currentIDBItemIndex++):this.currentIDBItemIndex=0:this.currentIDBItemIndex++,this.IDBManagementArray[this.currentIDBItemIndex]):{IDBId:0,timeStamp:0,isUpdating:!1}}initializeManagementArray(e){if(this.allowPersistIntoIDB&&e&&!this.db)if(this.isMaglev){const t=this.getIDBStore(e,this.storeName,"readwrite");if(t){const i=t.index(this.timeIndexName);if(i){const t=this.scenarioFactory.newScenario(z.RG.DiagnosticsGetAllKeysFromIDB),n=i.getAllKeys();n.onsuccess=()=>{null==t||t.stop(),this.db=e,this.IDBManagementArray=[],n.result.forEach((e=>this.addNewManagementItem(e))),this.currentIDBItemIndex=this.IDBManagementArray.length-1,this.fetchAndPersistPreviuosSessionLogs()},n.onerror=()=>{null==t||t.fail({reason:n.error}),this.increaseIDBErrorCount()}}}}else this.db=e,this.fetchAndPersistPreviuosSessionLogs()}addNewManagementItem(e=0){this.IDBManagementArray.push({timeStamp:0,isUpdating:!1,IDBId:e})}disablePersistIntoIDB(e,t){var i;const n=this.allowPersistIntoIDB;switch(e){case W.ecsSetting:if(!this.ecsEnableIDBLogs)return;this.ecsEnableIDBLogs=!1;break;case W.clientPreference:if(!this.isUserEnableIDBLogs)return;this.isUserEnableIDBLogs=!1;break;case W.error:case W.beforeDeletingDB:if(this.disableIDBLogs)return;this.disableIDBLogs=!0}const a=`DiagnosticService - writing logs into IDB settings changed for ${W[e]}`;this.addEvent({message:a,isPiiFree:!0,level:e===W.error?E.i.Error:E.i.Info,levelName:e===W.error?"error":"info",timeStamp:new Date}),n&&!this.allowPersistIntoIDB&&(e===W.error?null===(i=this.scenarioFactory.newScenario(z.RG.DiagnosticsDisableIDB))||void 0===i||i.stop({errorReason:t}):e!==W.beforeDeletingDB&&this.clearDBStore())}increaseIDBErrorCount(){this.IDBErrorCount<this.allowedIDBErrorCount&&(this.IDBErrorCount++,this.IDBErrorCount===this.allowedIDBErrorCount&&this.disablePersistIntoIDB(W.error,"Allowed IDB error count reached"))}shouldBeThrottled(){return!!this.timeThrottleEnabled()&&Date.now()-this.lastPersistTimestamp<this.timeThrottlingInterval}timeThrottleEnabled(){return!this.isUserEnableIDBLogs&&this.timeThrottlingInterval>0&&this.lastPersistTimestamp>0}addAnSeperateLogItem(e,t){0!==e.length&&e.push({message:`${M.f5} The following logs are for previous session [${t}] ${M.f5}`,isPiiFree:!0,level:E.i.Info,levelName:"Info",timeStamp:e[e.length-1].timeStamp})}get allowPersistIntoIDB(){return(this.ecsEnableIDBLogs||this.isUserEnableIDBLogs)&&!this.disableIDBLogs}fetchAndPersistPreviuosSessionLogs(){var e;let t=this.fetchPreviuosSessionLogsFromLocalStorage(this.userId);(0,M.uD)(this.host.localStorage,this.userId||""),void 0===t&&this.userId===M.$J&&(t=this.fetchPreviuosSessionLogsFromLocalStorage(),t&&(0,M.uD)(this.host.localStorage,"")),t&&t.sessionId&&(null===(e=t.logsArray)||void 0===e?void 0:e.length)>0&&this.persistBufferIntoDB(this.getNextManagementItem(),t.logsArray,!1,t.sessionId,t.logsArray[t.logsArray.length-1].timeStamp.getTime(),!1)}fetchPreviuosSessionLogsFromLocalStorage(e){const t=(0,M.IB)(e);return(0,M.Tx)(this.host.localStorage,t,!0)}checkIDBItemCount(){if(!this.isMaglev&&this.allowPersistIntoIDB&&this.db){const e=this.getIDBStore(this.db,this.storeName,"readwrite");if(e){const t=e.index(this.timeIndexName);if(t){const e=this.scenarioFactory.newScenario(z.RG.DiagnosticsGetAllKeysFromIDB),i=t.getAllKeys();i.onsuccess=()=>{null==e||e.stop(),i.result.length>this.allowedCountOfIndexDBObject&&this.deleteIDBItems([i.result[0]])},i.onerror=()=>{null==e||e.fail({reason:i.error}),this.increaseIDBErrorCount()}}}}}get isMaglev(){var e,t,i;return void 0===this._isMaglev&&(this._isMaglev=null===(i=null===(t=null===(e=(0,R.J)())||void 0===e?void 0:e.loader)||void 0===t?void 0:t.getProperties())||void 0===i?void 0:i.isMaglev),this._isMaglev}getAllEventsFromIDB(e,t){return new Promise((i=>{const n=e.index(this.timeIndexName);if(!n)return i(this.getBufferedEvents());{const e=this.scenarioFactory.newScenario(z.RG.DiagnosticsGetAllLogsFromIDB),a=n.getAll();a.onsuccess=()=>{null==e||e.stop();const n=this.isMaglev?this.parseMaglevEventsFromIDB(a.result,t):this.parseNonMaglevEventsFromIDB(a.result,t);i(n)},a.onerror=()=>{null==e||e.fail({reason:a.error}),this.increaseIDBErrorCount(),i(this.getBufferedEvents())}}}))}}var G=i(919567);class J extends P{constructor(e){super(),this.sessionId=e,this.currentIDBItemIndex=-1,this.IDBManagementArray=[],this.defaultWorkerAllowedBufferLength=1e3,this.defaultWorkerMaxCountOfIndexDBObject=10,this.minWorkerBufferLength=500,this.maxWorkerBufferLength=5e3,this.minWorkerCountOfIDBObjects=5,this.maxWorkerCountOfIDBObjects=100,this.timeThrottlingInterval=6e4,this.lastPersistTimestamp=0,this.skippedEventsCount=0,this.pushLogsOutOfOrdersFound=!1,this.disableIDBLogs=!1,this.ecsEnableIDBLogs=!1,this.isUserEnableIDBLogs=!1,this.allowedCountOfIndexDBObject=this.defaultWorkerMaxCountOfIndexDBObject,this.allowedBufferLength=this.defaultWorkerAllowedBufferLength,this.scenarioFactory=F(!0)}setDBInfo(e,t,i){this.addEvent({message:`DiagnosticsService - setDBInfo called for: tid ${e}, oid ${t}, userid ${i}`,isPiiFree:!0,level:E.i.Info,levelName:"info",timeStamp:new Date})}setCapacity(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){void 0!==e.throttleTime&&e.throttleTime>=0&&(this.timeThrottlingInterval=e.throttleTime*G.kg),e.bufferSize&&e.bufferSize>=this.minWorkerBufferLength&&e.bufferSize<=this.maxWorkerBufferLength&&(this.allowedBufferLength=e.bufferSize);const t=this.allowPersistIntoIDB;if(e.enableIndexedDB?this.ecsEnableIDBLogs=!0:!1===e.enableIndexedDB&&this.disablePersistIntoIDB(W.ecsSetting),e.clientEnableExtendedLogs?this.isUserEnableIDBLogs=!0:!1===e.clientEnableExtendedLogs&&this.disablePersistIntoIDB(W.clientPreference),e.IDBObjectCount&&e.IDBObjectCount>=this.minWorkerCountOfIDBObjects&&e.IDBObjectCount<=this.maxWorkerCountOfIDBObjects){if(t&&this.allowPersistIntoIDB&&this.IDBManagementArray.length>e.IDBObjectCount){const t=this.getToBeDeletedIDs(e.IDBObjectCount);yield this.deleteIDBItems(t)}this.allowedCountOfIndexDBObject=e.IDBObjectCount}}))}addEvent(e){if(!this.pushLogsOutOfOrdersFound&&this.eventsBufferArray.length>0&&e.timeStamp<this.eventsBufferArray[this.eventsBufferArray.length-1].timeStamp){this.pushLogsOutOfOrdersFound=!0;const t=this.scenarioFactory.newScenario(z.RG.DiagnosticsLogsAddOutOfOrder);null==t||t.fail({reason:`Add one log out of order: Current - ${e.timeStamp.toString()}, Last - ${this.eventsBufferArray[this.eventsBufferArray.length-1].timeStamp.toString()}`})}if(this.eventsBufferArray.push(e),this.eventsBufferArray.length>=this.allowedBufferLength)if(this.allowPersistIntoIDB&&this.dataManager)if(this.shouldBeThrottled()){const e=this.eventsBufferArray.shift();this.skippedEventsCount++,void 0===this.firstSkippedEventTime&&(this.firstSkippedEventTime=null==e?void 0:e.timeStamp),this.lastSkippedEventTime=null==e?void 0:e.timeStamp}else this.flushBufferIntoIndexedDB(!0);else this.eventsBufferArray.shift()}getAllEvents(e){return!this.dataManager||!this.allowPersistIntoIDB||e&&this.eventsBufferArray.length>=e?e&&this.eventsBufferArray.length>e?Promise.resolve(this.eventsBufferArray.slice(this.eventsBufferArray.length-e)):Promise.resolve(this.eventsBufferArray):new Promise((t=>{var i;null===(i=this.dataManager)||void 0===i||i.getAllLogs().then((i=>{let n=[],a="",s="";null==i||i.sort(((e,t)=>e.timeStamp-t.timeStamp)),null==i||i.forEach((e=>{""!==a&&e.logsArray.length>1&&e.logsArray[0].timeStamp>e.logsArray[e.logsArray.length-1].timeStamp&&(a=`Fetch from IDB out of order: First - ${e.logsArray[0].timeStamp.toString()}, Last - ${e.logsArray[e.logsArray.length-1].timeStamp.toString()}`),e.sessionId!==s&&""!==s&&this.addAnSeperateLogItem(n,s),s=e.sessionId,n=n.concat(e.logsArray)})),""!==s&&s!==this.sessionId&&this.addAnSeperateLogItem(n,s),n=n.concat(this.eventsBufferArray),e&&n.length>e&&(n=n.slice(n.length-e)),t(n)}))}))}setScenarioFactory(e){this.scenarioFactory.setScenarioFactory(e)}setWorkerLogsDataManager(e){this.dataManager=e}persistLogs(){this.allowPersistIntoIDB&&this.flushBufferIntoIndexedDB(!1)}handleUserLogout(e){return Promise.resolve()}flushBufferIntoIndexedDB(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this.eventsBufferArray.length>0){const t=this.eventsBufferArray;this.eventsBufferArray=[];const i=this.skippedEventsCount;this.updateThrottleInfo(t);const n=yield this.getNextManagementItem(),a=this.scenarioFactory.newScenario(z.RG.DiagnosticsSaveIDBItemMain);this.persistBufferIntoDB(n,t,e),null==a||a.stop({skippedCount:i})}}))}updateThrottleInfo(e){var t;this.skippedEventsCount>0&&this.lastSkippedEventTime&&(e.unshift({message:`DiagnosticsService - skipped ${this.skippedEventsCount} event logs between ${null===(t=this.firstSkippedEventTime)||void 0===t?void 0:t.toISOString()} and ${this.lastSkippedEventTime.toISOString()} for logs throttle`,level:E.i.Info,levelName:"Info",isPiiFree:!0,timeStamp:this.lastSkippedEventTime}),this.skippedEventsCount=0,this.lastSkippedEventTime=void 0,this.firstSkippedEventTime=void 0),this.lastPersistTimestamp=Date.now()}persistBufferIntoDB(e,t,i){var n;if(0===t.length||!this.allowPersistIntoIDB)return;const a={id:e.IDBId,logsArray:t,sessionId:this.sessionId||"",timeStamp:Date.now(),throttleEnabled:this.timeThrottleEnabled(),isRegularPersist:i};null===(n=this.dataManager)||void 0===n||n.persistLogs(a),e.timeStamp=a.timeStamp}deleteIDBItems(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){e.length>0&&this.dataManager&&e.forEach((e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t;if(yield null===(t=this.dataManager)||void 0===t?void 0:t.removeOneLogItem(e)){const t=this.IDBManagementArray.findIndex((t=>t.IDBId===e));t>=0&&this.IDBManagementArray.splice(t,1)}}))))}))}clearDBStore(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.dataManager&&(yield null===(e=this.dataManager)||void 0===e?void 0:e.clearAllLogs())&&(this.IDBManagementArray=[],this.currentIDBItemIndex=-1),!0}))}getToBeDeletedIDs(e){const t=[];if(this.dataManager&&e<this.IDBManagementArray.length){const i=this.IDBManagementArray.length-e;for(let e=0;e<i;e++){let e=0;this.currentIDBItemIndex<this.IDBManagementArray.length-1&&(e=this.currentIDBItemIndex+1);const i=this.IDBManagementArray[e];t.push(i.IDBId),this.IDBManagementArray.splice(e,1),0===e&&this.currentIDBItemIndex--}}return t}getNextManagementItem(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return 0===this.IDBManagementArray.length&&this.allowedCountOfIndexDBObject>0&&(yield this.initializeManagementArray()),this.currentIDBItemIndex===this.IDBManagementArray.length-1?this.IDBManagementArray.length<this.allowedCountOfIndexDBObject?(this.addNewManagementItem(),this.currentIDBItemIndex++):this.currentIDBItemIndex=0:this.currentIDBItemIndex++,this.IDBManagementArray[this.currentIDBItemIndex]}))}addNewManagementItem(){let e=0;for(this.IDBManagementArray.length>0&&(e=this.IDBManagementArray[this.IDBManagementArray.length-1].IDBId),e++;e>this.allowedCountOfIndexDBObject||this.idExists(e);)e>this.allowedCountOfIndexDBObject?e=1:e++;this.IDBManagementArray.push({IDBId:e,timeStamp:0,isUpdating:!1})}idExists(e){return this.IDBManagementArray.filter((t=>t.IDBId===e)).length>0}initializeManagementArray(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this.allowPersistIntoIDB&&this.dataManager&&0===this.IDBManagementArray.length&&this.allowedCountOfIndexDBObject>0){const t=yield null===(e=this.dataManager)||void 0===e?void 0:e.getAllKeys();null==t||t.sort(((e,t)=>e.timeStamp-t.timeStamp)),null==t||t.forEach((e=>this.IDBManagementArray.push({IDBId:e.id,timeStamp:e.timeStamp,isUpdating:!1}))),this.currentIDBItemIndex=this.IDBManagementArray.length-1}}))}disablePersistIntoIDB(e,t){var i;const n=this.allowPersistIntoIDB;switch(e){case W.ecsSetting:if(!this.ecsEnableIDBLogs)return;this.ecsEnableIDBLogs=!1;break;case W.clientPreference:if(!this.isUserEnableIDBLogs)return;this.isUserEnableIDBLogs=!1;break;case W.error:case W.beforeDeletingDB:if(this.disableIDBLogs)return;this.disableIDBLogs=!0}const a=`DiagnosticService - writing logs into IDB settings changed for ${W[e]}`;this.addEvent({message:a,isPiiFree:!0,level:e===W.error?E.i.Error:E.i.Info,levelName:e===W.error?"error":"info",timeStamp:new Date}),n&&!this.allowPersistIntoIDB&&(e===W.error?null===(i=this.scenarioFactory.newScenario(z.RG.DiagnosticsDisableIDB))||void 0===i||i.stop({errorReason:t}):e!==W.beforeDeletingDB&&this.clearDBStore())}shouldBeThrottled(){return!!this.timeThrottleEnabled()&&Date.now()-this.lastPersistTimestamp<this.timeThrottlingInterval}timeThrottleEnabled(){return!this.isUserEnableIDBLogs&&this.timeThrottlingInterval>0&&this.lastPersistTimestamp>0}addAnSeperateLogItem(e,t){0!==e.length&&e.push({message:`${M.f5} The following logs are for previous session [${t}] ${M.f5}`,isPiiFree:!0,level:E.i.Info,levelName:"Info",timeStamp:e[e.length-1].timeStamp})}get allowPersistIntoIDB(){return(this.ecsEnableIDBLogs||this.isUserEnableIDBLogs)&&!this.disableIDBLogs}}class K{constructor(e,t,i,n,s){var o;this.sessionId=e,this.experienceName=t,this.dbStoreName=i,this.defaultPreECSConsoleLogLevel=n,this.userECSConsoleLogLevel=s,this.diagnosticsBackupEnabled=!1,this.allowPersistUncaughtErrorLogs=!1,this.userDiagnosticsMap=new Map,this._userID="",this.memoryBufferArraySize=0,this._minDurationForCountingLogLines=20,this._minThrottleWindowSize=1e4,this._minThrottleWindowCapacity=5,this._minLoggerReportTimeInterval=1e4,this._minLoggerReportCountInterval=30,this._minLogsInLogFile=500,this._ALTCompleted=!1,this.rwcExperienceName="react-web-client",this.logsStoredAsPreviousSession=!1,this._enableScheduler=!1,this._enableSchedulerBeforeALT=!1,this._disableGzipPreviousSessionLogs=!1,this._loggerSettings={durationForCountingLogLines:0,loggerReportTimeInterval:0,loggerReportCountInterval:0,diagnosticsLogsThrottling:N.gG.DryRunQuiet,isUserEnableIDBLogs:!1,throttleWindowSize:0,throttleCapacity:0,consoleLogLevel:E.i.Error,throttleLoggers:new Set},this._defaultLatestErrorCount=5,this.logsProviderName=T.DIAGNOSTICSSERVICE,this.updatedSettingsForMainThread=e=>{this.diagnosticsSettings=e;const{diagnosticsBackupSyncCycleMs:t,diagnosticsEventQueueMaxSize:i,diagnosticsLogBufferArraySize:n,diagnosticsLogsIDBObjectCount:a,diagnosticsLogsThrottling:s,enableDiagnosticsBackup:o,enableStoreDiagnosticsLogsInIDB:r,errorDiagnosticsEventQueueMaxSize:c,logsMarkInterval:l,IDBFetchingTimeoutMs:d,savingLogsIntoIDBThrottleTime:u,throttleCapacity:m,throttleWindowSizeMs:g,clientExtendedDiagnosticsData:h,disableExtendedDiagnosticsDataToggle:p,consoleLogLevel:v,loggerReportTimeInterval:f,loggerReportCountInterval:b,enableSchedulerOnLoggers:y,enableSchedulerOnLoggersBeforeALT:k,loggerThrottleList:S,disableGzipPreviousSessionLogs:w,allowPersistUncaughtErrorLogs:j}=e;this.updateSettingsForLogger({durationForCountingLogLines:l||0,loggerReportTimeInterval:f||this._loggerSettings.loggerReportTimeInterval,loggerReportCountInterval:b||this._loggerSettings.loggerReportCountInterval,throttleWindowSize:g||0,throttleCapacity:m||0,isUserEnableIDBLogs:!!h&&!p,diagnosticsLogsThrottling:s||N.gG.DryRunQuiet,throttleLoggers:new Set(S||[]),consoleLogLevel:this.validateConsoleLogLevel(v||"")}),this.setDiagnosticsBackupEnabled(!!o,t||void 0);const C=(0,B.isNumber)(u)?u:void 0,_=(0,B.isNumber)(i)?i:0;if(void 0===r&&void 0===h)_&&this.diagnosticsEvents.setCapacity({bufferSize:_,throttleTime:C});else{const e=r?(0,B.isNumber)(n)?n:0:_;this.diagnosticsEvents.setCapacity({enableIndexedDB:(0,B.isUndefined)(r)?void 0:!!r,bufferSize:e,IDBObjectCount:(0,B.isNumber)(a)?a:0,throttleTime:C,clientEnableExtendedLogs:(0,B.isUndefined)(h)?void 0:!!h&&!p,IDBFetchingTimeoutMs:(0,B.isNumber)(d)?d:0})}this._enableScheduler=!!y,this._enableSchedulerBeforeALT=!!k,this._disableGzipPreviousSessionLogs=!!w,this.isErrorDiagnosticsEnabled=!!c,this.allowPersistUncaughtErrorLogs=!!j,this.isErrorDiagnosticsEnabled?(0,B.isNumber)(c)&&this.errorDiagnosticsEvents.setCapacity({bufferSize:c,throttleTime:C}):this.errorDiagnosticsEvents=new O(!0,this.sessionId,this.host,this._defaultLatestErrorCount)},this.updatedSettingsForWorkerThread=e=>{const{workerDiagnosticsEventQueueMaxSize:t,enableWorkerStoreDiagnosticsLogsInIDB:i,workerDiagnosticsLogBufferArraySize:n,workerDiagnosticsLogsIDBObjectCount:a,logsMarkInterval:s,savingLogsIntoIDBThrottleTime:o,throttleCapacity:r,throttleWindowSizeMs:c,clientExtendedDiagnosticsData:l,disableExtendedDiagnosticsDataToggle:d,diagnosticsLogsThrottling:u,consoleLogLevel:m,loggerReportTimeInterval:g,loggerReportCountInterval:h,loggerThrottleList:p}=e;this.updateSettingsForLogger({durationForCountingLogLines:s||0,loggerReportTimeInterval:g||this._loggerSettings.loggerReportTimeInterval,loggerReportCountInterval:h||this._loggerSettings.loggerReportCountInterval,throttleWindowSize:c||0,throttleCapacity:r||0,isUserEnableIDBLogs:!!l&&!d,diagnosticsLogsThrottling:u||N.gG.DryRunQuiet,throttleLoggers:new Set(p||[]),consoleLogLevel:this.validateConsoleLogLevel(m||"")});const v=(0,B.isNumber)(o)?o:void 0,f=(0,B.isNumber)(t)?t:0;this.memoryBufferArraySize=i&&(0,B.isNumber)(n)?n:f,this.diagnosticsEvents.setCapacity({bufferSize:this.memoryBufferArraySize,enableIndexedDB:(0,B.isUndefined)(i)?void 0:!!i,IDBObjectCount:(0,B.isNumber)(a)?a:0,throttleTime:v,clientEnableExtendedLogs:(0,B.isUndefined)(l)?void 0:!!l&&!d})},this.attemptToSetHost(),this.scenarioFactory=F(!1),void 0!==this.userECSConsoleLogLevel?this.loggerSettings.consoleLogLevel=this.userECSConsoleLogLevel:void 0!==n&&(this.loggerSettings.consoleLogLevel=n),this.sessionId&&t&&i===a.DiagnosticsLogsMain?this.diagnosticsEvents=new V(this.host,t,i,this.sessionId):t&&i===a.DiagnosticsLogsWorker&&this.sessionId?this.diagnosticsEvents=new J(this.sessionId):this.diagnosticsEvents=new O(!1,this.sessionId,this.host),this.isErrorDiagnosticsEnabled=!1,this.errorDiagnosticsEvents=new O(!0,this.sessionId,this.host),this.diagnosticsBackupService=void 0,(null===(o=this.host)||void 0===o?void 0:o.addEventListener)&&this.host.addEventListener("unload",(()=>{this.persistDiagnosticsAsPreviousSessionLogs()})),t!==this.rwcExperienceName&&this.loadDiagnosticsFromLocalStorage(!0)}setScenarioFactory(e){this.coreScenarioFactory=e,this.scenarioFactory.setScenarioFactory(e),this.diagnosticsEvents.setScenarioFactory(e),this.userDiagnosticsMap.size>0&&Array.from(this.userDiagnosticsMap.values()).forEach((t=>{t.setScenarioFactory(e)}))}setScheduler(e){this._scheduler||(this._scheduler=e,this.userDiagnosticsMap.size>0&&Array.from(this.userDiagnosticsMap.values()).forEach((t=>{t.setScheduler(e)})))}setLogsCountReporter(e){this._logsCountReporter||(this._logsCountReporter=e,this.userDiagnosticsMap.size>0&&Array.from(this.userDiagnosticsMap.values()).forEach((t=>{t.setLogsCountReporter(e)})))}setALTDone(){var e,t,i;if(!this._ALTCompleted){if(this._ALTCompleted=!0,this.diagnosticsEvents.setALTDone(),this.userDiagnosticsMap.size>0&&Array.from(this.userDiagnosticsMap.values()).forEach((e=>e.setALTDone())),this._userID===M.$J&&(null===(e=this.host)||void 0===e?void 0:e.localStorage)&&!(null===(t=this.diagnosticsSettings)||void 0===t?void 0:t.skipCleanInvalidPreSessionLogs)){const e=Array.from(this.userDiagnosticsMap.keys());(0,M.OO)(this.host.localStorage,[...e,M.$J])}this._userID===M.$J&&this.experienceName===this.rwcExperienceName&&(null===(i=this.host)||void 0===i?void 0:i.localStorage)&&(0,M.e2)(this.host.localStorage)}}subscribeToCoreSettings(e){if(!e)return void this.pushDiagnosticsEvent(E.i.Error,"DiagnosticsService: Failed to subscribe to core settings",!0);e.getObservable(S.J.Diagnostics).subscribe((e=>{this.dbStoreName===a.DiagnosticsLogsWorker?this.updatedSettingsForWorkerThread(e):(this.updatedSettingsForMainThread(e),this.userDiagnosticsMap.size>0&&Array.from(this.userDiagnosticsMap.values()).forEach((t=>t.updatedSettingsForMainThread(e))))})),this.logCountReporter&&this.logCountReporter.subscribeToCoreSettings(e)}updateDiagnosticInfo(e,t,i){i&&(this._userID=i),this.diagnosticsEvents.setDBInfo(e,t,i),this.errorDiagnosticsEvents.setDBInfo(e,t,i)}handleUserLogout(e){if(e){const t=this.userDiagnosticsMap.get(e);if(t){this.userDiagnosticsMap.delete(e);let i=Promise.resolve();return 0===this.userDiagnosticsMap.size&&(i=this.cleanLogsStorage()),Promise.all([t.handleUserLogout(e),i]).then()}}return this.cleanLogsStorage()}createUserDiagnosticsService(e,t,i){if(this.dbStoreName===a.DiagnosticsLogsWorker||this._userID&&this._userID!==M.$J)this.pushDiagnosticsEvent(E.i.Error,"DiagnosticsService: createUserDiagnosticsService function should only be called from the coreDiagnosticsService in the main thread",!0);else if(e&&t&&i){this._userID||this.updateDiagnosticInfo(M.zB,M.m0,M.$J);let n=this.userDiagnosticsMap.get(i);return void 0===n&&(n=new K(this.sessionId,this.experienceName,this.dbStoreName,this.defaultPreECSConsoleLogLevel,this.userECSConsoleLogLevel),n.updateDiagnosticInfo(e,t,i),this.diagnosticsSettings&&n.updatedSettingsForMainThread(this.diagnosticsSettings),this.coreScenarioFactory&&n.setScenarioFactory(this.coreScenarioFactory),this._scheduler&&n.setScheduler(this._scheduler),this._logsCountReporter&&n.setLogsCountReporter(this._logsCountReporter),this._ALTCompleted&&n.setALTDone(),this.userDiagnosticsMap.set(i,n)),n}}pushDiagnosticsEvent(e,t,i,n,a=!1){const s=(0,M.hR)(this.diagnosticsEvents,e,t,i,n,a);e===E.i.Error&&this.errorDiagnosticsEvents.addEvent(s,a),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.pushDiagnosticsEvent(s)}getDiagnosticsEvents(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let t=[];const i=this.scenarioFactory.newScenario(z.RG.DiagnosticsGetLogs);try{t=(yield this.diagnosticsEvents.getAllEvents(e))||[]}catch(e){const t=`DiagnosticsService: Failed to fetch diagnostic logs: ${e}`;this.pushDiagnosticsEvent(E.i.Error,t,!0),null==i||i.fail({reason:t})}try{t=t.reverse(),null==i||i.stop()}catch(e){null==i||i.fail({reason:"Logs events array failed on reverting and sorting"})}return t}))}persistDiagnostics(){this.experienceName!==this.rwcExperienceName&&this.allowPersistUncaughtErrorLogs&&(this.diagnosticsEvents.persistLogs(),this.errorDiagnosticsEvents.persistLogs(),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.flush(),this.userDiagnosticsMap.size>0&&Array.from(this.userDiagnosticsMap.values()).forEach((e=>{e.persistDiagnostics()})))}getLogsFiles(e,t=0){return(0,n.__awaiter)(this,void 0,void 0,(function*(){t>0&&t<this._minLogsInLogFile&&(t=this._minLogsInLogFile);const i="No logs found",n="Logging of this type is not enabled";let a="",s="",o=(yield this.errorDiagnosticsEvents.getAllEvents())||[];o=(e?(0,M.Ij)(o):o).reverse();let r=(0,M.Mf)(o.slice(0,this._defaultLatestErrorCount));r&&(r=`Latest errors for ${this._userID}\r\n${r}`),this.isErrorDiagnosticsEnabled?(s=this.getPreviousSessionDiagnosticsLogsString(!0,e),a=(0,M.Mf)(o)):(s=n,a=n);const c=this.getPreviousSessionDiagnosticsLogsString(!1,e),l=yield this.getDiagnosticsLogs(!!e,t),d=M.$J===this._userID?void 0:this._userID;return Promise.resolve([Object.assign({isPiiFree:!1,fileName:"diagnostics-error-logs-previous-session.txt",content:s||i},d?{userId:d}:{}),Object.assign({isPiiFree:!1,fileName:"diagnostics-logs-previous-session.txt",content:c||i},d?{userId:d}:{}),Object.assign({isPiiFree:!1,fileName:"diagnostics-error-logs.txt",content:a||i},d?{userId:d}:{}),Object.assign({isPiiFree:!1,fileName:"diagnostics-logs.txt",content:l||i},d?{userId:d}:{}),Object.assign({isPiiFree:!1,fileName:"latestErrors",content:r},d?{userId:d}:{})])}))}getSystemInfo(){return Promise.resolve(new Map)}get loggerSettings(){return this._loggerSettings}get logScheduler(){if(this._enableScheduler&&(this._enableSchedulerBeforeALT||this._ALTCompleted))return this._scheduler}get userId(){return this._userID!==M.$J?this._userID:""}get logCountReporter(){return this._logsCountReporter}setWorkerLogsDataManager(e){"setWorkerLogsDataManager"in this.diagnosticsEvents&&this.diagnosticsEvents.setWorkerLogsDataManager(e)}persistDiagnosticsAsPreviousSessionLogs(){var e;if(!this.logsStoredAsPreviousSession&&(this.logsStoredAsPreviousSession=!0,null===(e=this.host)||void 0===e?void 0:e.localStorage)){const e=this.experienceName===this.rwcExperienceName?this._userID||M.$J:void 0,t=this.experienceName===this.rwcExperienceName?this.sessionId:void 0,i=this.diagnosticsEvents.getBufferedEvents();i.length>0&&this.persistLogsWithErrorHandle(this.host.localStorage,i,(0,M.IB)(e),t);const n=this.errorDiagnosticsEvents.getBufferedEvents();n.length>0&&this.persistLogsWithErrorHandle(this.host.localStorage,n,(0,M.IB)(e,!0),t),this.userDiagnosticsMap.size>0&&Array.from(this.userDiagnosticsMap.values()).forEach((e=>{e.persistDiagnosticsAsPreviousSessionLogs()}))}}persistLogsWithErrorHandle(e,t,i,n){try{(0,M.NF)(e,t,i,n,!this._disableGzipPreviousSessionLogs)}catch(e){this.pushDiagnosticsEvent(E.i.Error,`DiagnosticsService: window_localstorage save logs failure, ${null==e?void 0:e.name}`,!0)}}setDiagnosticsBackupEnabled(e,t){var i,n,a;this.diagnosticsBackupEnabled=e,e?!this.diagnosticsBackupService&&(null===(i=this.host)||void 0===i?void 0:i.opener)&&(null===(n=this.host)||void 0===n?void 0:n.setTimeout)&&(null===(a=this.host)||void 0===a?void 0:a.clearTimeout)&&(this.diagnosticsBackupService=new $(this.host.opener,this.host.setTimeout,this.host.clearTimeout,t)):this.diagnosticsBackupService&&(this.diagnosticsBackupService.dispose(),this.diagnosticsBackupService=void 0)}getDiagnosticsLogs(e,t=0){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.getDiagnosticsEvents(t),n=(0,M.Mf)(e?(0,M.Ij)(i):i),a=`Note: only ${this.memoryBufferArraySize||2e3} most recent logs are guaranteed to be shown due to the way logs are stored. Previous logs may have been removed\n`;return n?a+n:n}))}attemptToSetHost(){try{this.host=(0,R.J)()}catch(e){}}loadDiagnosticsFromLocalStorage(e=!0){var t;if((null===(t=this.host)||void 0===t?void 0:t.localStorage)&&this.experienceName!==this.rwcExperienceName){const t=this.scenarioFactory.newScenario(z.RG.DiagnosticsGetLogsFromLocalStorage);try{(0,M.UL)(this.diagnosticsEvents,this.host.localStorage,(0,M.yN)(),e),(0,M.UL)(this.errorDiagnosticsEvents,this.host.localStorage,(0,M.yN)(void 0,!0),e),null==t||t.stop()}catch(e){const i=`DiagnosticsService: Failed to load persisted logs from store with error: ${e}`;this.pushDiagnosticsEvent(E.i.Error,i,!0),null==t||t.fail({reason:i})}}}cleanLogsStorage(){var e,t,i;return(null===(e=this.host)||void 0===e?void 0:e.localStorage)&&((0,M.uD)(null===(t=this.host)||void 0===t?void 0:t.localStorage,this.userId),this.userId===M.$J&&(0,M.uD)(null===(i=this.host)||void 0===i?void 0:i.localStorage,"")),Promise.all([this.diagnosticsEvents.handleUserLogout(),this.errorDiagnosticsEvents.handleUserLogout()]).then()}updateSettingsForLogger(e){this._loggerSettings.durationForCountingLogLines=this.validateSettingValue(e.durationForCountingLogLines,this._minDurationForCountingLogLines,this._loggerSettings.durationForCountingLogLines),this._loggerSettings.throttleCapacity=this.validateSettingValue(e.throttleCapacity,this._minThrottleWindowCapacity,this._loggerSettings.throttleCapacity),this._loggerSettings.throttleWindowSize=this.validateSettingValue(e.throttleWindowSize,this._minThrottleWindowSize,this._loggerSettings.throttleWindowSize),this._loggerSettings.isUserEnableIDBLogs=e.isUserEnableIDBLogs,this._loggerSettings.diagnosticsLogsThrottling=e.diagnosticsLogsThrottling,void 0===this.userECSConsoleLogLevel&&void 0!==e.consoleLogLevel&&null!==e.consoleLogLevel&&(this._loggerSettings.consoleLogLevel=e.consoleLogLevel),this._loggerSettings.loggerReportTimeInterval=this.validateSettingValue(e.loggerReportTimeInterval,this._minLoggerReportTimeInterval,this._loggerSettings.loggerReportTimeInterval),this._loggerSettings.loggerReportCountInterval=this.validateSettingValue(e.loggerReportCountInterval,this._minLoggerReportCountInterval,this._loggerSettings.loggerReportCountInterval),this._loggerSettings.throttleLoggers=e.throttleLoggers}validateSettingValue(e,t,i){return 0===e||e>=t?e:i}validateConsoleLogLevel(e){if(Object.keys(E.i).includes(e))return E.i[e]}getPreviousSessionDiagnosticsLogsString(e,t){var i;let n="";if(null===(i=this.host)||void 0===i?void 0:i.localStorage){const i=this.experienceName===this.rwcExperienceName?this._userID||M.$J:void 0,a=(0,M.IB)(i,e);n=(0,M.gE)(this.host.localStorage,a,!!t)}return n||"No logs found"}}var Q=i(137021);class Y{constructor(e){this.globalContext=e,this.reportIntervalHandler=0,this.minReportTimeInterval=6e4,this.minReportCountInterval=200,this.minReportErrorCountInterval=10,this.reportTimeInterval=0,this.reportCountInterval=0,this.reportErrorCountInterval=0,this.lastReportTime=Date.now(),this.totalLogsCountFromLastReport=0,this.errorLogsCountFromLastReport=0,this.logsCountMap=new Map}updateLogsCounts(e){for(const[t,i]of e)this.updateLogsCountForOneLogger(t,i)}updateLogsCountForOneLogger(e,t){this.startTimer();const i=this.logsCountMap.get(e);i?(i.total+=t.total,i.error+=t.error,i.diagnostics+=t.diagnostics,i.throttled+=t.throttled):this.logsCountMap.set(e,Object.assign({},t)),this.totalLogsCountFromLastReport+=t.total,this.errorLogsCountFromLastReport+=t.error}subscribeToCoreSettings(e){if(this.coreSettingsSubscription)return;const t=e.getObservable(S.J.Diagnostics,["logReporterSendCountInterval","logReporterSendTimeInterval","logReporterSendErrorCountInterval"]);this.coreSettingsSubscription=t.subscribe((e=>{if((0===e.logReporterSendCountInterval||(e.logReporterSendCountInterval||0)>=this.minReportCountInterval)&&(this.reportCountInterval=e.logReporterSendCountInterval||0),(0===e.logReporterSendErrorCountInterval||(e.logReporterSendErrorCountInterval||0)>=this.minReportErrorCountInterval)&&(this.reportErrorCountInterval=e.logReporterSendErrorCountInterval||0),0===e.logReporterSendTimeInterval||(e.logReporterSendTimeInterval||0)>=this.minReportTimeInterval){const t=e.logReporterSendTimeInterval||0;this.reportTimeInterval!==t&&(this.reportTimeInterval=t,this.reportIntervalHandler&&(this.globalContext.clearTimeout(this.reportIntervalHandler),this.reportIntervalHandler=0,this.startTimer()))}}))}reportLogsCount(){if(this.reportIntervalHandler=0,this.shouldReport()){const e=Date.now(),t=e-this.lastReportTime;this.lastReportTime=e,this.totalLogsCountFromLastReport=0,this.errorLogsCountFromLastReport=0;const i=this.logsCountMap;this.logsCountMap=new Map;const n=this.packLogsCountInfo(i);i.clear(),n&&(0,Q.MI)("logsCountInfo",{logsCountInfo:n,delta:t},"webclient_framework_logs_count_event")}}packLogsCountInfo(e){if(e.size>0){const t=[];for(const[i,n]of e)t.push({loggerName:i,total:n.total,error:n.error,diagnostics:n.diagnostics,throttled:n.throttled});return JSON.stringify(t)}return""}shouldReport(){return this.reportCountInterval>0&&this.reportTimeInterval>0&&this.reportErrorCountInterval>0&&(this.logsCountMap.size>0&&(this.totalLogsCountFromLastReport>=this.reportCountInterval||this.errorLogsCountFromLastReport>=this.reportErrorCountInterval))}startTimer(){0===this.reportIntervalHandler&&this.reportTimeInterval>0&&(this.reportIntervalHandler=this.globalContext.setTimeout((()=>this.reportLogsCount()),this.reportTimeInterval))}}var X=i(888418),Z=i(793989),ee=i(322910);class te{constructor(){this.debugLogging=""}initialize(e){this.logger=e,this.logger.debug("Telemetry Utility-Service initialized")}static getInstance(){return this.instance}}function ie(){return te.getInstance()}te.instance=new te;class ne{constructor(e,t,i,n="",a=""){var s;this.diagnosticsService=e,this.label=t,this.loggerName=i,this.contextId=n,this.userContextId=a,this.enableDebugLogging=!1,this.cidLabel="",this.logsCount=0,this.lastReportTime=0,this.throttleAllowance=0,this.currentWindow=0,this.throttledCount=0,this.logsCountPerLoggerNameMap=new Map;try{const e=(0,R.J)();ie().debugLogging||(ie().debugLogging=null!==(s=e.localStorage.getItem("localDebug"))&&void 0!==s?s:"default"),this.enableDebugLogging="true"===ie().debugLogging}catch(e){}this.cidLabel=n?n.concat(" ",t):t}log(e,...t){return this.invoke(console.log,e,E.i.Info,!1,...t)}warn(e,...t){return this.invoke(console.warn,e,E.i.Warn,!1,...t)}error(e,...t){return this.invoke(console.error,e,E.i.Error,!1,...t)}debug(e,...t){return this.enableDebugLogging||this.consoleLogLevel>=E.i.Debug?this.invoke(console.debug,e,E.i.Debug,!1,...t):X.V.None}logNoPii(e,...t){return this.invoke(console.log,e,E.i.Info,!0,...t)}warnNoPii(e,...t){return this.invoke(console.warn,e,E.i.Warn,!0,...t)}errorNoPii(e,...t){return this.invoke(console.error,e,E.i.Error,!0,...t)}debugNoPii(e,...t){return this.enableDebugLogging||this.consoleLogLevel>=E.i.Debug?this.invoke(console.debug,e,E.i.Debug,!0,...t):X.V.None}errorToTelemetry(e,t,i,n){return this.toTelemetry(console.error,e,t,E.i.Error,i,n)}warnToTelemetry(e,t,i,n){return this.toTelemetry(console.warn,e,t,E.i.Warn,i,n)}debugToTelemetry(e,t,i,n){return this.toTelemetry(console.debug,e,t,E.i.Debug,i,n)}infoToTelemetry(e,t,i,n){return this.toTelemetry(console.log,e,t,E.i.Info,i,n)}sendToDiagnosticLogs(e,t,i,n,a,s,...o){if((0,ee.R3)(a,X.V.AddedIntoDiagnostics)||(0,ee.R3)(a,X.V.ThrottledForDiagnostics)){if((null==o?void 0:o.length)>0){e=`${e} ${o.map((e=>(0,U.XC)(e))).join(", ")}`}e=(0,U.LQ)(e),(0,ee.R3)(a,X.V.AddedIntoDiagnostics)?this.diagnosticsService.pushDiagnosticsEvent(t,e,s,i,n):[N.gG.Enabled,N.gG.EnabledQuiet].includes(this.diagnosticsService.loggerSettings.diagnosticsLogsThrottling)||this.diagnosticsService.pushDiagnosticsEvent(t,e,s,i,n)}}toTelemetry(e,t,i,n,a,s=!1){t=(0,U.LQ)(`${t}`);let o=X.V.SentToTelemetry;return s&&(o=(0,ee.Kx)(this.invoke(e,t,n,!0),X.V.SentToTelemetry)),(a=a||{}).message=t,a.logLevel=E.i[n],a.contextId=this.contextId,(0,Q.MI)(this.label,a,i,void 0,void 0,this.userContextId),o}invoke(e,t,i,n,...a){var s;const o=this.getLogResult(i);if(o!==X.V.None){let r=this.loggerName;if((null==a?void 0:a.length)>0&&a[0]&&"object"==typeof a[0]&&"loggerName"in a[0])try{r=a[0].loggerName,1===Object.keys(a[0]).length?a.shift():delete a[0].loggerName}catch(e){}if(this.increaseLogCount(i,o,r),t=`${this.cidLabel}: ${t}`,(0,ee.R3)(o,X.V.LoggedInConsole)){const i=this.diagnosticsService.userId;e.call(console,i?`[${i}] - ${t}`:t,...a)}if(i!==E.i.Error&&this.diagnosticsService.logScheduler)try{return null===(s=this.diagnosticsService.logScheduler)||void 0===s||s.schedule((()=>this.sendToDiagnosticLogs(t,i,new Date,!0,o,n,...a)),{priority:Z.vW.Background,id:"send-log-to-console-and-diagnostics",scheduledById:"logger"},""),o}catch(e){this.diagnosticsService.pushDiagnosticsEvent(E.i.Error,"Schedule logs failed",!0,new Date,!1)}this.sendToDiagnosticLogs(t,i,new Date,!1,o,n,...a)}return o}getLogResult(e){let t=X.V.None;return(e<=this.consoleLogLevel||this.enableDebugLogging)&&(t=(0,ee.Kx)(t,X.V.LoggedInConsole)),(e<E.i.Debug||e<=this.consoleLogLevel)&&!this.isLoggerThrottledForDiagnostics()&&(e===E.i.Error||this.diagnosticsService.loggerSettings.isUserEnableIDBLogs||!this.shouldThrottle()?t=(0,ee.Kx)(t,X.V.AddedIntoDiagnostics):(this.throttledCount++,t=(0,ee.Kx)(t,X.V.ThrottledForDiagnostics))),t}increaseLogCount(e,t,i){if(-1===this.diagnosticsService.loggerSettings.loggerReportCountInterval)this.updateCountToReporterForOneEvent(i,t,e);else{0===this.lastReportTime&&(this.lastReportTime=Date.now());let n=this.logsCountPerLoggerNameMap.get(i);void 0===n&&(n={total:0,error:0,diagnostics:0,throttled:0},this.logsCountPerLoggerNameMap.set(i,n)),this.logsCount++,n.total++,e===E.i.Error&&n.error++;((0,ee.R3)(t,X.V.AddedIntoDiagnostics)||(0,ee.R3)(t,X.V.ThrottledForDiagnostics))&&(n.diagnostics++,(0,ee.R3)(t,X.V.ThrottledForDiagnostics)&&(this.throttledCount++,n.throttled++)),this.updateLogsCountToReporter(e===E.i.Error)}}updateLogsCountToReporter(e){if(this.logsCount>0&&this.diagnosticsService.loggerSettings.loggerReportCountInterval>0&&this.diagnosticsService.loggerSettings.loggerReportTimeInterval>0&&this.diagnosticsService.logCountReporter){const t=Date.now();(t-this.lastReportTime>this.diagnosticsService.loggerSettings.loggerReportTimeInterval||this.logsCount>=this.diagnosticsService.loggerSettings.loggerReportCountInterval||e)&&(this.diagnosticsService.logCountReporter.updateLogsCounts(this.logsCountPerLoggerNameMap),this.logsCount=0,this.throttledCount=0,this.lastReportTime=t,this.logsCountPerLoggerNameMap=new Map)}}updateCountToReporterForOneEvent(e,t,i){if(this.diagnosticsService.logCountReporter){const n={total:1,error:0,diagnostics:0,throttled:0};((0,ee.R3)(t,X.V.AddedIntoDiagnostics)||(0,ee.R3)(t,X.V.ThrottledForDiagnostics))&&(n.diagnostics=1,(0,ee.R3)(t,X.V.ThrottledForDiagnostics)&&(n.throttled=1)),i===E.i.Error&&(n.error=1),this.diagnosticsService.logCountReporter.updateLogsCountForOneLogger(e,n)}}shouldThrottle(){const e=this.diagnosticsService.loggerSettings;if(e.diagnosticsLogsThrottling===N.gG.Disabled||0===e.throttleCapacity)return!1;const t=Date.now();return t-this.currentWindow>e.throttleWindowSize&&(this.sendThrottledCount(),this.currentWindow=t,this.throttleAllowance=e.throttleCapacity),this.throttleAllowance<1||(this.throttleAllowance-=1,!1)}sendThrottledCount(){if(!(this.throttledCount<1)&&[N.gG.DryRun,N.gG.Enabled].includes(this.diagnosticsService.loggerSettings.diagnosticsLogsThrottling)){const e=this.diagnosticsService.loggerSettings.diagnosticsLogsThrottling===N.gG.DryRun?"would have been throttled":"were throttled",t=`${this.cidLabel}: ${this.throttledCount} logs ${e} from ${new Date(this.currentWindow).toISOString()}`;this.diagnosticsService.pushDiagnosticsEvent(E.i.Info,t,!0,new Date,!1)}}get consoleLogLevel(){const e=this.diagnosticsService.loggerSettings.consoleLogLevel;return void 0===e?E.i.Warn:e}isLoggerThrottledForDiagnostics(){var e,t,i;return!!this.loggerName&&(null===(i=null===(t=null===(e=this.diagnosticsService)||void 0===e?void 0:e.loggerSettings)||void 0===t?void 0:t.throttleLoggers)||void 0===i?void 0:i.has(this.loggerName))}}class ae{constructor(e,t,i=""){this.diagnosticsService=e,this.contextId=t,this.userContextId=i,this.newLogger=(e,t)=>{e=(0,U.LQ)(`${e}`);return new ne(this.diagnosticsService,e,t,this._contextId,this.userContextId)},this._contextId=t&&"00000000-0000-0000-0000-000000000000"!==t?(0,U.LQ)(`CID[${t}]`):""}get cID(){return this.contextId}notifyDiagnosticsALTDone(){this.diagnosticsService.setALTDone()}}var se=i(659726),oe=i(905581),re=i(540929),ce=i(187084),le=i(653826);const de=(e,t,i,a)=>(0,r.z)((0,ce.fU)(((i,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return function(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e[Symbol.iterator](),s=t[Symbol.iterator]();let o=n.next(),r=s.next();const c=[];for(;!r.done||!o.done;)r.done||!o.done&&r.value.id>o.value[0].id?(yield a(o.value[1]),o=n.next()):o.done||r.value.id<o.value[0].id?(c.push([r.value,i(r.value)]),r=s.next()):(c.push([r.value,o.value[1]]),o=n.next(),r=s.next());return c}))}(i,Array.from(s).sort(((e,t)=>e.id.localeCompare(t.id))),(t=>ue(t,e,a)),(e=>me(e,t)))}))),[]),(0,l.U)((e=>ge(e,i))),(0,le.b)((e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield e;return Promise.all(t)}))))),ue=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{return{type:"value",value:yield t(e)}}catch(t){return i&&i(e,t),{type:"error",error:t}}})),me=(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const i=yield e;if("error"!==i.type)return t(Promise.resolve(i.value))})),ge=(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const i=[],n=yield Promise.all(e);for(const e of n){const n=yield e[1];"value"===n.type&&i.push(t(e[0],Promise.resolve(n.value)))}return i}));var he=i(949556),pe=i(956255),ve=i(419925);var fe=i(324773);function be(e){return Object.keys(e).reduce(((t,i)=>(t[i]=function(e){const t=(0,fe.QS)(e);return{update:e=>t(e),read:()=>t(),ref:t}}(e[i]),t)),{})}const ye=new Set([ve.ab,ve.Xt]);class ke{constructor(e,t,i){this._logger=e.newLogger("ReactiveValuesService","core-services-activator"),this._appViewStateForWindowMap=new Map,this._servicesAppsRegistry=t,this._config=i}getAppViewStateForWindow(e,t){var i,n,a;this._config.enableEmbedDataClient&&(e=h.ew);const s=null===(i=this._appViewStateForWindowMap.get(e))||void 0===i?void 0:i.get(t);if(!s){const i=this._servicesAppsRegistry.getAppByID(t);i&&"viewStateRegistration"in i&&i.viewStateRegistration&&(null===(a=(n=this._logger).errorToTelemetry)||void 0===a||a.call(n,`Unable to find appViewState for window ${e} app ${t}, registeredApps: ${this._appViewStateForWindowMap.get(e)}`,"webclient_framework_foundation_core_services_activator"))}return s}resetAllViewState(e){const t=this._appViewStateForWindowMap.get(e);t&&t.forEach(((e,t)=>{ye.has(t)||this.resetViewStateForApp(t,e)}))}setReactiveValuesForApp(e,t,i){var n;const a=null===(n=this._appViewStateForWindowMap.get(e))||void 0===n?void 0:n.get(t);if(this._logger.log(`Setting view state to apollo cache value for windowId ${e}, app ${t}`),a){const{navigationalReactiveValues:e,nonNavigationalReactiveValues:t}=a;Object.keys(i).forEach((n=>{let a=e[n];a||(a=t[n]),a.update(i[n])}))}}getRegisteredAppsTypePolicies(e){const t={typePolicies:{},defaultTypeName:[]};return this._appViewStateForWindowMap.set(e,new Map),this._servicesAppsRegistry.registeredApps.forEach((i=>{const n=i.manifest.id,a=i;if(a.viewStateRegistration){const{computedValues:i,navigationalFieldDefaultValues:s,nonNavigationalFieldDefaultValues:o,gqlTypeName:r,queryFieldName:c}=a.viewStateRegistration,l=be(s),d=be(o),u=this._appViewStateForWindowMap.get(e);null==u||u.set(n,{navigationalReactiveValues:l,nonNavigationalReactiveValues:d});const m=function(...e){const[t,i,n]=e,a={};for(const e of Object.keys(i)){const t=e,n=()=>i[t].read();a[t]={read:n}}if(n)for(const e of Object.keys(n)){const t=e,s=(e,a)=>{const{args:s}=a||{};return n[t](i,s)},o=s;a[t]={read:o}}return{[t]:{fields:a}}}(r,Object.assign(Object.assign({},l),d),i);t.typePolicies=Object.assign(Object.assign({},t.typePolicies),m),t.defaultTypeName.push({gqlTypeName:r,queryFieldName:c})}})),t}removeWindowViewState(e){this._appViewStateForWindowMap.delete(e)}resetViewStateForApp(e,t,i){const n=this._servicesAppsRegistry.getAppByID(e);if(n&&t&&"viewStateRegistration"in n&&n.viewStateRegistration){this._logger.log(`Resetting view state for app ${e}`);const{navigationalFieldDefaultValues:a,nonNavigationalFieldDefaultValues:s}=n.viewStateRegistration;Object.keys(a||{}).forEach((e=>{(null==i?void 0:i.includes(e))||t.navigationalReactiveValues[e].update(a[e])})),Object.keys(s).forEach((e=>{(null==i?void 0:i.includes(e))||t.nonNavigationalReactiveValues[e].update(s[e])}))}}}var Se=i(265858),we=i.t(Se,2);const je={id:"com.microsoft.teams.corelayout",actors:["corelayout"],name:"CoreLayoutApp"};var Ce=i(979176);const _e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCoreLayoutResizeSlotDimensionsMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"width"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"slotName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SlotName"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resizeSlotDimensions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"width"},value:{kind:"Variable",name:{kind:"Name",value:"width"}}},{kind:"Argument",name:{kind:"Name",value:"slotName"},value:{kind:"Variable",name:{kind:"Name",value:"slotName"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var Te=i(528765);const Ie={onEventReceived:e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var t,i,n,a,s;const{appViewState:o,eventInput:r,requestContext:{client:c,loggerFactory:l},windowId:d}=e,u=l.newLogger("apps-core-layout","apps-core-layout"),m=r.event;if(!function(e){if(e.originator!==Ce.kn)return!1;for(const t in Ce.uS)if(t===e.type)return!0;return!1}(m))return u.error(`Unhandled event ${r} is not a core layout event`),Promise.reject(new Error(`Unhandled event ${r.event.type} is not a core layout event`));switch(m.type){case Ce.uS.criticalAppPhaseReached:return o.postCriticalPhaseReached.update(!1),void o.completePhaseReached.update(!1);case Ce.uS.postCriticalAppPhaseReached:return void o.postCriticalPhaseReached.update(!0);case Ce.uS.completeAppPhaseReached:return void o.completePhaseReached.update(!0);case Ce.uS.resizeSlot:return void c.mutate({mutation:_e,variables:{slotName:null===(t=m.data)||void 0===t?void 0:t.call(m).slotName,width:null===(i=m.data)||void 0===i?void 0:i.call(m).width,windowId:d}});case Ce.uS.updateAmsV2Domain:const{amsV2Domain:e}=m.data();return void(o.amsV2Domain.read()!==e&&o.amsV2Domain.update(e||""));case Ce.uS.updateMeControlAvatarSrc:const{meControlAvatarSrc:l}=m.data();return void(o.meControlAvatarSrc.read()!==l&&o.meControlAvatarSrc.update(l||""));case Ce.uS.updateBaseImageUrl:const{baseImageUrl:g}=m.data();return u.log(`Received baseImageUrl core-layout event with data ${g}`),void(o.baseImageUrl.read()!==g&&(u.log(`Updating baseImageUrl app view state ${g}`),o.baseImageUrl.update(g||"")));case Ce.uS.updateIsImageAuthCookieValid:const{isImageAuthCookieValid:h}=(null===(n=m.data)||void 0===n?void 0:n.call(m))||{};return void(void 0!==h&&o.isImageAuthCookieValid.read()!==h&&o.isImageAuthCookieValid.update(h));case Ce.uS.showMonitor:return Promise.resolve({command:Te.CN.showMonitor(null===(s=(a=r.event).data)||void 0===s?void 0:s.call(a))});case Ce.uS.closeMonitor:return Promise.resolve({command:Te.CN.closeMonitor()});case Ce.uS.hideMonitor:return Promise.resolve({command:Te.CN.hideMonitor()});case Ce.uS.unhideMonitor:return Promise.resolve({command:Te.CN.unhideMonitor()});default:return u.error(`Unhandled event ${r}`),Promise.reject(new Error(`Unhandled event ${r.event.type}`))}}))};const Ne={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCoreLayoutResizeHeaderMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"height"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resizeHeaderSlot"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"height"},value:{kind:"Variable",name:{kind:"Name",value:"height"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},Ee={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCoreLayoutChangeSlotsVisibilityMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"slotNames"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SlotName"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isHidden"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeSlotsVisibility"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"slotNames"},value:{kind:"Variable",name:{kind:"Name",value:"slotNames"}}},{kind:"Argument",name:{kind:"Name",value:"isHidden"},value:{kind:"Variable",name:{kind:"Name",value:"isHidden"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},Fe={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCoreLayoutChangeMonitorSlotMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityAction"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityAction"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeMonitorSlotContent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"entityType"},value:{kind:"Variable",name:{kind:"Name",value:"entityType"}}},{kind:"Argument",name:{kind:"Name",value:"entityAction"},value:{kind:"Variable",name:{kind:"Name",value:"entityAction"}}},{kind:"Argument",name:{kind:"Name",value:"entityOptions"},value:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var xe=i(516909),De=i(243334);const Ae={eventHandlers:Ie,onCommandReceived:e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{commandInput:i,requestContext:{client:n,loggerFactory:a},slotDimensionsOptions:s,windowId:o}=e,{command:{action:r,actor:c,data:l}}=i,d=a.newLogger("CoreLayoutApp onCommandReceived","apps-core-layout");if(!(null===(t=je.actors)||void 0===t?void 0:t.includes(c)))return void d.error(`Command  ${i.command} is sent to the wrong App.`);const{header:{height:u}}=s,{collapsed:m,expanded:g}=u||{};switch(r){case Te.Nw.collapseHeader:n.mutate({mutation:Ne,variables:{height:m,windowId:o}});break;case Te.Nw.expandHeader:n.mutate({mutation:Ne,variables:{height:g,windowId:o}});break;case Te.Nw.expandTab:{const{excludeHeader:e}=l||{},t=e?[De.WL.NOTIFICATIONS,De.WL.SUBNAV]:[De.WL.HEADER,De.WL.NOTIFICATIONS,De.WL.SUBNAV];n.mutate({mutation:Ee,variables:{slotNames:t,windowId:o,isHidden:!0}});break}case Te.Nw.maximizeTab:n.mutate({mutation:Ee,variables:{slotNames:[De.WL.HEADER,De.WL.NAV,De.WL.NOTIFICATIONS,De.WL.SUBNAV,De.WL.TITLE_BAR],windowId:o,isHidden:!0}});break;case Te.Nw.resetLayoutOverrides:n.mutate({mutation:Ee,variables:{slotNames:[De.WL.HEADER,De.WL.NAV,De.WL.NOTIFICATIONS,De.WL.SUBNAV,De.WL.TITLE_BAR],windowId:o,isHidden:!1}});break;case Te.Nw.showMonitor:n.mutate({mutation:Fe,variables:{windowId:o,entityType:xe.pyR.floatingmonitor,entityAction:xe.ukP.view,entityOptions:JSON.stringify(i.command.data)}});break;case Te.Nw.closeMonitor:n.mutate({mutation:Fe,variables:{windowId:o,entityType:xe.pyR.floatingmonitor,entityAction:xe.ukP.leave}});break;case Te.Nw.hideMonitor:n.mutate({mutation:Ee,variables:{slotNames:[De.WL.MONITOR],windowId:o,isHidden:!0}});break;case Te.Nw.unhideMonitor:n.mutate({mutation:Ee,variables:{slotNames:[De.WL.MONITOR],windowId:o,isHidden:!1}});break;default:d.error(`Command action ${r} is not supported at CoreLayoutApp.`)}})),onViewUpdateCommandResolved:()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){})),viewStateRegistration:{gqlTypeName:"CoreLayoutAppViewState",queryFieldName:"coreLayoutAppViewState",navigationalFieldDefaultValues:{},nonNavigationalFieldDefaultValues:{amsV2Domain:"",baseImageUrl:"",completePhaseReached:!1,isImageAuthCookieValid:!1,meControlAvatarSrc:"",postCriticalPhaseReached:!1},computedValues:void 0}};const Me={[pe.py.meetings]:["com.microsoft.teams.calling","com.microsoft.teams.meeting-options"]},Pe=function(){const e=()=>null;return Object.assign(Object.assign({},Ae),{manifest:je,render:()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return Se.createElement(e,null)}))})}();class Oe{constructor(e,t,i){this._loadedTasksMap=new Map,this._appIdToAppMap=void 0,this._logger=e.newLogger("AppsRegistryService","core-services-activator"),this._loadedApps=[],this._entityTypeToAppMap=new Map,this._appsWithAppHistoryStored=[],this.initialize(i),this._reactiveValuesService=new ke(e,this,t)}get registeredApps(){return this._loadedApps}get registeredAppManifests(){return this._loadedApps.map((e=>e.manifest))}get registeredTasks(){return Array.from(this._loadedTasksMap.values())}get appsWithAppHistoryStored(){return this._appsWithAppHistoryStored}getApp({entityType:e,renderMode:t}){if(e||t)return this.registeredApps.find((i=>(!e||function({supportedEntities:e},t){return!(!e||-1===e.indexOf(t))}(i.manifest,e))&&(!t||function({supportedRenderModes:e},t){return!(!e||-1===e.indexOf(t))}(i.manifest,t))))}getAppViewStateForWindow(e,t){return this._reactiveValuesService.getAppViewStateForWindow(e,t)}getAppByID(e){var t;return null===(t=this._appIdToAppMap)||void 0===t?void 0:t.get(e)}getPlatformAppIdForEntity(e){const t=this._entityTypeToAppMap.get(e.type);if(void 0===t)return void this._logger.error("getPlatformAppIdForEntity: Platform id requested for entity which has no registered app in this experience.",{entityType:e.type});if(void 0===t.getPlatformAppIdForEntity)return void this._logger.debug("getPlatformAppIdForEntity: An app is registered for this entity but has no function for getPlatformAppIdForEntity.",{appName:t.manifest.name,entityType:e.type});let i;try{i=t.getPlatformAppIdForEntity(e)}catch(i){this._logger.error("getPlatformAppIdForEntity: Error caught from app handler while mapping the id for this entity.",{appName:t.manifest.name,entityType:e.type})}if(void 0!==i)return i;this._logger.debug("getPlatformAppIdForEntity: App mapped the id for this entity to undefined.",{appName:t.manifest.name,entityType:e.type})}getAppByActor(e){if(e)return this.registeredApps.find((t=>function({actors:e},t){return!(!e||-1===e.indexOf(t))}(t.manifest,e)))}getDefaultCommand(e,t){var i,n;const{coldBootAppId:a}=e.get(S.J.Edu),{coreColdBootAppId:s,coreColdBootFlyoutWindowAppId:o,enableEDUColdBootApp:r}=e.get(S.J.Core),c=r?a:t===ve.lO.minimode||t===ve.lO.minimal?o:s;if(c){this._logger.debug(`Using cold boot appId of ${c} with enableEDUColdBootApp ${r}`);const t=this.getAppByID(c),a=null===(n=null==t?void 0:(i=t.manifest).getDefaultCommand)||void 0===n?void 0:n.call(i,e);if(a)return a;this._logger.debug(`No default command found ${c}`)}for(const t of this.registeredAppManifests)if(t.getDefaultCommand){const i=t.getDefaultCommand(e);if(i)return this._logger.debug(`Found a default command in ${t.name}`),i}}resetAllViewState(e){this._reactiveValuesService.resetAllViewState(e)}setReactiveValuesForApp(e,t,i){this._reactiveValuesService.setReactiveValuesForApp(e,t,i)}getRegisteredAppsTypePolicies(e){return this._reactiveValuesService.getRegisteredAppsTypePolicies(e)}removeWindowViewState(e){this._reactiveValuesService.removeWindowViewState(e)}registerTask(e){this._loadedTasksMap.set(e.id,e)}initialize(e){const t=new Map;if(!(e&&e.length>0))throw new Error(`initialize::${h.jK.Empty} - No apps registered`);-1===e.findIndex((e=>e.manifest.id===Pe.manifest.id))&&e.length>0&&e.push(Pe),e.forEach((e=>{var i,n;if(t.has(e.manifest.id))throw new Error(`Multiple apps found for appId ${e.manifest.id}`);t.set(e.manifest.id,e),null===(i=e.manifest.supportedEntities)||void 0===i||i.forEach((t=>{const i=Me[t];if(!i||!i.includes(e.manifest.id)){if(this._entityTypeToAppMap.has(t))throw new Error(`Multiple apps found for entity ${t}`);this._entityTypeToAppMap.set(t,e)}})),e.onRegister&&e.onRegister({registerTask:this.registerTask.bind(this)}),(null===(n=e.onBeforeAddToNavigation)||void 0===n?void 0:n.shouldStoreLastVisitedInAppHistory)&&this._appsWithAppHistoryStored.push(e.manifest.id)})),this._loadedApps=Array.from(t.values()),this._appIdToAppMap=t}}var Re=i(530014);class Le extends Re.G{static fromExecutionError(e,t){return new Le({code:"EXECUTION_FAILURE",taskName:e,prevError:t})}static fromMissingDependencies(e,t){return new Le({code:"MISSING_DEPENDENCIES",taskName:e,dependencies:t,message:`${JSON.stringify(t)} are required, but not initialized.`})}constructor({code:e,taskName:t,prevError:i,dependencies:n,message:a}){super({type:"TaskError",code:e,prevError:i,message:a}),this.taskName=t,this.missingDependencies=n}getBoundaryProps(){return"EXECUTION_FAILURE"===this.code&&this.prevError instanceof Re.G?this.prevError.getBoundaryProps():super.getBoundaryProps()}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{taskName:this.taskName,prevError:this.prevError,missingDependencies:JSON.stringify(this.missingDependencies)})}toTelemetryCode(){var e;return`[${this.type}::${this.taskName}::${this.code}::${null===(e=this.missingDependencies)||void 0===e?void 0:e.join()}]`}static fromSerialized(e){if("TaskError"!==(null==e?void 0:e.type))return null;const t=new Le({code:e.code,taskName:e.taskName,prevError:e.prevError,dependencies:e.dependencies});return t.deserialize(e),t}}class Ue{constructor(e,t){this.id=e,this.name=h.Yg[e],this.dependencies=t}executeSafe(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=[];for(const t of this.dependencies)null==e[t]&&i.push(t);if(i.length>0)throw Le.fromMissingDependencies(this.name,i);try{return yield this.execute(e,t)}catch(e){throw Le.fromExecutionError(this.name,e)}}))}}var $e=i(354571);const We={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindowForEntity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindowForEntity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindow"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindow"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"entityFieldsForActiveWindow"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}}]}}]}.definitions]};var Be=i(782243),ze=i(5575),He=i(528714),qe=i(915929),Ve=i.n(qe),Ge=i(238446),Je=i(321781);const Ke=new Set([ve.ab,ve.Xt]),Qe=e=>"viewStateRegistration"in e,Ye=e=>Ke.has(e.manifest.id),Xe=e=>{var t,i,n,a,s,o,r;return null!==(o=null!==(a=null!==(i=null===(t=e.current)||void 0===t?void 0:t.subNavEntity)&&void 0!==i?i:null===(n=e.current)||void 0===n?void 0:n.headerEntity)&&void 0!==a?a:null===(s=e.current)||void 0===s?void 0:s.startEntity)&&void 0!==o?o:null===(r=e.current)||void 0===r?void 0:r.mainEntity},Ze=e=>e.manifest.id===ve.vC,et={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"executeEntityCommand"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"executionContext"}},type:{kind:"NamedType",name:{kind:"Name",value:"ExecutionContextInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"command"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityCommandInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clientLaunchId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"WindowOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"executeEntityCommand"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}},{kind:"Argument",name:{kind:"Name",value:"executionContext"},value:{kind:"Variable",name:{kind:"Name",value:"executionContext"}}},{kind:"Argument",name:{kind:"Name",value:"command"},value:{kind:"Variable",name:{kind:"Name",value:"command"}}},{kind:"Argument",name:{kind:"Name",value:"clientLaunchId"},value:{kind:"Variable",name:{kind:"Name",value:"clientLaunchId"}}},{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"entityOptions"},value:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}}},{kind:"Argument",name:{kind:"Name",value:"windowOptions"},value:{kind:"Variable",name:{kind:"Name",value:"windowOptions"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};function tt(e){return Object.assign(Object.assign({},e),{id:(t=e,t&&t.id||(0,qe.v4)()),startTimestamp:it(e),source:(null==e?void 0:e.source)||k.D.StandAlone});var t}function it(e){return e&&e.startTimestamp||Date.now()}function nt({appName:e,commandChangeReportingService:t,entityCommand:i,getCommandScenarioName:n,logger:a,coreSettings:s,clientPreferences:o}){const r=i.command.correlation,c=void 0===r.scenarioName||r.scenarioName===z.RG.EntityCommand;if(n&&c){try{r.scenarioName=n(i,a,s,o)}catch(i){t.report({type:Ge.B.Failure,context:{errorInfo:Je.y.GetCommandScenarioNameHookFailed,errorMessage:`App ${e} failed to execute entity command hook GetCommandScenarioName with ${i.name}`,target:"internal-command-handler"},correlationId:r.id})}a.log(`App ${e} is overwriting default scenario name to ${r.scenarioName} for command with entityType ${i.entity.type}`)}}function at(e){return Object.assign(Object.assign({},e),{command:st(e.command)})}function st(e){return Object.assign(Object.assign({},e),{correlation:tt(e.correlation)})}const ot={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CoreServicesActivatorIsEntityInActiveWindowQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isEntityInActiveWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}},{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};function rt(e,t,i,a,s,o){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enableIsEntityInViewByFocusedWindow:n}=o.get(S.J.Core);if(!n){return lt(yield ct(e,t,s),a,i,s)}{const n=function(e,t,i){const n=e.getValue().find((e=>{const i=!(!e||!e.window.document.hasFocus()),n=t.getState(),a=n===$e.pk.LongInactive||n===$e.pk.Inactive;return i&&!a}));return i.log(`Current window in focus is ${null==n?void 0:n.id}`),null==n?void 0:n.id}(a,i,s);if(s.log("Window in focus: ",n),!n)return s.log("There are no windows in focus"),!1;try{return(yield t.query({query:ot,variables:{entity:e,windowId:n},fetchPolicy:"no-cache"})).data.isEntityInActiveWindow}catch(e){return s.error("isEntityInActiveWindowQuery failed"),!1}}}))}function ct(e,t,i){var a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield t.query({query:We,variables:{entity:e},fetchPolicy:"no-cache"});return null===(a=i.data.activeWindowForEntity)||void 0===a?void 0:a.id}catch(t){return void i.error(`query for entity failed. Entity: ${JSON.stringify(e)}, Error: ${t}`)}}))}function lt(e,t,i,n){const a=t.getValue().find((t=>t.id===e)),s=!(!a||!a.window.document.hasFocus()),o=i.getState(),r=o===$e.pk.LongInactive||o===$e.pk.Inactive,c=s&&!r;return c||n.log(`isWindowInView: Window considered to be not in view. Window is inactive ${r}, window has focus: ${s}`),c}function dt(e){return function(e,t){return(0,Be.sanitize)(e,t)}(e,function(e,t){return{ADD_ATTR:e,ADD_TAGS:t,RETURN_TRUSTED_TYPE:!0,WHOLE_DOCUMENT:!0}}(["content","focusable","nonce","onclick"],["link","meta","script","#comment","!doctype"]))}function ut(e){var t,i;return[null!==(t=null==e?void 0:e.findScenario(z.RG.ClientStart))&&void 0!==t?t:null,null!==(i=null==e?void 0:e.findScenario(z.RG.ExperienceReady))&&void 0!==i?i:null]}function mt(e,t){return e instanceof Re.G?e:new ze.G(ze.$.UNKNOWN,e,t)}function gt(e,t,i,n){return pt.bind(void 0,e,t,i,n)}function ht(e,t){var i;const n=null===(i=null==t?void 0:t.get(S.J.Core))||void 0===i?void 0:i.enableStackTraceCollection;return{errorCode:e instanceof Re.G&&Re.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():void 0,stack:n&&e instanceof Re.G?e.stack:void 0}}function pt(e,t,i,a){var s,o,r,c;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n="";const l=null==e?void 0:e.host;l&&(n=`SessionId:\t${l.sessionId}\r\nDeviceId:\t${l.deviceId}\r\nHostVersion:\t${l.hostAppVersion}\r\n`);const d=null==e?void 0:e.config;d&&(n=`${n}WebVersion:\t${null==d?void 0:d.clientVersion}\r\n`);const u=null==t?void 0:t.locale;u&&(n=`${n}Language:\t${u}\r\n`);const m=null==a?void 0:a.get(S.J.Metadata);(null===(s=null==m?void 0:m.ring)||void 0===s?void 0:s.id)&&(n=`${n}Ring:\t${m.ring.id}\r\n`),(null==d?void 0:d.vdi)&&(n=`${n}Virtualization:\t${null===(o=null==d?void 0:d.vdi)||void 0===o?void 0:o.configFilter}\r\n`,n=`${n}vdiMode:\t${null===(r=null==d?void 0:d.vdi)||void 0===r?void 0:r.mode}\r\n`);const g=yield null===(c=null==i?void 0:i.getCachedUsers)||void 0===c?void 0:c.call(i,Object.assign(Object.assign({},tt({source:k.D.Core})),{scenarioName:z.RG.AuthWebCachedUser}));if(null==g?void 0:g.length){n=`${n}Logged in users:\r\n`;for(const e of g)n=`${n}\t${e.userName}  ${e.profile.name}  TId:${e.profile.tid}  OId:${e.profile.oid}  UserId:${e.id}\r\n`}return n}))}class vt{constructor(e,t,i,n,a,s,o,r,c,l,d,u){this._loggerFactory=e,this._appsRegistryService=t,this._config=i,this._configLoader=n,this._coreTasks=s,this._diagnosticsService=o,this._logsCollectorService=r,this._waitForRenderingContextReady=c,this._isEntityInView=l,this._criticalDynamicImports=d,this._getPlatformConfigurationOverrides=u,this._logger=e.newLogger("TaskManagerService","core-services-activator"),this._appsRegistryService=t,this._taskContext=this.createNewContext(a)}notifyLifeCycleEvent(e,t={},i){var a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=this.extractApplicableTasks(this._appsRegistryService.registeredTasks,e),o=`notify::starting - lifeCycleEvent=${e}, taskCount=${n.length}`;this._logger.log(o);const r=Object.assign(Object.assign({},this._taskContext),t);this.markCoreLifeCycleEventStart(r,e);const c={},l=null===(a=null===performance||void 0===performance?void 0:performance.timing)||void 0===a?void 0:a.navigationStart,d=new Map,u=[];let m=0;for(const t of n){const n=null===(s=null===performance||void 0===performance?void 0:performance.now)||void 0===s?void 0:s.call(performance),a=e=>{var i,n;const a=`notify:: Task Execute Error - taskId ${h.Yg[t.id]}, code=${e.code} errorMsg=${(0,oe.B9)((null==e?void 0:e.prevError)||e)}.`;null===(n=(i=this._logger).errorToTelemetry)||void 0===n||n.call(i,a,"webclient_framework_foundation_core_init",void 0,!0),d.set(t.id,e)},o=()=>t instanceof Ue?t.executeSafe(r,c):t.execute(r,c),g=e=>e?(0,H.E)(o(),e,`${h.Yg[t.id]} timed out.`):o(),p=yield g(this._config.coreTasksTimeoutMs).catch(a);p&&u.push({taskId:t.id,cleanupFn:p}),this.markCoreLifeCycleTaskCompleted(r,e,t,d,n,l,++m,i)}return this.logErrorSummary(e,d),this._logger.log(`notify::tasks complete - lifeCycleEvent=${e}, taskCount=${n.length}`),Object.assign(Object.assign(Object.assign({},c),r),{coreTaskErrors:Array.from(d.values()),cleanupFns:u})}))}destroyContext(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=e.cleanupFns.length;let n,a=0;for(;n=e.cleanupFns.pop();)try{yield n.cleanupFn(t),a++}catch(e){this._logger.error(`Cleanup failed for task: ${h.Yg[n.taskId]}`)}this._logger.log(`destroyContext complete: ${a}/${i} tasks succeeded.`)}))}hasTasks(e){return this.extractApplicableTasks(this._appsRegistryService.registeredTasks,e).length>0}markCoreLifeCycleEventStart(e,t){var i,n,a;const s=null===(i=e.altScenarioService)||void 0===i?void 0:i.altScenario,o=null===(n=e.altScenarioService)||void 0===n?void 0:n.clientStartScenario,r=`${j}${t}`;s||o?(s&&s.mark(r),o&&o.mark(r)):null===(a=null===performance||void 0===performance?void 0:performance.mark)||void 0===a||a.call(performance,r)}markCoreLifeCycleTaskCompleted(e,t,i,n,a,s,o,r){var c,l,d;const u=null===(c=e.altScenarioService)||void 0===c?void 0:c.altScenario,m=null===(l=e.altScenarioService)||void 0===l?void 0:l.clientStartScenario,g=n.get(i.id),p=ht(g).errorCode,v=`${t}_${h.Yg[i.id]}`;u||m?(u&&u.mark(`core_task_${v}`,g?{errorCode:p}:void 0),m&&m.mark(`core_task_${v}`,g?{errorCode:p}:void 0)):null===(d=null===performance||void 0===performance?void 0:performance.mark)||void 0===d||d.call(performance,`${C}${v}`),this.addTaskDetailsToLocalStorage(g||{},a,s,v,o,e),null==r||r(i.id,g)}addTaskDetailsToLocalStorage(e,t,i,n,a,s){var o;try{const{windowProvider:r,config:c}=s;c.shouldTrackCoreInitTasks&&(null==r||r.localStorage.setItem(n,(0,U.u4)({index:a,startTime:new Date(i+t).toISOString(),duration:(null===(o=null===performance||void 0===performance?void 0:performance.now)||void 0===o?void 0:o.call(performance))-t,error:e})))}catch(e){e.code===DOMException.QUOTA_EXCEEDED_ERR?this._logger.error("Error: Quota exceeded while writing core task details to local storage."):this._logger.warn(`Couldn't write core init task details to local storage: ${(0,oe.B9)(e)}`)}}createNewContext(e){return{correlation:e,diagnosticsService:this._diagnosticsService,logsCollectorService:this._logsCollectorService,loggerFactory:this._loggerFactory,appsRegistryService:this._appsRegistryService,config:this._config,configLoader:this._configLoader,waitForRenderingContextReady:this._waitForRenderingContextReady,isEntityInView:this._isEntityInView,criticalDynamicImports:this._criticalDynamicImports,getPlatformConfigurationOverrides:this._getPlatformConfigurationOverrides}}extractApplicableTasks(e,t){var i,n;const a=[];if(e){const i=e.filter((e=>!e.lifeCycleSubscriptions&&t===h.sM.Initialization||e.lifeCycleSubscriptions&&-1!==e.lifeCycleSubscriptions.indexOf(t)));a.push(...i)}return((null===(n=(i=this._coreTasks)[t])||void 0===n?void 0:n.call(i))||[]).concat(a)}logErrorSummary(e,t){if(t.size>0){const i=(0,oe.Tr)("TaskManagerService",h.jK.NotInitialized,`lifeCycleEvent=${e}`,{failedTaskErrors:t});this._logger.error(`Failed ${t.size} core tasks: ${Array.from(t.keys()).map((e=>h.Yg[e])).join()}, lifeCycleEvent=${e}: `,i)}}}const ft={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"windowOptionsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowOptions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"left"}},{kind:"Field",name:{kind:"Name",value:"top"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]},bt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subNavEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"headerEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"startEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"monitorEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"inAppNotificationsEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"entityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"clientLaunchId"}}]}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}},{kind:"Field",name:{kind:"Name",value:"isNotificationsWindow"}},{kind:"Field",name:{kind:"Name",value:"isInitialWindowStateHidden"}},{kind:"Field",name:{kind:"Name",value:"userContextId"}},{kind:"Field",name:{kind:"Name",value:"layoutConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"layoutMode"}},{kind:"Field",name:{kind:"Name",value:"isFullscreen"}},{kind:"Field",name:{kind:"Name",value:"slots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"header"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"subNav"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"notifications"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowOptionsFields"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"entityFieldsForActiveWindows"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowOptionsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"linkedEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}}]}},{kind:"Field",name:{kind:"Name",value:"entityState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"flushableByLinkedEntity"}}]}}]}},...ft.definitions]}.definitions,...ft.definitions]},yt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"authenticationUsersEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsersEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cloud"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"puid"}}]}},{kind:"Field",name:{kind:"Name",value:"subType"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"loginUserName"}},{kind:"Field",name:{kind:"Name",value:"homeAccountId"}}]}}]}}]}}]},kt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationUsers"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cloud"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"puid"}}]}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"subType"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"loginUserName"}},{kind:"Field",name:{kind:"Name",value:"homeAccountId"}}]}}]}}]};var St=i(690344);const wt=new Set([p.G5.quit,p.G5.restart]);function jt({hostCommunicationService:e,logger:t,reason:i,renderingContextManager:a}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let s;const o=a.getDefaultRenderingContext();switch((null==o?void 0:o.scenarioFactory)&&(s=_t(i,o.scenarioFactory)),i){case"quit":try{yield a.removeAllRenderingContexts(i),null==s||s.mark(z.ck.RemoveAllRenderingContexts),yield function(e,t,i){var a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n,s;try{n=yield t.loadModule("core")}catch(e){s="LoadModuleCoreFailed"}try{yield null===(a=null==n?void 0:n.reportReadyToQuit)||void 0===a?void 0:a.call(n)}catch(e){s="ReportReadyToQuitFailed"}s&&Nt(s,e,i)}))}(t,e,s),null==s||s.stop()}catch(e){It(e,t,s)}break;case"restart":try{yield a.cleanupWithPriority(i),null==s||s.stop()}catch(e){It(e,t,s)}break;default:return}}))}function Ct({coreSettings:e,logger:t,reason:i,renderingContextManager:a,user:s}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n;try{const t=s&&(0,He.b4)(s);if(!t)throw new ze.G(ze.$.CLEANUP,new Error("signout::UserContextIdNotFound"));const o=yield a.getUserRenderingContext(t);(null==o?void 0:o.scenarioFactory)&&(n=_t(i,o.scenarioFactory)),yield a.removeUserRenderingContext(i,t),null==n||n.mark(z.ck.RemoveUserRenderingContext);if(!e.get(S.J.Auth).isLegacyCleanupCodeFlag){const e=["TestCookie","ringFinder"];!function(e){try{(0,R.J)().sessionStorage.clear()}catch(t){Tt(e,"ClearSessionStorageFailed")}}(n),function(e,t){try{Object.keys(St.getJSON()).forEach((t=>{e.includes(t)||St.remove(t)}))}catch(e){Tt(t,"DeleteCookiesFailed")}}(e,n)}null==n||n.stop()}catch(e){It(e,t,n)}}))}function _t(e,t){const i=t.newScenario(z.RG.CoreCleanup),n={reason:e};return i.appendEventData(n),i}function Tt(e,t){const i={errorCode:t};e&&e.fail(i)}function It(e,t,i){const n="UnknownCleanupFailure";let a;a=e instanceof ze.G&&Re.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():e instanceof Error?`${ze.$.CLEANUP}::${n}::${null==e?void 0:e.name}::${null==e?void 0:e.message}`:`${ze.$.CLEANUP}::${n}::${(0,U.u4)(e)}`,Nt(a,t,i)}function Nt(e,t,i){var n;i&&Tt(i,e),null===(n=t.errorToTelemetry)||void 0===n||n.call(t,e,"webclient_framework_foundation_core_services",void 0,!0)}var Et=i(382433),Ft=i(609901),xt=i(586335),Dt=i(293033),At=i(793377),Mt=i(218551);class Pt{constructor(e,t,i){this.eventHandler=e,this.commandHandler=t,this.commandDelegator=i}bubble(e){return this.eventHandler(e,this.commandHandler,this.commandDelegator)}}const Ot="internal-event-handler",Rt=({commandChangeReportingService:e,correlation:t,type:i})=>{if(i===Ge.B.DelegatedCommandReceived)e.report({type:i,correlationId:t.id,context:{target:Ot,correlation:t}});else e.report({type:i,correlationId:t.id,context:{target:Ot}})},Lt=({commandChangeReportingService:e,correlation:t,errorInfo:i=Je.y.DelegatedCommandError,errorMessage:n,logger:a})=>{var s;null===(s=a.errorToTelemetry)||void 0===s||s.call(a,n,"webclient_framework_foundation_core_services_internal_command_delegator",void 0,!0),e.report({correlationId:t.id,type:Ge.B.Failure,context:{target:Ot,errorMessage:n,errorInfo:i}})};var Ut=i(281423);const $t=({appsRegistryService:e,client:t,clientPreferences:i,commandChangeReportingService:a,commandHandler:s,commandInput:o,coreSettings:r,executionContext:c,loggerFactory:l,scenarioFactory:d,shortcutExecutionService:u,windowId:m,host:g,userBiService:p})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const v=l.newLogger("internalCommandDelegator","core-services-entity-commanding"),f=o.correlation||tt();Rt({commandChangeReportingService:a,correlation:f,type:Ge.B.DelegatedCommandReceived});const b=function(e,t){return e.getAppByActor(t.command.actor)}(e,o);if(!b){const e=`Command for actor ${o.command.actor} does not map to any registered app.`;return Lt({commandChangeReportingService:a,correlation:f,errorMessage:e,logger:v}),Promise.resolve(void 0)}if(!b.onCommandReceived){const e=`Command for actor ${o.command.actor} maps to app ${b.manifest.name}, but the app hasn't registered onCommandReceived handler.`;return Lt({commandChangeReportingService:a,correlation:f,errorMessage:e,logger:v}),Promise.resolve(void 0)}const{navigationalReactiveValues:y,nonNavigationalReactiveValues:k}=e.getAppViewStateForWindow(m||h.ew,b.manifest.id)||{};let S=!1,w={};y&&(w=Object.keys(y).reduce(((e,t)=>{const i=y[t];return Object.assign(Object.assign({},e),{[t]:{read:i.read,update:e=>{e!==i.read()&&(i.update(e),S=!0)}}})}),{}));const j=function(e,t,i,n,a,s,{viewEntitiesRef:o,viewEntity:r}={},c,l){var d,u,m;const g=o&&Xe(o);return{client:e,clientPreferences:t.getAllPreferences(),coreSettings:i,loggerFactory:n,scenarioFactory:a,shortcutExecutionService:l,executionContext:{viewEntities:{endEntity:null===(d=null==o?void 0:o.current)||void 0===d?void 0:d.endEntity,mainEntity:null===(u=null==o?void 0:o.current)||void 0===u?void 0:u.mainEntity},viewEntity:r,isHandlingAppActiveApp:!!g&&(null===(m=s.getApp({entityType:g.type}))||void 0===m?void 0:m.manifest.id)===c}}}(t,i,r,l,d,e,c,b.manifest.id,u);let C;try{const e={commandInput:o,requestContext:j};Rt({commandChangeReportingService:a,correlation:f,type:Ge.B.BeforeOnCommandReceived});const i=Object.assign(Object.assign({},w),k);C=yield(({delegatedApp:e,reactiveValues:t,hookOptions:i,host:a,windowId:s,userBiService:o})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(!e.onCommandReceived)return Promise.resolve(void 0);if(Qe(e)&&Ye(e)){if(t){const n=Object.assign(Object.assign({},i),{appViewState:t,host:a,slotDimensionsOptions:De.Vi,windowId:s,userBiService:o});return e.onCommandReceived(n)}}else{if(!Qe(e)){if(Ye(e)){const t=Object.assign(Object.assign({},i),{windowId:s,slotDimensionsOptions:De.Vi});return e.onCommandReceived(t)}return e.onCommandReceived(i)}if(t){const n=Object.assign(Object.assign({},i),{appViewState:t});return e.onCommandReceived(n)}}return Promise.resolve(void 0)})))({delegatedApp:b,reactiveValues:i,hookOptions:e,host:g,windowId:m,userBiService:p}),S&&(t.mutate({mutation:Ut.E,variables:{windowId:m,appIds:[b.manifest.id]}}).catch((e=>{v.warn(`saveReactiveVarToHistory failed ${e.message}`)})),S=!1),Rt({commandChangeReportingService:a,correlation:f,type:Ge.B.AfterOnCommandReceived})}catch(e){const t=`Command for actor ${o.command.actor} encountered an error inside onCommandReceived of ${b.manifest.name}.`;return Lt({commandChangeReportingService:a,correlation:f,errorMessage:t,logger:v}),Promise.reject(e)}if(!C)return Rt({correlation:f,commandChangeReportingService:a,type:Ge.B.CommandHandledByOnCommandReceived}),Promise.resolve(void 0);const _=Object.assign(Object.assign({},C),{command:Object.assign(Object.assign({},C.command),{correlation:f})});s(_)}));var Wt=i(127097);const Bt="internal-event-handler",zt=({commandChangeReportingService:e,correlation:t,type:i})=>{if(i===Ge.B.EventBubbled)e.report({type:i,correlationId:t.id,context:{target:Bt,correlation:t}});else e.report({type:i,correlationId:t.id,context:{target:Bt}})},Ht=({commandChangeReportingService:e,correlation:t,errorMessage:i,logger:n})=>{var a;const s=Je.y.EventError;null===(a=n.errorToTelemetry)||void 0===a||a.call(n,i,"webclient_framework_foundation_core_services_internal_event_handler",void 0,!0),e.report({correlationId:t.id,type:Ge.B.Failure,context:{target:Bt,errorMessage:i,errorInfo:s}})},qt=["MeControlCore","MeControlMeAccount","MeControlMTMA"],Vt=({appsRegistryService:e,client:t,clientPreferences:i,commandChangeReportingService:a,commandDelegator:s,commandHandler:o,coreSettings:r,eventInput:c,executionContext:l,loggerFactory:d,notificationsHandler:u,scenarioFactory:m,shortcutExecutionService:g,userBiService:p,windowId:v,hostCommunicationService:f})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var b;const y=d.newLogger("internalEventHandler","core-services-entity-commanding");let k=function(e,t){var i;return t?t&&e.getApp({entityType:null===(i=t.viewEntity)||void 0===i?void 0:i.type}):e.getAppByID(ve.ab)}(e,l);const S=((e,t,i,n,a,s)=>{var o;const{scenarioName:r,id:c,source:l}=(null===(o=null==t?void 0:t.getEventScenarioData)||void 0===o?void 0:o.call(t,e,n,a,s))||{},d=tt({id:c,scenarioName:r,source:l,startTimestamp:Date.now()});return zt({commandChangeReportingService:i,correlation:d,type:Ge.B.EventBubbled}),d})(c,k,a,y,r,i);if("com.microsoft.teams.search"===(null==k?void 0:k.manifest.id)&&qt.includes(c.event.originator)&&(k=e.getApp({renderMode:Wt.e.TitleBar})),!k){return Ht({commandChangeReportingService:a,correlation:S,errorMessage:"Error mapping event to slot.",logger:y}),Promise.resolve(void 0)}if(!(null===(b=k.eventHandlers)||void 0===b?void 0:b.onEventReceived)){const e=`Event '${c.event.type}' was received for app ${k.manifest.name}, but it hasn't registered an event handler.`;return Ht({commandChangeReportingService:a,correlation:S,errorMessage:e,logger:y}),Promise.resolve(void 0)}const w=function(e,t,i,n,a,s,o,{viewEntitiesRef:r,viewEntity:c}={},l,d,u){var m,g,h;const p=r&&Xe(r);return{client:e,clientPreferences:t.getAllPreferences(),coreSettings:i,hostCommunicationService:u,loggerFactory:n,scenarioFactory:a,shortcutExecutionService:d,userBiService:s,executionContext:{viewEntities:{endEntity:null===(m=null==r?void 0:r.current)||void 0===m?void 0:m.endEntity,mainEntity:null===(g=null==r?void 0:r.current)||void 0===g?void 0:g.mainEntity},viewEntity:c,isHandlingAppActiveApp:!!p&&(null===(h=o.getApp({entityType:p.type}))||void 0===h?void 0:h.manifest.id)===l}}}(t,i,r,d,m,p,e,l,k.manifest.id,g,f);let j;try{const i={eventInput:c,requestContext:w};zt({correlation:S,commandChangeReportingService:a,type:Ge.B.BeforeOnEventReceived});const{navigationalReactiveValues:s,nonNavigationalReactiveValues:o}=e.getAppViewStateForWindow(v||h.ew,k.manifest.id)||{};let r=!1,l={};s&&(l=Object.keys(s).reduce(((e,t)=>{const i=s[t];return Object.assign(Object.assign({},e),{[t]:{read:i.read,update:e=>{e!==i.read()&&(i.update(e),r=!0)}}})}),{}));const d=(l||o)&&Object.assign(Object.assign({},l),o);j=yield(({sourceApp:e,reactiveValues:t,hookOptions:i,notificationsHandler:a,windowId:s})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n;let o;if(!(null===(n=e.eventHandlers)||void 0===n?void 0:n.onEventReceived))return Promise.resolve(void 0);if(Qe(e)&&Ye(e)){if(t){const n=Object.assign(Object.assign({},i),{appViewState:t,windowId:s});o=yield e.eventHandlers.onEventReceived(n)}}else if(Qe(e)){if(t){const n=Object.assign(Object.assign({},i),{appViewState:t});o=yield e.eventHandlers.onEventReceived(n)}}else if(Ye(e)){const t=Object.assign(Object.assign({},i),{windowId:s});o=yield e.eventHandlers.onEventReceived(t)}else if(Ze(e)&&a){const t=Object.assign(Object.assign({},i),{notificationsHandler:a});o=yield e.eventHandlers.onEventReceived(t)}else o=yield e.eventHandlers.onEventReceived(i);return Promise.resolve(o)})))({sourceApp:k,reactiveValues:d,hookOptions:i,notificationsHandler:u,windowId:v}),r&&(t.mutate({mutation:Ut.E,variables:{windowId:v,appIds:[k.manifest.id]}}).catch((e=>{y.warn(`saveReactiveVarToHistory mutation failed ${e.message}`)})),r=!1),zt({correlation:S,commandChangeReportingService:a,type:Ge.B.AfterOnEventReceived})}catch(e){const t=`Event '${c.event.type}' encountered an error inside onEventReceived of ${k.manifest.name}.`;return Ht({commandChangeReportingService:a,correlation:S,errorMessage:t,logger:y}),Promise.reject(e)}if(!j)return zt({correlation:S,commandChangeReportingService:a,type:Ge.B.EventHandled}),Promise.resolve(void 0);const C=Object.assign(Object.assign({},j),{correlation:S});return s(C,o)}));var Gt=i(344207);const Jt="DeepLink:: ";var Kt,Qt;!function(e){e.DecodeURIComponentFailed="DecodeURIComponentFailed",e.DeeplinkNotHandledByRegisteredApps="DeeplinkNotHandledByRegisteredApps",e.DeeplinkTerminatedByApp="DeeplinkTerminatedByApp",e.ExecuteFromUrlFailed="ExecuteFromUrlFailed",e.IntentServiceExecutionFailed="IntentServiceExecutionFailed",e.InvalidDeepLinkUrl="InvalidDeepLinkUrl",e.OnBeforeDeeplinkParsedFailed="OnBeforeDeeplinkParsedFailed",e.ToNavigationIntentFailed="ToNavigationIntentFailed",e.InvalidOrigin="InvalidOrigin"}(Kt||(Kt={})),function(e){e.NavigationIntentNotFound="NavigationIntentNotFound"}(Qt||(Qt={}));var Yt=i(80719),Xt=i(628556);const Zt="https://teams.microsoft.com/l",ei="/task/",ti="/stage/",ii="/entity/",ni="context",ai="application/vnd.microsoft.card.adaptive",si=(e,t,i)=>{const n=e=>null==i?void 0:i(e);return e.executeCommand(t.entity,{entityCommand:t.command,entityOptions:t.entityOptions}).subscribe({complete:n,error:n}),Promise.resolve()},oi=(e,t,i,n,a,s)=>{const o=e.executeCommand(t.entity,{entityCommand:t.command,entityOptions:t.entityOptions}),r=i.newScenario(z.RG.ExtTaskModuleLaunch),c=Yt.gV.DeepLink;return o.subscribe({complete:()=>{n.log(`task module complete for entrypoint ${c}`),r.stop(li(a,c)),s&&s()},error:e=>{n.error(`error launching task module for entry point ${c}.  Error:`,e),r.fail(li(a,c,e)),s&&s(e)},next:e=>{e.containerState===ve.oq.Open&&r.stop(li(a,c))}}),Promise.resolve()},ri=(e,t)=>{const i=new URL(e).pathname.split("/");if(i.length===t){const[,,e,t,n]=i;return!(!e||!t)}return!1},ci=e=>!(!e||!e.startsWith(Zt)),li=(e,t,i)=>{const n={};return e&&(n["App.Id"]=e),t&&(n["App.EntryPoint"]=Yt.gV[t]),i&&(n.errors=i),n},di=(e,t)=>{if(!t)throw new Error("Could not find app context");switch(e.type){case pe.py.extensions:return Object.assign(Object.assign({},t),{type:Xt.p.tab});case pe.py.channels:return Object.assign(Object.assign({},t),{type:Xt.p.channel});case pe.py.chats:return Object.assign(Object.assign({},t),{type:Xt.p.chat});default:throw new Error("unsupported launch context")}},ui=e=>!!e&&"0"!==e,mi=e=>e?JSON.parse(e):{},gi=(e,t)=>{switch(e&&e.type){case pe.py.extensions:return vi(e);case pe.py.chats:return{chatId:e.id||""};case pe.py.channels:{const{channelId:i,replyChainId:n}=mi(e.id);return{channelId:i,parentMessageId:n,chatId:pi(n,i,t),meetingId:hi(i,n),channelMeetingMessageId:n}}default:return}},hi=(e,t)=>{if(e){const i=e.split(";")[0];return ui(t)?btoa(`0#${i}#${t}`):btoa(`0#${i}#0`)}return""},pi=(e,t,i)=>ui(e)&&i?t.includes("messageid")?t:`${t};messageid=${e}`:t,vi=e=>{if(e.linkedEntity)switch(e.linkedEntity.type){case pe.py.chats:return{chatId:e.linkedEntity.id};case pe.py.channels:{const{channelId:t,replyChainId:i}=mi(e.linkedEntity.id);return{channelId:t,parentMessageId:i,channelMeetingMessageId:i}}case pe.py.extensions:return e.linkedEntity.id?JSON.parse(e.linkedEntity.id):void 0}},fi=(e,t)=>{const i=e.search.indexOf("=")+1,n=e.search.substring(i)||"",a=decodeURIComponent(n),{contentUrl:s,websiteUrl:o,removeUrl:r,name:c}=JSON.parse(a);return{type:"tab/tabInfoAction",tabInfo:{contentUrl:s,websiteUrl:o,removeUrl:r,name:c,entityId:t}}},bi=e=>{const t=e.search.indexOf("?")+1;return(e.search.substring(t)||"").split("&").reduce(((e,t)=>{const[i,n]=t.split("="),a=decodeURIComponent(n);return Object.assign(Object.assign({},e),{[i]:(0,B.isString)(i)&&"card"===i.toLowerCase()?yi(a):a})}),{})},yi=e=>{try{const t=JSON.parse(e),i=(0,B.isString)(t.contentType)&&t.contentType.toLowerCase()===ai.toLowerCase(),n=(0,B.isString)(t.type)&&"adaptivecard"===t.type.toLowerCase();return i?{content:JSON.stringify(t.content),contentType:t.contentType}:n?{content:e,contentType:ai}:null}catch(e){return null}};class ki{constructor(e,t,i,n,a,s,o,r,c,l){this.host=e,this.commandHandler=t,this.extensionCommandingService=i,this.scenarioFactory=n,this.deeplinkService=s,this.coreSettings=o,this.userContextId=r,this.sourceViewEntity=c,this.clientLaunchId=l,this.logger=a.newLogger("DeepLinkCommandingService","core-services-entity-commanding")}checkForPendingDeeplink(e,t){return this.deeplinkService.checkForPendingIntent(e,this.clientLaunchId,null!=t?t:this.userContextId)}launchMainApp(e,t,i){return this.deeplinkService.launchMainApp(e,this.clientLaunchId,t,i)}launchMinimode(e,t){return this.deeplinkService.launchMinimode(e,this.clientLaunchId,t)}switchAccount(e,t,i,n,a){return this.deeplinkService.switchAccount(e,t,this.clientLaunchId,i,n,a)}prewarmFlyout(e){return this.deeplinkService.prewarmFlyout(e)}prewarmMinimode(e){return this.deeplinkService.prewarmFlyout(e,!0)}executeFromUrlV2(e,t,i,a){var s,o;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.allowV2Flow(e))return!1;try{return yield this.deeplinkService.executeFromUrlAsync(e,t,i,this.clientLaunchId,this.userContextId,this.sourceViewEntity,a)}catch(e){const t=`DeepLinkCommanding:: ${Kt.ExecuteFromUrlFailed} ${(0,U.u4)(e)}`;throw null===(o=(s=this.logger).errorToTelemetry)||void 0===o||o.call(s,t,"webclient_framework_foundation_core_services_deeplink",void 0,!0),new Error(t)}}))}executeDeepLinkFromUrl(e,t,i,a,s){var o,r,c,l;return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.coreSettings.get(S.J.Core).forceHostOpenForDeepLink&&this.host.open(e);const n=!!(null===(o=this.coreSettings.get(S.J.Core))||void 0===o?void 0:o.handleInternalDeepLinks),d=!!(null===(r=this.coreSettings.get(S.J.Extensibility))||void 0===r?void 0:r.enableChatIdChangeInGetContextCall);try{if(yield this.executeFromUrlV2(e,i,void 0,s))return}catch(e){null===(l=(c=this.logger).errorToTelemetry)||void 0===l||l.call(c,null==e?void 0:e.message,"webclient_framework_foundation_core_services_deeplink",void 0,!0)}const u=this.createEntityCommandFromDeepLink(e,t,d);return u?((e,t,i,n,a,s,o)=>{switch(e.entity.type){case pe.py.taskmodule:const r=new URL(t),[,,,c]=r.pathname.split("/");return oi(n,e,s,a,c,o);case pe.py.platformStage:return si(n,e,o);default:return i(e)}})(u,e,this.commandHandler,this.extensionCommandingService,this.logger,this.scenarioFactory,a):n?void this.host.open(e):this.host.opener.open(Gt.B.OpenOnMainRenderer,Gt._.DeepLink,{url:e})}))}executeIntent(e){var t;return this.deeplinkService.executeIntent(Object.assign(Object.assign({},e),{metadata:Object.assign({userContextId:null!==(t=e.metadata.userContextId)&&void 0!==t?t:this.userContextId},e.metadata)}))}createEntityCommandFromDeepLink(e,t,i){return(e=>ri(e,4))(e)&&(e=>{if(ci(e))return e.substr(29).toLowerCase().substring(0,6)===ei;return!1})(e)?((e,t,i)=>{const n=(0,qe.v4)(),a=new URL(e),[,,,s]=a.pathname.split("/"),o={entryPoint:Yt.gV.DeepLink,appId:s,taskInfo:bi(new URL(e))};return{entity:{id:n,type:pe.py.taskmodule,action:pe.uk.create},command:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:k.D.ExtensionCommanding}},entityOptions:{input:o,launchContext:di(t,gi(t,i))}}})(e,t,i):(e=>ri(e,5))(e)&&(e=>!!ci(e)&&e.substr(29).toLowerCase().substring(0,7)===ti)(e)?(e=>{try{const t=new URL(e),[,,,i]=t.pathname.split("/"),n=(0,qe.v4)();return{entity:{id:n,type:pe.py.platformStage,action:pe.uk.view},command:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:k.D.ExtensionCommanding}},entityOptions:{appId:i,tabInfo:JSON.stringify(fi(t,n))}}}catch(e){return null}})(e):null}allowV2Flow(e){var t;return!!(this.coreSettings.get(S.J.Extensibility).handleDeepLinkToMeetingSidePanel&&(e=>{if(!ri(e,5))return!1;const{searchParams:t}=new URL(e),i=t.has(ni)&&t.get(ni);if(!i)return!1;try{const e=JSON.parse(decodeURIComponent(i));return!(!e||!e.chatId||"chat"!==e.contextType&&"meeting"!==e.contextType||"false"===t.get("openInMeeting"))}catch(e){return!1}})(e)&&(e=>!!ci(e)&&e.substring(29).toLowerCase().substring(0,8)===ii)(e))||!!(null===(t=this.coreSettings.get(S.J.Core))||void 0===t?void 0:t.handleInternalDeepLinks)}}var Si=i(442755),wi=i(485346),ji=i(816439),Ci=i(266233),_i=i(228846),Ti=i(545618);const Ii={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CoreServicesEntityCommandingActiveWindowContainerStateQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}}]}}]},Ni={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindowBlockingExtension"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"blockingEntityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]}}]},Ei={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"addBlockingExtension"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"removeBlock"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addBlockingExtension"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}},{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"entityOptions"},value:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}}},{kind:"Argument",name:{kind:"Name",value:"removeBlock"},value:{kind:"Variable",name:{kind:"Name",value:"removeBlock"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};class Fi{constructor(e,t,i,n,a,s,o){this.commandHandler=e,this.client=t,this.windowId=i,this.scenarioFactory=n,this._coreSettings=s,this._windowLayoutService=o,this.subscribers=[],this.onDestroy=new _i.xQ,this.logger=a.newLogger("ExtensionCommandingService","core-services-entity-commanding")}destroy(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{this.onDestroy.next(),this.reset()}catch(e){this.logger.warn(`Unable to destroy, error ocurred in persisting delete of extension entity. e.name: ${e.name}, e.message: ${e.message}`)}}))}executeCommand(e,t){const i=(null==t?void 0:t.entityCommand)||{stateTransition:ve.su.none,visibilityState:ve.fe.show,correlation:{source:k.D.ExtensionCommanding}};i.stateTransition=ve.su.extend;const n={entity:e,command:i,entityOptions:null==t?void 0:t.entityOptions};return this.processRequest(n)}addBlockingExtension(e,t,i=!1){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!i&&(yield this.isWindowBlocked()))return void this.logger.log("Window is currently blocked, addBlockingExtension no-op");this.logger.log(`addBlockingExtension, requesting an extension of type ${e.type} to block the window`);const n={entity:e,entityOptions:JSON.stringify(t),windowId:this.windowId,removeBlock:i};yield this.client.mutate({mutation:Ei,variables:n})}))}isBlockedByEntity(e){return this._windowLayoutService.modalManager.isBlockedByEntity(e)}isWindowBlocked(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enableDecoupleCommandingFromApollo:e}=this._coreSettings.get(S.J.Core);if(e)return this._windowLayoutService.modalManager.isBlockingEntityExtension();const{data:t}=yield this.client.query({query:Ni,variables:{windowId:this.windowId}});return!!t.activeWindow.blockingEntityExtension}))}pipeWhileStateIsValid(e,t){return e.pipe((0,Si.R)(this.onDestroy),(0,wi.o)((e=>e.hasEntityExtension),!0),t,(0,ji.G)(),(0,wi.o)((([e,t])=>{const i=t.containerState,n=t.hasEntityExtension,a=e.containerState,s=i===ve.oq.Confirmed,o=i===ve.oq.Cancelled,r=i===ve.oq.Error,c=i===ve.oq.Closed,l=a===ve.oq.Open;return n&&!s&&!o&&!r&&!(l&&c)}),!0),(0,l.U)((([,e])=>({containerState:e.containerState}))))}processRequest(e){this.scenarioFactory.newScenario(z.RG.ExtensionOpen);const t=this._windowLayoutService.enableDecoupleCommandingFromApollo,i=t?this._windowLayoutService.modalManager.observeContainerState().pipe():this.observeContainerState(this.client,this.windowId),n=this.pipeWhileStateIsValid(i,t?(0,Ci.O)({hasEntityExtension:!1,containerState:ve.oq.Closed}):(0,g.b)());this.commandHandler(e).then((()=>{n.subscribe({next:e=>{this.stopActiveScenario(e.containerState),this.nextSubscriber(e),e.containerState===ve.oq.Error&&this.resetSubscriber((0,oe.Tr)("ExtensionCommanding",h.jK.Unknown,`ExtendedContainerState ${e.containerState}`,void 0,"Error processing entity extension"))},complete:()=>{this.resetSubscriber()},error:e=>{this.resetSubscriber(e)}})})).catch((e=>{this.resetSubscriber(e)}));return new Ti.y((e=>{this.subscribers.push(e)}))}nextSubscriber(e){this.subscribers.forEach((t=>t.next(e)))}resetSubscriber(e){const t=this.subscribers;this.reset(),e?(this.failActiveScenarios(),t.length&&t.forEach((t=>t.error(e)))):(this.stopActiveScenarios(),t.length&&t.forEach((e=>e.complete())))}reset(){this.subscribers=[]}stopActiveScenarios(){var e,t;null===(e=this.scenarioFactory.findScenario(z.RG.ExtensionClose))||void 0===e||e.stop(),null===(t=this.scenarioFactory.findScenario(z.RG.ExtensionOpen))||void 0===t||t.stop()}failActiveScenarios(){var e,t;null===(e=this.scenarioFactory.findScenario(z.RG.ExtensionClose))||void 0===e||e.fail(),null===(t=this.scenarioFactory.findScenario(z.RG.ExtensionOpen))||void 0===t||t.fail()}stopActiveScenario(e){switch(e){case ve.oq.Error:this.failActiveScenarios();break;case ve.oq.Open:case ve.oq.Closed:case ve.oq.Cancelled:case ve.oq.Confirmed:this.stopActiveScenarios();break;default:this.logger.errorToTelemetry&&this.logger.errorToTelemetry(`Unable to stop active scenario, no case mapped to container state provided: ${e}`,"webclient_framework_foundation_core_services_extension_commanding",void 0,!0)}}observeContainerState(e,t){return(0,he.G)(this.watchActiveWindow(e,t)).pipe((0,l.U)((({data:e})=>{var t;return{containerState:e.activeWindow.extendedEntityContainerState.containerState,hasEntityExtension:!!(null===(t=e.activeWindow.activeEntities.entityExtension)||void 0===t?void 0:t.type)}})))}watchActiveWindow(e,t){return e.watchQuery({query:Ii,variables:{windowId:t}})}}const xi=({appsRegistryService:e,client:t,commandChangeReportingService:i,coreSettings:a,entityCommandInput:s,executionContext:o,loggerFactory:r,platformService:c,scenarioFactory:l,windowId:d,clientLaunchId:u,windowProvider:m,userBiService:g,notificationsHandler:h,clientPreferences:p,userTrackingService:v})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var f,b;const y=r.newLogger("internalCommandHandler","core-services-entity-commanding"),S=null!==(b=null===(f=s.command)||void 0===f?void 0:f.__UNSAFE_windowId)&&void 0!==b?b:d;S!==d&&y.log(`window id overridden to ${S}`);let w=at(function(e){const t=e.command||st({stateTransition:ve.su.none,visibilityState:ve.fe.show,correlation:{source:k.D.Unknown}});return Object.assign(Object.assign({},e),{command:t})}(s));const j=function(e,t){var i;return t&&e.getApp({entityType:null===(i=t.viewEntity)||void 0===i?void 0:i.type})}(e,o),C=function(e,t){return e.getApp({entityType:t.entity.type})}(e,w);!function({commandChangeReportingService:e,entityCommand:t,logger:i,sourceApp:n,renderingApp:a,coreSettings:s,clientPreferences:o}){t.entity.type===pe.py.default&&(t.command.correlation.scenarioName=z.RG.DefaultCommand),n&&nt({appName:n.manifest.name,commandChangeReportingService:e,entityCommand:t,getCommandScenarioName:n.getCommandScenarioNameFromSource,logger:i,coreSettings:s,clientPreferences:o}),a&&nt({appName:a.manifest.name,commandChangeReportingService:e,entityCommand:t,getCommandScenarioName:a.getCommandScenarioName,logger:i,coreSettings:s,clientPreferences:o})}({commandChangeReportingService:i,entityCommand:w,renderingApp:C,sourceApp:j,logger:y,coreSettings:a,clientPreferences:p});const _=w.command.correlation.id;if(function({commandChangeReportingService:e,entityCommand:t,executionContextEntity:i}){const n=t.command.correlation.id;e.report({type:Ge.B.CommandStart,correlationId:n,context:{target:"internal-command-handler",entityCommand:t,executionContextEntity:i}})}({commandChangeReportingService:i,entityCommand:w,executionContextEntity:null==o?void 0:o.viewEntity}),C){const e=function(e,t,i,n,a,s,o){return{client:e,coreSettings:t,loggerFactory:i,platformService:n,scenarioFactory:a,userBiService:s,userTrackingService:o}}(t,a,r,c,l,g,v),s=m||void 0,o=yield function({app:e,commandChangeReportingService:t,entityCommand:i,hookRequestContext:a,logger:s,windowProvider:o,notificationsHandler:r}){var c;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n=i;if(e.onBeforeCommandHandled){const l=i.command.correlation,d=l.id,u="internal-command-handler-execute-before-command-handled-hook";t.report({type:Ge.B.ApplicationHookReceivedCommand,context:{target:u},correlationId:d});try{const t={entityCommand:i,requestContext:a,windowProvider:o||void 0,notificationsHandler:Ze(e)&&r?r:void 0};n=yield e.onBeforeCommandHandled(t)}catch(i){const n=`Command 'onBeforeCommandHandled' rejected. An attempt to handle the command was made by app:${e.manifest.name}, but failed. Error: ${(0,se.A)((0,oe.VK)(i))}`;return null===(c=s.errorToTelemetry)||void 0===c||c.call(s,n,"webclient_framework_foundation_core_services_internal_command_handler",void 0,!0),t.report({type:Ge.B.Failure,context:{errorInfo:Je.y.OnBeforeCommandHandledRejected,errorMessage:n,target:u},correlationId:d}),Promise.reject(i)}void 0!==n&&(t.report({type:Ge.B.ApplicationHookContinuedCommand,context:{target:u},correlationId:d}),n.command.correlation=l,t.report({type:Ge.B.CommandStart,correlationId:d,context:{target:u,entityCommand:n}}))}return Promise.resolve(n)}))}({app:C,commandChangeReportingService:i,entityCommand:w,hookRequestContext:e,logger:y,windowProvider:s,notificationsHandler:h});w=o}return w?function({entityCommand:e,mutateContext:{client:t,executionContext:i,windowId:n,clientLaunchId:a}}){return t.mutate({mutation:et,variables:Object.assign(Object.assign({},e),{entityOptions:JSON.stringify(e.entityOptions),executionContext:i,windowId:n,clientLaunchId:a}),fetchPolicy:"no-cache"}).then((e=>{var t,i;return null===(i=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.executeEntityCommand)||void 0===i?void 0:i.id}))}({entityCommand:w,mutateContext:{client:t,executionContext:o,windowId:S,clientLaunchId:u}}):(i.report({type:Ge.B.CommandHandledPriorToResolution,context:{target:"internal-command-handler"},correlationId:_}),Promise.resolve(void 0))}));var Di=i(141330);class Ai{constructor(e){this.commandHandler=e}trigger(e){return this.commandHandler({entity:Pi(e.entity),command:Ui(e.command)})}}const Mi=e=>{switch(e){case Di.uk.view:return pe.uk.view;case Di.uk.list:return pe.uk.list;case Di.uk.default:return pe.uk.default;default:throw(0,oe.Tr)(h.w5.Commanding,h.jK.NotImplemented,"Nova",void 0,`Mapping for Nova action type ${e} not implemented in Teams!`)}},Pi=e=>{switch(e.type){case Di.py.identity:return Oi(e);case Di.py.teams_chat:return{type:pe.py.chats,id:e.entityId,action:Mi(e.action)};case Di.py.teams_channel:return{type:pe.py.channels,id:e.entityId,action:Mi(e.action)};case Di.py.office_home:return{type:pe.py.communitiesonboarding,id:e.entityId,action:Mi(e.action)};case Di.py.office_people:return{type:pe.py.homepage,id:e.entityId,action:Mi(e.action)};case Di.py.teams_activity:return{type:pe.py.activity,id:e.entityId,action:Mi(e.action)};case Di.py.teams_calendar:return{type:pe.py.calendar,id:e.entityId,action:Mi(e.action)};case Di.py.teams_meet:return{type:pe.py.meet,id:e.entityId,action:Mi(e.action)};case Di.py.m365_app:return{type:pe.py.extensions,id:e.entityId,action:Mi(e.action)};case Di.py.teams_calling:return{type:pe.py.callsmain,id:e.entityId,action:pe.uk.view};default:throw(0,oe.Tr)(h.w5.Commanding,h.jK.NotImplemented,"Nova",void 0,`Mapping for Nova entity type ${e.type} not implemented in Teams!`)}},Oi=e=>{switch(e.action){case Di.uk.signout:return{type:pe.py.signoutdialog,id:e.entityId,action:pe.uk.view};case Di.uk.updateProfilePicture:return{type:pe.py.updatemsaprofileavatardialog,id:e.entityId,action:pe.uk.view};case Di.uk.updateDisplayName:return{type:pe.py.updatemsaprofilenamedialog,id:e.entityId,action:pe.uk.view};default:throw(0,oe.Tr)(h.w5.Commanding,h.jK.NotImplemented,"Nova",void 0,`Mapping for Nova identity entity with action type ${e.action} not implemented in Teams!`)}},Ri=e=>{switch(e){case Di.fe.hide:return ve.fe.hide;case Di.fe.show:return ve.fe.show;case Di.fe.toggle:return ve.fe.toggle}},Li=e=>{switch(e){case Di.su.extend:return ve.su.extend;case Di.su.flush:return ve.su.flush;case Di.su.forceFlush:return ve.su.forceFlush;case Di.su.new:return ve.su.new;case Di.su.none:return ve.su.none}},Ui=e=>({visibilityState:Ri(e.visibilityState),stateTransition:Li(e.stateTransition),correlation:{source:k.D.Nova}});var $i,Wi,Bi=i(388522),zi=i(257558),Hi=i(781662);class qi{constructor(e,t,i,n,a,s,o){this.commandHandler=e,this.extensionCommanding=t,this.hostCommunicationService=i,this.windowId=n,this.host=a,this.coreSettings=s,this._logger=o.newLogger("ShellCommandingService","core-services-entity-commanding")}bringWindowToFront(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("osutils");return this._logger.log(`Performing action: bringWindowToFront on ${e}`),(null===(t=null==i?void 0:i.bringWindowToFront)||void 0===t?void 0:t.call(i,e))||Promise.resolve(!1)}))}desktopActiveCallDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.appswitcherdesktopactivecalldialog,action:pe.uk.view},{entityCommand:e})}desktopNotice(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("osutils");return this._logger.log("Performing action: desktopNotice"),null===(e=null==t?void 0:t.openThirdPartyNotice)||void 0===e?void 0:e.call(t)}))}dismissBanner(e,t=k.D.Unknown){return this.dismissNotification(e,pe.py.bannerNotification,t)}dismissToast(e,t=k.D.Unknown){return this.dismissNotification(e,pe.py.inAppToast,t)}executeNotificationAction(e,t,i,n,a){var s,o;let r;try{r=JSON.parse(n)}catch(e){return null===(o=(s=this._logger).errorNoPii)||void 0===o||o.call(s,`Notification command can't be parsed: ${n}`),Promise.resolve()}return a?this.dismissNotification(e,t,i):t===pe.py.bannerNotification&&(r.entityOptions=Object.assign(Object.assign({},r.entityOptions),{bannerId:e})),this.commandHandler(r)}exitFullscreen(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(S.J.Core).routeWindowActionsThroughHostComms)return this.host.exitFullscreen(),Promise.resolve();this.host.document.exitFullscreen().then((()=>(this._logger.log("WindowAction[exitFullscreen] succeeded."),Promise.resolve()))).catch((e=>{const t=(0,se.A)(null==e?void 0:e.message);return this._logger.error(`WindowAction[exitFullscreen] failed due to: ${t}.`),Promise.reject(t)}))}))}getScreenshots(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: getScreenshots on ${this.windowId}`),null===(i=null==n?void 0:n.getScreenshots)||void 0===i?void 0:i.call(n,e,t)}))}installAndLaunchT1(){var e,t,i,a,s,o,r;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("appswitcher"),c=yield null===(e=null==n?void 0:n.downloadAndInstallPearApp)||void 0===e?void 0:e.call(n,Bi.OP.Teams1);switch(null==c?void 0:c.status){case Bi.cw.DownloadedAndInstalled:yield this.launchT1AndQuitT2(!0),this._logger.log("T1 is downloaded and installed");break;case Bi.cw.FailedToDownload:null===(i=(t=this._logger).errorNoPii)||void 0===i||i.call(t,`T1 failed to download: ${null==c?void 0:c.errorMessage}`);break;case Bi.cw.FailedToInstall:null===(s=(a=this._logger).errorNoPii)||void 0===s||s.call(a,`T1 failed to install: ${null==c?void 0:c.errorMessage}`);break;default:null===(r=(o=this._logger).errorNoPii)||void 0===r||r.call(o,`T1 download and install failed: ${null==c?void 0:c.errorMessage}`)}}))}joinLinkDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.joinlinkdialog,action:pe.uk.view},{entityCommand:e,entityOptions:t})}launchT1AndQuitT2(e,t){var i,a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("appswitcher");e&&(this._logger.log("launchT1AndQuitT2, Switcher default app to T1"),yield null===(i=null==n?void 0:n.switchDefaultAppTo)||void 0===i?void 0:i.call(n,Bi.OP.Teams1)),this._logger.log("launchT1AndQuitT2, launch T1"),yield null===(a=null==n?void 0:n.launchPearApp)||void 0===a?void 0:a.call(n,Bi.OP.Teams1,t),this._logger.log("Flushing T2 telemetry events"),yield(0,Hi.G)().flush(),this._logger.log("launchT1AndQuitT2, quit T2"),yield null===(s=null==n?void 0:n.quitApp)||void 0===s?void 0:s.call(n)}))}setWindowControlsTheme(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(t=null==i?void 0:i.setCustomFrameOptions)||void 0===t?void 0:t.call(i,this.windowId,{titleBarMode:zi.i$.ButtonsOnly,theme:e})}))}licenseRequestDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.licenserequestdialog,action:pe.uk.view},{entityCommand:e,entityOptions:t})}maximizeWindow(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(S.J.Core).routeWindowActionsThroughHostComms)return this.host.maximize();const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: maximizeWindow on ${this.windowId}`),null===(e=null==t?void 0:t.maximize)||void 0===e?void 0:e.call(t,this.windowId)}))}minimizeWindow(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(S.J.Core).routeWindowActionsThroughHostComms)return this.host.minimize();const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: maximizeWindow on ${this.windowId}`),null===(e=null==t?void 0:t.minimize)||void 0===e?void 0:e.call(t,this.windowId)}))}msaProfileAvatarUpdateDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.updatemsaprofileavatardialog,action:pe.uk.view},{entityCommand:e})}msaProfileNameUpdateDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.updatemsaprofilenamedialog,action:pe.uk.view},{entityCommand:e})}noticeDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.tpndialog,action:pe.uk.view},{entityCommand:e})}openFreDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.officeintegrationfredialog,action:pe.uk.info},{entityCommand:e})}premiumTrialDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.premiumtrialdialog,action:pe.uk.view},{entityCommand:e,entityOptions:t})}requestFullscreen(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(S.J.Core).routeWindowActionsThroughHostComms)return this.host.requestFullscreen(),Promise.resolve();this.host.document.documentElement.requestFullscreen().then((()=>(this._logger.log("WindowAction[requestFullscreen] succeeded."),Promise.resolve()))).catch((e=>{const t=(0,se.A)(null==e?void 0:e.message);return this._logger.error(`WindowAction[requestFullscreen] failed due to: ${t}.`),Promise.reject(t)}))}))}restoreWindow(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: restoreWindow on ${this.windowId}`),null===(e=null==t?void 0:t.restore)||void 0===e?void 0:e.call(t,this.windowId)}))}setMinimumWindowSize(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(i=null==n?void 0:n.setMinimumWindowSize)||void 0===i?void 0:i.call(n,this.windowId,e,t)}))}setWindowBounds(e,t,i,a){var s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(s=null==n?void 0:n.setWindowBounds)||void 0===s?void 0:s.call(n,this.windowId,Math.trunc(e),Math.trunc(t),Math.trunc(i),Math.trunc(a))}))}showContextMenu(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: showContextMenu on ${this.windowId} and position ${e}`),null===(t=null==i?void 0:i.showTitleBarContextMenu)||void 0===t?void 0:t.call(i,this.windowId,e)}))}showBanner(e){var{id:t,dismissable:i=!0,duration:a=4,source:s=k.D.Unknown}=e,o=(0,n.__rest)(e,["id","dismissable","duration","source"]);return this.commandHandler({command:{correlation:{source:s},stateTransition:ve.su.none,visibilityState:ve.fe.show},entity:{type:pe.py.bannerNotification,action:pe.uk.create,id:t},entityOptions:Object.assign(Object.assign({},o),{dismissable:i,duration:a})})}showToast(e){var{id:t,duration:i=7e3,source:a=k.D.Unknown}=e,s=(0,n.__rest)(e,["id","duration","source"]);return this.commandHandler({command:{correlation:{source:a},stateTransition:ve.su.none,visibilityState:ve.fe.show},entity:{type:pe.py.inAppToast,action:pe.uk.create,id:t},entityOptions:Object.assign(Object.assign({},s),{duration:i})})}signOutDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.signoutdialog,action:pe.uk.view},{entityCommand:e})}startWindowDragListener(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: startWindowDragListener on ${this.windowId}`),null===(e=null==t?void 0:t.startWindowDragListener)||void 0===e?void 0:e.call(t,this.windowId)}))}swapMeetingRoomFrontOfRoomWindows(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log("Performing action: swapMeetingRoomFrontOfRoomWindows"),null===(e=null==t?void 0:t.swapMeetingRoomFrontOfRoomWindows)||void 0===e?void 0:e.call(t)}))}switchDefaultAppTo(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("appswitcher");this._logger.log(`switchDefaultAppTo ${e}`),yield null===(t=null==i?void 0:i.switchDefaultAppTo)||void 0===t?void 0:t.call(i,e)}))}webActiveCallDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.appswitcherwebactivecalldialog,action:pe.uk.view},{entityCommand:e})}webMultipleTabsDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.appswitcherwebmultipletabsdialog,action:pe.uk.view},{entityCommand:e})}zoomInWindow(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: zoomInWindow on ${this.windowId}`),null===(e=null==t?void 0:t.zoomIn)||void 0===e?void 0:e.call(t,this.windowId)}))}zoomOutWindow(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: zoomOutWindow on ${this.windowId}`),null===(e=null==t?void 0:t.zoomOut)||void 0===e?void 0:e.call(t,this.windowId)}))}zoomResetWindow(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: zoomResetWindow on ${this.windowId}`),null===(e=null==t?void 0:t.zoomReset)||void 0===e?void 0:e.call(t,this.windowId)}))}dismissNotification(e,t,i=k.D.Unknown){return this.commandHandler({command:{correlation:{source:i},stateTransition:ve.su.none,visibilityState:ve.fe.hide},entity:{type:t,action:pe.uk.delete,id:e}})}}!function(e){e.openInExplorer="openInExplorer"}($i||($i={})),function(e){e.quickReply="quickReply",e.unknown="unknown",e.view="view",e.toast="toast"}(Wi||(Wi={}));var Vi,Gi=i(469980);!function(e){e.unknown="unknown",e.toast="toast",e.activity="activity"}(Vi||(Vi={}));var Ji=i(653266),Ki=i(428768);class Qi{constructor(e,t){this.commandHandler=e,this.userContextId=t}showMessage(e,{collectionId:t,conversationId:i,mainImage:n,discardDuringMeetingsAndCalls:a,messageId:s,quickReply:o,quickReplyButton:r,quickReplyPlaceholder:c,text:l,time:d,title:u,isUrgent:m,isFromPriorityContact:g}){const h={collectionId:t,isUrgent:g||m,mainImage:n,discardDuringMeetingsAndCalls:a,targetEntity:{action:p.A$.view,dataOptions:{actionType:Wi.view,messageId:s,userContextId:this.userContextId,toastType:Yi(i)?"phoneLinkSmsToast":void 0},id:i,type:p.dt.chats},textInput:o?Xi(i,r,c,this.userContextId):void 0,text:l,time:d,title:u,telemetryClientId:e},v={command:{correlation:{id:e,source:k.D.Notifications,startTimestamp:d.valueOf(),scenarioName:z.RG.CrossClientToastView},stateTransition:ve.su.new,visibilityState:ve.fe.show},entity:{action:pe.uk.view,type:pe.py.toasts},entityOptions:h};return this.commandHandler(v)}showReminder(e,{collectionId:t,conversationId:i,mainImage:n,messageId:a,text:s,time:o,title:r,buttonText:c,type:l}){const d={collectionId:t,mainImage:n,targetEntity:{action:p.A$.view,dataOptions:{actionType:Wi.view,messageId:a,userContextId:this.userContextId,toastType:l},id:i,type:p.dt.reminders},textInput:void 0,text:s,time:o,title:r,telemetryClientId:e,buttons:[{targetEntity:{action:p.A$.view,dataOptions:{actionType:Wi.view,messageId:a,userContextId:this.userContextId},id:i,type:p.dt.reminders},text:c}]},u={command:{correlation:{id:e,source:k.D.Notifications,startTimestamp:o.valueOf()},stateTransition:ve.su.new,visibilityState:ve.fe.show},entity:{action:pe.uk.view,type:pe.py.toasts},entityOptions:d};return this.commandHandler(u)}showChatTabEntityNotification(e,{collectionId:t,conversationId:i,mainImage:n,tabId:a,text:s,time:o,title:r}){const c={collectionId:t,mainImage:n,targetEntity:{id:a,type:p.dt.extensions,action:p.A$.view,dataOptions:{actionType:Wi.unknown,userContextId:this.userContextId},linkedEntity:{id:i,action:p.A$.view,type:p.dt.chats}},text:s,time:o,title:r,telemetryClientId:e},l={command:{correlation:{id:e,source:k.D.Notifications,startTimestamp:o.valueOf()},stateTransition:ve.su.flush,visibilityState:ve.fe.show},entity:{action:pe.uk.view,type:pe.py.toasts},entityOptions:c};return this.commandHandler(l)}showChannelsNotification(e,{collectionId:t,conversationId:i,mainImage:n,discardDuringMeetingsAndCalls:a,messageId:s,text:o,time:r,title:c,replyChainId:l}){const d={collectionId:t,mainImage:n,discardDuringMeetingsAndCalls:a,targetEntity:{action:p.A$.view,dataOptions:{actionType:Wi.view,messageId:s,userContextId:this.userContextId,focusOnLoad:Gi.t.DoNotMove},id:JSON.stringify({channelId:i,replyChainId:l,deepLinkId:l}),type:p.dt.channels},text:o,time:r,title:c,telemetryClientId:e},u={command:{correlation:{id:e,source:k.D.Notifications,startTimestamp:r.valueOf(),scenarioName:z.RG.CrossClientToastView},stateTransition:ve.su.new,visibilityState:ve.fe.show},entity:{action:pe.uk.view,type:pe.py.toasts},entityOptions:d};return this.commandHandler(u)}showCommunitiesNotifications(e,{collectionId:t,conversationId:i,mainImage:n,messageId:a,text:s,time:o,title:r,replyChainId:c,type:l}){const d={collectionId:t,mainImage:n,targetEntity:{action:p.A$.view,dataOptions:{actionType:Wi.view,messageId:a,userContextId:this.userContextId,toastType:l,teamId:i,deepLinkId:a},id:JSON.stringify({channelId:i,replyChainId:c}),type:p.dt.communities},text:s,time:o,title:r,telemetryClientId:e},u={command:{correlation:{id:e,source:k.D.Notifications,startTimestamp:o.valueOf()},stateTransition:ve.su.new,visibilityState:ve.fe.show},entity:{action:pe.uk.view,type:pe.py.toasts},entityOptions:d};return this.commandHandler(u)}showCommunitiesMemberRequestsNotifications(e,{collectionId:t,conversationId:i,mainImage:n,text:a,time:s,title:o,type:r}){const c={collectionId:t,mainImage:n,targetEntity:{action:p.A$.view,dataOptions:{actionType:Wi.view,userContextId:this.userContextId,toastType:r,teamId:i},id:i,type:p.dt.communitiesjoinrequest},text:a,time:s,title:o,telemetryClientId:e},l={command:{correlation:{id:e,source:k.D.Notifications,startTimestamp:s.valueOf()},stateTransition:ve.su.new,visibilityState:ve.fe.show},entity:{action:pe.uk.view,type:pe.py.toasts},entityOptions:c};return this.commandHandler(l)}showCommunitiesCalendarEventsNotifications(e,{collectionId:t,conversationId:i,mainImage:n,text:a,time:s,title:o}){const r={collectionId:t,mainImage:n,targetEntity:{action:p.A$.view,dataOptions:{actionType:Wi.view,userContextId:this.userContextId},id:JSON.stringify({channelId:i}),type:p.dt.communitiesevents},text:a,time:s,title:o},c={command:{correlation:{id:e,source:k.D.Notifications,startTimestamp:s.valueOf()},stateTransition:ve.su.new,visibilityState:ve.fe.show},entity:{action:pe.uk.view,type:pe.py.toasts},entityOptions:r};return this.commandHandler(c)}showEspSyntheticNotification(e,{collectionId:t,mainImage:i,text:n,time:a,title:s,campaignType:o}){let r;if(o){if(o===Ji.mL.files){const c="newchat";r={collectionId:t,mainImage:i,targetEntity:{type:p.dt.chats,action:p.A$.view,id:c,dataOptions:{actionType:Vi.toast,userContextId:this.userContextId,campaignType:o}},text:n,time:a,title:s,telemetryClientId:e}}else r={collectionId:t,mainImage:i,targetEntity:{type:p.dt.campaignnotifications,action:p.A$.view,id:o,dataOptions:{actionType:Vi.toast,userContextId:this.userContextId}},text:n,time:a,title:s,telemetryClientId:e};const c={command:{correlation:{id:e,source:k.D.Notifications,startTimestamp:a.valueOf()},stateTransition:ve.su.flush,visibilityState:ve.fe.show},entity:{action:pe.uk.view,type:pe.py.toasts},entityOptions:r};return this.commandHandler(c)}{const t={targetEntity:{dataOptions:{actionType:Wi.view,userContextId:this.userContextId,focusOnLoad:Gi.t.DeeplinkedMessage},action:p.A$.list,type:p.dt.activity},textInput:void 0,text:n,time:a,title:s,mainImage:i,telemetryClientId:e},o={command:{correlation:{id:e,source:k.D.Notifications,startTimestamp:a.valueOf()},stateTransition:ve.su.flush,visibilityState:ve.fe.show},entity:{action:pe.uk.view,type:pe.py.toasts},entityOptions:t};return this.commandHandler(o)}}showGraphItemNotification(e,{collectionId:t,mainImage:i,discardDuringMeetingsAndCalls:n,text:a,time:s,title:o}){const r={collectionId:t,mainImage:i,discardDuringMeetingsAndCalls:n,targetEntity:{action:p.A$.list,dataOptions:{actionType:Wi.view,userContextId:this.userContextId,focusOnLoad:Gi.t.DeeplinkedMessage},id:"msGraph",type:p.dt.activity},text:a,time:s,title:o,telemetryClientId:e},c={command:{correlation:{id:e,source:k.D.Notifications,startTimestamp:s.valueOf(),scenarioName:z.RG.CrossClientToastView},stateTransition:ve.su.flush,visibilityState:ve.fe.show},entity:{action:pe.uk.view,type:pe.py.toasts},entityOptions:r};return this.commandHandler(c)}showReEngageNudge(e,{conversationId:t,text:i,time:n,title:a,type:s}){const o={targetEntity:{action:p.A$.view,dataOptions:{actionType:Wi.view,userContextId:this.userContextId,toastType:s},id:t,type:p.dt.reminders},textInput:void 0,text:i,time:n,title:a,telemetryClientId:e},r={command:{correlation:{id:e,source:k.D.Notifications,startTimestamp:n.valueOf()},stateTransition:ve.su.new,visibilityState:ve.fe.show},entity:{action:pe.uk.view,type:pe.py.toasts},entityOptions:o};return this.commandHandler(r)}showLocalRecordingAssemblyNotification(e,{text:t,time:i,title:n,mainImage:a},s){const o={targetEntity:{action:p.A$.view,dataOptions:{actionType:$i.openInExplorer,userContextId:this.userContextId,fileId:s},id:"localRecordingAssembly",type:p.dt.activity},mainImage:a,textInput:void 0,text:t,time:i,title:n,telemetryClientId:e},r={command:{correlation:{id:e,source:k.D.Notifications,startTimestamp:i.valueOf()},stateTransition:ve.su.none,visibilityState:ve.fe.show},entity:{action:pe.uk.view,type:pe.py.toasts},entityOptions:o};return this.commandHandler(r)}showMeetNowNudge(e,{conversationId:t,text:i,time:n,title:a,type:s,deeplinkUrl:o,deepLinkId:r}){const c={targetEntity:{action:p.A$.join,dataOptions:{actionType:Wi.view,userContextId:this.userContextId,toastType:s,deeplinkUrl:o,coordinates:{joinType:"MeetingData",meetingData:{meetingUrl:o}},deepLinkId:r},id:t,type:p.dt.callingdeeplink},textInput:void 0,text:i,time:n,title:a,telemetryClientId:e},l={command:{correlation:{id:e,source:k.D.Notifications,startTimestamp:n.valueOf()},stateTransition:ve.su.flush,visibilityState:ve.fe.show},entity:{action:pe.uk.view,type:pe.py.toasts},entityOptions:c};return this.commandHandler(l)}}const Yi=e=>!!(null==e?void 0:e.startsWith(Ki.a.PhonelinkSmsPrefix)),Xi=(e,t,i,n)=>({placeholderText:i||"Send a quick reply",sendButton:{text:t||"Send",targetEntity:{action:p.A$.mutate,type:p.dt.chats,dataOptions:{actionType:Wi.quickReply,convId:e,userContextId:n,toastType:Yi(e)?"phoneLinkSmsToast":void 0}}}});class Zi{constructor(e){this.commandHandler=e}showAccounts(){return this.commandHandler({entity:{type:pe.py.accounts,action:pe.uk.list}})}}class en{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}default(e){return this.commandHandler({entity:{type:pe.py.activity,action:pe.uk.default},command:e})}empty(e){return this.commandHandler({entity:{type:pe.py.activity,action:pe.uk.empty},command:e})}launchDeleteActivityFeedItemDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.activity,action:pe.uk.delete},{entityCommand:e})}launchActivityErrorDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.activity,action:pe.uk.error},{entityCommand:t})}openEmptyFeedMainPane(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.activity,action:pe.uk.empty},command:t,scenarioEventData:i})}}var tn=i(804589),nn=i(932289);const an={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataAuthUserAuthStateQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userAuthState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userContextId"},value:{kind:"Variable",name:{kind:"Name",value:"userContextId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"reason"}},{kind:"Field",name:{kind:"Name",value:"customError"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errorCode"}},{kind:"Field",name:{kind:"Name",value:"isExpected"}},{kind:"Field",name:{kind:"Name",value:"message"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"errorMetadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"accountId"}},{kind:"Field",name:{kind:"Name",value:"cloud"}}]}}]}}]}}]}}]},sn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataAuthEndPagesQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isMRU"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userEndPageData"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userContextId"},value:{kind:"Variable",name:{kind:"Name",value:"userContextId"}}},{kind:"Argument",name:{kind:"Name",value:"isMRU"},value:{kind:"Variable",name:{kind:"Name",value:"isMRU"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"pictureBlob"}},{kind:"Field",name:{kind:"Name",value:"customError"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"message"}},{kind:"Field",name:{kind:"Name",value:"subContext"}}]}}]}}]}}]};class on{constructor(e,t,i,n){this.commandHandler=e,this.extensionCommanding=t,this.deeplinkCommandingService=i,this.client=n}signinPage(e){return this.commandHandler({entity:{type:pe.py.identity,action:pe.uk.default},command:e})}accountList(e){return this.commandHandler({entity:{type:pe.py.identity,action:pe.uk.list},command:e})}switchAccount({correlation:e,userContextId:t,targetEntity:i,cloud:a,entityOptions:s}){var o,r,c;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.client)throw new Error("client missing in switch account commanding");const{data:n}=(yield this.client.query({query:an,variables:{userContextId:t},context:{correlation:e}}))||{},l=null==n?void 0:n.userAuthState;if(l&&l.state!==xe.JEq.Up){let i,s;const d=null===(o=l.customError)||void 0===o?void 0:o.errorCode;if(l.state===xe.JEq.UnRedeemed&&(i=pe.uk.tenantRedemption),l.state===xe.JEq.LoginError)switch(null===(r=l.customError)||void 0===r?void 0:r.errorCode){case tn.SM.TenantUnredeemed:i=pe.uk.tenantRedemption;break;case tn.SM.InteractionRequired:i=pe.uk.tenantLogin;break;case tn.SM.CloudMismatch:const e=null===(c=l.customError)||void 0===c?void 0:c.errorMetadata;a=null==e?void 0:e.cloud,t=null==e?void 0:e.accountId;break;default:i=pe.uk.error}if(l.state===xe.JEq.LicenseError||l.state===xe.JEq.SignInRestriction||"MsaUserNotAllowed"===d){const n=yield this.client.query({query:sn,variables:{userContextId:t,isMRU:!1},context:{correlation:e}}),a="MsaUserNotAllowed"===d?d:l.state===xe.JEq.LicenseError?"LicenseError":"SignInRestriction",o=n.data.userEndPageData;i=pe.uk.error,s=(0,nn.fj)(o,a,t)}if(i)return this.commandHandler({entity:{type:pe.py.identitydialog,action:i},command:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:e},entityOptions:{correlation:e,userContextId:t,userAuthState:null==n?void 0:n.userAuthState,error:s}})}return this.deeplinkCommandingService.switchAccount(e,t,i,a,s)}))}signOutDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.signoutdialog,action:pe.uk.view},{entityCommand:e})}smartDeviceSignOutDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.smartdevicelogoutdialog,action:pe.uk.view},{entityCommand:e})}addAccountDialog(e){return this.commandHandler({entity:{type:pe.py.identitydialog,action:pe.uk.create},command:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,layoutMode:ve.lO.focus,correlation:e.correlation},entityOptions:e})}addAccount(e){return this.commandHandler({entity:{type:pe.py.identity,action:pe.uk.create},command:{visibilityState:ve.fe.show,stateTransition:ve.su.new,layoutMode:ve.lO.focus,correlation:e},entityOptions:{correlation:e}})}closeAccountListDialog(e){return this.commandHandler({entity:{type:pe.py.identitydialog,action:pe.uk.create},command:{visibilityState:ve.fe.hide,stateTransition:ve.su.flush,layoutMode:ve.lO.focus,correlation:{source:e}}})}closeEntity(e,t){return this.commandHandler({entity:t,command:{visibilityState:ve.fe.hide,stateTransition:ve.su.flush,layoutMode:ve.lO.focus,correlation:{source:e}}})}executeEntity(e){return this.commandHandler(e)}closeAccountLoginDialog(e){return this.commandHandler({entity:{type:pe.py.identitydialog,action:pe.uk.tenantLogin},command:{visibilityState:ve.fe.hide,stateTransition:ve.su.flush,layoutMode:ve.lO.focus,correlation:{source:e}}})}closeAddAccountListWindow(e){return this.commandHandler({entity:{type:pe.py.identity,action:pe.uk.create},command:{visibilityState:ve.fe.hide,stateTransition:ve.su.flush,layoutMode:ve.lO.focus,correlation:{source:e}}})}closeAccountListWindow(e){return this.commandHandler({entity:{id:ve.lO.focus,type:pe.py.identity,action:pe.uk.list},command:{visibilityState:ve.fe.hide,stateTransition:ve.su.flush,layoutMode:ve.lO.focus,correlation:{source:e}}})}showAuthEndPage(e,t,i){return this.commandHandler({entity:{type:i?pe.py.identitydialog:pe.py.identity,action:pe.uk.error},command:{visibilityState:ve.fe.show,stateTransition:i?ve.su.extend:ve.su.flush,layoutMode:i?ve.lO.focus:ve.lO.standard,correlation:{source:e}},entityOptions:{error:t.error}})}showRefreshModal(e){return this.commandHandler({entity:{type:pe.py.authrefreshdialog,action:pe.uk.view},command:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,layoutMode:ve.lO.standard,correlation:{source:e}}})}}class rn{constructor(e){this.commandHandler=e}viewAutoInstallNotification(e,t){return this.commandHandler({entity:{type:pe.py.autoinstallnotification,action:pe.uk.view},command:t,entityOptions:e})}}class cn{constructor(e){this.commandHandler=e}navigateToFaceEnrollment(){return this.commandHandler({entity:{type:pe.py.faceenrollment,action:pe.uk.view},command:{visibilityState:ve.fe.show,stateTransition:ve.su.flush,correlation:{startTimestamp:Date.now(),source:k.D.FaceEnrollmentGetStartedButton}}})}navigateToVoiceEnrollment(){return this.commandHandler({entity:{type:pe.py.voiceenrollment,action:pe.uk.view},command:{visibilityState:ve.fe.show,stateTransition:ve.su.flush,correlation:{startTimestamp:Date.now(),source:k.D.VoiceEnrollmentGetStartedButton}}})}}class ln{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}brbFeedbackDialogInMainWindow(e,t){return this.commandHandler({entity:{type:pe.py.brbfeedbackdialog,action:pe.uk.view},command:e,entityOptions:t})}brbFeedbackDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.brbfeedbackdialog,action:pe.uk.view},{entityCommand:e})}autoBrbConfirmationDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.autobrbconfirmationdialog,action:pe.uk.view},{entityCommand:e,entityOptions:t})}autoBrbFlowDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.autobrbflowdialog,action:pe.uk.view},{entityCommand:e,entityOptions:t})}}class dn{constructor(e){this.commandHandler=e}openBreakoutRooms(e,t){return this.commandHandler({entity:{type:pe.py.breakoutrooms,action:pe.uk.view},entityOptions:t,command:e})}openBreakoutRoomsInChat(e,t){return this.commandHandler({entity:{type:pe.py.breakoutrooms,action:pe.uk.view,linkedEntity:{type:pe.py.chats,id:e}},command:t})}showAssignmentDialog(e){return this.showDialog(pe.py.breakoutroomsassignment,e)}showAssignmentTypeDialog(e){return this.showDialog(pe.py.breakoutroomsassignmenttype,e)}showCreateRoomsDialog(e){return this.showDialog(pe.py.breakoutroomscreaterooms,e)}showDeleteRoomDialog(e){return this.showDialog(pe.py.breakoutroomsdeleteroom,e)}showDeleteRoomsDialog(e){return this.showDialog(pe.py.breakoutroomsdeleterooms,e)}showEditRoomDialog(e){return this.showDialog(pe.py.breakoutroomseditroom,e)}showSettingsDialog(e){return this.showDialog(pe.py.breakoutroomssettings,e)}showDialog(e,t){return this.commandHandler({entity:{type:e,action:pe.uk.view},command:{stateTransition:ve.su.extend,correlation:{source:k.D.ExtensionCommanding},visibilityState:t}})}}class un{constructor(e){this.commandHandler=e}qnaPanelById(e,t){return this.commandHandler({entity:{type:pe.py.broadcastqna,action:pe.uk.view,id:e,linkedEntity:{type:pe.py.calls,id:e}},command:t})}broadcastQnaPanelById(e,t){return this.commandHandler({entity:{type:pe.py.eventsbroadcastqna,action:pe.uk.view,id:e,linkedEntity:{type:pe.py.calls,id:e}},command:t})}infoPanelById(e,t){return this.commandHandler({entity:{type:pe.py.broadcasts,action:pe.uk.info,id:e,linkedEntity:{type:pe.py.calls,id:e}},command:t})}broadcastById(e,t,i){return this.commandHandler({entity:{type:pe.py.broadcasts,action:pe.uk.view,id:e},command:t,entityOptions:i})}broadcastFeedbackById(e,t,i){return this.commandHandler({entity:{type:pe.py.broadcastfeedback,action:pe.uk.view,id:e},command:t,entityOptions:i})}broadcastLeave(e,t,i){return this.commandHandler({entity:{type:pe.py.broadcasts,action:pe.uk.leave,id:e},command:t,entityOptions:i})}joinBroadcastAsAttendee(e){return this.commandHandler(e)}}class mn{constructor(e,t){this.extensionCommanding=e,this.commandHandler=t}meetingDetails(e,t,i,n){const a=n||pe.py.schedulingform;return this.commandHandler({entity:{type:a,action:pe.uk.view,id:e},command:t,entityOptions:i})}openCalendarSurface(e,t,i,n){return this.commandHandler({entity:{type:pe.py.calendar,action:pe.uk.view,id:e,linkedEntity:n},command:t,entityOptions:i})}openM365CalendarSurface(e){return this.commandHandler({entity:{type:pe.py.extensions,action:pe.uk.view,id:JSON.stringify({appId:"5966c135-e05f-4ce0-81e0-e138fe8e9583"})},command:{stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:e||k.D.Calendar}}})}openCalendarAgendaView(e,t,i){return this.commandHandler({entity:{type:pe.py.calendar,action:pe.uk.list,linkedEntity:i},command:e,entityOptions:t})}openChannelCalendarSurface(e,t,i,n){const a={entity:{action:pe.uk.view,id:e,linkedEntity:n,type:pe.py.channelcalendar},command:t,entityOptions:i};return this.commandHandler(a)}openSchedulingFormInMainWindow(e,t,i){return this.commandHandler({entity:{type:pe.py.schedulingform,action:pe.uk.create,id:e},command:t,entityOptions:i})}openBroadcast(e,t,i,n){const a={type:pe.py.broadcastliveevent,id:e,action:t};return this.extensionCommanding.executeCommand(a,{entityCommand:{visibilityState:ve.fe.show,stateTransition:ve.su.none,correlation:{source:i}},entityOptions:n})}closeSchedulingForm(e,t,i){return this.commandHandler({entity:e,command:t,entityOptions:i})}showCalendarErrorModal(e){return this.extensionCommanding.executeCommand({type:pe.py.calendar,action:pe.uk.error},{entityCommand:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:k.D.CalendarEventAction}},entityOptions:e})}addBlockingConfirmationDialog(e,t){return this.extensionCommanding.addBlockingExtension({type:pe.py.calendar,action:pe.uk.confirm},e,t)}isBlockedByCalendar(){return this.extensionCommanding.isBlockedByEntity(pe.py.calendar)}showConfirmationDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.calendar,action:pe.uk.confirm},{entityCommand:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:k.D.CalendarEventAction}},entityOptions:e})}showShareDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.calendar,action:pe.uk.share},{entityCommand:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:k.D.CalendarEventAction}},entityOptions:e})}showEmbedDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.calendar,action:pe.uk.info},{entityCommand:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:k.D.CalendarEventAction}},entityOptions:e})}openConnectedCalendarDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.connectedcalendardialog,action:pe.uk.view},{entityCommand:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:k.D.CalendarSettings}},entityOptions:e})}openConnectedCalendarSurfaceDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.connectedcalendarsurfacedialog,action:pe.uk.view},{entityCommand:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:k.D.Calendar}},entityOptions:e})}}class gn{constructor(e,t,i=void 0){this.commandHandler=e,this.extensionCommanding=t,this.userContextId=i}call(e,t){return this.commandHandler({entity:{type:pe.py.calls,action:pe.uk.list,id:e},command:t})}callDebug(e){return this.commandHandler({entity:{type:pe.py.calls,action:pe.uk.info},command:e})}dialPad(e){return this.commandHandler({entity:{type:pe.py.calls,action:pe.uk.join},command:e})}callById(e,t,i,n,a){let s;return i&&(s={type:pe.py.chats,id:i}),a&&(s={type:pe.py.callingdeeplink,id:a}),this.commandHandler({entity:{type:n||pe.py.calls,action:pe.uk.view,id:e,linkedEntity:s},command:t})}callStageContentById(e,t){return this.commandHandler({entity:{type:pe.py.stagecontent,action:pe.uk.view},entityOptions:t,command:e})}callList(e){return this.commandHandler({entity:{type:pe.py.calls,action:pe.uk.list},command:e})}deviceSettingsById(e,t,i={useCall:!0}){return this.commandHandler({entity:{type:pe.py.devicesettings,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},entityOptions:i,command:t})}extensibilityAppPickerCallingPanel(e,t,i){return this.commandHandler({entity:{type:pe.py.extensibilityapppickercallingpanel,action:pe.uk.info,id:e},command:t,entityOptions:{messageId:i,conversationId:e}})}callNotification(e,t,i,n){var a;const s=e.entityOptions;return s.targetEntity.dataOptions.userContextId=this.userContextId,s.telemetryClientId=i,null===(a=s.buttons)||void 0===a||a.forEach((e=>{e.targetEntity.dataOptions.userContextId=this.userContextId})),"Hide"===n?this.commandHandler({entity:{id:t,action:pe.uk.view,type:pe.py.toasts},command:{correlation:{id:i,source:k.D.Calling},stateTransition:ve.su.new,visibilityState:ve.fe.hide},entityOptions:s}):this.commandHandler({entity:{action:pe.uk.view,type:pe.py.toasts,id:t},command:e.command,entityOptions:s})}cameraEffectsSettingsById(e,t){return this.commandHandler({entity:{type:pe.py.cameraeffects,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},entityOptions:{commandSource:null==t?void 0:t.correlation.source},command:t})}customVideoBackgroundSettingsById(e,t){return this.commandHandler({entity:{type:pe.py.videobackgrounds,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},command:t})}styleMyRoomPanelById(e,t){return this.commandHandler({entity:{type:pe.py.stylemyroom,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},command:t})}callRosterById(e,t,i){const n={entity:{type:pe.py.roster,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},command:t};return i&&(n.entityOptions={isBYODAttendeeView:i}),this.commandHandler(n)}callByodRosterById(e,t){return this.commandHandler({entity:{type:pe.py.byodroster,action:pe.uk.view,linkedEntity:{type:pe.py.byodattendeewindow,id:e}},command:t})}callDetailsById(e,t,i){return this.commandHandler({entity:{type:pe.py.meetingdetails,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e},id:e},entityOptions:{didMeetingNotesAutoOpen:i},command:t})}callInfoById(e,t){return this.commandHandler({entity:{type:pe.py.calls,action:pe.uk.info,linkedEntity:{type:pe.py.calls,id:e}},command:t})}callNotesById(e,t){return this.commandHandler({entity:{type:pe.py.notes,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},command:t})}transcriptPanelById(e,t){return this.commandHandler({entity:{type:pe.py.transcript,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},command:t})}callHealthPanelById(e,t){return this.commandHandler({entity:{type:pe.py.calls,action:pe.uk.health,linkedEntity:{type:pe.py.calls,id:e}},command:t})}mediaStreamsPanelById(e,t){return this.commandHandler({entity:{type:pe.py.mediastreams,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},command:t})}callBreakoutRoomById(e,t){return this.commandHandler({entity:{type:pe.py.breakoutroomspanel,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e},id:e},command:t})}callDeeplinkDialog(e){return this.commandHandler({entity:{type:pe.py.callingdeeplinkDialog,action:pe.uk.view},command:e})}createById(e,t,i,n){return this.commandHandler({entity:{id:e,type:t,action:pe.uk.create},command:i,windowOptions:n})}callMonitorById(e,t,i){return this.commandHandler({entity:{type:pe.py.callsmonitor,action:pe.uk.view},entityOptions:e&&{callingIntentId:e},command:t,windowOptions:i})}callShareMeetingInviteDialogById(e,t,i){return this.extensionCommanding.executeCommand(e,{entityOptions:t,entityCommand:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:i}}})}callsKeypad(e,t){return this.commandHandler({entity:{type:pe.py.callskeypad,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},command:t})}callMeetingOptionsById(e,t){return this.commandHandler({entity:{type:pe.py.meetings,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},command:t})}callsTransfer(e,t){return this.commandHandler({entity:{type:pe.py.callstransfer,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},command:t})}contentCameraSetupDialog(e,t,i){return this.extensionCommanding.executeCommand({id:e,type:pe.py.contentcamerasetup,action:pe.uk.create},{entityOptions:t,entityCommand:{visibilityState:ve.fe.show,stateTransition:ve.su.none,correlation:{source:i}}})}startMeetingStream(e,t){return this.extensionCommanding.executeCommand({type:pe.py.meetingstream,action:pe.uk.create},{entityCommand:{visibilityState:ve.fe.show,stateTransition:ve.su.none,correlation:{source:e}},entityOptions:t})}stagingRoomStartMeetingConfirmationDialog(e,t,i){return this.extensionCommanding.executeCommand({id:e,type:pe.py.stagingroomstartmeetingconfirmationdialog,action:pe.uk.create},{entityCommand:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:t}},entityOptions:i})}openDialog(e,t,i){return this.extensionCommanding.executeCommand(e,{entityOptions:i,entityCommand:t})}dialogContainer({command:e,viewOptions:t}){return this.commandHandler({entity:{type:pe.py.callingdialog,action:pe.uk.view},command:Object.assign(Object.assign({},e),{stateTransition:ve.su.new}),entityOptions:t})}callableChannelById(e,t,i){return this.commandHandler({entity:{id:t,type:pe.py.callablechannels,action:pe.uk.list,linkedEntity:{id:e,type:pe.py.channels,action:pe.uk.view}},command:i})}toggleRoomRemote(e,t,i){return this.commandHandler({entity:{type:pe.py.roomremote,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},entityOptions:i,command:t})}accessibilityPanelById(e,t){return this.commandHandler({entity:{type:pe.py.accessibilitypanel,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},command:t})}closedCaptionsSettingsPanelById(e,t,i={allowTranslatedCaptions:!1}){return this.commandHandler({entity:{type:pe.py.closedcaptionssettings,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},entityOptions:i,command:t})}openCopilot(e,t,i){return this.commandHandler({entity:{type:pe.py.meetingcollaboration,action:pe.uk.view,id:t||e.callId||e.threadId,linkedEntity:{type:pe.py.calls,id:t||e.callId}},entityOptions:e,command:i})}presenterToolbarById(e,t){return this.commandHandler({entity:{type:pe.py.presentertoolbar,action:pe.uk.view},entityOptions:e&&{callingIntentId:e},command:t})}pstnCallMeDialogToggle(e,t,i){return this.extensionCommanding.executeCommand(e,{entityOptions:i,entityCommand:t})}openBYODAttendeeView(e,t){return this.commandHandler({entity:{type:pe.py.byodattendeewindow,action:pe.uk.view,id:null==t?void 0:t.intentId},entityOptions:t,command:e})}}class hn{constructor(e){this.commandHandler=e}navigateById(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.commandHandler({entity:{type:pe.py.campaignnotifications,action:pe.uk.view,id:e},entityOptions:null==t?void 0:t.entityOptions,command:null==t?void 0:t.entityCommand,scenarioEventData:null==t?void 0:t.scenarioEventData})}))}}class pn{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}default(e=this.getDefaultEntityCommand(k.D.Unknown)){return this.commandHandler({entity:{type:pe.py.channels,action:pe.uk.default},command:e})}channelDeeplinkWithMessageId(e,t,i){return this.commandHandler({entity:{type:pe.py.channels,action:pe.uk.view,id:e},command:t,entityOptions:i})}channelMessagesById(e,t){var i,n;const a={channelId:e,replyChainId:null==t?void 0:t.replyChainId};return this.commandHandler({entity:{type:pe.py.channels,action:pe.uk.view,id:JSON.stringify(a)},command:t.entityCommand,entityOptions:Object.assign(Object.assign({},t.entityOptions),{deepLinkId:t.deepLinkId,pinned:t.pinned,parentTeamId:t.parentTeamId,source:null===(i=t.entityCommand.correlation)||void 0===i?void 0:i.source}),scenarioEventData:null===(n=t.extendedOptions)||void 0===n?void 0:n.scenarioEventData})}toggleChannelInfoPane(e,t){const{channelId:i}=vn(e),n=JSON.stringify({channelId:i});return this.commandHandler({entity:{type:pe.py.channels,action:pe.uk.info,id:n},command:t})}toggleChannelInfoPaneExpandedView(e,t,i,n){const{channelId:a,replyChainId:s}=vn(e),o=JSON.stringify({channelId:a,replyChainId:s});return this.commandHandler({entity:{type:i,action:pe.uk.info,id:o,linkedEntity:{id:e,type:pe.py.channels}},command:t,entityOptions:n})}showDefaultNavigationDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.defaultchannelnavdialog,action:pe.uk.view},{entityCommand:t,entityOptions:e})}showJoinTeamDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.teamjoindialog,action:pe.uk.view},{entityCommand:t,entityOptions:e})}launchCrossPostChannelSelectionDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.crosspostchannelselectiondialog,action:pe.uk.view},{entityCommand:this.getDefaultEntityCommand(t,ve.su.extend),entityOptions:{selectedChannelIds:e}})}launchCrossPostChannelSelectionDialogV2(e,t,i){return this.extensionCommanding.executeCommand({type:pe.py.crosspostchannelselectiondialogV2,action:pe.uk.view},{entityCommand:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:i}},entityOptions:{selectedChannelIds:e,currentChannelId:t}})}toggleChannelCopilotView(e,t,i){return this.commandHandler({entity:{type:i,action:pe.uk.info,id:e,linkedEntity:{id:e,type:pe.py.channels}},command:t,entityOptions:{source:k.D.ChannelCopilot}})}launchCrossPostDeleteDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.crosspostdeletedialog,action:pe.uk.view},{entityCommand:this.getDefaultEntityCommand(t,ve.su.extend),entityOptions:e})}launchSharedChannelsPastePermissionsFluid(e){return this.extensionCommanding.executeCommand({type:pe.py.fluid,action:pe.uk.info},{entityCommand:e})}getDefaultEntityCommand(e,t=ve.su.flush){return{stateTransition:t,visibilityState:ve.fe.show,correlation:{source:e}}}}const vn=e=>{if(!e)return{teamId:void 0,channelId:void 0,replyChainId:void 0};try{const{teamId:t,channelId:i,replyChainId:n}=JSON.parse(e);return{teamId:t,channelId:i,replyChainId:n}}catch(t){return{channelId:e}}};var fn=i(281710);class bn{constructor(e,t,i,n){this.commandHandler=e,this.extensionCommanding=t,this.coreSettings=i,this._logger=n.newLogger("ChatCommandingService","core-services-entity-commanding")}default(e){return this.handleCommandWithChecks({entity:{type:pe.py.chats,action:pe.uk.default},command:e})}empty(e){return this.handleCommandWithChecks({entity:{type:pe.py.chats,action:pe.uk.empty},command:e})}chatList(e,t){return this.handleCommandWithChecks({entity:{type:pe.py.chats,action:pe.uk.list},entityOptions:null==t?void 0:t.entityOptions,command:e})}getChatByIdCommand(e,t,i){var n;const a=i&&(null===(n=null==t?void 0:t.entityOptions)||void 0===n?void 0:n.isBYODMode)?{type:pe.py.calls,id:i}:null,s={entity:{type:pe.py.chats,action:pe.uk.view,id:e,linkedEntity:a},entityOptions:null==t?void 0:t.entityOptions,command:null==t?void 0:t.entityCommand,scenarioEventData:null==t?void 0:t.scenarioEventData};return this.checkPolicies(s),s}chatById(...e){const t=this.getChatByIdCommand(...e);return this.commandHandler(t)}byodChatById(...e){const t=this.getByodChatByIdCommand(...e);return this.commandHandler(t)}chatChannelConversationById(e,t,i){const n={channelId:e,replyChainId:t};return this.handleCommandWithChecks({entity:{type:pe.py.chatschannelconv,action:pe.uk.view,id:JSON.stringify(n)},entityOptions:null==i?void 0:i.entityOptions,command:null==i?void 0:i.entityCommand,scenarioEventData:null==i?void 0:i.scenarioEventData})}chatWithUsers(e){const t=(0,fn.Mf)((null==e?void 0:e.userIds)||[],null==e?void 0:e.entityCommand);return this.handleCommandWithChecks(Object.assign(Object.assign({},t),{entityOptions:null==e?void 0:e.entityOptions}))}chatWithGuardians(e,t,i,n,a,s){const o=(0,fn.Mf)(t||[],s),r={groupName:i,isGuardiansChat:!0,guardiansChatGroupId:e,guardiansChatStudentId:n,guardiansPreferredToAlternateMriMappings:a};return this.handleCommandWithChecks(Object.assign(Object.assign({},o),{entityOptions:r}))}orgChat(e,t){return this.handleCommandWithChecks({entity:{type:pe.py.extensions,action:pe.uk.view,id:ve.oz.organization,linkedEntity:{type:pe.py.chats,id:(0,fn.f$)([e])}},command:t})}linkedIn(e,t){return this.handleCommandWithChecks({entity:{type:pe.py.extensions,action:pe.uk.view,id:ve.oz.linkedin,linkedEntity:{type:pe.py.chats,id:(0,fn.f$)([e])}},command:t})}openLpcInMainWindow(e,t){return this.commandHandler({entity:{type:pe.py.livepersonacard,action:pe.uk.view},command:t,entityOptions:e})}launchAltText(e,t){return this.extensionCommanding.executeCommand({type:pe.py.alttext,action:pe.uk.view},{entityCommand:t,entityOptions:{element:e}})}launchAddNewComponentFluid(e){return this.extensionCommanding.executeCommand({type:pe.py.fluid,action:pe.uk.confirm},{entityCommand:e})}launchInsertHyperlink(e,t,i){return this.extensionCommanding.executeCommand({type:pe.py.hyperlink,action:pe.uk.view},{entityCommand:i,entityOptions:{displayText:e,address:t}})}launchDiscardCodeSnippet(e){return this.extensionCommanding.executeCommand({type:pe.py.codesnippet,action:pe.uk.delete},{entityCommand:e})}launchTranslationFeedbackDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.translationfeedback,action:pe.uk.view},{entityCommand:t,entityOptions:e})}launchTwoWaySmsFriendlyNameDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.twowaysmsfriendlyname,action:pe.uk.view},{entityCommand:t,entityOptions:e})}launchDeleteChat(e,t){return this.extensionCommanding.executeCommand({type:pe.py.deletechat,action:pe.uk.delete},{entityCommand:t,entityOptions:e})}launchDiscardFluid(e,t){return this.extensionCommanding.executeCommand({type:pe.py.fluid,action:pe.uk.delete},{entityCommand:t,entityOptions:{isCompose:e}})}launchPastePermissionsFluid(e,t,i,n,a){return this.extensionCommanding.executeCommand({type:pe.py.fluid,action:pe.uk.manage},{entityCommand:a,entityOptions:{displayTitle:e,displayText:t,cancelButtonContent:i,confirmButtonContent:n}})}launchUpdatePermissionsFluid(e,t){return this.extensionCommanding.executeCommand({type:pe.py.fluid,action:pe.uk.update},{entityCommand:t,entityOptions:{recipientList:e}})}launchUnpinMessageFromChat(e){return this.extensionCommanding.executeCommand({type:pe.py.pinnedconversationitems,action:pe.uk.delete},{entityCommand:e})}launchReplaceMessageFromChat(e){return this.extensionCommanding.executeCommand({type:pe.py.pinnedconversationitems,action:pe.uk.update},{entityCommand:e})}launchDiscardMessageDraft(e,t,i,n){return this.extensionCommanding.executeCommand({type:pe.py.messagedraft,action:pe.uk.delete},{entityCommand:n,entityOptions:{isBranded:e,workload:t,isEditing:i}})}launchGiphyConsent(e){return this.extensionCommanding.executeCommand({type:pe.py.giphyconsent,action:pe.uk.view},{entityCommand:e})}launchLeaveChat(e){return this.extensionCommanding.executeCommand({type:pe.py.leavechat,action:pe.uk.delete},{entityCommand:e})}launchSendFeedback(e,t,i,n,a,s,o,r){return this.extensionCommanding.executeCommand({type:e,action:pe.uk.view},{entityCommand:t,entityOptions:{convId:i,serverMessageId:n,traceId:a,bizChatConversationId:s,endpoint:o,utteranceTimestamp:r}})}launchChatInviteConfirmation(e){return this.extensionCommanding.executeCommand({type:pe.py.chatInviteConfirmation,action:pe.uk.view},{entityCommand:e})}launchMaxPinnedChatsReached(e,t){return this.extensionCommanding.executeCommand({type:pe.py.pinnedchatsmaxreached,action:pe.uk.view},{entityCommand:t,entityOptions:{maxPinnedChats:e}})}launchUpdateGroupChatAvatar(e,t){return this.extensionCommanding.executeCommand({type:pe.py.updategroupchatavatar,action:pe.uk.view},{entityCommand:t,entityOptions:{threadId:e}})}launchTfwUpdateGroupChatAvatar(e,t,i){return this.extensionCommanding.executeCommand({type:pe.py.tfwupdategroupchatavatar,action:pe.uk.view},{entityCommand:i,entityOptions:{threadId:e,avatarUrl:t}})}launchRemoveChatUser(e,t,i){return this.extensionCommanding.executeCommand({type:pe.py.removechatuser,action:pe.uk.delete},{entityCommand:i,entityOptions:{userName:e,isRemoveTfwUserInTflChat:t}})}launchShareChatLink(e,t,i,n,a,s,o,r){return this.extensionCommanding.executeCommand({action:pe.uk.view,id:e,type:pe.py.sharechatlink},{entityCommand:r,entityOptions:{chatTitle:t,tenantId:i,hasError:n,sharedLink:a,cfet:s,panelType:o}})}launchChatError(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.chats,action:pe.uk.error},{entityCommand:t})}launchStreamCamera(e){return this.extensionCommanding.executeCommand({type:pe.py.streamcamera,action:pe.uk.default,id:null==e?void 0:e.correlation.id},{entityCommand:e})}launchStreamCameraInChannels(e){return this.extensionCommanding.executeCommand({type:pe.py.streamcamerainchannels,action:pe.uk.default,id:null==e?void 0:e.correlation.id},{entityCommand:e})}launchStreamCameraInCommunities(e){return this.extensionCommanding.executeCommand({type:pe.py.streamcameraincommunities,action:pe.uk.default,id:null==e?void 0:e.correlation.id},{entityCommand:e})}meetingRecapTab(e,t,i){return this.handleCommandWithChecks({entity:{type:i||pe.py.meetingrecaptab,action:pe.uk.view,id:e.threadId},command:t,entityOptions:e})}transcriptTab(e,t,i,n,a,s,o){return this.handleCommandWithChecks({entity:{type:pe.py.transcripttab,action:pe.uk.view,id:t},entityOptions:{conversationId:e,storageId:i,teamsCallId:n,meetingOrganizerId:a,meetingTenantId:s,eventId:o}})}launchReportConcern(e,t){return this.extensionCommanding.executeCommand({type:pe.py.reportConcern,action:pe.uk.create},{entityCommand:t,entityOptions:e})}launchForwardMessage(e,t){return this.extensionCommanding.executeCommand({type:pe.py.forwardMessage,action:pe.uk.create},{entityCommand:t,entityOptions:e})}launchReportConcernV2(e,t){return this.extensionCommanding.executeCommand({type:pe.py.reportConcernForTFW,action:pe.uk.create},{entityCommand:t,entityOptions:e})}launchReportConcernTY(e){return this.extensionCommanding.executeCommand({type:pe.py.reportConcern,action:pe.uk.info},{entityCommand:e})}launchReportConcernV2Confirmation(e){return this.extensionCommanding.executeCommand({type:pe.py.reportConcernForTFW,action:pe.uk.info},{entityCommand:e})}launchDlpDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.dlp,action:pe.uk.view},{entityCommand:t,entityOptions:e})}chatInfoPane(e,t,i){return this.handleCommandWithChecks({entity:{type:pe.py.chatsInfoView,action:pe.uk.info,id:e},command:t,entityOptions:i})}chatContextualSearch(e,t,i){return this.handleCommandWithChecks({entity:{type:pe.py.chatContextualSearch,action:pe.uk.info,id:e},command:t,entityOptions:i})}chatHighlightsDetails(e,t,i){return this.handleCommandWithChecks({entity:{type:pe.py.chatHighlightsDetails,action:pe.uk.info,id:e},command:t,entityOptions:i})}manage(e,t){return this.handleCommandWithChecks({entity:{type:pe.py.chatManageApps,action:pe.uk.manage,id:e,linkedEntity:{type:pe.py.chats,id:e}},command:t})}chatInfoPaneDetails(e,t,i,n){return this.handleCommandWithChecks({entity:{type:n||pe.py.chatsInfo,action:pe.uk.infoDetails,id:e},command:t,entityOptions:i})}launchBlockChatDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.blockChat,action:pe.uk.view},{entityCommand:t,entityOptions:e})}launchLeaveGroupAndBlockUserDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.leaveGroupAndBlockUser,action:pe.uk.view},{entityCommand:t,entityOptions:e})}launchCustomizeReactions(e){return this.extensionCommanding.executeCommand({type:pe.py.customizereactions,action:pe.uk.view},{entityCommand:e})}launchCustomEmojiUpload(e,t){return this.extensionCommanding.executeCommand({type:pe.py.customemojiupload,action:pe.uk.view},{entityCommand:t,entityOptions:{blobUrl:e}})}handleCommandWithChecks(e){return this.checkPolicies(e),this.commandHandler(e)}checkPolicies(e){var t,i,n;if(this.coreSettings.get(S.J.Messaging).allowUserChat||(null===(t=e.entity.id)||void 0===t?void 0:t.startsWith("19:meeting")))return;const{type:a,action:s}=e.entity,o=`${h.w5.Commanding}::${h.jK.PolicyCheckFailed}::Chat command not allowed due to policy (allowUserChat=false)`;null===(n=(i=this._logger).errorToTelemetry)||void 0===n||n.call(i,o,"messaging_command_policy_violation",{mainEntityType:a,mainEntityAction:s})}getByodChatByIdCommand(e,t,i){const n={entity:{type:pe.py.byodchat,action:pe.uk.view,id:e,linkedEntity:{type:pe.py.byodattendeewindow,id:i||""}},entityOptions:null==t?void 0:t.entityOptions,command:null==t?void 0:t.entityCommand,scenarioEventData:null==t?void 0:t.scenarioEventData};return this.checkPolicies(n),n}}class yn{constructor(e){this.commandHandler=e}coachReport(e,t){return this.commandHandler({entity:{type:pe.py.coachreport,action:pe.uk.view,linkedEntity:{type:pe.py.chats,id:t?t.threadId:""}},command:e,entityOptions:t})}}class kn{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}showAddMemberDialog(e,t){return this.commandHandler({entity:{id:e,type:pe.py.communitiesaddmember,action:pe.uk.view},entityOptions:{},command:t})}showCreateChannelDialog(e,t){return this.commandHandler({entity:{id:e,type:pe.py.communitiescreatechannel,action:pe.uk.view},entityOptions:{},command:t})}showEditChannelDialog(e,t){return this.commandHandler({entity:{id:e,type:pe.py.communitieseditchannel,action:pe.uk.view},entityOptions:{},command:t})}showDeleteChannelDialog(e,t){return this.commandHandler({entity:{id:e,type:pe.py.communitiesdeletechannel,action:pe.uk.view},entityOptions:{},command:t})}showCommunityLinkDialog(e,t,i){var n;const a=null!=i?i:{};return this.commandHandler({entity:{action:pe.uk.view,id:e,type:pe.py.sharecommunitieslink},entityOptions:Object.assign(Object.assign({},a),{source:null===(n=null==t?void 0:t.correlation)||void 0===n?void 0:n.source}),command:t})}showEmbedCommunityCodeDialog(e,t){return this.commandHandler({entity:{action:pe.uk.view,id:e,type:pe.py.embedcommunitycodedialog},entityOptions:{},command:t})}showCommunityGuidelinesDialog(e,t){return this.commandHandler({entity:{action:pe.uk.view,id:e,type:pe.py.communitiesguidelinesdialog},entityOptions:{},command:t})}showCommunityGetAppDialog(e){return this.commandHandler({entity:{action:pe.uk.view,type:pe.py.communitiesgetappdialog},entityOptions:{},command:e})}showCommunitiesCreateDialog(e){return this.commandHandler({entity:{action:pe.uk.view,type:pe.py.communitiescreatedialog},entityOptions:{},command:e})}showCommunitiesEditDialog(e,t){return this.commandHandler({entity:{action:pe.uk.view,type:pe.py.communitieseditdialog,id:e},entityOptions:{},command:t})}showReportConcernDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.reportconcerncommunities,action:pe.uk.create},{entityCommand:t})}showRemoveMemberDialog(e,t,i){return this.extensionCommanding.executeCommand({id:e,type:pe.py.communitiesremovemember,action:pe.uk.view},{entityOptions:Object.assign({},t),entityCommand:i})}showReportConcernTY(e,t){return this.commandHandler({entity:{type:pe.py.reportconcerncommunities,action:pe.uk.view,id:e},entityOptions:{},command:t})}showSendPostAsEmailDialog(e,t){return this.commandHandler({entity:{type:pe.py.communitiessendpostasemaildialog,action:pe.uk.view,id:e},entityOptions:{},command:t})}showWelcomeBotConfigDialog(e,t){return this.commandHandler({entity:{type:pe.py.communitieswelcomebotconfigdialog,action:pe.uk.view,id:e},entityOptions:{},command:t})}showLeaveCommunityDialog(e,t){return this.commandHandler({entity:{id:e,type:pe.py.leavecommunity,action:pe.uk.view},entityOptions:{},command:t})}showOwnerLeaveCommunityDialog(e,t){return this.commandHandler({entity:{id:e,type:pe.py.ownerleavecommunity,action:pe.uk.view},entityOptions:{},command:t})}openDialog(e,t,i,n){return this.commandHandler({entity:{id:t,type:e,action:null!=n?n:pe.uk.view},entityOptions:{},command:i})}communityMessagesById(e,t,i,n,a,s,o){const r={channelId:e,replyChainId:t};return localStorage.setItem("communities-selected-id",e),localStorage.setItem("communities-selected-reply-id",t||""),this.commandHandler({entity:{type:pe.py.communities,action:null!=o?o:pe.uk.view,id:JSON.stringify(r)},command:n,entityOptions:Object.assign(Object.assign({},a),{source:null==n?void 0:n.correlation.source,deepLinkId:i}),scenarioEventData:null==s?void 0:s.scenarioEventData})}getCommunityEvents(e,t){return this.commandHandler({entity:{type:pe.py.communitiesevents,action:pe.uk.view,id:JSON.stringify({channelId:e})},command:Object.assign({stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:k.D.CommunitiesEventsButton}},t)})}showCreateCommunityEvent(e){const t={stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:k.D.CommunitiesCreateEventButton}};return this.commandHandler({entity:{type:pe.py.communitiescreateevent,action:pe.uk.view,id:JSON.stringify({channelId:e})},command:t,entityOptions:{isGroup:!0,conversationId:e}})}getOnboardingView(e,t,i){return this.getView(pe.py.communitiesonboarding,null!=e?e:pe.uk.view,t,k.D.CommunitiesOnboarding,i)}getCommunitiesJoinView(e,t,i){const n={channelId:e,replyChainId:t},a=e?JSON.stringify(n):void 0;return this.commandHandler({entity:{type:pe.py.communities,action:pe.uk.join,id:a},command:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:k.D.CommunitiesInviteLink}},entityOptions:{messageId:t,inviteLinkUrl:i}})}navigateToCommunityId(e,t,i,n,a){const s={stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:i||k.D.Unknown}};return this.communityMessagesById(e,n,void 0,s,a?{enqueSwitch:!0}:void 0,void 0,t?pe.uk.default:void 0)}showCommunitiesManage(e,t,i,n){var a;localStorage.setItem("current-enitity-type",pe.py.communitiesmembers);const s=(null==i?void 0:i.source)||(null===(a=null==t?void 0:t.correlation)||void 0===a?void 0:a.source)||k.D.CommunitiesManage;return this.commandHandler({entity:{type:pe.py.communitiesmembers,action:pe.uk.view,id:e},entityOptions:Object.assign(Object.assign({},i),{source:s}),command:Object.assign({stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:s}},t),scenarioEventData:null==n?void 0:n.scenarioEventData})}showCommunitiesBlockMembers(e,t){var i;return this.commandHandler({entity:{type:pe.py.communitiesblockmembers,action:pe.uk.view,id:e},command:Object.assign({stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:(null===(i=null==t?void 0:t.correlation)||void 0===i?void 0:i.source)||k.D.CommunitiesManage}},t)})}showCommunitiesSettings(e,t){return this.commandHandler({entity:{type:pe.py.communitiessettings,action:pe.uk.view,id:e},command:Object.assign({stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:k.D.CommunitiesManageLink}},t)})}showCommunitiesManageMemberRequests(e,t,i,n){var a;const s=(null==i?void 0:i.source)||(null===(a=null==t?void 0:t.correlation)||void 0===a?void 0:a.source)||k.D.CommunitiesManage;return this.commandHandler({entity:{type:pe.py.communitiesjoinrequest,action:pe.uk.view,id:e},command:Object.assign({stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:s}},t),entityOptions:Object.assign(Object.assign({},i),{source:s}),scenarioEventData:null==n?void 0:n.scenarioEventData})}showCommunityJoinView(e,t,i,n,a){return this.commandHandler({entity:{type:pe.py.communitiesjoininviteview,action:pe.uk.join,id:e},command:t,entityOptions:Object.assign(Object.assign({},i),{activityId:a}),scenarioEventData:null==n?void 0:n.scenarioEventData})}showPerCommunityNotificationSettingsDialog(e,t){return this.commandHandler({entity:{action:pe.uk.view,id:e,type:pe.py.percommunitynotificationsettingsdialog},entityOptions:{},command:t})}getView(e,t,i,n,a,s){const o={channelId:s,replyChainId:a},r=s?JSON.stringify(o):void 0;return this.commandHandler(Object.assign({entity:{id:r,type:e,action:null!=t?t:pe.uk.default},command:{stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:n||k.D.ChannelListItem}}},t===pe.uk.join?{entityOptions:{inviteLinkUrl:i,messageId:a}}:{}))}}class Sn{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}openContactsSyncPopout(e){return this.commandHandler({entity:{type:pe.py.contactssync,action:pe.uk.default,id:"default"},command:(null==e?void 0:e.entityCommand)||{stateTransition:ve.su.new,visibilityState:ve.fe.show,correlation:{source:k.D.Flyout}},windowOptions:null==e?void 0:e.windowOptions})}openContactsSyncModal(){return this.extensionCommanding.executeCommand({type:pe.py.contactssync,action:pe.uk.view,id:"default"})}launchContactsModal(e,t){return this.extensionCommanding.executeCommand({type:pe.py.contactssync,action:pe.uk.info,id:e},{entityCommand:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:t}})}showHideContactsView(e,t,i){return this.commandHandler({entity:{type:pe.py.contactssync,action:pe.uk.view,id:e},command:{stateTransition:ve.su.flush,visibilityState:i?ve.fe.show:ve.fe.hide,correlation:t}})}}class wn{constructor(e){this.commandHandler=e}discoverApps(e,t){return this.commandHandler({entity:{type:pe.py.discoverappsnotifications,action:pe.uk.view},command:t,entityOptions:e})}}class jn{constructor(e,t){this.commandHandler=e,this.loggerFactory=t,this.logger=this.loggerFactory.newLogger("DiscoverSurfaceCommandingService","core-services-entity-commanding")}showDiscoverSurface(e){return this.logger.log(`showDiscoverSurface: called with - ${pe.py.discoversurface}:${pe.uk.view}`),this.commandHandler({entity:{type:pe.py.discoversurface,action:pe.uk.view},command:null==e?void 0:e.entityCommand,entityOptions:null==e?void 0:e.entityOptions})}}class Cn{constructor(e){this.commandHandler=e}launchErrorApp(e){return this.commandHandler({entity:{type:pe.py.error,action:pe.uk.view},command:{stateTransition:ve.su.forceFlush,visibilityState:ve.fe.show,correlation:{source:k.D.LayoutError}},entityOptions:{errorReason:e.code}})}}class _n{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t,this.entityAllowList=[pe.py.esp,pe.py.help,pe.py.storefre,pe.py.whatsnewdialog]}displaySurface(e,t,i){return this.commandHandler({entity:{type:pe.py.esp,action:pe.uk.create,id:e},entityOptions:{forceShow:t,customParams:i}})}displayFollowUpSurface(e,t){const i=xe.LQM.FollowUp;return this.commandHandler({entity:{type:pe.py.esp,action:pe.uk.create,id:e},entityOptions:{forceShow:t,espTrigger:i}})}launchDialog(e,t){let i=pe.py.esp;if(t){if(!this.entityAllowList.includes(t))throw new Error("launchDialog must be called with Entity from the allow list.");i=t}return this.extensionCommanding.executeCommand({id:e,type:i,action:pe.uk.view})}closeDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:null!=t?t:pe.py.esp,action:pe.uk.view},{entityCommand:{visibilityState:ve.fe.hide,stateTransition:ve.su.extend,correlation:{source:k.D.ExtensionCommanding}}})}navigate(e,t,i){return this.commandHandler({entity:e,command:t,entityOptions:i})}}class Tn{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}surveyDialogWithObserver(e,t,i){var n;const a=Object.assign(Object.assign({},i),{source:null===(n=null==t?void 0:t.correlation)||void 0===n?void 0:n.source,entityStateTransition:null==t?void 0:t.stateTransition});return this.extensionCommanding.executeCommand({action:pe.uk.view,type:pe.py.survey,id:e},{entityCommand:t,entityOptions:a})}surveyDialog(e,t,i){var n;const a=Object.assign(Object.assign({},i),{source:null===(n=null==t?void 0:t.correlation)||void 0===n?void 0:n.source,entityStateTransition:null==t?void 0:t.stateTransition});return this.commandHandler({entity:{type:pe.py.survey,action:pe.uk.view,id:e},command:t,entityOptions:a})}giveFeedbackDialog(e){return this.commandHandler({entity:{type:pe.py.givefeedbackchoices,action:pe.uk.view},command:e})}}class In{constructor(e,t){this.extensionCommanding=e,this.commandHandler=t}galleryImage(e,t){const i=e.galleryId,n={type:pe.py.galleryImages,action:pe.uk.view,id:i};return this.commandHandler({entity:n,command:t,entityOptions:e})}galleryImageExtended(e,t){const i=e.galleryId,n={type:pe.py.galleryImages,action:pe.uk.view,id:i};return this.extensionCommanding.executeCommand(n,{entityCommand:t,entityOptions:e})}fileById(e){const t=e.fileId;return this.commandHandler({entity:{type:pe.py.file,action:pe.uk.view,id:t},entityOptions:e})}launchFileViewApp(e,t,i=k.D.FileViewer){const n={subEntityId:JSON.stringify(t)};return this.commandHandler({entity:{type:pe.py.extensions,action:pe.uk.view,id:JSON.stringify({appId:e,fileId:t.fileId.toLowerCase()}),linkedEntity:{id:JSON.stringify(n),type:pe.py.extensions}},command:{visibilityState:ve.fe.show,stateTransition:t.shouldOpenInMultiWindow?ve.su.new:ve.su.flush,correlation:{source:i}},entityOptions:{entryPoint:"personalApp"}})}openInOneup(e,t=k.D.FileViewer){const i=e.fileId;let n,a;switch(e.context){case"channelsPDFTab":{const t={channelId:e.threadId,replyChainId:void 0};a={type:pe.py.filesoneupviewer,action:pe.uk.view,id:e.entityId,linkedEntity:{id:JSON.stringify(t),type:pe.py.channels}},n=k.D.ChannelHeader;break}case"chatPDFTab":a={type:pe.py.filesoneupviewer,action:pe.uk.view,id:e.entityId,linkedEntity:{id:e.threadId?e.threadId:"",type:pe.py.chats}},n=k.D.ChatHeader;break;case"ChannelMakeAsATab":{const t={channelId:e.threadId,replyChainId:void 0};a={type:pe.py.extensions,action:pe.uk.view,id:e.entityId,linkedEntity:{id:JSON.stringify(t),type:pe.py.channels}},n=k.D.ChannelHeader;break}default:a={type:pe.py.filesoneupviewer,action:pe.uk.view,id:i},n=t}return this.commandHandler({entity:a,command:{visibilityState:ve.fe.show,stateTransition:e.shouldOpenInMultiWindow?ve.su.new:ve.su.flush,correlation:{id:(0,qe.v4)(),source:n}},entityOptions:e})}closeOneup(e,t=k.D.FileViewer){return this.commandHandler({entity:{type:pe.py.filesoneupviewer,action:pe.uk.view,id:e},command:{visibilityState:ve.fe.hide,stateTransition:ve.su.flush,correlation:{source:t}}})}fileOpenSettingsSuggestion(e){return this.commandHandler({entity:{type:pe.py.fileopensettings,action:pe.uk.info},entityOptions:e})}fileOpenSettingsUpdate(e){return this.commandHandler({entity:{type:pe.py.fileopensettings,action:pe.uk.update},entityOptions:e})}chatFilesList(e,t){return this.commandHandler({entity:{id:null,type:pe.py.file,action:pe.uk.list,linkedEntity:{type:pe.py.chats,id:e}},command:t})}photosList(e,t){return this.commandHandler({entity:{id:null,type:pe.py.gallery,action:pe.uk.view,linkedEntity:{type:pe.py.chats,id:e}},command:t})}launchFilePicker(e,t,i,n){return this.extensionCommanding.executeCommand({type:pe.py.filepicker,action:pe.uk.view},{entityCommand:i,entityOptions:{fileContainerKey:e,filePickerContext:t,filePickerConfigurationOverrides:n}})}launchCloudStorageDialog(e,t,i){return this.extensionCommanding.executeCommand({type:pe.py.cloudStorageDialog,action:pe.uk.view},{entityCommand:i,entityOptions:{isClassMaterialRequired:e,channelId:t}})}}class Nn{constructor(e){this.commandHandler=e}launchFlyoutHomePage(){const e={id:(0,qe.v4)(),source:k.D.Flyout,startTimestamp:Date.now()};return this.commandHandler({entity:{type:pe.py.flyout,action:pe.uk.default},command:{correlation:e,stateTransition:ve.su.flush,visibilityState:ve.fe.show,layoutMode:ve.lO.minimal}})}showPhonelinkPairingPage(e){const t={id:(0,qe.v4)(),source:k.D.Flyout,startTimestamp:Date.now()};return this.commandHandler({entity:{id:e,type:pe.py.flyoutphonelink,action:pe.uk.default},command:{correlation:t,stateTransition:ve.su.flush,visibilityState:ve.fe.show,layoutMode:ve.lO.minimal}})}showFlyoutWhatsNew(){const e={id:(0,qe.v4)(),source:k.D.Flyout,startTimestamp:Date.now()};return this.commandHandler({entity:{type:pe.py.flyoutwhatsnew,action:pe.uk.default},command:{correlation:e,stateTransition:ve.su.flush,visibilityState:ve.fe.show,layoutMode:ve.lO.minimal}})}openMinimodeMeetingScheduler(){const e={id:(0,qe.v4)(),source:k.D.Flyout,startTimestamp:Date.now()};return this.commandHandler({entity:{type:pe.py.minimodeMeetingScheduler,action:pe.uk.view},command:{correlation:e,stateTransition:ve.su.new,visibilityState:ve.fe.show}})}closeMinimodeMeetingScheduler(){const e={id:(0,qe.v4)(),source:k.D.Flyout,startTimestamp:Date.now()};return this.commandHandler({entity:{type:pe.py.minimodeMeetingScheduler,action:pe.uk.view},command:{correlation:e,visibilityState:ve.fe.hide,stateTransition:ve.su.forceFlush}})}}class En{constructor(e){this.commandHandler=e}freemiumUpgrade(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.commandHandler({entity:{type:pe.py.freemiumupgrade,action:pe.uk.view},command:e,entityOptions:t})}))}}class Fn{constructor(e,t){this.extensionCommanding=e,this.commandHandler=t}guardiansTabInChannelById(e,t,i,n){const a={type:pe.py.guardians,action:pe.uk.list,id:e,linkedEntity:i};return this.commandHandler({entity:a,command:t,entityOptions:n})}showGuardiansApprovalRequestDialog(e,t){const i={type:pe.py.guardiansapprovalrequest,action:pe.uk.create};return this.commandHandler({entity:i,command:e,entityOptions:t})}showSendApprovalSuccessDialog(e){const t={type:pe.py.guardianssendapprovalsuccess,action:pe.uk.create};return this.extensionCommanding.executeCommand(t,{entityCommand:e})}showSendApprovalErrorDialog(e){const t={type:pe.py.guardianssendapprovalerror,action:pe.uk.create};return this.extensionCommanding.executeCommand(t,{entityCommand:e})}}class xn{constructor(e){this.commandHandler=e}launchTflHomepage(){const e={id:(0,qe.v4)(),source:k.D.Homepage,startTimestamp:Date.now()};return this.commandHandler({entity:{type:pe.py.homepage,action:pe.uk.default},command:{correlation:e,stateTransition:ve.su.flush,visibilityState:ve.fe.show}})}}class Dn{constructor(e){this.extensionCommanding=e}showCreatePostDialog(e,t,i,n){return this.extensionCommanding.executeCommand({type:pe.py.classesintegrationcontent,action:pe.uk.create},{entityCommand:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:k.D.LmsCourseTeams}},entityOptions:{teamId:e,teamName:t,groupId:i,tenantId:n}})}}class An{constructor(e){this.commandHandler=e}viewLobNotifications(e,t){return this.commandHandler({entity:{type:pe.py.lobnotifications,action:pe.uk.view},command:t,entityOptions:e})}}class Mn{constructor(e){this.commandHandler=e}analytics(e,t){return this.commandHandler({entity:{type:pe.py.meetinganalytics,action:pe.uk.view},command:e,entityOptions:t})}openAttendanceTabInSchedulingForm(e,t,i="",n=0){return this.commandHandler({entity:{type:pe.py.attendancereport,action:pe.uk.view,linkedEntity:{type:pe.py.schedulingform,action:pe.uk.view,id:JSON.stringify({eventId:(0,fn.cW)(i),providerType:n})}},command:e,entityOptions:Object.assign(Object.assign({},t),{eventId:(0,fn.cW)(i)})})}openAnalyticsInSchedulingForm(e,t,i="",n=0){return this.commandHandler({entity:{type:pe.py.meetinganalytics,action:pe.uk.view,linkedEntity:{type:pe.py.schedulingform,action:pe.uk.view,id:JSON.stringify({eventId:(0,fn.cW)(i),providerType:n})}},command:e,entityOptions:Object.assign(Object.assign({},t),{eventId:(0,fn.cW)(i)})})}openAttendanceTabInMeetingChat(e,t){return this.commandHandler({entity:{type:pe.py.meetinganalytics,action:pe.uk.view},command:e,entityOptions:{threadId:t}})}openAttendanceTabInMeetingRecapOfChat(e,t){return this.commandHandler({entity:{type:pe.py.meetinganalytics,action:pe.uk.view,linkedEntity:{type:pe.py.chats,action:pe.uk.view,id:(null==t?void 0:t.threadId)||""}},command:e,entityOptions:t})}}class Pn{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}meetingOptionsFormView(e,t,i,n,a,s){return this.commandHandler({entity:{type:pe.py.meetings,action:pe.uk.view,id:this.serializeMeetingCoordinates(e,t,i,n,a)},command:s})}meetingOptionsCreateViewDialog(e,t,i){const n={type:pe.py.meetingoptionscreatedialog,id:e.id,action:e.action};return this.extensionCommanding.executeCommand(n,{entityCommand:t,entityOptions:i})}serializeMeetingCoordinates(e,t,i,n,a){return JSON.stringify({tenantId:e,organizerId:t,threadId:i,messageId:n,additionalMessageId:a})}}class On{constructor(e){this.commandHandler=e}recapTabInMeetingChat(e,t,i){return this.commandHandler({entity:{type:pe.py.meetingrecap,action:pe.uk.view,linkedEntity:i?{type:pe.py.chats,action:pe.uk.view,id:(null==t?void 0:t.threadId)||""}:null},command:e,entityOptions:t})}recapTabInSchedulingForm(e,t,i){return this.commandHandler({entity:{type:pe.py.meetingrecap,action:pe.uk.view,linkedEntity:{type:pe.py.schedulingform,action:pe.uk.view,id:JSON.stringify({eventId:(0,fn.cW)((null==t?void 0:t.externalEntityKey)||""),providerType:i})}},command:e,entityOptions:t})}popOutMeetingRecap(e){const t={id:(0,qe.v4)(),source:k.D.ChatListItem,startTimestamp:Date.now()},{externalEntityKey:i,threadId:n}=e||{};return this.commandHandler({entity:{type:pe.py.meetingrecap,action:pe.uk.view,id:i||n},command:{stateTransition:ve.su.new,visibilityState:ve.fe.show,correlation:t},entityOptions:Object.assign(Object.assign({},e),{subType:"popup"})})}}var Rn;!function(e){e.JoinByCode="JoinByCode",e.Dialpad="Dialpad",e.Cortana="Cortana",e.SmartDeviceJoinByCode="SmartDeviceJoinByCode"}(Rn||(Rn={}));class Ln{constructor(e){this.commandHandler=e}meetingRoomConsoleInCallById(e,t,i){return this.commandHandler({entity:{type:pe.py.meetingroomconsolecall,action:pe.uk.view,id:e},entityOptions:t,command:i})}meetingRoomNewCall(e){return this.commandHandler({entity:{type:e,action:pe.uk.create},entityOptions:{stateParams:{isPstnCall:!0},createCallType:Rn.Dialpad},command:{stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:k.D.Calling}}})}meetingRoomBroadcast(e){return this.commandHandler({entity:{type:pe.py.meetingroomconsolecall,action:pe.uk.share},command:e})}meetingRoomSmartDeviceJoinByCode(e){return this.commandHandler({entity:{type:pe.py.meetingroomconsolecall,action:pe.uk.create},entityOptions:{createCallType:Rn.SmartDeviceJoinByCode},command:e})}meetingRoomJoinByCode(e,t){return this.commandHandler({entity:{type:e,action:pe.uk.create},entityOptions:{createCallType:Rn.JoinByCode},command:t})}meetingRoomHome(e){return this.commandHandler({entity:{type:pe.py.meetingroomconsolecall,action:pe.uk.list},entityOptions:{},command:e})}meetingRoomPostCall(e,t){return this.commandHandler({entity:{type:pe.py.meetingroomconsolecall,action:pe.uk.health},entityOptions:t,command:e})}meetingRoomFrontOfRoom(e,t){return this.commandHandler({entity:{type:e,action:pe.uk.create},command:t})}}class Un{constructor(e){this.commandHandler=e}viewOnboardingNotifications(e,t){return this.commandHandler({entity:{type:pe.py.onboardingnotifications,action:pe.uk.view},command:t,entityOptions:e})}}var $n=i(554404);class Wn{constructor(e,t,i){this.commandHandler=e,this.extensionCommanding=t,this.coreSettings=i}launchTaskModule(e,t){const i=(null==t?void 0:t.entityCommand)||this.getDefaultExtensionCommand();return i.visibilityState=ve.fe.show,this.extensionCommanding.executeCommand({id:e,type:pe.py.taskmodule,action:pe.uk.create},{entityCommand:i,entityOptions:null==t?void 0:t.taskModuleOptions})}launchHWCTaskModule(e,t){const i=(null==t?void 0:t.entityCommand)||this.getDefaultExtensionCommand();return i.visibilityState=ve.fe.show,this.extensionCommanding.executeCommand({id:e,type:pe.py.hwctaskmodule,action:pe.uk.create},{entityCommand:i,entityOptions:null==t?void 0:t.taskModuleOptions})}launchStage(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultExtensionCommand();return t.visibilityState=ve.fe.show,this.extensionCommanding.executeCommand({type:pe.py.platformStage,action:pe.uk.view},{entityCommand:t,entityOptions:null==e?void 0:e.stageOptions})}launchReactStageModal(e,t,i){const n=i||this.getDefaultExtensionCommand();return this.extensionCommanding.executeCommand({id:e,type:pe.py.platformstagemodal,action:pe.uk.view},{entityCommand:n,entityOptions:t})}launchStageMW(e){return this.commandHandler({entity:{id:e.id,type:pe.py.platformStage,action:pe.uk.create,linkedEntity:e.linkedEntity},command:{stateTransition:ve.su.new,visibilityState:ve.fe.show,correlation:{source:k.D.PlatformExtension,startTimestamp:e.stageOptions.scenarioStartTime}},entityOptions:e.stageOptions})}launchTabGallery(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultExtensionCommand();return t.visibilityState=ve.fe.show,this.extensionCommanding.executeCommand({type:pe.py.platformTabGallery,action:pe.uk.view},{entityCommand:t,entityOptions:null==e?void 0:e.tabGalleryOptions})}launchUnsupportedDeeplinkDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.unsupporteddeeplinkdialog,action:pe.uk.view},{entityOptions:{originalDeeplink:e}})}launchAppDetails(e,t){const i=(null==t?void 0:t.entityCommand)||this.getDefaultExtensionCommand();return i.visibilityState=ve.fe.show,this.extensionCommanding.executeCommand({id:e,type:pe.py.platformapp,action:pe.uk.create},{entityCommand:i,entityOptions:null==t?void 0:t.platformAppDetailsOptions})}launchAppDetailsTutorial(e){return this.extensionCommanding.executeCommand({type:pe.py.platformappdetails,action:pe.uk.info},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:e})}launchAppRevokeConsent(e){return this.extensionCommanding.executeCommand({type:pe.py.platformappconsent,action:pe.uk.delete},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:e})}appDetailsPostInstall(e){const t=this.getDefaultExtensionCommand();return t.stateTransition=ve.su.none,this.commandHandler({entity:{type:pe.py.platformappdetails,action:pe.uk.config},command:t,entityOptions:e})}appDetailsPostInstallV2(e){return this.extensionCommanding.executeCommand({type:pe.py.platformappdetails,action:pe.uk.view},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:e})}appDetailsOnDone(e,t){const i=this.getDefaultExtensionCommand();return i.stateTransition=ve.su.none,this.commandHandler({entity:{id:e,type:pe.py.platformappdetails,action:pe.uk.update},command:i,entityOptions:t})}launchInContextStore(e){return this.extensionCommanding.executeCommand({type:pe.py.incontextstore,action:pe.uk.view},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:e})}inContextStorePostInstall(e){const t=this.getDefaultExtensionCommand();return t.stateTransition=ve.su.none,this.commandHandler({entity:{type:pe.py.incontextstore,action:pe.uk.config},command:t,entityOptions:e})}inContextStoreOnDone(e,t){const i=this.getDefaultExtensionCommand();return i.stateTransition=ve.su.none,this.commandHandler({entity:{id:e,type:pe.py.incontextstore,action:pe.uk.update},command:i,entityOptions:t})}launchAppStore(e,t){return this.commandHandler({entity:{type:pe.py.platformapps,action:pe.uk.list},command:t,entityOptions:e})}launchDefaultPersonalApp(){return this.commandHandler({entity:{type:pe.py.default,action:pe.uk.view},command:{stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:k.D.Unknown}}})}launchPersonalApp(e){const t=this.getDefaultExtensionCommand();return t.stateTransition=ve.su.none,this.commandHandler({entity:{type:pe.py.platformapp,action:pe.uk.view},command:t,entityOptions:e})}launchAppUninstall(e,t){const i=(null==t?void 0:t.entityCommand)||this.getDefaultExtensionCommand();return i.visibilityState=ve.fe.show,this.extensionCommanding.executeCommand({id:e,type:pe.py.platformapp,action:pe.uk.delete},{entityCommand:i,entityOptions:null==t?void 0:t.uninstallOptions})}launchAppError(e){return this.extensionCommanding.executeCommand({type:pe.py.platformapp,action:pe.uk.error},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:e})}launchContextlessConfigDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.platformcontextlessinstalldialog,action:pe.uk.view},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:e})}launchManifestParsingErrorDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.customapp,action:pe.uk.error},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:e})}launchUploadCustomApp(){return this.extensionCommanding.executeCommand({type:pe.py.customapp,action:pe.uk.view},{entityCommand:this.getDefaultExtensionCommand()})}launchRequestSubmittedDialog(){return this.extensionCommanding.executeCommand({type:pe.py.customapp,action:pe.uk.info},{entityCommand:this.getDefaultExtensionCommand()})}launchLocationDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.locationapi,action:pe.uk.create},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:e})}launchSelectMediaDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.selectMediaApi,action:pe.uk.create},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:e})}launchViewImagesDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.viewImagesApi,action:pe.uk.create},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:e})}launchSelectPeoplePickerDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.selectpeoplepicker,action:pe.uk.view},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:e})}launchAppRatingCoachmark(e){return this.extensionCommanding.executeCommand({type:pe.py.platformappratingcoachmark,action:pe.uk.view},{entityCommand:null!=e?e:this.getDefaultExtensionCommand()})}launchAppConfig(e,t){const i=(null==t?void 0:t.entityCommand)||this.getDefaultExtensionCommand();return i.visibilityState=ve.fe.show,this.extensionCommanding.executeCommand({id:e,type:pe.py.platformapp,action:pe.uk.config},{entityCommand:i,entityOptions:null==t?void 0:t.launchAppConfigOptions})}launchTabInfo(e,t){const i=(null==t?void 0:t.entityCommand)||this.getDefaultExtensionCommand();return i.visibilityState=ve.fe.show,this.extensionCommanding.executeCommand({id:e,type:pe.py.platformtab,action:pe.uk.info},{entityCommand:i,entityOptions:null==t?void 0:t.launchTabInfoOptions})}launchStagedApps(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultExtensionCommand();return t.visibilityState=ve.fe.show,this.extensionCommanding.executeCommand({type:pe.py.stagedapps,action:pe.uk.info},{entityCommand:t,entityOptions:null==e?void 0:e.launchStagedAppsOptions})}launchAppAuthConsent(e,t){const i=(null==t?void 0:t.entityCommand)||this.getDefaultExtensionCommand();return i.visibilityState=ve.fe.show,this.extensionCommanding.executeCommand({id:e,type:pe.py.platformauthconsentdialog,action:pe.uk.create},{entityCommand:i,entityOptions:null==t?void 0:t.launchAuthConsentOptions})}platformTabById(e,t,i,n){return this.commandHandler({entity:{id:e,type:pe.py.extensions,action:pe.uk.view,linkedEntity:i},command:t,entityOptions:n})}launchPersonalPlatformApp(e,t,i,n,a){return this.commandHandler({entity:{id:JSON.stringify({appId:e,tabEntityId:i}),type:pe.py.extensions,action:pe.uk.view,linkedEntity:a},command:{visibilityState:ve.fe.show,stateTransition:t?ve.su.new:ve.su.flush,correlation:{source:null!=n?n:k.D.AppBar,startTimestamp:Date.now()}},entityOptions:{isMultiWindow:t,entryPoint:$n.mQ.personalApp}})}platformAppById(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.extensions,action:pe.uk.view,linkedEntity:i},command:t})}navigateToManageApps(e){return this.commandHandler({entity:{type:pe.py.platformapps,action:pe.uk.manage},entityOptions:e})}launchSubscriptionPlansDialog(e,t,i){const n=i||this.getDefaultExtensionCommand();return n.visibilityState=ve.fe.show,this.extensionCommanding.executeCommand({id:e,type:pe.py.platformsubscriptionplans,action:pe.uk.info},{entityCommand:n,entityOptions:t})}launchAngularAppDetails(e,t,i){const{enableAppDetailsAngularFeatureParity:n}=this.coreSettings.get(S.J.Host);if(n)return this.launchAppDetails(e,{platformAppDetailsOptions:t,entityCommand:i});const a=i||this.getDefaultExtensionCommand();return a.visibilityState=ve.fe.show,this.extensionCommanding.executeCommand({id:e,type:pe.py.platformapp,action:pe.uk.info},{entityCommand:a,entityOptions:t})}launchCustomAppFilePicker(e,t,i){return this.extensionCommanding.executeCommand({id:e,type:pe.py.customapp,action:pe.uk.create},{entityCommand:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:i||k.D.Store}},entityOptions:t})}launchWorkflowsDialog(e,t,i){return this.extensionCommanding.executeCommand({id:e,type:pe.py.workflows,action:pe.uk.create},{entityCommand:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:i||k.D.Store}},entityOptions:t})}launchWorkflowSelectionDialog(e,t,i,n){let a=pe.py.chatworkflows;const s=pe.uk.view;switch(t){case k.D.ChatListItem:a=pe.py.chatworkflows;break;case k.D.ChannelListItem:a=pe.py.channelworkflows}return this.extensionCommanding.executeCommand({id:e,type:a,action:s},{entityCommand:i,entityOptions:n})}launchManageWorkflows(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.workflows,action:pe.uk.manage},entityOptions:t,command:{visibilityState:ve.fe.show,stateTransition:ve.su.none,correlation:{source:i||k.D.Store}}})}launchSettingsDialog(e,t,i){const n={visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:i||k.D.Card}};return this.extensionCommanding.executeCommand({id:e,type:pe.py.settingsdialog,action:pe.uk.view},{entityCommand:n,entityOptions:t})}updatePlatformTabById(e,t,i,n){return this.commandHandler({entity:{id:e,type:pe.py.extensions,action:pe.uk.update,linkedEntity:i},command:t,entityOptions:n})}videoEffectsCustomizationPanelById(e,t){return this.commandHandler({entity:{type:pe.py.videoeffectscustomization,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},command:t})}videoEffectsMoreViewPanelById(e,t,i){return this.commandHandler({entity:{type:pe.py.videoeffectsmoreview,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},command:t,entityOptions:i})}videoEffectsAndAvatarPanelById(e,t,i){return this.commandHandler({entity:{type:pe.py.videoeffectsandavatar,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},command:t,entityOptions:i})}meshAvatarPanelById(e,t){return this.commandHandler({entity:{type:pe.py.meshavatar,action:pe.uk.view,linkedEntity:{type:pe.py.calls,id:e}},command:t})}launchManageAppsUninstall(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.manageapps,action:pe.uk.delete},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:t})}launchManageAppsWebhook(e,t){const i=t.editMode?pe.uk.update:pe.uk.create;return this.extensionCommanding.executeCommand({id:e,type:pe.py.manageappswebhook,action:i},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:t})}launchManageAppsWebhookConfirmation(e){const t={webhookToken:e};return this.extensionCommanding.executeCommand({type:pe.py.manageappswebhook,action:pe.uk.info},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:t})}selectAppEntity(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultExtensionCommand();return t.visibilityState=ve.fe.show,this.extensionCommanding.executeCommand({type:pe.py.platformTabGallery,action:pe.uk.create},{entityCommand:t,entityOptions:null==e?void 0:e.selectAppEntityOptions})}launchAppDevicePermissions(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.platformappdevicepermissions,action:pe.uk.create},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:t})}launchAppDevicePermissionsFirstRun(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.platformappdevicepermissions,action:pe.uk.update},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:t})}launchRefreshConfirmationAfterAppDevicePermissionsUpdate(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.platformappdevicepermissions,action:pe.uk.confirm},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:t})}hideExtension(e){return this.extensionCommanding.executeCommand(e,{entityCommand:{visibilityState:ve.fe.hide,stateTransition:ve.su.extend,correlation:{source:k.D.ExtensionCommanding}}})}getDefaultExtensionCommand(){return{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:k.D.ExtensionCommanding}}}}class Bn{constructor(e,t){this.commandHandler=e,this.coreSettings=t}registration(e){const{enableMultiWindowWebinarRegistration:t}=this.coreSettings.get(S.J.WebinarRegistration);return t?this.commandHandler({entity:{action:pe.uk.view,id:e,type:pe.py.registration},command:{visibilityState:ve.fe.show,stateTransition:ve.su.new,correlation:{source:k.D.Calendar}}}):((0,R.J)().open(`${(0,R.J)().location.origin}/registration/${e}?mode=edit`,"_blank"),Promise.resolve())}}class zn{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}showTeamsGrid(e){return this.commandHandler({entity:{type:pe.py.schoolteams,action:pe.uk.list},command:{visibilityState:ve.fe.show,stateTransition:ve.su.flush,correlation:{source:k.D.SchoolTeams}},entityOptions:{lastVisitedTeamId:e}})}gridTeamDiscover(){return this.commandHandler({entity:{type:pe.py.schoolteams,action:pe.uk.join},command:{stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:k.D.SchoolTeams}}})}showSingleTeam(e){return this.commandHandler({entity:{type:pe.py.channels,action:pe.uk.view,id:e},command:{visibilityState:ve.fe.show,stateTransition:ve.su.flush,correlation:{source:k.D.SchoolTeams}}})}showUnlockDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.schoolteams,action:pe.uk.update,id:e},{entityCommand:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:k.D.UnlockTeam}}})}}class Hn{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t,this.updateSearchState=(e,t,i)=>{const n={type:pe.py.search,action:pe.uk.view};let a;return a=t?Object.assign({},n):i&&i.type===pe.py.search&&i.action===pe.uk.view?Object.assign({},i):Object.assign(Object.assign({},n),{id:e&&e.searchQuery}),this.commandHandler({entity:a,command:{correlation:{id:(0,qe.v4)(),startTimestamp:Date.now(),source:k.D.Search},stateTransition:ve.su.none,visibilityState:ve.fe.show},entityOptions:e})},this.updateSearchStateRW=(e,t,i)=>this.commandHandler({entity:{id:t||e&&e.searchQuery,type:pe.py.search,action:pe.uk.view},command:{correlation:{id:(0,qe.v4)(),startTimestamp:Date.now(),source:k.D.Search},stateTransition:i||ve.su.flush,visibilityState:ve.fe.show},entityOptions:e}),this.sendSearchStateToMetaOSSearchService=(e,t)=>this.commandHandler({entity:{id:JSON.stringify({appId:t}),type:pe.py.extensions,action:pe.uk.view},command:{correlation:{id:(0,qe.v4)(),startTimestamp:Date.now(),source:k.D.Search},stateTransition:ve.su.flush,visibilityState:ve.fe.show},entityOptions:e}),this.open3SFeedback=e=>this.commandHandler({entity:{type:pe.py.open3sfeedback,action:pe.uk.view},command:{correlation:{source:k.D.Search},stateTransition:ve.su.new,visibilityState:ve.fe.show},entityOptions:e}),this.exitSearchState=()=>this.commandHandler({entity:{type:pe.py.search,action:pe.uk.view,id:"search"},command:{correlation:{source:k.D.Search},stateTransition:ve.su.forceFlush,visibilityState:ve.fe.hide}})}openFeedback(e,t){return this.extensionCommanding.executeCommand({type:pe.py.openfeedbackdialog,action:pe.uk.view},{entityCommand:e,entityOptions:t})}}class qn{constructor(e){this.commandHandler=e}launch(e,t){return this.commandHandler({entity:{type:pe.py.settingsstore,action:pe.uk.default,id:t},command:e})}launchSection(e,t,i,n){return this.commandHandler({entity:{type:null!=n?n:pe.py.settingsstore,action:pe.uk.view,id:e},command:t,entityOptions:Object.assign(Object.assign({},i),{commandSource:null==t?void 0:t.correlation.source})})}}class Vn{constructor(e){this.extensionCommanding=e}launchShareFormDialog(e,t){const i=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return i.visibilityState=ve.fe.show,i.stateTransition=ve.su.extend,this.extensionCommanding.executeCommand({id:e,type:pe.py.shareformdialog,action:pe.uk.view},{entityCommand:i,entityOptions:null==t?void 0:t.entityOptions})}getDefaultCommand(){return{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:k.D.ExtensionCommanding}}}}class Gn{constructor(e){this.commandHandler=e}viewStore(e,t,i){return this.commandHandler({entity:{type:pe.py.store,action:pe.uk.view,id:e},command:i,entityOptions:t})}showStoreFre(e,t){return this.commandHandler({entity:{type:pe.py.storefre,action:pe.uk.view,id:t},command:{visibilityState:e?ve.fe.show:ve.fe.hide,stateTransition:ve.su.extend,correlation:{source:k.D.ExtensionCommanding}}})}viewManageAppsTab(e,t){return this.commandHandler({entity:{type:pe.py.store,action:pe.uk.manage},command:t,entityOptions:e})}}var Jn,Kn=i(551675);function Qn(e){return{id:e||"",type:pe.py.channels,action:pe.uk.list}}function Yn(e,t=ve.su.flush){return{stateTransition:t,visibilityState:ve.fe.show,correlation:{source:e}}}!function(e){e.User="user",e.Team="team",e.TeamOwned="teamowned"}(Jn||(Jn={}));class Xn{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}editTeamPicture(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.teampicture,action:pe.uk.view})}viewTeamJoinCode(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.teamjoincode,action:pe.uk.view},{entityOptions:{teamJoinCode:t}})}viewTeamRenewal(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.teamrenewal,action:pe.uk.view},{entityOptions:{expiryTime:t}})}editTeam(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.teamedit,action:pe.uk.view},{entityOptions:t})}addMember(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.addmember,action:pe.uk.view})}addMemberToTeamDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.addmembertoteamdialog,action:pe.uk.view},{entityOptions:t})}addMemberToPrivateChannelDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.addmembertoprivatechanneldialog,action:pe.uk.view},{entityOptions:t})}shareChannelWithUserDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.sharechannelwithuserdialog,action:pe.uk.view},{entityOptions:t})}addMemberToNewTeam(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.addmembernewteam,action:pe.uk.view},{entityOptions:t})}addChannel(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.addchannel,action:pe.uk.view})}createChannel(e){return this.extensionCommanding.executeCommand({type:pe.py.createchanneldialog,action:pe.uk.view},{entityOptions:e})}createChannelOnLeftRail(e){return this.extensionCommanding.executeCommand({type:pe.py.createchannelleftraildialog,action:pe.uk.view},{entityOptions:e})}manageApps(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.teammanageapps,action:pe.uk.view,linkedEntity:Qn(e)},command:(null==i?void 0:i.entityCommand)||Yn(t),scenarioEventData:null==i?void 0:i.scenarioEventData,entityOptions:null==i?void 0:i.entityOptions})}manageTags(e,t,i,n){return this.commandHandler({entity:{id:e,type:pe.py.teammanagetags,action:pe.uk.view,linkedEntity:Qn(e)},entityOptions:Object.assign(Object.assign({},null==n?void 0:n.entityOptions),{tagId:i}),scenarioEventData:null==n?void 0:n.scenarioEventData,command:(null==n?void 0:n.entityCommand)||Yn(null!=t?t:k.D.ChannelListItem)})}leaveTeam(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.teamleave,action:pe.uk.view})}createTeam(){return this.extensionCommanding.executeCommand({type:pe.py.teamcreate,action:pe.uk.view})}archiveTeam(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.teamarchive,action:pe.uk.view})}restoreTeam(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.teamrestore,action:pe.uk.view})}launchConfirmPinUnpinPost(e,t){return this.extensionCommanding.executeCommand({type:pe.py.pinunpinpost,action:pe.uk.view},{entityCommand:t,entityOptions:e})}createTeamOnMainView(e,t){const i=(null==e?void 0:e.source)||Kn.IC.template;return this.commandHandler({entity:{id:i,type:pe.py.teams,action:pe.uk.create},entityOptions:e,command:Yn(null!=t?t:k.D.ChannelList)})}createTeamV2(){return this.extensionCommanding.executeCommand({type:pe.py.teamcreatedialog,action:pe.uk.view})}showListView(){return this.commandHandler({entity:{type:pe.py.channels,action:pe.uk.view},command:Yn(k.D.SchoolTeams)})}teamDiscover(){return this.commandHandler({entity:{type:pe.py.teamdiscover,action:pe.uk.view},command:Yn(k.D.ChannelListItem)})}manageTeam(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.teammanage,action:pe.uk.view,linkedEntity:Qn(e)},command:(null==i?void 0:i.entityCommand)||Yn(t),scenarioEventData:null==i?void 0:i.scenarioEventData,entityOptions:null==i?void 0:i.entityOptions})}manageTeams(e){return this.commandHandler({entity:{type:pe.py.teams,action:pe.uk.config},command:Yn(e)})}manageSharedChannelsPendingInvites(e,t,i){return this.commandHandler({entity:{id:i,type:pe.py.sharedchannelspendinginvites,action:pe.uk.view,linkedEntity:Qn(i)},command:(null==t?void 0:t.entityCommand)||Yn(e,ve.su.flow),scenarioEventData:null==t?void 0:t.scenarioEventData,entityOptions:(null==t?void 0:t.entityOptions)||{commandSource:e}})}manageTeamsList(e,t,i){return this.commandHandler({entity:{id:i,type:pe.py.teamslist,action:pe.uk.view,linkedEntity:Qn(i)},command:(null==t?void 0:t.entityCommand)||Yn(e,ve.su.flow),scenarioEventData:null==t?void 0:t.scenarioEventData,entityOptions:(null==t?void 0:t.entityOptions)||{commandSource:e}})}crossTeamAnalytics(e,t,i){return this.commandHandler({entity:{id:i,type:pe.py.crossteamanalytics,action:pe.uk.view,linkedEntity:Qn(i)},command:(null==t?void 0:t.entityCommand)||Yn(e),scenarioEventData:null==t?void 0:t.scenarioEventData,entityOptions:null==t?void 0:t.entityOptions})}acceptInvitation(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.sharedchannelacceptinvitation,action:pe.uk.view},{entityOptions:t})}declineInvitation(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.sharedchanneldeclineinvitation,action:pe.uk.view},{entityOptions:t})}teamDeepLink(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.teamdeeplink,action:pe.uk.view})}channelDeepLink(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.channeldeeplink,action:pe.uk.view})}viewChannelEmail(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.channelemail,action:pe.uk.view})}viewChannelEmailV2(e,t){return this.extensionCommanding.executeCommand({type:pe.py.channelemailv2,action:pe.uk.view},{entityCommand:t,entityOptions:e})}removeChannelEmail(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.removechannelemail,action:pe.uk.view},{entityCommand:t})}launchChannelEmailErrorDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.channelemailerror,action:pe.uk.view},{entityCommand:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:k.D.ChannelEmail}},entityOptions:{errorCode:e}})}manageChannelConnectors(e,t,i){return this.extensionCommanding.executeCommand({id:e,type:pe.py.channelconnectors,action:pe.uk.view},{entityCommand:i,entityOptions:t})}connectorInstanceConfiguration(e,t,i){return this.extensionCommanding.executeCommand({id:e,type:pe.py.connectorinstanceconfiguration,action:pe.uk.view},{entityCommand:i,entityOptions:t})}deleteChannel(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.channeldelete,action:pe.uk.view},{entityOptions:t})}editChannel(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.channeledit,action:pe.uk.view},{entityOptions:t})}channelModerators(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.channelmoderators,action:pe.uk.view})}manageChannel(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.channelmanage,action:pe.uk.view,linkedEntity:Qn(e)},entityOptions:{parentTeamId:null==t?void 0:t.parentTeamId},command:Yn(i||k.D.ChannelListItem)})}manageChannelAnalytics(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.channelanalytics,action:pe.uk.view,linkedEntity:Qn(e)},entityOptions:Object.assign(Object.assign({},null==i?void 0:i.entityOptions),{parentTeamId:null==i?void 0:i.parentTeamId}),command:(null==i?void 0:i.entityCommand)||Yn(t),scenarioEventData:null==i?void 0:i.scenarioEventData})}manageChannelMembers(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.channelmembers,action:pe.uk.view,linkedEntity:Qn(e)},entityOptions:Object.assign(Object.assign({},null==i?void 0:i.entityOptions),{parentTeamId:null==i?void 0:i.parentTeamId}),command:(null==i?void 0:i.entityCommand)||Yn(t),scenarioEventData:null==i?void 0:i.scenarioEventData})}manageChannelSettings(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.channelsettings,action:pe.uk.view,linkedEntity:Qn(e)},entityOptions:Object.assign(Object.assign({},null==i?void 0:i.entityOptions),{parentTeamId:null==i?void 0:i.parentTeamId}),command:(null==i?void 0:i.entityCommand)||Yn(t),scenarioEventData:null==i?void 0:i.scenarioEventData})}manageChannelInvitations(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.channelinvitations,action:pe.uk.view},entityOptions:Object.assign(Object.assign({},null==i?void 0:i.entityOptions),{parentTeamId:null==i?void 0:i.parentTeamId}),command:(null==i?void 0:i.entityCommand)||Yn(t),scenarioEventData:null==i?void 0:i.scenarioEventData})}manageChannelTags(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.channeltags,action:pe.uk.view,linkedEntity:Qn(e)},entityOptions:Object.assign(Object.assign({},null==i?void 0:i.entityOptions),{parentTeamId:null==i?void 0:i.parentTeamId,tagId:null==i?void 0:i.tagId}),command:(null==i?void 0:i.entityCommand)||Yn(null!=t?t:k.D.ChannelListItem),scenarioEventData:null==i?void 0:i.scenarioEventData})}addChannelMember(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.channelroster,action:pe.uk.manage})}leaveChannel(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.channels,action:pe.uk.leave})}showHideGeneralChannel(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.channels,action:pe.uk.confirm})}channelNotificationSettings(e,t,i){return this.extensionCommanding.executeCommand({id:e,type:pe.py.channelnotificationsettings,action:pe.uk.view},{entityCommand:Yn(t||k.D.ChannelListItem),entityOptions:{commandSource:t||k.D.ChannelListItem,teamName:null==i?void 0:i.teamName,channelName:null==i?void 0:i.channelName}})}shareChannelWithUser(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.channels,action:pe.uk.share},{entityOptions:{shareWith:Jn.User}})}shareChannelWithTeam(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.channels,action:pe.uk.share},{entityOptions:{shareWith:Jn.Team}})}shareChannelWithTeamOwned(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.channels,action:pe.uk.share},{entityOptions:{shareWith:Jn.TeamOwned}})}manageTeamSettings(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.teamsettings,action:pe.uk.view,linkedEntity:Qn(e)},command:(null==i?void 0:i.entityCommand)||Yn(t),scenarioEventData:null==i?void 0:i.scenarioEventData,entityOptions:null==i?void 0:i.entityOptions})}manageTeamAnalytics(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.teamanalytics,action:pe.uk.view,linkedEntity:Qn(e)},command:(null==i?void 0:i.entityCommand)||Yn(t),scenarioEventData:null==i?void 0:i.scenarioEventData,entityOptions:null==i?void 0:i.entityOptions})}manageTeamChannels(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.teamchannels,action:pe.uk.view,linkedEntity:Qn(e)},command:(null==i?void 0:i.entityCommand)||Yn(t),scenarioEventData:null==i?void 0:i.scenarioEventData,entityOptions:null==i?void 0:i.entityOptions})}manageTeamPendingJoinRequest(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.teampendingrequests,action:pe.uk.view,linkedEntity:Qn(e)},command:(null==i?void 0:i.entityCommand)||Yn(t),scenarioEventData:null==i?void 0:i.scenarioEventData,entityOptions:null==i?void 0:i.entityOptions})}deleteTeam(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.teams,action:pe.uk.delete})}restoreChannel(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.restorechannel,action:pe.uk.view},{entityOptions:null==t?void 0:t.entityOptions})}showChannelOwners(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.showChannelOwners,action:pe.uk.view},{entityOptions:t})}showChannelOwnersReactDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.showchannelownersreactdialog,action:pe.uk.view},{entityOptions:e})}showForMemberDialog(e){return this.extensionCommanding.executeCommand({id:e,type:pe.py.showformemberdialog,action:pe.uk.view})}userOnboardingTeam(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.useronboardingteam,action:pe.uk.view},command:(null==i?void 0:i.entityCommand)||Yn(t||k.D.ChannelList),scenarioEventData:null==i?void 0:i.scenarioEventData,entityOptions:null==i?void 0:i.entityOptions})}}class Zn{constructor(e){this.commandHandler=e}openTranscriptTab({entityCommand:e,messageId:t,threadId:i,transcriptId:n,isOrganizer:a,meetingOrganizerId:s,meetingTenantId:o},r){return this.commandHandler({entity:{type:pe.py.transcriptcontent,action:pe.uk.view},command:e,entityOptions:{messageId:t,threadId:i,transcriptId:n,isOrganizer:a,meetingOrganizerId:s,meetingTenantId:o,eventId:r}})}openTranscriptInSchedulingForm({entityCommand:e,messageId:t,threadId:i,transcriptId:n,isOrganizer:a,meetingOrganizerId:s,meetingTenantId:o},r,c){return this.commandHandler({entity:{type:pe.py.transcriptcontent,action:pe.uk.view,linkedEntity:{type:pe.py.schedulingform,action:pe.uk.view,id:JSON.stringify({eventId:(0,fn.cW)(r),providerType:c})}},command:e,entityOptions:{messageId:t,threadId:i,transcriptId:n,isOrganizer:a,eventId:(0,fn.cW)(r),meetingOrganizerId:s,meetingTenantId:o}})}openTranscriptInChatApp({entityCommand:e,messageId:t,threadId:i,transcriptId:n,isOrganizer:a,meetingOrganizerId:s,meetingTenantId:o},r,c){return this.commandHandler({entity:{id:n,type:pe.py.transcriptcontent,action:pe.uk.view,linkedEntity:c?{type:pe.py.chats,action:pe.uk.view,id:i||""}:null},command:e,entityOptions:{eventId:r?(0,fn.cW)(r):"",isOrganizer:a,meetingOrganizerId:s,meetingTenantId:o,messageId:t,threadId:i,transcriptId:n}})}}class ea{constructor(e,t,i,n){this.extensionCommanding=e,this.commandHandler=t,this.host=i,this.coreSettings=n}virtualEventsList(e){return this.commandHandler({entity:{type:pe.py.virtualevents,action:pe.uk.list},command:e})}virtualEventById(e,t){const{useMeetingExperienceForSchedulingVirtualEvents:i,virtualEventByIdLinkUrl:n}=this.coreSettings.get(S.J.VirtualEvents);return i&&(null==t?void 0:t.stateTransition)===ve.su.new?(this.host.open(null==n?void 0:n.replace("{eventId}",e)),Promise.resolve()):this.commandHandler({entity:{type:pe.py.virtualevents,action:pe.uk.view,id:e},command:t})}createVirtualEvent(e,t){const{eventType:i}=e,{useMeetingExperienceForSchedulingVirtualEvents:n,createVirtualEventsLinkUrl:a}=this.coreSettings.get(S.J.VirtualEvents);return n?(this.host.open(null==a?void 0:a.replace("{eventType}",i)),Promise.resolve()):this.commandHandler({entity:{type:pe.py.virtualevents,action:pe.uk.create},command:t,entityOptions:e})}showConfirmationDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.virtualevents,action:pe.uk.confirm},{entityCommand:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:k.D.VirtualEventDetails}},entityOptions:e})}showShareDialog(e){return this.extensionCommanding.executeCommand({type:pe.py.virtualevents,action:pe.uk.share},{entityCommand:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:k.D.VirtualEventDetails}},entityOptions:e})}navigateVirtualEvent(e,t,i,n,a){return this.commandHandler({entity:{type:pe.py.virtualevents,action:n||pe.uk.view,id:`${e}-${i}`},command:{visibilityState:ve.fe.show,stateTransition:ve.su.forceFlush,correlation:{source:k.D.VirtualEventDetails}},entityOptions:{selectedNavItem:i,sessionId:a,eventId:e,eventType:t}})}}class ta{constructor(e){this.commandHandler=e}openWikiTab(e,t,i,n){const a={entity:{action:pe.uk.view,id:e,linkedEntity:n,type:pe.py.wiki},command:t,entityOptions:i};return this.commandHandler(a)}}class ia{constructor(e){this.commandHandler=e}qnaById(e,t,i){return this.commandHandler({entity:{type:pe.py.yammerqna,action:pe.uk.view,id:e},command:t,entityOptions:i})}}class na{constructor(e){this.commandHandler=e}launch(e){return this.commandHandler({entity:{type:pe.py.teamsgallery,action:pe.uk.view},command:e})}launchSection(e){return this.commandHandler({entity:{type:pe.py.teamsgallery,action:pe.uk.view,id:e},command:{stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:k.D.TeamsGallery}}})}launchTeamsGallery(){return this.commandHandler({entity:{type:pe.py.teamsgallery,action:pe.uk.view,id:""},command:{stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:k.D.TeamsGallery}}})}manageAppsInTeam(e,t,i){return this.commandHandler({entity:{id:e,type:pe.py.teammanageapps,action:pe.uk.view,linkedEntity:{id:e||"",type:pe.py.channels,action:pe.uk.list}},command:(null==i?void 0:i.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==i?void 0:i.scenarioEventData,entityOptions:null==i?void 0:i.entityOptions})}getDefaultEntityCommand(e,t=ve.su.flush){return{stateTransition:t,visibilityState:ve.fe.show,correlation:{source:e}}}}class aa{constructor(e){this.commandHandler=e}callList(e,t){return this.commandHandler({entity:{id:e,type:pe.py.callsmain,action:pe.uk.view},command:t})}contactList(e,t){return this.commandHandler({entity:{type:pe.py.callsmain,action:pe.uk.list},command:e,entityOptions:null==t?void 0:t.entityOptions,scenarioEventData:null==t?void 0:t.scenarioEventData})}peopleAppAsContacts(e,t){return this.commandHandler({entity:{type:pe.py.peopleapp,action:pe.uk.view},command:e,scenarioEventData:null==t?void 0:t.scenarioEventData})}}class sa{constructor(e){this.extensionCommanding=e}launchUnifiedConsent(e){this.extensionCommanding.executeCommand({type:pe.py.unifiedconsentdialog,action:pe.uk.view},{entityOptions:Object.assign({},e)})}}class oa{constructor(e){this.extensionCommanding=e}stopSharingChannelWithTeam(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.stopsharingchannelwithteam,action:pe.uk.view},{entityOptions:null==t?void 0:t.entityOptions})}createSharedChannelInvitationDialog(e,t,i){return this.extensionCommanding.executeCommand({id:e,type:pe.py.sharedchannelcreateinvitationsdialog,action:pe.uk.view,linkedEntity:this.getChannelLinkedEntity(e)},{entityCommand:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:t}},entityOptions:i})}acceptSharedChannelInvitationDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.acceptsharedchannelinvitationdialog,action:pe.uk.view},{entityOptions:t})}shareWithTeamYouOwnDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.sharewithteamyouowndialog,action:pe.uk.view},{entityOptions:t})}archiveChannel(e,t,i){return this.extensionCommanding.executeCommand({id:t,type:pe.py.archivechannel,action:pe.uk.view},{entityOptions:{teamId:e,channelId:t,channelDisplayName:i}})}unArchiveChannel(e,t,i){return this.extensionCommanding.executeCommand({id:t,type:pe.py.unarchivechannel,action:pe.uk.view},{entityOptions:{teamId:e,channelId:t,channelDisplayName:i}})}editTeamPicture(e,t,i,n,a,s){return this.extensionCommanding.executeCommand({id:e,type:pe.py.changeteampicture,action:pe.uk.view},{entityCommand:s,entityOptions:{teamId:e,threadId:t,teamDisplayName:i,pictureETag:n,defaultTeamInitialsPicture:a}})}showForMemberDialogV2(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.showformemberdialogv2,action:pe.uk.view},{entityOptions:t})}getChannelLinkedEntity(e){return{id:e||"",type:pe.py.channels,action:pe.uk.list}}}class ra{constructor(e){this.extensionCommanding=e}launchTeamsErrorDialog(e,t,i,n,a){return this.extensionCommanding.executeCommand({id:e,type:pe.py.teamserrordialog,action:pe.uk.view},{entityCommand:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:a}},entityOptions:{titleString:t,contentString:i,buttonString:n}})}getLinkToTeamOrChannelDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.getlinktoteamorchanneldialog,action:pe.uk.view},{entityCommand:t,entityOptions:e})}denyInvitationConfirmDialog(){return this.extensionCommanding.executeCommand({type:pe.py.sharedchanneldenyinvitation,action:pe.uk.view},{entityCommand:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:k.D.ChannelInvitations}}})}launchConfirmLeaveChannel(e,t){return this.extensionCommanding.executeCommand({type:pe.py.leavechanneldialog,action:pe.uk.view},{entityCommand:t,entityOptions:e})}launchShowHideGeneralChannelWarningDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.showhidegeneralchannelwarningdialog,action:pe.uk.view},{entityCommand:t,entityOptions:e})}launchLeaveChannelLastOwnerDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.leavechannellastownerdialog,action:pe.uk.view},{entityCommand:t,entityOptions:e})}launchRestoreChannelDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.restorechannelreactdialog,action:pe.uk.view},{entityCommand:t,entityOptions:e})}launchDeleteChannelDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.deletechannelreactdialog,action:pe.uk.view},{entityCommand:t,entityOptions:e})}launchStopSharingChannelWithTeamDialog(e,t){return this.extensionCommanding.executeCommand({type:pe.py.stopsharingchannelwithteamreactdialog,action:pe.uk.view},{entityCommand:t,entityOptions:e})}archiveTeamT2(e,t,i,n){return this.extensionCommanding.executeCommand({id:t,type:pe.py.archiveteam,action:pe.uk.view},{entityCommand:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:n}},entityOptions:{teamName:i,groupId:e,threadId:t}})}deleteTeamT2(e,t,i,n){return this.extensionCommanding.executeCommand({id:t,type:pe.py.deleteteam,action:pe.uk.view},{entityCommand:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:n}},entityOptions:{teamName:i,groupId:e,threadId:t}})}leaveTeamT2(e,t,i,n){return this.extensionCommanding.executeCommand({id:t,type:pe.py.leaveteam,action:pe.uk.view},{entityCommand:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:n}},entityOptions:{teamName:i,groupId:e,threadId:t}})}restoreTeamT2(e,t,i,n){return this.extensionCommanding.executeCommand({id:t,type:pe.py.restoreteam,action:pe.uk.view},{entityCommand:{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:n}},entityOptions:{teamName:i,groupId:e,threadId:t}})}}class ca{constructor(e){this.extensionCommanding=e}launchAppDevicePermissionsConsent(e,t){return this.extensionCommanding.executeCommand({id:e,type:pe.py.platformappdevicepermissions,action:pe.uk.manage},{entityCommand:this.getDefaultExtensionCommand(),entityOptions:t})}getDefaultExtensionCommand(){return{stateTransition:ve.su.extend,visibilityState:ve.fe.show,correlation:{source:k.D.ExtensionCommanding}}}}class la{constructor(e){this.commandHandler=e}launch(e){return this.commandHandler({entity:{type:pe.py.cast,action:pe.uk.view},command:e})}}class da{constructor(e){this.commandHandler=e}acquireExploratoryLicense(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.commandHandler({entity:{type:pe.py.exploratorylicense,action:pe.uk.create},command:{visibilityState:ve.fe.show,stateTransition:ve.su.flush,correlation:{source:e}}})}))}}class ua{constructor(e){this.commandHandler=e}presenterChatById(e,t,i){return this.commandHandler({entity:{type:pe.py.presenterchat,action:pe.uk.view},entityOptions:e,command:t,windowOptions:i})}}const ma=(e,t,i,n,a,s,o,r,c,l,d,u=h.ew,m,g,p)=>{const v=new Fi(e,n,u,o,r,a,m),f=new ki(s,e,v,o,r,c,a,d,g,p);return{entityCommanding:{account:new Zi(e),activity:new en(e,v),authentication:new on(e,v,f,n),autoinstallnotification:new rn(e),biometricEnrollment:new cn(e),brbFeedback:new ln(e,v),breakoutRooms:new dn(e),broadcast:new un(e),calendar:new mn(v,e),call:new gn(e,v,d),callsMain:new aa(e),campaignNotifications:new hn(e),cast:new la(e),channel:new pn(e,v),chat:new bn(e,v,a,r),coachReport:new yn(e),contacts:new Sn(e,v),deepLink:f,destroy:()=>v.destroy(),discoverSurface:new jn(e,r),discoverappsnotifications:new wn(e),error:new Cn(e),esp:new _n(e,v),exploratory:new da(e),feedback:new Tn(e,v),file:new In(v,e),flyout:new Nn(e),freemiumUpgrade:new En(e),guardians:new Fn(v,e),homepage:new xn(e),meetingAnalytics:new Mn(e),meetingRecap:new On(e),meetingRoom:new Ln(e),meetingOptions:new Pn(e,v),nova:new Ai(e),platform:new Wn(e,v,a),platformDevicePermissionDialogs:new ca(v),presenterTools:new ua(e),registration:new Bn(e,a),school:new zn(e,v),search:new Hn(e,v),settings:new qn(e),shareForm:new Vn(v),shell:new qi(e,v,l,u,s,a,r),store:new Gn(e),lobnotifications:new An(e),lms:new Dn(v),onboardingnotifications:new Un(e),teamsAndChannels:new Xn(e,v),teamsAndChannelsDialogs:new oa(v),teamsAndChannelsConfirmationDialogs:new ra(v),teamsGallery:new na(e),toasts:new Qi(e,d),transcript:new Zn(e),unifiedConsent:new sa(v),virtualEvents:new ea(v,e,s,a),yammerQna:new ia(e),wiki:new ta(e),communities:new kn(e,v)},eventing:new Pt(i,e,t)}},ga=new Set(["com.microsoft.teams.activity","com.microsoft.teams.calling"]);class ha{constructor(e,t,i,n,a,s,o,r){this._appsRegistry=e,this._client=t,this._commandResultChangeReportingService=i,this._coreSettings=n,this._entityCommanding=a,this._loggerFactory=s,this._scenarioFactory=o,this._userContextId=r}init(){this._changes&&this.destroy(),this._changes=this._commandResultChangeReportingService.observeChanges().pipe((0,u.h)((e=>e.userContextId===this._userContextId))).subscribe((e=>this.executeOnCommandResultAppHooks(e)))}destroy(){var e;null===(e=this._changes)||void 0===e||e.unsubscribe(),this._changes=void 0}executeOnCommandResultAppHooks({context:{entityCommand:e,error:t},type:i}){var n,a;if(!e)return;const s=e.command.correlation.scenarioName===z.RG.ActivitySwitch,o=e.entity.type,r=o&&this._appsRegistry.getApp({entityType:s?pe.py.activity:o}),c=null==r?void 0:r.onCommandResult;if(r&&ga.has(r.manifest.id)&&c)try{c({requestContext:{client:this._client,coreSettings:this._coreSettings,entityCommanding:this._entityCommanding,error:t,loggerFactory:this._loggerFactory,scenarioFactory:this._scenarioFactory},entityCommand:e,result:i})}catch(e){null===(a=(n=this._loggerFactory.newLogger("command-result-hooks-service","core-services-entity-commanding")).errorToTelemetry)||void 0===a||a.call(n,`App ${null==r?void 0:r.manifest.name} failed to execute entity command hook 'OnAfterCommandResolved' with ""${e.name}"" error`,"entity_command_hook",{errors:`${e.name}`},!0)}}}var pa=i(100836);function va(e){return function(e){const t=ba(e),i=1,n=2,a=3;if(!t)return e;if(t[a])return t[i].replace(t[n],t[a]);return t[i]}(e)}function fa(e){return e.message&&(e.message=va(e.message)),e.stack&&(e.stack=function(e){if(ba(e.message))return"Sanitized due to potential PII leaks.";return e.stack}(e)),e}function ba(e){return new RegExp(/(Can't find field ((chat)\(.*\)|.*) on object)/).exec(e)}const ya=/-extension:\/\//;function ka(e){return e===h.jK.TimedOut}class Sa{constructor(e,t,i,a,s,o){this.host=e,this.scenarioFactory=t,this.platformService=i,this.networkStateProvider=a,this.diagnosticsService=s,this.coreSettings=o,this._onWindowError=e=>{if(function(e){return e&&("resizeobserver loop limit exceeded"===e.message.toLowerCase()||ya.test(e.filename))}(e))return!0;const{colno:t,filename:i,lineno:n,message:a}=e;let{error:s}=e;const o=!!s&&ka(s.code);return s=s?fa(s):new Error(va(a)),this._reportError(z.RG.GlobalWindowError,Object.assign(s,{colno:t,filename:i,lineno:n}),h.jK.UndefinedWindowError,o),!0},this._onUnhandledPromiseRejection=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const{reason:t}=e,i=!!t&&ka(t.code);return this._reportError(z.RG.UnhandledRejection,t,h.jK.UnhandledPromiseRejection,i)})),e.addEventListener(L.cr.UnhandledRejection,this._onUnhandledPromiseRejection),e.addEventListener(L.cr.GlobalWindowError,this._onWindowError)}dispose(){this.host.removeEventListener(L.cr.UnhandledRejection,this._onUnhandledPromiseRejection),this.host.removeEventListener(L.cr.GlobalWindowError,this._onWindowError)}set error(e){this.persistDiagnostics(),void 0!==e&&(this._error=e,this._reportError(z.RG.FatalError,e,h.jK.UndefinedGlobalError,!0))}get error(){return this._error}_reportError(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{code:s=i,context:o=""}=t||{},r=""===o?`${s}`:`${o}:${s}`,c=(0,oe._S)((0,se.A)((0,oe.B9)(t)));let l="";try{l=this.extractError(t)}catch(e){l="Stringifying error failed"}const d=`[${l}]`,u=null==t?void 0:t.originSlotName,m=null==t?void 0:t.originAppId;this.scenarioFactory.newScenario(e).fail({message:m||u?`${m}/${u}: ${c}`:c,errorCode:r,errors:d,showOops:a,"AppInfo.NetworkState":this.networkStateProvider.isOnline()?"Online":"Offline",errorSlotName:u,errorAppId:m});let g=Promise.resolve();if(a){const e=1e3;g=(0,H.E)(Q.ip.getInstance().flush(),e),this.persistDiagnostics()}const h=this.platformService.config.clientVersion;return g.catch((()=>this.diagnosticsService.pushDiagnosticsEvent(E.i.Warn,"Could not flush telemetry logs in time",!0))).then((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const{disableSendingLogsToHost:e}=this.coreSettings.get(S.J.Diagnostics);if(!e){const e=yield this.diagnosticsService.getDiagnosticsEvents(1e3);this.host.opener.postMessage(L.rY.WindowErrored,{errorCode:r,errorDescription:c,errorMsg:l,logs:e,showOops:a,clientVersion:h})}}))))}))}extractError(e){const{scrubStackTrace:t}=this.coreSettings.get(S.J.Core),i=t?[]:[pa.A4.SmtpAddress,pa.A4.IPV4Address,pa.A4.IPv6Address,pa.A4.PhoneNumber];return(0,se.A)(JSON.stringify(e,(0,oe.cm)()),i)}persistDiagnostics(){this.diagnosticsService.persistDiagnostics()}}const wa={[Z.vW.Background]:"background",[Z.vW.UserVisible]:"user-visible"};class ja{constructor(e,t,i){this.host=e,this.postTaskSchedulerDiagnosticsService=i,this.postTaskMap=new Map,this.logger=t.newLogger("PostTaskScheduler","core-services-scheduling")}schedule(e,t,i,n){const a=wa[t.priority],s=new AbortController;return this.host.scheduler.postTask((()=>(this.postTaskSchedulerDiagnosticsService.markTaskDequeued(n,t.id),e())),{signal:s.signal,priority:a}).then((()=>{this.postTaskMap.delete(n)})).catch((()=>{var e,i;this.postTaskMap.delete(n),null===(i=(e=this.logger).errorToTelemetry)||void 0===i||i.call(e,`PostTaskScheduler: Job failed ${n}, ${t.id}`,"webclient_framework_foundation_core_services_scheduling")})),this.postTaskMap.set(n,{controller:s}),this.postTaskSchedulerDiagnosticsService.markTaskEnqueued(n,t.id),n}cancel(e){const{controller:t}=this.postTaskMap.get(e)||{};t&&(t.abort(),this.postTaskMap.delete(e))}destroy(){this.postTaskMap.forEach(((e,t)=>{this.cancel(t),this.postTaskMap.delete(t)}))}}var Ca;!function(e){e.JobChange="job_change"}(Ca||(Ca={}));class _a{constructor(e,t,i,n,a,s,o){this._jobHandle=e,this._changes=t,this._meta=i,this._job=n,this._windowId=s,this._correlationId=o,this._timing={received:0,started:0,completed:0,canceled:0},this._execution=Z.Tf.None,this._logger=a.newLogger("Scheduled Job","core-services-scheduling")}receive(){this._timing.received=Date.now(),this._execution=Z.Tf.Received,this.reportJobChange()}execute(){if(this._execution===Z.Tf.Canceled)return;if(this._execution!==Z.Tf.Received)throw new Error("Unable to execute a job that has not been received");let e;this._timing.started=Date.now(),this._execution=Z.Tf.Started;try{this.reportJobChange();const t=this._job();e=t instanceof Promise?t:Promise.resolve(t)}catch(t){this._logger.error(`Job with ID:${this._meta.id} failed to execute or rejected with error: ${t.message?t.message:t}`),e=Promise.reject(t)}this.complete(e)}equals(e){return this._jobHandle===e}cancel(){return this._timing.canceled=Date.now(),this._execution=Z.Tf.Canceled,this.reportJobChange(),{meta:this._meta,job:this._job}}complete(e){const t=e=>{let t;return this._timing.completed=Date.now(),this._execution=Z.Tf.Complete,this.isError(e)&&(t={message:e.message,code:e.code,context:e.context,name:e.name}),this.reportJobChange(t),e};e.then(t).catch(t)}isError(e){return!!e&&e instanceof Error}reportJobChange(e){this._changes.report({correlationId:this._correlationId,type:Ca.JobChange,context:Object.assign(Object.assign({},this.toChangeState()),{target:"job",error:e}),windowId:this._windowId})}toChangeState(){return{handle:this._jobHandle,timing:this._timing,execution:this._execution,meta:this._meta}}}var Ta=i(234247);class Ia extends Ta.default{remove(e,t){const i=[];let n;return this.forEach((a=>{t(a,e)?n=a:i.push(a)})),n&&(this.clear(),i.forEach((e=>this.enqueue(e)))),n}}const Na=(e,t)=>e.equals(t),Ea=()=>0;class Fa{constructor(e,t,i,n){this._jobExecutor=e,this._supportedPriority=t,this._changes=i,this._loggerFactory=n,this._logger=n.newLogger("GreedyJobExecutionQueue","core-services-scheduling"),this._queue=new Ia(Ea)}clearExecutionSchedule(){this._jobExecutor.clearExecutionSchedule(),this._queue.clear()}cancel(e){const t=this._queue.remove(e,Na);return t&&t.cancel()}enqueue(e,t,i,n,a){if(i.priority!==this._supportedPriority)return this._logger.errorToTelemetry&&this._logger.errorToTelemetry(`Job priroty [${Z.vW[i.priority]}] not supported by this queue, this queue supports [${Z.vW[this._supportedPriority]}]`,"webclient_framework_foundation_core_services_scheduling",void 0,!0),!1;const s=new _a(e,this._changes,i,t,this._loggerFactory,n,a);return this._queue.enqueue(s)?(s.receive(),this._jobExecutor.scheduleExecution({getJob:()=>this._queue.dequeue()}),!0):(this._logger.errorToTelemetry&&this._logger.errorToTelemetry("PriorityQueue did not enqueue the job","webclient_framework_foundation_core_services_scheduling",void 0,!0),!1)}}class xa{constructor(e,t,i){this._schedule=e,this._clearSchedule=t,this._logger=i}clearExecutionSchedule(){this._executionHandle&&this._clearSchedule(this._executionHandle)}scheduleExecution(e){this._executionHandle||(this._executionHandle=this._schedule((()=>{this._executionHandle=void 0,this.execute(e)})))}execute({getJob:e}){let t;for(;t=e();)try{t.execute()}catch(e){this._logger.errorToTelemetry&&this._logger.errorToTelemetry(`Job executor caught an exception executing a job. Continuing execution of remaining jobs. Error: ${e.message?e.message:e}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0)}}}class Da{constructor(e,t,i,n){this._changes=e,this._loggerFactory=i,this._windowId=n,this._logger=i.newLogger("QueueScheduler","core-services-scheduling"),this._queues=new Map,this.createQueues(t)}destroy(){this._queues.forEach((e=>{e.clearExecutionSchedule()}))}schedule(e,t,i,n){const a=this._queues.get(t.priority);return a?(a.enqueue(n,e,t,this._windowId,i),n):(this._logger.errorToTelemetry&&this._logger.errorToTelemetry(`Job priority [${Z.vW[t.priority]}] supplied by ${t.scheduledById} not supported by scheduling`,"webclient_framework_foundation_core_services_scheduling",void 0,!0),Z.o_)}cancel(e){let t;if(e===Z.o_)return t;const i=Array.from(this._queues.values());for(const n of i)if(t=n.cancel(e),t)break;return t}createQueues(e){this.createQueue(Z.vW.Macro,(t=>e.setTimeout(t)),(t=>e.clearTimeout(t))),this.createQueue(Z.vW.RenderBlocking,(t=>e.requestAnimationFrame(t)),(t=>e.cancelAnimationFrame(t)))}createQueue(e,t,i){const n=new xa(t,i,this._logger),a=new Fa(n,e,this._changes,this._loggerFactory);this._queues.set(e,a)}}var Aa;!function(e){e.PostTask="PostTask",e.Queue="Queue"}(Aa||(Aa={}));const Ma={[Z.vW.Background]:Aa.PostTask,[Z.vW.Macro]:Aa.Queue,[Z.vW.RenderBlocking]:Aa.Queue,[Z.vW.UserVisible]:Aa.PostTask};class Pa{constructor(e,t,i,n,a){const s=new Da(e,t,i,n),o=new ja(t,i,a);this.activeSchedulers=new Map([[Aa.PostTask,o],[Aa.Queue,s]])}static get nextJobHandle(){return this._nextJobHandle===Number.MAX_SAFE_INTEGER&&(this._nextJobHandle=0),++this._nextJobHandle}destroy(){this.activeSchedulers.forEach((e=>{e.destroy()}))}schedule(e,t,i){return this.findScheduler(t.priority).schedule(e,t,i,Pa.nextJobHandle)}cancel(e){for(const t of this.activeSchedulers.values()){const i=t.cancel(e);if(i)return i}}findScheduler(e){const t=this.activeSchedulers.get(Ma[e]);if(!t)throw new Error("No scheduler found for priority");return t}}Pa._nextJobHandle=0;const Oa=(e,t,i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const[n,s]=yield Promise.all([t.getUser({correlation:i}),Ra(t,i,a)]);if(s)for(const t of s)e.setContext("UserInfo.IsMRU",void 0,void 0,t.id);e.setContext("UserInfo.IsMRU",!0,void 0,n.id)})),Ra=(e,t,i)=>{if(i)return Promise.resolve(i);const n=e.getCachedUsers;return n?n(t):void 0},La=(e,t,i,a,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n,o,r;const c={id:a.id,source:a.source,scenarioName:z.RG.AuthWebUser};try{const[a,s]=yield Promise.all([null===(n=i.getCachedUsers)||void 0===n?void 0:n.call(i,c,{isAllCachedUsers:!0,isAuthenticated:!0}),null===(o=i.getCachedUsers)||void 0===o?void 0:o.call(i,c,{isPrimaryUser:!0})]);if(Oa(t,i,c,a),Array.isArray(a)){for(const e of a)t.setContext("UserInfo.IsPrimary",void 0,void 0,e.id);const e=a.filter((e=>e.profile.isHomeAccount)).length;t.setCoreContext("uniqueCredentialCount",e),t.setCoreContext("mtmaAccounts",a.length)}if(Array.isArray(s)){const[i,n]=s;e?t.setContext("UserInfo.IsPrimary",!0,void 0,i.id):(t.setCoreContext("primaryUserInfoId",i.profile.oid),t.setCoreContext("primaryUserInfoTenantId",i.profile.tid))}}catch(e){null===(r=s.errorToTelemetry)||void 0===r||r.call(s,"Failed to update MRU or sync mtma context","telemetry_instrumentation_update_user_context")}})),Ua={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"performWindowHistoryNavigation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"navigationDirection"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NavigationDirection"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"performWindowHistoryNavigation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"navigationDirection"},value:{kind:"Variable",name:{kind:"Name",value:"navigationDirection"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},$a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"navigateToWindowHistoryIndex"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowHistoryIndex"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"navigateToWindowHistoryIndex"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"windowHistoryIndex"},value:{kind:"Variable",name:{kind:"Name",value:"windowHistoryIndex"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},Wa={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CoreServicesWindowHistoryNavigationPushToWindowHistoryMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pushToWindowHistory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}},{kind:"Argument",name:{kind:"Name",value:"entityOptions"},value:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},Ba={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CoreServicesWindowHistoryNavigationRemoveFromWindowHistoryMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeFromWindowHistory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};class za{constructor(e,t,i,a,s){this._client=e,this._host=t,this._coreSettings=i,this._windowId=a,this._activeWindowsService=s,this.onPopState=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t;this.navigateTo((null===(t=e.state)||void 0===t?void 0:t.windowHistoryIndex)||0)}))}init(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.hostHistoryNavigationEnabled&&this._host.addEventListener("popstate",this.onPopState)}))}destroy(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.hostHistoryNavigationEnabled&&this._host.removeEventListener("popstate",this.onPopState)}))}navigate(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.mutate(Ua,{navigationDirection:e})}))}navigateTo(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.mutate($a,{windowHistoryIndex:e})}))}isEnableDecoupleCommandingFromApollo(){return this._activeWindowsService.enableDecoupleCommandingFromApollo}canNavigateObservable(){return this._activeWindowsService.getActiveWindowObservable(this._windowId).pipe((0,u.h)((e=>(null==e?void 0:e.isMainWindow)&&(null==e?void 0:e.layoutConfig.layoutMode)===ve.lO.standard||!1)),(0,l.U)((e=>{var t,i;return{canNavigateBack:(null===(t=null==e?void 0:e.windowHistoryNavigationState)||void 0===t?void 0:t.canNavigateBack)||!1,canNavigateForward:(null===(i=null==e?void 0:e.windowHistoryNavigationState)||void 0===i?void 0:i.canNavigateForward)||!1}})))}historyNavigationObservable(){return this._activeWindowsService.getActiveWindowObservable(this._windowId).pipe((0,u.h)((e=>(null==e?void 0:e.isMainWindow)&&(null==e?void 0:e.layoutConfig.layoutMode)===ve.lO.standard||!1)),(0,l.U)((e=>{var t,i;return{backHistory:(null===(t=null==e?void 0:e.windowHistoryNavigationState)||void 0===t?void 0:t.backHistory)||[],forwardHistory:(null===(i=null==e?void 0:e.windowHistoryNavigationState)||void 0===i?void 0:i.forwardHistory)||[]}})))}pushToWindowHistory(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.mutate(Wa,{entity:e,entityOptions:JSON.stringify(t)})}))}removeFromWindowHistory(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.hostHistoryNavigationEnabled)return this.mutate(Ba,{entity:e})}))}get hostHistoryNavigationEnabled(){var e;return(null===(e=this._coreSettings.get(S.J.Core))||void 0===e?void 0:e.enableHostHistoryNavigation)||!1}mutate(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this._client.mutate({mutation:e,variables:Object.assign(Object.assign({},t),{windowId:this._windowId}),fetchPolicy:"no-cache"})}))}}var Ha=i(383392);const qa={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeWindow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},Va={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"windowStateEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"windowStateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isFocused"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"shouldClose"}}]}}]}}]};class Ga{report(e){if(!this._changes||0===this._changes.observers.length)return;const t=e.changeCorrelationId||(0,qe.v4)();this.changes.next(Object.assign(Object.assign({},e),{changeCorrelationId:t}))}observeChanges(){return this.changes.asObservable()}get changes(){return this._changes||(this._changes=new _i.xQ),this._changes}}class Ja{constructor(e,t){this.parentContext=e,this.pulsarLibraryInstance=t}startSignal(e,t){return this.pulsarLibraryInstance.startSignal(e,t,this.parentContext)}}class Ka{constructor(e,t,i,n){this.logger=e,this.span=t,this.pulsarLibraryInstance=n,this.pulsarLibraryInstance.otlDependencies?this.signalContext=this.pulsarLibraryInstance.otlDependencies.trace.setSpan(i,t):this.logger.error("PulsarSignal: otlDependencies is not defined")}stop(e){this.span.setStatus(e),this.span.end()}appendEventData(e,t){this.span.setAttributes(Ka.eventDataToAttributes(e,t))}addEvent(e){this.span.addEvent(e)}getPulsarContext(){return new Ja(this.signalContext,this.pulsarLibraryInstance)}propagate(){if(!this.signalContext)return void this.logger.error("propagate: signalContext is not defined");const{W3CTraceContextPropagator:e,defaultTextMapSetter:t}=this.pulsarLibraryInstance.otlDependencies,i={};return(new e).inject(this.signalContext,i,t),i}static eventDataToAttributes(e,t){const i={};return Object.keys(t).forEach((n=>{i[`${e}.${n}`]=t[n]})),i}}var Qa,Ya,Xa;!function(e){e.TEAMS_CORE="Teams.Core",e.TEAMS_RENDERING="Teams.Rendering",e.TEAMS_RESOLVER="Teams.Resolver"}(Qa||(Qa={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(Ya||(Ya={})),function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(Xa||(Xa={}));class Za{constructor(e,t){this.exporter=e,this.otlDependencies=t,this._shutdownOnce=new this.otlDependencies.BindOnceFuture(this._shutdown,this)}forceFlush(){return Promise.resolve()}onStart(e){this.export(e,"onStart")}onEnd(e){this._shutdownOnce.isCalled||0!=(e.spanContext().traceFlags&Xa.SAMPLED)&&this.export(e,"onEnd")}shutdown(){return this._shutdownOnce.call()}export(e,t){const{context:i,suppressTracing:n,ExportResultCode:a,globalErrorHandler:s}=this.otlDependencies;i.with(n(i.active()),(()=>{this.exporter.export([e],(e=>{var t;e.code!==a.SUCCESS&&s(null!==(t=e.error)&&void 0!==t?t:new Error(`PulsarSpanProcessor: span export failed (status ${e})`))}),t)}))}_shutdown(){return this.exporter.shutdown()}}var es=i(864452);class ts{constructor(e,t){this.serviceName=e,this.config=t,this.consumerNotificationObserver=new _i.xQ,this.logger=t.loggerFactory.newLogger("PulsarLib","frameworks-pulsar"),this.sessionId=t.sessionId}initialize(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield this.importOTLDependencies(),this.initOTL()}))}shutdown(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield null===(e=this.provider)||void 0===e?void 0:e.shutdown()}))}startSignal(e,t,i){if(!this.tracer)return void this.logger.error("startSignal: tracer is not initialized");const n=i||this.otlDependencies.ROOT_CONTEXT,a=this.tracer.startSpan(e,t,n);return a.setAttribute("sessionId",this.sessionId),new Ka(this.logger,a,n,this)}startSignalFromCarrier(e,t,i){if(!t)return;if(!this.otlDependencies)return void this.logger.error("startSignalFromCarrier: OTL dependencies are not initialized");const{W3CTraceContextPropagator:n,ROOT_CONTEXT:a,defaultTextMapGetter:s}=this.otlDependencies,o=(new n).extract(a,t,s);return this.startSignal(e,i,o)}observeConsumerNotifications(){return this.consumerNotificationObserver.asObservable()}initOTL(){if(!this.otlDependencies)return void this.logger.error("initOTL: OTL dependencies are not initialized");const{WebTracerProvider:e,Resource:t,SemanticResourceAttributes:i,SimpleSpanProcessor:n,OTLPTraceExporter:a}=this.otlDependencies;this.provider=new e({resource:new t({[i.SERVICE_NAME]:this.serviceName})}),this.config.spanExporter.registerConsumerNotificationCallback((e=>{this.consumerNotificationObserver.next(e)})),this.provider.addSpanProcessor(new Za(this.config.spanExporter,this.otlDependencies)),this.config.logToOTLCollector&&this.provider.addSpanProcessor(new n(new a({url:"http://localhost:4318/v1/traces"}))),this.tracer=this.provider.getTracer("pulsar-tracer")}importOTLDependencies(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.otlDependencies=yield(0,es.m)()}))}}class is{constructor(){this.hasShutdown=!1,this.telemetryProvider=(0,Hi.G)(),this.telemetryProvider.registerPulsarBackchannelListener(this.notify.bind(this))}export(e,t,i){this.hasShutdown||e.forEach((e=>{switch(i){case"onStart":this.telemetryProvider.sendPulsarSignal({type:"onStart",span:this.sanitizeSpan(e)});break;case"onEnd":this.telemetryProvider.sendPulsarSignal({type:"onEnd",span:this.sanitizeSpan(e)})}}))}registerConsumerNotificationCallback(e){this.consumerNotificationCallback=e}shutdown(){return this.hasShutdown=!0,Promise.resolve()}notify(e){var t;null===(t=this.consumerNotificationCallback)||void 0===t||t.call(this,e)}sanitizeSpan(e){return Object.assign(Object.assign({},e),{_spanProcessor:void 0,_clock:void 0})}}const ns=(e,t,i)=>{const{enableThemePreferenceResolution:n}=t.get(S.J.Core),{environment:a}=t.get(S.J.Metadata);if(n){const t=(0,Ha.R6)(null!=a?a:At.s.prod);return(0,Ha.u_)(e,i,t)}return t.get(S.J.Host).theme||"default"},as=(e,t)=>e.subscribe({query:Va,variables:{windowId:t}}),ss=(e,t,i,n,a,s,o)=>{const{isFocused:r,shouldClose:c,correlation:l}=e&&e.data&&e.data.windowStateEvent;let d;const u=null==l?void 0:l.id;c?(t.close(),o.log(`host.close() called through window state event with correlationId ${u}`),d=Ge.B.Close):r&&(t.isFocused()?(o.log(`host.isFocused() returns true with correlationId ${u}`),d=Ge.B.AlreadyFocused):(t.focus(),o.log(`host.focus() called through window state event with correlationId ${u}`),d=Ge.B.Focus,s.loadModule("windowcontrols").then((e=>{var t;null===(t=null==e?void 0:e.focus)||void 0===t||t.call(e,i),o.log(`HostComms focus() called through window state event with correlationId ${u}`)})))),d&&u&&(n.report({context:{target:"handle-window-state-event"},correlationId:u,type:d}),a.report({type:Mt.FV.WindowStateChange,context:{target:"context-providers-handle-window-event"},correlationId:u,windowId:i}))},os=(e,t)=>(0,l.U)((i=>((e,t,i)=>(i&&(e._cleanupFns||(e._cleanupFns=[]),e._cleanupFns.push(i)),Object.assign(Object.assign({},e),t)))(i,e(i),t))),rs=e=>os((t=>({regenerateEntityCommandingServices:(i,n,a)=>(({appsRegistryService:e,client:t,clientPreferences:i,clientLaunchId:n,commandChangeReportingService:a,coreSettings:s,deeplinkService:o,hostCommunicationService:r,loggerFactory:c,notificationsHandler:l,platformService:d,scenarioFactory:u,shortcutExecutionService:m,userContextId:g,viewEntitiesRef:h,viewEntity:p,viewEntityName:v,windowId:f,windowLayoutService:b,windowProvider:y,userBiService:k,userTrackingService:S})=>ma((o=>xi({appsRegistryService:e,client:t,clientLaunchId:n,commandChangeReportingService:a,coreSettings:s,entityCommandInput:o,loggerFactory:c,platformService:d,scenarioFactory:u,windowId:f,executionContext:{userContextId:g,viewEntity:p,viewEntityName:v},windowProvider:y,userBiService:k,notificationsHandler:l,clientPreferences:i,userTrackingService:S})),((o,r)=>$t({appsRegistryService:e,client:t,clientPreferences:i,clientLaunchId:n,commandChangeReportingService:a,coreSettings:s,commandInput:o,commandHandler:r,loggerFactory:c,scenarioFactory:u,shortcutExecutionService:m,windowId:f,executionContext:{userContextId:g,viewEntitiesRef:h,viewEntity:p,viewEntityName:v},host:y,userBiService:k})),((o,d,b)=>Vt({appsRegistryService:e,client:t,clientLaunchId:n,clientPreferences:i,commandChangeReportingService:a,commandDelegator:b,commandHandler:d,coreSettings:s,eventInput:o,executionContext:{userContextId:g,viewEntitiesRef:h,viewEntity:p,viewEntityName:v},hostCommunicationService:r,loggerFactory:c,notificationsHandler:l,scenarioFactory:u,shortcutExecutionService:m,userBiService:k,windowId:f})),t,s,y,u,c,o,r,g,f,b,p,n))({appsRegistryService:t.appsRegistryService,client:t.client,clientPreferences:t.clientPreferences,clientLaunchId:t.correlation.clientLaunchId||void 0,commandChangeReportingService:t.commandChangeReportingService,coreSettings:t.coreSettings,deeplinkService:t.deeplinkService,hostCommunicationService:t.hostCommunicationService,loggerFactory:t.loggerFactory,notificationsHandler:t.notificationsHandler,platformService:t.platformService,scenarioFactory:t.scenarioFactory,shortcutExecutionService:t.shortcutExecutionService,userContextId:t.authenticationUser?(0,He.b4)(t.authenticationUser):void 0,viewEntitiesRef:i,viewEntity:n,viewEntityName:a,cdlWorkerRegistrarService:t.cdlWorkerRegistrarService,windowId:e,windowProvider:t.windowProvider,userBiService:t.userBiService,windowLayoutService:t.activeWindowsService.getWindowLayoutService(e),userTrackingService:t.userTrackingService})}))),cs=(e,t,i,n,a,s,o,r)=>e.pipe((e=>e.pipe((e=>os((()=>({windowProvider:e}))))(s),(e=>os((t=>({loggerFactory:new ae(t.diagnosticsService,e)}))))(i),((e,t)=>os((({loggerFactory:i,postTaskSchedulerDiagnosticsService:n})=>({scheduler:new Pa(new Ga,t,i,e,n)})),(({scheduler:e})=>e.destroy())))(i,s),((e,t)=>os((i=>{const n=i.windowProvider.viewportContext,a=t.type,s=i.coreSettingsContext.createContextForViewport({id:e,viewportContext:n,entityType:a}),o=s.getCoreSettings();return{coreSettingsContext:s,coreSettings:o}}),(({coreSettingsContext:e})=>e.cleanup())))(i,r),(e=>os((()=>({scenarioFactory:e})),(({scenarioFactory:e})=>e.destroy())))(t),(e=>os((t=>({userBiService:t.telemetryService.createUserBiService(t,e,{id:t.correlation.id,startTimestamp:+t.correlation.startTimestamp||0,source:t.correlation.source})})),(({userBiService:e})=>e.destroy())))(i),((e,t)=>os((({experienceChangeReportingService:i,authenticationUser:n})=>({experienceChangeReportingService:Object.assign(Object.assign({},i),{report:a=>{i.report(Object.assign({windowId:e,isMainWindow:t,userContextId:n?(0,He.b4)(n):void 0},a))}})}))))(i,n),((e,t)=>os((({activeWindowsService:i,appBarService:n,appsRegistryService:a,appStateService:s,appSwitcherPolicyCheckService:o,authenticationService:r,authenticationUser:c,cacheStorage:l,cdlWorkerService:d,client:u,clientPreferences:m,clientState:g,commandChangeReportingService:h,coreSettings:p,dataCleanupService:v,discover:f,experienceChangeReportingService:b,hostCommunicationService:y,localStorage:k,loggerFactory:w,notificationsHandler:j,offlineCacheManager:C,platformService:_,rebootService:T,scenarioFactory:I,user:N,userBiService:E,windowProvider:F,i18n:x,brbServiceManager:D,entityCommanding:A,pulsar:M,cdlAppStateService:P})=>{var O,R;const L=u,U={activeWindowsService:i,appBarService:n,appsRegistryService:a,appStateService:s,appSwitcherPolicyCheckService:o,authenticationService:r,authenticationUser:c,cacheStorage:l,cdlWorkerService:d,clientPreferences:m,clientState:g,commandChangeReportingService:h,coreSettings:p,dataCleanupService:v,discover:f,entityType:t,experienceChangeReportingService:b,hostCommunicationService:y,localStorage:k,loggerFactory:w,notificationsHandler:j,offlineCacheManager:C,platformService:_,pubsub:L.getServices().pubsub,rebootService:T,scenarioFactory:I,user:N,userBiService:E,windowId:e,windowProvider:F,i18n:x,brbServiceManager:D,entityCommanding:A,pulsar:M,cdlAppStateService:P},{enableViewSchema:$}=p.get(S.J.Core);return{client:L.clone(U),viewSchemaClient:$?null===(R=(O=L).cloneForViewSchema)||void 0===R?void 0:R.call(O,U):null}}),(({client:e,entityCommanding:t,viewSchemaClient:i,coreSettings:n})=>(null==i||i.destroy(),e.destroy(),n.get(S.J.Core).enableMTMA&&(null==e||e.clearCache()),t.destroy()))))(i,r.type))),(e=>e.pipe(((e,t,i)=>os((n=>(e&&n.notificationsHandler.initializeWithWindow(t,i,n.client),{notificationsHandler:n.notificationsHandler})),(()=>{})))(a,i,s),((e,t)=>os((i=>{var n;const{appsRegistryService:a,authenticationUser:s,client:o,commandResultChangeReportingService:r,coreSettings:c,correlation:{clientLaunchId:l},deeplinkService:d,hostCommunicationService:u,loggerFactory:m,scenarioFactory:g}=i,{entityCommanding:h,eventing:p}=ma((t=>xi({appsRegistryService:i.appsRegistryService,client:i.client,clientLaunchId:i.correlation.clientLaunchId||void 0,commandChangeReportingService:i.commandChangeReportingService,coreSettings:i.coreSettings,entityCommandInput:t,loggerFactory:i.loggerFactory,notificationsHandler:i.notificationsHandler,platformService:i.platformService,scenarioFactory:i.scenarioFactory,executionContext:{userContextId:i.authenticationUser?(0,He.b4)(i.authenticationUser):void 0},windowId:e,userBiService:i.userBiService,clientPreferences:i.clientPreferences,userTrackingService:i.userTrackingService}).then()),((n,a)=>$t({appsRegistryService:i.appsRegistryService,client:i.client,clientPreferences:i.clientPreferences,commandChangeReportingService:i.commandChangeReportingService,coreSettings:i.coreSettings,commandInput:n,commandHandler:a,loggerFactory:i.loggerFactory,scenarioFactory:i.scenarioFactory,shortcutExecutionService:i.shortcutExecutionService,windowId:e,host:t,userBiService:i.userBiService})),((t,n,a)=>Vt({appsRegistryService:i.appsRegistryService,client:i.client,clientPreferences:i.clientPreferences,commandChangeReportingService:i.commandChangeReportingService,commandDelegator:a,commandHandler:n,coreSettings:i.coreSettings,eventInput:t,hostCommunicationService:i.hostCommunicationService,loggerFactory:i.loggerFactory,notificationsHandler:i.notificationsHandler,scenarioFactory:i.scenarioFactory,shortcutExecutionService:i.shortcutExecutionService,userBiService:i.userBiService,windowId:e})),o,c,t,g,m,d,u,s?(0,He.b4)(s):void 0,e,i.activeWindowsService.getWindowLayoutService(e),void 0,l||void 0);let v=i.commandResultHooksService;return v&&(null===(n=c.get(S.J.Core))||void 0===n?void 0:n.enableStandaloneCommandReportingService)&&(v=new ha(a,o,r,c,h,m,g,i.authenticationUser&&(0,He.b4)(i.authenticationUser)),v.init()),{entityCommanding:h,eventing:p,commandResultHooksService:v}}),(({commandResultHooksService:e})=>null==e?void 0:e.destroy())))(i,s),os((e=>({errorState:new Sa(e.windowProvider,e.scenarioFactory,e.platformService,e.networkState,e.diagnosticsService,e.coreSettings)})),(({errorState:e})=>e.dispose())),(e=>os((()=>({clientState:e}))))(o),rs(i),(e=>os((t=>{const i=new za(t.client,t.windowProvider,t.coreSettings,e,t.activeWindowsService);return i.init(),{windowHistoryNavigationService:i}}),(({windowHistoryNavigationService:e})=>e.destroy())))(i),os((e=>{const{enablePulsarTelemetry:t,logToOTLCollector:i}=e.coreSettings.get(S.J.Pulsar),n=new ts(Qa.TEAMS_RENDERING,{sessionId:e.platformService.host.sessionId,spanExporter:new is,loggerFactory:e.loggerFactory,logToOTLCollector:!!i});return t&&n.initialize(),{pulsar:n}}),(({pulsar:e})=>e.shutdown())))),(e=>e.pipe(((e,t,i)=>os((n=>(n.authenticationUser&&n.experienceLifecycleManager.manageWindow(e,n.authenticationUser.id,Object.assign(Object.assign({},n),{isMainWindow:t,isNotificationsWindow:i})),{})),(t=>t.authenticationUser&&t.experienceLifecycleManager.removeWindow(t.authenticationUser.id,e,"window_closed"))))(i,n,a)))),ls=(e,t,i,n,a,s,o,r,c)=>{const d=r.pipe((0,xt.g)("userContextId"),(0,Dt.w)((({userContextId:e,correlation:t})=>c(e||void 0).pipe((0,l.U)((e=>({context:e,correlation:t})))))),(0,xt.g)("context"),(0,g.b)((({context:e,correlation:t})=>s&&ds(e,t))),(0,l.U)((({context:e,correlation:t})=>Object.assign(Object.assign({},e),{correlation:t}))));return cs(d,e,t,s,o,i,n,a)},ds=(e,t)=>{var i,n,a,s;const{coreSettings:o,cdlWorkerRegistrarService:r}=e,c=null===(i=null==o?void 0:o.get(S.J.Core))||void 0===i?void 0:i.enableMTMA,l=!!(null===(n=null==o?void 0:o.get(S.J.CdlWorker))||void 0===n?void 0:n.enableUserContextWorkerRegistration),d={id:t.id,source:t.source,scenarioName:t.scenarioName||"auth_switch_account"};e.authenticationUser&&c&&(null===(s=(a=e.authenticationService).updateMostRecentUser)||void 0===s||s.call(a,{accountId:(0,He.b4)(e.authenticationUser),correlation:d}).then((()=>{d.scenarioName=z.RG.AuthWebUser,Oa(e.telemetryContextService,e.authenticationService,d)})).then((()=>{l&&e.authenticationUser&&r.setMainWindowWorkerByUserId((0,He.b4)(e.authenticationUser))})))},us=(e,t,i)=>{i.log(`Removing window ${e} from apollo cache`),t.client.mutate({mutation:qa,variables:{windowId:e}}).catch((e=>i.error("Error in removing window: ",e)))},ms=(e,t,i,n,a="")=>{var s;return e.telemetryService.createScenarioFactory(e,t,{id:i.id,startTimestamp:parseInt(i.startTimestamp,10)||0,source:i.source},null!==(s=i.clientLaunchId)&&void 0!==s?s:void 0,n,a)},gs=(e,t)=>e.markStep(z.RG.WindowLaunchTime,t);var hs=i(301835);const ps={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"setWindowFullscreen"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isFullscreen"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setWindowFullscreen"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"isFullscreen"},value:{kind:"Variable",name:{kind:"Name",value:"isFullscreen"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var vs=i(101027);const fs=(e,t)=>e.opener.postMessage(L.Gx.Destroy,{windowId:t});function bs(e,t,i,a,s,o,r,c){return(0,n.__awaiter)(this,void 0,void 0,(function*(){gs(a,z.ck.BeginWindowCreation);const n=e.windowProvider;if(t===h.ew)return n;const l=yield function(e,t,i,n){return new Promise(((a,s)=>{const o=e.setTimeout((()=>{s("New Frame did not report in 10000ms")}),1e4),r=e.self;return r.frameResolvers=r.frameResolvers||{},r.frameResolvers[t]=i=>{e.clearTimeout(o),Ts(e,t),a(i)},e.opener.postMessage(L.Gx.Create,{windowId:t,correlation:i,activeEntities:n})}))}(n,t,s,c);if(!l)return n;const d=(0,hs.dP)(l,e,t,o,r),u=d.getHostedWindowContext();return Object.assign(d,{getHostedWindowContext:()=>Object.assign(Object.assign({},u),{windowId:t}),viewportContext:Et.R.iFrame}),gs(a,z.ck.EndWindowCreation),Ns(l,t,d.viewportContext,c),Ns(d,t,d.viewportContext,c),ys(l,d,e,t,i),d.close=()=>fs(n,t),d}))}const ys=(e,t,i,n,a,s)=>{ks(i,e,t);const o="onpagehide"in t?"pagehide":"unload",r=t.onFullscreen().subscribe((e=>{i.client.mutate({mutation:ps,variables:{isFullscreen:e,windowId:n}})})),c=()=>{e&&Es(e),Es(t),us(n,i,a),s&&s(),t.removeEventListener(o,c),r.unsubscribe()};t.addEventListener(o,c)},ks=(e,t,i)=>{var n;const a=null===(n=e.leakDetectorService)||void 0===n?void 0:n.create();null==a||a.track(vs.I.UnwrappedIFrame,t),null==a||a.track(vs.I.IFrameWrapper,i)},Ss=({id:e,activeEntities:t},i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{window:n,context$:a}=yield i;return{id:e,window:n,context$:a,activeEntities:t}})),ws=(e,t,i)=>(0,r.z)(de((a=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return Cs(a,e,t,i)}))),(e=>function(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{window:n,subscription:a,clientState:s}=yield t,o=null===(i=n.location.hash)||void 0===i?void 0:i.slice(1);o?fs(n,o):n.close(),a&&a.unsubscribe(),s&&s.dispose(),null==e||e.cleanup(),n.destroy(0)}))}(t.leakDetectorService,e)),Ss,((e,i)=>((e,t,i)=>{const n=i.loggerFactory.newLogger("IframeStateManager","core-services-activator");n.error(`Creation for window ${e.id} failed with ${t}. Removing window from cache`),i.commandChangeReportingService.report({context:{target:"iframe-state-manager",errorInfo:Je.y.CreateWindowError},correlationId:e.correlation.id,type:Ge.B.Failure}),us(e.id,i,n)})(e,i,t)))),js=(e,t,i,a,s,o,r,c,l,d,u)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return e&&t?Promise.resolve(((e,t,i,n,a,s,o)=>{const r=t.windowProvider,c=r.open(void 0,e,"width=600px,height=500px,toolbar=no,menubar=no,location=no");if(o){const{clientPreferences:e,coreSettings:i}=t,n=o({theme:ns(e,i,r),viewportContext:Et.R.iFrame});c.document.write(n),c.document.close()}const l=()=>{const e=new URL(r.location.href);e.searchParams.append("random",Date.now().toString()),e.hash=[r.location.pathname,n.mainEntity.type,encodeURIComponent(n.mainEntity.id)].join("/"),c.location.href=decodeURIComponent(e.href)};r.addEventListener("unload",l);let d=(0,hs.dP)(c,t,e,a,s);return d=Object.assign(d,{getHostedWindowContext:()=>({startReason:Ft.zF.userInitiated,panelContext:Ft.QP.secondary})}),Ns(c,e,d.viewportContext,n),Ns(d,e,d.viewportContext,n),ys(c,d,t,e,i,(()=>{r.removeEventListener("unload",l)})),d})(a,i,s,c,l,d,u)):bs(i,a,s,o,r,l,d,c)})),Cs=(e,t,i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{id:n,correlation:s,activeEntities:o,isMainWindow:r,layoutConfig:{layoutMode:c}}=e,{coreSettings:l}=i,d=s.source===k.D.PopOutButton,{enablePopOutChats:u}=l.get(S.J.Messaging),m=new ae(i.diagnosticsService,n),g=m.newLogger("IframeStateManager","core-services-activator"),h=Object.assign(Object.assign({},i),{loggerFactory:m}),p=ms(h,n,s,Et.R.iFrame);return _s(t,h,g,n,s,o,d,u,p,r,c,a)})),_s=(e,t,i,a,s,o,r,c,l,d,u,m)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=yield js(c,r,t,a,i,l,s,o,d,u,m),g=as(t.client,a).subscribe((e=>ss(e,n,a,t.commandChangeReportingService,t.experienceChangeReportingService,t.hostCommunicationService,i))),h=t.clientState.getChildWindowStateProvider(n,t.loggerFactory,t.coreSettings),{mainEntity:p}=o,v=Is(n,a,d,g,h,e,l,s,p);return gs(l,z.ck.WindowContextProvider),v})),Ts=(e,t)=>e.opener.postMessage(L.Gx.Acquired,{windowId:t}),Is=(e,t,i,n,a,s,o,r,c)=>({window:e,subscription:n,clientState:a,context$:cs(s(void 0).pipe((0,l.U)((e=>Object.assign(Object.assign({},e),{correlation:r})))),o,t,i,!1,e,a,c)}),Ns=(e,t,i,n)=>{e.iframeLeakInfo={iframeLeakInfoStartTime:(new Date).toISOString(),iframeLeakInfoEntities:Object.keys(n).reduce(((e,t)=>{const i=n[t],a=i&&"object"==typeof i&&"type"in i?null==i?void 0:i.type:void 0;return a&&(e[t]=a),e}),{}),iframeLeakInfoViewportContext:i,iframeLeakInfoWindowId:t}},Es=e=>{e.iframeLeakInfo||(e.iframeLeakInfo={}),e.iframeLeakInfo.iframeLeakInfoEndTime=(new Date).toISOString()};var Fs=i(520116),xs=i(170348);const Ds=(e,t,i)=>{e.opener.postMessage(L.rY.ShouldShowChatNotification,{shouldShowChatNotification:t,windowId:i})};var As=i(313298),Ms=i(318379),Ps=i(446652),Os=i(558632),Rs=i(23669),Ls=i(929778);const Us=(e,t)=>!!(e===t||!e&&!t||e&&t&&e.id===t.id&&e.type===t.type&&e.action===t.action);function $s(e,t){var i,n;if(!t||!t.activeEntities)return!1;const a=null===(i=t.activeEntities)||void 0===i?void 0:i.mainEntity,s=null===(n=e.activeEntities)||void 0===n?void 0:n.mainEntity;return!Us(s,a)&&!function(e,t){const i=["subNavEntity","headerEntity","startEntity","mainEntity","endEntity"];for(const n of i)if(e[n]||t[n])return Us(e[n],t[n]);return!1}(e.activeEntities,t.activeEntities)}const Ws=e=>({isChanged:Bs,execute:t=>{e.dataCleanupService.markDataForWindowAsInactive(t.id)}});function Bs(e,t){return function(e){var t;return!!e.isMainWindow&&(null===(t=e.layoutConfig)||void 0===t?void 0:t.layoutMode)===ve.lO.standard}(e)&&function(e,t){var i,n;if(!t||!t.activeEntities)return!1;const a=null===(i=t.activeEntities)||void 0===i?void 0:i.mainEntity,s=null===(n=e.activeEntities)||void 0===n?void 0:n.mainEntity;return!Us(s,a)}(e,t)}const zs=e=>({isChanged:(e,t)=>!e.isMainWindow&&!e.isNotificationsWindow&&$s(e,t),execute:(t,i)=>function(e,t,i){var n;const a=t.activeEntities.mainEntity,s=null==i?void 0:i.activeEntities.mainEntity,o=e.appsRegistryService.getApp({entityType:a.type});if(!o)throw new Error("Entity does not match to an existing app");const r=null===(n=o.getAppWindowFeatures)||void 0===n?void 0:n.call(o,{coreServices:e,host:t.window,isResize:!0,prevEntityType:null==s?void 0:s.type,entityType:null==a?void 0:a.type});if(!r)return;const{width:c,height:l,minWidth:d,minHeight:u}=r,{window:m}=t,g=e.loggerFactory.newLogger("WindowResizeCommand","core-services-activator");g.log(`From ${null==s?void 0:s.type} of height ${m.innerHeight} and width ${m.innerWidth}, to ${a.type} of height ${l} and width ${c}`),d&&u&&(m.setMinimumSize&&m.setMinimumSize(d,u),e.hostCommunicationService.loadModule("windowcontrols").then((e=>{var i;return null===(i=null==e?void 0:e.setMinimumWindowSize)||void 0===i?void 0:i.call(e,t.id,d,u)})));c&&l&&(m.setBounds&&m.setBounds({x:m.screenX,y:m.screenY,width:c,height:l}),e.hostCommunicationService.loadModule("windowcontrols").then((e=>{var i;return null===(i=null==e?void 0:e.setWindowBounds)||void 0===i?void 0:i.call(e,t.id,void 0,void 0,Math.trunc(c),Math.trunc(l))})))}(e,t,i)});const Hs=e=>({isChanged:(e,t)=>!(!e.isMainWindow||e.layoutConfig&&e.layoutConfig.layoutMode!==ve.lO.standard||e.userContextId===(null==t?void 0:t.userContextId)),execute:t=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var i;if((0,Rs._)(e.coreSettings,e.platformService)&&t.userContextId){const n=yield e.hostCommunicationService.loadModule("core");null===(i=null==n?void 0:n.setUserContextIdOnWindow)||void 0===i||i.call(n,t.userContextId,t.id)}}))});function qs(e){return!e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||"bigint"==typeof e||"symbol"==typeof e}function Vs(e){return function(t){const i=t&&("error"in t&&t.error||"reason"in t&&t.reason);return e.setTimeout((()=>function(e){if(e instanceof Error){const t=e.stack,i=e.message,n=e.code;Error.captureStackTrace(e),Object.setPrototypeOf(e,{});for(const t of Reflect.ownKeys(e))delete e[t];e.message=qs(i)?i:JSON.stringify(i),e.stack=qs(t)?t:JSON.stringify(t),e.code=qs(n)?n:JSON.stringify(n),Reflect.preventExtensions(e)}}(i)),0),console.error("Unhandled error/rejection",t),t&&t.preventDefault&&t.preventDefault(),!0}}function Gs(e){!function(e){for(const t in e.console){const i=t;if("function"!=typeof e.console[i]||"Console"===i||"assert"===i||"dir"===i||"dirxml"===i||"table"===i)continue;const n=e.console[i];e.console[i]=function(...e){return n(...e.map((e=>{if(qs(e))return e;try{return JSON.stringify(e)}catch(t){return`Can't stringify ${e} - circular reference`}})))},Object.defineProperty(e.console[i],"name",{value:i,writable:!1})}}(e);const t=Vs(e);e.addEventListener("unhandledrejection",t),e.addEventListener("error",t)}function Js(e,t,i,a,s,o,r,c,l){var d;let u={},m={};if(l)u=l({coreServices:e,host:t,screenState:s,windowOptions:a,entityType:i,entityOptions:c})||{};else{const n=e.appsRegistryService.getApp({entityType:i});if(!n)throw new Error("Entity does not match to an existing app");m=(null===(d=n.getAppWindowFeatures)||void 0===d?void 0:d.call(n,{coreServices:e,host:t,screenState:s,windowOptions:a,entityType:i,entityOptions:c}))||{}}const g=Object.assign(Object.assign({},u),m),{additionalFeatures:h={}}=g,p=(0,n.__rest)(g,["additionalFeatures"]),{width:v,height:f,minWidth:b,minHeight:y}=p;void 0!==v&&void 0!==b&&v<b&&(p.width=b),void 0!==f&&void 0!==y&&f<y&&(p.height=y);let k=Object.keys(p).reduce(((e,t)=>`${e}${e?",":""}${t}=${p[t]}`),"");return k=e.platformService.config.clientType===Ps.Bh.Web?`${k},toolbar=no,menubar=no,location=no`:k,r=Object.keys(h).reduce(((e,t)=>h?(0,Os.ZN)(e,t,h[t]):e),r),o.log(`windowFeatures: ${k}, url: ${r}`),{url:r,windowFeatures:k}}const Ks=(e,t)=>{switch(t){case xe.lOW.standard:return(0,Os.ZN)(e,"window",Ft.d.main);case xe.lOW.minimal:return(0,Os.ZN)(e,"window",Ft.d.flyout);case xe.lOW.minimode:return(0,Os.ZN)(e,"window",Ft.d.minimode);default:return e}},Qs=(e,t,i,n,a,s,o,r,c,l,d,u,m,g,h,p)=>{var v,f,b;let y="",k="about:blank";const{coreSettings:w,platformService:j}=t;d!==xe.lOW.minimode&&(k=j.config.clientType!==Ps.Bh.Web?(0,Os.ZN)(k,"entityType",o.type):k);const C={url:k,windowId:i,windowFeatures:y,globalWindow:e,coreServices:t,logger:n,scenarioFactory:a,windowState:s,isMainWindow:c,isNotificationsWindow:l,layoutMode:d,userContextId$:m,templateGenerator:h};if(j.config.clientType===Ps.Bh.Maglev){const{addWindowIdQsp:a}=t.coreSettings.get(S.J.Core),{enablePinchToZoomTouchpad:s}=t.coreSettings.get(S.J.Calling);a&&(k=(0,Os.ZN)(k,"windowId",i)),s&&(k=(0,Os.ZN)(k,"pinchzoom","true"));const h=m.value.userContextId;if((0,Rs._)(w,j)&&h&&(k=(0,Os.ZN)(k,"userContextId",h)),k=((e,t)=>t?(0,Os.ZN)(e,"show","false"):e)(k,u),c){if(d===xe.lOW.standard){const{flushViewSchemaClient:e}=t.coreSettings.get(S.J.Core);e&&(null===(f=null===(v=t.client)||void 0===v?void 0:v.viewSchemaClient)||void 0===f||f.clearStore()),k=(0,Os.ZN)(k,"customframetheme","main")}else d===xe.lOW.minimode&&(({url:k,windowFeatures:y}=Js(t,e,o.type,null!=g?g:o.windowOptions,r,n,k,null)),k=(0,Os.ZN)(k,"customframetheme","nobuttons"),null===(b=y.split(","))||void 0===b||b.forEach((e=>{k=(0,Os.ZN)(k,e.split("=")[0],e.split("=")[1])})));return Ys(Object.assign(Object.assign({},C),{url:Ks(k,d),windowFeatures:y}))}l&&(k=(0,Os.ZN)(k,"window",Ft.d.notifications)),k=(0,Os.ZN)(k,"customframetheme","default")}return({url:k,windowFeatures:y}=Js(t,e,o.type,null!=g?g:o.windowOptions,r,n,k,o.options,p)),Ys(Object.assign(Object.assign({},C),{url:k,windowFeatures:y}))},Ys=({url:e,windowId:t,windowFeatures:i,globalWindow:n,coreServices:a,logger:s,scenarioFactory:o,windowState:r,isMainWindow:c,isNotificationsWindow:l,layoutMode:d,userContextId$:u,templateGenerator:m})=>{const g=n.open(e,t,i||void 0);if(!g)throw new ze.G(ze.$.WINDOW_UNDEFINED);var h;(h=g)._leakOverrides||(h._leakOverrides=!0,Gs(h));const p=(0,hs.dP)(g,a,t,c,d);go(g,t,p.viewportContext,e),go(p,t,p.viewportContext,e),s.log(`windowState: ${JSON.stringify(r)}`);const{minWidth:v=0,minHeight:f=0}=r;p.setMinimumSize&&p.setMinimumSize(v,f),Xs(n,p,a,m),gs(o,z.ck.EndWindowCreation),Zs(g,p,a,d,o,u,t,s),eo(a,p,g);const{enableHostHistoryNavigation:b}=a.coreSettings.get(S.J.Core);return b||l||p.history.pushState("defaultBrowserHistory",""),p},Xs=(e,t,i,n)=>{if(!n)return;if(!!t.document.getElementById("app"))return;const{clientPreferences:a,coreSettings:s,platformService:o}=i,r=o.config.clientVersion.split("/").pop(),c=dt(n({theme:ns(a,s,e),osPlatform:o.config.osPlatform,cspNonce:e.__webpack_nonce__,publicPathScript:`window.__webpack_public_path__="${o.config.publicPath}"`,containerVer:r,environment:s.get(S.J.Metadata).environment||"",viewportContext:t.viewportContext,shouldStubConsoleError:!0}));t.document.write(c),t.document.close()},Zs=(e,t,i,n,a,s,o,r)=>{const{disableMainWindowMouseListeners:c,enableActiveWindowsHistoryRecovery:l}=i.coreSettings.get(S.J.Core),d=()=>{t.opener.postMessage(L.rY.UnhandledMouseEvent,{type:"mousemove"})},u=()=>{t.opener.postMessage(L.rY.UnhandledMouseEvent,{type:"click"})},m=e=>{if(!(e=>{var t,i;const n=e.target,a=null===(t=n.nodeName)||void 0===t?void 0:t.toLowerCase(),s=null===(i=n.type)||void 0===i?void 0:i.toLowerCase();return!(!n||!(n.isContentEditable||"textarea"===a||"input"===a&&/^(?:text|email|number|search|tel|url|password)$/i.test(s)))})(e))return e.preventDefault(),!1},g="onpagehide"in t?"pagehide":"unload",p=(e=>{const{disableContextMenu:t}=e.coreSettings.get(S.J.Core);return!!t})(i),v=t.onFullscreen().subscribe((e=>{i.client.mutate({mutation:ps,variables:{isFullscreen:e,windowId:o}})})),f=()=>{if(s.isStopped)return;const{correlation:{id:e},userContextId:n}=s.value;i.experienceChangeReportingService.report({correlationId:e,type:Mt.FV.WindowOptionsChange,userContextId:n||void 0,windowId:o,context:{target:"window-state-manager",height:t.innerHeight,left:t.screenX,top:t.screenY,width:t.innerWidth}})},b=l&&i.platformService.config.clientType===Ps.Bh.Maglev&&n===xe.lOW.focus&&o!==h.ew,y=b&&(0,Fs.R)(t,"resize").pipe((0,As.b)(500)).subscribe(f),k=b&&s.pipe((0,As.b)(500)).subscribe(f),w=()=>{r.log(`${g} called for window ${o}`),e&&ho(e),ho(t),uo(a),us(o,i,r),t.document.removeEventListener("mouseenter",d),t.document.removeEventListener("click",u),p&&t.removeEventListener("contextmenu",m),t.removeEventListener(g,w),r.log(`blur/unload listeners removed for windowId: ${o}`),mo(i,t,r,o),v.unsubscribe(),y&&y.unsubscribe(),k&&k.unsubscribe()};o!==h.ew||c||(t.document.addEventListener("mouseenter",d),t.document.addEventListener("click",u)),t.addEventListener(g,w),p&&t.addEventListener("contextmenu",m)},eo=(e,t,i)=>{var n;const a=null===(n=e.leakDetectorService)||void 0===n?void 0:n.create();null==a||a.track(vs.I.UnwrappedWindow,i),null==a||a.track(vs.I.WindowWrapper,t)},to=(e,t,i,n)=>{return(0,r.z)((0,Ls.j)((a=>io(a,e,t,i,n)),(e=>so(e,t)),oo,((e,i)=>((e,t,i)=>{let n,a;const s=i.loggerFactory.newLogger("WindowStateManager","core-services-activator");t instanceof ze.G&&Re.G.isFunction(t.toTelemetryEntry)?(n=t.code,a=t.toTelemetryEntry()):(n=Je.y.CreateWindowError,a=(0,U.u4)(t)),s.error(`Creation for window ${e.id} failed with ${a}. Removing window from cache`),i.commandChangeReportingService.report({context:{target:"window-state-manager",errorInfo:n,errorMessage:a},correlationId:e.correlation.id,type:Ge.B.Failure}),us(e.id,i,s)})(e,i,t))),lo([Hs(t),zs(t),Ws(t)]),(a=t.platformService.config.clientType===Ps.Bh.Web,s=e=>co(e,t),e=>a?e.pipe((0,g.b)((e=>s(e)))):e));var a,s},io=(e,t,i,n,a)=>{const{id:s,activeEntities:o,correlation:r,screenState:c,isMainWindow:l,isNotificationsWindow:d,layoutConfig:{layoutMode:u},isInitialWindowStateHidden:m,userContextId:g,windowOptions:h}=e,{mainEntity:p,endEntity:v}=o,f=new ae(i.diagnosticsService,s),b=f.newLogger("WindowStateManager","core-services-activator"),y=Object.assign(Object.assign({},i),{loggerFactory:f}),k=ms(y,s,r,(0,hs.YR)(l,u),g||""),S=k.findScenario(z.RG.WindowLaunchTime);let w;return null==S||S.appendEventData({mainEntityType:p.type,endEntityType:null==v?void 0:v.type}),w=a?a({coreServices:i,isResize:!0,entityType:p.type,windowOptions:h})||{}:((e,t,i)=>{var n;const a=e.appsRegistryService.getApp({entityType:t.type});return(null===(n=null==a?void 0:a.getAppWindowFeatures)||void 0===n?void 0:n.call(a,{coreServices:e,isResize:!0,entityType:t.type,windowOptions:i}))||{}})(y,p,null!=h?h:p.windowOptions),no(t,g,y,s,p,b,k,w,r,c,l,d,u,m,h,n,a)},no=(e,t,i,n,a,o,r,c,l,d,u,m,g,p,v,f,b)=>{const y=new s.X({userContextId:t,correlation:l}),k=((e,t,i,n,a,s,o,r,c,l,d,u,m,g,p)=>{gs(n,z.ck.BeginWindowCreation),i.log(`mainEntityId: ${s.id}, mainEntityType: ${s.type}, mainEntityAction: ${s.action}`);const v=e.windowProvider;return t===h.ew?(Zs(void 0,v,e,l,n,u,t,i),v):Qs(v,e,t,i,n,a,s,o,r,c,l,d,u,m,g,p)})(i,n,o,r,c,a,d,u,m,g,p,y,v,f,b),S=((e,t,i,n)=>as(e.client,t).subscribe((a=>ss(a,i,t,e.commandChangeReportingService,e.experienceChangeReportingService,e.hostCommunicationService,n))))(i,n,k,o),w=i.clientState.getChildWindowStateProvider(k,i.loggerFactory,i.coreSettings),j=ao(k,n,y,S,w,e,r,a,u&&g===xe.lOW.standard,m,i.loggerFactory,i.leakDetectorService);return gs(r,z.ck.WindowContextProvider),i.commandChangeReportingService.report({context:{target:"window-state-manager-create-window",layoutMode:g},correlationId:l.id,type:Ge.B.WindowCreated,isMainWindow:u,userContextId:t}),j},ao=(e,t,i,n,a,s,o,r,c,l,d,u)=>({id:t,window:e,windowStateSubscription:n,clientState:a,leakDetectorService:u,loggerFactory:d,userContextId$:i,context$:ls(o,t,e,a,r,c,l,i,s)}),so=({clientState:e,id:t,window:i,windowStateSubscription:n,loggerFactory:a,leakDetectorService:s},o)=>{const r=a.newLogger("WindowStateManager","core-services-activator");r.log(`Destroy called on window ${t}`),t!==h.ew&&(i&&i.close(),r.log(`Window.close() called for window ${t}`),null==i||i.destroy(500)),null==n||n.unsubscribe(),null==s||s.cleanup(),e.dispose(),o.appsRegistryService.removeWindowViewState(t)},oo=({activeEntities:e,correlation:t,id:i,isMainWindow:n,isNotificationsWindow:a,layoutConfig:s,userContextId:o},{context$:r,window:c,userContextId$:l})=>(l.next({userContextId:o,correlation:t}),{activeEntities:e,context$:r,id:i,isMainWindow:n,isNotificationsWindow:a,layoutConfig:s,userContextId:o,window:c});let ro;const co=(e,t)=>{const i=t.loggerFactory.newLogger("WindowStateManager","core-services-activator"),{isChatHybridArchitectureEnabled:n}=t.coreSettings.get(S.J.Host);if(n){if(!e.find((e=>e.id===h.ew)))return}const a=t.windowProvider,s="onpagehide"in a?"pagehide":"unload";a.removeEventListener(s,ro),ro=()=>{i.log(`Global window unload handler called for ${e.length} windows`),e.forEach((e=>{e.id!==h.ew&&e.window.close()}))},a.addEventListener(s,ro,{once:!0})},lo=e=>(0,Ms.R)(((t,i)=>(i.forEach((i=>{const n=t.find((e=>e.id===i.id));e.forEach((e=>{e.isChanged(i,n)&&e.execute(i,n)}))})),i)),[]),uo=e=>{e.stopScenarioIfActive(z.RG.WindowLaunchTime,{},"abandoned")},mo=(e,t,i,n)=>{(e=>{const{enableCdlRegistration:t}=e.coreSettings.get(S.J.Core);return!!t})(e)&&(t.opener.postMessage(L.rY.CdlRegistration,{childWindowId:n,eventType:"unregister"}),i.log(`CdlRegistration: windowId: '${n}', eventType: unregister`))},go=(e,t,i,n)=>{const a=new URL(n);e.windowLeakInfo={windowLeakInfoStartTime:(new Date).toISOString(),windowLeakInfoEntityType:a.searchParams.get("entityType")||n,windowLeakInfoViewportContext:i,windowLeakInfoWindowId:t}},ho=e=>{e.windowLeakInfo||(e.windowLeakInfo={}),e.windowLeakInfo.windowLeakInfoEndTime=(new Date).toISOString()};var po=i(898293);class vo extends Ue{constructor(){super(h.Yg.ClearStoreCartTask,["authenticationService","coreSettings","scenarioFactory","loggerFactory"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:i,loggerFactory:n,scenarioFactory:a}=e,s=n.newLogger("ClearStoreCartTask","core-services-tasks"),{appManifestUC:o}=i.get(S.J.Marketplace);return e=>{if("signout"===e)(0,po.Dj)(null==o?void 0:o.id,t,a).catch((e=>s.log(`ClearStoreCartTask: ${e.message}`)))}}))}}var fo=i(699355),bo=i(328942),yo=i(424356);const ko=new Map,So=1e3,wo=/^\/|\/$/g,jo=0,Co=1,_o=2,To=3;function Io(e,t){return new URL(e,t.get(S.J.Host).deepLinkDomain||void 0)}function No(e){return e.toLowerCase()}function Eo(e){const{hash:t,search:i}=e;let n=i;if(t&&!(0,B.isEmpty)(t)){const e=t.indexOf("?");e>=0&&(n=t.substr(e+1,t.length-1))}const a=function(e){return(0,yo.parse)(e||"")}(n),s=a;let o;return s.correlationId&&s.startTimestamp&&s.source&&(o={id:s.correlationId,startTimestamp:s.startTimestamp,source:s.source}),o}function Fo({clientLaunchId:e,location:t}){var i;return null!==(i=null!=e?e:t&&Do(t,"clientId"))&&void 0!==i?i:(0,qe.v4)()}function xo(e,t){let i=Eo(e);return i=i||tt({id:Do(e,"deeplinkId"),scenarioName:z.RG.NavigationCommand,source:t}),i}function Do(e,t){const{hash:i}=e;if(i){const e=Oo(i);return e&&e[t]}}function Ao(e){const{action:t,id:i,type:n}=e;if(t===pe.uk.default)switch(e.type){case pe.py.default:return fo.n0.default;case pe.py.flyout:return fo.n0.flyout}return i?`/${n}/${i}/${t}`:`/${n}/${t}`}function Mo(e){const{experienceBasePath:t,location:i,loggerFactory:n}=e,{hash:a,href:s,pathname:o}=i,r=n.newLogger(Jt,"core-services-deeplink");if(!a&&!s&&!o)return;const c=function(e,t){return!(!t||!e.pathname)&&Po(e.pathname)===Po(t)}(i,t);if(a||!c){if(a){r.log("generateDeepLinkFromLocation::hash");const{deepLink:e,crash:t,relaunch:i,source:n,userContextId:s,windowType:o,homeCloud:l}=Oo(a);if(e)return{deepLink:e,homeCloud:l,crash:t,relaunch:i,relaunchSource:n,isDesktopDeeplink:!0,userContextId:s,windowType:o};if(c)return{deepLink:a.startsWith("#")?a.substring(1):a,isDesktopDeeplink:!1}}return s?(r.log("generateDeepLinkFromLocation::href"),{deepLink:s,crash:!1,relaunch:!1,relaunchSource:void 0}):void 0}}function Po(e){return e.replace(/^\/|\/$/g,"")}function Oo(e){const{deepLink:t,crash:i,relaunch:n,source:a,clientId:s,deeplinkId:o,userContextId:r,window:c,homeCloud:l}=(0,yo.parse)(e);return{deepLink:"string"==typeof t?t:"",crash:"true"===i,relaunch:"true"===n,source:"string"==typeof a?bo.d[a]:void 0,clientId:"string"==typeof s?s:void 0,deeplinkId:"string"==typeof o?o:void 0,userContextId:"string"==typeof r?r:void 0,windowType:"string"==typeof c?c:void 0,homeCloud:"string"==typeof l?l:void 0}}function Ro(e){if(!e||0===e.length)return;const t=ko.get(e);if(t)return t;const i=e.replace(wo,"");if(0===i.length)return;const n=i.split("/");try{let t;if(n){let e=n.length-1;for(;e>=0;){const t=n[e].toLowerCase();if(pe.py[t]&&(!pe.uk[t]||e!==n.length-1))break;e--}e>=0&&(t=function(e){let t;switch(e.length){case To:t={type:No(e[jo]),id:e[Co],action:No(e[_o])};break;case _o:{const i=e[Co].toLowerCase();t=pe.uk[i]?{type:No(e[jo]),action:No(e[Co])}:{type:No(e[jo]),id:e[Co],action:pe.uk.view};break}default:throw new Error("Invalid entity fragment format found. Valid type, id or action is required.")}return t}(n.splice(e)))}return ko.size<=So&&t&&ko.set(e,t),t}catch(e){throw new Error(`Unable to parse path into proper command. ${e.message}`)}}var Lo=i(838440);const Uo=new Set([xe.pyR.chats,xe.pyR.channels]),$o="active_windows_history",Wo="ActiveWindowsHistoryService:: ";class Bo{constructor(e,t,i,n,a,s,o,r,c){this._client=t,this._experienceChangeReportingService=i,this._localStorage=n,this._rebootService=a,this._scenarioFactory=s,this._userContextId=o,this._windowProvider=r,this._activeWindowsService=c,this.cleanup=e=>{switch(e){case"quit":case"restart":this.unsubscribe();break;default:this.unsubscribe(),this.clearCache()}},this.unsubscribe=()=>{var e,t;null===(e=this._activeWindowsSubscription)||void 0===e||e.unsubscribe(),null===(t=this._windowOptionsSubscription)||void 0===t||t.unsubscribe()},this._logger=e.newLogger("ActiveWindowsHistoryService","core-services-active-windows-history"),this._logger.log(`${Wo}constructed`)}initialize(){const e=this.cleanup;this._rebootService.registerCleanupCallback(e);const{crash:t,relaunch:i}=Oo(this._windowProvider.location.hash);this._logger.log(`${Wo}crash: ${t} or relaunch: ${i}`),this.restoreWindows(t||i)&&this.subscribeWindows()}restoreWindows(e){if(!e)return this.clearCache(),!0;const t=this._scenarioFactory.newScenario(z.RG.ActiveWindowsHistoryRestore),i=e=>{this.cleanup();const i={reason:e};t.fail(i)};let n;if(n=this._activeWindowsService.enableDecoupleCommandingFromApollo?this._activeWindowsService.getActiveWindows():(0,Lo.F$)(this._client),!n)return i("Failed to read activeWindows from Apollo."),!1;const a=this.filterWindows(n),s=this.readCache();if(!s)return i("Failed to read from localStorage."),!1;const o=s.filter((e=>!a.find((t=>t.activeEntities.mainEntity.id===e.activeEntities.mainEntity.id))));if(o.length)if(o.forEach((e=>{e.activeEntities.entityExtension=null})),this._activeWindowsService.enableDecoupleCommandingFromApollo)this._activeWindowsService.setActiveWindows(n.concat(o));else if(!(0,Lo.bF)(this._client,n.concat(o)))return i("Failed to write activeWindows to Apollo."),!1;return a.length&&!this.persistCache(a.concat(o))?(i("Failed to write to localStorage."),!1):(t.stop(),!0)}persistActiveWindowsInCache(e){var t,i;const n=this.filterWindows(e);this.persistCache(n)||(this.cleanup(),null===(i=(t=this._logger).errorToTelemetry)||void 0===i||i.call(t,`Failed to write ${n.length} windows to localStorage.`,"webclient_framework_foundation_core_services_active_windows_history",void 0,!0))}subscribeWindows(){this._activeWindowsService.enableDecoupleCommandingFromApollo?this._activeWindowsSubscription=this._activeWindowsService.getActiveWindowsObservable().subscribe((e=>{this.persistActiveWindowsInCache(e)})):this._activeWindowsSubscription=(0,Lo.OB)(this._client).subscribe((({errors:e,loading:t,data:i})=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var n,a;if(t)return;if(e)return void(null===(a=(n=this._logger).errorToTelemetry)||void 0===a||a.call(n,`subscribeWindows::watchActiveWindows::${(0,U.u4)(e)}`,"webclient_framework_foundation_core_services_active_windows_history",void 0,!0));const{activeWindows:s=[]}=i;this.persistActiveWindowsInCache(s)})))),this._windowOptionsSubscription=this._experienceChangeReportingService.observeChanges().subscribe((e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){if(e.type!==Mt.FV.WindowOptionsChange||!e.windowId||this._userContextId&&e.userContextId!==this._userContextId)return;const t=e=>{var t,i;this.cleanup(),null===(i=(t=this._logger).errorToTelemetry)||void 0===i||i.call(t,e,"webclient_framework_foundation_core_services_active_windows_history",void 0,!0)},i=this.readCache();if(!i)return void t("subscribeWindows::windowOptions::Failed to read from localStorage.");const n=i.find((t=>t.id===e.windowId));if(!n)return;const{height:a,left:s,top:o,width:r}=e.context;n.windowOptions={__typename:"WindowOptions",height:a,left:s,top:o,width:r},this.persistCache(i)||t(`subscribeWindows::windowOptions::Failed to write ${i.length} windows to localStorage.`)}))))}filterWindows(e){return e.filter((e=>((e,t)=>e.layoutConfig.layoutMode===xe.lOW.focus&&!e.isMainWindow&&(!t||t===e.userContextId)&&Uo.has(e.activeEntities.mainEntity.type))(e,this._userContextId)))}clearCache(){this._logger.log("ClearCache::ACTIVE_WINDOWS_HISTORY_STORAGE_KEY"),this._localStorage.remove($o,"UserAndExperience")}persistCache(e){return this._logger.debug(`Persist ${e.length} windows to cache.`),this._localStorage.setSafe($o,JSON.stringify(e),"UserAndExperience")}readCache(){try{const e=JSON.parse(this._localStorage.get($o,"UserAndExperience")||"[]");return this._logger.debug(`Read ${e.length} windows from cache.`),e}catch(e){return}}}var zo=i(466094);class Ho extends Ue{constructor(){super(h.Yg.CreateActiveWindowsHistoryTask,["activeWindowsService","authenticationUser","client","coreSettings","experienceChangeReportingService","localStorage","loggerFactory","rebootService","scenarioFactory","windowProvider"]),this.isAuthenticatedUser=e=>(null==e?void 0:e.role)===zo.w4.Member||(null==e?void 0:e.role)===zo.w4.Guest}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:i}=e,n=null==i?void 0:i.get(S.J.Core);if(!(null==n?void 0:n.enableActiveWindowsHistoryRecovery)||!this.isAuthenticatedUser(t))return;const{activeWindowsService:a,client:s,experienceChangeReportingService:o,localStorage:r,loggerFactory:c,rebootService:l,scenarioFactory:d,windowProvider:u}=e,m=(0,He.b4)(t);e.activeWindowsHistoryService=new Bo(c,s,o,r,l,d,m,u,a)}))}}var qo=i(168616);const Vo={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"CoreServicesAppbarUpdateApplicationInUseFragment_applicationIsInUse"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"M365Application"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isInUse"}}]}}]},Go={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CoreServicesAppbarUpdateApplicationInUseQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"m365Apps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"CoreServicesAppbarUpdateApplicationInUseFragment_applicationsWithInUseStatus"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"CoreServicesAppbarUpdateApplicationInUseFragment_applicationsWithInUseStatus"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"M365ApplicationConnection"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"CoreServicesAppbarUpdateApplicationInUseFragment_applicationIsInUse"}}]}}]}}]}},...Vo.definitions]}.definitions]};function Jo(e,t,i,n){e.writeFragment({id:`${i}:${t}`,fragment:Vo,data:{__typename:i,id:t,isInUse:n}})}class Ko{constructor(e,t,i,n){this._experienceChangeReportingService=e,this._userContextId=t,this._client=i,this._logger=n,this._appBarObservable=this._experienceChangeReportingService.observeChanges().pipe((0,u.h)((e=>e.userContextId===this._userContextId&&e.type===Mt.yU.AppSelectionChanged&&e.context.appId!==this._currentValue)),(0,l.U)((e=>{this._previousValue=this._currentValue;const t=e;return this._currentValue=t.context.appId,this._client.viewSchemaClient?function(e,t,i){try{const t=e.readQuery({query:Go});if(t){let n,a;for(const[,e]of(0,B.entries)(t))if(n||(n=e.edges.find((e=>e.node.isInUse))),a||(a=e.edges.find((e=>e.node.id===i))),n&&a)break;if((null==n?void 0:n.node.id)===(null==a?void 0:a.node.id))return;n&&Jo(e,n.node.id,n.node.__typename,!1),a&&Jo(e,a.node.id,a.node.__typename,!0)}}catch(e){t.error("Error thrown updating Nova AppBar selection.")}}(this._client.viewSchemaClient,this._logger,this._currentValue):this._logger.error("Viewclient store isn't available for updating  AppBar selection."),{previousApplicationSelection:this._previousValue,newApplicationSelection:this._currentValue}}))).pipe((0,qo.B)()),this._appBarSubscription=this._appBarObservable.subscribe()}cleanup(){var e;null===(e=this._appBarSubscription)||void 0===e||e.unsubscribe()}observe(){return this._appBarObservable}current(){return this._currentValue}}class Qo extends Ue{constructor(){super(h.Yg.CreateAppBarServiceTask,["client","authenticationUser","experienceChangeReportingService","loggerFactory"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,experienceChangeReportingService:i,client:n,loggerFactory:a}=e,s=a.newLogger("AppBarService","core-services-tasks"),o=new Ko(i,(0,He.b4)(t),n,s);return e.appBarService=o,()=>{o.cleanup()}}))}}var Yo=i(961614);function Xo(e){switch(e){case h.eT.InCall:case h.eT.InBroadcast:case h.eT.Presenting:return $e.pk.VeryActive;case h.eT.Interactive:return $e.pk.Active;case h.eT.Inactive:return $e.pk.Inactive;case h.eT.LongInactive:return $e.pk.LongInactive;case h.eT.Disabled:return $e.pk.Unrecoverable;default:return}}var Zo,er=i(706007);class tr{constructor(e,t,i,n,a){this._host=t,this.timesToSendUntilIdle=2,this._logger=i.newLogger("ClientStateSender","core-services-client-state");const{appIdleTimeoutInMs:s}=n.get(S.J.Core);this.msUntilResend=s?Math.round(s/this.timesToSendUntilIdle):a,this._subscriptionToStateChange=e.pipe((0,er.x)()).subscribe((e=>this.handleStateChange(e))),this._logger.log("Initialized")}dispose(){this.stopRecurringSending(),this._subscriptionToStateChange.unsubscribe()}handleStateChange(e){try{e===$e.pk.Active||e===$e.pk.VeryActive?this.sendStateRecurringly(e):(this.stopRecurringSending(),this.sendState(e))}catch(t){this._logger.error(`Failed to send client state update: ClientState=${e}, Error: ${t}`)}}sendStateRecurringly(e){this._logger.log(`Starting recurring sending of client state: ${e}`);try{this.sendStateAndStartTimer(e)}catch(t){this._logger.error(`Failed to start recurring sending of client state: ClientState=${e}, Error: ${t}`)}}stopRecurringSending(){this.stopTimer(),this._logger.log("Stopped recurring client state sending")}stopTimer(){if(void 0!==this._recurringSendCountdownTimer)try{this._host.clearInterval(this._recurringSendCountdownTimer),this._recurringSendCountdownTimer=void 0}catch(e){this._logger.error(`Failed to stop sending of client state: ${e}`)}}sendStateAndStartTimer(e){this.sendState(e),this.stopTimer(),this._recurringSendCountdownTimer=this._host.setInterval((()=>this.sendState(e)),this.msUntilResend)}sendState(e){const t=function(e){switch(e){case $e.pk.Unrecoverable:return h.eT.Disabled;case $e.pk.Inactive:return h.eT.Inactive;case $e.pk.LongInactive:return h.eT.LongInactive;case $e.pk.VeryActive:return h.eT.InCall;default:return h.eT.Interactive}}(e);this._logger.log(`Sending state to main window: ${t} (ClientState=${e})`),this._host.opener.postMessage(L.rY.UpdateWindowState,{childSettings:{appState:t}})}}class ir{constructor(e,t,i,n){this._coreClientStateObservable=e,this._idleTracker=i,this._initialClientState=n,this._coreClientStateSubscription=null,this._logger=t.newLogger("ChildClientStateProvider","core-services-client-state"),this._logger.log(`Initializing clientState with state=${this._initialClientState}`),this._childClientStateBehaviorSubject=new s.X(this._initialClientState),this._coreClientStateSubscription=this._coreClientStateObservable.subscribe((e=>{e!==this.getState()&&(this._logger.log(`Client state is ${e}.`),this._childClientStateBehaviorSubject.next(e))})),this._logger.log("Initialized")}observe(){return this._childClientStateBehaviorSubject.asObservable()}getState(){return this._childClientStateBehaviorSubject.value}getChildWindowStateProvider(e,t,i){const n=this._idleTracker.createChildWindowIdleTracker(e,t,i);return new ir(this._coreClientStateObservable,t,n,this.getState())}dispose(){var e;this._idleTracker.dispose(),null===(e=this._coreClientStateSubscription)||void 0===e||e.unsubscribe(),this._childClientStateBehaviorSubject.complete()}}class nr{constructor(e,t,i,n,a,o){this._host=e,this._idleTracker=i,this._defaultClientState=$e.pk.Active,this._initializing=!0,this._clientStateSubscription=null,this._idleTrackerStateSubscription=null,this.handleAppStateSyncMessage=e=>{var t;const i=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.appState;void 0!==i&&(this._logger.log(`Handling pushed host appState update change to ${i}.`),this.handleMainWindowStateChange(i))},this._logger=t.newLogger("ClientStateProvider","core-services-client-state");let r=this._defaultClientState;if(void 0!==o){const e=Xo(o);void 0!==e&&(r=e)}this._logger.log(`Initializing clientState with state=${r}`),this._clientStateBehaviorSubject=new s.X(r),this._setupEventHandlers(t,n,a),this.restartIdleTimerWhenActiveState(),this._initializing=!1,this._logger.log("Initialized")}observe(){return this._clientStateBehaviorSubject.asObservable()}getState(){return this._clientStateBehaviorSubject.value}getChildWindowStateProvider(e,t,i){const n=this._idleTracker.createChildWindowIdleTracker(e,t,i);return new ir(this.observe(),t,n,this.getState())}dispose(){var e,t;this._host.opener.removeEventListener(L.rY.AppStateSyncMessage,this.handleAppStateSyncMessage),this._idleTracker.dispose(),this._stateSender&&this._stateSender.dispose(),this._clientStateBehaviorSubject.complete(),null===(e=this._clientStateSubscription)||void 0===e||e.unsubscribe(),null===(t=this._idleTrackerStateSubscription)||void 0===t||t.unsubscribe()}startVeryActive(e){this._logger.log(`startVeryActive(): Client state is set to very active by ${e}.`),this.setClientState($e.pk.VeryActive)}stopVeryActive(e){this._logger.log(`stopVeryActive(): Client state is set to active by ${e}.`),this.setClientState($e.pk.Active)}_setupEventHandlers(e,t,i){var n;this._clientStateSubscription=this.observe().subscribe((e=>{this._logger.log(`Client state is ${e}.`)})),this._host.opener.addEventListener(L.rY.AppStateSyncMessage,this.handleAppStateSyncMessage),this._idleTrackerStateSubscription=this._idleTracker.observe().subscribe((e=>this.handleIdleChange(e))),i&&t&&(null===(n=t.get(S.J.Core))||void 0===n?void 0:n.enableUpdateAngularOnClientStateChange)&&(this._stateSender=new tr(this.observe(),this._host,e,t,Yo.u.MsUntilIdleDefault))}handleIdleChange(e){this._logger.log(`Handling idleness change to ${e}.`),this._clientStateBehaviorSubject.value!==$e.pk.VeryActive&&(this._initializing||this.setClientState(function(e){switch(e){case Yo.R.Inactive:return $e.pk.Inactive;case Yo.R.LongInactive:return $e.pk.LongInactive;default:return $e.pk.Active}}(e),!1))}setClientState(e,t=!0){e!==$e.pk.Active&&e!==$e.pk.VeryActive||!t||this._idleTracker.restartIdleTimer(),e===$e.pk.Inactive&&this._clientStateBehaviorSubject.value===$e.pk.LongInactive||this._clientStateBehaviorSubject.value!==e&&(this._logger.log(`Updating client state from=${this._clientStateBehaviorSubject.value} to=${e}.`),this._clientStateBehaviorSubject.next(e))}handleMainWindowStateChange(e){const t=Xo(e);t!==$e.pk.Active&&t!==$e.pk.VeryActive||this.setClientState(t)}restartIdleTimerWhenActiveState(){this.getState()!==$e.pk.Active&&this.getState()!==$e.pk.VeryActive||this._idleTracker.restartIdleTimer()}}!function(e){e.Initializing="Initializing",e.Unrecoverable="Unrecoverable",e.LongInactive="LongInactive",e.Inactive="Inactive",e.Active="Active",e.VeryActive="VeryActive"}(Zo||(Zo={}));class ar{constructor(e=h.eT.Interactive){this._appState$=new s.X(e);(0,R.J)().opener.addEventListener(L.rY.AppStateSyncMessage,(e=>{var t;const i=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.appState;this.setAppState(i)}))}observe(){return this._appState$.asObservable().pipe((0,er.x)())}getState(){return this._appState$.value}setAppState(e){void 0!==e&&e!==this.getState()&&this._appState$.next(e)}}const sr="HostComms:: ";var or,rr;!function(e){e.LoadModuleCoreFailed="LoadModuleCoreFailed",e.LoadModuleOsUtilsFailed="LoadModuleOsUtilsFailed",e.LoadModuleScenarioFailed="LoadModuleScenarioFailed",e.LoadModuleTelemetryFailed="LoadModuleTelemetryFailed",e.LoadModuleWebClientStatesFailed="LoadModuleWebClientStatesFailed",e.ExecuteCommandFailed="ExecuteCommandFailed",e.RegisterForAppStateChangedFailed="RegisterForAppStateChangedFailed",e.ReportReadyToQuitFailed="ReportReadyToQuitFailed"}(or||(or={})),function(e){e.LoadModuleCoreSuccess="LoadModuleCoreSuccess",e.ExecuteCommandSuccess="ExecuteCommandSuccess"}(rr||(rr={}));var cr=i(665380);class lr{constructor(e,t,i){this.handleMachineLockUpdate=e=>{var t;const i=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.isMachineLocked;void 0!==i&&(this._logger.log(`Handling pushed machineLock update change: isMachineLocked = ${i}.`),this.updateMachineLockState(i))},this._logger=t.newLogger("HostStateProvider","core-sercices-host-state"),this._hostStateSubject=new s.X({windowState:$e.kZ.InFocus,machineLockState:$e.UV.Active,suspendedState:$e.V9.Initialized}),this.registerForStateChanges(e,i)}observe(){return this._hostStateSubject.asObservable()}getState(){return Object.assign({},this._hostStateSubject.value)}dispose(){var e;null===(e=this._machineStateChangedSubscription)||void 0===e||e.call(this)}registerForStateChanges(e,t){e.opener.addEventListener(L.rY.AppStateSyncMessage,this.handleMachineLockUpdate),t.loadModule("osutils").then((e=>{var t;this._machineStateChangedSubscription=null===(t=null==e?void 0:e.registerForSessionStateChanged)||void 0===t?void 0:t.call(e,(e=>{this._logger.log(`Handling pushed machineLock update change: machine SessionStatus= ${e.status}.`),e.status===cr.$y.Suspending||e.status===cr.$y.Resumed?this.updateSuspendedState(e.status===cr.$y.Suspending):this.updateMachineLockState(e.status===cr.$y.Locked)}))})).catch((()=>{var e,t;null===(t=(e=this._logger).errorToTelemetry)||void 0===t||t.call(e,'Error happened while loading "osutils"',"webclient_framework_host_comms",void 0,!0)}))}updateMachineLockState(e){const t=e?$e.UV.Locked:$e.UV.Active,i=this.getState().machineLockState;if(t!==i){this._logger.log(`Updating machine lock state from=${i} to=${t}.`);const e=this.getState();e.machineLockState=t,this._hostStateSubject.next(e)}}updateSuspendedState(e){const t=e?$e.V9.Suspending:$e.V9.Resumed,i=this.getState().suspendedState;if(t!==i){this._logger.log(`Updating machine suspended state from=${i} to=${t}.`);const e=this.getState();e.suspendedState=t,this._hostStateSubject.next(e)}}}var dr=i(109062);class ur{constructor(e,t,i){this.scenarioFactory=i,this.observe=()=>this.networkStateBehaviorSubject.asObservable(),this.getState=()=>this.networkStateBehaviorSubject.getValue(),this.observeIsOnline=()=>this.isOnlineObservable,this.isOnline=()=>this.convertToIsOnline(this.getState()),this.observeDetailedNetworkState=()=>this.detailedNetworkStateBehaviorSubject.asObservable(),this.convertToIsOnline=e=>e===dr.G.Online,this.getDetailedState=()=>this.detailedNetworkStateBehaviorSubject.getValue(),this.logger=e.newLogger(t,"core-services-network-state");const n=dr.G.Online,a=dr.T.Unknown;this.networkStateBehaviorSubject=new s.X(n),this.isOnlineObservable=this.networkStateBehaviorSubject.asObservable().pipe((0,l.U)((e=>this.convertToIsOnline(e))),(0,er.x)()),this.logger.log(`Network state is initialized as ${dr.G[n]}`),this.sendStateChangeTelemetry(n),this.detailedNetworkStateBehaviorSubject=new s.X(a)}dispose(){this.networkStateBehaviorSubject.complete(),this.detailedNetworkStateBehaviorSubject.complete(),this.previousNetworkStateChangeTime=void 0}setNetworkState(e,t){this.logger.log(`Set network state to ${dr.G[e]}${t?` due to ${t}`:""}`),this.setDetailedNetworkState(this.convertToIsOnline(e)?dr.T.Online:dr.T.Offline),this.getState()!==e&&(this.networkStateBehaviorSubject.next(e),this.logger.log(`Network is ${dr.G[e]}`),this.sendStateChangeTelemetry(e,t))}setDetailedNetworkState(e){this.getDetailedState()!==e&&this.detailedNetworkStateBehaviorSubject.next(e)}sendStateChangeTelemetry(e,t){if(!this.scenarioFactory)return;let i=-1;const n=(new Date).getTime();if(this.previousNetworkStateChangeTime&&(i=n-this.previousNetworkStateChangeTime),this.previousNetworkStateChangeTime=n,-1===i)return;const a=e===dr.G.Online?z.RG.NetworkOnline:z.RG.NetworkOffline;this.scenarioFactory.newScenario(a).stop({offsetCurrentTimeInMs:i,reason:t})}}class mr{constructor(e){this.logger=e,this.subscriptions=[],this.currentState=void 0}getLastState(){return this.currentState}subscribeToStateChange(e){const t=this;t.subscriptions.push(e);return()=>{const i=t.subscriptions.indexOf(e);i>=0&&t.subscriptions.splice(i,1)}}cleanUpSubscriptions(){this.subscriptions=[],this.currentState=void 0}notifyAboutStateChange(e){this.currentState=e,this.subscriptions.forEach((t=>t(e)))}doOverrideOfLastState(e){this.currentState=e}}class gr extends mr{constructor(e,t,i){super(e),this.label=t,this.onOverrideLastState=i,this.handleNetworkStateNotification=e=>{this.logger.debug(`${this.label} received ${dr.G[e]}`),this.getLastState()!==e&&(this.logger.log(`${this.label} network state is ${dr.G[e]}`),this.notifyAboutStateChange(e))}}overrideLastState(e){const t=this.getLastState();this.logger.debug(`NetworkStateTracker state is overriden from ${void 0===t?"undefined":dr.G[t]} to ${dr.G[e]}`),this.doOverrideOfLastState(e),this.onOverrideLastState(e)}cleanUpSubscriptions(){super.cleanUpSubscriptions()}}class hr extends mr{constructor(e,t){super(e),this.handleNetworkStateNotification=e=>{const t=e?dr.G.Online:dr.G.Offline;this.logger.debug("Endpoints network state is "+(e?"online":"offline")),this.getLastState()!==t&&(this.logger.log("Endpoints network state is "+(e?"online":"offline")),this.notifyAboutStateChange(t))};const i={next:this.handleNetworkStateNotification,complete:()=>{var e;return null===(e=this.subscription)||void 0===e?void 0:e.unsubscribe()}};this.subscription=t.observeIsOnline().subscribe(i)}overrideLastState(e){const t=this.getLastState();this.logger.debug(`EndpointsNetworkStateListener state is overriden from ${void 0===t?"undefined":dr.G[t]} to ${dr.G[e]}`),this.doOverrideOfLastState(e)}cleanUpSubscriptions(){var e;super.cleanUpSubscriptions(),this.subscription&&!this.subscription.closed&&(null===(e=this.subscription)||void 0===e||e.unsubscribe()),this.subscription=void 0}}var pr=i(974509),vr=i(500254);class fr extends mr{constructor(e){super(e),this.failed_to_fetch_subContext="rejectHttpError",this.processResponse=e=>{void 0!==e.status&&e.status!==pr.qb.NOT_MODIFIED&&e.status!==pr.qb.GATEWAY_TIMEOUT&&this.handleNetworkStateNotification(dr.G.Online)},this.processResponseError=e=>{e&&(e.serverResponse?this.handleNetworkStateNotification(dr.G.Online):e.context===h.w5.RejectHttpError&&e.code===h.jK.RemoteOperationFailed&&e.subContext===this.failed_to_fetch_subContext?this.handleNetworkStateNotification(dr.G.Offline):this.logger.log(`Not network related error: ${e.message||e}`))},this.handleNetworkStateNotification=e=>{this.logger.debug(`Send network state is ${dr.G[e]}`),this.getLastState()!==e&&(this.logger.log(`Send network state listener is ${dr.G[e]}`),this.notifyAboutStateChange(e))},this.unsubscribeFromSendTracking=(0,vr.z)(this.processResponse,this.processResponseError)}overrideLastState(e){const t=this.getLastState();this.logger.debug(`Send state listener's state is overriden from ${void 0===t?"undefined":dr.G[t]} to ${dr.G[e]}`),this.doOverrideOfLastState(e)}cleanUpSubscriptions(){super.cleanUpSubscriptions(),this.unsubscribeFromSendTracking&&this.unsubscribeFromSendTracking(),this.unsubscribeFromSendTracking=void 0}}var br=i(8122);const yr=(e,t)=>Promise.resolve({apiName:t,constructRequest:(i,n)=>{const a=e();return a.searchParams.set("cb",Date.now().toString()),{apiName:t,url:a.href,method:"HEAD",timeout:1e4,headers:{"cache-control":"no-store"},cancellationToken:i.token,correlationId:n}},transformResponse:e=>e.status===pr.qb.GATEWAY_TIMEOUT?Promise.reject("GATEWAY_TIMEOUT"):Promise.resolve()}),kr=e=>{const{coreSettings:t,platformService:i}=e;return{serviceName:br.E.NetworkPing,models:{getNetworkStatus:yr((()=>new URL(t.get(S.J.Core).networkPingUrl||"/diagnostics/network",i.config.currentUrl)),"networkPing"),getNetworkStatusFallback:yr((()=>new URL(t.get(S.J.Core).networkPingFallbackPingUrl||"/evergreen-assets/icons/1x1-000000ff.png",i.config.staticsPath)),"networkFallbackPing")}}};var Sr=i(223005),wr=i(145279);function jr(e,t,i,n=Sr.A.TimedOut){let a;const s=new Promise((e=>{a=t.setTimeout(e,i)}));return Promise.race([e,s.then((()=>{throw(0,wr.T)(n)}))]).then((e=>(t.clearTimeout(a),e)))}function Cr(e,t){return new Promise(((i,n)=>{if(e<0)n((0,wr.T)(Sr.A.InvalidParameters));else{let n=0;n=t.setTimeout((()=>{t.clearTimeout(n),i()}),e)}}))}const _r=[5e3,1e4,3e4],Tr="cancelled_ping";class Ir{constructor(e,t,i,a,s){this.coreSettings=e,this.endpointsManager=t,this.scenarioFactory=i,this.host=a,this.ping=e=>{const t=this.coreSettings.get(S.J.Core).networkPingDisableFallback||!1,i=this.scenarioFactory.newScenario(z.RG.NetworkPing);i.appendEventData({correlationId:e});let n=this.endpointsManager.createCancelToken(),a=!1;const s=()=>a;return{promise:this.pingEndpoint("initial ping",(()=>this.endpoints.getNetworkStatus(n,e)),i,!t,s).then((a=>a||t?Promise.resolve(a):(n=this.endpointsManager.createCancelToken(),this.pingEndpoint("fallback ping",(()=>this.endpoints.getNetworkStatusFallback(n,e)),i,!1,s)))),cancel:()=>(n.cancel(),void(a=!0))}},this.pingEndpoint=(e,t,i,a,s)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){i.appendEventData({operation:e});try{return yield t(),s()?this.markPingScenarioCancelled(e,i):this.markPingScenarioSuccess(e,i)}catch(t){return s()?this.markPingScenarioCancelled(e,i):(null==t?void 0:t.serverResponse)?this.markPingScenarioSuccess(e,i):((null==t?void 0:t.reason)===Sr.A.TimedOut?this.logger.log(`${e} timed out`):this.logger.log(`${e} failed`),!a&&this.markPingScenarioFailed(e,t,i))}})),this.getRetryIntervals=()=>{const e=this.coreSettings.get(S.J.Core).networkPingRetryIntervals||_r;return Object.assign([],e)},this.updatePingResult=e=>{this.latestPingResult={isOnline:e,timestamp:Date.now()}},this.logger=s.newLogger("NetworkPingService","core-services-network-state"),this.endpoints=t.createApi(kr),this.logger.log("Initialized")}detectCurrentNetworkStatus(e){const t=this.coreSettings.get(S.J.Core).networkPingDebounceDelay||3e4;return!(this.coreSettings.get(S.J.Core).networkPingDisableDebounce||!1)&&this.latestPingResult&&this.latestPingResult.isOnline&&this.latestPingResult.timestamp&&Date.now()-this.latestPingResult.timestamp<t?(this.logger.log(`Skipping network detection as last online check succeeded less than ${t}ms ago.`),{promise:Promise.resolve(!0),cancel:()=>{}}):(this.logger.log("doing network ping"),this.ping(e))}whenNetworkOnline(e){if(this.whenNetworkOnlinePromise)return this.whenNetworkOnlinePromise;const t=this.getRetryIntervals();let i=!1;const a=()=>{this.whenNetworkOnlinePromise=void 0,i=!0};let s;const o=new Promise(((o,r)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){let n;s=()=>{null==n||n(),a(),r(Tr)};let c=t[0];for(let a=0;!i;a++){const{promise:s,cancel:o}=this.ping(e);n=()=>{null==o||o(),n=()=>{}};try{const e=yield s;if(n=()=>{},e||i)break;a<t.length&&(c=t[a]),yield Cr(c,this.host)}catch(e){this.logger.log("whenNetworkOnline ping rejected")}}a(),o()}))));return this.whenNetworkOnlinePromise={promise:o,cancel:()=>null==s?void 0:s()},this.whenNetworkOnlinePromise}markPingScenarioSuccess(e,t){return t.stop({message:`${e} successful!`},"success"),this.logger.log(`${e} successful!`),this.updatePingResult(!0),!0}markPingScenarioFailed(e,t,i){var n;const a=(null==t?void 0:t.reason)?t.reason:"undefined",s=null===(n=null==t?void 0:t.serverResponse)||void 0===n?void 0:n.status;return i.fail({errors:`${e} failed. error reason: ${a}. Response status: ${s}`}),this.updatePingResult(!1),!1}markPingScenarioCancelled(e,t){return t.stop({message:`${e} cancelled`},"abandoned"),this.logger.log(`${e} cancelled`),this.updatePingResult(!0),Promise.reject(Tr)}}class Nr extends ur{constructor(e,t,i,n,a,s,o,r){var c,l;super(e,"NetworkStateProvider",i),this.loggerFactory=e,this.coreSettings=t,this.host=n,this.clientStateProvider=a,this._defaultNetworkOnlineDetectionTimeoutInMs=15e3,this.coreContextID="",this._contextListeners=new Map,this._skipNetworkDetectionDelay=!0,this.authStateSubscriptions=[],this.createNetworkStateTracker=(e,t,i)=>{const n=new gr(this.logger,t,i),a={next:n.handleNetworkStateNotification,dispose:n.cleanUpSubscriptions};return this._addToContextListeners(e,n),n.subscribeToStateChange((e=>this._handleNetworkStateUpdate(e,`${t} network state is ${dr.G[e]}`))),a},this._handleNetworkStateUpdate=(e,t)=>{if(this.logger.debug(`Update network to ${dr.G[e]} due to ${t}`),e===dr.G.Offline){if(this.getState()===dr.G.Offline)return;this._suspectOffline()}else this._cancelNetworkOnlineDetection(t),this.getState()!==e?this.setNetworkState(e,t):(this.setDetailedNetworkState(dr.T.Online),this._updateAllListenersTo(dr.G.Online));this._skipNetworkDetectionDelay&&(this._skipNetworkDetectionDelay=!1)},this._handleWindowOnline=()=>{this.logger.log("browser network online"),this.isOnline()||(this._updateAllListenersTo(dr.G.Offline),this._kickOffNetworkOnlineDetection(dr.G.Online))},this._handleWindowOffline=()=>{if(this.logger.log("browser network offline"),this.coreSettings.get(S.J.Core).disableWindowEventsNetworkDetectionV2){if(this.getState()===dr.G.Offline)return;this.setNetworkState(dr.G.Offline,"browser offline"),this._updateAllListenersTo(dr.G.Offline),this._kickOffNetworkOnlineDetection(dr.G.Offline)}else this._suspectOffline()};try{this._networkPingService=new Ir(this.coreSettings,s,i,this.host,this.loggerFactory)}catch(e){null===(l=(c=this.logger).errorNoPii)||void 0===l||l.call(c,"NetworkPingService initialization has failed")}this._subscribeToSendNetworkState(),this.subscribeToEndpointsNetworkStateTracking(this.coreContextID,s.networkState),this._subscribeToWindowNetworkEvents(),this._subscribeToSuspendedStateResumeEvent(o),this.subscribeAuthStateEvent(r)}dispose(){var e;super.dispose(),this._cancelNetworkOnlineDetection("dispose"),this.disposeAllContexts(),this._unsubscribeFromWindowNetworkEvents(),null===(e=this.suspendedStateSubscription)||void 0===e||e.unsubscribe(),this.suspendedStateSubscription=void 0,this.authStateSubscriptions.forEach((e=>e.unsubscribe())),this.authStateSubscriptions=[]}disposeContext(e){const t=this._contextListeners.get(e);t&&(t.forEach((e=>{e.cleanUpSubscriptions()})),this._contextListeners.delete(e))}subscribeToEndpointsNetworkStateTracking(e,t){const i=new hr(this.logger,t);return this._addToContextListeners(e,i),i.subscribeToStateChange((e=>this._handleNetworkStateUpdate(e,`Endpoints network state is ${dr.G[e]}`)))}subscribeAuthStateEvent(e){if(this.coreSettings.get(S.J.Core).disableNetworkDetectionOnResume)return;const t=null==e?void 0:e.observe();t&&this.authStateSubscriptions.push(t.subscribe((e=>{var t;switch(null===(t=e.customError)||void 0===t?void 0:t.errorCode){case"NoNetwork":case"NetworkOffline":case"NetworkTemporarilyUnavailable":this._skipNetworkDetectionDelay=!0,this._handleNetworkStateUpdate(dr.G.Offline,"auth state network related error")}})))}setNetworkState(e,t){super.setNetworkState(e,t),this._updateAllListenersTo(e)}_subscribeToSendNetworkState(){const e=new fr(this.logger);this._addToContextListeners(this.coreContextID,e),e.subscribeToStateChange((e=>this._handleNetworkStateUpdate(e,`Send network state is ${dr.G[e]}`)))}_subscribeToWindowNetworkEvents(){this.host.addEventListener("online",this._handleWindowOnline),this.host.addEventListener("offline",this._handleWindowOffline),this.host.navigator&&(this.host.navigator.onLine?this._handleWindowOnline():this._handleWindowOffline())}_unsubscribeFromWindowNetworkEvents(){this.host.removeEventListener("online",this._handleWindowOnline),this.host.removeEventListener("offline",this._handleWindowOffline)}_subscribeToSuspendedStateResumeEvent(e){if(!e||this.coreSettings.get(S.J.Core).disableNetworkDetectionOnResume)return;const t=null==e?void 0:e.observe().pipe((0,l.U)((e=>e.suspendedState)),(0,er.x)());this.suspendedStateSubscription=null==t?void 0:t.subscribe((e=>{e===$e.V9.Resumed&&(this._skipNetworkDetectionDelay=!0,this._handleNetworkStateUpdate(dr.G.Offline,"resumed from suspended"))}))}_updateAllListenersTo(e){this._contextListeners.forEach((t=>t.forEach((t=>{var i;return null===(i=t.overrideLastState)||void 0===i?void 0:i.call(t,e)}))))}_addToContextListeners(e,t){var i;this._contextListeners.has(e)?null===(i=this._contextListeners.get(e))||void 0===i||i.push(t):this._contextListeners.set(e,[t])}_suspectOffline(){const{enableSkipNetworkDetectionTimeoutOnOfflineStart:e,useVeryActiveForNetworkOnlineDetection:t,enableNetworkOnlineDetectionTimeout:i,networkOnlineDetectionTimeoutInMs:n}=this.coreSettings.get(S.J.Core);if(t&&this.clientStateProvider.getState()===$e.pk.VeryActive)return this.logger.log("Network detection cancelled due to VeryActive client state."),this._updateAllListenersTo(dr.G.Online),void this.setDetailedNetworkState(dr.T.Online);const a=this._skipNetworkDetectionDelay&&!!e;if(!(this._networkDetectionTimeout&&!a||this._detectCurrentNetworkStatusPromise||this._networkPing))if(this._updateAllListenersTo(dr.G.Offline),this.setDetailedNetworkState(dr.T.SuspectedOffline),i&&!a){const e=n||this._defaultNetworkOnlineDetectionTimeoutInMs;void 0!==this._networkDetectionTimeout||this._detectCurrentNetworkStatusPromise||(this.logger.log(`Starting ${e}ms timeout before kicking off network online detection.`),this._networkDetectionTimeout=this.host.setTimeout((()=>{this._networkDetectionTimeout=void 0,this.logger.log("Timeout expired."),this._kickOffNetworkOnlineDetection(dr.G.Offline)}),e))}else this._kickOffNetworkOnlineDetection(dr.G.Offline)}_kickOffNetworkOnlineDetection(e){if(!this._networkPingService||!this._canPerformPing())return void(this.getState()!==e&&this.setNetworkState(e));if(this._detectCurrentNetworkStatusPromise||this._networkPing)return;this.logger.log("Kicking off network status detection.");const t=(0,qe.v4)(),i=this._networkPingService;this._detectCurrentNetworkStatusPromise=i.detectCurrentNetworkStatus(t),this._detectCurrentNetworkStatusPromise.promise.then((e=>{void 0!==this._detectCurrentNetworkStatusPromise?(this._detectCurrentNetworkStatusPromise=void 0,e?(this.logger.log("Network status verified as online."),this.setNetworkState(dr.G.Online,"http online")):(this.setNetworkState(dr.G.Offline,"http offline"),this._startNetworkPing(i,t))):this.logger.log("Network detection cancelled, ignoring result.")})).catch((e=>{e===Tr?this.logger.log("Network detection is cancelled"):this.logger.warn(`Network status verification error: ${e}`),this._detectCurrentNetworkStatusPromise=void 0}))}_canPerformPing(){const{enablePingService:e}=this.coreSettings.get(S.J.Core);return!!e||(this.logger.warn("Network detection is disabled."),!1)}_startNetworkPing(e,t){this.logger.log("Started recurring network ping."),this._networkPing=e.whenNetworkOnline(t),this._networkPing.promise.then((()=>{this._networkPing?(this._networkPing=void 0,this.getState()!==dr.G.Online&&this.setNetworkState(dr.G.Online,"Network ping succeded")):this.logger.log("Network ping cancelled, ignoring result.")})).catch((e=>{this.logger.log(`network detection by ping terminated due to ${(null==e?void 0:e.message)?e.message:e}`)}))}_cancelNetworkPing(e){var t,i;this._networkPing&&(this.logger.log(`Cancelling network ping due to ${e}`),null===(i=(t=this._networkPing).cancel)||void 0===i||i.call(t),this._networkPing=void 0)}_cancelNetworkOnlineDetection(e){var t,i;void 0!==this._networkDetectionTimeout&&(this.logger.log(`Cancelling network detection timeout due to ${e}`),this.host.clearTimeout(this._networkDetectionTimeout),this._networkDetectionTimeout=void 0),this._detectCurrentNetworkStatusPromise&&(this.logger.log(`Cancelling network detection due to ${e}`),null===(i=(t=this._detectCurrentNetworkStatusPromise).cancel)||void 0===i||i.call(t),this._detectCurrentNetworkStatusPromise=void 0),this._cancelNetworkPing(e)}disposeAllContexts(){this._contextListeners.forEach((e=>{e.forEach((e=>{e.cleanUpSubscriptions()}))})),this._contextListeners.clear()}}class Er extends mr{constructor(e,t){super(e),this.handleLegacyApplicationStateChange=e=>{const t=this.isOnlineAndConnectedInternal(e);this.logger.log(`LegacyApplicationState changed to ${h.eT[e]}`),this.notifyAboutStateChange(t)},this.isOnlineAndConnectedInternal=e=>{switch(e){case h.eT.Disabled:case h.eT.Offline:return dr.G.Offline;default:return dr.G.Online}},this.legacyApplicationStateSubscription=t.observe().pipe((0,er.x)()).subscribe(this.handleLegacyApplicationStateChange)}cleanUpSubscriptions(){super.cleanUpSubscriptions(),this.legacyApplicationStateSubscription&&(this.legacyApplicationStateSubscription.unsubscribe(),this.legacyApplicationStateSubscription=void 0)}}class Fr extends ur{constructor(e,t,i,a,s,o){super(t,"LegacyNetworkStateProvider",i),this.hostCommunicationService=o,this._legacyAppStateListener=void 0,this._suspectedStateListeners=[],this._handleNetworkListenerUpdate=(e,t)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){e!==this.getState()?(this.logger.debug(`Network suspected ${dr.G[e]}${t?" due to ":""}${t}`),yield this._sendSuspectedNetworkStateThrottled(this._convertToIsOnline(e))):void 0!==this._suspectedIsOnline&&this.convertToIsOnline(e)!==this._suspectedIsOnline&&this._resetSuspectedState()})),this._sendSuspectedNetworkState=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){this.logger.log(`Sending network state to main window: ${e}`);const t=yield this.hostCommunicationService.loadModule("core");(null==t?void 0:t.notifyCoreStateChanged)?t.notifyCoreStateChanged({isNetworkOnline:e}):this.logger.warn("notifyCoreStateChanged is missing in HostComms")})),this._initSuspectedThrottleFunc=()=>{this._throttledSuspectedIsOnline=(0,B.throttle)(this._sendSuspectedNetworkState,2e3)},this._convertToIsOnline=e=>e!==dr.G.Offline,this._updateSuspectedStateListenersTo=e=>this._suspectedStateListeners.forEach((t=>{var i;return null===(i=t.overrideLastState)||void 0===i?void 0:i.call(t,e)})),this._subscribeToLegacyAppStateTracking(e),this._subscribeToSuspectedNetworkState(s,a)}dispose(){var e;super.dispose(),null===(e=this._legacyAppStateListener)||void 0===e||e.cleanUpSubscriptions(),this._legacyAppStateListener=void 0,this._suspectedStateListeners.forEach((e=>e.cleanUpSubscriptions())),this._suspectedStateListeners=[],this._clearSuspectedState(),this._throttledSuspectedIsOnline=void 0}_subscribeToLegacyAppStateTracking(e){this._legacyAppStateListener=new Er(this.logger,e);const t=this;this._legacyAppStateListener.subscribeToStateChange((e=>t._updateNetworkState(e,`LegacyApplicationState changed to ${dr.G[e]}`)));const i=this._legacyAppStateListener.getLastState();void 0!==i&&this._updateNetworkState(i,"initial LegacyApplicationState")}_subscribeToSuspectedNetworkState(e,t){const{enableNetworkTrackingForLegacyNetworkState:i}=t.get(S.J.Core);i&&(this._initSuspectedThrottleFunc(),this._subscribeToSendNetworkState(),this._subscribeToEndpointsNetworkStateTracking(e.networkState))}_subscribeToSendNetworkState(){const e=new fr(this.logger);this._suspectedStateListeners.push(e),e.subscribeToStateChange((e=>this._handleNetworkListenerUpdate(e,`Send network state is ${dr.G[e]}`)))}_subscribeToEndpointsNetworkStateTracking(e){const t=new hr(this.logger,e);this._suspectedStateListeners.push(t),t.subscribeToStateChange((e=>this._handleNetworkListenerUpdate(e,`Endpoints network state is ${dr.G[e]}`)))}_updateNetworkState(e,t){this.logger.log(`Update network to ${dr.G[e]}${t?" due to ":""}${t}`),this.getState()!==e&&(this.setNetworkState(e),this._resetSuspectedState())}_sendSuspectedNetworkStateThrottled(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){e!==this._suspectedIsOnline?(this._resetSuspectedState(),this._suspectedIsOnline=e):this._updateSuspectedStateListenersTo(this.getState()),this._throttledSuspectedIsOnline&&(yield this._throttledSuspectedIsOnline(e))}))}_clearSuspectedState(){var e;void 0!==this._suspectedIsOnline&&(this._suspectedIsOnline=void 0),null===(e=this._throttledSuspectedIsOnline)||void 0===e||e.cancel(),this._updateSuspectedStateListenersTo(this.getState())}_resetSuspectedState(){this._clearSuspectedState(),this._initSuspectedThrottleFunc()}}class xr extends Ue{constructor(){super(h.Yg.CreateAppState,[]),this.clientStateStorageKey="tmp.clientState",this._updateTelemetryOnClientStateChange=(e,t)=>{e.observe().subscribe((e=>{t.setCoreContext("AppInfo.ClientState",e)}))},this._updateTelemetryOnNetworkStateChange=(e,t)=>{e.observeIsOnline().subscribe((e=>{const i=e?"Online":"Offline";t.setCoreContext("AppInfo.NetworkState",i)}));e.observeDetailedNetworkState().subscribe((e=>{t.setCoreContext("AppInfo.DetailedNetworkState",e)}))},this._updateTelemetryOnHostStateChange=(e,t)=>{e.observe().pipe((0,l.U)((e=>e.suspendedState)),(0,er.x)()).subscribe((e=>{t.setCoreContext("AppInfo.Suspended",e)}));e.observe().pipe((0,l.U)((e=>e.machineLockState)),(0,er.x)()).subscribe((e=>{t.setCoreContext("AppInfo.MachineLock",e)}))},this._updateHostOnClientStateChange=(e,t,i)=>{const n=i.newLogger("updateHostOnClientStateChange","core-services-tasks");e.observe().subscribe((e=>t.loadModule("webclientstates").then((t=>{if(t&&t.notifyWebClientStateChange){const i=Zo[e];t.notifyWebClientStateChange(i),n.log(`messaged host new ClientState (${e}). WebClientState sent: ${i}`)}else n.warn(`${or.LoadModuleWebClientStatesFailed} or webclientstates.notifyWebClientStateChange is not loaded`)})).catch((e=>{n.errorToTelemetry&&n.errorToTelemetry(`Error happened: ${e.message||e}`,"webclient_framework_host_comms",void 0,!0)}))))},this._trackClientStateForGlassjar=(e,t)=>{e.observe().subscribe((e=>t.localStorage.setItem(this.clientStateStorageKey,e)))}}execute(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:i,hostCommunicationService:n,hostSettings:a,loggerFactory:s,platformService:o,scenarioFactory:r,telemetryService:c,windowProvider:l}=e,d=null===(t=null==a?void 0:a.hostSettings)||void 0===t?void 0:t.appState,u=void 0!==d?d:h.eT.Inactive;e.appStateService=new ar(u);const m=new Yo.u(l,s,i),g=new lr(l,s,n);e.hostState=g,e.clientState=new nr(l,s,m,i,e.hostState,d);const p=this._createNetworkStateProvider(e,e.clientState,e.appStateService);e.networkState=p,e.errorState=new Sa(l,r,o,p,e.diagnosticsService,i),this._updateTelemetryOnClientStateChange(e.clientState,c),this._updateTelemetryOnNetworkStateChange(p,c),this._updateTelemetryOnHostStateChange(g,c);const{enableUpdateHostOnClientStateChange:v}=i.get(S.J.Core);v&&this._updateHostOnClientStateChange(e.clientState,n,s);const{isRunningGlassjar:f}=i.get(S.J.Test);f&&this._trackClientStateForGlassjar(e.clientState,l)}))}_createNetworkStateProvider(e,t,i){const{coreSettings:n,loggerFactory:a,scenarioFactory:s,windowProvider:o,endpointsManager:r,hostCommunicationService:c,hostState:l,authStateProvider:d}=e,{enableNetworkOnlineDetection:u}=n.get(S.J.Core);return u?new Nr(a,n,s,o,t,r,l,d):new Fr(i,a,s,n,r,c)}}var Dr=i(891772),Ar=i(800418);class Mr extends Ue{constructor(){super(h.Yg.CreateAsyncMediaAuth,["gtmRegistry","discover","loggerFactory","coreSettings","windowProvider","platformService","endpointsManager","localStorage","authenticationService","config","authenticationUser","clientState","networkState"]),this.lifeCycleSubscriptions=[h.sM.OnUserAuthenticated,h.sM.OnUserAuthenticated_MTMA]}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){e.mediaAuthService||(e.mediaAuthService=new Ar.b(Dr.l,e.gtmRegistry,e.discover,e.loggerFactory,e.coreSettings,e.windowProvider,e.platformService,e.endpointsManager,e.localStorage,e.authenticationService,e.config,e.authenticationUser,e.clientState,e.networkState))}))}}var Pr=i(588470),Or=i(136613),Rr=i(959078),Lr=i(278593),Ur=i(7269),$r=i(928665),Wr=i(535059);class Br{constructor(e,t,i){var n;this._coreSettings=t,this._accountId=i,this._criticalResources=[],this.cleanup=new _i.xQ,this.currentAuthState=new s.X({state:Lr.j.Up}),this.resourceTokenStates=new Map,this.logSubscriptions=[],this.stateChangeLogs=[],this.skypeState=Lr.Q.Success,this.skypeTokenState=new s.X(Lr.Q.Unknown),this._logger=e.newLogger("AuthStateProvider","core-services-auth"),this._logger.log("[AuthState] Initializing auth state to Up.");const{criticalResources:a,authStateChangeTimeout:o}=(null===(n=this._coreSettings)||void 0===n?void 0:n.get(S.J.Auth))||{};this._criticalResources=a||[],this._authStateChangeTimeout=null!=o?o:3e4,this.badTokenStates=new Map,this.skypeLogSubscription=this.skypeTokenState.pipe((0,Si.R)(this.cleanup)).pipe((0,er.x)()).subscribe((e=>{this._logger.log(`[AuthState] Skype token state changed to: ${e}`),this.recordStateChange("SkypeToken",e)})),this.telemetryInterval=globalThis.window.setInterval((()=>{this.publishAuthStateTelemetry()}),tn.rF.ONE_HOUR),i&&(0,Wr.kh)(this.currentAuthState.value.state,i)}observe(){return this.currentAuthState}getState(){return this.currentAuthState.value}getInteractionRequiredResource(){const e=this.badTokenStates.entries();let t=e.next();for(;!t.done;){if(t.value[1]===Lr.Q.InteractionRequired)return t.value[0];t=e.next()}}reportResourceTokenState(e,t,i){(this._criticalResources.includes(e)||e===tn.ej.SIGNIN_RESTRICTIONS_KEY)&&(this.updateTokenStateMap(e,t),t===Lr.Q.Success?this.badTokenStates.has(e)&&(this.badTokenStates.clear(),this.skypeState=t):this.badTokenStates.set(e,t),this.evaluateCurrentState(i))}observeResourceTokenState(e){if(!this._criticalResources.includes(e)&&e!==tn.ej.SIGNIN_RESTRICTIONS_KEY)throw new Error("Unsupported resource, contact Auth team if you need your resource added.");let t=this.resourceTokenStates.get(e);return t||(t=this.updateTokenStateMap(e,Lr.Q.Unknown)),t.pipe((0,Si.R)(this.cleanup)).pipe((0,er.x)())}reportSkypeTokenState(e,t){this.skypeTokenState.next(e),e!==this.skypeState&&(this.skypeState=e,this.evaluateCurrentState(t))}observeSkypeTokenState(){return this.skypeTokenState.pipe((0,Si.R)(this.cleanup)).pipe((0,er.x)())}getSkypeTokenState(){return this.skypeTokenState.value}cleanupObservables(){var e;this._logger.log("[AuthState] Cleanup function called."),this.publishAuthStateTelemetry(),null===(e=null===globalThis||void 0===globalThis?void 0:globalThis.window)||void 0===e||e.clearInterval(this.telemetryInterval),this.cleanup.next(!0),this.cleanup.complete(),this.skypeTokenState.complete(),this.resourceTokenStates.forEach((e=>e.complete())),this.resourceTokenStates.clear(),this.skypeLogSubscription.unsubscribe(),this.logSubscriptions.forEach((e=>e.unsubscribe())),this.logSubscriptions=[]}recordStateChange(e,t){t!==Lr.Q.Unknown&&this.stateChangeLogs.push(`${Date.now()}|${e}->${t}`)}publishAuthStateTelemetry(){if(this.stateChangeLogs.length<1)return;const e=Ur.cv.create({subContext:"AuthState",correlation:{id:(0,$r.pW)(),source:"auth-state-provider",scenarioName:z.RG.AuthPublishState}});e.addEventData(this.stateChangeLogs),e.closeScenario(),this.stateChangeLogs=[]}updateTokenStateMap(e,t){let i=this.resourceTokenStates.get(e);return i?i.next(t):(i=new s.X(t),this.resourceTokenStates.set(e,i),this.logSubscriptions.push(i.pipe((0,Si.R)(this.cleanup)).pipe((0,er.x)()).subscribe((t=>{this._logger.log(`[AuthState] ${e} token state changed to: ${t}`),this.recordStateChange(e,t)})))),i}evaluateCurrentState(e){let t;if(0===this.badTokenStates.size)t=this.skypeState===Lr.Q.LicenseError?Lr.j.LicenseError:this.skypeState!==Lr.Q.Success?Lr.j.SkypeReconnecting:Lr.j.Up;else{const e=this.badTokenStates.values();let i=e.next();for(;!i.done;){if(i.value===Lr.Q.InteractionRequired){t=Lr.j.InteractionRequired;break}t=i.value===Lr.Q.SignInRestriction?Lr.j.SignInRestriction:Lr.j.AADReconnecting,i=e.next()}}t&&this.changeAuthState(t,e)}changeAuthState(e,t){if(this.shouldChangeStateToImmediately(e))this.pendingStateClearTimeout&&(globalThis.window.clearTimeout(this.pendingStateClearTimeout),this.pendingState=void 0,this.pendingStateClearTimeout=void 0),this.changeTo({state:e,customError:zr(t)});else if(this.pendingState)this.pendingState={state:e,customError:zr(t)};else{if(e===this.currentAuthState.value.state)return;this.pendingState={state:e,customError:zr(t)},this.pendingStateClearTimeout=globalThis.window.setTimeout((()=>{this.pendingState&&this.changeTo(this.pendingState),this.pendingState=void 0,this.pendingStateClearTimeout=void 0}),this._authStateChangeTimeout)}}shouldChangeStateToImmediately(e){switch(e){case Lr.j.Up:case Lr.j.InteractionRequired:case Lr.j.LicenseError:case Lr.j.SignInRestriction:return!0;default:return!1}}changeTo(e){e.state!==this.currentAuthState.value.state&&(this._logger.warn(`[AuthState] Transition from ${this.currentAuthState.value} to ${e}`),this.recordStateChange("AuthState",e.state),this.currentAuthState.next(e),this._accountId&&(0,Wr.kh)(e.state,this._accountId,e.customError))}}const zr=e=>e&&{errorCode:e.errorCode||e.code,message:e.message,context:e.context,isExpected:e.isExpected,correlationId:e.correlationId,subContext:e.subContext};var Hr=i(646645);const qr=Hr.string.pipe(new Hr.Type("URL",(e=>e instanceof URL),((e,t)=>{try{return(0,Hr.success)(new URL(e))}catch(i){return(0,Hr.failure)(e,t)}}),(e=>e.href))),Vr=(0,Hr.union)([(0,Hr.literal)("NA"),qr.pipe(new Hr.Type("GTM URL",(e=>e instanceof URL&&e.pathname.endsWith("/")),(e=>(e.pathname.endsWith("/")||(e.pathname+="/"),(0,Hr.success)(e))),Hr.identity))]),Gr=(0,Hr.partial)({isFreemium:Hr.boolean,isBasicLiveEventsEnabled:Hr.boolean,isAdvComms:Hr.boolean,isTranscriptEnabled:Hr.boolean,eduLicenseSkuAndCategory:(0,Hr.union)([Hr.string,Hr.nullType]),isCopilot:Hr.boolean,isM365CopilotBusinessChat:Hr.boolean,isTPProtection:Hr.boolean,isTPCustomization:Hr.boolean,isTPManagement:Hr.boolean,isTPWebinar:Hr.boolean,isTPVirtualAppointments:Hr.boolean,isInfoProtectionPremium:Hr.boolean,isTeamsPhonePremium:Hr.boolean,isTeamsSmb:Hr.boolean,isAvatarsEnabled:Hr.boolean,isTeamsPremiumSelfAssigned:Hr.boolean,isTeamsSharedDevices:Hr.boolean}),Jr=(0,Hr.partial)({ams:Vr,amsV2:Vr,appMonetizationService:Vr,appsSuggestionService:Vr,appService:Vr,biometricService:Vr,chatService:Vr,chatServiceAfd:Vr,chatSvcAggAfd:Vr,teamsPushServiceAfd:Vr,cmdArtifactsService:Vr,groupsServiceV2:Vr,mcpService:Vr,middleTier:Vr,mtImageService:Vr,phonelinkSmsService:Vr,powerPointStateService:Vr,peopleProfileService:Vr,search:Vr,tdmService:Vr,teamsAndChannelsProvisioningService:Vr,teamsEventsIntegration:Vr,unifiedPresence:Vr,urlp:Vr,urlpV2:Vr,userProfileService:Vr,calling_trouterUrl:Vr,calling_registrarUrl:Vr,consumerLicenses:Vr,virtualEventsService:Vr,userIntelligenceService:Vr},"region Gtms");var Kr=i(455572),Qr=i(400871),Yr=i(448850),Xr=i(772580),Zr=i(726727);const ec="[Authentication][DiscoverV2]";var tc,ic,nc,ac,sc;!function(e){e.userLocale="X-Client-UI-Language",e.skypeTokenAuthzTypeHeader="ms-teams-authz-type",e.claimsChallengeCapable="claimsChallengeCapable",e.consistencyValue="ConsistencyLevel"}(tc||(tc={})),function(e){e.skypeTokenRefresh="TokenRefresh",e.skypeTokenExplicitLogin="ExplicitLogin",e.strongConsistencyMsInternalUserSignup="MS-Internal-UserSignup",e.strongConsistencyDefaultValue="Organization;ScenarioId={id}"}(ic||(ic={})),function(e){e[e.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD=Zr.gT.Two*Zr.gT.SECONDS_PER_MINUTE*Zr.gT.MILLI_PER_SECOND]="DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD"}(nc||(nc={})),function(e){e.skypeAuthAnonReloadJoinLocation="skypeAuthAnonReloadJoinLocation",e.skypeAuthForceAnonReload="skypeAuthForceAnonReload"}(ac||(ac={})),function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.FIVE=5]="FIVE",e[e.TEN=10]="TEN",e[e.FIFTEEN=15]="FIFTEEN",e[e.SIXTEEN=16]="SIXTEEN",e[e.THIRTY=30]="THIRTY",e[e.TWO_HUNDRED_FIFTY_FIVE=255]="TWO_HUNDRED_FIFTY_FIVE"}(sc||(sc={}));const oc="skype_send_request",rc="skype_received_response",cc="skype_send_request_desktop",lc="skype_send_request_worker",dc="skype_token_received_worker",uc="NA";var mc=i(535151),gc=i(287474),hc=i(942209);const pc=[h.jK.NetworkOffline,h.jK.Forbidden,h.jK.ProxyAuthenticationRequired],vc={context:ec,subContext:"_getDiscoverResponse",errorCode:h.jK.NetworkOffline,message:"Network is offline, not making any call",isExpected:!0},fc={context:ec,subContext:"_getDiscoverResponse",errorCode:tn.SM.InteractionRequired,message:"Interaction is required to get a skype token, not making any call",isExpected:!0},bc=e=>{if(void 0===e)return h.jK.InvalidResponse;switch(e){case pr.qb.FORBIDDEN:return h.jK.Forbidden;case pr.qb.NOT_AUTHORIZED:return h.jK.Unauthorized;case pr.qb.PROXY_AUTHENTICATION_REQUIRED:return h.jK.ProxyAuthenticationRequired;default:return h.jK.FailedToFetch}},yc=(0,Hr.type)({skypeid:Hr.string}),kc=((0,Hr.type)({skypeTokenData:(0,Hr.type)({regionGtms:Jr,token:(0,Hr.type)({skypeToken:Hr.string,expiration:Hr.number,userDetails:(0,Hr.partial)({region:Hr.string})})})},"token"),(e,t)=>{if(!e)return t.error("Can not get userId due to skypeToken is undefined"),"";const{skypeid:i}=(0,mc.as)(yc,(0,Yr.J)(e));return`8:${i}`}),Sc=e=>{let t=e.findScenario(z.RG.GetSkypeToken);return t||(t=e.newScenario(z.RG.GetSkypeToken),t.mark("Non authz error scenario")),t},wc=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=(0,$r.pW)();null==i||i.push("fn:getuid");const a=yield e.getUser({correlation:{id:n,source:"discover-helper::getUserIdentifierForDiscover",scenarioName:z.RG.AuthWebUser}});if(null==i||i.push("user:"+ +!!a),null==a?void 0:a.isAuthenticated){t.log(`[_getUserIdentifier][${n}]user found by getUser call`);return(0,Rr.Xx)(a)}const s=`[_getUserIdentifier] ${a?`User is not authenticated. UserId: [${a.id}] tenantId: [${a.profile.tid}]`:"user missing"}. ${null==i?void 0:i.join(";")}`;throw(0,nn.Tr)({context:ec,subContext:"_getUserIdentifier",errorCode:a?tn.SM.UserNotAuthenticated:tn.SM.UserNotFoundError,isExpected:!0,message:s,correlationId:null!=n?n:(0,$r.pW)()})})),jc=(e,t,i,a,s,o,r,c,l)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){Pr.Jt.put(Tc(e),t.userDetails),null==i||i.push("userDetails:1"),yield function(e,t,i,a,s){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enableSkypeTokenEncryption:n,enableEncryptionKeyMaglev:o}=s.get(S.J.Auth);if(!n)return e;const r=i.newScenario(z.RG.AuthWebEncryptToken);r.mark("auth_web_encrypt_token_start");const c=yield(0,Wr.mM)(t,a,void 0,!!o);if(!c)return r.mark("auth_web_encrypt_token_stop",{reason:"tokenEncryption:MissingEncryptionKey"}),r.stop(),e;try{const i=t.crypto.getRandomValues(new Uint8Array(tn.uI.SIXTEEN)),n=(new TextEncoder).encode(e.skypeToken),a=yield t.crypto.subtle.encrypt({name:"AES-CBC",iv:i},c,n);e.encryptedToken=(0,hc.z)(a),e.iv=(0,hc.z)(i),r.mark("auth_web_encrypt_token_stop",{reason:"tokenEncryption:success"}),r.stop()}catch(e){r.mark("auth_web_encrypt_token_stop",{error:e,reason:null==e?void 0:e.message},"failure"),r.fail()}return e}))}(t,r,o,c,l),Pr.Jt.put(_c(e),t),null==i||i.push("skypeToken:1");const d=null==t?void 0:t.regionGtms;d&&(0,U.u4)(d).length>Zr.lP.DEFAULT_REGION_GTM_MIN_LENGTH?(Pr.Jt.put(Cc(e),d),null==i||i.push("regionGtms:1")):(null==i||i.push("regionGtms:-1"),s.error(`[_getDiscoverResponse][${a}] RegionGtm is missing in response, not able to cache.`))})),Cc=e=>({user:e,typeName:"Discover",key:tn.op}),_c=e=>({user:e,typeName:"Discover",key:tn.rz}),Tc=e=>({user:e,typeName:"Discover",key:tn.ru}),Ic=(e,t)=>{var i;const n=kc(e.skypeToken,t);return t.log(`[convertResponseToISkypeToken] Skypeid received from discovery. Region: ${null==e?void 0:e.region}`),{skypeToken:null==e?void 0:e.skypeToken,expiration:null===(i=null==e?void 0:e.expires)||void 0===i?void 0:i.getTime(),regionGtms:null==e?void 0:e.regionGtms,userDetails:{id:n,licenseDetails:Object.assign(Object.assign({},null==e?void 0:e.licenseDetails),{consumerLicenseDetails:null==e?void 0:e.consumerLicenseDetails}),region:null==e?void 0:e.region,userRegion:null==e?void 0:e.userRegion,partition:null==e?void 0:e.partition,userPartition:null==e?void 0:e.userPartition,regionOverride:null==e?void 0:e.regionOverride,regionSettings:null==e?void 0:e.regionSettings}}},Nc=(e,t,i,n,a)=>{const{skypeTokenValidationDisabled:s}=i.get(S.J.Auth),o=i.get(S.J.Host).skypeTokenValidationDisabled,r=s||o;return r&&Ec(e,t,n,a),!!r},Ec=(e,t,i,n)=>{if(t){i.log(`Skype token validation skipped. forceRenew:${e};isTokenSame:${t}`);const a=n.newScenario(z.RG.SkypeTokenValidationSkipped);a.appendEventData({message:`forceRenew:${e};isTokenSame:${t}`}),a.stop()}},Fc=(e,t,i,n,a,s)=>{const{authOverrides:o}=i.get(S.J.Host),{authzEndpointUrl:r,authzUrl:c,regionGtmsEnv:l}=i.get(S.J.Auth),d=((e,t,i,n,a)=>{const{environment:s}=(null==n?void 0:n.get(S.J.Metadata))||{},{doNotPassTenantIdForAnonMeetingJoins:o}=(null==n?void 0:n.get(S.J.Calling))||{};let r={method:"POST",url:i?`${e}?region_gtms_env=${i}`:`${e}`,serviceName:br.E.Auth,apiName:"acquireSkypeTokenWeb"};if(t.role===xe.w4O.Anonymous)if(t.subType===zo.Yf.Ccm){const e=Uc(t);if(!e)throw(0,nn.Tr)({context:"Authentication",subContext:"DiscoverHelper::getRequestConfig",errorCode:"MeetingDetailsNotFound",message:"No meetingUrl present for CCM user",correlationId:a,isExpected:!1});r=Object.assign(Object.assign({},r),{body:`{"meetingURL": "${e}"}`})}else r=o?Object.assign(Object.assign({},r),{url:`${e}/visitor`}):Object.assign(Object.assign({},r),{url:`${e}/visitor`,body:`{"tenantId": "${t.profile.tid}"}`});return s!==gc.s_.life||t.role!==xe.w4O.Guest&&t.role!==xe.w4O.Anonymous||(r=Object.assign(Object.assign({},r),{url:`${e}/guest${i?`?region_gtms_env=${i}`:""}`})),r})((null==o?void 0:o.authzEndpointUrl)||r||c||tn.ej.AUTHZ_DEFAULT_BASE_URL,e,l,i,t);return n.log(`[_getFormatRequest][${t}] Request formatted. `),d.headers=((e,t,i,n)=>{const a={},s=null==t?void 0:t.locale,{disableClaimsChallenge:o,enableSTMHeaderForAuthZ:r}=i.get(S.J.Auth);return s&&(a[tc.userLocale]=s),o||(a[tc.claimsChallengeCapable]="true"),r&&(a["X-MS-Migration"]="True"),a.clientRequestId=e,a["x-ms-skip-phone"]="true",void 0!==n&&(a["ms-teams-authz-type"]=n?ic.skypeTokenRefresh:ic.skypeTokenExplicitLogin),a})(t,a,i,s),d},xc=(e,t,i)=>{"object"==typeof e&&(e.context=e.context||ec,e.subContext=e.subContext||t,e.correlationId=e.correlationId||i)},Dc=(e,t,i,n,a)=>{const s=`${null==e?void 0:e.subContext}: Failed to get skype token; correlationId:${e.correlationId}, status:${a}, message:${t}, eventData: ${null==i?void 0:i.join(";")}`;return e.isExpected?n.debug(s):n.error(s),e},Ac=(e,t,i)=>{const n=null==e?void 0:e.join(";"),a=(null==i?void 0:i.get(S.J.Metadata))||{},s=i.get(S.J.Auth);return{message:`${n}::isOnline-${t}::environment:${null==a?void 0:a.environment}`,endpointUrl:null==s?void 0:s.authzUrl,resource:null==s?void 0:s.authzResource}},Mc=(e,t,i,n,a,s)=>{var o,r;const{serverResponse:{status:c,body:l}={}}=e;let{message:d,errorCode:u}=e;const{reason:m,code:g}=e,p=i&&!(e.context===h.w5.RejectHttpError&&g===h.jK.RemoteOperationFailed),v=null==t?void 0:t.join(";");c&&(u=bc(c),d=l.message);const f={reason:m,message:d,eventData:v},b=(0,se.A)((0,U.u4)(f)),y=e.correlationId,k=(null==s?void 0:s.get(S.J.Metadata))||{},w=s.get(S.J.Auth);void 0===e.isExpected&&(e.isExpected=!p||pc.indexOf(u)>-1);const j={context:null!==(o=null==e?void 0:e.context)&&void 0!==o?o:ec,subContext:null==e?void 0:e.subContext,message:`${d}::isOnline-${p}::env:${null==k?void 0:k.environment}`,errorCode:p?null!=u?u:g:h.jK.NetworkOffline,statusCode:c,correlationId:y,reason:b,endpointUrl:null==w?void 0:w.authzUrl,resource:null==w?void 0:w.authzResource,isExpected:!p||e.isExpected};if(!((null===(r=(0,U.u4)(e.reason))||void 0===r?void 0:r.indexOf("LoggedAlready"))>-1)&&n){let t=((e,t,i)=>{const{errorCode:n,code:a}=t;if(!e||t.isExpected||i===pr.qb.FORBIDDEN||i===pr.qb.PROXY_AUTHENTICATION_REQUIRED||n===h.jK.NetworkOffline||a===h.jK.NetworkOffline)return"cancel";if(n===h.jK.TimedOut||a===h.jK.TimedOut)return"incomplete";switch(i){case pr.qb.NOT_AUTHORIZED:case-1:case pr.qb.THROTTLED:return"incomplete";default:return"fail"}})(p,e,c);switch(t=(0,nn.ZG)(e)?"incomplete":t,t){case"stop":n.stop(j);break;case"incomplete":n.incomplete(j);break;case"cancel":n.cancel(j);break;default:n.fail(j)}}return Dc(e,d,t,a,c)};function Pc(e){return pc.indexOf(e.code)>-1||"Authentication::getUser"===e.subContext&&e.message.indexOf("User information is not available")>-1||e.message.indexOf("getUser: MSAL account not found")>-1||e.message.indexOf("Get skype token promise timed out, keep retrying. Is expected:true")>-1}function Oc(e,t,i){return t.getUser().then((()=>{const n=Rc(i);return t.authorize(e,n)}))}function Rc(e){const{isRunningGlassjar:t,mtAuthResourceOverride:i}=e.get(S.J.Test);if(t&&i)return i;const{authOverrides:n}=e.get(S.J.Host),{mtResource:a}=e.get(S.J.Auth);return(null==n?void 0:n.mtResource)||a||gc.O_.MT}const Lc=(e,t,i,n)=>{var a,s,o,r,c,l,d;if(!e)return void n.log("Failed to obtain telemetry details from discovery.");if(!i)return void n.log("Failed to obtain telemetry provider from getTelemetryProviderInstance.");const u=null===(a=e.licenseDetails)||void 0===a?void 0:a.isFreemium,{environment:m}=t.get(S.J.Metadata),g=m===gc.s_.life?Kr.OV.Life:u?Kr.OV.Freemium:Kr.OV.Work;if(m===gc.s_.life&&u&&n.warn("The Environment indicates TFL, but Freemium is true - defaulting telemetry to TFL Tenant.Model"),i.setContext("UserInfo.Region",e.region),i.setContext("Tenant.Model",g),null===(s=e.consumerLicenseDetails)||void 0===s?void 0:s.consumerLicenseDetails){const t=null===(c=null===(r=null===(o=e.consumerLicenseDetails)||void 0===o?void 0:o.consumerLicenseDetails)||void 0===r?void 0:r.licensedProducts)||void 0===c?void 0:c.map((e=>e.skuName)).sort().join(",");i.setContext("UserInfo.IsLicensed",!!(null===(d=null===(l=e.consumerLicenseDetails)||void 0===l?void 0:l.consumerLicenseDetails)||void 0===d?void 0:d.hasTeamsLicense)),i.setContext("UserInfo.Licenses",t)}},Uc=e=>{const t=Pr.Jt.getValue((0,Or.VF)((0,Rr.Xx)(e)).meetingDetails);if(!t)return;const{messageId:i,conversationId:n,tenantId:a,rootMessageId:s}=t;return i===s?`${a}${n}${i}`:`${a}${n}${i}${s}`},$c=e=>({isAdvComms:(null==e?void 0:e.isAdvComms)||!1,isTranscriptEnabled:(null==e?void 0:e.isTranscriptEnabled)||!1,isFreemium:(null==e?void 0:e.isFreemium)||!1,isTrial:(null==e?void 0:e.isTrial)||!1,isWebinarEnabled:(null==e?void 0:e.isWebinarEnabled)||!1,isPrivacyDataControlEnabled:(null==e?void 0:e.isPrivacyDataControlEnabled)||!1,eduLicenseSkuAndCategory:(null==e?void 0:e.eduLicenseSkuAndCategory)||void 0,isBasicLiveEventsEnabled:(null==e?void 0:e.isBasicLiveEventsEnabled)||!1,isCopilot:(null==e?void 0:e.isCopilot)||!1,isM365CopilotBusinessChat:(null==e?void 0:e.isM365CopilotBusinessChat)||!1,isTPProtection:(null==e?void 0:e.isTPProtection)||!1,isTPCustomization:(null==e?void 0:e.isTPCustomization)||!1,isTPManagement:(null==e?void 0:e.isTPManagement)||!1,isTPWebinar:(null==e?void 0:e.isTPWebinar)||!1,isTPVirtualAppointments:(null==e?void 0:e.isTPVirtualAppointments)||!1,isInfoProtectionPremium:(null==e?void 0:e.isInfoProtectionPremium)||!1,isTeamsPhonePremium:(null==e?void 0:e.isTeamsPhonePremium)||!1,isTeamsSmb:(null==e?void 0:e.isTeamsSmb)||!1,isAvatarsEnabled:(null==e?void 0:e.isAvatarsEnabled)||!1,isTeamsPremiumSelfAssigned:(null==e?void 0:e.isTeamsPremiumSelfAssigned)||!1,isTeamsSharedDevices:(null==e?void 0:e.isTeamsSharedDevices)||!1});var Wc=i(765358);const Bc=(e,t)=>e.decode(t).getOrElseL((e=>{throw new TypeError((0,Wc.Rn)(e).join("\n"))})),zc=(0,Hr.partial)({isNotificationEnabled:Hr.boolean,isUnifiedPresenceEnabled:Hr.boolean,isOutOfOfficeIntegrationEnabled:Hr.boolean,isContactMigrationEnabled:Hr.boolean,isAppsDiscoveryEnabled:Hr.boolean,isFederationEnabled:Hr.boolean}),Hc=(0,Hr.partial)({licenseDetails:Gr}),qc=(0,Hr.partial)({regionSettings:zc}),Vc=(0,Hr.partial)({userRegion:Hr.string}),Gc=(0,Hr.partial)({partition:Hr.string}),Jc=(0,Hr.partial)({userPartition:Hr.string}),Kc=(0,Hr.intersection)([(0,Hr.type)({region:Hr.string,regionGtms:Jr,tokens:(0,Hr.type)({skypeToken:Hr.string,expiresIn:Hr.number})}),(0,Hr.intersection)([qc,Hc,Vc,Gc,Jc])]),Qc=(0,Hr.type)({skuId:Hr.string,skuName:Hr.string,maxMeetingDurationMinutes:Hr.number,maxMeetingParticipants:Hr.number}),Yc=(0,Hr.intersection)([(0,Hr.type)({hasTeamsLicense:Hr.boolean}),(0,Hr.partial)({teamsFree:(0,Hr.type)({maxMeetingDurationMinutes:Hr.number,maxMeetingParticipants:Hr.number}),licensedProducts:(0,Hr.array)(Qc)})]),Xc=(0,Hr.partial)({consumerLicenseDetails:Yc}),Zc=(0,Hr.intersection)([(0,Hr.type)({regionGtms:Jr,skypeToken:(0,Hr.type)({skypetoken:Hr.string,expiresIn:Hr.number})}),Xc,Hc]),el=(0,Hr.type)({skypeTokenData:(0,Hr.type)({regionGtms:Jr,token:(0,Hr.type)({skypeToken:Hr.string,expiration:Hr.number,userDetails:(0,Hr.partial)({region:Hr.string})})})},"token"),tl=(0,Hr.type)({skypeid:Hr.string}),il=1e3,nl="Discover",al="https://api.spaces.skype.com";function sl(e){return Xr.getParser(e.navigator.userAgent).isBrowser("ie",!0)}class ol{constructor(e,t,i,a,o,r,c,l,d,u,m,g=(0,R.J)()){var h,p;this.aad=e,this.coreSettings=a,this.scenarioFactory=o,this.isOnline=r,this.shouldNotDecodeTokenForIE=c,this.onDiscoverSuccess=l,this.onDiscoverFail=d,this.isCDLWorker=u,this.cdlAuthClient=m,this.globalScope=g,this._localStorageKeys=[],this.licenseTypeToTenantType=e=>e?Kr.OV.Freemium:Kr.OV.Work,this._canGetSkypeTokenFromHost=()=>!!this.bootstrapData,this._acquireSkypeTokenWorker=(e=!1)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t,i;if(!this.cdlAuthClient)return Promise.reject("CDL worker auth client unavailable");try{const t=yield this.cdlAuthClient.getSkypeToken(e);return Object.assign(Object.assign({},t.userDetails),{skypeToken:t.skypeToken,regionGtms:Bc(Jr,t.regionGtms),expires:new Date(t.expiration)})}catch(e){throw(null===(t=e.response)||void 0===t?void 0:t.serverResponse)&&(e.serverResponse=e.response.serverResponse),e.context=null!==(i=e.context)&&void 0!==i?i:nl,e}})),this._acquireUserDetailsWorker=()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var e,t,i,n,a,s,o,r,c,l,d,u,m,g,h,p,v,f,b,y,k;if(!this.cdlAuthClient)return Promise.reject("CDL worker auth client unavailable");const S=yield this.cdlAuthClient.getUserDetails();return{id:S.id,region:S.userDetails.region,userRegion:S.userDetails.userRegion||void 0,partition:S.userDetails.partition||void 0,userPartition:S.userDetails.userPartition||void 0,tenant:{type:this.licenseTypeToTenantType(null===(e=S.userDetails.licenseDetails)||void 0===e?void 0:e.isFreemium)},isAdvComms:(null===(t=S.userDetails.licenseDetails)||void 0===t?void 0:t.isAdvComms)||!1,isTranscriptEnabled:(null===(i=S.userDetails.licenseDetails)||void 0===i?void 0:i.isTranscriptEnabled)||!1,isFreemium:(null===(n=S.userDetails.licenseDetails)||void 0===n?void 0:n.isFreemium)||!1,isTrial:(null===(a=S.userDetails.licenseDetails)||void 0===a?void 0:a.isTrial)||!1,isWebinarEnabled:(null===(s=S.userDetails.licenseDetails)||void 0===s?void 0:s.isWebinarEnabled)||!1,isBasicLiveEventsEnabled:(null===(o=S.userDetails.licenseDetails)||void 0===o?void 0:o.isBasicLiveEventsEnabled)||!1,eduLicenseSkuAndCategory:(null===(r=S.userDetails.licenseDetails)||void 0===r?void 0:r.eduLicenseSkuAndCategory)||void 0,isCopilot:(null===(c=S.userDetails.licenseDetails)||void 0===c?void 0:c.isCopilot)||!1,isM365CopilotBusinessChat:(null===(l=S.userDetails.licenseDetails)||void 0===l?void 0:l.isM365CopilotBusinessChat)||!1,isTPProtection:(null===(d=S.userDetails.licenseDetails)||void 0===d?void 0:d.isTPProtection)||!1,isTPCustomization:(null===(u=S.userDetails.licenseDetails)||void 0===u?void 0:u.isTPCustomization)||!1,isTPManagement:(null===(m=S.userDetails.licenseDetails)||void 0===m?void 0:m.isTPManagement)||!1,isTPWebinar:(null===(g=S.userDetails.licenseDetails)||void 0===g?void 0:g.isTPWebinar)||!1,isTPVirtualAppointments:(null===(h=S.userDetails.licenseDetails)||void 0===h?void 0:h.isTPVirtualAppointments)||!1,isInfoProtectionPremium:(null===(p=S.userDetails.licenseDetails)||void 0===p?void 0:p.isInfoProtectionPremium)||!1,isTeamsPhonePremium:(null===(v=S.userDetails.licenseDetails)||void 0===v?void 0:v.isTeamsPhonePremium)||!1,isTeamsSmb:(null===(f=S.userDetails.licenseDetails)||void 0===f?void 0:f.isTeamsSmb)||!1,isAvatarsEnabled:(null===(b=S.userDetails.licenseDetails)||void 0===b?void 0:b.isAvatarsEnabled)||!1,isTeamsPremiumSelfAssigned:(null===(y=S.userDetails.licenseDetails)||void 0===y?void 0:y.isTeamsPremiumSelfAssigned)||!1,isTeamsSharedDevices:(null===(k=S.userDetails.licenseDetails)||void 0===k?void 0:k.isTeamsSharedDevices)||!1}})),this._acquireSkypeTokenDesktop=()=>this.globalScope.opener.requestMessage(L.rY.GetStateData,{requestType:"skypeToken",timeout:Zr.lP.ACQUIRE_TOKEN_TIMEOUT}).then((e=>Bc(el,e))).then((({skypeTokenData:{regionGtms:e,token:{skypeToken:t,expiration:i,userDetails:n}}})=>Object.assign(Object.assign({},n),{skypeToken:t,regionGtms:e,expires:new Date(i)}))),this._acquireSkypeTokenWeb=()=>{const e=Date.now(),{authOverrides:t}=this.coreSettings.get(S.J.Host),{authzEndpointUrl:i,authzUrl:n,regionGtmsEnv:a}=this.coreSettings.get(S.J.Auth),{doNotPassTenantIdForAnonMeetingJoins:s}=this.coreSettings.get(S.J.Calling)||{},o=(null==t?void 0:t.authzEndpointUrl)||i||n||"https://authsvc.teams.microsoft.com/v1.0/authz";return this.aad.getUser().then((t=>{const i=this.getResponseFromLocalStorage(t.profile.oid,t.profile.tid);if(i)return i;let n={method:"POST",url:a?`${o}?region_gtms_env=${a}`:`${o}`,serviceName:br.E.Auth,apiName:"acquireSkypeTokenWeb"};if(t.role===zo.w4.Anonymous&&(n=s?Object.assign(Object.assign({},n),{url:`${o}/visitor`}):Object.assign(Object.assign({},n),{url:`${o}/visitor`,body:`{"tenantId": "${t.profile.tid}"}`})),sl(this.globalScope)&&this.shouldNotDecodeTokenForIE)return this.send().then((t=>t(n).then((({body:e})=>e.json())).then((t=>Object.assign(Object.assign({},t),{tokens:Object.assign(Object.assign({},t.tokens),{expires:new Date(e+t.tokens.expiresIn*il)})})))));{const i=this.send().then((e=>e(n).then((({body:e})=>e.json())))),a=t.type===zo.Ch.MsaLife;return this.parseAuthzResponse(i,a,e)}}))},this.logger=t.newLogger("Discover","core-services-discover"),this.send=()=>function(e,t,i){return t.getUser().then((()=>{const{authzResource:n}=i.get(S.J.Auth);return t.authorize(e,n||al)}))}(i,e,this.coreSettings).then((e=>(0,Qr.B)(e,pr.qb.OK))),this._skypeToken=new s.X(null),this.bootstrapData=this.coreSettings.get(S.J.Host).authBootstrapData,this.telemetryProvider=(0,Hi.G)(),null===(p=null===(h=e.observeMiddleTierToken)||void 0===h?void 0:h.call(e))||void 0===p||p.subscribe((e=>{void 0===e&&(this._discoveryResponse=void 0)}))}observeSkypeToken(){return this._skypeToken.pipe((0,u.h)((e=>null!==e)))}shouldThrowErrorIfSkypeTokenIsEmpty(){return!this.coreSettings.get(S.J.Auth).disableThrowingErrorIfSkypeTokenIsEmpty}getSettingToDisableSkypeTokenValidation(e,t){return Nc(e,t,this.coreSettings,this.logger,this.scenarioFactory)}shouldSkipTokenRefreshForAnon(){return!this.coreSettings.get(S.J.Auth).disableSkipTokenRefreshForAnon}regionGtm(e){return sl(this.globalScope)&&this.shouldNotDecodeTokenForIE?this.getDiscovery().then((t=>{let i=t.regionGtms[e];if(i)return i===uc||i.endsWith("/")||(i+="/"),i;throw(0,oe.Tr)(nl,h.jK.InvalidResponse,"regionGtm")})):this.getDiscovery().catch((e=>{var t;if(this._canGetSkypeTokenFromHost()){return{regionGtms:Bc(Jr,null===(t=this.bootstrapData)||void 0===t?void 0:t.regionGtms)}}throw e})).then((({regionGtms:{[e]:t}})=>{if(void 0===t)throw(0,oe.Tr)(nl,h.jK.InvalidResponse,"regionGtm",{},`${nl}::regionGtm::${h.jK.InvalidResponse} - ${e} is missing in discover response`);return t===uc?t:t.href}))}skypeid(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.getUser();return new Promise((t=>t(e.id)))}))}getRegion(){return this.getDiscovery().then((({region:e})=>e)).catch((e=>{var t;if(this._canGetSkypeTokenFromHost()){const e=null===(t=this.bootstrapData)||void 0===t?void 0:t.region;if(!e)throw(0,oe.Tr)(nl,h.jK.InvalidResponse,"getRegion");return e}throw e}))}getUserRegionAndPartitionForMultiGeo(){return this.getDiscovery().then((({userRegion:e,userPartition:t,partition:i})=>({userRegion:e,userPartition:t,partition:i}))).catch((e=>{var t,i,n;if(this._canGetSkypeTokenFromHost()){const e=null===(t=this.bootstrapData)||void 0===t?void 0:t.userRegion,a=null===(i=this.bootstrapData)||void 0===i?void 0:i.userPartition,s=null===(n=this.bootstrapData)||void 0===n?void 0:n.partition;if(!e||!a||!s)throw(0,oe.Tr)(nl,h.jK.InvalidResponse,"getUserRegionAndPartitionForMultiGeo");return{userRegion:e,userPartition:a,partition:s}}throw e}))}getUser(){var e,t;let i;if(this._canGetSkypeTokenFromHost()){const i=null===(e=this.bootstrapData)||void 0===e?void 0:e.userId,n=null===(t=this.bootstrapData)||void 0===t?void 0:t.region;if(i)return this.logger.log(`skypeid and region received from host: ${i} ${n}`),Promise.resolve(this._mapHostSkypeTokenToUser(i,n||void 0));this.logger.warn("skypeid or region was not received from host when expected")}return this.isCDLWorker?this._acquireUserDetailsWorker():this.getSkypeTokenInfoFromDiscoveryResponse().then((e=>{var t,n,a,s,o,r,c,l,d,u,m,g,h,p,v,f,b,y,k,S,w;return i={id:e.userDetails.id,region:e.userDetails.region,userRegion:e.userDetails.userRegion||void 0,partition:e.userDetails.partition||void 0,userPartition:e.userDetails.userPartition||void 0,tenant:{type:this.licenseTypeToTenantType(null===(t=e.userDetails.licenseDetails)||void 0===t?void 0:t.isFreemium)},isAdvComms:null===(n=e.userDetails.licenseDetails)||void 0===n?void 0:n.isAdvComms,isTranscriptEnabled:null===(a=e.userDetails.licenseDetails)||void 0===a?void 0:a.isTranscriptEnabled,isFreemium:(null===(s=e.userDetails.licenseDetails)||void 0===s?void 0:s.isFreemium)||!1,isTrial:(null===(o=e.userDetails.licenseDetails)||void 0===o?void 0:o.isTrial)||!1,isWebinarEnabled:(null===(r=e.userDetails.licenseDetails)||void 0===r?void 0:r.isWebinarEnabled)||!1,isBasicLiveEventsEnabled:(null===(c=e.userDetails.licenseDetails)||void 0===c?void 0:c.isBasicLiveEventsEnabled)||!1,eduLicenseSkuAndCategory:(null===(l=e.userDetails.licenseDetails)||void 0===l?void 0:l.eduLicenseSkuAndCategory)||void 0,isCopilot:(null===(d=e.userDetails.licenseDetails)||void 0===d?void 0:d.isCopilot)||!1,isM365CopilotBusinessChat:(null===(u=e.userDetails.licenseDetails)||void 0===u?void 0:u.isM365CopilotBusinessChat)||!1,isTPProtection:(null===(m=e.userDetails.licenseDetails)||void 0===m?void 0:m.isTPProtection)||!1,isTPCustomization:(null===(g=e.userDetails.licenseDetails)||void 0===g?void 0:g.isTPCustomization)||!1,isTPManagement:(null===(h=e.userDetails.licenseDetails)||void 0===h?void 0:h.isTPManagement)||!1,isTPWebinar:(null===(p=e.userDetails.licenseDetails)||void 0===p?void 0:p.isTPWebinar)||!1,isTPVirtualAppointments:(null===(v=e.userDetails.licenseDetails)||void 0===v?void 0:v.isTPVirtualAppointments)||!1,isInfoProtectionPremium:(null===(f=e.userDetails.licenseDetails)||void 0===f?void 0:f.isInfoProtectionPremium)||!1,isTeamsPhonePremium:(null===(b=e.userDetails.licenseDetails)||void 0===b?void 0:b.isTeamsPhonePremium)||!1,isTeamsSmb:(null===(y=e.userDetails.licenseDetails)||void 0===y?void 0:y.isTeamsSmb)||!1,isAvatarsEnabled:(null===(k=e.userDetails.licenseDetails)||void 0===k?void 0:k.isAvatarsEnabled)||!1,isTeamsPremiumSelfAssigned:(null===(S=e.userDetails.licenseDetails)||void 0===S?void 0:S.isTeamsPremiumSelfAssigned)||!1,isTeamsSharedDevices:(null===(w=e.userDetails.licenseDetails)||void 0===w?void 0:w.isTeamsSharedDevices)||!1},i}))}validateSkypeToken(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield this.validateSkypeTokenV2(e)).skypeToken}))}validateSkypeTokenV2(e){const t=this.getDiscovery(),i=null==e?void 0:e.forceRenew,n=null==e?void 0:e.invalidSkypeToken;return t.then((({expires:e,skypeToken:t})=>{if(!i&&t!==n&&e.getTime()>Date.now()&&t)return{skypeToken:t,fromCache:!0};if(!t){this.scenarioFactory.newScenario(z.RG.SkypeTokenUndefined).stop()}return this.resetDiscoveryResponse(),this.getDiscovery(i).then((({skypeToken:e})=>({skypeToken:e,fromCache:!1})))}))}getSkypeTokenInfoFromDiscoveryResponse(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.getDiscovery().then((e=>{const{skypeid:t}=(0,mc.as)(tl,(0,Yr.J)(e.skypeToken)),i=`8:${t}`;this.logger.log(`skypeid received from discovery: ${i}. Region: ${e.region}`);const n={id:i,region:e.region,userRegion:null==e?void 0:e.userRegion,partition:null==e?void 0:e.partition,userPartition:null==e?void 0:e.userPartition,licenseDetails:Object.assign(Object.assign({},e.licenseDetails),{consumerLicenseDetails:null==e?void 0:e.consumerLicenseDetails}),regionOverride:null==e?void 0:e.regionOverride,regionSettings:e.regionSettings};return{regionGtms:e.regionGtms,skypeToken:e.skypeToken,expiration:e.expires.getTime(),userDetails:n}})).catch((e=>{throw this.logger.error(`failed to get skypeid from discovery: ${(0,U.u4)(e)}â€‹â€‹`),e}))}))}getConsumerLicenseDetails(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.getSkypeTokenInfoFromDiscoveryResponse().then((e=>{var t,i;return null===(i=null===(t=null==e?void 0:e.userDetails)||void 0===t?void 0:t.licenseDetails)||void 0===i?void 0:i.consumerLicenseDetails}))}))}parseAuthzResponse(e,t,i){return t?e.then((e=>Bc(Zc,e))).then((({regionGtms:e,licenseDetails:t,skypeToken:{skypetoken:n,expiresIn:a},consumerLicenseDetails:s})=>({regionGtms:e,skypeToken:n,expires:new Date(i+a*il),licenseDetails:t,consumerLicenseDetails:s?{consumerLicenseDetails:s,timeStamp:new Date}:void 0}))):e.then((e=>Bc(Kc,e))).then((({region:e,userRegion:t,partition:n,userPartition:a,licenseDetails:s,regionGtms:o,tokens:{skypeToken:r,expiresIn:c},regionSettings:l})=>({region:e,userRegion:t,partition:n,userPartition:a,regionGtms:o,skypeToken:r,expires:new Date(i+c*il),licenseDetails:s,regionSettings:l})))}getDiscovery(e=!1){if(!this._discoveryResponse){const t=this.scenarioFactory.newScenario(z.RG.GetSkypeToken),i=this._canGetSkypeTokenFromHost()?this._acquireSkypeTokenDesktop:this.isCDLWorker?this._acquireSkypeTokenWorker:this._acquireSkypeTokenWeb,n=this.getDiscoveryResponse(i,t,0,e);return this.setDiscoveryResponse(n)}return this._discoveryResponse}getDiscoveryResponse(e,t,i=0,a=!1){var s,o;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield e(a);return t.stop(),this.onDiscoverSuccess&&this.onDiscoverSuccess(),Lc(i,this.coreSettings,this.telemetryProvider,this.logger),i}catch(n){let r=n;(null===(s=r.serverResponse)||void 0===s?void 0:s.body)&&(null===(o=r.serverResponse)||void 0===o?void 0:o.body.json)&&(r.serverResponse.body=yield r.serverResponse.body.json().catch((e=>{n.message+=`::${e.message}`})));const{disableResponseParsing:c}=this.coreSettings.get(S.J.Auth);if(r=((e,t,i)=>{let n;if(!i){const{response:t}=e;n=null==t?void 0:t.isExpected}let a=e;a.context||(a=(0,oe.Jn)(e,h.w5.Discover,h.jK.InvalidResponse,"",{error:e.stack},e.message||("string"==typeof e?e:(0,U.u4)(e))));const{serverResponse:{status:s,body:o,headers:r={}}={},context:c}=a;let{reason:l,message:d,code:u=h.jK.InvalidResponse,subContext:m=""}=a;return l=r?Object.assign(Object.assign({},l),{responseCorrelationId:r["correlation-id"],innerError:a}):l,d=(null==o?void 0:o.message)||d,m=(null==o?void 0:o.errorCode)||c,u=t?bc(s):h.jK.NetworkOffline,(0,oe.Tr)(h.w5.Discover,u,m,Object.assign(Object.assign({},l),{innerError:e}),d,a.serverResponse,n)})(n,this.isOnline(),!!c),this.canRetry(i,r))return null==t||t.mark("retry_skype_token_step",{message:r.message,reason:(0,U.u4)(r)}),this.getDiscoveryResponse(e,t,++i,this.coreSettings.get(S.J.Auth).useForceRenewInSkypeTokenRetry?a:void 0);throw this.onDiscoverFail&&this.onDiscoverFail(this._canGetSkypeTokenFromHost()),this.resetDiscoveryResponse(),((e,t,i)=>{if(!e)throw t;const n=Object.assign(Object.assign({},t),{errorCode:t.code,reason:(0,U.u4)(t.reason)});return(0,nn.ZG)(t)?e.incomplete(n):Pc(t)||!i&&(null==t?void 0:t.isExpected)?e.cancel(n):e.fail(n),t.reason&&(t.reason.isExpectedError=Pc(t)),t})(t,r,!!c)}}))}resetDiscoveryResponse(){this._discoveryResponse=void 0,this.clearFromLocalStorage()}canRetry(e,t){return e<1&&t.code!==h.jK.NetworkOffline&&t.code!==h.jK.Forbidden&&t.code!==h.jK.ProxyAuthenticationRequired}setDiscoveryResponse(e){return e=e.then((e=>(this._skypeToken.next(e.skypeToken),e))),this._discoveryResponse=e}getResponseFromLocalStorage(e,t){let i=this.getFromLocalStorage(e,t,"auth.gtm.table");const n=this.getFromLocalStorage(e,t,"auth.skype.token");return i&&n?(sl(this.globalScope)&&this.shouldNotDecodeTokenForIE||(i=Bc(Jr,i)),Object.assign(Object.assign({},n.userDetails),{skypeToken:n.skypeToken,expires:new Date(n.expiration),regionGtms:i})):null}getFromLocalStorage(e,t,i){var n;if(!(null===(n=this.globalScope)||void 0===n?void 0:n.localStorage))return;let a=`ts.${t}-${e}.${i}`,s=this.globalScope.localStorage.getItem(a);if(s||(a=`ts.${e}.${i}`,s=this.globalScope.localStorage.getItem(a)),s){this._localStorageKeys.push(a);try{return JSON.parse(s)}catch(e){this.logger.error(e)}}}clearFromLocalStorage(){var e;(null===(e=this.globalScope)||void 0===e?void 0:e.localStorage)&&(this._localStorageKeys.forEach((e=>{this.globalScope.localStorage.removeItem(e)})),this._localStorageKeys=[])}getAdditionalUserInfo(){var e,t,i;return{userRegion:(null===(e=this.bootstrapData)||void 0===e?void 0:e.userRegion)||void 0,userPartition:(null===(t=this.bootstrapData)||void 0===t?void 0:t.userPartition)||void 0,partition:(null===(i=this.bootstrapData)||void 0===i?void 0:i.partition)||void 0}}_mapHostSkypeTokenToUser(e,t){var i;const n=null===(i=this.bootstrapData)||void 0===i?void 0:i.licenseDetails,a=this.getAdditionalUserInfo();return Object.assign({id:e,region:t||void 0,tenant:{type:this.licenseTypeToTenantType(null==n?void 0:n.isFreemium)},isAdvComms:(null==n?void 0:n.isAdvComms)||!1,isTranscriptEnabled:(null==n?void 0:n.isTranscriptEnabled)||!1,isFreemium:(null==n?void 0:n.isFreemium)||!1,isTrial:(null==n?void 0:n.isTrial)||!1,isWebinarEnabled:(null==n?void 0:n.isWebinarEnabled)||!1,eduLicenseSkuAndCategory:(null==n?void 0:n.eduLicenseSkuAndCategory)||void 0,isBasicLiveEventsEnabled:(null==n?void 0:n.isBasicLiveEventsEnabled)||!1,isCopilot:(null==n?void 0:n.isCopilot)||!1,isM365CopilotBusinessChat:(null==n?void 0:n.isM365CopilotBusinessChat)||!1,isTPProtection:(null==n?void 0:n.isTPProtection)||!1,isTPCustomization:(null==n?void 0:n.isTPCustomization)||!1,isTPManagement:(null==n?void 0:n.isTPManagement)||!1,isTPWebinar:(null==n?void 0:n.isTPWebinar)||!1,isTPVirtualAppointments:(null==n?void 0:n.isTPVirtualAppointments)||!1,isInfoProtectionPremium:(null==n?void 0:n.isInfoProtectionPremium)||!1,isTeamsPhonePremium:(null==n?void 0:n.isTeamsPhonePremium)||!1,isTeamsSmb:(null==n?void 0:n.isTeamsSmb)||!1,isAvatarsEnabled:(null==n?void 0:n.isAvatarsEnabled)||!1,isPrivacyDataControlEnabled:(null==n?void 0:n.isPrivacyDataControlEnabled)||!1,isTeamsPremiumSelfAssigned:(null==n?void 0:n.isTeamsPremiumSelfAssigned)||!1,isTeamsSharedDevices:(null==n?void 0:n.isTeamsSharedDevices)||!1},a)}}var rl=i(827748),cl=i(236380);const ll="Login Rate limit exceeded",dl={AdminUserLicenseNotPresentForbidden:"AdminUserLicenseNotPresentForbidden",AdminTeamsDisabledForTenantForbidden:"AdminTeamsDisabledForTenantForbidden",UserLicenseNotPresentForbidde:"UserLicenseNotPresentForbidde",TeamsDisabledForTenantForbidden:"TeamsDisabledForTenantForbidden",UserLicenseNotPresentTrialEligible:"UserLicenseNotPresentTrialEligible",TrialLicenseTenantNotReady:"TrialLicenseTenantNotReady",NewFederatedUsersNotAllowed:"NewFederatedUsersNotAllowed"},ul=(e,t)=>(t<0||Date.now()-t>=Zr.gT.MILLISECONDS_PER_HOUR)&&((0,oe.o7)(e)||[pr.qb.THROTTLED,pr.qb.NOT_AUTHORIZED,-1].indexOf(e)>-1),ml=(e,t,i,a,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n;const o=Sc(a),{serverResponse:{status:r,body:c}={}}=e;null==o||o.appendEventData({statusCode:r}),(0,oe.o7)(null!=r?r:0)?null==o||o.fail({message:(0,$r.VK)(e),errorCode:h.jK.ServiceUnavailable,statusCode:r}):-1!==r?((null===(n=c.message)||void 0===n?void 0:n.indexOf(ll))>-1&&(null==o||o.incomplete({message:(0,$r.VK)(e),errorCode:ll,statusCode:r}),s.error(`DiscoverRetryPolicy: Delaying skype token fetch for ${nc.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD}' .`),(0,rl._)(nc.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD)),yield gl(e,t,i,a,s)):null==o||o.incomplete({message:(0,$r.VK)(e),errorCode:h.jK.TimedOut,statusCode:r})})),gl=(e,t,i,a,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n,o;const r=Sc(a),{serverResponse:{status:c,body:l,headers:d}={}}=e;let u;try{const e=yield l.json();u=null===(n=null==e?void 0:e.error)||void 0===n?void 0:n.code}catch(e){s.error(`Body jsonify failed: ${e}`)}switch(s.error(`Getting errorCode: [${u}] from response`),c){case pr.qb.NOT_AUTHORIZED:yield pl(d,i,s,null===(o=t.options)||void 0===o?void 0:o.userIdentifier),null==r||r.incomplete({message:(0,$r.VK)(e),errorCode:null!=u?u:h.jK.Unauthorized,statusCode:c});break;case pr.qb.FORBIDDEN:((e,t)=>e===pr.qb.FORBIDDEN&&!!t&&t in dl)(c,u)&&hl(u,t,a),null==r||r.cancel({message:(0,$r.VK)(e),errorCode:null!=u?u:h.jK.Forbidden,statusCode:c});break;case pr.qb.THROTTLED:default:null==r||r.incomplete({message:(0,$r.VK)(e),errorCode:null!=u?u:h.jK.Throttled,statusCode:c})}})),hl=(e,t,i)=>{const n=Sc(i);if(e===dl.NewFederatedUsersNotAllowed)return t.headerUpdate||(t.headerUpdate={strongConsistencyValue:(a=ic.strongConsistencyMsInternalUserSignup,ic.strongConsistencyDefaultValue.replace("{id}",a))}),void(null==n||n.mark(dl.NewFederatedUsersNotAllowed));var a;e===dl.UserLicenseNotPresentTrialEligible?(null==n||n.mark(dl.UserLicenseNotPresentTrialEligible),t.lastLicenseErrorTime=-1):t.lastLicenseErrorTime=Date.now()},pl=(e,t,i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n;e&&0!==(null===(n=Object.keys(e))||void 0===n?void 0:n.length)?yield t(e,a):i.error("DiscoverUnauthorizeError: header is empty")}));const vl=(e,t,i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return fl(e,t,bl)({policy:i,delay:i.createDelay(),retryCount:0,retriesTable:{},startTime:Date.now().valueOf(),forever:i.foreverCheck,headerUpdate:void 0,lastLicenseErrorTime:-1,options:{userIdentifier:null!=a?a:void 0}})})),fl=(e,t,i)=>a=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){for(var n;;){const s=t;(null===(n=a.headerUpdate)||void 0===n?void 0:n.strongConsistencyValue)&&(s.headers||(s.headers={}),s.headers.ConsistencyLevel=a.headerUpdate.strongConsistencyValue);try{return yield e(s)}catch(e){yield i(e,a)}}})),bl=(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(!e.serverResponse)throw e;const i=!(yield t.forever()),{serverResponse:{status:n}}=e;if(-1!==t.startTime&&Date.now().valueOf()-t.startTime>=t.policy.retryMaxTimeMs&&(t.startTime=-1,t.policy.retryMaxTimeCallback(i)),n&&t.policy.isOnline()&&(t.retryCount++<t.policy.maxRetryCount&&!i||i)&&t.policy.shouldRetry(n,t.lastLicenseErrorTime))return t.retriesTable[n]=(t.retriesTable[n]||0)+1,t.policy.errorHandler(e,t);throw e}));var yl=i(849960),kl=i(924732),Sl=i(561849),wl=i(935232);class jl{constructor(e,t,i,a,o,r,c,l,d,u,m,g,p,v=(0,R.J)()){var f,b,y,w,j,C;this._authenticationService=e,this._coreSettings=a,this._scenarioFactory=o,this._networkStateProvider=r,this._hostCommunicationService=c,this._i18n=l,this._authStateProvider=d,this.onDiscoverSuccess=u,this.onDiscoverFail=m,this.isCDLWorker=g,this.cdlAuthClient=p,this.globalScope=v,this._skypeToken=new s.X(null),this._localStorageKeys=[],this._firstMTTokenEstablished=!1,this.cleanup=()=>{var e,t;null===(e=this._onlineSubscription)||void 0===e||e.unsubscribe(),this._onlineSubscription=void 0,null===(t=this._awakeSubscription)||void 0===t||t.unsubscribe(),this._awakeSubscription=void 0},this.clearDiscoveryCacheForLogout=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=(0,Rr.Xx)(e);this.clearDiscoveryCache(t,["^fn:clearDiscoveryCacheForLogout"])})),this.clearDiscoveryCache=(e,t,i)=>{this._skypeToken.next(null),Pr.Jt.del(_c(e)),null==t||t.push("skypeCacheClear"),i||(Pr.Jt.del(Tc(e)),null==t||t.push("userDetailsCacheClear"),Pr.Jt.del(Cc(e)),null==t||t.push("regionGtmsCacheClear")),this._clearFromLocalStorage(i),null==t||t.push("localstorageCacheClear"),this._logger.log(`[clearDiscoveryCache] Discover cache cleared, tokenOnly: ${!!i}.`)},this._getDiscoverResponse=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t,i,n,a,s,o;const{correlationId:r=(0,$r.pW)(),eventData:c=[]}=e;null==c||c.push("_getDiscoverResponse|startScenario");const l=this._scenarioFactory.newScenario(z.RG.GetSkypeToken);let d;try{if(!this._isAppOnline())throw(0,nn.Tr)(Object.assign(Object.assign({},vc),{correlationId:r}));if((null===(i=null===(t=this._authStateProvider)||void 0===t?void 0:t.getState())||void 0===i?void 0:i.state)===Lr.j.InteractionRequired)throw(0,nn.Tr)(Object.assign(Object.assign({},fc),{correlationId:r}));d=yield this._discoverProvider(Object.assign(Object.assign({},e),{eventData:c})),Lc(d,this._coreSettings,this._telemetryProvider,this._logger)}catch(e){const t=e.errorCode||e.code,{serverResponse:{status:i}={}}=e;throw i===pr.qb.FORBIDDEN?(null===(n=this._authStateProvider)||void 0===n||n.reportSkypeTokenState(Lr.Q.LicenseError,e),null==c||c.push("authState:license-error")):t===tn.SM.InteractionRequired?(null===(a=this._authStateProvider)||void 0===a||a.reportSkypeTokenState(Lr.Q.InteractionRequired,e),null==c||c.push("authState:interactionRequired")):(null===(s=this._authStateProvider)||void 0===s||s.reportSkypeTokenState(Lr.Q.Failure,e),null==c||c.push("authState:failure")),this.onDiscoverFail&&this.onDiscoverFail(!!this._bootstrapData),Mc(e,c,this._isAppOnline(),l,this._logger,this._coreSettings)}null===(o=this._authStateProvider)||void 0===o||o.reportSkypeTokenState(Lr.Q.Success);const u=Ic(d,this._logger);yield jc(e.userIdentifier,u,c,r,this._logger,this._scenarioFactory,this.globalScope,this._hostCommunicationService,this._coreSettings);const m=yield wc(this._authenticationService,this._logger,c);return(0,Rr.FG)(null==e?void 0:e.userIdentifier,m)||!(null==e?void 0:e.userIdentifier)?this._skypeToken.next(d.skypeToken):this._logger.error(`[_getDiscoverResponse][${r}] option uid:${null==e?void 0:e.userIdentifier}`),null==l||l.stop({reason:c.join(";")}),this.onDiscoverSuccess&&this.onDiscoverSuccess(),d})),this._isSkypeTokenValidInMemory=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=null!=e?e:yield wc(this._authenticationService,this._logger,[]);return!!Pr.Jt.getValue(_c(t))})),this._retryMaxTimeCallback=e=>{var t;return e?(null===(t=this._authStateProvider)||void 0===t||t.reportSkypeTokenState(Lr.Q.Failure),this._logger.error("[_retryMaxTimeCallback]Reporting skype token failure to authState"),!1):(this._logger.warn("[_retryMaxTimeCallback] Reached retry max time."),!1)},this._getResponseFromLocalStorage=(e,t)=>{if(!t||!e)return;const i=this._getFromLocalStorage(e,t,"auth.gtm.table"),n=this._getFromLocalStorage(e,t,"auth.skype.token");return i&&n?Object.assign(Object.assign({},n.userDetails),{skypeToken:n.skypeToken,expires:new Date(n.expiration),regionGtms:i}):void 0},this._getCachedResponseWrapper=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t,i;return this._getResponseFromLocalStorage(null===(t=null==e?void 0:e.profile)||void 0===t?void 0:t.oid,null===(i=null==e?void 0:e.profile)||void 0===i?void 0:i.tid)})),this._acquireSkypeTokenWeb=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t,i,a,s;null===(t=e.eventData)||void 0===t||t.push("fn:_acquireSkypeTokenWeb");let o=yield this._authenticationService.getUser({accountId:e.userIdentifier.id,userIdentifier:e.userIdentifier,correlation:{id:e.correlationId,source:"discoverV2::_acquireSkypeTokenWeb",scenarioName:z.RG.AuthWebUser}});if(null===(i=e.eventData)||void 0===i||i.push("user:"+ +!!o,"uid:"+ +!!e.userIdentifier),!o){if(o=yield this._authenticationService.getUser({correlation:{id:e.correlationId,source:"discoverV2::_acquireSkypeTokenWeb",scenarioName:z.RG.AuthWebUser}}),!o)throw(0,nn.Tr)({context:ec,subContext:"_acquireSkypeTokenWeb",errorCode:tn.SM.UserNotFoundError,message:"User not found for provided userIdentifier nor globally.",correlationId:e.correlationId,isExpected:!1});((e,t,i)=>{var n;if(!(0,Rr.FG)(e.userIdentifier,(0,Rr.Xx)(t)))throw null===(n=e.eventData)||void 0===n||n.push("userMismatch"),i.warn("[_acquireSkypeTokenWeb] user obtained does not match provided userIdentifier, throw error."),(0,nn.Tr)({context:ec,subContext:"_acquireSkypeTokenWeb",errorCode:tn.SM.UserNotFoundError,message:"User obtained does not match provided userIdentifier.",correlationId:e.correlationId,isExpected:!0})})(e,o,this._logger)}const r=yield this._getCachedResponseWrapper(o);if(r)return null===(a=e.eventData)||void 0===a||a.push("cache:1"),r;const c=Pr.Jt.getValue(Tc((0,Rr.Xx)(o))),l=Fc(o,e.correlationId,this._coreSettings,this._logger,this._i18n,!!c),d=this._scenarioFactory.findScenario(z.RG.GetSkypeToken);null==d||d.mark(oc,Ac(e.eventData,this._isAppOnline(),this._coreSettings));const u=yield this.send({userIdentifier:e.userIdentifier,correlationId:e.correlationId})(l);return null===(s=e.eventData)||void 0===s||s.push("response:1"),null==d||d.mark(rc,Ac(e.eventData,this._isAppOnline(),this._coreSettings)),d&&(d.eventData.authzCorrelationId=u.headers["correlation-id"],d.eventData.correlationTags=u.headers["correlation-tags"],d.eventData.correlationId=null==e?void 0:e.correlationId),((e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n,a;const s=Date.now(),{regionGtms:o,licenseDetails:r,skypeToken:c,tokens:l,region:d,regionOverride:u,regionSettings:m,skypeGuestUserToken:g,consumerLicenseDetails:h,userRegion:p,partition:v,userPartition:f}=yield e.body.json();null===(n=t.eventData)||void 0===n||n.push("parsejson:1");const b=c||l||g,y=null!==(a=null==b?void 0:b.skypeToken)&&void 0!==a?a:null==b?void 0:b.skypetoken;let k;return i.log(`[_acquireSkypeTokenWeb][${null==t?void 0:t.correlationId}] Response parsed succeed.`),h&&(k={timeStamp:new Date(s),consumerLicenseDetails:h}),{userId:kc(y,i),regionGtms:o,licenseDetails:r,skypeToken:y,expires:new Date(s+(null==b?void 0:b.expiresIn)*Zr.gT.MILLI_PER_SECOND),region:d,userRegion:p,partition:v,userPartition:f,regionOverride:u,regionSettings:m,consumerLicenseDetails:k}})))(u,e,this._logger)})),this._acquireSkypeTokenDesktop=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t,i,n,a;null===(t=e.eventData)||void 0===t||t.push("fn:_acquireSkypeTokenDesktop");const s=yield this._authenticationService.getUser({accountId:e.userIdentifier.id,userIdentifier:e.userIdentifier,correlation:{id:e.correlationId,source:"discoverV2::_acquireSkypeTokenWeb",scenarioName:z.RG.AuthWebUser}}),o=yield this._getCachedResponseWrapper(s);if(o)return o;null===(i=e.eventData)||void 0===i||i.push("cache:0");const r=this._scenarioFactory.findScenario(z.RG.GetSkypeToken);null==r||r.mark(cc);const c=yield this.globalScope.opener.requestMessage(L.rY.GetStateData,{requestType:"skypeToken",timeout:Zr.lP.ACQUIRE_TOKEN_TIMEOUT});null==r||r.mark(rc);const l=null==c?void 0:c.skypeTokenData;r&&(r.eventData.correlationId=null==c?void 0:c.correlationId);return{userId:kc(null===(n=null==l?void 0:l.token)||void 0===n?void 0:n.skypeToken,this._logger),userDetails:null==l?void 0:l.userDetails,skypeToken:null===(a=null==l?void 0:l.token)||void 0===a?void 0:a.skypeToken,regionGtms:null==l?void 0:l.regionGtms,expires:new Date(null==l?void 0:l.token.expiration)}})),this._acquireSkypeTokenWorker=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const{eventData:t}=e;if(t.push("fn:_acquireSkypeTokenWorker"),!this.cdlAuthClient)throw(0,nn.Tr)({context:ec,subContext:"_acquireSkypeTokenWorker",errorCode:h.jK.NotPresent,message:"CDL worker auth client unavailable",correlationId:e.correlationId,isExpected:!1});const i=!1!==e.forceRenew,n=this._scenarioFactory.findScenario(z.RG.GetSkypeToken);null==n||n.mark(lc);const a=yield this.cdlAuthClient.getSkypeToken(i);return null==n||n.mark(dc),Object.assign(Object.assign({userId:kc(a.skypeToken,this._logger)},a.userDetails),{skypeToken:a.skypeToken,regionGtms:a.regionGtms,expires:new Date(a.expiration)})})),this._getRetryForSend=e=>{const{authzResource:t,disableRetryInDiscoverV2:i}=this._coreSettings.get(S.J.Auth);return a=>{var s;if(!this._authenticationService.authorizeV2)throw(0,nn.Tr)({context:ec,subContext:"_getRetryForSend",errorCode:"AuthorizeV2NotFound",message:"AuthorizeV2 endpoint not accessible",correlationId:null!==(s=a.correlationId)&&void 0!==s?s:(0,$r.pW)(),isExpected:!1});const o=this._authenticationService.authorizeV2.bind(this._authenticationService),r=()=>(0,Qr.B)(o(e,t||Zr.ej.MT_AAD_KEY,{userIdentifier:a.userIdentifier}),pr.qb.OK);return i?r():function(e,t,i){return n=>vl(e,n,t,i)}(r(),((e,t,i,a,s,o)=>({shouldRetry:ul,errorHandler:(a,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=Sc(t),{serverResponse:{status:o,headers:r}={}}=a;if(!o||!s.retriesTable[o])throw a.reason=Object.assign(Object.assign({},a.reason),{scenarioStep:"fail"}),a.message=`dicoverRetryPolicy: retry count for ${o} is empty`,a;const c=null==r?void 0:r["correlation-id"],l=null==r?void 0:r["correlation-tags"];null==n||n.appendEventData({authzCorrelationId:c,correlationTags:l}),s.headerUpdate=void 0,yield ml(a,s,i,t,e),e.error(`[DiscoverRetryPolicy]: retrying '[${s.retryCount}]' times due to response status - '[${o}], wait for '[${s.delay.next()}] for next retry..'`);const d=yield s.forever();if(s.retryCount>=s.policy.maxRetryCount&&d)throw e.log(`[DiscoverRetryPolicy]: maxTimeReached count: ${s.retryCount} and tokenValid, cancel forever`),a.reason=["LoggedAlready"],a;return(0,rl._)(s.delay.next())})),retryMaxTimeMs:Zr.lP.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS,maxRetryCount:Zr.lP.DEFAULT_SKYPE_MAX_RETRY_COUNT,createDelay:()=>new cl.df(Zr.lP.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS,Zr.lP.DEFAULT_SKYPE_EXP_DELAY_FACTOR,Zr.lP.DEFAULT_SKYPE_MAX_DELAY_TIME_MS),isOnline:a,retryMaxTimeCallback:s,foreverCheck:o}))(this._logger,this._scenarioFactory,this.unauthorizedErrorHandler,this._isAppOnline,this._retryMaxTimeCallback,this._isSkypeTokenValidInMemory),a.userIdentifier)}},this._isRefreshInBackgroundRequired=(e,t,i,n)=>{(null==e?void 0:e.shouldRefresh)&&(null==i||i.push("shouldrefreshbg"),this._debouncedGetDiscoverResponse((0,U.u4)(t),{userIdentifier:t,correlationId:n,eventData:i}).catch((e=>{Dc(e,null==e?void 0:e.message,i,this._logger)})))},this._populateDiscoverResponseFromBootstrapdata=()=>{this._bootstrapData=this._coreSettings.get(S.J.Host).authBootstrapData,this._bootstrapData},this._isAppOnline=()=>this._networkStateProvider.getState()===dr.G.Online,this.unauthorizedErrorHandler=(e,t)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){((e,t,i,a,s)=>{(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{disableClaimsChallenge:n}=a.get(S.J.Auth);if(n)s.log("[unauthorizedErrorHandler] Claims challenge handling disabled.");else if(e)if(t)Pr.Jt.deleteType(t,"Token");else{const e=yield i.getUser();Pr.Jt.deleteType((0,Rr.Xx)(e),"Token")}else s.log("[unauthorizedErrorHandler] No header passed in.")}))})(e,t,this._authenticationService,this._coreSettings,this._logger)})),this._logger=t.newLogger(ec,"core-services-discover"),(0,yl.g)(this,"DiscoverV2",this._getConfig("mockApi"),this._getConfig("enableMockApi")),this.send=this._getRetryForSend(i),this._debouncedGetDiscoverResponse=(0,kl.k)(this._getDiscoverResponse),(0,Pr.ky)(v),this._populateDiscoverResponseFromBootstrapdata(),this._discoverProvider=this.resolveProvider(),null===(b=null===(f=this._authenticationService)||void 0===f?void 0:f.registerCleanUpOnLogoutCallback)||void 0===b||b.call(f,k.D.Discover,this.clearDiscoveryCacheForLogout),this._tokenObserver=null===(j=null===(w=(y=this._authenticationService).observeMiddleTierToken)||void 0===w?void 0:w.call(y))||void 0===j?void 0:j.subscribe((e=>{if(void 0===e)this._logger.log("MT token appears as undefined, deleting skype token for relevant user."),wc(this._authenticationService,this._logger,[]).then((e=>{e&&Pr.Jt.del(_c(e))}));else if(""!==e){const e=this._firstMTTokenEstablished;this._firstMTTokenEstablished=!0,this._logger.log(`Get Skype token on new MT token forceRenew: ${e}.`),this.getSkypeTokenInfoFromDiscoveryResponse({forceRenew:e})}}));const{enableTokenRefreshOnOnline:_,enableTokenRefreshOnWakeUp:T}=null===(C=this._coreSettings)||void 0===C?void 0:C.get(S.J.Auth);_&&(this._logger.log("Subscribing to Online state for Skype token."),this._onlineSubscription=wl._i.observeMachineOnline().subscribe((()=>{this._logger.log("Getting skype token on Online."),this.getSkypeTokenInfoFromDiscoveryResponse()}))),T&&(this._logger.log("Subscribing to Suspended state for Skype token."),this._awakeSubscription=wl._i.observeMachineAwake().subscribe((()=>{this._logger.log("Getting skype token on Suspended."),this.getSkypeTokenInfoFromDiscoveryResponse()}))),this._telemetryProvider=(0,Hi.G)(),this._logger.log("[ctor]Service initialized.")}observeSkypeToken(){return this._skypeToken.pipe((0,u.h)((e=>null!==e)),(0,er.x)())}shouldThrowErrorIfSkypeTokenIsEmpty(){return!this._coreSettings.get(S.J.Auth).disableThrowingErrorIfSkypeTokenIsEmpty}getSettingToDisableSkypeTokenValidation(e,t){return Nc(e,t,this._coreSettings,this._logger,this._scenarioFactory)}shouldSkipTokenRefreshForAnon(){return!this._coreSettings.get(S.J.Auth).disableSkipTokenRefreshForAnon}regionGtm(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=(0,$r.pW)(),n=["^fn:regionGtm:uid:"+ +!!t];try{const a=null!=t?t:yield wc(this._authenticationService,this._logger,n);let s=Pr.Jt.getValue(Cc(a));if(!s){this._logger.log(`[regionGtm][${i}] No cached regionGtm, start network call..`),null==n||n.push("cache:0");const e=yield this._debouncedGetDiscoverResponse((0,U.u4)(a),{userIdentifier:a,correlationId:i,eventData:n});s=null==e?void 0:e.regionGtms,null==n||n.push(`InResponse:${!!s}`)}const o=null==s?void 0:s[e];if(o)return o===uc?o:(0,Os.m)(o);throw(0,nn.Tr)({correlationId:i,message:`${ec}[regionGtm][${i}] ${e} not found in regionGtms table`,isExpected:!0,context:ec,subContext:"regionGtm",errorCode:"RegionGtmNotFoundInRespone"})}catch(e){throw xc(e,"regionGtm",i),Dc(e,null==e?void 0:e.message,n,this._logger)}}))}skypeid(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=(0,$r.pW)(),i=["^fn:skypeid:uid:"+ +!!e];try{const i=yield this.getUser(t,e);if(!i){const e=`[skypeid][${t}] No userDetail for getting skypeId`;throw this._logger.error(e),new Error(`${ec} No user for getting skypeId`)}return i.id}catch(e){throw xc(e,"skypeid",t),Dc(e,null==e?void 0:e.message,i,this._logger)}}))}validateSkypeToken(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield this.validateSkypeTokenV2(e)).skypeToken}))}validateSkypeTokenV2(e){var t,i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const s=(0,$r.pW)(),o=["^fn:validateSkypeToken:uid:"+ +!!(null==e?void 0:e.userIdentifier)];try{const r=null!==(t=null==e?void 0:e.userIdentifier)&&void 0!==t?t:yield wc(this._authenticationService,this._logger,o),c=Pr.Jt.get(_c(r)),l=null==c?void 0:c.item;if(o.push(`cache:${!!l}`),l&&(yield function(e,t,i,a,s){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enableSkypeTokenEncryption:n,enableEncryptionKeyMaglev:o}=s.get(S.J.Auth);if(!n||!e.encryptedToken||e.skypeToken)return e;const r=i.newScenario(z.RG.AuthWebDecryptToken);r.mark("auth_web_decrypt_token_start");const c=yield(0,Wr.mM)(t,a,void 0,!!o);if(!c)return r.mark("auth_web_decrypt_token_stop",{reason:"Missing encryption key for decryption"}),r.stop(),e;let l=e.iv;if(l||(l=Pr.Jt.getValue(Or.Jl.initializationVector)),!l)return r.mark("auth_web_decrypt_token_stop",{reason:"Missing initialization vector for decryption"}),r.stop(),e;try{const i=(0,hc.k)(l),n=(0,hc.k)(e.encryptedToken),a=yield t.crypto.subtle.decrypt({name:"AES-CBC",iv:i},c,n);e.skypeToken=(new TextDecoder).decode(a),r.mark("auth_web_decrypt_token_stop"),r.stop()}catch(e){r.mark("auth_web_decrypt_token_stop",{error:e,reason:null==e?void 0:e.message},"failure"),r.fail()}return e}))}(l,this.globalScope,this._scenarioFactory,this._hostCommunicationService,this._coreSettings)),(null==r?void 0:r.accountType)===zo.Ch.Anonymous&&(null==l?void 0:l.skypeToken)&&!this._coreSettings.get(S.J.Auth).disableIgnoringForceRenewForAnon)return null===(i=this._authStateProvider)||void 0===i||i.reportSkypeTokenState(Lr.Q.Success),{skypeToken:l.skypeToken,fromCache:!0};const d=null==e?void 0:e.forceRenew,u=null==e?void 0:e.invalidSkypeToken;if(!d&&l&&l.skypeToken&&l.skypeToken!==u&&l.expiration&&l.expiration>Date.now())return this._isRefreshInBackgroundRequired(c,r,o,s),this._skypeToken.value||this._skypeToken.next(l.skypeToken),null===(a=this._authStateProvider)||void 0===a||a.reportSkypeTokenState(Lr.Q.Success),{skypeToken:l.skypeToken,fromCache:!0};this.clearDiscoveryCache(r,o,!0),this._logger.log(`[validateSkypeToken][${s}] Skype token not valid during ping of forceRenew:${d}, clear old cache and start wire request.`);const m=yield this._debouncedGetDiscoverResponse((0,U.u4)(r),{userIdentifier:r,correlationId:s,eventData:o});return this._logger.log(`[validateSkypeToken][${s}] SkypeToken fetched from network.`),o.push(`InResponse:${!!m.skypeToken}`),{skypeToken:m.skypeToken,fromCache:!1}}catch(e){throw xc(e,"validateSkypeToken",s),Dc(e,null==e?void 0:e.message,o,this._logger)}}))}getRegion(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=(0,$r.pW)(),i=["^fn:getRegion:uid:"+ +!!e];try{const n=null!=e?e:yield wc(this._authenticationService,this._logger,i),a=Pr.Jt.getValue(Tc(n));if(a)return a.region;i.push("cache:0"),this._logger.log(`[getRegion][${t}] No user details found in cache. Getting it from request.`);const s=yield this._debouncedGetDiscoverResponse((0,U.u4)(n),{userIdentifier:n,correlationId:t,eventData:i});return i.push(`InResponse:${!!s.region}`),s.region}catch(e){throw xc(e,"getRegion",t),Dc(e,null==e?void 0:e.message,i,this._logger)}}))}getUserRegionAndPartitionForMultiGeo(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=(0,$r.pW)(),i=["^fn:getUserRegionAndPartitionForMultiGeo:uid:"+ +!!e];try{const n=null!=e?e:yield wc(this._authenticationService,this._logger,i),a=Pr.Jt.getValue(Tc(n));if(a)return{userRegion:null==a?void 0:a.userRegion,partition:null==a?void 0:a.partition,userPartition:null==a?void 0:a.userPartition};i.push("cache:0"),this._logger.log(`[getUserRegionAndPartitionForMultiGeo][${t}] No user details found in cache. Getting it from request.`);const s=yield this._debouncedGetDiscoverResponse((0,U.u4)(n),{userIdentifier:n,correlationId:t,eventData:i});return i.push(`InResponse|userRegion:${!!s.userRegion}|partition:${!!s.partition}|userPartition:${!!s.userPartition}`),{userRegion:null==s?void 0:s.userRegion,partition:null==s?void 0:s.partition,userPartition:null==s?void 0:s.userPartition}}catch(e){throw xc(e,"userRegionAndPartition",t),Dc(e,null==e?void 0:e.message,i,this._logger)}}))}getUser(e=(0,$r.pW)(),t){var i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=["^fn:getUser:uid:"+ +!!t];try{const s=null!=t?t:yield wc(this._authenticationService,this._logger,n);let o=Pr.Jt.getValue(Tc(s));if(o||(this._logger.log(`[getUser][${e}]No cache, start network call...`),n.push("cache:0"),n.push(`IsCDL:${this.isCDLWorker&&this.cdlAuthClient}`),o=this.isCDLWorker&&this.cdlAuthClient?null===(i=yield this.cdlAuthClient.getUserDetails())||void 0===i?void 0:i.userDetails:((e,t,i)=>{if(e.push("fn:_getUserDetailFromHost"),!t)return void e.push("_bootstrapData:0");const{userId:n,region:a,licenseDetails:s,userRegion:o,partition:r,userPartition:c}=t;return n&&a&&s?{id:n,licenseDetails:s,region:a,userRegion:o,partition:r,userPartition:c}:(i.log(`[_getUserDetailFromHost] userId:${!!n}|region:${!!a}|licenseDetails:${!!s}|userRegionForMultiGeo:${!!o}|partition${!!r}|userPartition${!!c}`),void e.push(`userId:${!!n}|region:${!!a}|licenseDetails:${!!s}|userRegionForMultiGeo:${!!o}|partition${!!r}|userPartition${!!c}`))})(n,this._bootstrapData,this._logger)||(null===(a=yield this.getSkypeTokenInfoFromDiscoveryResponse({silent:!1,correlationId:e,userIdentifier:t,eventData:n}))||void 0===a?void 0:a.userDetails)),!o)throw new Error(`${ec}[getUser][${e}] UserDetails fetched failure from network request`);return(e=>{var t;const i=$c(e.licenseDetails);return Object.assign({id:e.id,region:e.region,userRegion:e.userRegion||void 0,partition:e.partition||void 0,userPartition:e.userPartition||void 0,tenant:{type:(null===(t=e.licenseDetails)||void 0===t?void 0:t.isFreemium)?Kr.OV.Freemium:Kr.OV.Work}},i)})(o)}catch(t){xc(t,"getUser",e);const i=Dc(t,null==t?void 0:t.message,n,this._logger);throw new Sl.l(i)}}))}getSkypeTokenInfoFromDiscoveryResponse(e){var t,i,a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{correlationId:n=(0,$r.pW)(),userIdentifier:o}=e||{},r=null!==(t=null==e?void 0:e.eventData)&&void 0!==t?t:[];null==r||r.push("fn:getSkypeTokenInfoFromDiscoveryResponse");try{const t=null!=o?o:yield wc(this._authenticationService,this._logger,r),c=null==e?void 0:e.forceRenew,l=Pr.Jt.get(_c(t));if((null==t?void 0:t.accountType)===zo.Ch.Anonymous&&(null===(i=null==l?void 0:l.item)||void 0===i?void 0:i.skypeToken)&&!this._coreSettings.get(S.J.Auth).disableIgnoringForceRenewForAnon)return null===(a=this._authStateProvider)||void 0===a||a.reportSkypeTokenState(Lr.Q.Success),l.item;let d;if(l&&l.item&&!c)this._isRefreshInBackgroundRequired(l,t,r,n),d=l.item;else{null==r||r.push("cache:0"),this._logger.log(`[getSkypeTokenInfoFromDiscoveryResponse][${n}] No response retrieved from cache.`),this.clearDiscoveryCache(t,r,!0);const i=yield this._debouncedGetDiscoverResponse((0,U.u4)(t),Object.assign(Object.assign({},e),{userIdentifier:t,eventData:r}));d=Ic(i,this._logger)}return null===(s=this._authStateProvider)||void 0===s||s.reportSkypeTokenState(Lr.Q.Success),d}catch(e){throw xc(e,"getSkypeTokenInfoFromDiscoveryResponse",n),Dc(e,null==e?void 0:e.message,r,this._logger)}}))}unsubscribeMtToken(){var e;null===(e=this._tokenObserver)||void 0===e||e.unsubscribe()}getConsumerLicenseDetails(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=(0,$r.pW)(),n=["^fn:getConsumerLicenseDetails:uid:"+ +!!e];try{const a=null!=e?e:yield wc(this._authenticationService,this._logger,n);if(!(a.accountType===zo.Ch.MsaLife))return this._logger.log(`[getConsumerLicenseDetails][${i}] User account type is not MsaLife.`),Promise.resolve(void 0);const s=Pr.Jt.getValue(Tc(a)),o=null===(t=null==s?void 0:s.licenseDetails)||void 0===t?void 0:t.consumerLicenseDetails;if(o)return o;n.push("cache:0"),this._logger.log(`[getConsumerLicenseDetails][${i}] No user license details found in cache. Getting it from request.`);const r=yield this._debouncedGetDiscoverResponse((0,U.u4)(a),{userIdentifier:a,correlationId:i,eventData:n});return n.push(`InResponse:${!!(null==r?void 0:r.consumerLicenseDetails)}`),null==r?void 0:r.consumerLicenseDetails}catch(e){throw xc(e,"getConsumerLicenseDetails",i),Dc(e,null==e?void 0:e.message,n,this._logger)}}))}_clearFromLocalStorage(e){var t;(null===(t=this.globalScope)||void 0===t?void 0:t.localStorage)&&(e?this._localStorageKeys.forEach((e=>{e.indexOf("auth.skype.token")>-1&&this.globalScope.localStorage.removeItem(e)})):this._localStorageKeys.forEach((e=>{this.globalScope.localStorage.removeItem(e)})),this._localStorageKeys=[])}resolveProvider(){return this._bootstrapData?this._acquireSkypeTokenDesktop:this.isCDLWorker?this._acquireSkypeTokenWorker:this._acquireSkypeTokenWeb}_getFromLocalStorage(e,t,i){var n;if(!(null===(n=this.globalScope)||void 0===n?void 0:n.localStorage))return;let a=`ts.${t}-${e}.${i}`,s=this.globalScope.localStorage.getItem(a);if(s||(a=`ts.${e}.${i}`,s=this.globalScope.localStorage.getItem(a)),s){this._localStorageKeys.push(a);try{return JSON.parse(s)}catch(e){this._logger.error(`[_getFromLocalStorage] ${e}`)}}}_getConfig(e){return this._coreSettings.get(S.J.Auth)[e]}}const Cl=(e,t,i,n,a,s,o,r,c,l,d,u,m,g,h,p)=>{const{enableRequireDiscoverV2:v}=n.get(S.J.Auth);return v?new jl(e,t,i,n,a,o,r,c,l,u,m,g,h,p):new ol(e,t,i,n,a,s,d,u,m,g,h,p)};var _l=i(306179);class Tl extends Ue{constructor(){super(h.Yg.CreateAuthMTMA,["appStateService","loggerFactory","scenarioFactory","networkState","coreSettings","authenticationService","authenticationUser","telemetryService","i18n","deeplinkService","userBiService","hostCommunicationService"])}execute(e){var t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{appStateService:n,loggerFactory:a,scenarioFactory:s,networkState:o,coreSettings:r,authenticationService:c,authenticationUser:l,telemetryService:d,i18n:u,deeplinkService:m,userBiService:g,hostCommunicationService:h}=e,{enableUserAuthT2:p}=r.get(S.J.Auth)||{};if(!p)return;(0,Ur.u)(null==l?void 0:l.id,g);const v=Il(l);try{if(!l)throw new Error("No AuthenticationUserContext found during User Auth init.");if(!c.createUserAuth)throw new Error("No User Auth Creation API exposed.");const i=new Br(a,r,l.id);e.authStateProvider=i,v.addEventData(["authState:created"]);const g=null===(t=c.createUserAuth)||void 0===t?void 0:t.call(c,l,"create-auth-mtma-task",i,m);e.authenticationService=g,v.addEventData(["userAuth:created"]);const p=(0,_l.Gg)(n);let f;if(r.get(S.J.Telemetry).useTelemetryServicesCache){f=d.getTelemetryServicesCache().get(l.id);const e=Pr.Jt.getValue((0,Or.VF)({id:l.id}).telemetryInfo);v.setUserToTelemetryContext({id:l.id,oid:l.profile.objectId,tid:l.profile.tenantId,type:l.type,role:l.role,subType:l.subType,isCrossCloudUser:!!(null==e?void 0:e.isCrossCloudUser),isExternalMember:(0,Rr.wm)(l.role,l.id,l.homeAccountId)})}const b=Cl(g,a,Dr.l,r,(null==f?void 0:f.coreScenarioFactory)||s,p,o,h,u,i,void 0,void 0,void 0,void 0,void 0);return e.discover=b,v.addEventData(["discover:created"]),b.validateSkypeToken(),r.get(S.J.Telemetry).useTelemetryServicesCache&&b.getRegion().then((e=>v.setUserDetailsToTelemetryContext({region:e||""}))),v.closeScenario(),e=>{var t;switch(e){case"quit":case"restart":break;default:null===(t=b.cleanup)||void 0===t||t.call(b),null==i||i.cleanupObservables()}}}catch(e){const t=e instanceof Sl.l?e:new Sl.l(e);throw v.closeScenario({error:null!==(i=t.prevError)&&void 0!==i?i:e}),t}}))}}const Il=e=>{const t={id:(0,$r.pW)(),scenarioName:z.RG.AuthUserInit,source:"create-auth-mtma-task::execute"};return Ur.cv.create({correlation:t,subContext:"createAuthMTMATask",timeoutMs:tn.rF.ONE_HOUR,scenarioEventData:{context:`id:${!!(null==e?void 0:e.id)}`,accountId:null==e?void 0:e.id}})},Nl="auth-cache",El="key",Fl=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return new Promise(((a,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{const n=yield Dl(e),o=xl(n,"readwrite",a,s),r=((e,t)=>({[El]:t,value:e}))(t,i),c=o.put(r);c.onerror=e=>{n.close(),s(`[putToIDB] error: ${e}`)},c.onsuccess=()=>{n.close(),a()}}catch(e){s(`[putToIDB][catch] error: ${e}`)}}))))})),xl=(e,t,i,n)=>{Al(e,n)||n("Transaction not valid");const a=e.transaction(Nl,t);return a.onerror=t=>{e.close(),n(t)},a.oncomplete=()=>{e.close(),i()},a.onabort=t=>{e.close(),n(t)},a.objectStore(Nl)},Dl=e=>new Promise(((t,i)=>{const n=e.open("Teams:auth",1);n.onsuccess=()=>{const e=n.result;t(e)},n.onerror=()=>{i(`IndexedDB error: ${n.error}`)},n.onblocked=()=>{i("IndexedDB error: BLOCKED")},n.onupgradeneeded=e=>{const t=n.result;if(!t.objectStoreNames.contains(Nl)||e.oldVersion<1){const e=t.createObjectStore(Nl,{keyPath:El});e&&!e.indexNames.contains("key")&&e.createIndex("key",El)}t.close()}})),Al=(e,t)=>e?!!e.objectStoreNames.contains(Nl)||(t(`objectStore does not exists: ${Nl}`),!1):(t("You need to use the openDatabase function to create a database before you query it!"),!1);class Ml{constructor(e){this._indexedDbStorage=e.indexedDB}put(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield Fl(this._indexedDbStorage,t,e)}))}getValue(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return new Promise(((i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{const n=yield Dl(e),s=xl(n,"readonly",i,a).get(t);s.onerror=e=>{n.close(),a(`[IndexDB][getFromIDB] error: ${e}`)},s.onsuccess=e=>{var t,a;n.close(),i(null===(a=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.result)||void 0===a?void 0:a.value)}}catch(e){a(`[getFromIDB][catch] error: ${e}`)}}))))})))(this._indexedDbStorage,e)}))}del(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return new Promise(((i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{const n=yield Dl(e),s=xl(n,"readwrite",i,a).delete(t);s.onsuccess=e=>{n.close(),i(null==e?void 0:e.target)},s.onerror=e=>{n.close(),a(`Error in deleteRequest: ${e}`)}}catch(e){a(`[deleteFromIDB][catch] error: ${e}`)}}))))})))(this._indexedDbStorage,e)}))}}var Pl=i(703793),Ol=i(59482),Rl=i(332507),Ll=i(451249);const Ul=(e,t,i)=>{var n;const{environment:a}=null!==(n=i.get(S.J.Metadata))&&void 0!==n?n:{},{clientType:s,currentUrl:o,hostingParent:r,isInIframe:c,isInCypressFrame:l,browser:d,browserVersion:u,osPlatform:m,osVersion:g}=t.config;return Object.assign(Object.assign({},e),{clientType:s,currentUrl:o,hostingParent:r,isInIframe:c,isInCypressFrame:l,browser:d,browserVersion:u,osPlatform:m,osVersion:g,environment:a})},$l=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){e.initializeAuthenticationService&&(yield e.initializeAuthenticationService())})),Wl=(e,t,i,n)=>{const a={id:(0,$r.pW)(),scenarioName:z.RG.AuthStart,source:"core-auth-tasks::init"};return Pr.Jt.put(Or.Jl.authSessionId,a.id),Ur.cv.create({correlation:a,subContext:"createAuthenticationServiceInstance",timeoutMs:tn.rF.ONE_HOUR,scenarioEventData:{context:`env:${e}||host:${t}||v2:${+!!i}||global:${+!!n}`}})},Bl=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n;null===(n=e.registerCleanUpOnLogoutCallback)||void 0===n||n.call(e,"BatchAuthTelemetry",(e=>(0,Ol.mM)(t,i,(0,Rr.Xx)(e))))}));class zl extends Ue{constructor(){super(h.Yg.CreateAuth,[])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){e.authenticationService=yield(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var t,n,a;const{loggerFactory:s,scenarioFactory:o,config:r,appStateService:c,coreSettings:l,windowProvider:d,platformService:u,authStateProvider:m,hostCommunicationService:g,telemetryService:h,i18n:p,rebootService:v,userBiService:f,endpointsManager:b,crossTabsService:y,networkState:k,hostState:w}=e,j=(0,Pr.ky)(d),C=new Ml(d),_=(0,Pl.N)(C);(0,Ur.Tu)(o,_,h),(0,wl.rt)(w,k),(0,Ur.u)(void 0,f);const T=(0,Ll.fZ)(s,y),I=Ul(r,u,l),N=(0,_l.Gg)(c),{enableAuthV2:E,enableUserAuthT2:F}=(null==l?void 0:l.get(S.J.Auth))||{},x=Wl(null!==(t=I.environment)&&void 0!==t?t:"",null===(n=null==d?void 0:d.location)||void 0===n?void 0:n.hostname,!!E,!!F);let D;try{D=E?F?new((yield(0,Rl.mT)((()=>Promise.all([i.e(825779),i.e(59938),i.e(608983)]).then(i.bind(i,280869))),"global-auth",o)).GlobalAuthService)(s,o,I,d,g,T,p,l,v,b):new((yield(0,Rl.mT)((()=>Promise.all([i.e(825779),i.e(59938),i.e(496106)]).then(i.bind(i,943470))),"auth_v2",o)).AuthenticationService)(s,o,I,d,g,T,p,m,l):new((yield(0,Rl.mT)((()=>Promise.all([i.e(511961),i.e(159818)]).then(i.bind(i,35901))),"auth",o)).AuthenticationService)(s,o,N,I,d,h,l,g),yield $l(D);const{enableAsyncBatchScenario:e}=(null==l?void 0:l.get(S.J.Auth))||{};e&&(yield Bl(D,o,_));const{deleteBatchScenarioFromStorage:t}=(null==l?void 0:l.get(S.J.Auth))||{};t&&(0,Ol.Q7)(j),x.closeScenario()}catch(e){const t=e instanceof Sl.l?e:new Sl.l(e);throw x.closeScenario({error:null!==(a=t.prevError)&&void 0!==a?a:e}),t}return D})))(e)}))}}var Hl=i(27149),ql=i(565697);const Vl=(e,t,i,n)=>{var a;if(null===(a=null==n?void 0:n.get(S.J.Auth))||void 0===a?void 0:a.enableMtoCoachMark){(null==t?void 0:t.some((e=>"DefaultHidden"===(null==e?void 0:e.userTenantState)&&"MTO"===(null==e?void 0:e.tenantRelationship))))&&(null==e||e.recordAuthUserBiTelemetry(i,{scenario:Hl.dX.authMtoUser}))}(null==t?void 0:t.some((e=>"MTO"===(null==e?void 0:e.tenantRelationship))))&&(null==e||e.recordAuthUserBiTelemetry(i,{scenario:Hl.dX.authHasMtoTenant}))},Gl=(e,t)=>Ur.cv.create({correlation:e,subContext:"createAuthTenantsTask",timeoutMs:tn.rF.ONE_HOUR,scenarioEventData:{accountId:null==t?void 0:t.id}});class Jl extends Ue{constructor(){super(h.Yg.CreateAuthTenants,[])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=e;yield(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{coreSettings:i,authenticationUser:n,endpointsManager:a,authenticationService:s}=e,{enableUserAuthT2:o,enableMultiTenants:r}=i.get(S.J.Auth)||{};if(!n)throw new Error("No AuthenticationUserContext found during OnUserAuthenticated_MTMA hook");const{testAutomation:c}=i.get(S.J.Test)||{};if(!o||!r||!(0,ql.Kf)(n))return;const l={id:(0,$r.pW)(),scenarioName:z.RG.AuthWebSetUpTenants,source:"create-auth-tenants-task::setupTenantService"},d=Gl(l,n);try{if(!s.setUpTenantsService||!s.getTenants)throw new Error("No TenantsService Set Up found duringGetTenants Task");const e={accountId:n.id,correlation:d.correlation,forceRefresh:!c};try{yield s.setUpTenantsService(a,e)}catch(e){return void d.closeScenario({error:e})}d.addEventData(["tenantService:created"]),s.getTenants(e).then((e=>{d.appendScenarioEventData({tenantCount:null==e?void 0:e.length}),Vl(d,e,n.id,i),d.closeScenario()})).catch((e=>{d.closeScenario({error:e})}))}catch(e){const i=e instanceof Sl.l?e:new Sl.l(e);throw d.closeScenario({error:null!==(t=i.prevError)&&void 0!==t?t:e}),i}})))(t);const{enableTenantPolling:i}=t.coreSettings.get(S.J.Auth);if(!i)return;const a=yield(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{coreSettings:i,authenticationService:a,windowProvider:s,authenticationUser:o,correlation:r}=e;if(!o)throw new Error("No AuthenticationUserContext found during OnUserAuthenticated_MTMA hook");if(o.homeAccountId!==o.id||!(0,ql.Kf)(o))return;const c=(null===(t=i.get(S.J.Auth))||void 0===t?void 0:t.tenantPollingMiliseconds)||tn.rF.ONE_DAY,l=s.setInterval((()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const e={id:r.id,scenarioName:z.RG.AuthWebGetTenantsInterval,source:"create-auth-tenants-task::tenantPollingInterval"},t=Gl(e,o);try{const n={accountId:o.id,forceRefresh:!0,correlation:e};if(!a.getTenants)throw new Error("No valid getTenants function inside tenant polling interval");const s=yield a.getTenants(n);Vl(t,s,o.id,i),t.addEventData(["tenantService:AuthWebTenantPolling"]),t.appendScenarioEventData({tenantCount:null==s?void 0:s.length}),t.closeScenario()}catch(e){t.closeScenario({error:e}),s.clearInterval(l)}}))),c);return Promise.resolve(l)})))(t);return e=>{a&&"signout"===e&&t.windowProvider.clearInterval(a)}}))}}var Kl=i(462410),Ql=i(747741);class Yl{constructor(e,t,i){this.aad=e,this.discover=t,this.coreSettings=i,this.cmdMTAuthResource=e=>this._cmdMtAuthorize(e),this.mtAuthResource=e=>{const{requireSkypetokenForMT:t}=this.coreSettings.get(S.J.Auth);return this._mtAuthorize(e,t||!1)},this.skypeAuthResource=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return this._authorizeWithSkypeTokenMigration(e)})),this.skypeAuthorizeAuthResource=e=>this._authorizeWithSkypeTokenMigration(e,"Authorization"),this.skypeXTokenAuthResource=e=>this._authorizeWithSkypeTokenMigration(e,"x-skypetoken"),this.mtAuthWithSkypeXTokenResource=e=>this._mtAuthorize(e,!0),this.authorizeByUrl=(e,t)=>{const i=new URL(e.url),n=t?"/":"",a=`${i.protocol}//${i.host}${n}`;return this.aad.authorizeRequest(e,a)},this._migrateSkypeToken=(e,t,i)=>{e.headers&&(e.headers[tn.kI]="True");const n=t===gc.Zw.CAE?tn.ej.IC3_GATEWAY_CAE_KEY:tn.ej.IC3_GATEWAY_AAD_KEY,a=this._composeAuthResourcesForStm((e=>this.aad.authorizeRequest(e,n)),i);return a(e)},this._cmdMtAuthorize=e=>this.aad.getUser().then((()=>{const{cmdMeetingArtifactsServiceResource:t}=this.coreSettings.get(S.J.CMDMeetingArtifactsService);return(e=>this.aad.authorizeRequest(e,null!=t?t:""))(e)})),this._mtAuthorize=(e,t)=>this.aad.getUser().then((()=>{const{enableSkypeTokenMigrationForMT:i}=this.coreSettings.get(S.J.Auth);if(i&&t){const{stmHeader:i,overwrittenRequireSkypetokenForMT:n}=this._getStmInfoForSources(e);t=n,e.headers=Object.assign(Object.assign({},e.headers),i)}const n=Rc(this.coreSettings),a=e=>this.aad.authorizeRequest(e,n);return(t?this.composeAuthResources(a,this.skypeXTokenAuthResource):a)(e)})),this._getStmInfoForSources=e=>{const{stmSourceList:t=[]}=this.coreSettings.get(S.J.Auth),i=e.authOptions||{},n={stmHeader:{},overwrittenRequireSkypetokenForMT:!0},a=null==t?void 0:t.find((e=>(null==e?void 0:e.source)===(null==i?void 0:i.source)));return a?(n.stmHeader={[tn.kI]:"True"},(null==a?void 0:a.disableSkypeTokenInHeader)&&(n.overwrittenRequireSkypetokenForMT=!1),n):n},this.skype=new Kl.q(this.discover)}composeAuthResources(e,t){return i=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return e(i).then((e=>t(e.request).then((t=>({request:t.request,resolver:(i,a)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield t.resolver(i,a);return yield e.resolver(i,n||a)}))})))))}))}_authorizeWithSkypeTokenMigration(e,t){const{skypeTokenMigrationEnabled:i}=this.coreSettings.get(S.J.Auth);return i?this.aad.getUser().then((i=>{const n=e.authOptions||{};let a=(null==n?void 0:n.source)?(0,Ql.xT)(null==n?void 0:n.source,this.coreSettings,void 0,i):gc.Zw.Skype;const{disableSTMFallback:s}=this.coreSettings.get(S.J.Auth),{skypeTokenFallbackMap:o}=this.aad;if(!s&&(null==n?void 0:n.source)&&o){const e=(0,Ql.eH)(o,null==n?void 0:n.source,this.coreSettings);void 0!==e&&(a=(0,Ql.JX)([e],a))}return(null==n?void 0:n.source)&&a!==gc.Zw.Skype?this._migrateSkypeToken(e,a,t):this.skype.authorizeRequest(e,t)})).catch((()=>{const{disableSTMFallback:i}=this.coreSettings.get(S.J.Auth);if(i)throw(0,nn.Tr)({context:"authentication-resources",subContext:"disableSTMFallback",errorCode:tn.SM.InvalidToken,message:"disableSTMFallback: true, STM fallback logic blocked",correlationId:"",isExpected:!0});return this.skype.authorizeRequest(e,t)})):this.skype.authorizeRequest(e,t)}_composeAuthResourcesForStm(e,t){return i=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return e(i).then((e=>({request:e.request,resolver:(i,a)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){try{return yield e.resolver(i,a)}catch(e){if((null==e?void 0:e.errorCode)===tn.SM.FallbackWithSkypeToken){(null==a?void 0:a.headers)&&delete a.headers.Authorization;return(yield this.skype.authorizeRequest(a,t)).request}throw e}}))})))}))}}class Xl extends Ue{constructor(){super(h.Yg.CreateAuthenticationResources,["authenticationService","discover","coreSettings"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){e.authenticationResources=new Yl(e.authenticationService,e.discover,e.coreSettings)}))}}class Zl extends Ue{constructor(){super(h.Yg.CreateAuthStateTask,["loggerFactory","coreSettings","telemetryService"]),this._updateTelemetryOnClientStateChange=(e,t)=>{e.observe().subscribe((e=>{t.setCoreContext("AppInfo.AuthState",e)}))}}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t,coreSettings:i,telemetryService:n}=e,{enableAuthState:a,enableUserAuthT2:s}=i.get(S.J.Auth);if(!a||s)return;const o=new Br(t,i);e.authStateProvider=o,this._updateTelemetryOnClientStateChange(o,n)}))}}class ed extends Ue{constructor(){super(h.Yg.CreateCacheClearing,["clientState","windowProvider"]),this._clearCacheOnClientStateChangeToInactive=(e,t)=>{e.observe().subscribe((e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var i;e===$e.pk.Inactive&&(yield null===(i=this.dataEvictionService)||void 0===i?void 0:i.evict(),t.clearCache())}))))}}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{clientState:t,windowProvider:i,dataEvictionService:n}=e;this.dataEvictionService=n,this._clearCacheOnClientStateChangeToInactive(t,i)}))}}class td{constructor(e,t,i,n){this._caches=e,this._tenantId=t,this._userId=i,this._experienceName=n}setUserAndTenantIds(e,t){this._tenantId=e,this._userId=t}createRequest(e,t,i,n,a=!1,s=this._experienceName){const o=this._getFormatKey(t,s,i,a);return{cacheName:e,request:new Request(o,n)}}add({cacheName:e,request:t}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield this._caches.open(e)).add(t)}))}addAll(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{cacheName:t}=e[0],i=e.map((({request:e})=>e));return(yield this._caches.open(t)).addAll(i)}))}delete({request:e,cacheName:t},i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield this._caches.open(t)).delete(e,i)}))}keys(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield this._caches.open(e)).keys(t,i)}))}match({request:e,cacheName:t},i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield this._caches.open(t)).match(e,i)}))}matchAll({request:e,cacheName:t},i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield this._caches.open(t)).matchAll(e,i)}))}put({request:e,cacheName:t},i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield this._caches.open(t)).put(e,i)}))}clear(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this._caches.delete(e)}))}_getFormatKey(e,t,i,n){try{return new URL(e),e}catch(a){let s="";switch(i){case"Experience":s=`${t}/${e}`;break;case"User":if(!this._tenantId||!this._userId)throw new Error("tenantId and userId must be defined for storage scope User.");s=`${this._tenantId}/${this._userId}/${e}`;break;case"Global":s=e;break;case"UserAndExperience":if(!this._tenantId||!this._userId)throw new Error("tenantId and userId must be defined for storage scope UserAndExperience.");s=`${this._tenantId}/${this._userId}/${this._experienceName}/${e}`;break;default:return`/${e}`}return n?`//${s}`:s}}}class id{constructor(e,t){this._cacheStorage=e,this._cacheName="offline-cache-manager",this._logger=t.newLogger("OfflineCacheManager","services-io-browser-cache-storage")}setUserAndTenantIds(e,t){this._cacheStorage.setUserAndTenantIds(e,t)}save(e,t,i,a=!0){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!e)throw this._error("get","Invalid key");try{this._logger.log(`saving item to offline cache: ${e}`);const n=this._getScopedRequest(e,i,a);return yield this._cacheStorage.put(n,t),n.request.url}catch(e){throw e instanceof DOMException&&this._logger.error(`DOMException name:${e.name}, message${e.message}`),this._error("save","Failed to save object to cache")}}))}saveDynamic(e,t,i=!0){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=(0,qe.v4)();return[n,yield this.save(n,e,t,i)]}))}get(e,t,i,a=!0){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!e)throw this._error("get","Invalid key");try{const i=this._getScopedRequest(e,t,a),n=yield this._cacheStorage.match(i);if(!n)throw this._error("get","Object not found");return n}catch(e){throw e instanceof DOMException&&this._logger.error(`DOMException name:${e.name}, message${e.message}`),this._error("get","Failed to get item from cache")}}))}getAll(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{return yield this._cacheStorage.keys(this._cacheName,e?this._getScopedRequest(e,t).request:void 0,i)}catch(e){throw e instanceof DOMException&&this._logger.error(`DOMException name:${e.name} code:${e.code}`),this._error("getAll","Failed to get keys from cache")}}))}delete(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!e)throw this._error("get","Invalid key");this._logger.log(`deleting item from offline cache: ${e}`);const i=this._getScopedRequest(e,t);return this._cacheStorage.delete(i)}))}clear(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this._logger.log("clearing offline cache"),this._cacheStorage.clear(this._cacheName)}))}getCachedUrlByKey(e,t){return this._getScopedRequest(e,t).request.url}_error(e,t){const i=(0,oe.Tr)("OfflineCacheManager",h.jK.Undefined,e,void 0,t);return this._logger.error(i.message),i}_getScopedRequest(e,t,i=!0){return this._cacheStorage.createRequest(this._cacheName,`${this._cacheName}/${e}`,"UserAndExperience",t,i)}}class nd extends Ue{constructor(){super(h.Yg.CreateCacheStorageAndCacheManagers,[])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,windowProvider:i,config:n,loggerFactory:a}=e;t&&(e.cacheStorage=new td(i.caches,t.profile.tenantId,t.profile.objectId,n.experienceName)),e.cacheStorage&&(e.offlineCacheManager=new id(e.cacheStorage,a))}))}}var ad=i(32783),sd=i(845279);class od{constructor(e){this.context=e,this._appServiceStateMap=this._newAppServiceStateMap(),this._logger=e.loggerFactory.newLogger("CDLApplicationStateService","core-services-app-state")}notifyServiceUp(e,t,i){this.notifyAppServiceStateChange(e,t,sd.l.ONLINE,i)}notifyServiceDown(e,t,i,n){this.notifyAppServiceStateChange(e,t,sd.l.OFFLINE,i,n)}observeAppServiceState(){const e=Array.from(Object.values(this._appServiceStateMap)).map((e=>e.asObservable().pipe((0,xt.g)("currentState"))));return(0,ad.T)(...e)}_newAppServiceStateMap(){return Object.values(sd.Q).reduce(((e,t)=>{var i;return e[t]=(i=t,new s.X({appService:i,currentState:sd.l.UNKNOWN})),e}),{})}notifyAppServiceStateChange(e,t,i,n,a){var s,o,r,c,l;if(!!this.context.coreSettings.get(S.J.CdlWorker).enableUserContextWorkerRegistration&&(null===(s=this.context.cdlWorkerRegistrarService)||void 0===s?void 0:s.mainWindowWorkerId)!==e.workerId)return void(null===(r=(o=this._logger).infoToTelemetry)||void 0===r||r.call(o,`Filtered out appService state changed from worker (originating worker = ${e.workerId}, main window worker id = ${this.context.cdlWorkerRegistrarService.mainWindowWorkerId})`,"cdl_app_state_notification_filtered_out",{origin:e.workerId,target:this.context.cdlWorkerRegistrarService.mainWindowWorkerId,context:t},!0));const d=this._appServiceStateMap[t],u={appService:t,previousState:d.getValue().currentState,currentState:i,currentStateChangeTimestamp:new Date,currentStateChangeReason:n,currentStateChangeCode:a};null===(l=(c=this._logger).infoToTelemetry)||void 0===l||l.call(c,`Received appService state change for ${t} (current state = ${u.currentState}, previous state = ${u.previousState}) from worker '${e.workerId}'`,"cdl_app_state_change_notification",{origin:e.workerId,target:this.context.cdlWorkerRegistrarService.mainWindowWorkerId,context:t},!0),d.next(u)}}class rd{constructor(e){this.logger=e}log(e,t){return e?this.safeWrapILoggerCall(((e,t)=>this.logger.log(e,t)),e,t):X.V.None}warn(e,t){return e?this.safeWrapILoggerCall(((e,t)=>this.logger.warn(e,t)),e,t):X.V.None}debug(e,t){return this.safeWrapILoggerCall(((e,t)=>this.logger.debug(e,t)),e,t)}error(e,t,i){return e&&i?this.safeWrapILoggerCall(((e,t)=>this.logger.error(e,t)),e,t,i):X.V.None}errorToTelemetry(e,t,i,n){return this.logger.errorToTelemetry?this.logger.errorToTelemetry(e,t,i,n):this.logger.error(e)}warnToTelemetry(e,t,i,n){return this.logger.warnToTelemetry?this.logger.warnToTelemetry(e,t,i,n):this.logger.warn(e)}debugToTelemetry(e,t,i,n){return this.logger.debugToTelemetry?this.logger.debugToTelemetry(e,t,i,n):this.logger.debug(e)}infoToTelemetry(e,t,i,n){return this.logger.infoToTelemetry?this.logger.infoToTelemetry(e,t,i,n):this.logger.log(e)}safeWrapILoggerCall(e,t,i,n){return function(e){return(0,B.isObject)(e)&&"hostRendererId"in e&&"component"in e}(i)?e(this.serializeMessageFromParams(t,i,n),{loggerName:i.component}):e(t,{loggerName:"CDLNoLoggingContext"})}serializeMessageFromParams(e,t,i){const n=Object.assign(Object.assign(Object.assign(Object.assign({},i?{errorCode:i}:{}),t?{requestId:t.requestId,component:t.component,requestRendererId:t.requestRendererId,requestWindowId:t.requestWindowId,operationType:t.operationType,operationName:t.operationName,requestType:t.requestType,timeOfRequest:t.timeOfRequest,correlationId:t.correlationId,callerInfo:t.callerInfo,callerScenarioId:t.callerScenarioId}:{}),{message:e}),t);return JSON.stringify(n,void 0,"").replace(/\\|"/g,"")}}const cd=(e,t,i,n,a,s,o,r,c,l,d,u,m,g=!1,h)=>{let p={};if(e&&(p={experienceName:e}),t&&(p=Object.assign(Object.assign({},p),{ring:t})),i&&(p=Object.assign(Object.assign({},p),{environment:i})),n&&(p=Object.assign(Object.assign({},p),{sessionId:n})),a&&(p=Object.assign(Object.assign({},p),{platformId:a})),s&&(p=Object.assign(Object.assign({},p),{buildVersion:s})),o&&(p=Object.assign(Object.assign({},p),{localeCode:o})),r&&(p=Object.assign(Object.assign({},p),{workerId:r})),c&&(p=Object.assign(Object.assign({},p),{preAuthUserId:c})),u&&(p=Object.assign(Object.assign({},p),{publicPath:u})),void 0!==d?p=Object.assign(Object.assign({},p),{userConsoleLogLevel:d}):void 0!==l&&(p=Object.assign(Object.assign({},p),{preECSConsoleLogLevel:l})),m&&(p=Object.assign(Object.assign({},p),{deviceId:m})),g){const e=new Date(Date.now());p=Object.assign(Object.assign({},p),{date:`${e.getMonth()}-${e.getDate()}`})}return h&&(p=Object.assign(Object.assign({},p),{telemetryWorkerBroadcast:h})),JSON.stringify(p)};let ld;const dd=(e,t,i,n,a)=>class{constructor(s){const o=n?`${s}#${n}`:s,r=typeof e==typeof Worker?"cdlWorker":"cdlsharedWorker";ud(t,o,!1,r,i),null==a||a(o);const c=((e,t)=>{var i,n;if(ld)return ld;try{return ld=null===(i=window.trustedTypes)||void 0===i?void 0:i.createPolicy("@msteams/core-cdl-worker-common#create-cdl-worker",{createScriptURL:e=>md(e,t)}),ld}catch(i){null===(n=t.errorToTelemetry)||void 0===n||n.call(t,`Create CDL worker URL trustedType policy failed. This is not a critical error, falling back to function validation. Error ${i}`,"cdl_worker_startup_error_trusted_policy",{endpointUrl:e},!0)}})(o,t);if(c){const t=c.createScriptURL(o);return new e(t)}const l=md(o,t);return new e(l)}},ud=(e,t,i,n,a)=>{e.log(`{"hostRendererId":${n},"component":${a} Creating CDL Worker with ${i?"passed":"determined"} url ${t} }`)};function md(e,t){var i;try{const t=new URL(e,gd().location.origin);let i=!0,n="CDL Web worker URL is invalid.";if(t.origin!==gd().location.origin&&(n=n.concat("OriginValidationFailed"),i=!1),i)return e;throw new Error(n)}catch(n){throw null===(i=t.errorToTelemetry)||void 0===i||i.call(t,"CDL web worker url is not valid","cdl_worker_startup_error_invalid_url",{endpointUrl:e},!0),(0,oe.Tr)(n.message,h.jK.InvalidUrl,"",void 0)}}function gd(){return window}var hd=i(219667);class pd{constructor(e,t){this.logger=e,this.loggingContext=t,this.isCompleted=!1,this.subscriptions=new Set,this.observable$=new hd((e=>(this.subscriptions.add(e),()=>{this.subscriptions.has(e)&&this.subscriptions.delete(e)})))}get observable(){return this.observable$}subscribe(e){return this.isCompleted&&this.logger.error("Subject - tried to subscribe to a complete observable",this.loggingContext,h.jK.NotPresent),this.observable$.subscribe(e)}onNext(e){this.subscriptions.forEach((t=>{t.next(e)}))}onComplete(){this.isCompleted=!0,this.subscriptions.forEach((e=>{e.closed||e.complete()}))}onError(e){this.isCompleted=!0,this.subscriptions.forEach((t=>{t.error(e)}))}}class vd{constructor(e){this._state=null,this._checkpoints=new Set,this._context={bootstrapServices:e.bootstrapServices,loggingContext:{hostRendererId:e.loggingContext.hostRendererId,component:"CDLGlobalState"}},this.subject=new pd(e.bootstrapServices.logger,this._context.loggingContext)}get current(){return this._state}setState(e,t){if(!e)throw new TypeError("state should have name specified");this.hasReachedCheckpoint(e)||(this._context.bootstrapServices.logger.log(`Global state has reached checkpoint ${e}`,this._context.loggingContext),this._checkpoints.add(e),this._state=e,this.subject.onNext({newState:e,args:t}))}subscribe(e){return this.subject.subscribe(e)}hasReachedCheckpoint(e){if(!e)throw new TypeError("state should have name specified");return this._checkpoints.has(e)}}var fd=i(587592),bd=i(194232);class yd{constructor(e,t,i,n){var a;this._context=n,this._clients=new Map,t.forEach(((t,a)=>{const s=new t((t=>e(t)),i,n,a);this._clients.set(a,s)})),null===(a=n.bootstrapServices.workerCacheManager)||void 0===a||a.saveWorkerStatusToCacheStorage({state:"Success",stepName:"ClientResponseRouterCreated"})}get cdlControlClient(){return this._clients.get(fd.k.control)}get cdlDiagnosticsClient(){return this._clients.get(fd.k.diagnostics)}get cdlAuthClient(){return this._clients.get(fd.k.auth)}get cdlAppServiceClient(){return this._clients.get(fd.k.appService)}get cdlAppStateClient(){return this._clients.get(fd.k.appState)}get cdlDatabaseClient(){return this._clients.get(fd.k.database)}get cdlSyncEngineClient(){return this._clients.get(fd.k.syncEngine)}get cdlGraphQLClient(){return this._clients.get(fd.k.graphql)}get cdlNetworkStateClient(){return this._clients.get(fd.k.networkState)}get cdlEndpointsHealthClient(){return this._clients.get(fd.k.endpointHealth)}get telemetryClient(){return this._clients.get(fd.k.telemetry)}handleResponse(e){var t,i;const n=this._clients.get(e.type);if(!n)throw null===(i=(t=this._context.bootstrapServices.logger).errorToTelemetry)||void 0===i||i.call(t,`no client is configured for response type ${e.type}`,"cdl_client_no_client_configured_error",Object.assign(Object.assign({},(0,bd.n)(this._context.loggingContext)),{queryId:e.requestId,windowId:e.windowId,origin:"CDLClientResponseRouter",errorCode:h.jK.Unknown}),!0),new TypeError(`no client is configured for response type ${e.type}`);return n.handleResponse(e)}cleanup(){this._clients.forEach((e=>{Object.keys(e).forEach((t=>e[t]=void 0))})),Object.keys(this).forEach((e=>this[e]=void 0))}}class kd{constructor(e,t,i,n){var a;this._bootstrapServices=e,this._stateAndRequestHandlers=n,this._globalState=i,this._context={component:"CDLServer",hostRendererId:t},this._bootstrapServices.logger.log("Booted up server",this._context),null===(a=this._bootstrapServices.workerCacheManager)||void 0===a||a.saveWorkerStatusToCacheStorage({state:"Success",stepName:"CDLServerCreated"})}handleRequest(e,t,i){const n=performance.now(),a=this._stateAndRequestHandlers.get(e.type);return a?a.stateMachine.isCompleted().then((s=>{const o=performance.now(),r={requestStartTime:n,stateMachineTime:o-n};return this._handleMessage(e,t,a.requestHandler,r,i,s).catch((t=>{var i,n;!!(0,oe.Wc)(t)||null===(n=(i=this._bootstrapServices.logger).errorToTelemetry)||void 0===n||n.call(i,`Failed to process request due to error ${(0,oe.VK)(t)}`,"cdl_server",Object.assign(Object.assign({},(0,bd.n)(this._context)),{origin:e.requestId,correlationId:e.rendererId,conversationId:e.windowId,type:e.type}),!0)}))})).catch((i=>this._returnCriticalError(e,t,`State machine init failed for request of type ${e.type} with error ${(0,oe.VK)(i)}`,i))):this._returnCriticalError(e,t,`StateMachine and requestHandler not defined for request of type ${e.type}`)}start(){this._globalState.setState("Server_Start")}cleanup(){this._stateAndRequestHandlers.forEach((e=>{Object.keys(e).forEach((t=>e[t]=void 0))})),Object.keys(this).forEach((e=>this[e]=void 0))}_handleMessage(e,t,i,n,a,s){const o=this._decorateResponseCallback(e,t,n);return i.handle(e,o,{bootstrapServices:this._bootstrapServices,loggingContext:{hostRendererId:this._context.hostRendererId,requestId:e.requestId,requestRendererId:e.rendererId,requestWindowId:e.windowId,requestType:e.type},portId:a},s)}_decorateResponseCallback(e,t,i){return n=>{const a=performance.now()-i.requestStartTime,s=a-i.stateMachineTime;if(i=Object.assign(Object.assign({},i),{handlerResponseTime:s}),"graphql"===e.type){const i=n.response;i.extensions=Object.assign({},i.extensions),i.extensions.perfStats=Object.assign(Object.assign({},i.extensions.perfStats),{workerResponseTime:a,dataStorePerfStats:[]}),t(Object.assign({requestId:e.requestId,rendererId:e.rendererId,windowId:e.windowId,type:e.type,extensions:i.extensions},n))}else t(Object.assign(Object.assign(Object.assign({requestId:e.requestId,rendererId:e.rendererId,windowId:e.windowId,type:e.type},n),i),{extensions:{},workerResponseTime:a}))}}_returnCriticalError(e,t,i,n){return Promise.reject(t({windowId:e.windowId,requestId:e.requestId,type:e.type,response:{errors:i,errorCode:(null==n?void 0:n.errorCode)||(null==n?void 0:n.code),error:n},status:"failure",rendererId:e.rendererId,extensions:{},workerResponseTime:-1}))}}function Sd(e,t,i,n){var a,s;null===(a=e.workerCacheManager)||void 0===a||a.saveWorkerStatusToCacheStorage({state:"InProgress",stepName:"CDLPeerCreated"});const o=new yd((e=>t.postMessageCallback(JSON.stringify(e))),t.clients,{rendererId:n},{bootstrapServices:e,loggingContext:{hostRendererId:n}}),r=new kd(e,n,i.globalState,i.requestAndStateHandlers);return null===(s=e.workerCacheManager)||void 0===s||s.saveWorkerStatusToCacheStorage({state:"Success",stepName:"CDLPeerCreated"}),{workerServer:r,workerClientResponseRouter:o,onMessageCallback:(t,i,a)=>{var s,c,l,d,u,m;const g=Date.now(),h=t.data&&JSON.parse(t.data);if(h&&h.rendererId===n){const e=null===(c=null===(s=h.response)||void 0===s?void 0:s.extensions)||void 0===c?void 0:c.perfStats;e&&(e.payloadLength=t.data.length),o.handleResponse(h)}else h&&h.status?null===(d=(l=e.logger).errorToTelemetry)||void 0===d||d.call(l,`Received response with rendererId mismatch ${JSON.stringify(t)}`,"cdl_peer_creation",{origin:"CDLPeer",correlationId:n},!0):h?r.handleRequest(h,(e=>(e=>{var t;const n=Date.now();if("graphql"===e.type){const i=e.response;(null===(t=i.extensions)||void 0===t?void 0:t.perfStats)&&(i.extensions.perfStats.requestReceivedTime=g,i.extensions.perfStats.responseSendTime=n),e.extensions.perfStats&&(e.extensions.perfStats.requestReceivedTime=g,e.extensions.perfStats.responseSendTime=n)}else e.requestReceivedTime=g,e.responseSendTime=n;i(JSON.stringify(e))})(e)),a):null===(m=(u=e.logger).errorToTelemetry)||void 0===m||m.call(u,`Unknown message received that doesn't conform to CDL format ${JSON.stringify(t)}`,"cdl_peer_creation",{origin:"CDLPeer",correlationId:n},!0)}}}var wd=i(507829);class jd{constructor(){this.isSubscriptionRequest=e=>e instanceof pd,this._rendererRequestMap=new Map}addRequest(e,t){if(!e.rendererId)throw new TypeError("No rendererId in request");if(!e.requestId)throw new TypeError("No requestId in request");const i=this.getRequestRegistrationKey(e);let n=this._rendererRequestMap.get(i);if(n||(n=new Map,this._rendererRequestMap.set(i,n)),n.has(e.requestId))throw new Error(`Request ${e.requestId} for renderer ${i} already exists, something is off here`);if(t&&this.isSubscriptionRequest(t))return n.set(e.requestId,{resolution:t,request:e}),Promise.resolve(void 0);const a=(0,wd.P)();return n.set(e.requestId,{resolution:a,request:e}),a.promise}reconcileResponse(e){if(!e.rendererId)throw new TypeError("No rendererId in response");if(!e.requestId)throw new TypeError("No requestId in response");const t=this.getRequestRegistrationKey(e);if(!this._rendererRequestMap.has(t))throw new Error(`Response ${t} is not found in map`);const i=this._rendererRequestMap.get(t);if(!i)throw new Error(`Request map for renderer/window ${t} does not exist`);const n=i.get(e.requestId);if(!n)throw new Error(`Request ${e.requestId} for renderer/window ${t} does not exist`);"success"===e.status?this.handleSuccessResponse(e,n):this.handleErrorResponse(e,n),this.isSubscriptionRequest(n.resolution)&&"failure"!==e.status||i.delete(e.requestId),0===i.size&&this._rendererRequestMap.delete(t)}handleSuccessResponse(e,t){this.isSubscriptionRequest(t.resolution)?t.resolution.onNext(e):t.resolution.resolve(e)}handleErrorResponse(e,t){this.isSubscriptionRequest(t.resolution)?t.resolution.onError(e):t.resolution.reject(e)}getRequestRegistrationKey(e){return`${e.rendererId}${e.windowId?`_${e.windowId}`:""}`}}class Cd{constructor(e){this.requestType=e,this.counter=0}toString(){return`${this.getOperationPrefix(this.currentCounterRequestType)||this.requestType}-${this.counter}`}next(e){return this.safeIncrementCounter(),this.currentCounterRequestType=e,this.toString()}getOperationPrefix(e){switch(e){case"mutation":return"m";case"subscription":return"s";case"query":return"q";default:return e}}safeIncrementCounter(){return this.counter===Cd.MAX_COUNTER_VALUE&&(this.counter=0),this.counter++}}Cd.MAX_COUNTER_VALUE=Number.MAX_SAFE_INTEGER;class _d{constructor(e,{rendererId:t,windowId:i},n,a){this._context=n,this._loggingContext={component:"CDLClient",hostRendererId:t,requestWindowId:i},this._rendererId=t,this._windowId=i,this._clientRequestType=a,this._postMessage=t=>e(t),this._requestRegistrar=new jd,this.requestId=new Cd(a)}sendRequest(e,t){const i={rendererId:this._rendererId,windowId:this._windowId,requestId:this.requestId.next(),type:this._clientRequestType,payload:e},n=this._requestRegistrar.addRequest(i,t);return this._postMessage(i),n}handleResponse(e){return new Promise(((t,i)=>{var n,a;try{this._requestRegistrar.reconcileResponse(e),t()}catch(t){null===(a=(n=this._context.bootstrapServices.logger).errorToTelemetry)||void 0===a||a.call(n,`Error occurred on reconciling response ${t}`,"cdl_client_response_error",Object.assign(Object.assign({},(0,bd.n)(this._loggingContext)),{correlationId:e.requestId,windowId:e.windowId,errorCode:h.jK.Unknown}),!0),i(t)}}))}}const Td="MainRenderer",Id="GQL_STOP";class Nd extends _d{constructor(e,{rendererId:t,windowId:i},n,a){super(e,{rendererId:t,windowId:i},n,a)}sendFilteredAppStateRequest(e){const t=e.context.appState;return this._rendererId===Td&&(e.context.appState=this.filterWorkerAppState(t)),super.sendRequest(e)}filterWorkerAppState(e){return e}}class Ed{constructor(){this.onResponseReceived=e=>{if(this.onMessage){const t=this.transformLegacyClientFields(e.payload.dataLayer);this.onMessage(t)}}}transformLegacyClientFields(e){return e.error&&(e.errors=e.error),e.extensions||(e.extensions={}),e.perfStats&&(e.extensions.perfStats=e.perfStats),e}}class Fd extends Ed{constructor(e,{rendererId:t,windowId:i},n,a){super(),this._context=n,this._loggingContext={hostRendererId:t,component:"CDLClient",requestWindowId:i},this.sendMessage=t=>e({requestId:t.requestId,rendererId:t.rendererId,windowId:t.windowId,payload:t.request,operationName:t.operationName,type:a,cdlOperationCustomContext:t.cdlOperationCustomContext})}handleResponse(e){var t;return this._context.bootstrapServices.logger.debug("Received message",Object.assign(Object.assign({},this._loggingContext),{requestId:e.requestId,requestRendererId:e.rendererId,requestWindowId:e.windowId})),Promise.resolve(this.onResponseReceived({payload:{dataLayer:{rendererId:e.rendererId,requestId:e.requestId,windowId:e.windowId,data:e.response.data,errors:e.response.errors?e.response.errors:void 0,errorCode:null===(t=e.response)||void 0===t?void 0:t.errorCode,extensions:e.response.extensions}}}))}}class xd{constructor(e,t,i,n,a){var s;this.stateMachineName=a,this.completionAwaiter=(0,wd.P)(),this.bootstrapContext=Object.assign(Object.assign({},n),{loggingContext:Object.assign(Object.assign({},n.loggingContext),{component:"CDLStateMachine"})}),this.actionStateMap=t,this.globalState=e,this.currentState=e.current,null===(s=this.workerStartupTelemetryService)||void 0===s||s.onStart(this.stateMachineName),this.globalState.hasReachedCheckpoint(i)?this.transitionToNextState(i):this.subscribeToGlobalState()}isCompleted(){return this.completionAwaiter.promise}errorStateMachine(e){var t,i,n,a;this.unsubscribeStateTransition&&this.unsubscribeStateTransition.unsubscribe(),this.completionAwaiter.reject(e),"coreGraphql"===this.stateMachineName&&(null===(t=this.bootstrapContext.bootstrapServices.workerCacheManager)||void 0===t||t.saveWorkerStatusToCacheStorage({error:JSON.stringify(e),state:"Failure",stepName:`${this.currentState}::Fail`})),e&&e.code===h.jK.Disabled?this.bootstrapContext.bootstrapServices.logger.log(e.message,this.bootstrapContext.loggingContext):null===(n=(i=this.bootstrapContext.bootstrapServices.logger).errorToTelemetry)||void 0===n||n.call(i,`State machine is erroring out: ${(0,oe.VK)(e)}`,"cdl_state_managers",Object.assign({},(0,bd.n)(this.bootstrapContext.loggingContext)),!0),null===(a=this.workerStartupTelemetryService)||void 0===a||a.onFail(this.stateMachineName,e)}completeStateMachine(e){var t;this.unsubscribeStateTransition&&this.unsubscribeStateTransition.unsubscribe(),this.completionAwaiter.resolve(e),this.bootstrapContext.bootstrapServices.logger.log("State machine is reaching completion",this.bootstrapContext.loggingContext),null===(t=this.workerStartupTelemetryService)||void 0===t||t.onComplete(this.stateMachineName)}execute(e,t,i){var n;null===(n=this.workerStartupTelemetryService)||void 0===n||n.onStepStart(this.stateMachineName,e);const a=e,s=this.actionStateMap.get(a);if(!s)return this.bootstrapContext.bootstrapServices.logger.log(`State machine is transitioning from ${this.currentState} to ${e}, skipping action invoke as none is defined`,this.bootstrapContext.loggingContext),this.emitState(e,i);this.bootstrapContext.bootstrapServices.logger.log(`State machine is invoking action for transition state ${this.currentState} to ${e}`,this.bootstrapContext.loggingContext),s.action(t,i).then((t=>{var i;this.bootstrapContext.bootstrapServices.logger.log(`State machine is transitioning from ${this.currentState} to ${e}`,this.bootstrapContext.loggingContext),s.eventData&&(null===(i=this.workerStartupTelemetryService)||void 0===i||i.appendEventData(this.stateMachineName,s.eventData)),this.emitState(e,t)})).catch((e=>{this.errorStateMachine(e)}))}transitionToNextState(e,t){this.currentState=e,this.transitionState(e,t)}subscribeToGlobalState(){this.unsubscribeStateTransition=this.globalState.subscribe({next:e=>{const{newState:t,args:i}=e;this.transitionToNextState(t,i)}})}emitState(e,t){this.globalState.hasReachedCheckpoint(e)?this.transitionToNextState(e,t):(this.unsubscribeStateTransition||this.subscribeToGlobalState(),this.globalState.setState(e,t))}get workerStartupTelemetryService(){return this.bootstrapContext.bootstrapServices.workerStartupTelemetryService}}class Dd extends xd{transitionState(e,t){switch(e){case"authLoaded":this.execute("authServiceInjected",t,void 0);break;case"authServiceInjected":this.completeStateMachine(!0)}}}class Ad extends xd{transitionState(e,t){switch(e){case"appService:Loaded":this.execute("appService:Injected",t,void 0);break;case"appService:Injected":this.completeStateMachine(!0)}}}class Md{constructor(e){this._componentName=e,this._handlerMap=new Map}addHandlers(e){e.forEach((e=>{this._handlerMap.set(e.requestType,e.handlerFunc)}))}handle(e,t,i,...n){const a=e.payload;return new Promise(((e,s)=>{var o,r;const c=this._handlerMap.get(a.requestOperationtype);if(!c){null===(r=(o=i.bootstrapServices.logger).errorToTelemetry)||void 0===r||r.call(o,`No handler found for request type ${a.requestOperationtype}`,"cdl_request_handler_no_handler_error",Object.assign({origin:this._componentName,errorCode:h.jK.NotImplemented},(0,bd.n)(i.loggingContext)),!0);const e={response:{statusMsg:`Unknown request type: ${a.requestOperationtype}`,data:void 0},status:"failure"};return t(e),s(e)}c(a,i,...n,t).then((i=>e(Md.callResponseCallback(t,i,"success")))).catch((e=>{const i={response:e,status:"failure"};return t(i),s(i)}))}))}static callResponseCallback(e,t,i){e({response:t,status:i})}static onHandlerError(e,t,i,n,a,s=!1){var o,r;s?null===(r=(o=e.bootstrapServices.logger).errorToTelemetry)||void 0===r||r.call(o,i,"cdl_request_handler_on_error",Object.assign({origin:a,errorCode:t},(0,bd.n)(e.loggingContext)),!0):e.bootstrapServices.logger.error(i,Object.assign({component:a},e.loggingContext),t);const c={statusMsg:n,data:void 0};return Promise.reject(c)}}var Pd,Od,Rd,Ld;!function(e){e.AadGetToken="aadGetToken",e.AadGetCurrentUser="aadCurrentUser",e.AadClearCache="aadClearCache",e.StartupApiToken="startupApiToken",e.GetSkypeTokens="getSkypeTokens",e.GetUserDetails="getUserDetails",e.SubscribeToAuthState="subscribeToAuthState"}(Pd||(Pd={}));class Ud{constructor(e){this._requestUtility=new Md("CDLAuthHandler");let t=[];t=e===Td?[{requestType:Pd.AadGetToken,handlerFunc:Ud.getAadTokensAngular},{requestType:Pd.AadGetCurrentUser,handlerFunc:Ud.getUserInformationAngular},{requestType:Pd.GetSkypeTokens,handlerFunc:Ud.getSkypeTokensAngular},{requestType:Pd.GetUserDetails,handlerFunc:Ud.getUserDetailsAngular},{requestType:Pd.SubscribeToAuthState,handlerFunc:Ud.subscribeToAuthState}]:[{requestType:Pd.AadGetToken,handlerFunc:Ud.getAadTokens},{requestType:Pd.AadGetCurrentUser,handlerFunc:Ud.getUserInformation},{requestType:Pd.GetSkypeTokens,handlerFunc:Ud.getSkypeTokens},{requestType:Pd.GetUserDetails,handlerFunc:Ud.getUserDetails},{requestType:Pd.SubscribeToAuthState,handlerFunc:Ud.subscribeToAuthState}],this._requestUtility.addHandlers(t)}injectDependentServices(e){return new Promise((t=>{if(!e)throw new TypeError("Cannot injectDependentServices of undefined");if("function"==typeof e.getAuthTokens&&(e={authenticationService:e,discover:void 0}),!e.authenticationService)throw new TypeError("Cannot inject authentication service that is not defined");if(this._authenticationService)throw new TypeError("injectDependentServices has been called again, even though it's already initialized");return this._authenticationService=e.authenticationService,this._discover||(this._discover=e.discover),this._authStateProvider||(this._authStateProvider=e.authStateProvider),t()}))}handle(e,t,i){return this._requestUtility.handle(e,t,i,this._authenticationService,this._discover,this._authStateProvider)}static convertAngularPromise(e){return new Promise(((t,i)=>{e.then((e=>t(e))).catch((e=>i(e)))}))}static handleAuthResult(e,t,i){const n=t.bootstrapServices.newScenario(z.RG.AuthHandlerRequest);return n.appendEventData({operation:i}),e.then((e=>{if(null==e){const e="response payload is empty";throw n.fail({message:e}),new Error(e)}const t={statusMsg:`${i} request in main renderer has been processed`,data:e};return n.stop(),t})).catch((e=>{const a=Ud.getErrorMessage(i,e),s=!!(0,oe.Wc)(e);Md.onHandlerError(t,h.jK.UnhandledPromiseRejection,"the auth handler has exception",a,"CDLAuthHandler",!s&&"response payload is empty"!==(null==e?void 0:e.message)),e.isExpected?n.incomplete({message:a}):n.fail({message:a});try{"string"==typeof e&&(e=new Error(e)),e.reason||(e.reason={}),e.reason.cdlClient="auth"}catch(i){t.bootstrapServices.logger.warn(`Failed to handle auth error. Original error: ${(0,oe.VK)(e)}. Handling error: ${(0,oe.VK)(i)}`,Object.assign({component:"CDLAuthHandler"},t.loggingContext))}throw e}))}static getAadTokensAngular(e,t,i){var n;const a=e.context.resource,s=e.context.options;return Ud.logStartHandle(e,t,a),Ud.handleAuthResult(Ud.convertAngularPromise(i.getAuthToken(a,null==s?void 0:s.claim,null==s?void 0:s.silent,null===(n=e.context)||void 0===n?void 0:n.forceRenew)).then((e=>{if(!e)return;return{token:e.token,expires:e.expiration,tokenType:e.tokenType,fromCache:!1}})),t,Pd.AadGetToken)}static getAadTokens(e,t,i){const{resource:n,options:a}=e.context;let s;return Ud.logStartHandle(e,t,n),s=i.acquireTokenV2?i.acquireTokenV2(n,a):i.acquireToken(n,a).then((e=>({token:e}))),Ud.handleAuthResult(s,t,Pd.AadGetToken)}static getUserInformationAngular(e,t,i){return Ud.logStartHandle(e,t),Ud.handleAuthResult(Ud.convertAngularPromise(i.getUserInformation()),t,Pd.AadGetCurrentUser)}static getUserDetailsAngular(e,t,i){return Ud.logStartHandle(e,t),Ud.handleAuthResult(Ud.convertAngularPromise(i.getUserDetails()),t,Pd.GetUserDetails)}static getUserDetails(e,t,i,a){var s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){Ud.logStartHandle(e,t);const i=yield a.getSkypeTokenInfoFromDiscoveryResponse({forceRenew:!!(null===(s=e.context)||void 0===s?void 0:s.forceRenew)}),n=i?{userDetails:i.userDetails,id:i.userDetails.id}:void 0;return Ud.handleAuthResult(Promise.resolve(n),t,Pd.GetUserDetails)}))}static subscribeToAuthState(e,t,i,a,s,o){var r;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!s){t.bootstrapServices.logger.log("Auth-Handler - auth state provider not provided. Not subscribing.",Object.assign({component:"CDLAuthHandler"},t.loggingContext));const e=(0,oe.Tr)("AuthStateProvider not provided - This will should be an error in the RWC experience",h.jK.MissingParameter,"Auth-Handler");return Promise.reject(e)}const e=s.observe().subscribe((e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield Ud.handleAuthResult(Promise.resolve(null==e?void 0:e.state),t,Pd.SubscribeToAuthState);Md.callResponseCallback(o,i,"success")}))),(e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){Md.callResponseCallback(o,{statusMsg:Ud.getErrorMessage(Pd.SubscribeToAuthState,e),data:e},"failure")}))),(()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){e.unsubscribe(),Md.callResponseCallback(o,{statusMsg:"AuthStateProvider Completed",data:void 0},"failure")}))));return Ud.handleAuthResult(Promise.resolve(null===(r=s.getState())||void 0===r?void 0:r.state),t,Pd.SubscribeToAuthState)}))}static getSkypeTokensAngular(e,t,i){var n;Ud.logStartHandle(e,t);const a=i.getSkypeTokens(!!(null===(n=e.context)||void 0===n?void 0:n.forceRenew)).then((e=>{if(!e)return;return{expiration:e.tokenExpiration||0,skypeToken:e.skypeToken,userDetails:e.userDetails,regionGtms:e.regionGtms}}));return Ud.handleAuthResult(a,t,Pd.GetSkypeTokens)}static getSkypeTokens(e,t,i,n){var a;return Ud.logStartHandle(e,t),Ud.handleAuthResult(n.getSkypeTokenInfoFromDiscoveryResponse({forceRenew:!!(null===(a=e.context)||void 0===a?void 0:a.forceRenew)}),t,Pd.GetSkypeTokens)}static getUserInformation(e,t,i){return Ud.logStartHandle(e,t),Ud.handleAuthResult(i.getUser({correlation:{source:"AuthHandlerRequest",id:"na",scenarioName:"CentralDataLayerBootstrapAuthGetUser"}}),t,Pd.AadGetCurrentUser)}static logStartHandle(e,t,i){const n=i?` for resource ${i}`:"";t.bootstrapServices.logger.log(`Auth handler started serving request ${e.requestOperationtype}${n}`,Object.assign({component:"CDLAuthHandler"},t.loggingContext))}}Ud.getErrorMessage=(e,t)=>`the request type for ${e} failed due to ${(0,oe.VK)(t)}`,function(e){e.MachineActive="MachineActive",e.MachineInactive="MachineInactive",e.MachineLongInactive="MachineLongInactive",e.MachineLocked="MachineLocked"}(Od||(Od={})),function(e){e.NotifyAppState="NotifyAppState",e.NotifyTokenRefresh="NotifyTokenRefresh",e.NotifyCoreClientState="NotifyCoreClientState",e.NotifyCoreMachineState="NotifyCoreMachineState",e.NotifyCoreSuspendedState="NotifyCoreSuspendedState",e.NotifyServiceUp="NotifyServiceUp",e.NotifyServiceDown="NotifyServiceDown"}(Rd||(Rd={})),function(e){e[e.ChatSync=0]="ChatSync",e[e.Presence=1]="Presence",e[e.Files=2]="Files",e[e.OneNote=3]="OneNote",e[e.Groups=4]="Groups",e[e.Video=5]="Video",e[e.MasterTab=6]="MasterTab",e[e.IndexDb=7]="IndexDb",e[e.AdalTokens=8]="AdalTokens",e[e.AdalLogin=9]="AdalLogin",e[e.AdalReauth=10]="AdalReauth",e[e.SkypeTokens=11]="SkypeTokens",e[e.SkypeLicense=12]="SkypeLicense",e[e.SupportedBrowser=13]="SupportedBrowser",e[e.MSAGuestLicense=14]="MSAGuestLicense",e[e.AppSession=15]="AppSession",e[e.CSAStartup=16]="CSAStartup"}(Ld||(Ld={}));class $d{constructor(e,t){this.workerId=t,this._requestUtility=new Md("CDLAppServiceHandler");let i=[];i=e===Td?[{requestType:Rd.NotifyServiceUp,handlerFunc:$d.notifyServiceUpAngular},{requestType:Rd.NotifyServiceDown,handlerFunc:$d.notifyServiceDownAngular}]:[{requestType:Rd.NotifyServiceUp,handlerFunc:$d.notifyServiceUp},{requestType:Rd.NotifyServiceDown,handlerFunc:$d.notifyServiceDown}],this._requestUtility.addHandlers(i)}injectAppState(e){return new Promise((t=>{if(this.appService)throw new TypeError("injectAppStateService has been called again, even though it's already initialized");return this.appService=e,t()}))}handle(e,t,i){return this._requestUtility.handle(e,t,i,this.appService,this.workerId)}static notifyServiceUp(e,t,i,n){return new Promise((a=>{t.bootstrapServices.logger.log(`App service change is received (worker ${n}), ${e.context.appService} is up and running`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:s,reason:o}=e.context,r={workerId:n};return i.notifyServiceUp(r,s,o),a()}))}static notifyServiceUpAngular(e,t,i){return new Promise((n=>{t.bootstrapServices.logger.log(`App service change is received, ${e.context.appService} is up and running. Notifying Angular.`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:a,reason:s}=e.context,o=Ld[a];return i.notifyServiceUp(o,s),n()}))}static notifyServiceDown(e,t,i,n){return new Promise((a=>{t.bootstrapServices.logger.log(`App service change is received (worker ${n}), ${e.context.appService} is down`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:s,reason:o,code:r}=e.context,c={workerId:n};return i.notifyServiceDown(c,s,o,r),a()}))}static notifyServiceDownAngular(e,t,i){return new Promise((n=>{t.bootstrapServices.logger.log(`Angular app service change is received, ${e.context.appService} is down. Notifying Angular.`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:a,reason:s,code:o}=e.context,r=Ld[a];return i.notifyServiceDown(r,s,o),n()}))}}class Wd{constructor(e){this.workerId=e}handle(e,t,i){return new Promise((n=>{var a;i.bootstrapServices.logger.log(`Network state received from CDL worker ${this.workerId}. Network state: ${e.payload.networkState}`,Object.assign({component:"NetworkStateHandler"},i.loggingContext)),null===(a=this.networkStateChangeHandler)||void 0===a||a.next(e.payload.networkState);n(t({response:{statusMsg:"Network state received success.",data:void 0},status:"success"}))}))}injectNetworkStateTracker(e){return new Promise((t=>{if(this.networkStateChangeHandler)throw new TypeError("injectNetworkStateTracker has been called again, even though it's already initialized");return this.networkStateChangeHandler=e,t()}))}}class Bd extends xd{transitionState(e,t){switch(e){case"networkState:Loaded":this.execute("networkState:Injected",t,void 0);break;case"networkState:Injected":this.completeStateMachine(!0)}}}class zd{constructor(){this._componentName="EndpointsHealthMessageHandler"}handle(e,t,i){return new Promise((n=>{var a,s;(!e.payload||void 0===e.payload.healthState&&void 0===e.payload.endpointHealth)&&(this.log("Endpoints health message received from CDL. Payload is empty.",i),n(t(this.getSuccessMessage()))),e.payload.endpointHealth&&(this.log(`Endpoints health message received from CDL. Update: ${JSON.stringify(e.payload.endpointHealth)}.`,i),null===(a=this.endpointsHealthUpdateHandler)||void 0===a||a.handleEndpointHealthUpdate(e.payload.endpointHealth),n(t(this.getSuccessMessage()))),e.payload.healthState&&(this.log("Endpoints state dump message received from CDL.",i),null===(s=this.endpointsHealthUpdateHandler)||void 0===s||s.handleStateDump(e.payload.healthState),n(t(this.getSuccessMessage())))}))}injectEndpointsHealthUpdateHandler(e){return new Promise((t=>{if(this.endpointsHealthUpdateHandler)throw new TypeError("injectEndpointsHealthUpdateHandler has been called again, even though endpointsHealthUpdateHandler is already initialized");return this.endpointsHealthUpdateHandler=e,t()}))}log(e,t){t.bootstrapServices.logger.log(e,Object.assign({component:this._componentName},t.loggingContext))}getSuccessMessage(){return{response:{statusMsg:"Endpoints health received success.",data:void 0},status:"success"}}}class Hd extends xd{transitionState(e,t){switch(e){case"endpointsHealthUpdateHandler:Loaded":this.execute("endpointsHealthUpdateHandler:Injected",t,void 0);break;case"endpointsHealthUpdateHandler:Injected":this.completeStateMachine(!0)}}}function qd(e,t,i,n){const{authStateMachine:a,authHandler:s}=Vd(e,t,n),{appServiceStateMachine:o,appServiceMessageHandler:r}=Gd(e,t,n,i),{networkStateHandlerStateMachine:c,networkStateHandler:l}=Jd(e,t,n,i),{endpointsHealthHandlerStateMachine:d,endpointsHealthHandler:u}=Kd(e,t,n);return new Map([[fd.k.auth,{stateMachine:a,requestHandler:s}],[fd.k.appService,{stateMachine:o,requestHandler:r}],[fd.k.networkState,{stateMachine:c,requestHandler:l}],[fd.k.endpointHealth,{stateMachine:d,requestHandler:u}]])}const Vd=(e,t,i)=>{const n=new Ud(t),a={action:n.injectDependentServices.bind(n)},s=new Map;s.set("authServiceInjected",a);return{authHandler:n,authStateMachine:new Dd(i,s,"authLoaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:"auth",component:"CreateWorkerStateAndRequestHandlers"}},"auth")}},Gd=(e,t,i,n)=>{const a=new $d(t,n),s={action:a.injectAppState.bind(a)},o=new Map;o.set("appService:Injected",s);return{appServiceMessageHandler:a,appServiceStateMachine:new Ad(i,o,"appService:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:"appService",component:"CreateWorkerStateAndRequestHandlers"}},"appService")}},Jd=(e,t,i,n)=>{const a=new Wd(n),s={action:a.injectNetworkStateTracker.bind(a)},o=new Map;o.set("networkState:Injected",s);return{networkStateHandler:a,networkStateHandlerStateMachine:new Bd(i,o,"networkState:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:fd.k.networkState,component:"CreateWorkerStateAndRequestHandlers"}},"networkState")}},Kd=(e,t,i)=>{const n=new zd,a={action:n.injectEndpointsHealthUpdateHandler.bind(n)},s=new Map;s.set("endpointsHealthUpdateHandler:Injected",a);return{endpointsHealthHandler:n,endpointsHealthHandlerStateMachine:new Hd(i,s,"endpointsHealthUpdateHandler:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:fd.k.endpointHealth,component:"CreateWorkerStateAndRequestHandlers"}},"endpointsHealth")}};function Qd(){return new SharedWorker("/convene/worker/precompiled-shared-worker-c4cceffa5ae0c511.js")}function Yd(){return new Worker("/convene/worker/precompiled-web-worker-f03c3ae5e8e2d395.js")}const Xd=-1,Zd=e=>({loaded:e.hasReachedCheckpoint("loaded")?1:0,healthCheck:e.hasReachedCheckpoint("health_checked")?1:0,syncEngine:e.hasReachedCheckpoint("syncEngine:Initialized")?1:e.hasReachedCheckpoint("syncEngine:FailedToInitialize")?2:0,authLoaded:e.hasReachedCheckpoint("authLoaded")?1:0}),eu=e=>{const t=Zd(e);return`LD${t.loaded}:HC${t.healthCheck}:SE${t.syncEngine}:AL${t.authLoaded}`},tu=e=>{const t=Zd(e);return{"WorkerStartupState.Loaded":1===t.loaded,"WorkerStartupState.HealthCheck":1===t.healthCheck,"WorkerStartupState.SyncEngine":t.syncEngine,"WorkerStartupState.AuthLoaded":1===t.authLoaded}},iu=(e,t)=>{if(e.hasOwnProperty("code")){const t=e;if(t.code!==h.jK.Unknown)return t.code}return t.hasReachedCheckpoint("loaded")?t.hasReachedCheckpoint("syncEngine:FailedToInitialize")?h.jK.NotInitialized:t.hasReachedCheckpoint("health_checked")&&t.hasReachedCheckpoint("syncEngine:Initialized")?h.jK.UnhandledRuntimeException:h.jK.TimedOut:h.jK.ScriptLoadError},nu=e=>e&&e.message&&e.message.includes("AsyncIterableObserver buffer is full")?"AsyncIterableBufferOverflow":"Unknown",au=120*Zr.gT.MILLI_PER_SECOND,su="CDLWorkerManager",ou="default";function ru(e,t,i,n,a,s,o,r,c,l,d,u,m){var g,h;let p;const v=function(){const e=new Map;return e.set(fd.k.appState,Nd),e.set(fd.k.control,_d),e.set(fd.k.database,_d),e.set(fd.k.diagnostics,_d),e.set(fd.k.endpointHealth,_d),e.set(fd.k.graphql,Fd),e.set(fd.k.networkState,_d),e.set(fd.k.syncEngine,_d),e.set(fd.k.supportedResolvers,_d),e.set(fd.k.telemetry,_d),e}();return null===(g=e.workerCacheManager)||void 0===g||g.saveWorkerStatusToCacheStorage({state:"InProgress",stepName:"CreateCDLWorker"}),void 0!==(null==l?void 0:l.telemetryWorkerBroadcast)&&(null===(h=null==u?void 0:u.localStorage)||void 0===h||h.setItem("tmp.telemetryBroadcastEnabledCache",l.telemetryWorkerBroadcast.toString())),p=i?function(e,t,i,n,a,s,o,r,c,l,d,u,m,g){var h,p;if(c){ud(e.logger,c,!0,e.hostRendererId,su);const l=null===(p=null===(h=null==m?void 0:m.loader)||void 0===h?void 0:h.getSharedWorker)||void 0===p?void 0:p.call(h),v=l||new SharedWorker(c);return cu(e,n,a,r,t,i,(e=>v.port.postMessage(e)),(e=>{v.port.onmessage=t=>e(t,(e=>v.port.postMessage(e)))}),(e=>{v.onerror=t=>e(t)}),"shared-worker",s,o,u,g,null==d?void 0:d.workerId)}const v=cd(null==d?void 0:d.experienceName,null==d?void 0:d.ring,null==d?void 0:d.environment,null==d?void 0:d.sessionId,null==d?void 0:d.platformId,null==d?void 0:d.buildVersion,null==d?void 0:d.localeCode,null==d?void 0:d.workerId,void 0,null==d?void 0:d.preECSConsoleLogLevel,null==d?void 0:d.userConsoleLogLevel,null==d?void 0:d.publicPath,void 0,null==d?void 0:d.telemetryWorkerBroadcast),f=SharedWorker;SharedWorker=dd(f,e.logger,su,v,l);const b=new Qd;return SharedWorker=f,cu(e,n,a,r,t,i,(e=>b.port.postMessage(e)),(e=>{b.port.onmessage=t=>e(t,(e=>b.port.postMessage(e)))}),(e=>{b.onerror=t=>e(t)}),"shared-worker",s,o,u,g,null==d?void 0:d.workerId)}(e,t,v,n,a,s,o,r,c&&c.cdlSharedWorkerUrl,(e=>{c&&(c.cdlSharedWorkerUrl=e)}),l,d,u):function(e,t,i,n,a,s,o,r,c,l,d,u,m,g){var h,p;if(c){ud(e.logger,c,!0,e.hostRendererId,su);const l=null===(p=null===(h=null==m?void 0:m.loader)||void 0===h?void 0:h.getWorker)||void 0===p?void 0:p.call(h),v=l||new Worker(c);return cu(e,n,a,r,t,i,(e=>v.postMessage(e)),(e=>{v.onmessage=t=>e(t,(e=>v.postMessage(e)))}),(e=>{v.onerror=t=>e(t)}),"web-worker",s,o,u,g,null==d?void 0:d.workerId)}const v=cd(null==d?void 0:d.experienceName,null==d?void 0:d.ring,null==d?void 0:d.environment,null==d?void 0:d.sessionId,null==d?void 0:d.platformId,null==d?void 0:d.buildVersion,null==d?void 0:d.localeCode,null==d?void 0:d.workerId,null==d?void 0:d.preAuthUserId,null==d?void 0:d.preECSConsoleLogLevel,null==d?void 0:d.userConsoleLogLevel,null==d?void 0:d.publicPath,null==d?void 0:d.deviceId,null==d?void 0:d.telemetryWorkerBroadcast),f=Worker;Worker=dd(f,e.logger,su,v,l);const b=new Yd;return Worker=f,cu(e,n,a,r,t,i,(e=>b.postMessage(e)),(e=>{b.onmessage=t=>e(t,(e=>b.postMessage(e)))}),(e=>{b.onerror=t=>e(t)}),"web-worker",s,o,u,g,null==d?void 0:d.workerId)}(e,t,v,n,a,s,o,r,c&&c.cdlWebWorkerUrl,(e=>{c&&(c.cdlWebWorkerUrl=e)}),l,d,u,m),p}function cu(e,t,i,a,s,o,r,c,l,d,u,m,g,h,p=ou){return new Promise(((v,f)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const b={hostRendererId:s,component:"CDLWorker"},y=new vd({bootstrapServices:e,loggingContext:b});y.setState("bootstrapped"),null==g||g.mark(z.ck.CdlWorkerBootstrapped);const k=Sd(e,{postMessageCallback:e=>r(e),clients:o},{globalState:y,requestAndStateHandlers:qd(e,s,p,y)},s);k.workerServer.start(),c(((e,t)=>k.onMessageCallback(e,t,Xd))),l((t=>{f(lu(t,e,b,"workerOnError",m,S.state))}));const S={workerServer:k.workerServer,workerClientResponseRouter:k.workerClientResponseRouter,state:y,workerType:d,syncEngineInitializationPromise:u};S.state.setState("loaded");try{yield function(e,t,i,a,s){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=t.workerClientResponseRouter.cdlControlClient.sendRequest({type:"health_check",bootstrapData:a,initiatorExperience:i});let o;o=s?(yield n).response:(yield(0,H.E)(n,e)).response,t.cdlWorkerSessionId=o.cdlWorkerSessionId,t.cdlWorkerSupportedResolvers=o.cdlWorkerSupportedResolvers,t.state.setState("health_checked")}))}(t||au,S,i,a,h)}catch(t){f(lu(t,e,b,"healthCheckException",m,S.state))}v(S)}))))}function lu(e,{logger:t,workerCacheManager:i},n,a,s,o){const r=iu(e,o),c=eu(o),l=`err: ${(0,oe.VK)(e.error)};message: ${(0,oe.VK)(e.message)}`,d=(0,oe.Tr)(h.w5.DataLayerClient,r,l,void 0,`Uncaught ${a} in Worker: ${(0,oe.VK)(e.message)} Auth: ${s} WorkerState: ${c}`),u=`CDL Worker OnError for ${a}::Auth${s}::workerState:${c}::${nu(e)}`;return t.errorToTelemetry?t.errorToTelemetry(u,"cdl_worker_startup_error",tu(o),!0):t.error(u,n,r),null==i||i.saveWorkerStatusToCacheStorage({state:"Failure",stepName:"CDLWorkerOnError",error:l}),d}const du=e=>{switch(e){case"clean":return N.UF.Clean;case"upgrade:blocking":return N.UF.UpgradeBlocking;case"upgrade:non-blocking":return N.UF.UpgradeNonBlocking;case"warm":return N.UF.Warm}};var uu=i(907550),mu=i(535674),gu=i(649247);const hu=(0,uu.p)(mu.A),pu=()=>{let e;return(t,i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(void 0===e){const n=yield vu(t,i,a);return e=n,n}return e}))},vu=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n,a,s,o,r;if(!e)return t.log("WebWorkerURL is undefined",i),!0;let c;null===(n=t.infoToTelemetry)||void 0===n||n.call(t,"Pinging PDS / ServiceWorker to verify if worker script is up","cdl_worker_startup_error_verify_worker_script",{endpointUrl:e});const l=new Date,d=performance.now();try{c=yield hu({url:e,method:"HEAD"})}catch(e){return null===(a=t.errorToTelemetry)||void 0===a||a.call(t,e.toString(),"cdl_worker_startup_error_verify_worker_script",{statusCode:-1},!0),!1}const u=performance.now()-d;if(null===(s=t.infoToTelemetry)||void 0===s||s.call(t,"Finished pinging PDS / ServiceWorker","cdl_worker_startup_error_verify_worker_script",{totalRequestTime:u,statusCode:c.status,size:Number(c.headers["content-length"]||-1),correlationId:c.headers["x-msedge-ref"],callId:c.headers["x-ms-request-id"],contentType:c.headers["x-cache"]}),t.log(`precompiled-web-worker header x-msedge-ref: ${c.headers["x-msedge-ref"]}`,i),function(e,t){const i="Ref C: ";if(!e)return!0;let n;if(!(n=e.indexOf(i)))return!0;const a=e.slice(n+i.length),s=new Date(a);if(!(0,gu.q)(s))return!0;return t.getTime()<s.getTime()}(c.headers["x-msedge-ref"],l)||t.log("Request is likely served from service worker, since PDS response time is before the request time",i),c.status!==pr.qb.OK)return null===(o=t.errorToTelemetry)||void 0===o||o.call(t,`PDS returned ${c.status} for worker script`,"cdl_worker_startup_error_verify_worker_script",void 0,!0),!1;return!c.headers["content-length"]||Number(c.headers["content-length"])<1e3?(null===(r=t.errorToTelemetry)||void 0===r||r.call(t,`PDS returned smaller than expected worker script, of size ${c.headers["content-length"]}`,"cdl_worker_startup_error_verify_worker_script",void 0,!0),!1):(t.log("Worker script fetched successfully.",i),!0)}));const fu=(e,t,i,a,s,o,r,c,l,d,u,m,g,p,v,f,b,y,k)=>new Promise(((S,w)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var j,C;const _=performance.now();let T=null==g?void 0:g.workerStartupScenario,I=null==g?void 0:g.workerStartupScenarioTimeout;const N=bu(t);if(!T){const e=yu(i.newScenario,o,N,i.workerCacheManager,u,m,v,i.logger);T=e.workerStartupScenario,I=e.workerStartupScenarioTimeout}if(T.appendEventData({origin:r}),k&&(null==v?void 0:v.getUser)&&!T.isPaused){(yield null==v?void 0:v.getUser())||T.pause({reason:h.jK.Authentication,pauseReason:"AuthNoUser_InteractionRequired"})}null==y||y.setCoreContext("AppInfo.CDLState","Initializing");const E=wu(e);(null===(j=null==m?void 0:m.getState())||void 0===j?void 0:j.state)===Lr.j.InteractionRequired&&(i.logger.warn("Worker startup - User is in InteractionRequired state. pausing worker startup scenario",E),null==T||T.pause({reason:h.jK.Authentication,pauseReason:"InteractionRequired"}));const F=null===(C=null==m?void 0:m.observe())||void 0===C?void 0:C.subscribe({next:e=>{e.state!==Lr.j.InteractionRequired||(null==T?void 0:T.isPaused)?e.state===Lr.j.Up&&(null==T?void 0:T.isPaused)&&(i.logger.log("Worker startup - User came out of InteractionRequired state. Resuming worker startup scenario",E),null==T||T.resume({reason:"ValidToken"})):(i.logger.warn("Worker startup - User is in InteractionRequired state. Pausing worker startup scenario",E),null==T||T.pause({reason:h.jK.Authentication,pauseReason:"InteractionRequired"}))}}),x=T;u&&i.logger.log(`Initializing worker manager from renderer with host: ${u.location.host} protocol: ${u.location.protocol} port: ${u.location.port}`,E);const D=pu();let A;p||(A=null==u?void 0:u.setTimeout((()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const t=wu(e);if(!(yield D(N?null==a?void 0:a.cdlSharedWorkerUrl:null==a?void 0:a.cdlWebWorkerUrl,i.logger,t))){const t=(0,oe.Tr)("CDL worker script load error",h.jK.ScriptLoadError,"cdl_worker_startup_error_script_load_error"),n=yield Su(t,i,e,x,N,a,D,!1,!!p,_,y);w(n)}}))),4e4)),function(e,t,i,a,s,o,r,c,l,d,u,m,g,p,v,f,b,y,k,S){var w;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let j=!1;v&&t.logger.log(`Initializing worker manager from renderer with host: ${v.location.host} protocol: ${v.location.protocol} port: ${v.location.port}`,{hostRendererId:e,component:"CDLWorkerManager"});try{const u=(0,wd.P)();d.appendEventData({newState:"beforeCreateCDLWorker"});const b=yield ru(t,e,o,a,s,u.promise,f?null===(w=f.getState())||void 0===w?void 0:w.state:Lr.j.Up,m,i,g,d,v,y).finally((()=>{var e,t,i;null===(e=null==v?void 0:v.clearTimeout)||void 0===e||e.call(v,l),null==v||v.clearTimeout(c),null===(i=null===(t=null==v?void 0:v.loader)||void 0===t?void 0:t.clearWorker)||void 0===i||i.call(t)}));return j=!0,d.appendEventData({newState:z.ck.CdlWorkerManagerHealthChecked,searchSessionId:b.cdlWorkerSessionId}),b.state.setState("initialized"),null==S||S.setCoreContext("AppInfo.CDLState","Running"),ju(d),d.mark("CDLWorkerManagerInitialized"),function(e,t,i,a,s,o,r,c,l){var d,u,m,g,p,v,f,b,y,k,S,w,j,C,_;(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=wu(i);try{const{response:i}=yield e.workerClientResponseRouter.cdlSyncEngineClient.sendRequest({type:"startup_info",subType:"Messaging",params:void 0}),o=i;if(o&&"string"!=typeof o&&"error"===o.type){const e="string"==typeof o.details?o.details:JSON.stringify(o.details);throw t.logger.warn(`Sync engine for Messaging strategy: ${e}`,n),e}const u="clean"===o?"cold":"warm";null==c||c.appendEventData({messagingSyncEngineStartupMode:o,appLaunchMode:u,workerResponseTime:performance.now()-r}),s.resolve({isSyncEngineInitialized:!0,bootType:du(o)}),l&&(null===(d=null==l?void 0:l.setContext)||void 0===d||d.call(l,{"AppInfo.LaunchMode":u})),e.state.setState("syncEngine:Initialized"),ju(a),a.stop({dataSource:o})}catch(i){const r=yield ku(o,t.workerCacheManager),c="Init SyncEngine failed",l=`err: ${(0,oe.VK)(i)}`,d=i.code||(null===(m=null===(u=i.response)||void 0===u?void 0:u.error)||void 0===m?void 0:m.code)||h.jK.Unknown;null===(p=(g=t.logger).errorToTelemetry)||void 0===p||p.call(g,`${c}:: ${l}`,"cdl_worker_manager_get_messaging_sync_engine_startup_info_error",Object.assign(Object.assign({},(0,bd.n)(n)),{errorCode:d}),!0),null===(f=(v=t.logger).errorToTelemetry)||void 0===f||f.call(v,`${c}:: WSM: ${r}`,"cdl_worker_manager_get_messaging_sync_engine_startup_info_error",Object.assign(Object.assign({},(0,bd.n)(n)),{errorCode:d}),!0),ju(a);const T=`${c}:: WSM: ${r}:: ${l}`,I=(null===(y=null===(b=i.response)||void 0===b?void 0:b.error)||void 0===y?void 0:y.isExpected)||!1,N={errors:T,isAccepted:I,errorCode:d,dataSource:null===(S=null===(k=i.response)||void 0===k?void 0:k.error)||void 0===S?void 0:S.startupMode,reason:null===(j=null===(w=i.response)||void 0===w?void 0:w.error)||void 0===j?void 0:j.message,statusCode:null===(_=null===(C=i.response)||void 0===C?void 0:C.error)||void 0===_?void 0:_.statusCode};I?a.cancel(N):a.fail(N),e.state.setState("syncEngine:FailedToInitialize"),s.resolve({isSyncEngineInitialized:!1})}}))}(b,t,e,d,u,o,r,p,k),b}catch(n){throw yield Su(n,t,e,d,o,i,u,!j,!!b,r,S)}}))}(e,i,a,s,r,N,_,A,I,T,D,c,l,d,u,m,p,f,b,y).then((e=>S(e))).catch((e=>{null==F||F.unsubscribe(),w(e)})).finally((()=>null==F?void 0:F.unsubscribe()))})))),bu=e=>"electron"===e||"sharedworker"===e;function yu(e,t,i,n,a,s,o,r){var c;const l=300*G.kg,d=t||l,u=e(z.RG.CentralDataLayerWorkerManagerStartup,d);let m=!0;(null==o?void 0:o.getUser)&&(m=!1,null==o||o.getUser().then((()=>m=!0)));const g=null===(c=null==a?void 0:a.setTimeout)||void 0===c?void 0:c.call(a,(()=>{var e;m||(null==r||r.warn("Worker startup - getUser is still not available. Cancelling Worker Scenario"),u.cancel({reason:"GetUser"}));(s?null===(e=s.getState())||void 0===e?void 0:e.state:Lr.j.Up)===Lr.j.InteractionRequired&&(null==r||r.warn("Worker startup - User is in InteractionRequired state. Cancelling Worker Scenario"),u.cancel({reason:"InteractionRequired"})),ku(i,n).then((e=>{u.appendEventData({errors:e})}))}),d-500);return{workerStartupScenario:u,workerStartupScenarioTimeout:g}}function ku(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=e?"shared-worker":"web-worker";let n="";if(t)try{const e=yield t.getWorkerStartupStatus(i);return"WorkerStartupStatus: "+(e?`lastError: ${JSON.stringify(e.lastError)}:: lastState: ${JSON.stringify(e.lastState)}`:"Unable to get CDL worker startup status")}catch(e){n=`Unable to get CDL worker startup status. Reason: ${(0,oe.VK)(e)}`}else n="Unable to get CDL worker startup status. Reason: workerCacheManager is undefined";return n}))}function Su(e,t,i,a,s,o,r,c,l,d,u){var m,g,p,v,f;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield ku(s,t.workerCacheManager),b=`Failed to initialize CDL Worker :: err: ${(0,oe.VK)(e)}`,y=`${b}, workerResponseTime: ${performance.now()-d}ms, ${n}`;null==u||u.setCoreContext("AppInfo.CDLState","Failed");const k=wu(i);let S={errors:y,errorCode:t.workerCacheManager?e.code:h.jK.NotInitialized};if(c&&!l)try{if(!(yield r(s?null==o?void 0:o.cdlSharedWorkerUrl:null==o?void 0:o.cdlWebWorkerUrl,t.logger,k))){e.code=h.jK.ScriptLoadError;S={errors:"CDL Worker Script load error",errorCode:h.jK.ScriptLoadError}}}catch(t){e.code=h.jK.ScriptLoadError;S={errors:`CDL Worker Script load error :: ${t.message}`,errorCode:h.jK.ScriptLoadError}}const w=(0,oe.Tr)("CDLWorkerManager",e.code,JSON.stringify(k),void 0,y);return null===(g=(m=t.logger).errorToTelemetry)||void 0===g||g.call(m,b,"cdl_worker_manager_handle_initialize_worker_manager_failure_error",Object.assign(Object.assign({},(0,bd.n)(k)),{errorCode:w.code}),!0),null===(v=(p=t.logger).errorToTelemetry)||void 0===v||v.call(p,n,"cdl_worker_manager_handle_initialize_worker_manager_failure_error",Object.assign(Object.assign({},(0,bd.n)(k)),{errorCode:w.code}),!0),ju(a),e&&e.code===h.jK.TimedOut?a.stop(S,"timeout"):a.fail(S),null===(f=t.workerCacheManager)||void 0===f||f.saveWorkerStatusToCacheStorage({state:"Failure",stepName:"CreateCDLWorker",error:y}),w}))}function wu(e){return{hostRendererId:e,component:"CDLWorkerManager"}}function ju(e){e.appendEventData({"Thread.Id":"",threadId:""})}var Cu=i(246632);class _u{constructor(e,t,i){this._cacheStorage=e,this._cacheName="cdl-worker-cache-manager",this.lastSavePromise=Promise.resolve(null),this._logger=t,this._scenarioFactory=i}save(e,t,i,a,s){var o,r;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n="";try{if(!e)throw this._error("get","Invalid key");null==s||s.appendEventData({context:a}),n=JSON.stringify(t),this._logger.log(`[CDLWorkerCacheManager]: Saving item to ${this._cacheName} key: ${e}`);const o=new Response(n),r=this._getScopedRequest(e,i,a);return yield this._cacheStorage.put(r,o),null==s||s.stop(),r.request.url}catch(t){const i=this._error("save",`[CDLWorkerCacheManager]: Failed to save object to cache, err: ${null==t?void 0:t.message}, key: ${e}, experienceName: ${a}`);return null===(r=(o=this._logger).warnToTelemetry)||void 0===r||r.call(o,i.message,"cdl_worker_cache_manager_save_error",{origin:e,context:a},!0),null==s||s.fail({message:i.message,errorCode:i.name,errors:i.message}),null}}))}get(e,t,i,a){var s,o;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{if(!e)throw this._error("get","Invalid key");null==a||a.appendEventData({context:i});const n=this._getScopedRequest(e,t,i),s=yield this._cacheStorage.match(n);return s&&s.body?(null==a||a.stop({cached:!0}),yield s.json()):(this._logger.log(`[CDLWorkerCacheManager]: Get from cache for key ${e} could not find a result, returning null.`),null==a||a.stop({cached:!1}),null)}catch(t){const n=this._error("get",`[CDLWorkerCacheManager]: Failed to get item from cache for key ${e}, err: ${null==t?void 0:t.message}`);throw null===(o=(s=this._logger).errorToTelemetry)||void 0===o||o.call(s,n.message,"cdl_worker_cache_manager_get_error",{origin:e,context:i},!0),null==a||a.fail({errors:n.message,errorCode:n.code,message:n.message}),n}}))}delete(e,t,i){var a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{if(!e)throw this._error("get","Invalid key");this._logger.log(`[CDLWorkerCacheManager]: Deleting item from cdl worker cache key: ${e}, experienceName: ${i}`);const n=this._getScopedRequest(e,t,i),a=yield this._cacheStorage.delete(n);return Promise.resolve(a)}catch(t){const n=this._error("delete",`[CDLWorkerCacheManager]: Failed to delete item from cache key: ${e}, experienceName: ${i}, err: ${null==t?void 0:t.message}`);return null===(s=(a=this._logger).errorToTelemetry)||void 0===s||s.call(a,n.message,"cdl_worker_cache_manager_delete_error",{origin:e,context:i},!0),!1}}))}clear(){var e,t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{return this._logger.log("[CDLWorkerCacheManager]: Clearing cdl-worker cache"),this._cacheStorage.clear(this._cacheName)}catch(i){const n=this._error("clear",`[CDLWorkerCacheManager]: Failed to clear the cache: ${this._cacheName}, err: ${null==i?void 0:i.message}`);return null===(t=(e=this._logger).errorToTelemetry)||void 0===t||t.call(e,n.message,"cdl_worker_cache_manager_clear_error",{origin:this._cacheName},!0),!1}}))}getCachedUrlByKey(e,t){return this._getScopedRequest(e,t).request.url}saveWorkerStatusToCacheStorage(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let t;return yield this.lastSavePromise,this.lastSavePromise=this.get(Cu.QC).then((e=>{t=e})).catch((()=>{this._logger.warn(`WorkerCacheManager couldn't get cache key ${Cu.QC}, setting to default`)})).then((()=>{t||(t={}),"Failure"===e.state?t.lastError=e:t.lastState=e,t.statusLogs=t.statusLogs||[];const i={timestamp:(new Date).getTime(),status:e};return t.statusLogs.push(i),this.save(Cu.QC,t)})),this.lastSavePromise}))}getWorkerStartupStatus(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.get(Cu.QC,void 0,e)}))}saveWorkerVerboseLog(e){return this.save(Cu._1,e,void 0)}getWorkerVerboseLog(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield this.get(Cu._1,void 0,e);return t||""}catch(e){return""}}))}getAggregatedUserData(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const i=null===(t=this._scenarioFactory)||void 0===t?void 0:t.newScenario(z.RG.MTMAAggregatorUserDataRead);return yield this.get(`${Cu.fl}/${e}`,void 0,"cdl-worker",i)}catch(e){return null}}))}getGlobalUserData(){var e,t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{return yield this.get(Cu.nx,void 0,"cdl-worker")}catch(i){const n=this._error("getGlobalUserData",`[CDLWorkerCacheManager]: Failed to get global user data from cache, err: ${null==i?void 0:i.message},`);return null===(t=(e=this._logger).errorToTelemetry)||void 0===t||t.call(e,n.message,"cdl_worker_cache_manager_get_global_user_data_error",void 0,!0),null}}))}getAllKeys(e){var t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield this._cacheStorage.keys(this._cacheName);if(null==e||e.stop(),!t)return[];return t.map((e=>e.url))}catch(n){const a=this._error("getAllKeys",`[CDLWorkerCacheManager]: Failed to get all keys from cache, err: ${null==n?void 0:n.message},`);return null===(i=(t=this._logger).warnToTelemetry)||void 0===i||i.call(t,a.message,"cdl_worker_cache_manager_get_all_keys_error",{origin:this._cacheName},!0),null==e||e.fail({message:a.message,errorCode:a.code,errors:a.message}),[]}}))}_error(e,t){return(0,oe.Tr)("CDLWorkerCacheManager",h.jK.Undefined,e,void 0,t)}_getScopedRequest(e,t,i){return this._cacheStorage.createRequest(this._cacheName,`${this._cacheName}/${e}`,"Experience",t,!0,i)}}const Tu=(e,t,i)=>{try{const n=new _u(new td(caches,"","",e),t,i);return n.delete(Cu.QC),n}catch(e){return void t.error(`[createCDLWorkerCacheManager]: Error occurred while creating CDLWorkerCacheManager: ${(0,oe.VK)(e)}`)}};function Iu(e,t,i,a,s,o,r,c,l,d,u,m,g,h,p,v,f){var b,y,k,w,j,C,_,T,I,N;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{workerStartScenarioTimeoutInMs:E}=o.get(S.J.CdlWorker),F=(e,t,i)=>s.newScenario(e,{callback:i,timeoutMs:t}),x=Tu(t.experienceName,a.newLogger("CDL:DataClientCoreWorkerManager","core-services-cdl-worker"),s),D=Eu(l,o),A=yu(F,E,bu(D),x,e,m,r,d),M=(null===(b=e.loader)||void 0===b?void 0:b.getCdlSharedWorkerUrl)?null===(y=e.loader)||void 0===y?void 0:y.getCdlSharedWorkerUrl():Fu(o,e,s,d),P=(null===(k=e.loader)||void 0===k?void 0:k.getCdlWorkerUrl)?null===(w=e.loader)||void 0===w?void 0:w.getCdlWorkerUrl():void 0,O=Nu(l,o,s,e,d);A.workerStartupScenario.appendEventData({contentType:O.toString(),newState:"beforeBootstrapData"}),function(e,t,i,n){n.log(`Initializing workerType ${e} ${t?"as Worker host":`as non-Worker host with sharedWorkerUrl ${i}`}`)}(D,O,M,d);try{let b;O&&(b=yield function(e,t,i,a,s,o,r){return(0,n.__awaiter)(this,void 0,void 0,(function*(){o.appendEventData({newState:"beforeAuthBootstrapData"});const c=yield function(e,t,i,a,s,o){var r;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n;s.appendEventData({newState:"beforeAuthUserData"});const c=1e4,l=o.get(S.J.CdlWorker).timeToGetUserFromAuthMs||c;try{n=yield(0,H.E)(e.getUser(),l)}catch(e){i.error(`Worker bootstrap authentication error - cannot authenticationService.getUser: ${null==e?void 0:e.code}`)}if(!n)return{};let d;s.appendEventData({newState:"beforeDiscoverUserData"});try{d=yield(0,H.E)(t.getUser(),l)}catch(e){i.error(`Worker bootstrap authentication error - cannot discover.getUser: ${null==e?void 0:e.code}`)}if(!d)return{userInformation:n};const u=null==d?void 0:d.id;return{userInformation:n,userDetails:{userDetails:{licenseDetails:d,region:null==d?void 0:d.region,userRegion:null==d?void 0:d.userRegion,partition:null==d?void 0:d.partition,userPartition:null==d?void 0:d.userPartition,id:u},id:u},authState:(null===(r=null==a?void 0:a.getState())||void 0===r?void 0:r.state)||Lr.j.Up}}))}(e,t,i,a,o,r);return{hostSettings:s.hostSettings,auth:c}}))}(r,c,d,m,i,A.workerStartupScenario,o)),A.workerStartupScenario.appendEventData({newState:"beforeInitializeWorkerManagerFromDataClientCore"});const y=yield function(e,t,i,a,s,o,r,c,l,d,u,m,g,h,p,v,f,b,y,k,w){var j,C;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{ring:n,environment:_}=u.get(S.J.Metadata),{enableWorkerBroadcast:T}=u.get(S.J.Telemetry),{sessionId:I}=u.get(S.J.Platform),{enablePassingPlatformIdInWorkerUrlHash:N}=u.get(S.J.Core),{workerStartTimeoutInMs:E,workerStartScenarioTimeoutInMs:F,disablePingingPDSIfWorkerStartupFails:x,shouldDisableHealthCheckTimeout:D,enablePausingWorkerScenarioWhenAuthDoesNotHaveUser:A}=u.get(S.J.CdlWorker),M=_?(0,B.get)(At.s,_):void 0;return v.workerStartupScenario.appendEventData({newState:"beforeInitializeWorkerManager"}),fu(e,t,{logger:new rd(c.newLogger("CDL:DataClientCoreWorkerManager","core-services-cdl-worker")),newScenario:p,offlineCacheManager:r,workerCacheManager:d,hostRendererId:e},{cdlSharedWorkerUrl:i||"",cdlWebWorkerUrl:a||""},E||void 0,F||void 0,s,o,{experienceName:s,ring:(null==n?void 0:n.id)||void 0,environment:M,platformId:N?l.config.platformId:void 0,sessionId:I||void 0,buildVersion:l.config.buildVersion,localeCode:f,workerId:h,publicPath:m.__webpack_public_path__,preECSConsoleLogLevel:null===(j=m.defaultConsoleLogLevel)||void 0===j?void 0:j.preECSConsoleLogLevel,userConsoleLogLevel:null===(C=m.defaultConsoleLogLevel)||void 0===C?void 0:C.userConsoleLogLevel,deviceId:l.host.deviceId,telemetryWorkerBroadcast:!!T},b,m,g,v,!!x,y,!!D,k,w,!!A)}))}(t.clientId,D,M,P,t.experienceName,b,u,a,l,x,o,e,m,h,F,A,p,v,r,s,f);return!!(null===(j=null==o?void 0:o.get(S.J.CdlWorker))||void 0===j?void 0:j.enableUserContextWorkerRegistration)&&(h&&(null===(C=null==b?void 0:b.auth.userDetails)||void 0===C?void 0:C.id)?g.mapUserIdToRegisteredWorker(h,b.auth.userDetails.id):null===(_=d.errorToTelemetry)||void 0===_||_.call(d,`Unable to register worker '${h}' to user through worker registrar for userId '${null===(T=null==b?void 0:b.auth.userDetails)||void 0===T?void 0:T.id}'`,"cdl_worker_init_register_user_context",{origin:h,userId:null===(I=null==b?void 0:b.auth.userDetails)||void 0===I?void 0:I.id},!0)),y}catch(e){return void(null===(N=d.errorToTelemetry)||void 0===N||N.call(d,`Failed to start CDL Worker from DataClientCore: ${(0,oe.VK)(e)}`,"cdl_services_worker_worker_service_start_client_core_cdl_worker_error",void 0,!0))}}))}const Nu=(e,t,i,n,a)=>{const s=Eu(e,t),o=Fu(t,n,i,a);return"webworker"===s||"web"===s||!o};function Eu(e,t){let i=e.config.clientType===Ps.Bh.Web?"webworker":"sharedworker";const n=t.get(S.J.Host).cdlWorkerType,a=t.get(S.J.CdlWorker).cdlWorkerType;return n?i=n:a&&(i=a),i}function Fu(e,t,i,n){var a;let{cdlSharedWorkerUrl:s}=e.get(S.J.Host);const o=t.localStorage.getItem("ts.cdlSharedWorkerJsUrl");if(s&&o&&s!==o){null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`Worker URL saved in TSW:${s} is different from worker url in TMP:${o}`,"cdl_services_worker_worker_service_get_cdl_shared_worker_url_error",void 0,!0);i.newScenario(z.RG.HostSettingsSync).fail({reason:JSON.stringify({cdlSharedWorkerUrl:s,storedWorkerUrl:o})}),s=o}return s}var xu=i(368310);class Du extends Ue{constructor(){super(h.Yg.CreateCDLWorkerAppServiceTask,["windowProvider","scenarioFactory","coreSettings","platformService","loggerFactory"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=(0,xu.Q6)(e.coreSettings),i=!!e.coreSettings.get(S.J.CdlWorker).enableCdlAppStateService;if(!t||!i)return Promise.resolve();const n=new od(e);return e.cdlAppStateService=n,function(e,t,i,n,a,s,o){Nu(n,i,t,e,a)&&s.getCDLWorkerManager().then((e=>{null==e||e.state.setState("appService:Loaded",o)}))}(e.windowProvider,e.scenarioFactory,e.coreSettings,e.platformService,e.loggerFactory.newLogger("CDLWorkerManager","core-services-tasks"),e.cdlWorkerService,n)}))}}class Au extends Ue{constructor(){super(h.Yg.CreateCDLWorkerAuthTask,["cdlWorkerRegistrarService","cdlWorkerService","scenarioFactory"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=(0,xu.Q6)(e.coreSettings),{cdlWorkerService:i,cdlWorkerRegistrarService:a,scenarioFactory:s}=e;if(t&&i){const{enableCleanUpOnLogout:t,enablePausingWorkerScenarioWhenAuthDoesNotHaveUser:o}=e.coreSettings.get(S.J.CdlWorker);if(o){const e=s.findScenario(z.RG.CentralDataLayerWorkerManagerStartup);(null==e?void 0:e.isPaused)&&e.resume({reason:"UserAuthenticated"})}if(function(e,t,i,n,a,s,o,r,c,l){Nu(s,i,t,e,o)&&r.getCDLWorkerManager().then((e=>{null==e||e.state.setState("authLoaded",{authenticationService:n,discover:a,authStateProvider:l,cdlWorkerRegistrarService:c})}))}(e.windowProvider,e.scenarioFactory,e.coreSettings,e.authenticationService,e.discover,e.platformService,e.loggerFactory.newLogger("CDLWorkerManager","core-services-tasks"),i,a,e.authStateProvider),!t)return;return t=>(0,n.__awaiter)(this,void 0,void 0,(function*(){"signout"===t&&(yield i.logoutCurrentUser(e.coreSettings))}))}}))}}class Mu{constructor(e,t,i,n){this.cdlWorkerService=n,this._logger=i.newLogger("CDLWorkerStateSender","core-services-cdl-worker"),this._clientStateSubscription=e.observe().subscribe((e=>this.sendAppStateChangeToWorker({requestOperationtype:Rd.NotifyCoreClientState,context:{appState:e}}))),this._machineLockStateSubscription=t.observe().pipe((0,er.x)(((e,t)=>e.machineLockState===t.machineLockState))).subscribe((e=>this.sendAppStateChangeToWorker({requestOperationtype:Rd.NotifyCoreMachineState,context:{appState:e.machineLockState}}))),this._suspendedStateSubscription=t.observe().pipe((0,er.x)(((e,t)=>e.suspendedState===t.suspendedState))).subscribe((e=>this.sendAppStateChangeToWorker({requestOperationtype:Rd.NotifyCoreSuspendedState,context:{appState:e.suspendedState}})))}dispose(){this._clientStateSubscription&&(this._clientStateSubscription.unsubscribe(),this._clientStateSubscription=void 0),this._machineLockStateSubscription&&(this._machineLockStateSubscription.unsubscribe(),this._machineLockStateSubscription=void 0),this._suspendedStateSubscription&&(this._suspendedStateSubscription.unsubscribe(),this._suspendedStateSubscription=void 0)}sendAppStateChangeToWorker(e){var t,i,a,s,o,r;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=(0,U.u4)(e);let c;try{c=yield this.getCdlAppStateClient()}catch(e){return void(null===(i=(t=this._logger).errorToTelemetry)||void 0===i||i.call(t,`Failed to send app state change ${n} to CDL. Reason: failed to obtain a CDLAppStateClient. See initialization failures earlier in the logs.`,"cdl_services_worker_worker_state_sender_send_app_state_get_client_error",void 0,!0))}if(c){this._logger.log(`Alerting CDL Worker of host state change: ${n}`);try{yield c.sendFilteredAppStateRequest(e)}catch(e){null===(r=(o=this._logger).errorToTelemetry)||void 0===r||r.call(o,`Failed to send app state change ${n} to CDL. Reason: ${(0,U.u4)(e)}`,"cdl_services_worker_worker_state_sender_send_app_state_send_request_error",void 0,!0)}}else null===(s=(a=this._logger).errorToTelemetry)||void 0===s||s.call(a,`Failed to send app state change ${n} to CDL. Reason: CDLAppStateClient does not exist. See initialization failures earlier in the logs.`,"cdl_services_worker_worker_state_sender_send_app_state_get_client_undefined_error",void 0,!0)}))}getCdlAppStateClient(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.cdlWorkerService.getCDLWorkerManager();return null==e?void 0:e.workerClientResponseRouter.cdlAppStateClient}))}}class Pu extends Ed{constructor(e,t){super(),this.workerClientResponseRouter=e,this.logger=t.loggerFactory.newLogger("CDLControlPlaneCommunicator","cdl-control-plane-communicator")}sendMessage(e){this.getRequestForOperationName(e).then((t=>this.handleResponse(e.rendererId,e.requestId,this.extractPerfStats(t)))).catch((t=>this.handleResponse(e.rendererId,e.requestId,void 0,(0,U.u4)(t)||"Unknown Error")))}getRequestForOperationName(e){const t=e.operationName;if(!t)return Promise.reject(`Request could not be sent: operationName unavailable. RequestId: ${e.requestId}.`);switch(this.logger.log(`Converting GQL operation ${t} to CDL Worker control plane message.`),t){case"notifyWorkerSyncCanStart":return this.workerClientResponseRouter.cdlControlClient.sendRequest({type:"sync_can_start"});case"AppsChatNotifyActiveContextChangedMutation":const t=e.request.variables;return this.workerClientResponseRouter.cdlControlClient.sendRequest({type:"active_context_changed",activeContextChangedData:{activeContextId:t.activeContextId,activeContextType:t.activeContextType}})}}handleResponse(e,t,i,n){return Promise.resolve(this.onResponseReceived({payload:{dataLayer:{rendererId:e,requestId:t,data:!n,errors:n,extensions:{perfStats:i}}}}))}extractPerfStats(e){return{workerResponseTime:e.workerResponseTime||0,dataStorePerfStats:[]}}}var Ou=i(232894),Ru=i(458561);const Lu={activity:["activityCustomizations","enableActivityAppCommandResultHook","enableActivityDotBadge","enableActivityFeedItemDeletion","enableActivityFeedItemDeletionOnUI","enableActivityFeedItemDeletionWithToast","enableCommunitiesCalendarEventsFeedItems","enableCommunitiesFeedItems","enableCommunitiesInviteAcceptedActivity","enableCommunitiesOwnerPromotionActivity","enableMTMAMissedNotificationsDotBadge","enableMTMANotificationsReadFromMaglevStorage","enableMTMANotificationsUnseenBehavior","enableRealTimeUpdatesToMissedMTMANotifications","enableUnreadToggle","enableVoicemailFeedItems","enabledCommunitiesActivities","enabledGenericActivities","mtmaNotificationsFetchMoreDebounceInterval","mtmaNotificationsPublishDebounceInterval"],activityNotification:["enableActivitySettingsV2","enableEnhancedSettingsExperience","enableEnhancedSettingsExperienceForApps","notificationFeedSettingsNoiseThreshold"],ageConsent:["ageGroup"],artifactsPlatform:["enable3SRTelemetry"],auth:["allowCdlWorkerToUpdateSetting","disableSTMFallback","disableSkipTokenRefreshForAnon","disableSkypeTokenOnCsa","disableSkypeTokenToMtInGtm","enableAsyncBatchScenario","enableCachedUser","enableMTO","enableRegionAndSTMHeadersOnCsa","enableSTMHeaderForAuthZ","enableSkypeTokenMigrationForMT","enableSkypeTokenMigrationForTrouter","forceRenewForAADToken","sendMigrationHeaderToMtInGtm","skypeTokenMigrationEnabled","skypeTokenMigrationServiceInfo","stmFallbackMapTimerInHr","stmSourceList"],autosuggest:["enable3SSharedChannelSuggestion","enable3sQueryTextSuggestionDelete","enableContextualSearchEntryPointInASTypeahead","enableContextualSearchEntryPointInZQ","enableDomainScopingV1","enableEDUSersInAutosuggest","enableExternalSearchSuggestions","enableMirroringDomainScoping","enableQuickActions","enableSearchBoxAlignmentWithSerp","enableSearchV2ForGuestInAutosuggest","enableSlashCommand","enableSubstrateInstrumentation","enableWPSSearch","learningSlotConfig","wpsSearchConfig"],calendar:["enableCalendarInviteRouting","enableM365CalendarToggle","enableRememberAnonymousExternalContacts","enableRememberingExternalUsersInCalendar","enableResolvingInTenantEmailsInPasting","enableWhiteboardCalendarTab"],calling:["addCountryCodeDuringNormalization","allowNonE164Mri","allowPrivateCallingPolicy","callHistorySettings","callLogsBlacklistedMRIs","commentStreamFetchPageSize","dialPlanPolicy","enableCallHistoryExternalTagging","enableCallsAppPhaseStateMachine","enableCapiV3Contacts","enableDialPlans","enableFixForDtmfTone","enableFormatNumberV2ForUI","enableFormattingFixForExtension","enableMeetingStartedNotificationV2","enableNewCallsBadging","enableNovaSpeedDial","enablePrivateLine","enablePstnWithExtnFix","enableRichCallHistory","enableRichCallHistoryExtension","enableSLABossTabsForMW","enableSLACallHistory","enableSLACallHistoryFromPersonalHistory","enableStarfieldBackgroundsPromo","enableStreamChatFeature","enableUpdatedGetVoicemailsPath","enableWhiteboardAG08","enableWhiteboardAG09","enableWhiteboardPolicy","forceCommentStreamForConversations","isFluidDefaultOn","meetingPolicy","sharedVoicemailServiceSettings","showCustomChatPaneErrorForNonChannelMember","stopNormalizationOnPlus","teamsVoiceApplicationsPolicy","useFluidWhiteboard","userIdPrefix","voicemailServiceSettings","yammerQnaGraphqlAuthEndpoint","yammerQnaGraphqlEndpoint"],cdlWorker:["conversationUpdatesBatchingConfig","currentConversationTableVersionGCC","disableLiveMessageUpdatesOverPNH","enableAvatarUserInfoCache","enableConversationFolderManagerStore","enableConversationTableVersionGCC","enableConversationUpdatesBatching","enableLiveMessagesNotificationsOverANS","enableLiveMessagesNotificationsOverTrouter","enableMTMAUserDataInMaglevStorage","enableTelemetryOnMachineActive","telemetryOnMachineActiveScenarioTimeoutMs"],channels:["enableAtMentionManyRecipientsWarningBanner","enableChannelCopilotInL2Header","enableChannelMessagesUserResolutionByUserDataLoader","enableInfoPaneUserFetchingByUserDataLoader"],chat:["enableRoleBasedChatPermissions"],chatList:["disablePinnedChatsInUserPreferences","enableChatListRawErrorLogging","enableShowMissedActivitiesInChatList","enableSmbAllDirectorySuggestedContacts","enableSmbChatListSuggestedContacts","enableSmbExternalChatListSuggestedContacts"],communities:["atMentionsSearchMembersLimit","atMentionsStorageExpiryTime","atMentionsStorageInvalidateTimeInMinutes","enableCommunitiesApp","enableCommunitiesAtMentionsEveryone","enableCommunitiesAtMentionsWorkerResolver","enableCommunitiesCreate","enableCommunitiesDetailedBadgeCount","enableCommunitiesJoinDialogForPostlink","enableCommunitiesJoinFlyout","enableCommunitiesOnNetworkInviteEmailToggle","enableDeltaProfilesFetchAtMention","enableMediaScanDeleteTombStone","enableMemberThreadDetailsSync","showTextScanDeletedPost","updateCommunitiesAtMentionLabelToEveryone"],compose:["enableDesignerInChannelAnnouncementPost","enableSendPostAsEmail"],core:["coreColdBootAppId","disableAppBarAppsSubscriptionThrottling","disableCachingM365SuggestedApps","disableTrouterConnectivityTracker","enable1JSEcsClient","enable1JSGraphqlSearchBox","enableCommunitiesBadgeCount","enableLocaleFilterForFeatureFlags","enablePersonalFlyoutSearch","enablePersonalFlyoutSuggestions","enablePlatformAppsBadgeCount","enablePoliciesPushUpdates","enableSupermassiveCDL","searchBoxSuggestions"],csaService:["apiConstantsGCC","chatsStartupCallMaxRetryCount","chatsStartupCallMaxRetryInterval","chatsStartupCallMinRetryInterval","chatsStartupCallStalledInterval","enableChatsStartupCallStalledTimeout"],diagnostics:["clientExtendedDiagnosticsData","consoleLogLevel","diagnosticsLogsThrottling","disableExtendedDiagnosticsDataToggle","enableWorkerStoreDiagnosticsLogsInIDB","logReporterSendCountInterval","logReporterSendErrorCountInterval","logReporterSendTimeInterval","loggerReportCountInterval","loggerReportTimeInterval","loggerThrottleList","logsMarkInterval","savingLogsIntoIDBThrottleTime","throttleCapacity","throttleWindowSizeMs","workerDiagnosticsEventQueueMaxSize","workerDiagnosticsLogBufferArraySize","workerDiagnosticsLogsIDBObjectCount"],discoverSurface:["enableHybridDiscoverSurface"],edu:["enableAssignmentsApp"],extensibility:["appSuggestionsExperiments","botDynamicCommandDebounceMaxWaitMs","botDynamicCommandDebounceMs","botDynamicCommandsSyncStrategyRefreshIntervalInMs","disableMessageExtensionsInMeeting","disabledTabAppIds","eduSelectAppEntityAllowList","enableAppServiceInPlatformService","enableBotDynamicCommandsSyncEngine","enableBotSsoV2","enableFilterPinnedAppsBasedOnPolicy","enableMessageExtensionInTFLCommunities","enablePowerbarMESearch","enableReactTaskModuleForBIM","enableStoreApiCapabilities","enableSuggestionsServiceOdataEndpoints","includeOpenAIPlugins","isSideLoadingInteractionEnabled","isUserPinningAllowed","ratingsOnRankingExperiment","storeApiCategoryMaxAgeInMinutes","storeApiMaxBackoffInMinutes","storeApiMinBackoffInMinutes","storeSearchSettings","teamsAppPermissionPolicyHash","teamsAppSetupPolicyHash","workflowApp"],files:["enableFilesPolicy","nativeFileEntryPoints"],flyout:["enableOverflowMenuInFlyout","enableScheduledMeetingsInForYou","enableTflFeaturedCommunitiesSync","frequentlyUsedContactsListSize","tflFeaturedCommunitiesSyncIntervalInMs"],homepage:["enableTflHomepage"],host:["enableRecordingAndTranscribingInCallsAppV2"],hostCapabilities:["phoneLinkingBlocked","storagePartition"],marketplace:["defaultMarket","deviceStoreCatalogCDNHost"],meet:["disableArtifactsStoreSubscription","disableDynamicJobQueuePriority","disableLazyLoadUpcomingEventDetails","disableMCUMeetAppScenario","disableMeetForWorkManager","disableMeetForWorkRecentRefreshStrategy","disableMeetForWorkScenarioDetails","disableReduceCalendarCallOnIntervalForUpcoming","disableThumbnailFromMCO","disableUpcomingPagination","enableCalendarEventCountTelemetry","enableCalendarTPSForRecent","enableFetchBeforeEnterMeetApp","enableFetchUserProfilesInBatch","enableFileRecommendation","enableMCUMeetAppScenario","enableMeetForWork","enableMeetForWorkCDL","enableMeetForWorkPrePin","enableMeetForWorkRecentRefreshStrategy","enableMockCalendarFetchError","enableMockMCOFetchError","enableMockMCUFetchError","enableMockMREFetchError","enableNativeMeetApp","enablePrefetchOnInterval","getThumbnailIgnoringMCU","graphqlBaseUrl","insightsProviderVersion","isMailboxDiscoverable","isOnCloud","mcuFlights","meetForWorkCDLSettings","mockFeatureForABTest","moreTelemetryForFetch","preFetchRecentAttendee","substrateBaseUrl","throttlePublishTime"],meetingArtifacts:["allowEngagementReportPolicy","enableBypassingEngagementReportPolicy","enableCheckCoOrganizerInRecentAttendanceReport","enableHidingOneOnOneMeetingAttendanceReportEntrances"],meetingRecap:["blockedMeetingTypesTemplateIds","convertROnlyToRnT","enableMergeSeriesMasterCollabObject","enableRecapTranscriptOnly","getDateOffset","recapDurationDaysOffset"],messaging:["allowUserChat","commCopilotSummarizationRequestConfig","copilotPluginServiceAuthUrl","copilotPluginServiceUrl","enableAutoDeleteV2","enableAutoEditV2","enableAutomaticTranslationV2","enableCallKMApiDirectly","enableChatPinEventErrorMessageLogging","enableChatWithMtoFederatedIdentity","enableConsumerConversations","enableHasTeamsProProtectionLicenseCheck","enableHideExternalLabelForMTOUsers","enableInOrganizationChatControl","enableInOrganizationChatControlFeature","enableMarkAllActivityMsgsInConvAsRead","enableMarkAllChannelsAsRead","enableMarkAllChatsAsRead","enableMeetingChatAutoUnmute","enableMtoUserChatBanner","enableOnDemandTranslation","enableRoamMessageDraft","enableTogetherEmojisV2","enableTopicInline","enableTopicInlinePreview","enableTopicSmartReplies","enableTopicSmartRepliesPreview","enableTopicsSdkWebWorker","inOrganizationChatControl","markAllAsReadBatchSize","msgEnableSfbCloudFromBVD","rejectNonAmsURLFromAsyncMediaService","sydneyPromptServiceAuthUrl","sydneyPromptServiceUrl","useKServingInTopicsSDK","vivaTopicsAriaCollectorUri"],metadata:["region"],notifications:["enableThrottleNotifications","enableUrgentToastsContentFixes","notificationThrottleTimeMs","showGenericNotificationsSoundSetting","showNotificationsCallsSoundSetting"],people:["allowScopedPeopleSearchandAccess","enableAtMentionInStatusNote","enableCapiv3MigrationStateCheckInLPC","enableDDRForProfileAndAvatarFreshness","enableExtendedDirectory","enableLPCOneGQLPerson","enableLPCPhotoViaOneGQLPerson","enableLabelingUsersByTrustLevel","enableLokiContactModifiedOnPersonMutation","enableNativeAvatarForMTO","enablePBCCreation","enablePBCsForEnterpriseOutTenantUsers","enablePeopleApp","enableSearchV2SearchForGuests","enableSilentLokiAuthTokenRetrieval","enableTfwUpdateGroupChatAvatar","experimentalPeoplePickerOrderChanges","lokiTokenResourceUrl","lpcOneGQLPersonDebugPrefix"],peopleTargeting:["customTagMode","disallowedSources","enableOwnersTag","enableOwnersTagInPrivateChannel","enableScheduledTags","enableTagsInPrivateChannels","ownersCanOverwriteTagSettings","suggestedTags","tagPermissions"],phonelinkSms:["csaPhonelinkSmsRequestTimeout","enablePhoneLinkSmsWhatsNew","enablePhonelinkOobeFlow","enablePhonelinkSms","phonelinkSmsDCGEndpoint","phonelinkSmsDCGResource"],platform:["deviceInfo"],presence:["enableAnonymousRequestsFiltering","enableAvailabilityComputationInCreateEndpointWorkflow","enableCallingClientState","enableMultipleGetPresenceFix","enablePresenceServiceRetries","enableRetrievingEndpointIdOnlyFromPresenceManager","enableSkipPresenceSyncWhileLongInactive","enableUnknownPresenceFixTest","presenceServiceMaxRetries"],queues:["enableRealTimeStatsForQueuesApp","enableRealTimeStatsForQueuesAppOnStartUp","queuesRtaSignalRServiceSettings","queuesRtaVoiceAppsServiceSettings"],search:["enablePeopleSearchV2"],serp:["enableClientVersionHeader","groupChatSettingConfig","substrateInstrumentationClientVersion","substrateTokenUrl","teamChannelSearchConfig"],smb:["enableTenantDirectoryStateMachine","externalTopNSuggestionsCacheExpiry","tenantDirectoryCacheExpiryMinutes"],sync:["disableUserActivityReportingOnTrouterConnect","messageSyncColdBootMaxCallCount"],teamsAndChannels:["enableAutoFavoriteChannel","enableChannelActiveCallsResolver","enablePrivateChannelOnLWGT2","enableReactJoinTeamsGallery","enableRecommendedTeamsSync","enableSensitivityLabelPrivacyValidationOptInBehavior","enableShareWithTeamSensitivityLabelEnforcementReact","enableSharedChannelLieCreation","enableStaleChannelsFlow","enableStaleTeamsFlow","enableT2ChannelsAtMentionBadging","enableT2ChannelsBadgingAppBar","enableTeamsAndChannelsUserResolutionByUserDataLoader","enableUserFetchForJoinTeamGallery","enableUserResolutionForChannelModeratorList","privateChannelsOnLWGAllowedGroupsListT2","recommendedTeamsCacheIntervalInHours","staleTeamsAbsentTotalDays","staleTeamsCalculationChannelsLimit","staleTeamsCalculationTeamsLimit","staleTeamsFavoritedTotalDays","staleTeamsInactiveTotalDays","staleTeamsMinimumTotalTeams","staleTeamsRunJobInterval"],telemetry:["enableWorkerBroadcast","samplingRules"],test:["testAutomation"],userResources:["isSfbCloud","isSfbCloudInBVD","isSipEnabled","isSipEnabledInBVD","isTenantAdmin"],whatsNew:["chatViaSms","communities5k","communitiesBeta","communitiesCreate","contactsSync","designerInChannelAnnouncementPost","enableEntryPointPromotions","enableWhatsNew","flyoutInlineChat","flyoutV2","gamebarWidget","maxFeaturesInOverlayCount","maxValidFromDaysToBeShown","mobileDownloadQrPromo","onDemandTranslations","peopleExperience","phonelinkSms","polls","sendPostAsEmail","starfieldBackgroundsPromo","togetherEmojisHighFive"],windowsSignatureExperiences:["enableGamebarWidgetWhatsNew","enableHighFiveTogetherEmojis"]};var Uu=i(891822);class $u{constructor(e,t,i,n,a,s,o,r,c){this.configLoader=e,this.coreSettings=t,this.coreSettingsContext=i,this.platformService=a,this.primaryUser=s,this.locale=o,this.osLocale=r,this.osLocaleInfo=c,this._settings={},this.cdlWorkerSettingsAllowlist=Lu,this.logger=n.newLogger("CDLWorkerHostSettingsAggregator","core-services-cdl-worker")}get hostSettings(){return 0===Object.keys(this._settings).length&&(this._settings=this.getAllWorkerSettings()),this._settings}startNotifyingCDLWorkerForHostSettingsChanges(e){const t=this.coreSettings.getObservableForAnySettingsChangeForCdlWorker();this.settingsChangedSubscription=t.subscribe((()=>{this.notifyCDLWorkerForSettingsChanges(e)}))}cleanup(){var e;null===(e=this.settingsChangedSubscription)||void 0===e||e.unsubscribe(),this.settingsChangedSubscription=void 0}notifyCDLWorkerForSettingsChanges(e){const t=this.getAllWorkerSettings();(0,B.isEqual)(this._settings,t)||(this._settings=t,this.logger.log("Notifying CDL Worker of host settings changes: ",t),e.sendRequest({type:"host_settings_updated",hostSettings:t}))}getAllWorkerSettings(){const e=this.getCdlWorkerSettings(this.coreSettings);return Object.assign(Object.assign({},e),{[S.J.Host]:(0,B.mergeWith)(e.host||{},this.aggregateHostSettings(),Ru.g)})}aggregateHostSettings(){var e;this.logger.debug("aggregateHostSettings called...");const{enableNetworkStateCommsBetweenCoreAndWorker:t,enableMTMA:i}=this.coreSettings.get(S.J.Core),{electronVersion:n,enableHybridChannelList:a=!1,msgEnableChannelsV2:s=!1,msgEnableChannelsV2Header:o=!1,msgEnableSelfChat:r=!1,userType:c="",windowsInsiderChannel:l}=this.coreSettings.get(S.J.Host),d=this.coreSettingsContext,{enableTPSSyncStrategy:u,enableTPSUpdatesOverTrouter:m,tpsSyncStrategyPollingIntervalMs:g,enablePinnedChannelUpdatesOverTPS:p}=this.coreSettings.get(S.J.CdlWorker);let v=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({enableNetworkStateCommsBetweenCoreAndWorker:!!t,enableMTMA:!!i,policiesNamespaces:(0,Uu.z$)(this.configLoader,this.coreSettings,this.logger),enableSyncEngine:(0,xu.Q6)(this.coreSettings),enableProfileManagerStore:(0,xu.bE)(this.coreSettings),enableMessagingNotificationsOverTrouter:this.isMessagingNotificationsOverTrouterEnabled(),imageCookieAuthEnabled:!this.coreSettings.get(S.J.Auth).skipAmsAuthRequest,msgEnableChannelsV2:s,msgEnableChannelsV2Header:o,msgEnableSelfChat:r,enableHybridChannelList:a,enableEspInWorker:!!this.coreSettings.get(S.J.Esp).enableEsp,espIrisExperimentFlightIds:this.coreSettings.get(S.J.Esp).espIrisExperimentFlightIds,espIrisPlacementId:this.coreSettings.get(S.J.Esp).espIrisPlacementId,ecsHostUrl:this.platformService.ecsOverrides.hostUrl,desktopVersion:this.platformService.host.hostAppVersion,initialWorkerHostLocationUrl:this.platformService.config.currentUrl,serviceSwitcherSelectedServiceId:d.getServiceSwitcherApiKey(),electronVersion:n,locale:this.locale||h.ZW,osLocale:this.osLocale,osLocaleInfo:this.osLocaleInfo,userType:c,windowsInsiderChannel:l,enableTPSSyncStrategy:!!u,enableTPSUpdatesOverTrouter:!!m,enablePinnedChannelUpdatesOverTPS:!!p,tpsSyncStrategyPollingIntervalMs:g},this.getCdlWorkerHostSettings(this.coreSettings)),this.getActivityHostSettings(this.coreSettings)),this.getActivityNotificationHostSettings(this.coreSettings)),this.getEndpointsHealthHostSettings(this.coreSettings)),this.getPeopleHostSettings(this.coreSettings)),this.getMessagingHostSettings(this.coreSettings)),this.getTeamsAndChannelsHostSettings(this.coreSettings)),this.getCalendarHostSettings(this.coreSettings)),this.getExternalAccountHostSettings(this.coreSettings)),this.getPresenceHostSettings(this.coreSettings)),this.getDataStoreHostSettings(this.coreSettings)),this.getFilesHostSettings(this.coreSettings)),this.getAuthHostSettings(this.coreSettings)),this.getDiscoverSurfaceHostSettings(this.coreSettings)),this.getMtmaSpecificHostSettings()),this.getGuardiansHostSettings(this.coreSettings)),f=this.getCoreSettingsTestOverrides(this.coreSettingsContext);const{isRunningGlassjar:b}=this.coreSettings.get(S.J.Test);if(this.platformService.config.isInCypressFrame||b){const t={authOverrides:{authzEndpointUrl:this.coreSettings.get(S.J.Auth).authzEndpointUrl},csaOverrides:{csaHostUrl:null===(e=this.coreSettings.get(S.J.CsaService).apiConstants)||void 0===e?void 0:e.host}};v=Object.assign(Object.assign({},v),t),f={localStorageTestOverrides:Object.assign(Object.assign({},f.localStorageTestOverrides),{test:{}}),qspTestOverrides:f.qspTestOverrides}}return Object.assign(Object.assign({},v),f)}getCdlWorkerSettings(e){var t;const i=this.getAllowlistedCdlWorkerSettings(),n={[S.J.Messaging]:{allowUserChat:this.getAllowUserChat(e)},[S.J.Calling]:{callGroupMembershipSettings:null===(t=this.coreSettings.get(S.J.Calling).voiceAdminSettings)||void 0===t?void 0:t.callGroupMembershipSettings}};let a={};return Object.values(S.J).forEach((e=>{const t=(0,B.merge)({},i[e],n[e]);Object.keys(t).length>0&&(a=Object.assign(Object.assign({},a),{[e]:t}))})),a}getAllowlistedCdlWorkerSettings(){const e={};return Object.keys(this.cdlWorkerSettingsAllowlist).forEach((t=>{var i;const n=this.coreSettings.get(t),a={};null===(i=this.cdlWorkerSettingsAllowlist[t])||void 0===i||i.forEach((e=>{const t=(0,B.get)(n,e);(0,B.isNil)(t)||(0,B.set)(a,e,t)})),Object.keys(a).length>0&&(e[t]=a)})),e}getAllowUserChat(e){const{allowUserChat:t,messagingPolicy:i}=e.get(S.J.Messaging);return"boolean"==typeof t||!!i?!!t:void 0}getPresenceHostSettings(e){const{enablePresenceInWorker:t,enablePresenceNotificationsOverTrouter:i,enableReportingUserActivityThroughTrouterByPresence:n,enablePriorityContactsSettings:a,enableSendPresenceTokenToUPS:s,upsTrouterConnectEndpointRecreateDelayInMs:o,priorityContactsRefreshIntervalInMs:r}=e.get(S.J.Presence);return{enablePresenceInWorker:Boolean(t),enablePresenceNotificationsOverTrouter:Boolean(i),enableReportingUserActivityThroughTrouterByPresence:Boolean(n),enablePriorityContactsSettings:Boolean(a),enableSendPresenceTokenToUPS:Boolean(s),upsTrouterConnectEndpointRecreateDelayInMs:null!=o?o:0,priorityContactsRefreshIntervalInMs:null!=r?r:0}}getAuthHostSettings(e){const{skypeTokenValidationDisabled:t}=e.get(S.J.Auth);return{skypeTokenValidationDisabled:!!t}}getCdlWorkerHostSettings(e){const t=e.get(S.J.CdlWorker);return{enableClassBasedErrors:!!t.enableClassBasedErrors,enablePoliciesSyncEngine:!!t.enablePoliciesSyncEngine,enableCrossTenantPoliciesSyncEngine:!!t.enableCrossTenantPoliciesSyncEngine,enableOpenWindowsSettingsMaglev:!!t.enableOpenWindowsSettingsMaglev,enableSendNudgeAfterInactivityPeriod:!!t.enableSendNudgeAfterInactivityPeriod,enableMeetNowLinksReminder:!!t.enableMeetNowLinksReminder,enableNotificationsEngine:!!t.enableNotificationsEngine,enableAppsUsageSyncEngine:!!t.enableAppsUsageSyncEngine,enableUserPreferencesWorkerFetch:!!t.enableUserPreferencesWorkerFetch,enableAppsPlatformSyncEngine:!!t.enableAppsPlatformSyncEngine,enableAppsPlatformTrouterUpdates:this.isMessagingNotificationsOverTrouterEnabled()&&!!t.enableAppsPlatformTrouterUpdates,enableChatWithUserNetworkFetch:!!t.enableChatWithUserNetworkFetch,enableOfflineActionsSyncEngine:!!t.enableOfflineActionsSyncEngine,enableStartupDeferral:!!t.enableStartupDeferral,enableTenantSyncStrategy:!!t.enableTenantSyncStrategy,enableSearchTopNPopulateStrategy:!!t.enableSearchTopNPopulateStrategy,enableSensitivityLabelSync:!!t.enableSensitivityLabelSync,enableWaitOnAuthUp:!!t.enableWaitOnAuthUp,enableStartupUsingPartialData:!!t.enableStartupUsingPartialData,enableNonRecentChatsStartup:!!t.enableNonRecentChatsStartup,nonRecentChatsStartupPageSize:t.nonRecentChatsStartupPageSize,nonRecentChatsStartupMaxCalls:t.nonRecentChatsStartupMaxCalls,nonRecentChatsStartupWorkflowTimeoutInMS:t.nonRecentChatsStartupWorkflowTimeoutInMS,chatsStartupJobPageSize:t.chatsStartupJobPageSize,chatListCacheDaysThreshold:t.chatListCacheDaysThreshold,partialDataStartupChatsLimit:t.partialDataStartupChatsLimit,partialDataStartupSkipNonRecentMeeting:t.partialDataStartupSkipNonRecentMeeting,skipMeetingChatsInGroupChatSync:!!t.skipMeetingChatsInGroupChatSync,enableChatTitleCache:!!t.enableChatTitleCache,enableMruChannelsMemoryPruning:!!t.enableMruChannelsMemoryPruning,disableUnknownTitleFallback:!!t.disableUnknownTitleFallback,disableTitleCacheRefreshOnDisplayNameChange:!!t.disableTitleCacheRefreshOnDisplayNameChange,disablePartialLoadConversationNetworkFetch:!!t.disablePartialLoadConversationNetworkFetch,enableMultipleReplyChainsUpdatesFromWorker:!!t.enableMultipleReplyChainsUpdatesFromWorker,enableMTMAAggregator:!!t.enableMTMAAggregator,disablePingingPDSIfWorkerStartupFails:t.disablePingingPDSIfWorkerStartupFails,currentConversationTableVersion:t.currentConversationTableVersion,disableMessageContentWrapperDiv:t.disableMessageContentWrapperDiv,enablePriorityJobRunner:!!t.enablePriorityJobRunner,scheduleChannelsConversationSyncAtBackgroundPriority:!!t.scheduleChannelsConversationSyncAtBackgroundPriority,trouterNotifyServiceDownTimerMs:t.trouterNotifyServiceDownTimerMs,chatServiceMaxPageSize:t.chatServiceMaxPageSize,chatReplyChainsToFetch:t.chatReplyChainsToFetch,preloadNamespaces:t.preloadNamespaces,enableBypassSortAndDedupe:!!t.enableBypassSortAndDedupe}}getActivityHostSettings(e){const t=e.get(S.J.Activity);return{enableActivityManagerStore:!!t.enableActivityManagerStore,enableActivityBellCount:!!t.enableActivityBellCount,feedItemsCountOnAppLoad:t.paginationFirstLoad||0,enableOrderFeedsReplyChainsByMaxVersion:!!t.enableOrderFeedsReplyChainsByMaxVersion,enableChannelFeedItems:!!t.enableChannelFeedItems,enableActivityTranslationInCDL:!!t.enableActivityTranslationInCDL,enableMarkAllAsReadLogic:!!t.enableMarkAllAsReadLogic,enableSharedChannelFeedItems:!!t.enableSharedChannelFeedItems,enableUrgentFeedItems:!!t.enableUrgentFeedItems,enableSyntheticNotificationProcessor:!!t.enableSyntheticNotificationProcessor,enableGraphFeedItems:!!t.enableGraphFeedItems,disableIncomingPstnActivityFeed:!!t.disableIncomingPstnActivityFeed,enableMTMAMissedNotifications:!!t.enableMTMAMissedNotifications,mtmaNotificationsPollingInterval:t.mtmaNotificationsPollingInterval||$u.mtmaNotificationsPollingIntervalDefault}}getActivityNotificationHostSettings(e){const{enableNewSettingsApiUse:t,enableMissedActivityEmails:i}=e.get(S.J.ActivityNotification);return{enableNewSettingsApiUse:!!t,enableMissedActivityEmails:!!i}}getPeopleHostSettings(e){const t=e.get(S.J.People);return{enableBuddyListService:!!t.enableBuddyListService,buddyListRefreshTimeoutInMilliSeconds:t.buddyListRefreshTimeoutInMilliSeconds||0,blockedListRefreshIntervalInMs:t.blockedListRefreshIntervalInMs||0,blockedListPendingActionQueueChunkSize:t.blockedListPendingActionQueueChunkSize||0,enableContactsSync:!!t.enableContactsSync,enableMultipleAliasesForContactsSync:!!t.enableMultipleAliasesForContactsSync,maxNumberOfRoamingDevices:t.maxNumberOfRoamingDevices||0,enableInstantSyncForRoamingDevices:!!t.enableInstantSyncForRoamingDevices,fetchTFLContactsRefreshInterval:t.fetchTFLContactsRefreshInterval||[],enableEndpointsManagerOnAcceptListService:!!t.enableEndpointsManagerOnAcceptListService,enableEndpointsManagerOnBuddyService:!!t.enableEndpointsManagerOnBuddyService,enableEndpointsManagerOnBlockService:!!t.enableEndpointsManagerOnBlockService,contactsSyncDeltaRefreshIntervalInMs:t.contactsSyncDeltaRefreshIntervalInMs||0,contactsSyncFullRefreshIntervalInMs:t.contactsSyncFullRefreshIntervalInMs||0,contactsSyncKeepAliveIntervalInMs:t.contactsSyncKeepAliveIntervalInMs||0,maxBatchSizeforSCDDeletion:t.maxBatchSizeforSCDDeletion||0,lokiTokenResourceUrl:t.lokiTokenResourceUrl||"",buddyServiceEndpointManagerMaxRetries:t.buddyServiceEndpointManagerMaxRetries||0,enableTflTfwFederation:!!t.enableTflTfwFederation,enableProfilePicturesWithObjectId:!!t.enableProfilePicturesWithObjectId,enableMeProfileSyncStrategy:!!t.enableMeProfileSyncStrategy,checkProfileExpiryAndRefreshIntervalInMs:t.checkProfileExpiryAndRefreshIntervalInMs||0,enableTfwToTfwFederatedInviteFree:!!t.enableTfwToTfwFederatedInviteFree,enableBlockedContactsDataStore:!!t.enableBlockedContactsDataStore,enableM365Endpoint:!!t.enableM365Endpoint,enableExtendedDirectory:!!t.enableExtendedDirectory,enableCapiv3ContactsSync:!!t.enableCapiv3ContactsSync,enableSharedChannelPeoplePickerErrorMessages:!!t.enableSharedChannelPeoplePickerErrorMessages,enableProfileFetchFromWorkingSet:!!t.enableProfileFetchFromWorkingSet,enableAtMentionEveryoneInGroupChat:!!t.enableAtMentionEveryoneInGroupChat,enableAtMentionEveryoneInMeetingChat:!!t.enableAtMentionEveryoneInMeetingChat,enableAddAnonDisplayNameTagsInProfile:!!t.enableAddAnonDisplayNameTagsInProfile}}getMessagingHostSettings(e){const t=e.get(S.J.Messaging);return{enableChatWithNonTflUsers:!!t.enableChatWithNonTflUsers,enableCSAChatSummarization:!!t.enableCSAChatSummarization,enableCSAChatSummarizationV2:!!t.enableCSAChatSummarizationV2,chatSummarizationTimeoutOverride:t.chatSummarizationTimeoutOverride,enableTflSmsCreate:!!t.enableTflSmsCreate,enableTfwTflFederation:!!t.enableTfwTflFederation,enableTfwFederationOnTfl:!!t.enableTfwFederationOnTfl,enableTFLSmsFriendlyNameSearch:!!t.enableTFLSmsFriendlyNameSearch,tflSmsAllowedPhoneNumberRegionCodes:t.tflSmsAllowedPhoneNumberRegionCodes||[],disableMessagingSyncEngine:!!t.disableMessagingSyncEngine,enableAutoSendV2:!!t.enableAutoSendV2,disableRendererSideSanitization:!!t.disableRendererSideSanitization,enableTranslationSettings:!!t.enableTranslationSettings,enableSingleInbox:!!t.enableSingleInbox,enableTagsMention:!!t.enableTagsMention}}getTeamsAndChannelsHostSettings(e){const t=e.get(S.J.Channels),i=e.get(S.J.TeamsAndChannels);return{enablePinnedChannelsSyncEngine:!!i.enablePinnedChannelsSyncEngine,maximumPinnedChannelLimit:i.maximumPinnedChannelLimit,pinnedChannelsSyncIntervalInMs:i.pinnedChannelsSyncIntervalInMs,enableFixingPinnedChannelsConflict:!!i.enableFixingPinnedChannelsConflict,enableUserResolutionForChannelModeratorList:!!i.enableUserResolutionForChannelModeratorList,enableRecommendedTeamsSync:!!i.enableRecommendedTeamsSync,allowChannelSharingToExternalUser:!!i.allowChannelSharingToExternalUser,enableChannelInfoPane:!!t.enableChannelInfoPane,enableUseT1LocaleInTranslation:!!t.enableUseT1LocaleInTranslation,enableChannelsUserResolutionInT21:!!t.enableChannelsUserResolutionInT21,allowGuestUser:!!i.allowGuestUser}}getCalendarHostSettings(e){const t=e.get(S.J.Calendar);return{autodiscoverSettings:t.autodiscoverSettings,calendarRESTEnabledAPIs:t.calendarRESTEnabledAPIs,connectedCalendarSettingsRefreshIntervalInMs:t.connectedCalendarSettingsRefreshIntervalInMs||0,enableCalendarSyncEngine:!!t.enableCalendarSyncEngine,enableCalendarV2ApiService:!!t.enableCalendarV2ApiService,enableCalendarV2ApiServiceEnterprise:!!t.enableCalendarV2ApiServiceEnterprise,enableCalendarManagerPrefetchInMemoryData:!!t.enableCalendarManagerPrefetchInMemoryData,enableClientStateCheckForCalendarPolling:!!t.enableClientStateCheckForCalendarPolling,enableMultipleCalendarSyncEngine:!!t.enableMultipleCalendarSyncEngine,enableUnifiedCalendarSyncEngine:!!t.enableUnifiedCalendarSyncEngine,enableConnectedCalendar:!!t.enableConnectedCalendar,enableConnectedCalendarSettingsSync:!!t.enableConnectedCalendarSettingsSync,enableCourseCalendarSyncEngine:t.enableCourseCalendarSyncEngine,enableEventFetchOptimizationUsingLastSync:t.enableEventFetchOptimizationUsingLastSync,enableMeetingArtifactsCollaborationData:t.enableMeetingArtifactsCollaborationData,enablePrefetchCourseCalendarEventsOnStartUp:t.enablePrefetchCourseCalendarEventsOnStartUp,isOnCloud:t.isOnCloud,maxRoomListsToFetch:t.maxRoomListsToFetch,maxRoomsInRoomListToFetch:t.maxRoomsInRoomListToFetch,maxRoomsToFetch:t.maxRoomsToFetch,enableThirdPartyCalendar:!!t.enableThirdPartyCalendar,calendarEventsPollIntervalInMs:t.calendarEventsPollIntervalInMs,calendarEventsPollIntervalWithPushInMs:t.calendarEventsPollIntervalWithPushInMs,isLmsCourseCalendar:!!t.isLmsCourseCalendar,enablePrefetchCalendarEventsOnStartUp:!!t.enablePrefetchCalendarEventsOnStartUp,enableSensitivityLabelInCalendar:!!t.enableSensitivityLabelInCalendar,enableCalendarPushNotifications:!!t.enableCalendarPushNotifications,enableCalendarPollingWithPushNotifications:!!t.enableCalendarPollingWithPushNotifications,enableCalendarGCVOptimizations:!!t.enableCalendarGCVOptimizations,enableCalendarMailBoxDiscoveryHandler:!!t.enableCalendarMailBoxDiscoveryHandler,enablePushCalendarEventsOnSubscription:!!t.enablePushCalendarEventsOnSubscription}}getExternalAccountHostSettings(e){const{enableExternalAccounts:t,requestSource:i,enableUnifiedHardDelete:n}=e.get(S.J.ExternalAccounts);return{enableExternalAccounts:!!t,requestSource:i,enableUnifiedHardDelete:!!n}}getEndpointsHealthHostSettings(e){const{enableWorkerEndpointsHealthMonitor:t,enableWorkerEndpointsHealthService:i}=e.get(S.J.Core);return{enableWorkerEndpointsHealthMonitor:!!t,enableWorkerEndpointsHealthService:!!i}}getDataStoreHostSettings(e){const t=e.get(S.J.CdlWorker);return{enableDbOpenTimeout:!!t.enableDbOpenTimeout,dbOpenTimeoutLengthSeconds:t.dbOpenTimeoutLengthSeconds||60,dataStoreMapType:t.dataStoreMapType||"",disableDataStoreInMemoryProvider:!!t.disableDataStoreInMemoryProvider,disableDataStoreDbProvider:!!t.disableDataStoreDbProvider,rollbackSupportInDataStoreInMemoryProvider:!!t.rollbackSupportInDataStoreInMemoryProvider,disableReplyChainManagerPrefetch:!!t.disableReplyChainManagerPrefetch,dataStoreCreationResiliencyConfig:t.dataStoreCreationResiliencyConfig||{enable:!1},disableRetryOnStoreMissing:!!t.disableRetryOnStoreMissing,dataStoreDbOperationResiliencyConfig:t.dataStoreDbOperationResiliencyConfig,enableConversationTypeIndex:!!t.enableConversationTypeIndex}}getCoreSettingsTestOverrides(e){const t=e;return{localStorageTestOverrides:t.getLocalStorageTestOverrides()||{},qspTestOverrides:t.getQspTestOverrides()||{}}}getFilesHostSettings(e){const{preferGraphOverVroom:t,vroomEndpointBaseUrl:i,graphEndpointBaseUrl:n,graphAuthScope:a,vroomAuthScope:s}=e.get(S.J.Files);return{filesOverrides:{preferGraphOverVroom:!!t,vroomEndpointBaseUrl:i||"",graphEndpointBaseUrl:n||"",graphAuthScope:a||"",vroomAuthScope:s||""}}}getDiscoverSurfaceHostSettings(e){const t=e.get(S.J.DiscoverSurface);return{enableHybridDiscoverSurface:!!t.enableHybridDiscoverSurface,discoverSurfaceTopItemsCount:t.discoverSurfaceTopItemsCount||Ou.$O.defaultItemsToFetch,enableNewPollingChanges:!!t.enableNewPollingChanges,disableDiscoverNetworkCall:!!t.disableDiscoverNetworkCall,discoverSurfaceDefaultSection:t.discoverSurfaceDefaultSection||Ou.$O.defaultSection,enableDiscoverSurfaceDebugMenu:!!t.enableDiscoverSurfaceDebugMenu,serverCacheRetentionTimeInHrsSinceFirstCall:t.serverCacheRetentionTimeInHrsSinceFirstCall||Ou.$O.defaultServerCacheRetentionTimeInHrsSinceFirstCall,enableDiscoverBadging:!!t.enableDiscoverBadging,dataSyncIntervalTime:t.dataSyncIntervalTime||Ou.$O.defaultDataSyncIntervalTime,enableDiscoverSurfaceSyncEngine:!!t.enableDiscoverSurfaceSyncEngine}}getMtmaSpecificHostSettings(){const{enableMTMA:e}=this.coreSettings.get(S.J.Core);return e&&this.primaryUser&&this.primaryUser.profile?{primaryUserProfile:{oid:this.primaryUser.profile.objectId,tid:this.primaryUser.profile.tenantId}}:{}}isMessagingNotificationsOverTrouterEnabled(){const e=this.coreSettings.get(S.J.Host).enableMessagingNotificationsOverTrouter;return(0,B.isNil)(e)?!!this.coreSettings.get(S.J.CdlWorker).enableMessagingNotificationsOverTrouter:e}getGuardiansHostSettings(e){const{enableGuardiansPreferredMethodAndSmsInvite:t}=e.get(S.J.Guardians);return{enableGuardiansPreferredMethodAndSmsInvite:t}}}$u.mtmaNotificationsPollingIntervalDefault=3e5;class Wu{constructor(){this.perfDataByOperationName=new Map,this.cdlSubscriptionAggregatorAllowList=["chatServiceEvent","DataResolversBrowserChatServiceEventsChatServiceBatchEventSubscription","DataResolversBrowserChatServiceEventsChatServiceEventSubscription"]}static getInstance(){return this.subscriptionEventAggregatorSingleton||(this.subscriptionEventAggregatorSingleton=new Wu),this.subscriptionEventAggregatorSingleton}init(e,t,i,n){var a;this.logger=e.newLogger("SubscriptionEventAggregator","core-cdl-data-layer-client"),i&&(this.cdlSubscriptionAggregatorAllowList=i),null===(a=this.logger)||void 0===a||a.log(`Initialized CDLSubscriptionEventAggregator Allow List: ${this.cdlSubscriptionAggregatorAllowList.join(",")}`),this.intervalCancellationToken=setInterval((()=>{this.logStats(t)}),n||G.A_)}addToTimeline(e,t,i,n,a,s,o){if(this.intervalCancellationToken||this.init(i,n,a,o),!t)return void(this.logger&&this.logger.log("Received subscription perf stat without responseSendTime. Ignoring."));const r=Date.now()-t;if(!(r<0)&&(e&&!this.perfDataByOperationName.has(e)&&this.perfDataByOperationName.set(e,{ipcTimes:[],customIdentifierCount:{}}),e)){const t=this.perfDataByOperationName.get(e);if(!t)return void(this.logger&&this.logger.warn(`SubscriptionEventAggregator: No perf data found for operationName ${e}`));if(t.ipcTimes.push(r),s){let e={};e="string"==typeof s?{[s]:1}:s,Object.keys(e).forEach((i=>{const n=e[i];t.customIdentifierCount[i]||(t.customIdentifierCount[i]=0),t.customIdentifierCount[i]+=n}))}}}logStats(e){const t=Array.from(this.perfDataByOperationName.entries());this.perfDataByOperationName.clear();for(const[i,n]of t){if(!this.cdlSubscriptionAggregatorAllowList.includes(i))continue;const t={operationName:i,numberOfRequests:n.ipcTimes.length,averageIPCTimeOneWay:n.ipcTimes.reduce(((e,t)=>e+t),0)/n.ipcTimes.length},a=e.newScenario(z.RG.CentralDataLayerSubscription);(0,B.keys)(n.customIdentifierCount).forEach((e=>{a.mark(e,{size:n.customIdentifierCount[e],type:e})})),a.stop(t)}}}function Bu(e,t,i,n,a){var s,o;let r;if(function(e,t,i){return!e.some((e=>{var n,a;const s=t.getEntriesByName(e);return null===(n=i.infoToTelemetry)||void 0===n||n.call(i,`Marker performance information ${e}!`,"telemetry_instrumentation_capture_perf_measurement",void 0,!1),s.length<=0&&(null===(a=i.errorToTelemetry)||void 0===a||a.call(i,`Measure ${e} was never created!`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0),!0)}))}([t,i],n,a))try{n.measure(e,t,i);const a=n.getEntriesByName(e)[0];r=null==a?void 0:a.duration,r&&(r=Math.round(r)),n.clearMeasures(e)}catch(e){null===(s=a.errorToTelemetry)||void 0===s||s.call(a,`Failed to capture measurement between ${t} and ${i}: ${e}`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0)}else null===(o=a.errorToTelemetry)||void 0===o||o.call(a,`Can not capture measurement between ${t} and ${i}, at least one of them not exist`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0);return r}function zu(e,t,i,n){e.measure(t,i,n),e.clearMeasures(t),e.clearMarks(i),n&&e.clearMarks(n)}class Hu{constructor(e,t,i){this.isResponse=t,this.internalPerfStat={operationName:i,requestStartTime:{perf:performance.now(),date:Date.now()},responseReceivedTime:{perf:performance.now(),date:Date.now()},workerResponseTime:0,dataStorePerfStats:[]},this.operationName=i||"",this.operationType=e,performance.mark(`${this.getPerformanceName()}-start`)}stopMeasurement(e,t,i){this.internalPerfStat=Object.assign(Object.assign(Object.assign({},this.internalPerfStat),e),{responseReceivedTime:{perf:performance.now(),date:Date.now()}});const n=this.getPerformanceName(),a=`${n}-start`,s=`${n}-end`;!function(e,t){void 0===function(e,t){const i=t.getEntriesByName(e);if(i&&i.length>0)return i[0]}(e,t)&&t.mark(e)}(a,performance),performance.mark(s),zu(performance,n,a,s);const{requestStartTime:o,requestReceivedTime:r,responseSendTime:c,responseReceivedTime:l,workerResponseTime:d}=this.internalPerfStat,u={totalRequestTime:Math.round(l.perf-o.perf),workerResponseTime:Math.round(d),requestTime:Math.round(o.perf),responseTime:Math.round(l.perf)};return(null==t?void 0:t.length)&&(u.otherResponsesReceivedWhileInTransit=t),i&&(u.responseReceiveLatency=i),r&&(u.requestIPCTime=r-o.date),c&&(u.responseIPCTime=l.date-c),u}static markSubscriptionRequest(e){const t=`subscription_request_start_${e}`,i=`subscription_request_${e}`;performance.mark(t),zu(performance,i,t)}static addSubscriptionResponse(e,t,i,n,a,s,o){Wu.getInstance().addToTimeline(e,t,i,n,s,a,o)}getPerformanceName(){return`cdl-${this.isResponse?"response":"request"}-${this.operationName||this.operationType}`}}const qu=["callParticipantsVoiceLevelsChangedEvent","callParticipantsChangedEvent"],Vu=["callingIntent","chat","messageList"],Gu=["putConversations"],Ju="debug";class Ku{constructor(e,t,i,n,a,s,o,r,c,l,d,u=[],m,g,h,p,v,f){var b;if(this.variables=i,this._logger=s,this.loggerFactory=o,this.scenarioFactory=r,this.syncEngineInitializationPromise=c,this.rendererId=l,this.requestHealthMonitor=m,this.enableClassBasedErrors=g,this.cdlOperationCustomContext=p,this.splitFetchWaitMarkerInWLT=v,this.dataLayerClientSettings=f,this._perfStats=null,this._perfStatsForResponseProcessing=null,this._scenario=void 0,this._startTime=Date.now(),this._lastUpdateTime=null,this._requestId=e,this._windowId=d,this._requestType=t,"subscription"!==t?this._perfStats=new Hu(t,!1,a):Hu.markSubscriptionRequest(a),this._requestComplete=!1,this._operationName=a,this._loggingContext={requestId:e,component:"RequestHandler",requestRendererId:this.rendererId,requestWindowId:this.windowId,hostRendererId:n,operationType:t,operationName:a},u=u&&u.length?u:Gu,this.subject=new pd(this._logger,this._loggingContext),this.logRequest(),a&&!u.includes(a)&&"subscription"!==t){this._scenario=this.scenarioFactory.newScenario(z.RG.CentralDataLayerRequest),this._scenario.clientName=a;const e=this.getActiveCPM();if(this._scenario.appendEventData({operationName:a,operationType:t,context:this.rendererId,"Panel.WindowID":this.windowId,target:h,correlationId:null==p?void 0:p.callerScenarioId,origin:null==p?void 0:p.callerInfo,activeCPM:e}),this.isRequestFromWindowLaunch(a,r)){r.startStep(z.RG.WindowLaunchTime,z.ck.FetchWait);const e=this.scenarioFactory.findScenario(z.RG.WindowLaunchTime);this._wltTimestampsAtInit=null==e?void 0:e.timestamps.length}}null===(b=this.requestHealthMonitor)||void 0===b||b.requestCreated(this),this.syncEngineInitializationPromise.then((e=>{var t;if(!e.isSyncEngineInitialized)throw Error();null===(t=this._scenario)||void 0===t||t.appendEventData({messagingSyncEngineStartupMode:e.bootType})})).catch((()=>{var e;null===(e=this._scenario)||void 0===e||e.appendEventData({messagingSyncEngineStartupMode:"Error"})}))}get requestId(){return this._requestId}get windowId(){return this._windowId}get response(){return this.subject.observable}get requestType(){return this._requestType}get operationName(){return this._operationName}isComplete(){return this._requestComplete}setResponseAndEndScenario(e,t,i){var n,a,s;const o=!e.errors&&e.data;this._otherResponsesReceivedWhileInTransit=t,this._responseReceiveLatency=i,o?(this._perfStatsForResponseProcessing=new Hu(this.requestType,!0,this.operationName),this.onSuccess(e)):this.onError(e),this.onComplete(o?"success":"error"),o&&(null===(n=e.extensions)||void 0===n?void 0:n.perfStats)&&(null===(a=this._perfStatsForResponseProcessing)||void 0===a||a.stopMeasurement(null===(s=e.extensions)||void 0===s?void 0:s.perfStats,t,i))}cancel(){this._requestComplete||(this._requestComplete=!0,this._scenario&&this._scenario.incomplete(),this.onComplete("cancelled"))}toLog(){return{requestId:this.requestId,requestType:this.requestType,operationName:this.operationName,isComplete:this.isComplete(),variables:(0,B.mapValues)(this.variables,((e,t)=>this.variableToLog(t,e))),customContext:this.cdlOperationCustomContext,startTime:this._startTime,lastUpdateTime:this._lastUpdateTime}}onComplete(e){var t;this._requestComplete&&(this.subject.onComplete(),null===(t=this.requestHealthMonitor)||void 0===t||t.requestCompleted(this,e))}onSuccess(e){this.mergeAndEndStatsSnapshot(e.extensions),this.logResponse(),this.subject.onNext(e)}onError(e){var t;this._requestComplete=!0;const i=(null==e?void 0:e.errors)||"Unexpected: data layer query response missing both data and error",n=Array.isArray(i)?i.map((e=>(0,oe.VK)(e))).join():(0,oe.VK)(i);if(this.mergeAndEndStatsSnapshot(e.extensions,n),this.enableClassBasedErrors)this.subject.onNext(e);else{let i=e.errorCode;!i&&(null===(t=e.errors)||void 0===t?void 0:t.length)&&(i=e.errors[0].name||h.jK.RemoteOperationFailed),i||(i=h.jK.InvalidResponse);const a=(0,oe.Tr)(h.w5.DataLayerClient,i,"onError",void 0,n);this._logger.error(`error while processing ${this._requestId}: ${a.message} (reason: ${a.reason})`,this._loggingContext,i),this.subject.onError(a)}}mergeAndEndStatsSnapshot(e,t){var i,n,a,s;let o;e&&e.perfStats&&(this._perfStats&&(o=this._perfStats.stopMeasurement(e.perfStats,this._otherResponsesReceivedWhileInTransit,this._responseReceiveLatency)),"subscription"===this.requestType&&(this._lastUpdateTime=Date.now(),Hu.addSubscriptionResponse(this.operationName,e.perfStats.responseSendTime,this.loggerFactory,this.scenarioFactory,e.subscriptionCustomIdentifier,null===(i=this.dataLayerClientSettings)||void 0===i?void 0:i.cdlSubscriptionAggregatorAllowList,null===(n=this.dataLayerClientSettings)||void 0===n?void 0:n.cdlSubscriptionAggregatorLogIntervalMS))),e&&(null===(a=this._scenario)||void 0===a||a.appendEventData({dataSource:e.dataSource,size:null===(s=e.perfStats)||void 0===s?void 0:s.payloadLength})),this._scenario&&(t?this.syncEngineInitializationPromise.then((e=>{var i,n,a;null===(i=this._scenario)||void 0===i||i.appendEventData(Object.assign(Object.assign({},o),{errors:(0,se.A)(t)})),e.isSyncEngineInitialized?null===(n=this._scenario)||void 0===n||n.fail():null===(a=this._scenario)||void 0===a||a.incomplete()})):(this._scenario.stop(o),this.isRequestFromWindowLaunch(this.operationName,this.scenarioFactory)&&this.createWltSteps(o)))}logResponse(){this._logger[this.getLogLevel()]("Received response data for request",this._loggingContext)}createWltSteps(e){const t=this.scenarioFactory.findScenario(z.RG.WindowLaunchTime);if(t&&t.currentStep!==z.ck.FetchProcessResponse){if(e){const{requestIPCTime:i,responseIPCTime:n,workerResponseTime:a}=e;if(i&&n&&this.splitFetchWaitMarkerInWLT){if(this._wltTimestampsAtInit&&t.timestamps.length>this._wltTimestampsAtInit)return;t.mark(z.ck.FetchWaitRequestIPC,{offsetCurrentTimeInMs:Math.round(a)+n}),t.mark(z.ck.FetchWaitWorker,{offsetCurrentTimeInMs:n}),t.mark(z.ck.FetchWaitResponseIPC)}else t.mark(z.ck.FetchWaitIPC,{offsetCurrentTimeInMs:Math.round(a)}),t.mark(z.ck.FetchWaitWorker)}t.startStep(z.ck.FetchProcessResponse)}}isRequestFromWindowLaunch(e,t){return!!t.findScenario(z.RG.WindowLaunchTime)&&Vu.indexOf(e)>-1}logRequest(){this._logger[Ju]("Created new request",this._loggingContext)}getLogLevel(){var e;return qu.indexOf(null!==(e=this._loggingContext.operationName)&&void 0!==e?e:"")>=0?Ju:"log"}getActiveCPM(){const e=[z.RG.ChatSwitch,z.RG.ChannelSwitchL1,z.RG.ChannelSwitchL2,z.RG.ChannelL1Deeplink,z.RG.ChannelL2Deeplink,z.RG.ActivitySwitch,z.RG.ApplicationLaunchTime,z.RG.WindowLaunchTime];if(this.scenarioFactory.doesScenariosExist){const t=this.scenarioFactory.doesScenariosExist(e);if(t.length)return t.join(",")}}variableToLog(e,t){var i,n;return(null===(n=null===(i=this.dataLayerClientSettings)||void 0===i?void 0:i.loggableOperationVariablesAllowList)||void 0===n?void 0:n.includes(e))||(0,B.isBoolean)(t)||(0,B.isNumber)(t)||(0,B.isNil)(t)?t:"N/A"}}class Qu extends Ku{onSuccess(e){super.onSuccess(e),this._requestComplete=!0}}class Yu extends Ku{onSuccess(e){super.onSuccess(e),this._requestComplete=!0}}class Xu extends Ku{onSuccess(e){super.onSuccess(e)}}class Zu{static createDataLayerRequest(e,t,i,n,a,s,o,r,c,l,d,u,m,g,h,p,v){const f=[e,t,i,n,a,s,o,r,c,l,d,void 0,u,m,g,h,p,v];switch(t){case"mutation":return new Qu(...f);case"query":return new Yu(...f);case"subscription":return new Xu(...f)}}}var em=i(61754);class tm{constructor(e,t,i,n,a){this.config=t,this.timeoutProvider=i,this.syncEngineInitializationPromise=n,this.dataLayerTarget=a,this.isRequestInProcess=!1,this.requestTimer=null,this.openRequests=new Map,this.timedOutDistinctRequestCount=0,this.failedDistinctRequestCount=0,this.timedOutOperationNames=new Set,this.failedOperationNames=new Set,this.lastSucceededRequest=this.firstTimedOutRequest=tm.DefaultRequestLoggingData,this.logger=e.newLogger("RequestHealthMonitor","core-cdl-data-layer-client")}requestCreated(e){if(!this.shouldMonitor(e))return;let t;null!==this.requestTimer||this.isRequestInProcess?t=!1:(this.startTimer(),t=!0),this.openRequests.set(e.requestId,{operationName:e.operationName,shouldTimeout:t,timeAdded:Date.now()})}requestCompleted(e,t){if(!this.shouldMonitor(e))return;this.openRequests.delete(e.requestId)||this.logger.warn(`Unknown request completed. Possibly timed out. RequestId ${e.requestId}, OperationName ${e.operationName}, Target ${this.dataLayerTarget}.`),0===this.openRequests.size&&null!==this.requestTimer&&this.clearTimer(),"success"===t&&this.onSuccess(e),"error"===t&&this.onError(e)}onSuccess(e){this.lastSucceededRequest={requestId:e.requestId,operationName:e.operationName},this.timedOutDistinctRequestCount=0,this.failedDistinctRequestCount=0,this.timedOutOperationNames.clear(),this.failedOperationNames.clear(),this.firstTimedOutRequest=tm.DefaultRequestLoggingData}onError(e){this.failedOperationNames.has(e.operationName)||(this.failedDistinctRequestCount++,this.failedOperationNames.add(e.operationName),this.failedDistinctRequestCount===this.failureCountThreshold&&this.indicateTargetUnhealthy("error"))}onTimeout(){let e=tm.DefaultRequestLoggingData,t=Number.MAX_SAFE_INTEGER;this.openRequests.forEach(((i,n)=>{if(i.shouldTimeout){const a=i.operationName;i.timeAdded<t&&(t=i.timeAdded,e={operationName:a,requestId:n}),this.logger.warn(`Request reached time out in health monitor. RequestId ${n}, OperationName ${a}, Target ${this.dataLayerTarget}.`),this.openRequests.delete(n),this.timedOutOperationNames.has(a)||(this.timedOutDistinctRequestCount++,this.timedOutOperationNames.add(a),this.timedOutDistinctRequestCount===this.timedOutCountThreshold&&this.indicateTargetUnhealthy("timedOut"))}else i.shouldTimeout=!0})),this.firstTimedOutRequest===tm.DefaultRequestLoggingData&&(this.firstTimedOutRequest=e),this.requestTimer=null,this.isRequestInProcess=!1,this.openRequests.size>0&&this.startTimer()}startTimer(){null!==this.requestTimer&&(this.logger.warn(`Health monitor timer already running when attempting to start new. Clearing old timer. Target ${this.dataLayerTarget}.`),this.timeoutProvider.clearTimeout(this.requestTimer)),this.isRequestInProcess=!0,this.syncEngineInitializationPromise.then((e=>{e.isSyncEngineInitialized&&(this.requestTimer=this.timeoutProvider.setTimeout((()=>this.onTimeout()),this.timeOutLengthMs))}))}clearTimer(){null!==this.requestTimer?(this.timeoutProvider.clearTimeout(this.requestTimer),this.requestTimer=null,this.isRequestInProcess=!1):this.logger.warn(`Health monitor timer tried to cancel non-existent timer. Ignoring. Target ${this.dataLayerTarget}.`)}indicateTargetUnhealthy(e){var t,i,n,a;let s="error"===e?`ErrorCount: ${this.failureCountThreshold}.`:`TimedOutCount: ${this.timedOutCountThreshold}. TimeOutMs: ${this.timeOutLengthMs}.`;this.config.memoryMapType&&(s=`${s} MemoryMapType: ${this.config.memoryMapType}.`);const o=`Last succeeded operation: ${this.lastSucceededRequest.operationName}, ${this.lastSucceededRequest.requestId}.`,r=`First timeout operation: ${this.firstTimedOutRequest.operationName}, ${this.firstTimedOutRequest.requestId}`,c=`RequestHealthMonitor: DataLayer is unhealthy due to successive requests failing with ${e}. Target: ${this.dataLayerTarget}. ${s} ${o} ${r}`;null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,c,"cdl_data_layer_client_request_health_monitor_unhealthy_target",void 0,!0),null===(a=(n=this.config).unhealthyDataLayerCallback)||void 0===a||a.call(n,c)}shouldMonitor(e){return"subscription"!==e.requestType}get failureCountThreshold(){return this.config.failureCountThreshold||tm.DefaultFailureCountThreshold}get timeOutLengthMs(){return(this.config.timeoutLengthSeconds||tm.DefaultTimeoutLengthSeconds)*G.NO}get timedOutCountThreshold(){return this.config.timeoutCountThreshold||tm.DefaultTimeoutCountThreshold}}tm.DefaultFailureCountThreshold=5,tm.DefaultTimeoutCountThreshold=5,tm.DefaultTimeoutLengthSeconds=60,tm.DefaultRequestLoggingData={operationName:"na",requestId:"na"};class im{constructor(e,t,i,n,a,s,o,r,c,l,d,u,m){var g;this.logger=e,this.scenarioFactory=i,this.syncEngineInitializationPromise=a,this.leakDetectorService=s,this.dataLayerCommunicatorTarget=o,this.timeoutProvider=r,this.enableClassBasedErrors=l,this.trackingOperationsDuringWaitConfig=d,this.dataClientTrackingService=u,this.dataLayerClientSettings=m,this.requestMap=new Map,this.recentlyCancelledRequests=new Map,this.loggingContext={hostRendererId:t,component:"RequestRegistrar"},this.leakDetector=null===(g=this.leakDetectorService)||void 0===g?void 0:g.create(),c&&c.enableRequestHealthMonitor&&r&&(this.requestHealthMonitor=new tm(n,c,r,this.syncEngineInitializationPromise,o))}createRequest(e,t,i,n,a,s,o,r,c){var l;const d=Zu.createDataLayerRequest(e,t,n,this.loggingContext.hostRendererId,i,this.logger,a,this.scenarioFactory,this.syncEngineInitializationPromise,s,o,this.requestHealthMonitor,this.enableClassBasedErrors,this.dataLayerCommunicatorTarget,r,c,this.dataLayerClientSettings);return null===(l=this.leakDetector)||void 0===l||l.track(`Request-${d.requestType}-${i}`,d),this.requestMap.set(e,d),em.Q.Instance.processRequest(t,i,e),d}reconcileResponse(e,t){var i,n,a,s,o;const r=this.requestMap.get(e),c=t.data?t.data&&Object.keys(t.data).toString():"";if(this.recentlyCancelledRequests.has(e))return void this.logger.log(`Received response to a requestId that was recently cancelled. RequestId: ${e}. OperationNameHints: ${c}.`,this.loggingContext);if(!r)return void(null===(n=(i=this.logger).errorToTelemetry)||void 0===n||n.call(i,`Received response to a requestId that cannot be found in the map. operationName ${c}`,"cdl_request",{operationName:c,windowId:t.windowId,callId:t.requestId,target:this.dataLayerCommunicatorTarget},!0));const l=t.extensions&&t.extensions.perfStats;let d,u;if(l||this.logger.warn(`Received response without perfStats for request. RequestId: ${e} RendererId: ${t.rendererId}, WindowId: ${t.windowId}, Target ${this.dataLayerCommunicatorTarget}`,this.loggingContext),(null===(a=this.trackingOperationsDuringWaitConfig)||void 0===a?void 0:a.enableTrackingCdlOperationsDuringWait)&&l&&l.responseSendTime){this.markResponse(r);const e=l.responseSendTime,t=Date.now();if(u=t-e,u>((null===(s=this.trackingOperationsDuringWaitConfig)||void 0===s?void 0:s.trackingCdlOperationsDuringWaitThresholdInMs)||100)){d=this.getResponsesBetweenStartAndLast(e);const i=null==d?void 0:d.reduce(((e,t)=>{const i=e.find((e=>(null==e?void 0:e.name)===t));return i?i.count++:e.push({name:t,count:1}),e}),[]);(null===(o=this.trackingOperationsDuringWaitConfig)||void 0===o?void 0:o.enableLoggingCdlOperationsDuringWait)&&this.logger.log(`${null==r?void 0:r.operationName}, sendtime: ${e}, receivetime: ${t}, latency: ${t-e}, responses received between send and receive: ${JSON.stringify(i)}`,this.loggingContext)}}const m=l;r.setResponseAndEndScenario(t,d,u),r.isComplete()&&(this.requestMap.delete(e),em.Q.Instance.processResponse(e,m&&m.workerResponseTime))}cancelRequest({requestId:e,rendererId:t,windowId:i}){const n=this.requestMap.get(e);n?(n.cancel(),this.requestMap.delete(e),this.recentlyCancelledRequests.set(e,(new Date).getTime()),this.scheduleCancelledRequestsMapCleanup()):this.logger.debug(`Nothing to cancel, request no longer in map. RequestId: ${e} RendererId: ${t}, WindowId: ${i}, Target ${this.dataLayerCommunicatorTarget}`,this.loggingContext)}getLogs(){return JSON.stringify((0,B.map)(Array.from(this.requestMap.values()),(e=>e.toLog())),null,2)}scheduleCancelledRequestsMapCleanup(){var e;if(!this.recentlyCancelledRequestsTimer){const t=2,i=(new Date).getTime();this.recentlyCancelledRequestsTimer=null===(e=this.timeoutProvider)||void 0===e?void 0:e.setTimeout((()=>this.cleanRecentlyCancelledRequestsMap(i)),t*G.A_)}}cleanRecentlyCancelledRequestsMap(e){this.recentlyCancelledRequests.forEach(((t,i)=>{t<e&&this.recentlyCancelledRequests.delete(i)})),this.recentlyCancelledRequestsTimer=void 0}markResponse(e){var t;null===(t=this.dataClientTrackingService)||void 0===t||t.markResponse(e.operationName)}getResponsesBetweenStartAndLast(e){var t;return(null===(t=this.dataClientTrackingService)||void 0===t?void 0:t.getResponsesBetweenStartAndLast(e))||[]}}var nm,am=i(109458),sm=i(696758);class om{constructor(e,t,i,n,a,s,o,r,c=!1,l=Promise.resolve({isSyncEngineInitialized:!0}),d,u,m,g){this.hostRendererId=e,this.loggerFactory=t,this.scenarioFactory=i,this.dataLayerCommunicator=n,this.leakDetectorService=a,this.splitFetchWaitMarkerInWLT=m,this.loggingContext={component:"DataLayerClient",hostRendererId:e},this.logger=new rd(t.newLogger("CDL","core-cdl-data-layer-client")),this.logger.log("logger created for renderer",this.loggingContext),this.dataLayerCommunicator.onMessage=this.onMessageReceived.bind(this),this.requestRegistrar=new im(this.logger,e,this.scenarioFactory,this.loggerFactory,l,this.leakDetectorService,s,o,r,c,d,u,g),this.requestId=new Cd("graphql")}execute(e,t,i,n,a,s){const o=(0,am.S)(e,i),r=o&&o.operation||"query";return this.executeWithQueryText(r,(0,sm.S)(e),t,i,n,a,s)}executeWithQueryText(e,t,i,n,a,s,o){const r=this.requestId.next(e),c=this.requestRegistrar.createRequest(r,e,n||e,i,this.loggerFactory,a,s,o,this.splitFetchWaitMarkerInWLT);this.logger.log("executing graphql request to data layer",Object.assign(Object.assign({requestId:c.requestId},this.loggingContext),{operationType:e,operationName:n,hostRendererId:this.hostRendererId,requestRendererId:a,requestWindowId:s})),this.dataLayerCommunicator.sendMessage({requestId:r,windowId:s,rendererId:this.hostRendererId,request:{graphqlQuery:t,variables:i},cdlOperationCustomContext:o,operationName:n});return function(e,t){const i=e.subscribe;return e.subscribe=n=>{const a=i.call(e,n),s=a.unsubscribe;return a.unsubscribe=()=>(t(),s.call(a)),a},e}(c.response,this.onUnsubscribe(c,n))}getRequestLogs(){return this.requestRegistrar.getLogs()}onUnsubscribe(e,t){return()=>{e.isComplete()||(this.logger.log("Notifying server of unsubscription",Object.assign(Object.assign({},this.loggingContext),{requestId:e.requestId,requestType:Id,operationName:t})),this.dataLayerCommunicator.sendMessage({requestId:e.requestId,rendererId:this.hostRendererId,windowId:e.windowId,request:{graphqlQuery:Id,variables:void 0},operationName:t}),this.requestRegistrar.cancelRequest({requestId:e.requestId,rendererId:this.hostRendererId,windowId:e.windowId}))}}onMessageReceived(e){this.requestRegistrar.reconcileResponse(e.requestId,e)}}class rm{constructor(e,t,i,n,a,s,o,r,c,l,d,u,m,g,h,p,v,f,b,y,k,w,j){this.host=e,this.config=t,this.loggerFactory=n,this.scenarioFactory=a,this.coreSettings=s,this.dataClientTrackingService=k,this.isDisposed=!1,this.logger=n.newLogger("DataClientCoreCDLWorkerService","core-services-cdl-worker"),this.cdlWorkerHostSettingsAggregator=new $u(i,s,o,n,l,m,g,h,p),this.cdlWorkerManagerInitializationPromise=Iu(e,t,this.cdlWorkerHostSettingsAggregator,n,a,s,r,c,l,this.logger,v,f,b,y,g,j,w);if(Nu(l,s,a,e,this.logger)){this.cdlWorkerStateSender=new Mu(d,u,n,this);const{disableCDLWorkerHostSettingsUpdates:e}=s.get(S.J.Core);e||this.startNotifyingCDLWorkerForHostSettingsChanges()}}getCDLWorkerManager(){return this.cdlWorkerManagerInitializationPromise}getDataLayerClient(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.dataLayerClient){const e=yield this.getCDLWorkerManagerOrThrow("getDataLayerClient"),t=this.coreSettings.get(S.J.CdlWorker),{logCdlOperationsDuringWaitSettings:i}=this.coreSettings.get(S.J.Core);this.dataLayerClient=new om(this.config.clientId,this.loggerFactory,this.scenarioFactory,e.workerClientResponseRouter.cdlGraphQLClient,void 0,"Worker",this.host,{enableRequestHealthMonitor:!!t.enableRequestHealthMonitor,failureCountThreshold:t.requestHealthMonitorFailureCountThreshold,timeoutCountThreshold:t.requestHealthMonitorTimeoutCountThreshold,timeoutLengthSeconds:t.requestHealthMonitorTimeoutLengthSeconds,memoryMapType:(0,xu.qo)(this.coreSettings)},!!t.enableClassBasedErrors,e.syncEngineInitializationPromise,{enableLoggingCdlOperationsDuringWait:null==i?void 0:i.enableLoggingCdlOperationsDuringWait,enableTrackingCdlOperationsDuringWait:null==i?void 0:i.enableTrackingCdlOperationsDuringWait,trackingCdlOperationsDuringWaitThresholdInMs:null==i?void 0:i.trackingCdlOperationsDuringWaitThresholdInMs},this.dataClientTrackingService,!!t.splitFetchWaitMarkerInWLT,{cdlSubscriptionAggregatorAllowList:t.cdlSubscriptionAggregatorAllowList||void 0,loggableOperationVariablesAllowList:t.loggableOperationVariablesAllowList||void 0,cdlSubscriptionAggregatorLogIntervalMS:t.cdlSubscriptionAggregatorLogIntervalMS||void 0})}return this.dataLayerClient}))}getControlPlaneCommunicator(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.controlPlaneCommunicator){const e=yield this.getCDLWorkerManagerOrThrow("getControlPlaneCommunicator");this.controlPlaneCommunicator=new Pu(e.workerClientResponseRouter,{loggerFactory:this.loggerFactory})}return this.controlPlaneCommunicator}))}dispose(){this.cdlWorkerStateSender&&this.cdlWorkerStateSender.dispose(),this.cdlWorkerHostSettingsAggregator.cleanup(),this.isDisposed=!0}logoutCurrentUser(e){var t,i,a,s,o,r;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.get(S.J.CdlWorker).maxLogoutTime||5e3;if(this.isDisposed)return void(null===(i=(t=this.logger).warnToTelemetry)||void 0===i||i.call(t,"Unable to cleanup CDL Worker: Already disposed.","cdl_services_worker_worker_service_logout_current_user_error",void 0,!0));const c=yield this.getCDLWorkerManager();if(c)try{yield(0,H.E)(c.workerClientResponseRouter.cdlSyncEngineClient.sendRequest({type:"logout",subType:"",params:void 0}),n,`logout request to CDL worker timed out after ${n} ms`)}catch(e){null===(r=(o=this.logger).errorToTelemetry)||void 0===r||r.call(o,`Failed to cleanup CDL Worker on logout. ${e&&e.code===h.jK.TimedOut?e.message:""}`,"cdl_services_worker_worker_service_logout_current_user_error",void 0,!0)}else null===(s=(a=this.logger).warnToTelemetry)||void 0===s||s.call(a,"Unable to cleanup CDL Worker: Worker manager not available.","cdl_services_worker_worker_service_logout_current_user_error",void 0,!0)}))}getDebugService(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.debugService){const{DataClientCoreCDLWorkerDebugService:e}=yield i.e(583194).then(i.bind(i,156780));this.debugService=new e(this.loggerFactory,this)}return this.debugService}))}getDataLayerRequestLogs(){var e,t;if(!this.dataLayerClient)return"Data layer client unavailable.";if(this.coreSettings.get(S.J.CdlWorker).disableOperationsInLogFiles)return"Data layer request logs disabled by setting 'disableOperationsInLogFiles'.";try{return(null===(t=(e=this.dataLayerClient).getRequestLogs)||void 0===t?void 0:t.call(e))||"Data layer client has not implemented request logs."}catch(e){return`Data layer client failed to get logs: ${(0,oe.VK)(e)}.`}}startNotifyingCDLWorkerForHostSettingsChanges(){var e,t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let i;try{i=yield this.getCDLWorkerManager()}catch(i){return void(null===(t=(e=this.logger).errorToTelemetry)||void 0===t||t.call(e,`Unable to start notifying CDL Worker for host settings changes: getCDLWorkerManager failed: ${i.message}.`,"cdl_services_worker_worker_service_notify_worker_host_settings_changes_error",void 0,!0))}i?(this.cdlWorkerHostSettingsAggregator.startNotifyingCDLWorkerForHostSettingsChanges(i.workerClientResponseRouter.cdlControlClient),this.logger.log("Start notifying CDL Worker for host settings changes.")):this.logger.log("Unable to start notifying CDL Worker for host settings changes: Worker manager not available.")}))}getCDLWorkerManagerOrThrow(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getCDLWorkerManager();if(!t)throw(0,oe.Tr)(rm.ComponentName,h.jK.NotInitialized,e,void 0,"Worker manager is not initialized");return t}))}}rm.ComponentName="DataClientCoreCDLWorkerService",function(e){e.NoLog="no_logs",e.Activities="activities_logs",e.AllConversations="all_conversations_logs",e.AppsPlatform="apps_platform_logs",e.Calendar="calendar_logs",e.ChannelInfoPane="channel-info-pane",e.Diagnostics="diagnostics_logs",e.Files="files_logs",e.Messaging="messaging_logs",e.People="people_logs",e.Presence="presence_logs",e.MTMAAggregator="mtma_aggregator",e.UserPreferences="user_preferences_logs",e.TeamsAndChannels="teams_and_channels_logs",e.MeetForWork="meet_for_work_logs",e.Discover="discover_logs"}(nm||(nm={}));class cm{constructor(e,t,i,n,a){this.cdlWorkerManager=e,this.logger=t,this.authenticationService=i,this.getDataLayerRequestLogs=n,this.cacheStorage=a,this.workerGetLogsTimeoutMs=18e3,this.logsProviderName="CdlWorkerLogsProvider"}getLogsFiles(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let t;const i=this.getWorkerDiagnosticsLogsFromCdlWorkerManager(),n=this.getVerboseWorkerLogs(this.cdlWorkerManager.workerType),a=yield this.authenticationService.getUser();if(a&&a.isAuthenticated)t=this.getSyncEngineLogsFromCdlWorkerManager();else{const e="Sync logs cannot be retrieved for unauthenticated users.";t=Promise.resolve([{isPiiFree:!0,fileName:"sync-failure-logs.txt",content:e}]),this.logger.warn(e)}const[s,o,r]=yield Promise.all([this.timeoutSafeGetLogsFiles(i,{diagnosticsEvents:void 0,coreSettingsSnapshot:""},"workerDiagnostics"),this.timeoutSafeGetLogsFiles(n,[],"workerVerboseDiagnostics"),this.timeoutSafeGetLogsFiles(t,[],"workerSyncDiagnostics")]);return[{isPiiFree:!s.diagnosticsEvents||!!e,fileName:"cdl-worker-diagnostics-logs.txt",content:s.diagnosticsEvents?(0,M.Mf)(e?s.diagnosticsEvents.filter((e=>e.isPiiFree)):s.diagnosticsEvents):"No logs found"},{isPiiFree:!0,fileName:"cdl-worker-settings.json",content:s.coreSettingsSnapshot},{isPiiFree:!1,fileName:"cdl-worker-requests.txt",content:this.getDataLayerRequestLogs()},...r,...o]}))}subscribeToCoreSettings(e){if(!e)return void this.logger.error("Failed to subscribe to core settings");e.getObservable(S.J.Diagnostics,["workerGetLogsTimeoutMs"]).subscribe((({workerGetLogsTimeoutMs:e})=>{e&&(this.workerGetLogsTimeoutMs=e)}))}getVerboseWorkerLogs(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this.cacheStorage){const t=new _u(this.cacheStorage,this.logger),i=yield t.getWorkerVerboseLog(e);if(""!==i)return Promise.resolve([{isPiiFree:!1,fileName:"verbose-worker-logs.txt",content:i}])}return Promise.resolve([])}))}getWorkerDiagnosticsLogsFromCdlWorkerManager(){var e,t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=this.cdlWorkerManager.workerClientResponseRouter.cdlDiagnosticsClient;try{const t=yield n.sendRequest("get_logs");if(null===(e=null==t?void 0:t.response)||void 0===e?void 0:e.data)return t.response.data;this.logger.warn("Diagnostic event list empty or ill-formed")}catch(e){const n=yield this.getSyncEngineInitResultFromCdlWorkerManager(),a=`Unable to retrieve worker diagnostics logs. ${(0,oe.VK)(e)}.`,s=`syncEnginePromiseResult: ${n}`;return null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,`${a}::${s}`,"cdl_worker_diagnostics_logs_error",{errorMessage:a,errors:s},!0),{diagnosticsEvents:[{message:a,level:E.i.Error,isPiiFree:!0,levelName:"error",timeStamp:new Date},{message:s,level:E.i.Error,isPiiFree:!0,levelName:"error",timeStamp:new Date}],coreSettingsSnapshot:""}}return{diagnosticsEvents:void 0,coreSettingsSnapshot:""}}))}getSyncEngineInitResultFromCdlWorkerManager(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const e=yield this.cdlWorkerManager.syncEngineInitializationPromise;return JSON.stringify(e)}catch(e){return(0,oe.VK)(e)}}))}getSyncEngineLogsFromCdlWorkerManager(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=[];for(const t of(0,B.values)(nm))t!==nm.NoLog&&t!==nm.Diagnostics&&e.push(this.getSyncEngineLogsForTypeFromCdlWorkerManager(t));return Promise.all(e)}))}getSyncEngineLogsForTypeFromCdlWorkerManager(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=this.cdlWorkerManager.workerClientResponseRouter.cdlSyncEngineClient;let i;try{const n=yield t.sendRequest({type:"get_logs",subType:e,params:{conversationId:void 0}});(null==n?void 0:n.response)?i=n.response:(this.logger.warn(`Sync engine logs empty. LogType: ${e}`),i="No logs available.")}catch(e){const t=`Unable to retrieve sync diagnostics logs. ${(0,oe.VK)(e)}`;this.logger.error(t),i=t}return{isPiiFree:!1,fileName:`sync-${this.syncEngineLogTypeToFileName(e)}-logs.txt`,content:i}}))}syncEngineLogTypeToFileName(e){switch(e){case nm.Messaging:return"messaging";case nm.AllConversations:return"all_conversations";case nm.People:return"people";case nm.Presence:return"presence";case nm.Calendar:return"calendar";case nm.AppsPlatform:return"apps-platform";case nm.Activities:return"activities";case nm.ChannelInfoPane:return"channel-info-pane";case nm.MTMAAggregator:return"mtma-aggregator";case nm.UserPreferences:return"user-preferences";case nm.TeamsAndChannels:return"teams-and-channels";case nm.Files:return"files";case nm.MeetForWork:return"meet-for-work";case nm.Discover:return"discover"}}timeoutSafeGetLogsFiles(e,t,i){var a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{return yield(0,H.E)(e,this.workerGetLogsTimeoutMs)}catch(e){let t=`Failed fetching logs files from CDL Worker Logs Provider - ${i}`;(0,H.T)(e)&&(t=`Timed out fetching logs files from CDL Worker Logs Provider - ${i}`),null===(s=(a=this.logger).errorToTelemetry)||void 0===s||s.call(a,t,"cdl_get_logs_error")}return t}))}}function lm(e){var t,i,a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield null===(t=e.i18NextWrapper)||void 0===t?void 0:t.osLocale,o=new rm(e.windowProvider,e.config,e.configLoader,e.loggerFactory,e.scenarioFactory,e.coreSettings,e.coreSettingsContext,e.authenticationService,e.discover,e.platformService,e.clientState,e.hostState,e.primaryUser,null===(i=e.i18NextWrapper)||void 0===i?void 0:i.locale,n,null===(a=e.i18NextWrapper)||void 0===a?void 0:a.osLocaleInfo,e.offlineCacheManager,e.authStateProvider,e.cdlWorkerRegistrarService,e.workerId,e.dataClientTrackingService,e.telemetryService,null===(s=e.altScenarioService)||void 0===s?void 0:s.altScenario);return function(e,t){const i=null==e?void 0:e.altScenario;i&&i.appendEventData({dataStoreName:(0,xu.qo)(t)})}(e.altScenarioService,e.coreSettings),o.getCDLWorkerManager().then((t=>{if(t){const{authenticationService:i,authenticationUser:n,cacheStorage:a,cdlWorkerRegistrarService:s,loggerFactory:r,logsCollectorService:c,workerId:l}=e,d=new cm(t,r.newLogger("CdlWorkerLogsProvider","core-services-tasks"),i,(()=>o.getDataLayerRequestLogs()),a);d.subscribeToCoreSettings(e.coreSettings);const u=n&&(0,He.b4)(n);c.registerUserLogsProvider(u||"",d),s.registerWorker(l),function(e,t){var i,n;const{enableNetworkStateCommsBetweenCoreAndWorker:a}=e.coreSettings.get(S.J.Core);if(a){const a=i=>{const n={networkState:e.networkState.getState(),baselineNetworkStateOverride:i};t.workerClientResponseRouter.cdlNetworkStateClient.sendRequest(n)},s=e.authenticationUser&&(0,He.b4)(e.authenticationUser)||"",o=null===(n=(i=e.networkState).createNetworkStateTracker)||void 0===n?void 0:n.call(i,s,`CDL Worker EM [${s}]`,a);o&&t.state.setState("networkState:Loaded",o);return function(e,t){return()=>{e.unsubscribe(),t.dispose()}}(e.networkState.observe().subscribe((e=>{const i={networkState:e};t.workerClientResponseRouter.cdlNetworkStateClient.sendRequest(i)})),o)}}(e,t),function(e,t){const{enableEndpointsHealthCommsBetweenCoreAndWorker:i}=e.coreSettings.get(S.J.Core);if(i){const i=e.endpointsHealthService;if(null==i?void 0:i.getEndpointsHealthUpdateHandler){const e=i.getEndpointsHealthUpdateHandler();t.state.setState("endpointsHealthUpdateHandler:Loaded",e),e.onStateDumpRequest((()=>{const e="get_health_state";t.workerClientResponseRouter.cdlEndpointsHealthClient.sendRequest(e)}))}}}(e,t),function(e){(0,Hi.G)().setCdlContextCallback(((t,i,n)=>{e.workerClientResponseRouter.telemetryClient.sendRequest({requestOperationtype:"setContext",context:{[t]:i},userContextId:n})}))}(t)}})),yield(0,rl._)(1),o}))}function dm(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield um(e);return!!i&&!!t&&i.id===t.id}))}function um(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield null===(t=null==e?void 0:e.getCachedUsers)||void 0===t?void 0:t.call(e,Object.assign(Object.assign({},tt({source:k.D.Core})),{scenarioName:z.RG.AuthWebCachedUser}),{isPrimaryUser:!0}),n=null==i?void 0:i[0];if(n)return(0,He.KQ)(n)}))}class mm extends Ue{constructor(){super(h.Yg.CreateCDLWorkerOnAuthUserTask,["altScenarioService","authenticationService","clientState","config","configLoader","coreSettings","coreSettingsContext","diagnosticsService","discover","endpointsHealthService","hostState","i18NextWrapper","loggerFactory","logsCollectorService","networkState","platformService","scenarioFactory","windowProvider","telemetryService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{altScenarioService:t,authenticationService:i,clientState:a,config:s,configLoader:o,coreSettings:r,coreSettingsContext:c,diagnosticsService:l,discover:d,endpointsHealthService:u,hostState:m,i18NextWrapper:g,loggerFactory:h,logsCollectorService:p,networkState:v,platformService:f,scenarioFactory:b,windowProvider:y,telemetryService:k}=e,{authenticationUser:w,authStateProvider:j,cacheStorage:C,cdlWorkerRegistrarService:_,dataClientTrackingService:T,offlineCacheManager:I}=e,N=h.newLogger("CreateCDLWorkerOnAuthUserTask","core-services-tasks"),E=(0,xu.Q6)(r),{enableMTMA:F,disableExperience:x}=r.get(S.J.Core),{crossCloudMeetingEnabled:D}=r.get(S.J.HostCapabilities),A=x&&(null==w?void 0:w.role)!==zo.w4.Anonymous,M=x&&!1===D&&(null==w?void 0:w.role)===zo.w4.Anonymous;if(!E||!F)return N.warn(`Not creating worker as cdl worker or mtma is not enabled. isCdlWorkerEnabled: ${E}, isMTMAEnabled: ${F}`),Promise.resolve();if(!w||!_)return N.warn("Not creating worker as authenticated user is not available or cdl worker registrar service is undefined."),Promise.resolve();if(A||M)return N.warn("Not creating worker as experience is disabled for the user and it is not a CCM/CCA sign in."),Promise.resolve();const P=null==w?void 0:w.id;if(_.isWorkerRegistered(P)||_.useInitTaskWorker)return N.log(`Not creating a worker as we already have created worker workerId: ${P} for the user oid: ${w.profile.objectId},\n         tid: ${w.profile.tenantId}`),void(_.useInitTaskWorker=!1);let O;return N.log(`Creating a worker with id: ${P} for the user oid: ${w.profile.objectId},\n       tid: ${w.profile.tenantId}`),F&&(O=yield um(i)),e.cdlWorkerService=yield lm({altScenarioService:t,authenticationService:i,authenticationUser:w,authStateProvider:j,cacheStorage:C,cdlWorkerRegistrarService:_,clientState:a,config:s,configLoader:o,coreSettings:r,coreSettingsContext:c,dataClientTrackingService:T,diagnosticsService:l,discover:d,endpointsHealthService:u,hostState:m,i18NextWrapper:g,loggerFactory:h,logsCollectorService:p,networkState:v,offlineCacheManager:I,platformService:f,primaryUser:O,scenarioFactory:b,windowProvider:y,workerId:P,telemetryService:k}),e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t;"signout"===e&&(null===(t=_.activeWorkers)||void 0===t||t.delete(P))}))}))}}class gm extends Ue{constructor(){super(h.Yg.CreateCDLWorkerOnInitTask,["altScenarioService","authenticationService","clientState","config","configLoader","coreSettings","coreSettingsContext","diagnosticsService","discover","endpointsHealthService","hostState","i18NextWrapper","loggerFactory","logsCollectorService","networkState","platformService","scenarioFactory","windowProvider","cdlWorkerRegistrarService","telemetryService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{altScenarioService:t,authenticationService:i,clientState:n,config:a,configLoader:s,coreSettings:o,coreSettingsContext:r,diagnosticsService:c,discover:l,endpointsHealthService:d,hostState:u,i18NextWrapper:m,loggerFactory:g,logsCollectorService:h,networkState:p,platformService:v,scenarioFactory:f,windowProvider:b,cdlWorkerRegistrarService:y,telemetryService:k}=e,{authenticationUser:w,authStateProvider:j,cacheStorage:C,dataClientTrackingService:_,offlineCacheManager:T}=e,I=g.newLogger("CreateCDLWorkerOnInitTask","core-services-tasks");if(!(0,xu.Q6)(o))return void I.warn("Not creating worker as CDL worker is not enabled");const N=w?w.id:(0,qe.v4)();let E;const{enableMTMA:F}=o.get(S.J.Core);if(F){if(!y)return void I.warn("Not creating worker as cdlWorkerRegistrarService is undefined");I.log(`Creating CDL worker with id ${N} for user oid:${null==w?void 0:w.profile.objectId}, tid: ${null==w?void 0:w.profile.tenantId}`),E=yield um(i)}else I.log("MTMA is not enabled. Creating a CDL worker with default workerId");e.cdlWorkerService=yield lm({altScenarioService:t,authenticationService:i,authenticationUser:w,authStateProvider:j,telemetryService:k,cacheStorage:C,cdlWorkerRegistrarService:y,clientState:n,config:a,configLoader:s,coreSettings:o,coreSettingsContext:r,dataClientTrackingService:_,diagnosticsService:c,discover:l,endpointsHealthService:d,hostState:u,i18NextWrapper:m,loggerFactory:g,logsCollectorService:h,networkState:p,offlineCacheManager:T,platformService:v,primaryUser:E,scenarioFactory:f,windowProvider:b,workerId:N})}))}}var hm,pm=i(607586);class vm{constructor({loggerFactory:e}){this.initTaskWorkerId="",this.mainWindowWorkerId=void 0,this.useInitTaskWorker=!0,this.activeWorkers=new Set,this.userRegisteredActiveWorkers=new Map,this.formatUserId=e=>e.replace(pm.V.User,""),this.logger=e.newLogger("DataClientCoreCDLWorkerRegistrarService","core-services-cdl-worker")}setMainWindowWorkerByUserId(e){var t,i;e=this.formatUserId(e),this.userRegisteredActiveWorkers.has(e)?this.mainWindowWorkerId=this.userRegisteredActiveWorkers.get(e):null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,`No registered active worker for user id ${e}`,"cdl_registrar_service_no_registered_active_worker",void 0,!0)}isWorkerRegistered(e){return this.activeWorkers.has(e)}mapUserIdToRegisteredWorker(e,t){var i,n;t=this.formatUserId(t),this.isWorkerRegistered(e)||(null===(n=(i=this.logger).warnToTelemetry)||void 0===n||n.call(i,`${e} wasn't tracked yet was registered to active user. Tracking worker.`,"cdl_registrar_service_map_user_worker_not_registered",void 0,!0),this.registerWorker(e)),this.userRegisteredActiveWorkers.set(t,e)}registerWorker(e){var t,i;this.isWorkerRegistered(e)?null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,`${e} is already being tracked by cdl worker registrar service; skipping.`,"cdl_registrar_service_worker_already_registered",void 0,!0):(this.activeWorkers.add(e),this.initTaskWorkerId||(this.initTaskWorkerId=e,this.mainWindowWorkerId=e))}}class fm extends Ue{constructor(){super(h.Yg.CreateCDLWorkerRegistrarServiceTask,["loggerFactory"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t}=e;return e.cdlWorkerRegistrarService=new vm({loggerFactory:t}),Promise.resolve()}))}}!function(e){e.LifeCycleScopeChange="LifeCycleScopeChange"}(hm||(hm={}));class bm extends Ue{constructor(){super(h.Yg.CreateChangeReporting,[])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){e.schedulerChangeReporting=new Ga,e.experienceChangeReportingService=new Ga,e.lifeCycleScopeChangeReportingService=new Ga,e.commandResultChangeReportingService=new Ga,e.commandChangeReportingService=new Ga}))}}const ym="local-user-preferences",km={theme:{userTheme:"light",followOsTheme:!0,isClassicTheme:!1,isCallingWindowDarkTheme:!1},animation:{disableAnimations:void 0},infoPane:{chatContextualSearch:"closed",channelcontextualsearch:"closed",chatHighlightsDetails:"closed"},flyoutCamera:{cameraState:"notSet"},promo:{badgeActionComplete:!1,labelActionComplete:!1},density:{chatDensity:"comfy"},performance:{mode:"normal"},appSwitcher:{checkboxChecked:!1,multipleTabsCheckboxChecked:!1},videoEffect:{lastUsedVideoFilter:void 0,lastUsedBackgroundImage:void 0},backgroundEffect:{lastUsedBackgroundEffect:void 0},avatar:{lastUsedAvatarFilter:void 0,hasUsedInMeeting:!1},teamLayout:{currentLayout:void 0},diagnosticsLogs:{shouldPersistLogsIntoIDB:!1},windowing:{shouldOpenContentInNewWindow:!1},lockScreenInCall:{turnOffMediaOnDeviceLock:!1},messagePreviews:{messagePreviewsSetting:"default"},composeSpellcheck:{disableDefaultSpellcheck:!1},copilotInChatList:{shouldShowMetaOSCopilotApp:!0}},Sm={get:()=>null,set:()=>{}};class wm{constructor(e,t=Sm){this.storage=t,this.subjectCache=new Map,this.logger=e.newLogger("ClientPreferencesService","services-io-browser-client-preferences"),this.clientPreferences=this.hydrateClientPreferences()}getPreferences(e){return this.clientPreferences[e]}getAllPreferences(){return this.clientPreferences}updatePreferences(e){const t=this.clientPreferences;this.clientPreferences=(0,B.merge)({},this.clientPreferences,e),this.storage.set(ym,JSON.stringify(this.clientPreferences)),this.subjectCache.forEach(((e,i)=>{(0,B.isEqual)(t[i],this.clientPreferences[i])||(this.logger.log(`Notifying subscribers of: '${i}', settings changed to: `,this.clientPreferences[i]),e.next(this.clientPreferences[i]))}))}getPreferenceObservable(e){return this.createOrGetSubjectFromCache(e).asObservable()}createOrGetSubjectFromCache(e){const t=this.subjectCache.get(e);if(t)return t;const i=this.getPreferences(e),n=new s.X(i);return this.subjectCache.set(e,n),this.logger.log(`Creating subject for '${e}' category, settings:`,i),n}hydrateClientPreferences(){try{const e=this.storage.get(ym);if(!e)return this.logger.log("Client preferences were not found in local storage; returning defaults."),km;this.logger.log("Client preferences was found in local storage.");const t=JSON.parse(e);return(0,B.defaultsDeep)(t,km)}catch(e){return this.logger.error("Unable fetch client preferences from local storage. ",e),km}}}class jm extends Ue{constructor(){super(h.Yg.CreateClientPreferences,["localStorage","loggerFactory"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{localStorage:t,loggerFactory:i}=e;e.clientPreferences=new wm(i,{set:(e,i)=>t.set(e,i,"Experience"),get:e=>t.get(e,"Experience")})}))}}class Cm extends Ue{constructor(){super(h.Yg.CreateCommandDelegator,["appsRegistryService","client","clientPreferences","commandChangeReportingService","coreSettings","loggerFactory","scenarioFactory","shortcutExecutionService","userBiService","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:i,clientPreferences:n,commandChangeReportingService:a,coreSettings:s,loggerFactory:o,scenarioFactory:r,shortcutExecutionService:c,userBiService:l,windowProvider:d}=e;e.commandDelegator=(e,u)=>$t({appsRegistryService:t,client:i,clientPreferences:n,commandChangeReportingService:a,commandHandler:u,commandInput:e,coreSettings:s,loggerFactory:o,scenarioFactory:r,shortcutExecutionService:c,host:d,userBiService:l})}))}}class _m extends Ue{constructor(){super(h.Yg.CreateCommandHandler,["appsRegistryService","client","commandChangeReportingService","coreSettings","loggerFactory","platformService","scenarioFactory","userBiService","notificationsHandler","clientPreferences","userTrackingService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:i,commandChangeReportingService:n,coreSettings:a,loggerFactory:s,platformService:o,scenarioFactory:r,userBiService:c,notificationsHandler:l,clientPreferences:d,userTrackingService:u}=e;e.commandHandler=(e,m)=>xi({appsRegistryService:t,client:i,commandChangeReportingService:n,coreSettings:a,entityCommandInput:e,loggerFactory:s,platformService:o,scenarioFactory:r,clientLaunchId:m,userBiService:c,notificationsHandler:l,clientPreferences:d,userTrackingService:u})}))}}var Tm;!function(e){e[e.Canceled=0]="Canceled",e[e.Failure=1]="Failure",e[e.Incomplete=2]="Incomplete",e[e.Success=3]="Success"}(Tm||(Tm={}));const Im=[Ge.B.Abandoned,Ge.B.Close,Ge.B.IntentTransferredCrossCloud],Nm=[Ge.B.Incomplete,Ge.B.WindowNotUpdated],Em=[Ge.B.Blanked,Ge.B.CommandHandledByOnCommandReceived,Ge.B.CommandHandledPriorToResolution,Ge.B.EventHandled,Ge.B.Hidden,Ge.B.LayoutRendered,Ge.B.LayoutRenderUpdated,Ge.B.NotHandled,Ge.B.Toggled],Fm=[Ge.B.Failure,Ge.B.SlotPhasedRenderingTimedOut];function xm(e){switch(e){case Ge.B.ApplicationHookReceivedCommand:case Ge.B.CommandBeforeGetAppViewEntities:case Ge.B.RenderStarted:case Ge.B.ChunkLoadStarted:case Ge.B.ChunkLoadSucceeded:case Ge.B.Rendered:return!0;default:return!1}}const Dm={[z.RG.ClientStart]:24e4},Am="command-result-service";class Mm{constructor(e,t,i,n){this.commandChangeReportingService=t,this.commandResultChangeReportingService=i,this.host=n,this.logger=e.newLogger(Am,"core-services-entity-commanding"),this.pendingCommands=new Map}init(){this.commandChangeSubscription=this.setUpCommandChangeSubscriptions()}destroy(){var e;this.pendingCommands.clear(),null===(e=this.commandChangeSubscription)||void 0===e||e.unsubscribe()}registerForCommandTimeOut(e,t){const i=this.pendingCommands.get(e);i&&(i.onCommandTimeOut=t)}unRegisterForCommandTimeOut(e){const t=this.pendingCommands.get(e);t&&(t.onCommandTimeOut=void 0)}onCommandChange(e){switch(e.type){case Ge.B.ScenarioEventDataAppended:case Ge.B.ScenarioMarked:case Ge.B.Rendered:break;case Ge.B.CommandMetaDataAdded:{const{context:{contentExistsAndHasChanged:t},correlationId:i}=e,n=this.pendingCommands.get(i);n&&void 0!==t&&(this.logger.log(`CommandMetaDataAdded: contentExistsAndHasChanged=${t}`),n.contentExistsAndHasChanged=t);break}case Ge.B.DelegatedCommandReceived:case Ge.B.EventBubbled:{const{context:{correlation:t},correlationId:i}=e;let n=this.pendingCommands.get(i);n||(n=this.createPendingCommand({correlation:t}),this.pendingCommands.set(i,n));break}case Ge.B.CommandStart:{const{correlationId:t,context:{entityCommand:i},userContextId:n}=e;let a=this.pendingCommands.get(t);a?a.entityCommand=i:a=this.createPendingCommand({entityCommand:i,userContextId:n}),this.pendingCommands.set(t,a);break}case Ge.B.NavigationCommandStart:{const{correlationId:t,context:{correlation:i},userContextId:n}=e;let a=this.pendingCommands.get(t);a||(a=this.createPendingCommand({correlation:i,userContextId:n})),this.pendingCommands.set(t,a);break}case Ge.B.Incomplete:case Ge.B.Failure:{const{correlationId:t,context:{errorInfo:i,errorMessage:n,showOops:a,eventData:s},userContextId:o}=e,r=this.pendingCommands.get(t);r&&this.calculateCommandResult(r,e.type,o,{errorInfo:i,errorMessage:n,showOops:a,eventData:s});break}default:{const{type:t,correlationId:i,context:{eventData:n}}=e,a=this.pendingCommands.get(i);if(a&&a.previousEvents.has(t))break;a&&this.calculateCommandResult(a,e.type,e.userContextId,{eventData:n});break}}}createPendingCommand({correlation:e,entityCommand:t,userContextId:i}){if(!(e=null!=e?e:null==t?void 0:t.command.correlation)){const e=new Error("correlation cannot be undefined. A valid entityCommand or correlation should be passed.");throw this.logger.errorToTelemetry&&this.logger.errorToTelemetry(e.message,"webclient_framework_foundation_command_reporting_service_event",void 0,!0),e}const n=e.id,a=this.host.setTimeout(this.getCommandTimeoutHandler(n,i),this.getCommandTimeout(e));return{contentExistsAndHasChanged:void 0,correlation:e,entityCommand:t,previousEvents:new Set,timeoutId:a}}getCommandTimeoutHandler(e,t){return()=>{var i;const n=this.pendingCommands.get(e);if(n){const{previousStep:a}=n,s=function(e){return e&&xm(e)?Je.y.TimeoutRunningApp:Je.y.TimeoutRunningCore}(a);null===(i=n.onCommandTimeOut)||void 0===i||i.call(n),this.logger.error(`Command error, correlationId: ${e}, reason ${s}, previousStep: ${a}`),this.onCommandResult(Tm.Failure,e,s,a,t,{errorCode:s})}}}setUpCommandChangeSubscriptions(){return this.commandChangeReportingService.observeChanges().subscribe((e=>this.onCommandChange(e)))}getCommandTimeout({id:e,scenarioName:t}){return t&&Dm[t]?(this.logger.log(`Increasing the command timeout (${Dm[t]}) during ${t}, correlationId: ${e}`),Dm[t]):12e4}calculateCommandResult(e,t,i,n){var a;const{previousStep:s,correlation:{id:o}}=e;if(e.previousEvents.add(t),e.previousStep=t,function(e){return Em.includes(e)}(t))this.onCommandResult(Tm.Success,o,t,s,i,{eventData:null==n?void 0:n.eventData});else if(function(e){return Fm.includes(e)}(t)){const e=(r=t,c=null==n?void 0:n.errorInfo,r===Ge.B.SlotPhasedRenderingTimedOut?Je.y.SlotPhasedRenderingTimedOut:c||Je.y.UnknownCommandError),l=(null==n?void 0:n.errorMessage)||(null===(a=null==n?void 0:n.eventData)||void 0===a?void 0:a.errors);this.logger.error(`Command error, correlationId: ${o}, reason ${e}, previousStep: ${s}`),this.onCommandResult(Tm.Failure,o,e,s,i,{errorCode:e,errorMessage:l,eventData:null==n?void 0:n.eventData})}else if(function(e,t){return e===Ge.B.RenderStarted&&!1===t}(t,e.contentExistsAndHasChanged)){const e=Je.y.AlreadyRendered;this.onCommandResult(Tm.Incomplete,o,e,s,i,{errorCode:e,eventData:null==n?void 0:n.eventData})}else if(function(e){return Im.includes(e)}(t)){const e=function(e,t){return e===Ge.B.Close?t&&xm(t)?Je.y.WindowCloseRunningApp:Je.y.WindowCloseRunningCore:e===Ge.B.Abandoned?Ge.B.Abandoned:e===Ge.B.IntentTransferredCrossCloud?Ge.B.IntentTransferredCrossCloud:Je.y.UnknownCommandError}(t,s);this.onCommandResult(Tm.Canceled,o,e,s,i,{errorCode:e,eventData:null==n?void 0:n.eventData}),this.logger.log(`Command abandoned, correlationId: ${o}, reason ${e}, previousStep: ${s}`)}else if(function(e){return Nm.includes(e)}(t)){const e=(null==n?void 0:n.errorInfo)||t;this.onCommandResult(Tm.Incomplete,o,e,s,i,{errorCode:e,eventData:null==n?void 0:n.eventData}),this.logger.log(`Command incomplete, correlationId: ${o}, reason ${t}, previousStep: ${s}`)}var r,c}onCommandResult(e,t,i,n,a,s){const o=this.pendingCommands.get(t);o&&(this.reportCommandResult(t,a,e,i,n,o,s),this.cleanUpPendingCommand(t,o))}cleanUpPendingCommand(e,{timeoutId:t}){this.host.clearTimeout(t),this.pendingCommands.delete(e)}reportCommandResult(e,t,i,n,a,s,o){const{entityCommand:r}=s;this.commandResultChangeReportingService.report({correlationId:e,userContextId:t,context:{entityCommand:r,error:(null==o?void 0:o.errorCode)||(null==o?void 0:o.errorMessage)?{errorCode:null==o?void 0:o.errorCode,errorMessage:null==o?void 0:o.errorMessage}:void 0,previousStep:a,reason:n,target:Am,eventData:null==o?void 0:o.eventData},type:i})}}var Pm;!function(e){e.ExpLoader="ExpLoader",e.Core="Core",e.App="App"}(Pm||(Pm={}));var Om=i(878652);const Rm={eventId:"executeEntityCommand"};function Lm(e,t,i,n){const{replyContent:a}=e,{id:s,type:o}=t;if(n)switch(o){case pe.py.chats:return function({actionType:e,convId:t,userContextId:i,toastType:n},a,s){let o=Wi.unknown;if("quickReply"===e)o=Wi.quickReply;else{const e=`${sr}${Ki.f.RequiredFieldMissing} Toast activation command received from host with unknown chats action Type`;s.errorToTelemetry&&s.errorToTelemetry(e,"webclient_framework_host_comms",void 0,!0)}return{actionType:o,convId:t||void 0,message:a,userContextId:i,toastType:n}}(n,a,i);case pe.py.calls:return function({actionType:e,userContextId:t,toastType:i},n,a){return e||(a.errorToTelemetry&&a.errorToTelemetry(`${sr}${Ki.f.RequiredFieldMissing} Toast activation command received from host with unknown calls action type`,"webclient_framework_host_comms",void 0,!0),e="Unknown"),{actionType:e,toastId:n||void 0,toastType:i,userContextId:t}}(n,s,i);case pe.py.communities:case pe.py.communitiesjoinrequest:return function({actionType:e,userContextId:t,toastType:i,teamId:n,messageId:a},s){return i||(s.errorToTelemetry&&s.errorToTelemetry(`${sr}${Ki.f.RequiredFieldMissing} Toast activation command received from host with unknown communities toast type`,"webclient_framework_host_comms",void 0,!0),i="Unknown"),{actionType:e,toastType:i,userContextId:t,messageId:a,teamId:n}}(n,i);case pe.py.callingdeeplink:return function({actionType:e,userContextId:t,toastType:i},n,a){return e||(a.errorToTelemetry&&a.errorToTelemetry(`${sr}${Ki.f.RequiredFieldMissing} Toast activation command received from host with unknown calls action type`,"webclient_framework_host_comms",void 0,!0),e=Wi.unknown),{actionType:e,toastId:n||void 0,toastType:i,userContextId:t}}(n,s,i);default:return void(i.errorToTelemetry&&i.errorToTelemetry(`${sr}${Ki.f.RequiredFieldMissing} Unkown target entity type received from host for toast activation command`,"webclient_framework_host_comms",void 0,!0))}else i.errorToTelemetry&&i.errorToTelemetry(`${sr}${Ki.f.RequiredFieldMissing} Toast activation command received from host without target host entity options`,"webclient_framework_host_comms",void 0,!0)}function Um(e,t){switch(e){case p.A$.mutate:return pe.uk.mutate;case p.A$.view:return pe.uk.view;case p.A$.list:return pe.uk.list;case p.A$.join:return pe.uk.join;default:return t.errorToTelemetry&&t.errorToTelemetry(`${sr}${Ki.f.RequiredFieldMissing} Toast activation command received from host with unknown entity action. Defaulting to view.`,"webclient_framework_host_comms",void 0,!0),pe.uk.view}}function $m(e,t){const{entity:i,entityOptions:n,command:a}=e,{visibilityState:s,correlation:o}=a,{id:r,startTimestamp:c,source:l}=o,d=null==n?void 0:n.toastActivationEntityOptions;if(t.log(`Converting host entity command, type ${null==i?void 0:i.type}, action ${null==i?void 0:i.action}, id ${null==i?void 0:i.id}`),t.log(`toastActivationEntityOptions ${d}, visibilityState ${s}`),!d)return Rm;if(!i)return Rm;const{optionsJson:u}=i,m=function(e,t){const{id:i,type:n,action:a,linkedEntity:s}=e;return{action:Um(a,t),id:i,linkedEntity:Xm(s,t),type:Bm(n,t)}}(i,t),g=u?(0,Om.D)(u,void 0):void 0;return Object.assign(Object.assign({},Rm),{payload:{entity:m,command:{visibilityState:zm(s,t),correlation:{id:r,startTimestamp:c?c.getTime():void 0,source:l,scenarioName:z.RG.ToastActivation},stateTransition:Zm(i.type,t)},entityOptions:Wm(g),dataOptions:i.action===p.A$.mutate||i.type===p.dt.communities||i.type===p.dt.reminders||i.type===p.dt.callingdeeplink||i.type===p.dt.communitiesjoinrequest?Lm(d,m,t,g):{userContextId:g.userContextId}}})}function Wm(e){if((null==e?void 0:e.deepLinkId)&&!(null==e?void 0:e.coordinates))return{deepLinkId:e.deepLinkId};if((null==e?void 0:e.deepLinkId)&&(null==e?void 0:e.coordinates))return{deepLinkId:e.deepLinkId,deeplinkId:e.deepLinkId,coordinates:e.coordinates};if(null==e?void 0:e.campaignType)return{campaignType:e.campaignType};if(!(null==e?void 0:e.messageId))return;const{messageId:t,focusOnLoad:i}=e;return{messageId:t,focusOnLoad:i}}function Bm(e,t){switch(e){case p.dt.chats:case p.dt.reminders:return pe.py.chats;case p.dt.calls:return pe.py.calls;case p.dt.extensions:return pe.py.extensions;case p.dt.activity:return pe.py.activity;case p.dt.campaignnotifications:return pe.py.campaignnotifications;case p.dt.channels:return pe.py.channels;case p.dt.communities:return pe.py.communities;case p.dt.communitiesevents:return pe.py.communitiesevents;case p.dt.callingdeeplink:return pe.py.callingdeeplink;case p.dt.communitiesjoinrequest:return pe.py.communitiesjoinrequest;default:return t.errorToTelemetry&&t.errorToTelemetry(`${sr}${Ki.f.RequiredFieldMissing} Toast activation command received from host with unknown entity type. Defaulting to chats`,"webclient_framework_host_comms",void 0,!0),pe.py.chats}}function zm(e,t){switch(e){case p.S1.show:return ve.fe.show;case p.S1.hide:return ve.fe.hide;default:return t.errorToTelemetry&&t.errorToTelemetry(`${sr}${Ki.f.RequiredFieldMissing} Toast activation command received from host with unknown visibility state. Defaulting to show`,"webclient_framework_host_comms",void 0,!0),ve.fe.show}}function Hm(e,t){var i;const{command:n}=e,{correlation:a,visibilityState:s}=n;let o;return(null==a?void 0:a.startTimestamp)&&(o=new Date(+a.startTimestamp),o=ig(o)?o:void 0),{correlation:{id:null!==(i=null==a?void 0:a.id)&&void 0!==i?i:(0,qe.v4)(),startTimestamp:o,source:p.tq.toastFromWeb},visibilityState:Ym(s,t)}}function qm(e,t){try{const{entity:i}=e,{action:n,id:a,type:s}=i;return{action:Vm(n,t),id:a,type:Km(s)}}catch(e){throw t.errorToTelemetry&&t.errorToTelemetry(`${sr}${(0,U.u4)(e)}`,"webclient_framework_host_comms",void 0,!0),e}}function Vm(e,t){switch(e){case pe.uk.mutate:return p.A$.mutate;case pe.uk.view:return p.A$.view;case pe.uk.list:return p.A$.list;case pe.uk.join:return p.A$.join;default:return t.errorToTelemetry&&t.errorToTelemetry(`${sr}${Ki.f.RequiredFieldMissing}: EntityAction. Defaulting to HostEntityAction.view`,"webclient_framework_host_comms",void 0,!0),p.A$.view}}function Gm(e){const{id:t,linkedEntity:i,action:n,type:a,dataOptions:s}=e;return{action:n,id:t,linkedEntity:i,type:a,optionsJson:(0,U.u4)(s)}}function Jm(e){!function(e){if(!e)throw(0,oe.Tr)(h.w5.Commanding,Ki.f.RequiredFieldMissing,pe.py.toasts,void 0,`${Ki.f.RequiredFieldMissing}: entityOptions`);const t=e;if(!(t.targetEntity&&t.targetEntity.action&&t.targetEntity.type&&t.targetEntity.dataOptions&&t.time&&(t.title||""===t.title)))throw(0,oe.Tr)(h.w5.Commanding,Ki.f.RequiredFieldMissing,pe.py.toasts,void 0,`${Ki.f.RequiredFieldMissing}: hostEntityOptions?.toastEntityOptions`)}(e);const{buttons:t,targetEntity:i,textInput:n,time:a,isUrgent:s,bypassOsLevelDoNotDisturb:o}=e;return{toastEntityOptions:Object.assign(Object.assign({},e),{isUrgent:s||o,targetEntity:Gm(i),time:a,buttons:tg(t),textInput:Qm(n)})}}function Km(e){if(e===pe.py.toasts)return p.dt.toasts;throw(0,oe.Tr)(h.w5.Commanding,Ki.f.RequiredFieldMissing,pe.py.toasts,void 0,`${Ki.f.RequiredFieldMissing}: EntityType`)}function Qm(e){if(!e)return;const{placeholderText:t,sendButton:i}=e;return{placeholderText:t,sendButton:i?eg(i):void 0}}function Ym(e,t){switch(e){case ve.fe.hide:return p.S1.hide;case ve.fe.show:return p.S1.show;default:return t.errorToTelemetry&&t.errorToTelemetry(`${sr}${Ki.f.RequiredFieldMissing}: EntityVisibilityState. Defaulting to HostEntityVisibilityState.show`,"webclient_framework_host_comms",void 0,!0),p.S1.show}}function Xm(e,t){if(!e)return;const{id:i,type:n,action:a}=e;return{action:a?Um(a,t):void 0,id:i,type:Bm(n,t)}}function Zm(e,t){switch(e){case p.dt.chats:case p.dt.channels:case p.dt.calls:case p.dt.campaignnotifications:return ve.su.new;case p.dt.extensions:case p.dt.reminders:case p.dt.activity:case p.dt.communities:case p.dt.communitiesevents:case p.dt.callingdeeplink:case p.dt.communitiesjoinrequest:return ve.su.flush;default:return t.errorToTelemetry&&t.errorToTelemetry(`${sr}${Ki.f.RequiredFieldMissing} Toast activation command received from host with unhandled host entity type - ${e}.`,"webclient_framework_host_comms",void 0,!0),ve.su.new}}function eg(e){const{image:t,targetEntity:i,text:n,preferImageOnly:a,style:s}=e;return{image:t,preferImageOnly:a,style:s,targetEntity:Gm(i),text:n}}function tg(e){if(e)return e.map(eg)}const ig=e=>e instanceof Date&&!isNaN(e.getTime());function ng(e,t,i,a){var s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(e.entity.type!==pe.py.toasts)return;let o,r,c;if((null===(s=e.command.correlation)||void 0===s?void 0:s.id)&&(o=a.findScenarioByNameAndId(z.RG.CrossClientToastView,e.command.correlation.id),r=a.findScenarioByNameAndId(z.RG.WebToastShow,e.command.correlation.id)),e.entityOptions){const t=e.entityOptions;(null==t?void 0:t.crossClientScenarioName)&&(null==t?void 0:t.callId)&&(c=a.findScenarioByNameAndId(null==t?void 0:t.crossClientScenarioName,null==t?void 0:t.callId))}const l=yield function(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let i;try{i=yield e.loadModule("core"),t.log(`${sr}${rr.LoadModuleCoreSuccess}`)}catch(e){const i=`${sr}${or.LoadModuleCoreFailed} ${(0,U.u4)(e)}`;t.errorToTelemetry&&t.errorToTelemetry(i,"webclient_framework_host_comms",void 0,!0)}return i}))}(t,i);if(!l||!l.executeCommand)return i.errorToTelemetry&&i.errorToTelemetry(`${sr}${or.LoadModuleCoreFailed}`,"webclient_framework_host_comms",void 0,!0),null==o||o.fail({errorCode:or.LoadModuleCoreFailed}),null==r||r.fail({errorCode:or.LoadModuleCoreFailed}),void(null==c||c.fail({errorCode:or.LoadModuleCoreFailed}));try{const t=function(e,t){return{command:Hm(e,t),entity:qm(e,t),entityOptions:Jm(null==e?void 0:e.entityOptions)}}(e,i);yield null==l?void 0:l.executeCommand(t),i.log(`${sr}${rr.ExecuteCommandSuccess}`),null==o||o.mark(z.ck.CrossClientHostEventSent),null==c||c.mark(z.ck.CrossClientHostEventSent),null==r||r.stop()}catch(e){i.errorToTelemetry&&i.errorToTelemetry(`${sr}${or.ExecuteCommandFailed} ${(0,U.u4)(e)}`,"webclient_framework_host_comms",void 0,!0),null==o||o.fail({errorCode:or.ExecuteCommandFailed}),null==r||r.fail({errorCode:or.ExecuteCommandFailed}),null==c||c.fail({errorCode:or.ExecuteCommandFailed})}}))}class ag{constructor(e,t,i,n){this.commandChangeReportingService=e,this.commandResultChangeReportingService=t,this.scenarioFactory=i,this.pendingCommands=new Map,this.logger=n.newLogger("CommandTelemetryService","core-services-entity-commanding"),this.commandSequence=0}init(){this.commandChangeSubscription=this.commandChangeReportingService.observeChanges().subscribe((e=>this.onCommandChange(e))),this.commandResultChangeSubscription=this.commandResultChangeReportingService.observeChanges().subscribe((e=>this.onCommandResultChange(e)))}destroy(){var e,t,i;this.pendingCommands.clear(),null===(e=this.commandChangeSubscription)||void 0===e||e.unsubscribe(),null===(t=this.commandResultChangeSubscription)||void 0===t||t.unsubscribe(),null===(i=this.lifeCycleScopeChangeSubscription)||void 0===i||i.unsubscribe()}onCommandChange(e){switch(e.type){case Ge.B.ScenarioEventDataAppended:{const{correlationId:t,context:{eventData:i}}=e;this.appendScenarioEventData(t,i);break}case Ge.B.ScenarioMarked:{const{correlationId:t,context:{step:i,eventData:n,status:a,monitoringData:s}}=e;this.addScenarioMark(t,i,e.type,n,a,s);break}case Ge.B.Rendered:case Ge.B.CommandMetaDataAdded:break;case Ge.B.DelegatedCommandReceived:case Ge.B.EventBubbled:{const{context:{correlation:t}}=e;this.startCommandTelemetry(t.id,{correlation:t});break}case Ge.B.CommandStart:{const{correlationId:t,context:{entityCommand:i}}=e,{scenarioEventData:n}=i;this.startCommandTelemetry(t,{entityCommand:i}),n&&this.appendScenarioEventData(t,n);break}case Ge.B.NavigationCommandStart:{const{correlationId:t,context:{clientLaunchId:i,correlation:n,eventData:a}}=e;this.startCommandTelemetry(t,{correlation:n,clientLaunchId:i}),a&&this.appendScenarioEventData(t,a);break}default:{const{type:t,correlationId:i,context:{eventData:n}}=e,a=this.pendingCommands.get(i);if(a&&a.previousEvents.has(t))break;null==a||a.previousEvents.add(t),xm(t)&&(null==a||a.commandScenario.appendEventData({scenarioPhase:Pm.App})),n&&this.appendScenarioEventData(i,n),this.addScenarioMark(i,t,t,n);break}}}findExistingNavigationCommandScenario(e,t){const i=t.scenarioName||z.RG.NavigationCommand;let n=this.scenarioFactory.findScenarioByNameAndId(i,e);return(null==n?void 0:n.eventData["EventInfo.CorrelationId"])!==t.id&&(n=null),n||t.scenarioName!==z.RG.ClientStart||(n=this.scenarioFactory.findScenario(z.RG.ClientStart)),n||void 0}findExistingActivitySwitchScenario(e){const t=null==e?void 0:e.id;if((null==e?void 0:e.source)===k.D.ActivityFeedBellClick){const e=Array.from(this.pendingCommands.values());for(const i of e)if(i.correlation.scenarioName===z.RG.ActivitySwitch||i.correlation.scenarioName===z.RG.NavigationCommand){const e=i.correlation.id;this.logger.log(`Command was sent by activity app as a result of a bell click, correlationId ${t}. Combining scenario with existing ${i.correlation.scenarioName} of correlationId ${e}`);const n=i.commandScenario;return this.pendingCommands.delete(e),n}}}startCommandTelemetry(e,{entityCommand:t,correlation:i,clientLaunchId:n}){let a,s=this.pendingCommands.get(e);if(n&&i&&(a=this.findExistingNavigationCommandScenario(n,i)),!a&&t){const{scenarioName:e,id:i}=t.command.correlation;e&&(a=this.scenarioFactory.findScenarioByNameAndId(e,i))}a||(a=this.findExistingActivitySwitchScenario(i||(null==t?void 0:t.command.correlation))),s?t&&(this.logger.log(`Updating command\n\tscenarioName: ${s.commandScenario.name}\n\tcorrelationId: ${e}\n\tentityType: ${t.entity.type}\n\tentityAction: ${t.entity.action}`),s.commandScenario.appendEventData({mainEntityAction:t.entity.action,mainEntityType:t.entity.type})):s=this.createPendingCommand(e,{commandScenario:a,entityCommand:t,correlation:i,clientLaunchId:n}),this.pendingCommands.set(e,s)}createPendingCommand(e,{entityCommand:t,correlation:i,clientLaunchId:n,commandScenario:a}){var s;if(!(i=null!=i?i:null==t?void 0:t.command.correlation)){const e=new Error("correlation cannot be undefined. A valid entityCommand or correlation should be passed.");throw this.logger.errorToTelemetry&&this.logger.errorToTelemetry(e.message,"webclient_framework_foundation_command_reporting_service_event",void 0,!0),e}if(i.scenarioName=null!==(s=i.scenarioName)&&void 0!==s?s:z.RG.EntityCommand,!a){this.logger.log(`Creating new scenario with scenarioName: ${i.scenarioName}, correlationId ${e}`);const{startTimestamp:s}=i,o=s&&ig(new Date(+s))?+s:void 0,r=n;(a=this.scenarioFactory.newScenario(i.scenarioName,{startTime:o,clientId:r})).appendEventData({"EventInfo.CorrelationId":e,commandSequence:++this.commandSequence,commandSource:i.source,mainEntityAction:null==t?void 0:t.entity.action,mainEntityType:null==t?void 0:t.entity.type,scenarioPhase:Pm.Core})}return this.logger.log(`Starting to track a new command\n\tscenarioName: ${i.scenarioName}\n\tcorrelationId: ${e}\n\tentityType: ${null==t?void 0:t.entity.type}\n\tentityAction: ${null==t?void 0:t.entity.action}\n\tclientId: ${n}`),{correlation:i,commandScenario:a,previousEvents:new Set}}appendScenarioEventData(e,t){const i=this.pendingCommands.get(e);i&&i.commandScenario.appendEventData((0,B.omitBy)(t,B.isUndefined))}addScenarioMark(e,t,i,n,a,s){const o=this.pendingCommands.get(e);o&&(i!==Ge.B.ScenarioMarked&&this.logger.log(`${o.commandScenario.name} addScenarioMark, correlationId: ${e}, step: ${t}, eventData: ${JSON.stringify(n)}`),o.commandScenario.mark(t,n&&(0,B.omitBy)(n,B.isUndefined),a,s))}onCommandResultChange(e){const{context:{error:t,reason:i,previousStep:n,eventData:a,entityCommand:s},correlationId:o,type:r}=e,c=this.pendingCommands.get(o);if(!c)return void this.logger.error(`Command Result of ${i} and correlationId ${o} was reported but no pending command was found`);const l=null==c?void 0:c.commandScenario,d=(0,B.omitBy)(s&&ag.overrideMainEntityForExtensionCommand(a,s)||a,B.isUndefined);switch(r){case Tm.Canceled:{const{errorCode:e}=t||{};this.logger.warn(`${l.name} Cancelled, correlationId: ${o}, reason: ${e}, previousStep: ${n}`),l.cancel(Object.assign({errorCode:e,reason:e},d));break}case Tm.Failure:{const{errorCode:e,errorMessage:i}=t||{};this.logger.error(`${l.name} Failed, correlationId: ${o}, reason: ${e}, errorMessage: ${i}, previousStep: ${n}`),l.fail(Object.assign({errorCode:e,reason:e,errors:i&&(0,se.A)(i)},d));break}case Tm.Incomplete:{const{errorCode:e}=t||{};this.logger.warn(`${l.name} Incomplete, correlationId: ${o}, reason: ${e}, previousStep: ${n}`),l.incomplete(Object.assign({errorCode:e,reason:e},d));break}case Tm.Success:this.logger.log(`${l.name} Successful, correlationId: ${o}, reason: ${i}, previousStep: ${n}`),l.stop(Object.assign({reason:i},d))}this.pendingCommands.delete(o)}static overrideMainEntityForExtensionCommand(e,t){return t.command.stateTransition!==ve.su.extend?e:Object.assign(Object.assign({},e),{modalEntityType:t.entity.type,modalEntityAction:t.entity.action})}}const sg=[Ge.B.ApplicationHookReceivedCommand,Ge.B.ApplicationHookContinuedCommand],og=[Ge.B.ChunkLoadStarted,Ge.B.ChunkLoadSucceeded,Ge.B.ScenarioEventDataAppended,Ge.B.ScenarioMarked];class rg{constructor(e,t){this._host=t,this.commandTimedOutAtHostHandler=e=>{const{correlationId:t,reason:i}=e.payload,n=this._pendingCommands.get(t);n&&(n.onCommandTimeOut&&n.onCommandTimeOut(i),this.cleanUpPendingCommand(t))},this._logger=e.newLogger("CommandReportingServiceHybrid","core-services-entity-commanding"),this._pendingCommands=new Map,this._host.opener.addEventListener(L.rY.EntityCommandTimedOutAtHost,this.commandTimedOutAtHostHandler)}registerNavigationCommandStart(){}registerCommandStart(e){var t;const i=e.command.correlation.id;if(!i)return void this._logger.error("registerCommandStart called without a command correlation id");const n=this._pendingCommands.get(i);n&&(this._logger.log(`registerCommandStart called with a pending command with correlation id ${i}, overwriting and starting new timeout interval`),this._host.clearTimeout(n.timeoutId));const a=null===(t=null==n?void 0:n.entityCommand.entityOptions)||void 0===t?void 0:t.timeout,s=a||9e4,o=this._host.setTimeout((()=>{this.reportCommandEvent(i,Ge.B.CommandReportingTimedOut),this.cleanUpPendingCommand(i)}),s);this._logger.log(`Starting to track command with correlation Id ${i}`),this._pendingCommands.set(i,{entityCommand:e,timeoutId:o,previousEvents:new Set})}appendCommandEventData(e,t){const i=this._pendingCommands.get(e);i?this._pendingCommands.set(e,Object.assign(Object.assign({},i),{eventData:Object.assign(Object.assign({},i.eventData),t)})):this._logger.warn(`appendCommandEventData called with correlationId ${e}, but there was no such pending command`)}reportCommandEvent(e,t,i,n,a,s){const o=this._pendingCommands.get(e);if(!o)return;if(!og.includes(t)&&o.previousEvents.has(t))return;o.previousEvents.add(t);const{entityCommand:r,eventData:c}=o,l=Object.assign(Object.assign(Object.assign({entityCommand:r,commandEvent:t},c),i),{timestamp:Date.now(),scenarioEventData:n,step:a,status:s});t===Ge.B.CommandReportingTimedOut||sg.includes(t)||this._logger.log(`Command event reported ${t} for correlation id ${e}`),sg.includes(t)||this._host.opener.postMessage(w.W.CommandChangeType,l)}registerForCommandTimeOut(e,t){const i=this._pendingCommands.get(e);i&&(i.onCommandTimeOut=t)}unRegisterForCommandTimeOut(e){const t=this._pendingCommands.get(e);t&&(t.onCommandTimeOut=void 0)}appendScenarioEventData(e,t){this.reportCommandEvent(e,Ge.B.ScenarioEventDataAppended,void 0,t)}addScenarioMark(e,t,i,n){this.reportCommandEvent(e,Ge.B.ScenarioMarked,void 0,i,t,n)}cleanUpPendingCommand(e){const t=this._pendingCommands.get(e);t&&(this._host.clearTimeout(t.timeoutId),this._pendingCommands.delete(e))}}class cg{constructor(e,t){this.legacyCommandReportingService=e,this.commandChangeReportingService=t,this.commandChangeSubscription=this.setUpCommandChangeSubscriptions()}destroy(){this.commandChangeSubscription.unsubscribe()}changeToCommandReportingService(e){switch(e.type){case Ge.B.AfterOnCommandReceived:case Ge.B.AfterOnEventReceived:case Ge.B.BeforeOnCommandReceived:case Ge.B.BeforeOnEventReceived:case Ge.B.CommandHandledByOnCommandReceived:case Ge.B.EventBubbled:case Ge.B.EventHandled:case Ge.B.DelegatedCommandReceived:break;case Ge.B.ScenarioEventDataAppended:{const{context:{eventData:t},correlationId:i}=e;this.legacyCommandReportingService.appendScenarioEventData(i,t);break}case Ge.B.ScenarioMarked:{const{context:{step:t,eventData:i,status:n,monitoringData:a},correlationId:s}=e;this.legacyCommandReportingService.addScenarioMark(s,t,i,n,a);break}case Ge.B.CommandStart:{const{context:{entityCommand:t,executionContextEntity:i},correlationId:n}=e,{scenarioEventData:a}=t;this.legacyCommandReportingService.registerCommandStart(t),a&&this.legacyCommandReportingService.appendScenarioEventData(n,a),this.legacyCommandReportingService.reportCommandEvent(n,Ge.B.CommandReceived,{executionContextEntity:i});break}case Ge.B.NavigationCommandStart:{const{context:{clientLaunchId:t,correlation:i,eventData:n},correlationId:a}=e;this.legacyCommandReportingService.registerNavigationCommandStart(t,i),this.legacyCommandReportingService.addScenarioMark(a,Ge.B.DeeplinkReceived),n&&this.legacyCommandReportingService.appendScenarioEventData(a,n);break}case Ge.B.CommandMetaDataAdded:{const t=e.context,{target:i}=t,a=(0,n.__rest)(t,["target"]),{correlationId:s}=e;this.legacyCommandReportingService.appendCommandEventData(s,a);break}case Ge.B.NotHandled:{const{correlationId:t,type:i}=e;this.legacyCommandReportingService.reportCommandEvent(t,i);break}default:{const t=e.context,{target:i,eventData:a}=t,s=(0,n.__rest)(t,["target","eventData"]),{correlationId:o,type:r}=e;this.legacyCommandReportingService.reportCommandEvent(o,r,s,a);break}}}setUpCommandChangeSubscriptions(){return this.commandChangeReportingService.observeChanges().subscribe((e=>this.changeToCommandReportingService(e)))}}class lg{constructor(e,t,i){this.commandChangeReportingService=e,this.lifeCycleScopeChangeReportingService=t,this.logger=i.newLogger("CommandAppLifeCycleListenerService","core-services-entity-commanding"),this.lifeCycleScopeChangeSubscription=this.subscribeToLifeCycleScopeChange()}destroy(){var e;null===(e=this.lifeCycleScopeChangeSubscription)||void 0===e||e.unsubscribe()}subscribeToLifeCycleScopeChange(){return this.lifeCycleScopeChangeReportingService.observeChanges().pipe((0,l.U)((({correlationId:e,context:{apps:t}})=>{let i=!1;return t.forEach((({id:t,type:n})=>{n===Mt.c4.Initialized&&(i=!0,this.logger.log(`${t} initialized, correlationId: ${e}`))})),{appInitialized:i,correlationId:e}})),(0,u.h)((({appInitialized:e})=>e))).subscribe((({correlationId:e,appInitialized:t})=>{this.commandChangeReportingService.report({correlationId:e,type:Ge.B.ScenarioEventDataAppended,context:{target:"commandAppLifeCycle",eventData:{appInitialized:t}}})}))}}class dg{constructor(e){this._cap=e,this._map=new Map}entries(){return this._map.entries()}get(e){return this._map.get(e)}set(e,t){if(this._map.size>=this._cap){const e=this._map.keys().next().value;this._map.delete(e)}return this._map.set(e,t)}}class ug{constructor(e){this.commandChangeReportingService=e}init(){this.commandsHistory&&this.destroy(),this.commandsHistory=new dg(30),this.initCommandChangeReportingSubscription()}destroy(){var e;null===(e=this.commandChangeReportingSubscription)||void 0===e||e.unsubscribe(),this.commandChangeReportingSubscription=void 0,this.commandsHistory=void 0}get CommandsHistory(){return this.commandsHistory}initCommandChangeReportingSubscription(){this.commandChangeReportingSubscription=this.commandChangeReportingService.observeChanges().subscribe((e=>this.onCommandChange(e)))}onCommandChange(e){const{correlationId:t}=e;if(this.commandsHistory)if(e.type===Ge.B.CommandStart){const{context:{entityCommand:i}}=e;let n=this.commandsHistory.get(t);const a={entityCommand:i,isCommandTargetedToMainWindow:!1,steps:[]};n=n?Object.assign(Object.assign({},n),{entityCommand:i}):a,this.commandsHistory.set(t,n)}else if(e.type===Ge.B.CommandMetaDataAdded){const{correlationId:t,context:{isCommandTargetedToMainWindow:i}}=e,n=this.commandsHistory.get(t);n&&i&&this.commandsHistory.set(t,Object.assign(Object.assign({},n),{isCommandTargetedToMainWindow:i}))}else{const i=this.commandsHistory.get(t);null==i||i.steps.push({event:e.type,timestamp:Date.now()-(parseInt(i.entityCommand.command.correlation.startTimestamp,10)||0)})}}}function mg(e,t,...i){var n;const{coreSettings:a}=t,s=null!==(n=null==a?void 0:a.get(S.J.Core).enableCoreErrorsV2)&&void 0!==n&&n,o=[];for(const n of i)if(!t[n]&&(o.push(n),!s)){const t=`${e}: ${n} is missing`;throw(0,oe.Tr)(h.w5.Core,h.jK.CoreServiceMissing,e,void 0,t)}if(s&&o.length>0)throw Le.fromMissingDependencies(e,o);return t}class gg extends Ue{constructor(){super(h.Yg.CreateCommandReportingService,[])}execute(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i="CreateCommandReportingServiceTask",{commandChangeReportingService:n,coreSettings:a,lifeCycleScopeChangeReportingService:s,loggerFactory:o,scenarioFactory:r,windowProvider:c}=mg(i,e,"coreSettings","commandChangeReportingService","lifeCycleScopeChangeReportingService","loggerFactory","scenarioFactory","windowProvider");if(null===(t=a.get(S.J.Core))||void 0===t?void 0:t.enableStandaloneCommandReportingService){const{commandResultChangeReportingService:t}=mg(i,e,"commandResultChangeReportingService"),s=new Mm(o,n,t,c);s.init(),e.commandResultService=s,new ag(n,t,r,o).init(),this.initCommandHistoryService(e,n,a)}else e.commandReportingService=new rg(o,c),new cg(e.commandReportingService,n);new lg(n,s,o),this.initCommandHistoryService(e,n,a)}))}initCommandHistoryService(e,t,i){e.commandHistoryService=new ug(t),(null==i?void 0:i.get(S.J.Diagnostics).isDiagnosticsPanelEnabled)&&e.commandHistoryService.init()}}class hg extends Ue{constructor(){super(h.Yg.CreateCommandResultHooksService,[])}execute(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:i,coreSettings:n,client:a,commandResultChangeReportingService:s,entityCommanding:o,loggerFactory:r,scenarioFactory:c}=mg("CreateCommandReportingServiceTask",e,"appsRegistryService","client","commandResultChangeReportingService","coreSettings","entityCommanding","loggerFactory","scenarioFactory");return(null===(t=n.get(S.J.Core))||void 0===t?void 0:t.enableStandaloneCommandReportingService)&&(e.commandResultHooksService=new ha(i,a,s,n,o,r,c,e.authenticationUser&&(0,He.b4)(e.authenticationUser)),e.commandResultHooksService.init()),Promise.resolve()}))}}var pg=i(682265);const vg=(e,t,i,n)=>{const a=`${e}::TypeError::`;try{return new URL(t,i||void 0)}catch(e){let s=`${a}base::${i}`;throw n&&(s=s.concat(`::url::${t}`)),new pg.Y("URL_PARSE_FAILED",new Error(s))}},fg=(e,t,i)=>{let n=!1,a=!1,s=!1,o=!1,r=!1,c=`${e}::`;const l="ProtocolValidationFailed::",d="OriginValidationFailed::";if(t.protocol&&i.protocol?a=!0:c=c.concat(`${l}EmptyProtocol::'${t.protocol}'::'${i.protocol}'`),t.protocol!==i.protocol?c=c.concat(`${l}'${t.protocol}' !== '${i.protocol}'`):s=!0,t.origin&&i.origin?o=!0:c=c.concat(`${d}EmptyOrigin::'${t.origin}'::'${i.origin}'`),t.origin!==i.origin?c=c.concat(`${d}'${t.origin}' !== '${i.origin}'`):r=!0,n=a&&s&&o&&r,!n)throw new pg.Y("URL_VALIDATION_FAILED",new Error(c))},bg={id:"@msteams/components-calling-ppt-sharing#components-calling-ppt-sharing",getConfig:e=>({createScriptURL:(t,i)=>{var n;const a="pptLivePolicy",s=null!==(n=e.get(S.J.Security).pptLiveAllowedOrigin)&&void 0!==n?n:[];if(!Array.isArray(s)||0===s.length)throw new pg.Y("URL_VALIDATION_FAILED",new Error(`${a}::TypeError::allowedOriginList pptLiveAllowedOrigin is undefined or empty`));let o;const r=vg(a,t,i,!0);for(const e of s)try{const t=vg(a,e,void 0,!0);return fg(a,r,t),r.href}catch(e){o=e}throw o}})},yg={id:"@msteams/services-utilities-google-authentication#google-client-library-loader",getConfig:e=>({createScriptURL:(t,i)=>{var n;const a="googleClientLibraryLoaderPolicy",s=null!==(n=e.get(S.J.Security).googleClientLibraryLoaderAllowedOrigin)&&void 0!==n?n:[];if(!Array.isArray(s)||0===s.length)throw new pg.Y("URL_VALIDATION_FAILED",new Error(`${a}::TypeError::allowedOriginList googleClientLibraryLoaderAllowedOrigin is undefined or empty`));let o;const r=vg(a,t,i,!0);for(const e of s)try{const t=vg(a,e,void 0,!0);return fg(a,r,t),r.href}catch(e){o=e}throw o}})},kg=[{id:"@msteams/services-io-calling-service-adapters#cmdb-calling-bundle-loader-service-adapter",getConfig:e=>({createScriptURL:(t,i)=>{const n="callingBundleLoaderPolicy",a=e.get(S.J.Security).callingBundleLoaderAllowedOrigin;if(!a)throw new pg.Y("URL_VALIDATION_FAILED",new Error(`${n}::TypeError::allowedOriginList callingBundleLoaderAllowedOrigin is undefined or empty`));let s;const o=vg(n,t,i,!0);try{const e=vg(n,a,void 0,!0);return fg(n,o,e),o.href}catch(e){s=e}throw s}})},yg,{id:"@msteams/components-location-bing-map#location-sdk-api",getConfig:e=>({createScriptURL:(t,i)=>{const n="locationSdkApiPolicy",a=e.get(S.J.Security).bingApiAllowedOrigin;if(!a)throw new pg.Y("URL_VALIDATION_FAILED",new Error(`${n}::TypeError::allowedOriginList bingApiAllowedOrigin is undefined or empty`));let s;const o=vg(n,t,i,!0);try{const e=vg(n,a,void 0,!0);return fg(n,o,e),o.href}catch(e){s=e}throw s}})},bg],Sg={id:"@msteams/services-utilities-common#ChunkLoader",getConfig:e=>({createScriptURL:(t,i)=>{var n;const a="chunkLoaderPolicy";let s,o,r,c=!1,l=!1;const d=vg(a,t,i,!0),u=null!==(n=e.get(S.J.Platform).staticsPath)&&void 0!==n?n:"";if(!u)throw new pg.Y("URL_PARSE_FAILED",new Error(`${a}::TypeError::allowListUrl staticsPath is undefined`));try{r=vg(a,u,void 0,!0),fg(a,d,r),c=!0}catch(e){s=e}if(c)return d.href;try{r=vg(a,Cg,void 0,!0),fg(a,d,r),l=!0}catch(e){o=e}if(l)return d.href;if(s)throw s;throw o}})},wg=[{id:"@msteams/no-op",getConfig:()=>({createHTML:e=>e,createScriptURL:e=>e})},Sg,{id:"@msteams/services-io-browser-web-client-update#register-service-worker",getConfig:()=>({createScriptURL:(e,t)=>{const i="registerServiceWorkerPolicy";let n,a,s=!1;const o=vg(i,e,t,!0);try{a=vg(i,Cg,void 0,!0),fg(i,o,a),s=!0}catch(e){n=e}if(s)return o.pathname;throw n}})},{id:"@msteams/core-services-telemetry-worker#TelemetryWorker",getConfig:e=>({createScriptURL:(e,t)=>{const i="telemetryWorkerPolicy";let n,a,s=!1;const o=vg(i,e,t,!0);try{a=vg(i,Cg,void 0,!0),fg(i,o,a),s=!0}catch(e){n=e}if(s)return o.pathname;throw n}})}];function jg(){return window}const Cg=jg().location.origin;class _g{constructor(e,t){this.coreSettings=e,this.logger=t.newLogger("CoreSecurityService","core-services-security"),this.configMap=new Map,this.policyMap=new Map,this.initializeTrustedTypeConfigMap(),this.setIsTrustedTypePoliciesEnabled()}getTrustedTypePolicy(e){var t,i,n;let a;if(this.isTrustedTypePoliciesEnabled||(e="@msteams/no-op"),a=this.policyMap.get(e),a)return a;if(a=this.createTrustedTypePolicyOnDemand(e),a)return this.policyMap.set(e,a),a;const s=new pg.Y("POLICY_NOT_FOUND",new Error(`${e}`));throw null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,`${s.code}::${null===(n=s.prevError)||void 0===n?void 0:n.message}`,"webclient_framework_foundation_core_services_security",void 0,!0),s}createTrustedTypePolicyOnDemand(e){var t,i,n;const a=this.configMap.get(e);if(!a)return;const s=jg().trustedTypes;if(!this.isTrustedTypePoliciesEnabled||!s)return this.getOptionsAsTrustedTypePolicy(a);try{return s.createPolicy(a.id,a.getConfig(this.coreSettings))}catch(a){const s=new pg.Y("CREATE_POLICY_FAILED",new Error(`${e}${null==a?void 0:a.message}`));throw null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,`${s.code}::${null===(n=s.prevError)||void 0===n?void 0:n.message}`,"webclient_framework_foundation_core_services_security",void 0,!0),s}}getOptionsAsTrustedTypePolicy(e){return e.getConfig(this.coreSettings)}initializeConfigs(){kg.forEach((e=>{this.setConfig(e)}))}initializeCoreConfigs(){wg.forEach((e=>{this.setConfig(e)}))}initializeTrustedTypeConfigMap(){this.initializeCoreConfigs(),this.initializeConfigs()}setConfig(e){if(this.configMap.has(e.id))throw new pg.Y("DUPLICATE_POLICY_FOUND",new Error(`CoreSecurityService::${e.id}`));this.configMap.set(e.id,e)}setIsTrustedTypePoliciesEnabled(){const{enableTrustedTypePolicies:e}=this.coreSettings.get(S.J.Core);this.isTrustedTypePoliciesEnabled=!!e}}class Tg extends Ue{constructor(){super(h.Yg.CreateCoreSecurityTask,["coreSettings","loggerFactory","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:i,windowProvider:n}=e,a=i.newLogger("CoreSecurityService","core-services-tasks"),s=new _g(t,i);e.coreSecurityService=s,n.chunkLoader.configureCoreSecurityService(s),a.log("CoreSecurityService Initialized")}))}}var Ig,Ng;!function(e){e.Merge="merge",e.Override="override"}(Ig||(Ig={})),function(e){e[e.Configuration=0]="Configuration",e[e.Override=1]="Override",e[e.ClientFilters=2]="ClientFilters",e[e.Policy=3]="Policy",e[e.TestOverride=4]="TestOverride"}(Ng||(Ng={}));class Eg{constructor(){this.providers={[Ng.Configuration]:[],[Ng.Override]:[],[Ng.ClientFilters]:[],[Ng.Policy]:[],[Ng.TestOverride]:[]}}registerProvider(e,t){this.providers[t].push(e)}getSettings(e){const t=this.mergeProviders(Ng.Configuration,e),i=this.mergeProviders(Ng.Override,e,t),n=this.mergeProviders(Ng.ClientFilters,e),a=this.combineConfigs(i,n,this.filterAndConfigMergeRule),s=this.mergeProviders(Ng.Policy,e),o=this.combineConfigs(a,s,this.policyAndConfigMergeRule);return this.mergeProviders(Ng.TestOverride,e,o)}mergeProviders(e,t,i={}){return this.providers[e].map((e=>e.getSettings())).filter((e=>!!e)).map((e=>(0,B.pick)(e,t))).reduce(((e,t)=>((0,B.mergeWith)(e,t,Ru.g),e)),i)}combineConfigs(e,t,i){return Object.keys(t).map((n=>{const a=(0,B.get)(e,n)||{},s=(0,B.get)(t,n)||{};Object.keys(s).map((t=>{const o=(0,B.get)(a,t),r=(0,B.get)(s,t),c=i(o,r);(0,B.set)(a,t,c),(0,B.set)(e,n,a)}))})),e}policyAndConfigMergeRule(e,t){return(0,B.isNil)(e)?t:(0,B.isNil)(t)?void 0:(0,B.isBoolean)(t)?e&&t:t}filterAndConfigMergeRule(e,t){return(0,B.isNil)(e)?t:(0,B.isBoolean)(t)?t&&e:t}}class Fg{constructor(e){this.value=e,this.observers=new Map}getObservable(e){return new Ti.y((t=>(e.forEach((e=>this.getOrCreateObservers(e).push(t))),t.next(this.value),{unsubscribe:()=>{e.forEach((e=>{const i=this.getOrCreateObservers(e),n=i.indexOf(t);n>=0&&i.splice(n,1)}))}})))}next(e,t){this.value=t;const i=(0,B.reduce)(e.map((e=>this.getOrCreateObservers(e))),((e,t)=>e.concat(t)));new Set(i).forEach((e=>e.next&&e.next(t)))}getOrCreateObservers(e){let t=this.observers.get(e);return void 0===t&&(t=[],this.observers.set(e,t)),t}}class xg{constructor(e,t){this.cachedCategorySettings=new Map,this.categoryBehaviorSubjectMap=new Map,this.perCategoryFilteredSubjects={},this.behaviorSubjectForAnySettingsChangeForCdlWorker=new s.X(void 0),this.providerSubscriptions=[],this.enableFilteredSettingsSubject=!1,this.notifySettingsChanged=()=>{var e;const t=Array.from(this.cachedCategorySettings.keys());this.logger.log("Settings have changed, checking for differences in these categories:",t);const i=this.ruleEngine.getSettings(t),n={};t.forEach((e=>{const t=this.cachedCategorySettings.get(e)||{},a=i[e]||{},s=this.getKeysForUpdatedSettingsInCategory(t,a);s.length>0&&(n[e]=s,this.cachedCategorySettings.set(e,a))})),this.logger.log("Updated settings:",i),Object.keys(n).length>0&&this.behaviorSubjectForAnySettingsChangeForCdlWorker.next();const a=null===(e=this.scenarioFactory)||void 0===e?void 0:e.newScenario(z.RG.SettingsChangedNotificationSync);try{this.getObservedCategories().forEach((e=>{const t=this.createOrGetBehaviorSubjectFromCache(e),s=i[e]||{},o=n[e]||[];0!==o.length&&(this.logger.log(`Notifying subscribers of: '${e}', settings changed to: `,s),t.next(s),null==a||a.mark(z.ck.SettingsChangedNotificationSyncCategoryNotified,{category:e,selectedSettings:!1}),this.getOrCreateFilteredSubject(e).next(o,s),null==a||a.mark(z.ck.SettingsChangedNotificationSyncCategoryNotified,{category:e,selectedSettings:!0}))}))}finally{null==a||a.stop()}},this.logger=t.newLogger(`CoreSettings/Service(${e})`,"core-services-settings"),this.ruleEngine=new Eg,this.logger.log("Created.")}cleanup(){this.logger.log("Cleaning up."),this.providerSubscriptions.forEach((e=>e.unsubscribe())),this.categoryBehaviorSubjectMap.clear(),this.perCategoryFilteredSubjects={}}get(e,t){const i=this.cachedCategorySettings.get(e);if(i)return i;const n=this.getLatestSettingsForCategory(e);return this.cachedCategorySettings.set(e,n),this.logger.log(`Creating cache for '${e}' category, settings:`,n),n}getObservable(e,t){const i=this.createOrGetBehaviorSubjectFromCache(e);return this.enableFilteredSettingsSubject&&void 0!==t?this.getOrCreateFilteredSubject(e).getObservable(t):i.asObservable()}getObservableForAnySettingsChangeForCdlWorker(){return this.behaviorSubjectForAnySettingsChangeForCdlWorker.asObservable()}registerProvider(e,t){this.ruleEngine.registerProvider(e,t);const i=e.subscribe(this.notifySettingsChanged);this.providerSubscriptions.push(i)}setScenarioFactory(e){this.scenarioFactory=e}readEnableFilteredSettingsSubject(){this.enableFilteredSettingsSubject=!!this.getLatestSettingsForCategory(S.J.Core).enableFilteredSettingsSubject}createOrGetBehaviorSubjectFromCache(e){let t=this.categoryBehaviorSubjectMap.get(e);if(!t){const i=this.get(e);t=new s.X(i),this.categoryBehaviorSubjectMap.set(e,t),this.logger.log(`Creating subject for '${e}' category, settings:`,i)}return t}getOrCreateFilteredSubject(e){let t=this.perCategoryFilteredSubjects[e];return void 0===t&&(t=new Fg(this.get(e)),this.perCategoryFilteredSubjects[e]=t),t}getLatestSettingsForCategory(e){return this.ruleEngine.getSettings([e])[e]||{}}getKeysForUpdatedSettingsInCategory(e,t){return(0,B.reduce)(t,((t,i,n)=>(0,B.isEqual)(i,e[n])?t:t.concat(n)),[])}getObservedCategories(){let e=Array.from(this.categoryBehaviorSubjectMap.keys());return e=e.concat(Object.keys(this.perCategoryFilteredSubjects)),e=Array.from(new Set(e)),e}}class Dg{constructor(e,t){this.coreSettingsContext=t,this.providers=[],this.logsProviderName="CoreSettingsLogsProvider",this.logger=e.newLogger("CoreSettingsLogsProvider","core-services-settings")}getLogsFiles(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return[{isPiiFree:!1,fileName:"settings.json",content:(yield this.getCurrentSettingsSnapshot())||"Could not fetch settings"}]}))}registerProvider(e,t){this.providers.push({provider:e,type:t})}getCurrentSettingsSnapshot(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const e=yield this.coreSettingsContext.getDebugService(),t=e.getSettings(!0),i=new Map;this.providers.forEach((({provider:e})=>{const t=e.getDiagnosticsInfo();t&&i.set(e.providerName,t)}));const n={settings:this.getGroupedSettings(t),rawPolicies:e.getRawPolicies()||"",providersInfo:[...i.entries()]};return JSON.stringify(n)}catch(e){this.logger.error("Diagnostics: Failed to get settings snapshot: ",e)}return""}))}getGroupedSettings(e){if(!e||0===e.length)return"";const t=e.reduce(((e,t)=>{var i;if(void 0===t.value&&(!t.providers||0===t.providers.length))return e;e[t.category]=e[t.category]||{},e[t.category][t.key]={};let n=!1;return null===(i=t.providers)||void 0===i||i.forEach((i=>{e[t.category][t.key][i.shortName]=i.value,(0,B.isEqual)(t.value,i.value)||(n=!0)})),n&&t.providers&&(t.providers.length>1||void 0===t.value)&&(e[t.category][t.key].value=void 0===t.value?"undefined":t.value),e}),{});return t}}class Ag{constructor(){this.callbacks=[]}subscribe(e){if(!(0,B.isFunction)(e))throw Error("Callback is not a valid function.");const t=this;t.callbacks.push(e);return{unsubscribe:()=>{const i=t.callbacks.indexOf(e);i>=0&&t.callbacks.splice(i,1)}}}getRawSettings(){}getDiagnosticsInfo(){}cleanup(){}notifySettingsChanged(e){this.callbacks.forEach((t=>t(e)))}}function Mg(e,t,i){const n={};return(0,B.forOwn)(e,((e,a)=>{const s={};(0,B.forOwn)(e,((e,n)=>{(0,B.forEach)(e,(e=>!function(e,t){let i=!0;return(0,B.forOwn)(t,((t,n)=>{const a=(0,B.get)(e,n)||[];return null==t?i=0===a.length:a.length>0&&(i=a.includes(t)),i})),i}(e,t)||(s[n]=e.value,!1))),!s[n]&&i&&(s[n]=!1)})),s&&!(0,B.isEmpty)(s)&&(n[a]=s)})),n}class Pg extends Ag{constructor(e,t,i,n,a){super(),this.providerName=e,this.configs=t,this.platformService=i,this.logger=a.newLogger("CoreSettings/ConfigProviderDynamic","core-services-settings"),this.applyFiltersAndNotify(),n&&this.setClientPreferences(n)}cleanup(){var e;null===(e=this.clientPreferencesSubscription)||void 0===e||e.unsubscribe()}getSettings(){return this.settings||{}}setLocale(e){this.locale=e,this.applyFiltersAndNotify()}setClientPreferences(e){var t,i;(null===(i=null===(t=this.settings)||void 0===t?void 0:t.core)||void 0===i?void 0:i.enableLowPerformanceModeCoreSettingsFilter)&&(this.clientPreferencesSubscription&&this.clientPreferencesSubscription.unsubscribe(),this.clientPreferencesSubscription=e.getPreferenceObservable("performance").subscribe((({mode:e})=>{this.currentPerformanceMode=e,this.applyFiltersAndNotify()})))}applyFiltersAndNotify(){const e=this.getFilters(),t=Mg(this.configs,e);this.logger.log("Filters:",e),this.logger.log("Filtered settings:",t),this.settings?(0,B.isEqual)(this.settings,t)||(this.settings=t,this.notifySettingsChanged()):this.settings=t}getFilters(){const{ecsOverrides:{environment:e},config:{platformId:t,vdi:i,osPlatform:n,buildType:a}}=this.platformService;return{environment:e,platform:t,buildType:a,virtualization:null==i?void 0:i.configFilter,os:n,performanceMode:this.currentPerformanceMode,locale:this.locale}}}const Og=e=>e!==$e.pk.VeryActive;function Rg(e,t,i,n){let a;const s=()=>{null==a||a.unsubscribe(),a=void 0,null==r||r.cancel()},o=i=>{e(i),s(),t.debug("Notified about settings change")},r=(0,B.throttle)(((e,i)=>{Og(e)?o(i):t.log("Throttle executed with VeryActive state, waiting for next state change")}),n||0,{leading:!1,trailing:!0}),c=e=>!i||Og(i.getState())?(o(e),!0):(a||(a=i.observe().subscribe((i=>{Og(i)&&!n?o(e):n&&(t.log("Throttled function called"),r(i,e))}))),t.log(`Postponed settings change notification due to client state being ${$e.pk[i.getState()]}`),!1);return c.cancel=s,c}class Lg extends Ag{constructor(e,t,i,n,a){var s;super(),this.settings={},this.providerName="HostProvider",this.logger=t.newLogger("CoreSettings/HostProvider","core-services-settings"),i?(this.logger.log("Host settings found."),this.updateSettingsAndCheckForChanges(i)):this.logger.log("No host settings found."),this.notifySettingsChangedDeferred=Rg((()=>this.notifySettingsChanged()),this.logger,n,a),null===(s=e.opener)||void 0===s||s.addEventListener(L.rY.UpdateWindowState,(e=>{var t,i;if(null==e?void 0:e.payload){let n=e.payload;(null===(i=null===(t=e.payload)||void 0===t?void 0:t.hostSettings)||void 0===i?void 0:i.hostSettings)&&(n=e.payload.hostSettings),this.logger.log("Host settings update received, payload:",n),this.updateSettingsAndCheckForChanges(n)&&this.notifySettingsChangedDeferred()}}))}getSettings(){return this.settings}cleanup(){super.cleanup(),this.notifySettingsChangedDeferred.cancel()}updateSettingsAndCheckForChanges(e){const t=Object.assign({},this.settings.host),i=Object.assign({},this.settings.metadata);e.hostSettings&&Object.assign(t,e.hostSettings),e.desktopSettings&&Object.assign(t,e.desktopSettings),this.updateSettings(t,i,e);const n={[S.J.Host]:t,[S.J.Metadata]:i};return(0,B.isEqual)(this.settings,n)?(this.logger.log("Host settings did not change."),!1):(this.settings=n,this.logger.log("Host settings updated to:",this.settings),!0)}updateSettings(e,t,i){var n;if(i.bootstrapData&&(e.authBootstrapData=i.bootstrapData),(null===(n=i.hostSettings)||void 0===n?void 0:n.hostETag)&&(t.hostETag=i.hostSettings.hostETag),i.dataLayerSettings){const t=i.dataLayerSettings,n=t.query||[],a=t.mutation||[],s=t.subscription||[];e.dataLayerSettings={query:n,mutation:a,subscription:s}}}}const Ug=e=>"localMigratedSettings"===e.name,$g=(e,t)=>{var i,n;if(null==e)return{};if("string"!=typeof e)return null===(i=t.errorNoPii)||void 0===i||i.call(t,`Failed to parse localMigratedSettings. Type is not string, got ${typeof e}.`),{};let a;try{a=JSON.parse(e)}catch(e){return null===(n=t.errorNoPii)||void 0===n||n.call(t,"Failed to parse localMigratedSettings. Value is not valid JSON."),{}}const s={chatDensity:qg(a),language:Wg(a,"language"),messagePreviewShown:Gg(a),performanceMode:Vg(a),callingSelectedDevices:Kg(a,"calling_selected_devices"),callingSelectedCameraDevice:Kg(a,"calling_selected_camera_device"),callingSelectedSpeakerDevice:Kg(a,"calling_selected_speaker_device"),callingSelectedMicrophoneDevice:Kg(a,"calling_selected_microphone_device"),callingSelectedSecondaryRingerDevice:Kg(a,"calling_selected_secondary_ringer_device"),agcEnabled:Bg(a,"agcEnabled"),autoAdjustEnabled:Bg(a,"call.setAutoAdjust"),hfmmEnabled:Bg(a,"hfmmEnabled"),ignoreMirrorMyVideoSettingsSelected:Bg(a,"ignoreMirrorMyVideoSettingsSelected"),noiseSuppressionMode:Jg(a),touchUpEnabled:Bg(a,"call.setTouchUp"),touchUpStrength:zg(a,"call.setTouchUpStrength"),spatialAudioEnabled:Bg(a,"spatialAudioEnabled"),ttyEnabled:Bg(a,"ttyEnabled"),cachedImage:Qg(a,"cachedImage"),reservedMetadata:Yg(a)};return(0,B.omitBy)(s,B.isUndefined)},Wg=(e,t)=>{const i=e[t];return"string"==typeof i?i:void 0},Bg=(e,t)=>{const i=e[t];return"boolean"==typeof i?i:"string"==typeof i?"true"===i:void 0},zg=(e,t)=>{const i=e[t];return"number"==typeof i&&Number.isFinite(i)?i:void 0},Hg=(e,t)=>{const i=e[t];try{return"string"==typeof i?new Date(i).toISOString():void 0}catch(e){return}},qg=e=>{switch(e.chatDensity){case"comfy":return N.LN.Comfy;case"compact":return N.LN.Compact;default:return}},Vg=e=>{switch(e.performanceMode){case"Normal":return N.Cz.Normal;case"Low":return N.Cz.Low;default:return}},Gg=e=>{switch(e.messagePreviewsShown){case"default":return N.xu.Default;case"show-previews":return N.xu.ShowPreviews;case"hide-previews":return N.xu.HidePreviews;default:return}},Jg=e=>{switch(e.noiseSuppressionMode){case"Off":return N.uD.Off;case"Auto":return N.uD.Auto;case"Low":return N.uD.Low;case"High":return N.uD.High;case"Pns":return N.uD.Pns;case"HeadsetNS":return N.uD.HeadsetNS;default:return}},Kg=(e,t)=>{const i=(0,B.pickBy)(e[t],((e,t)=>["microphone","speaker","camera","audioIngestDevice"].includes(t)&&"string"==typeof e));return Object.keys(i).length>0?i:void 0},Qg=(e,t)=>{const i=(0,B.pickBy)(e[t],((e,t)=>["imageId","path","imageSrc"].includes(t)&&"string"==typeof e));return Object.keys(i).length>0?i:void 0},Yg=e=>{if(!e.reservedMetadata)return;const t=e.reservedMetadata,i=(0,B.omitBy)({version:zg(t,"version"),correlationId:Wg(t,"correlationId"),created:Hg(t,"created"),reason:Xg(t)},B.isUndefined);return Object.keys(i).length>0?i:void 0},Xg=e=>{switch(Wg(e,"reason")){case"pear-app-install":return N.hk.PearAppInstall;case"direct-install":return N.hk.DirectInstall;default:return}};class Zg extends Ag{constructor(e,t){super(),this.host=e,this.settings={},this.providerName="LocalMigratedSettingsProvider",this.logger=t.newLogger("CoreSettings/LocalMigratedSettingsProvider","core-services-settings"),this.loadLocalMigratedSettings()}loadLocalMigratedSettings(){const e=this.host.localStorage.getItem("tmp.localMigratedSettings"),t=$g(e,this.logger);this.settings={[S.J.LocalMigrated]:Object.assign({},t)},this.notifySettingsChanged()}getSettings(){return this.settings}}class eh extends Ag{constructor(e){super(),this.settings={},this.providerName="MaglevHostProvider",this.logger=e.newLogger("CoreSettings/MaglevHostProvider","core-services-settings")}initialize(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{windowsInsiderChannel:t,windowsInsiderRing:i,installedThroughAppSwitcher:n}=yield this.getHostSettings(e),{hostCapabilitiesSettings:a,localMigratedSettings:s}=yield this.fetchHostInitialCapabilities(e);this.settings={[S.J.Host]:{windowsInsiderChannel:t,windowsInsiderRing:i,installedThroughAppSwitcher:n},[S.J.HostCapabilities]:Object.assign({},a),[S.J.LocalMigrated]:Object.assign({},s)},this.notifySettingsChanged()}))}onPreWarm(e){var t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield e.loadModule("m365link"),a=yield null===(t=null==n?void 0:n.isBrowserPreferenceEnabled)||void 0===t?void 0:t.call(n),s=yield this.getHostCapabilities(e),o=yield this.getMemoryInfo(e);this.mergeSettings({[S.J.Host]:{enableM365LinksSettings:a},[S.J.HostCapabilities]:Object.assign({},s),[S.J.Calling]:{totalMemoryInBytes:o}}),null===(i=null==n?void 0:n.registerForIsBrowserPreferenceEnabled)||void 0===i||i.call(n,(e=>{this.mergeSettings({[S.J.Host]:{enableM365LinksSettings:e}})}))}catch(e){this.logger.warn("Unable to get host settings post alt:",e)}}))}getSettings(){return this.settings}mergeSettings(e){this.settings={[S.J.Host]:Object.assign(Object.assign({},this.settings.host),e.host),[S.J.HostCapabilities]:Object.assign(Object.assign({},this.settings.hostCapabilities),e.hostCapabilities),[S.J.Calling]:Object.assign(Object.assign({},this.settings.calling),e.calling)},this.notifySettingsChanged()}getHostSettings(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let t;try{if(t=yield e.loadModule("ecs"),null==t?void 0:t.getHostSettings)return yield null==t?void 0:t.getHostSettings()}catch(e){this.logger.warn("Unable to get host settings:",e)}return{}}))}fetchHostInitialCapabilities(e){var t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=[];try{const i=yield e.loadModule("hostcapabilities"),a=yield null===(t=null==i?void 0:i.getInitialCapabilities)||void 0===t?void 0:t.call(i);a&&n.push(...a)}catch(e){this.logger.warn("Unable to get host capabilities settings:",e)}const a=n.filter((e=>!Ug(e))).reduce(((e,t)=>(Object.assign(e,{[t.name]:t.value}),e)),{}),s=null===(i=n.find((e=>Ug(e))))||void 0===i?void 0:i.value;return{hostCapabilitiesSettings:a,localMigratedSettings:$g(s,this.logger)}}))}getHostCapabilities(e){var t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield e.loadModule("hostcapabilities"),a=["crossCloudMeetingEnabled","hardwareAccelerationAvailable","installedThroughAppSwitcher","storagePartition","phoneLinkingBlocked","windowsInsiderChannel","windowsInsiderRing","t1AppSwitcherEffectivePolicy","t1AppSwitcherCohort"];return(null!==(i=yield null===(t=null==n?void 0:n.getCapabilities)||void 0===t?void 0:t.call(n,a))&&void 0!==i?i:[]).reduce(((e,t)=>(Object.assign(e,{[t.name]:t.value}),e)),{})}catch(e){this.logger.warn("Unable to get host capabilities settings:",e)}return{}}))}getMemoryInfo(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield e.loadModule("osutils"),n=yield null===(t=null==i?void 0:i.getSystemMemoryInfo)||void 0===t?void 0:t.call(i),a=Number(null==n?void 0:n.totalPhysicalMemoryBytes);return isNaN(a)?void 0:a}catch(e){this.logger.warn("Unable to get memory info:",e)}}))}}class th extends Ag{constructor(e,t,i){super(),this.loggerFactory=e,this.configLoader=t,this.resolutionStrategy=i,this.settings={},this.providerName="ClientFiltersProvider",this.logger=this.loggerFactory.newLogger("CoreSettings/ClientFiltersProvider","core-services-settings")}initialize(e){this.settings=this.filterSettings(e),this.notifySettingsChanged()}getSettings(){return this.settings}filterSettings(e){const t=Mg(this.configLoader(this.getConfigFileName()),e,this.resolutionStrategy===Ig.Merge);return this.logger.debug(`Calculated client ${this.resolutionStrategy} filters for ${(0,U.u4)(e)}:`,t),t}getConfigFileName(){switch(this.resolutionStrategy){case Ig.Merge:return"clientFiltersMerge";case Ig.Override:default:return"clientFiltersOverride"}}}var ih;!function(e){e[e.Valid=0]="Valid",e[e.Expired=1]="Expired",e[e.NoData=2]="NoData",e[e.NoCache=3]="NoCache"}(ih||(ih={}));const nh="tmp";var ah;function sh(e){return[nh,e.experienceName,e.userId,e.tenantId,e.environment,e.ring,e.virtualization,e.type].filter((e=>!(0,B.isNil)(e))).join(".")}!function(e){e.TestOverrides="settings",e.EcsCache="ecs-settings-cache",e.PolicyCache="policy-cache"}(ah||(ah={}));const oh="CachedProvider";class rh extends Ag{constructor(e,t,i){super(),this.storage=e,this.options=i,this.providerName=oh,this.logger=t.newLogger("CoreSettings/CachedProvider","core-services-settings")}initialize(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.settings=yield this.loadCache()}))}setProvider(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.cleanup(),this.provider=e,this.providerName=`${oh}:${this.provider.providerName}`,this.subscription=this.provider.subscribe((e=>this.updateCache(e))),yield this.updateCache()}))}getProvider(){return this.provider}getSettings(){return this.settings}getDiagnosticsInfo(){return this.provider?this.provider.getDiagnosticsInfo():super.getDiagnosticsInfo()}get cacheState(){return this.getCacheState()}cleanup(e=!1){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0),this.providerName=oh,null===(t=this.provider)||void 0===t||t.cleanup(),e&&this.storage.removeItem(this.getStorageKey())}))}getCacheState(){return this.settings?ih.Valid:ih.NoData}getStorageKey(){if(!this._storageKey){if(!this.options)throw new Error("No storage options are passed to the CachedProvider.");this._storageKey=sh(this.options)}return this._storageKey}updateCache(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.provider)return;const i=null!==(t=null==e?void 0:e.settings)&&void 0!==t?t:this.provider.getSettings(),n=this.getStorageKey();i&&0!==Object.keys(i).length?(this.settings=i,yield this.storage.setItem(n,JSON.stringify(this.settings)),this.logger.log(`Cache '${n}' updated.`),this.notifySettingsChanged()):this.logger.log(`Got empty settings from provider. Cache State: ${ih[this.cacheState]} (Storage key: ${n})`)}))}loadCache(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let e;const t=this.getStorageKey();try{const i=yield this.storage.getItem(t);i?(e=JSON.parse(i),this.logger.log(`Cache successfully loaded: ${t}`)):this.logger.log(`No cached data found: ${t}`)}catch(e){this.logger.log(`Error while loading from cache '${t}', error:`,e)}return e}))}}class ch extends rh{constructor(e,t,i){super(e,t,i)}getExpiration(){var e,t;const i=null===(t=null===(e=this.settings)||void 0===e?void 0:e.metadata)||void 0===t?void 0:t.expires;return i&&!isNaN(Date.parse(i))?new Date(i):void 0}getCacheState(){if(!this.settings)return ih.NoData;const e=this.getExpiration();return e&&e.valueOf()>Date.now()?ih.Valid:ih.Expired}}var lh=i(867328),dh=i(806982),uh=i(704680),mh=i(656618);const gh="CoreSettings/EcsClientProvider";class hh extends Ag{constructor(e,t,i){super(),this.loggerFactory=i,this.providerName="EcsClientProvider",this.clientStarted=!1,this.onEcsClientConfigurationFetch=e=>{if(!this.fetchProps)throw new Error("Must call initializeClient() before fetching");const{incompleteBootAttemptsCounter:t,notifySettingsChangedDeferred:i,scenarioFactory:n}=this.fetchProps;this.handleEcsConfigurationData(e,this.createScenario(!1,n),t,i)},this.logger=this.loggerFactory.newLogger(gh,"core-services-settings"),this.cacheOptions={storage:e,partitionBy:lh.F4.ConsumerKey,consumerKey:sh(t)}}initializeLocal(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.ecsClient=yield(0,dh.un)({serviceName:gh,cacheOptions:this.cacheOptions,loggerFactory:this.loggerFactory})}))}initializeClient(e,t,i,a,s,o,r,c){var l;return(0,n.__awaiter)(this,void 0,void 0,(function*(){switch(this.fetchProps={ecsParameters:e,host:i,scenarioFactory:r,incompleteBootAttemptsCounter:c,notifySettingsChangedDeferred:Rg((e=>this.notifySettingsChanged(e)),this.logger,a,t.get(S.J.Core).ecsNotifySettingsChangedDelayInMs)},null===(l=this.ecsClient)||void 0===l?void 0:l.clientType){case"EcsClient":return!1;case"LocalEcsClient":return this.ecsClient=this.ecsClient.createClient({ecsParameters:e,endpointsManager:o,loggerFactory:this.loggerFactory,fetchPrecheck:this.fetchPrecheck(a,s).bind(this),transformData:this.transformDataToSettings.bind(this)}),!0;default:return this.ecsClient=yield(0,dh.fh)({serviceName:gh,cacheOptions:this.cacheOptions,loggerFactory:this.loggerFactory,ecsParameters:e,endpointsManager:o,fetchPrecheck:this.fetchPrecheck(a,s).bind(this),transformData:this.transformDataToSettings.bind(this)}),!0}}))}startClient(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if("EcsClient"!==(null===(t=this.ecsClient)||void 0===t?void 0:t.clientType)||!this.fetchProps)throw new Error("Must call initializeClient() before startClient()");let i=!0;const n=this.fetch(!0);return e&&(i=yield n),this.ecsClient.startFetchSchedule(this.fetchProps.host,this.onEcsClientConfigurationFetch),this.clientStarted=!0,i}))}getClientType(){var e;return null===(e=this.ecsClient)||void 0===e?void 0:e.clientType}getCacheState(){return this.ecsClient?this.ecsClient.cacheState:ih.NoCache}getSettings(){var e,t;return null===(t=null===(e=this.ecsClient)||void 0===e?void 0:e.get())||void 0===t?void 0:t.ecsConfiguration}updateParametersAndFetch(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if("EcsClient"!==(null===(t=this.ecsClient)||void 0===t?void 0:t.clientType)||!this.fetchProps)throw new Error("Must call initializeClient() before updateEcsParameters()");this.fetchProps.ecsParameters=Object.assign({},e);this.ecsClient.updateParameters(this.fetchProps.ecsParameters)?(this.logger.log("Refresh required, manually fetching settings ..."),yield this.fetch(!1)):this.logger.log("No refresh required, ECS parameters haven't changed.")}))}cleanup(){var e,t;super.cleanup(),null===(e=this.fetchProps)||void 0===e||e.notifySettingsChangedDeferred.cancel(),"EcsClient"===(null===(t=this.ecsClient)||void 0===t?void 0:t.clientType)&&this.ecsClient.dispose()}fetch(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if("EcsClient"!==(null===(t=this.ecsClient)||void 0===t?void 0:t.clientType)||!this.fetchProps)throw new Error("Must call initializeClient() before fetching");const{incompleteBootAttemptsCounter:i,notifySettingsChangedDeferred:n,scenarioFactory:a}=this.fetchProps,s=this.createScenario(e,a);try{this.logger.debug("Awaiting manual ECS fetch...");const e=yield this.ecsClient.fetch();return this.logger.debug("Manual ECS fetch complete."),this.handleEcsConfigurationData(e,s,i,n)}catch(e){return s.fail({errors:e.message}),this.logger.warn("Manual ECS fetch failed.",e),!1}}))}handleEcsConfigurationData(e,t,i,n){i.markBootAttemptComplete();let a=!1,s=!1;switch(e.requestStatus){case uh.m.Success:if(!e.ecsConfiguration){t.fail({errors:"Empty ECS configuration"});break}s=n({settings:e.ecsConfiguration}),this.logger.log("Settings updated to:",e.ecsConfiguration),t.stop({size:JSON.stringify(e.ecsConfiguration).length,message:JSON.stringify({settingsUpdated:!0,notified:s})}),a=!0;break;case uh.m.Success_NoChanges:s=n({settings:e.ecsConfiguration}),this.logger.debug("Settings are the same."),t.stop({message:JSON.stringify({settingsUpdated:!1,headersUpdated:!0,notified:s})}),a=!0;break;case uh.m.Abandoned_ClientVeryActive:this.logger.debug("Skipping override settings check due to app being in a very active state."),t.stop({message:"very active"},"abandoned");break;case uh.m.Abandoned_NoNetwork:this.logger.debug("Skipping override settings check due to app being offline."),t.stop({message:"no network"},"abandoned");break;case uh.m.Error_BrowserError:t.stop({errors:`${e.errorMessage} - BrowserError`},"abandoned");break;case uh.m.Error_TimedOut:t.stop({errors:e.errorMessage},"timeout");break;case uh.m.Error_TransformFailed:case uh.m.Error_Unknown:t.fail({errors:e.errorMessage});break;case uh.m.NotStarted:t.fail({errors:"ECS client is in a corrupt state - received a 'NotStarted' request status"});break;default:t.fail({errors:`Received unknown request status value of ${e.requestStatus}`})}return a}fetchPrecheck(e,t){return()=>t&&!1===t.isOnline()?{errorMessage:"Skipping ECS configuration fetch due to app being offline",requestStatus:uh.m.Abandoned_NoNetwork}:!e||e.getState()!==$e.pk.VeryActive||{errorMessage:"Skipping ECS configuration fetch due to app being very active",requestStatus:uh.m.Abandoned_ClientVeryActive}}createScenario(e,t){var i,n;const a=t.newScenario(z.RG.EcsProviderFetch);return a.appendEventData({endpointUrl:null===(i=this.ecsClient)||void 0===i?void 0:i.getDiagnosticInfo().fetchUrl,operation:e?"initial":"refresh",correlationId:a.id,timeSinceCacheExpired:(0,mh.mN)(null===(n=this.ecsClient)||void 0===n?void 0:n.expiration)}),a}transformDataToSettings(e){const{ecsConfiguration:t,headers:i}=e;if(!this.fetchProps)throw new Error("Must call initializeClient() before transforming data");if(!t||!i)throw new Error("Data is missing ecsConfiguration or headers");if((0,B.isNil)(this.fetchProps.ecsParameters.agents))return Object.assign(Object.assign({},e),{ecsConfiguration:{}});let n={};const a=[],s=[],{agents:o=[],criticalAgents:r=[]}=this.fetchProps.ecsParameters;return o.forEach((e=>{var i;if(null==r?void 0:r.includes(e)){const i=t[e];if((0,B.isNil)(i))throw new Error(`ECS configuration is missing configurations for critical namespace '${e}'`);n=Object.assign(Object.assign({},n),i)}const o=null===(i=null==t?void 0:t.ConfigIDs)||void 0===i?void 0:i[e];if(o){const e=o.split(",");a.push(...e.filter((e=>e.startsWith("P-E")))),s.push(...e.filter((e=>e.startsWith("P-R"))))}})),n=Object.assign(Object.assign({},n),{metadata:Object.assign(Object.assign({},n.metadata),{eTag:i.ETag,expires:i.Expires.toString(),configIds:{experiments:a,rollouts:s}})}),Object.assign(Object.assign({},e),{ecsConfiguration:n})}}class ph extends Ag{constructor(e,t){super(),this.workerHostSettings=t,this.providerName="WorkerHostProvider",this.logger=e.newLogger("CoreSettings/WorkerHostSettingsProvider","core-services-settings"),this.settings={},this.testSettings={},this.logger.log("Worker host settings is initialized",this.settings),t.subscribeToHostSettingsUpdates((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield t.getHostSettings();this.settings=e.settings,this.testSettings=e.testSettings,this.notifySettingsChanged()}))))}initialize(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield(0,H.E)(this.workerHostSettings.getHostSettings(),1e4).catch((e=>(this.logger.error(`retrieve worker host setting timed out, the error is ${e}`),{settings:{},testSettings:{}})));this.settings=e.settings,this.testSettings=e.testSettings,this.logger.log("Worker host setting is being initialized")}))}getSettings(){return Object.assign(Object.assign({},this.settings),{[S.J.Test]:this.testSettings})}}class vh extends Ag{constructor(e,t,i){super(),this.loggerFactory=e,this.configLoader=i,this.providerName="ViewportOverrideProvider",this.logger=this.loggerFactory.newLogger("CoreSettings/ViewportOverrideProvider","core-services-settings"),this.settings=this.filterSettings(t)}getSettings(){return this.settings}hasOverrides(){return!(0,B.isEmpty)(this.settings)}hasDifferences(e){const t=this.filterSettings(e);return!(0,B.isEqual)(this.settings,t)}filterSettings(e){const t=Mg(this.configLoader("viewportOverrides"),e);return this.logger.debug(`Calculated overrides for ${(0,U.u4)(e)}:`,t),t}}class fh extends Ag{constructor(e,t,i){super(),this.host=e,this.providerName="LocalStorageProvider",this.onStorageEvent=e=>{e.key===this.storageKey&&(this.logger.log("Local storage settings updated."),this.settings=this.loadStorageSettings(),this.notifySettingsChanged())},this.logger=t.newLogger("CoreSettings/LocalStorageProvider","core-services-settings"),this.storageKey=sh(i),this.settings=this.loadStorageSettings(),this.host.addEventListener("storage",this.onStorageEvent)}getSettings(){return this.settings}cleanup(){this.host.removeEventListener("storage",this.onStorageEvent)}setSettings(e){try{this.host.localStorage.setItem(this.storageKey,(0,U.u4)(e))}catch(e){this.logger.log("Could not write settings to local storage, error:",e)}this.settings=e,this.notifySettingsChanged()}clearSettings(){this.host.localStorage.removeItem("tmp.settings"),this.settings={}}loadStorageSettings(){const e=this.host.localStorage.getItem(this.storageKey);if(e)try{return JSON.parse(e)}catch(e){this.logger.log(`Could not parse settings stored in local storage, key: ${this.storageKey}, error: ${e}`)}return{}}}class bh extends Ag{constructor(e,t){super(),this.clientPreferencesService=e,this.providerName="ClientPreferencesProvider",this.logger=t.newLogger("CoreSettings/ClientPreferencesProvider","core-services-settings"),this.settings=this.loadClientPreferences(),this.setupSubscription()}getSettings(){return this.settings}cleanup(){var e;null===(e=this.clientPreferencesSubscription)||void 0===e||e.unsubscribe()}loadClientPreferences(){const e=this.clientPreferencesService.getPreferences("diagnosticsLogs");if(void 0!==(null==e?void 0:e.shouldPersistLogsIntoIDB))try{return{diagnostics:{clientExtendedDiagnosticsData:!!(null==e?void 0:e.shouldPersistLogsIntoIDB)}}}catch(t){this.logger.log(`Could not parse client preferences, ${e}, error: ${t}`)}return{}}setupSubscription(){const e=this.clientPreferencesService.getPreferenceObservable("diagnosticsLogs");this.clientPreferencesSubscription=e.subscribe((e=>this.clientPreferenceUpdateHandler(e)))}clientPreferenceUpdateHandler(e){var t,i;!!(null==e?void 0:e.shouldPersistLogsIntoIDB)!=!!(null===(i=null===(t=this.settings)||void 0===t?void 0:t.diagnostics)||void 0===i?void 0:i.clientExtendedDiagnosticsData)&&(this.settings={diagnostics:{clientExtendedDiagnosticsData:!!(null==e?void 0:e.shouldPersistLogsIntoIDB)}},this.notifySettingsChanged())}}class yh extends Ag{constructor(e){super(),this.providerName="ApiServiceProvider",this.logger=e.newLogger(this.providerName,"core-services-settings"),this.settings=this.loadApiSwitcherSettings()}getSettings(){return this.settings}setOverrides(e){this.settings=this.loadApiSwitcherSettings(e),this.notifySettingsChanged()}loadApiSwitcherSettings(e){if((null==e?void 0:e.configs)&&(null==e?void 0:e.id))try{const t=e.configs,i=e.id;return{apiService:{serviceConfig:t},auth:this.getAuthOverrides(e.configs),metadata:{serviceId:i}}}catch(e){this.logger.log(`Could not parse settings stored in local storage , error: ${e}`)}return{}}getAuthOverrides(e){return{authzEndpointUrl:null==e?void 0:e.authzEndpointUrl,authzUrl:null==e?void 0:e.authzEndpointUrl,authzResource:null==e?void 0:e.authzResource,regionGtmsEnv:null==e?void 0:e.regionGtmsEnv}}}class kh{constructor(e){this.logger=e.newLogger("CoreSettings/QspSettingsParser","core-services-settings")}parse(e,t={}){return new URLSearchParams(e).forEach(((e,i)=>{const n=this.parseQspSetting(i,e);n&&(this.logger.log("QSP override: ",n.key,n.value),(0,B.set)(t,n.key,n.value))})),t}parseQspSetting(e,t){const i=this.extractQspKeyObject(e);if("config"===i.config)return{key:`${i.category}.${i.featureName}`,value:this.tryGetParsedValueOrReturnOriginalValue(t)}}extractQspKeyObject(e){const t=e.split(".");let i="";for(let e=2;e<t.length;e++)i+=t[e],e<t.length-1&&(i+=".");return{config:t[0],category:t[1],featureName:i}}tryGetParsedValueOrReturnOriginalValue(e){const t=e.toLowerCase();return"true"===t||"false"===t?"true"===t:e.startsWith("[")&&e.endsWith("]")?this.getStringArrayValue(e.substring(1,e.length-1)):encodeURIComponent(e)}getStringArrayValue(e){if(0===e.length)return[];const t=e.split(","),i=[];for(const e of t)i.push(encodeURIComponent(e));return i}}class Sh extends Ag{constructor(e,t,i,n){super(),this.host=e,this.platformService=t,this.experienceName=n,this.providerName="QspProvider",this.settings={},(this.platformService.config.isInternalUser||"meeting-options"===this.experienceName)&&(this.parser=new kh(i))}getSettings(){return this.parseQsp(),this.settings}parseQsp(){if(!this.parser)return;const e={};this.host.location.search&&this.parser.parse(this.host.location.search,e);const t=this.getQueryStringFromHash();t&&this.parser.parse(t,e),this.platformService.config.isInternalUser?this.settings=e:"meeting-options"===this.experienceName&&this.populateAllowList(e)}getQueryStringFromHash(){const e=this.host.location.hash;if(!e)return null;const t=e.indexOf("?");return t>-1?e.substr(t):null}populateAllowList(e){const t={};e&&(e.meetingOptions&&(t.meetingOptions={},e.meetingOptions.isClientSideInviteeListSupported&&(t.meetingOptions.isClientSideInviteeListSupported=e.meetingOptions.isClientSideInviteeListSupported),e.meetingOptions.isClientSideSensitivityLabelSupported&&(t.meetingOptions.isClientSideSensitivityLabelSupported=e.meetingOptions.isClientSideSensitivityLabelSupported)),e.host&&(t.host={},e.host.skin&&(t.host.skin=e.host.skin),e.host.headless&&(t.host.headless=e.host.headless),e.host.theme&&(t.host.theme=e.host.theme))),this.settings=t}}var wh,jh=i(563125);!function(e){e.None="0",e.CitrixXenDesktop="1",e.CitrixXenApp="2",e.VMWare="3",e.WVD="5"}(wh||(wh={}));class Ch extends Ag{constructor(e){var t;super(),this.platformService=e,this.providerName="PlatformProvider",this.platformSettings={[S.J.Platform]:{browser:this.getBrowser(),browserVersion:null===(t=this.platformService.config.browserVersion)||void 0===t?void 0:t.toString(),buildType:this.platformService.config.buildType,buildVersion:this.platformService.config.buildVersion,clientVersion:this.platformService.config.clientVersion,deviceInfo:this.platformService.host.deviceInfo,enableSlotBorderRadius:this.getEnableSlotBorderRadius(),isHtmlInputSelectApiSupported:this.getIsHtmlInputSelectApiSupported(),isScreenRecordingPermissionRequired:this.getIsScreenRecordingPermissionRequired(),sessionId:this.platformService.host.sessionId,staticsPath:this.platformService.config.staticsPath,thirdPartyCookieSupport:Ps.Yv.Unknown,useMacKeyboardLayout:this.getUseMacKeyboardLayout(),vdi:this.getVdiSettings()},[S.J.Metadata]:{environment:this.platformService.ecsOverrides.environment,ring:{id:this.platformService.ecsOverrides.ring}},[S.J.Host]:{desktopVersion:this.platformService.host.hostAppVersion}}}getSettings(){return this.platformSettings}updateSettings(e){let t=Object.assign({},this.platformSettings.metadata);e.region&&(t=Object.assign(Object.assign({},t),{region:e.region}));let i=Object.assign({},this.platformSettings.platform);e.bootType&&(i=Object.assign(Object.assign({},i),{bootType:e.bootType})),e.localeCode&&(i=Object.assign(Object.assign({},i),{localeCode:e.localeCode})),e.thirdPartyCookieSupport&&(i=Object.assign(Object.assign({},i),{thirdPartyCookieSupport:e.thirdPartyCookieSupport})),this.platformSettings=Object.assign(Object.assign({},this.platformSettings),{[S.J.Platform]:i,[S.J.Metadata]:t}),this.notifySettingsChanged()}getBrowser(){const{browser:e}=this.platformService.config;switch(e){case Ps.AR.Chrome:return N.Aq.Chrome;case Ps.AR.Edge:return N.Aq.Edge;case Ps.AR.Safari:return N.Aq.Safari;case Ps.AR.Firefox:return N.Aq.Firefox;case Ps.AR.Electron:return N.Aq.Electron;default:return N.Aq.Unknown}}getVdiSettings(){const{vdi:e}=this.platformService.config;if(e){const{provider:t,mode:i,isAvRemoted:n,configFilter:a,vdiOptimizationMode:s}=e,o=e=>{switch(e){case wh.CitrixXenDesktop:return N.$w.CitrixXenDesktop;case wh.CitrixXenApp:return N.$w.CitrixXenApp;case wh.VMWare:return N.$w.VMWare;case wh.WVD:return N.$w.WVD;default:return N.$w.None}};return{provider:o(t),mode:i,isAvRemoted:n,configFilter:a,vdiOptimizationMode:s}}}getIsHtmlInputSelectApiSupported(){return this.platformService.config.osPlatform!==Ps.NR.IOS}getUseMacKeyboardLayout(){return this.platformService.config.osPlatform===Ps.NR.Mac}getIsScreenRecordingPermissionRequired(){if(this.platformService.config.platformId===Ps.us.MaglevMacT21)return!0;if(this.platformService.config.clientType===Ps.Bh.Web||this.platformService.config.osPlatform!==Ps.NR.Mac||!this.platformService.config.osVersion)return!1;const e=this.platformService.config.osVersion.toString();return(0,jh.compare)(e,"10.15",">=")}getEnableSlotBorderRadius(){return this.platformService.config.osPlatform===Ps.NR.Mac}}class _h extends Ag{constructor(e,t){super(),this.workerHostSettings=t,this.providerName="WorkerHostTestOverridesProvider",this.logger=e.newLogger("CoreSettings/WorkerHostTestOverridesProvider","core-services-settings"),this.settings={},t.subscribeToHostSettingsUpdates((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield t.getHostSettings();this.settings=(0,B.merge)({},e.localStorageTestOverrides,e.qspTestOverrides),this.notifySettingsChanged()}))))}initialize(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield(0,H.E)(this.workerHostSettings.getHostSettings(),1e4).catch((e=>(this.logger.error(`Retrieving worker host setting timed out, the error is ${e}`),{localStorageTestOverrides:{},qspTestOverrides:{}})));this.settings=(0,B.merge)({},e.localStorageTestOverrides,e.qspTestOverrides),this.logger.log("Worker host test overrides setting is being initialized")}))}getSettings(){return this.settings}}class Th{constructor(e,t,i,n,a,s,o,r,c){this.id=e,this.experienceName=t,this.cache=i,this.loggerFactory=n,this.platformService=a,this.clientPreferences=s,this.configLoader=o,this.partitionCacheByExperience=r,this.localStorage=c,this.logger=this.loggerFactory.newLogger(`CoreSettings/Context(${e})`,"core-services-settings"),this.cleanupFunctions=[],this.settingsService=new xg(this.id,this.loggerFactory),this.cleanupFunctions.push((()=>{this.settingsService.cleanup()})),this.logsProvider=new Dg(this.loggerFactory,this),this.logger.log("Created.")}cleanup(e){this.cache.release(this.id,(()=>{this.logger.log("Cleaning up."),this.cleanupFunctions.forEach((t=>t(e)))}))}getCoreSettings(){return this.settingsService}getLogsProvider(){return this.logsProvider}getDebugService(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.debugSettingsService){const{DebugSettingsService:e}=yield i.e(226842).then(i.bind(i,737493));this.debugSettingsService=new e(this,this.loggerFactory,this.id)}return this.debugSettingsService}))}updatePlatformProviderSettings(e){this.platformProvider&&this.platformProvider.updateSettings(e)}setScenarioFactory(e){this.scenarioFactory=e,this.settingsService&&this.settingsService.setScenarioFactory(e)}setLocale(e){this.enableLocaleFilterForFeatureFlags&&(this.locale=e,this.configProvider&&this.configProvider.setLocale(e))}registerAllProviders(){this.registerProvider(Ng.Configuration,this.configProvider),this.registerProvider(Ng.Configuration,this.platformProvider),this.registerProvider(Ng.Configuration,this.hostProvider),this.registerProvider(Ng.Configuration,this.localMigratedSettingsProvider),this.registerProvider(Ng.Configuration,this.maglevHostProvider),this.registerProvider(Ng.Configuration,this.workerHostProvider),this.registerProvider(Ng.Configuration,this.clientPreferencesProvider),this.registerProvider(Ng.Configuration,this.ecsCachedProvider),this.registerProvider(Ng.Override,this.clientFiltersOverrideProvider),this.registerProvider(Ng.Override,this.viewportOverrideProvider),this.registerProvider(Ng.ClientFilters,this.clientFiltersMergeProvider),this.registerProvider(Ng.Policy,this.policyCachedProvider),this.registerProvider(Ng.TestOverride,this.apiServiceProvider),this.registerProvider(Ng.TestOverride,this.localStorageProvider),this.registerProvider(Ng.TestOverride,this.qspProvider),this.registerProvider(Ng.TestOverride,this.workerTestProvider),this.registerProvider(Ng.TestOverride,this.workerHostTestOverridesProvider),this.settingsService.readEnableFilteredSettingsSubject()}registerProvider(e,t){t&&(this.settingsService.registerProvider(t,e),this.getLogsProvider().registerProvider(t,e))}createConfigProviderForMainThread(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.configProvider=yield function(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield e.configLoader(function(e){const{ecsOverrides:{environment:t}}=e;return`${t}`}(e.platformService));return new Pg("ConfigProviderAsync",t,e.platformService,e.clientPreferences,e.loggerFactory)}))}({clientPreferences:this.clientPreferences,configLoader:this.configLoader,loggerFactory:this.loggerFactory,platformService:this.platformService}),this.locale&&this.configProvider.setLocale(this.locale),this.cleanupFunctions.push((()=>{var e;null===(e=this.configProvider)||void 0===e||e.cleanup()}))}))}createConfigProviderForCDLWorker(){this.configProvider=function(e){const t=e.configLoader("config");return new Pg("ConfigProviderSync",t,e.platformService,e.clientPreferences,e.loggerFactory)}({clientPreferences:this.clientPreferences,configLoader:this.configLoader,loggerFactory:this.loggerFactory,platformService:this.platformService}),this.locale&&this.configProvider.setLocale(this.locale),this.cleanupFunctions.push((()=>{var e;null===(e=this.configProvider)||void 0===e||e.cleanup()}))}createHostProvider(e,t){this.hostProvider=new Lg(e,this.loggerFactory,t),this.cleanupFunctions.push((()=>{var e;null===(e=this.hostProvider)||void 0===e||e.cleanup()}))}createLocalMigratedSettingsProvider(e){this.localMigratedSettingsProvider=new Zg(e,this.loggerFactory),this.cleanupFunctions.push((()=>{var e;null===(e=this.localMigratedSettingsProvider)||void 0===e||e.cleanup()}))}createMaglevHostProvider(){this.maglevHostProvider=new eh(this.loggerFactory),this.cleanupFunctions.push((()=>{var e;null===(e=this.maglevHostProvider)||void 0===e||e.cleanup()}))}createClientFiltersProviders(){this.clientFiltersMergeProvider=new th(this.loggerFactory,this.configLoader,Ig.Merge),this.clientFiltersOverrideProvider=new th(this.loggerFactory,this.configLoader,Ig.Override),this.cleanupFunctions.push((()=>{var e,t;null===(e=this.clientFiltersMergeProvider)||void 0===e||e.cleanup(),null===(t=this.clientFiltersOverrideProvider)||void 0===t||t.cleanup()}))}createEcsCachedProvider(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{ring:t,environment:i}=this.platformService.ecsOverrides,n="general"===t?void 0:t,a="prod"===i?void 0:i,s=this.partitionCacheByExperience?this.experienceName:void 0;this.ecsCachedProvider=new ch(e,this.loggerFactory,{type:ah.EcsCache,experienceName:s,ring:n,environment:a,virtualization:this.getVirtualization()}),yield this.ecsCachedProvider.initialize(),this.cleanupFunctions.push((()=>{var e;null===(e=this.ecsCachedProvider)||void 0===e||e.cleanup()}))}))}getVirtualization(){var e,t;return this.platformService.config.clientType===Ps.Bh.Maglev&&null!==(t=null===(e=this.platformService.config.vdi)||void 0===e?void 0:e.configFilter)&&void 0!==t?t:void 0}createEcsClientProvider(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{ring:t,environment:i}=this.platformService.ecsOverrides,n="general"===t?void 0:t,a="prod"===i?void 0:i,s=this.partitionCacheByExperience?this.experienceName:void 0,o={type:ah.EcsCache,experienceName:s,ring:n,environment:a,virtualization:this.getVirtualization()};this.ecsClientProvider=new hh(e,o,this.loggerFactory),yield this.ecsClientProvider.initializeLocal(),this.cleanupFunctions.push((()=>{var e;null===(e=this.ecsClientProvider)||void 0===e||e.cleanup()}))}))}createWorkerTestProvider(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.workerTestProvider=new rh(e,this.loggerFactory,{type:ah.TestOverrides}),yield this.workerTestProvider.initialize(),this.cleanupFunctions.push((()=>{var e;null===(e=this.workerTestProvider)||void 0===e||e.cleanup()}))}))}createWorkerHostTestOverridesProvider(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.workerHostTestOverridesProvider=new _h(this.loggerFactory,e),yield this.workerHostTestOverridesProvider.initialize(),this.cleanupFunctions.push((()=>{var e;null===(e=this.workerHostTestOverridesProvider)||void 0===e||e.cleanup()}))}))}createWorkerHostProvider(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.workerHostProvider=new ph(this.loggerFactory,e),yield this.workerHostProvider.initialize(),this.cleanupFunctions.push((()=>{var e;null===(e=this.workerHostProvider)||void 0===e||e.cleanup()}))}))}createViewportOverrideProvider(e){this.viewportOverrideProvider=new vh(this.loggerFactory,e,this.configLoader),this.cleanupFunctions.push((()=>{var e;null===(e=this.viewportOverrideProvider)||void 0===e||e.cleanup()}))}createPolicyCachedProvider(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.policyCachedProvider=new rh(e,this.loggerFactory,{type:ah.PolicyCache,userId:null==t?void 0:t.id}),yield this.policyCachedProvider.initialize(),this.cleanupFunctions.push((e=>{var t;const i="signout"===e;null===(t=this.policyCachedProvider)||void 0===t||t.cleanup(i)}))}))}createLocalStorageProvider(e){this.localStorageProvider=new fh(e,this.loggerFactory,{type:ah.TestOverrides}),this.cleanupFunctions.push((()=>{var e;null===(e=this.localStorageProvider)||void 0===e||e.cleanup()}))}createClientPreferencesProvider(e){this.clientPreferencesProvider=new bh(e,this.loggerFactory),this.cleanupFunctions.push((()=>{var e;null===(e=this.clientPreferencesProvider)||void 0===e||e.cleanup()}))}createApiServiceProvider(){this.apiServiceProvider=new yh(this.loggerFactory),this.cleanupFunctions.push((()=>{var e;null===(e=this.apiServiceProvider)||void 0===e||e.cleanup()}))}createQspProvider(e){this.qspProvider=new Sh(e,this.platformService,this.loggerFactory,this.experienceName),this.cleanupFunctions.push((()=>{var e;null===(e=this.qspProvider)||void 0===e||e.cleanup()}))}createPlatformProvider(e){this.platformProvider=new Ch(e),this.cleanupFunctions.push((()=>{var e;null===(e=this.platformProvider)||void 0===e||e.cleanup()}))}get enableLocaleFilterForFeatureFlags(){const e=this.getCoreSettings(),{enableLocaleFilterForFeatureFlags:t}=e.get(S.J.Core,["enableLocaleFilterForFeatureFlags"]);return!!t}}var Ih,Nh,Eh,Fh=i(143285);!function(e){e[e.AbortWhenVeryActive=0]="AbortWhenVeryActive",e[e.ContinueWhenVeryActive=1]="ContinueWhenVeryActive"}(Ih||(Ih={})),function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online"}(Nh||(Nh={})),function(e){e.Initializing="Initializing",e.Unrecoverable="Unrecoverable",e.LongInactive="LongInactive",e.Inactive="Inactive",e.Active="Active",e.VeryActive="VeryActive"}(Eh||(Eh={}));class xh{constructor(e,t,i,n,a,s,o,r=Ih.AbortWhenVeryActive){this.host=n,this.applicationStateProvider=s,this.networkStateProvider=o,this.clientVeryActiveMode=r,this.ecsClient=(0,dh.bn)({serviceName:t,ecsParameters:e,loggerFactory:a,endpointsManager:i,fetchPrecheck:this.fetchPreCheck.bind(this)})}updateParameters(e){return this.ecsClient.updateParameters(e)}getDiagnosticInfo(){var e,t;return Object.assign(Object.assign({},this.ecsClient.getDiagnosticInfo()),{clientVeryActiveMode:this.clientVeryActiveMode,configIds:null===(t=null===(e=this.ecsClient.get())||void 0===e?void 0:e.ecsConfiguration)||void 0===t?void 0:t.ConfigIDs})}getConfigurationAsync(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.ecsClient.fetch()}))}startWhenExpiredFetchSchedule(e){return this.ecsClient.startFetchSchedule(this.host,e)}stopFetchSchedule(){return this.ecsClient.dispose()}fetchPreCheck(){var e;return this.networkStateProvider&&this.networkStateProvider.getState()!==Nh.Online?{errorMessage:"Skipping ECS configuration fetch due to app being offline",requestStatus:uh.m.Abandoned_NoNetwork}:this.clientVeryActiveMode!==Ih.AbortWhenVeryActive||(null===(e=this.applicationStateProvider)||void 0===e?void 0:e.getState())!==Eh.VeryActive||{errorMessage:"Skipping ECS configuration fetch due to app being very active",requestStatus:uh.m.Abandoned_ClientVeryActive}}}class Dh extends Ag{constructor(e,t,i,n,a,s,o,r,c,l){super(),this.coreSettings=t,this.loggerFactory=i,this.scenarioFactory=n,this.host=a,this.clientStateProvider=s,this.networkStateProvider=o,this.endpointsManager=r,this.incompleteBootAttemptsCounter=c,this.getExtraScenarioEventData=l,this._isInitialized=!1,this.providerName="EcsProvider",this.onEcsClientConfigurationFetch=e=>{this.handleEcsConfigurationData(e,this.createScenario(!1))};const d=`CoreSettings/${this.providerName}`;this.logger=i.newLogger(d,"core-services-settings"),this.ecsClientFetchMode=Fh.z.Manual,this.ecsParameters=Object.assign({},e),this.ecsClient=new xh(this.ecsParameters,d,this.endpointsManager,this.host,this.loggerFactory,this.clientStateProvider,this.networkStateProvider,Ih.AbortWhenVeryActive),this.notifySettingsChangedDeferred=Rg((e=>this.notifySettingsChanged(e)),this.logger,s,this.coreSettings.get(S.J.Core).ecsNotifySettingsChangedDelayInMs)}initialize(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this.isInitialized)return!1;let i=!0;const n=this.performManualFetch(!0);e&&(i=yield n);const a=this.coreSettings.get(S.J.Core).ecsProviderFetchMode;if(this.ecsClientFetchMode=null!==(t=(0,mh.JX)(a))&&void 0!==t?t:Fh.z.WhenExpired,this.ecsClientFetchMode!==Fh.z.WhenExpired)throw new Error(`${Fh.z[this.ecsClientFetchMode]} fetch mode is not supported`);return this.ecsClient.startWhenExpiredFetchSchedule(this.onEcsClientConfigurationFetch),this._isInitialized=!0,i}))}get isInitialized(){return this._isInitialized}getSettings(){return this.settings}getParameters(){return this.ecsParameters}getDiagnosticsInfo(){return this.ecsClient.getDiagnosticInfo()}cleanup(){super.cleanup(),this.notifySettingsChangedDeferred.cancel(),this.ecsClient.stopFetchSchedule()}updateEcsParametersAndFetchSettings(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.ecsParameters=Object.assign({},e);this.ecsClient.updateParameters(e)?this.isInitialized?(this.logger.log("Refresh required, manually fetching settings ..."),yield this.performManualFetch(!1)):this.logger.log("Refresh required but provider not initialized, skipping settings fetch."):this.logger.log("No refresh required, ECS parameters haven't changed.")}))}performManualFetch(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=this.createScenario(e);try{this.logger.debug("Awaiting manual ECS fetch...");const e=yield this.ecsClient.getConfigurationAsync();return this.logger.debug("Manual ECS fetch complete."),this.handleEcsConfigurationData(e,t)}catch(e){return this.appendExtraScenarioEventData(t),t.fail({errors:e.message}),this.logger.warn("Manual ECS fetch failed.",e),!1}}))}notifyEcsFetchComplete(){this.incompleteBootAttemptsCounter.markBootAttemptComplete()}appendExtraScenarioEventData(e){var t;const i=null===(t=this.getExtraScenarioEventData)||void 0===t?void 0:t.call(this);i&&e.appendEventData(i)}handleEcsConfigurationData(e,t){var i;this.notifyEcsFetchComplete(),this.appendExtraScenarioEventData(t);let n=!1,a=!1;switch(e.requestStatus){case uh.m.Success:if(!e.ecsConfiguration||!e.headers){t.fail({errors:"Empty headers or ECS configuration"});break}try{this.settings=this.extractSettings(e.ecsConfiguration,e.headers)}catch(e){t.fail({errors:`Extracting settings failed - ${(null==e?void 0:e.message)||"unknown error"}`});break}a=this.notifySettingsChangedDeferred({settings:this.settings}),this.logger.log("Settings updated to:",this.settings),t.stop({size:JSON.stringify(e.ecsConfiguration).length,message:JSON.stringify({settingsUpdated:!0,notified:a})}),n=!0;break;case uh.m.Success_NoChanges:if(!e.headers){t.fail({errors:"Empty headers"});break}this.settings=Object.assign(Object.assign({},this.settings),{metadata:Object.assign(Object.assign({},null===(i=this.settings)||void 0===i?void 0:i.metadata),{expires:e.headers.Expires.toString()})}),a=this.notifySettingsChangedDeferred({settings:this.settings}),this.logger.debug("Settings are the same."),t.stop({message:JSON.stringify({settingsUpdated:!1,headersUpdated:!0,notified:a})}),n=!0;break;case uh.m.Abandoned_ClientVeryActive:this.logger.debug("Skipping override settings check due to app being in a very active state."),t.stop({message:"very active"},"abandoned");break;case uh.m.Abandoned_NoNetwork:this.logger.debug("Skipping override settings check due to app being offline."),t.stop({message:"no network"},"abandoned");break;case uh.m.Error_BrowserError:t.stop({errors:`${e.errorMessage} - BrowserError`},"abandoned");break;case uh.m.Error_TimedOut:t.stop({errors:e.errorMessage},"timeout");break;case uh.m.Error_TransformFailed:case uh.m.Error_Unknown:t.fail({errors:e.errorMessage});break;case uh.m.NotStarted:t.fail({errors:"ECS client is in a corrupt state - received a 'NotStarted' request status"});break;default:t.fail({errors:`Received unknown request status value of ${uh.m[e.requestStatus]}`})}return n}createScenario(e){const t=this.scenarioFactory.newScenario(z.RG.EcsProviderFetch);return t.appendEventData({endpointUrl:this.ecsClient.getDiagnosticInfo().fetchUrl,operation:e?"initial":"refresh",correlationId:t.id}),t}extractSettings(e,t){if((0,B.isNil)(this.ecsParameters.agents))return{};let i={};const n=[],a=[],{agents:s=[],criticalAgents:o=[]}=this.ecsParameters;return s.forEach((t=>{var s;if(null==o?void 0:o.includes(t)){const n=e[t];if((0,B.isNil)(n))throw new Error(`ECS payload is missing configurations for critical namespace '${t}'`);i=Object.assign(Object.assign({},i),n)}const r=null===(s=null==e?void 0:e.ConfigIDs)||void 0===s?void 0:s[t];if(r){const e=r.split(",");n.push(...e.filter((e=>e.startsWith("P-E")))),a.push(...e.filter((e=>e.startsWith("P-R"))))}})),i=Object.assign(Object.assign({},i),{metadata:Object.assign(Object.assign({},i.metadata),{eTag:t.ETag,expires:t.Expires.toString(),configIds:{experiments:n,rollouts:a}})}),i}}class Ah extends Ag{constructor(e,t,i,n){super(),this.policiesDataProvider=t,this.configLoader=i,this.enablePoliciesDefaultValues=n,this.providerName="PolicyProvider",this.refreshSettings=e=>{this.rawPolicies=e;const t=this.policySettings,i=this.mapPoliciesToSettings(e);if(this.enablePoliciesDefaultValues){const e=(0,B.cloneDeep)(this.policySettingsDefaults);this.policySettings=(0,B.mergeWith)(e,i,Ru.g)}else this.policySettings=i;(0,B.isEqual)(t,this.policySettings)?this.logger.log("No changes detected."):(this.logger.log("Policy settings updated to: ",this.policySettings),this.notifySettingsChanged())},this.logger=e.newLogger("CoreSettings/PolicyProvider","core-services-settings"),this.policiesDataProvider.subscribeForSettingsUpdates(this.refreshSettings),this.policySettingsDefaults={},this.rawPolicies={}}initialize(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.policiesJson=this.configLoader("policies").mappings,this.logger.log("Loaded policies mapping: ",this.policiesJson),this.enablePoliciesDefaultValues&&this.policiesJson&&(this.policySettingsDefaults=this.getPolicySettingsDefaults(this.policiesJson),this.policySettings=(0,B.cloneDeep)(this.policySettingsDefaults),this.logger.log("Loaded default for policies settings: ",this.policySettingsDefaults)),yield this.policiesDataProvider.initialize(!0),this.logger.log("Initial fetch completed.")}))}getSettings(){return this.policySettings}getRawSettings(){return this.rawPolicies}cleanup(){this.policiesDataProvider.cleanup()}getPolicySettingsDefaults(e){const t={};return Object.keys(e).map((e=>{const i={},n=(0,B.get)(this.policiesJson,e);Object.keys(n).map((e=>{const t=(0,B.get)(n,e);if(t&&(0,B.has)(t,"defaultValue")){const n=(0,B.get)(t,"defaultValue");(0,B.set)(i,e,n)}})),(0,B.set)(t,e,i)})),t}mapPoliciesToSettings(e){const t={};return this.policiesJson&&Object.keys(this.policiesJson).map((i=>{const n={},a=(0,B.get)(this.policiesJson,i);Object.keys(a).map((t=>{const i=(0,B.get)(a,t);if(i&&(0,B.has)(i,"name")){const a=(0,B.get)(i,"name"),s=(0,B.get)(e,a);(0,B.set)(n,t,s)}})),(0,B.set)(t,i,n)})),t}}class Mh{constructor(e){this.host=e}setItem(e,t){return this.host.localStorage.setItem(e,t),Promise.resolve()}getItem(e){const t=this.host.localStorage.getItem(e);return Promise.resolve(t)}removeItem(e){return this.host.localStorage.removeItem(e),Promise.resolve()}}const Ph=["EducationStudent","EducationFaculty","SmbLicense"],Oh=["A1","A3","A5","Other"];function Rh(e,t,i){const n=function(e,t){let i,n;const{isTeamsSmb:a,eduLicenseSkuAndCategory:s,region:o}=e,r=null==o?void 0:o.toLowerCase();if(a&&t)n="SmbLicense";else if(s&&s.trim().length>0&&s.includes("_")){const[e,t]=s.split("_");e&&t&&Oh.find((t=>t===e))&&Ph.find((e=>e===t))&&(i=e,n=t)}return{userLicenseSku:i,userLicenseCategory:n,region:r}}(e,t);return Object.assign(Object.assign({},n),i)}class Lh{constructor(e){this.cacheMap=new Map,this.logger=e.newLogger("CoreSettings/ContextCache","core-services-settings")}cache(e,t){if(this.cacheMap.has(e))throw new Error(`Context '${e}' already stored.`);this.cacheMap.set(e,{context:t,refCount:1}),this.logger.debug(`Context '${e}' cached.`)}acquire(e,t){const i=this.cacheMap.get(e);if(i)return i.refCount++,this.logger.debug(`Acquiring context '${e}', ref count: '${i.refCount}'.`),i.context;if(!t)throw new Error(`Context '${e}' not found in cache.`);this.logger.debug(`Context '${e}' not found in cache, constructing...`);const n=t();return this.cache(e,n),n}release(e,t){const i=this.cacheMap.get(e);if(!i)throw new Error(`Cannot release context '${e}', not found in cache.`);i.refCount--,this.logger.debug(`Releasing context '${e}', ref count: '${i.refCount}'.`),0===i.refCount&&(t(),this.cacheMap.delete(e))}}const Uh="incomplete-boot-attempts";class $h{constructor(e,t,i){if(this.coreSettings=e,this.storage=i,this.pastAttemptsCount=0,this.logger=t.newLogger("CoreSettings/IncompleteBootAttemptsCounter","core-services-settings"),!i)return void this.logger.debug("Disabled because no storage is available.");this.pastAttemptsCount=function(e){if(!e)return 0;try{return parseInt(e,10)}catch(e){return 0}}(i.get(Uh));const n=this.pastAttemptsCount+1;i.setSafe(Uh,`${n}`),this.logger.debug(`Set past incomplete boot count to ${n}.`)}markBootAttemptComplete(){this.storage&&(this.pastAttemptsCount>0&&this.logger.debug("Boot attempt complete, incomplete boot counter reset to 0."),this.storage.setSafe(Uh,"0"),this.pastAttemptsCount=0)}get tooManyPastAttempts(){if(!this.storage)return this.logger.debug("No blocking fetch because storage is unavailable."),!1;const e=this.coreSettings.get(S.J.Core).maxBootAttemptsWithoutEcsFetch;if(!e)return this.logger.debug("No blocking fetch because incomplete boot count limit is unset or zero."),!1;const t=this.pastAttemptsCount>=e;return this.logger.debug(`Too many attempts: ${t}`),t}}const Wh="cachedPrimaryUser";class Bh{constructor(e,t){this.localStorage=e,this.logger=t.newLogger("CoreSettings/PrimaryUserCache","core-services-settings")}get(){return void 0===this.inMemoryCachedUser&&this.loadFromLocalStorage(),this.inMemoryCachedUser}update(e){const t=Object.assign(Object.assign({},this.inMemoryCachedUser),e),i=!(0,B.isEqual)(t,this.inMemoryCachedUser);return this.inMemoryCachedUser=t,this.persistToLocalStorage(),i}clear(){this.inMemoryCachedUser=void 0,this.clearLocalStorage()}loadFromLocalStorage(){const e=this.localStorage.get(Wh,"Experience");if(e)try{return void(this.inMemoryCachedUser=JSON.parse(e))}catch(e){this.logger.warn("Cannot parse cached primary user",e)}this.inMemoryCachedUser=null}persistToLocalStorage(){try{this.localStorage.setSafe(Wh,(0,U.u4)(this.inMemoryCachedUser),"Experience")}catch(e){this.logger.error("Unable to cache primary user")}}clearLocalStorage(){this.localStorage.remove(Wh,"Experience")}}class zh extends Th{constructor(e,t,i,a,s,o,r,c,l,d){super(e,t,i,a,s,o,r,c,l),this.primaryUserCache=d,this.fetchEcsSettingsIfApplicable=()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var e;if(this.enable1JSEcsClient)return this.fetchEcsSettingsFromEcsClientProvider();const t=null===(e=this.ecsCachedProvider)||void 0===e?void 0:e.getProvider();if(!t.isInitialized){const e=!0;yield null==t?void 0:t.initialize(e)}})),this.getServiceSwitcherApiKey=()=>{var e;return null===(e=this.localStorage)||void 0===e?void 0:e.get("serviceId","Experience")},this.getChildId=e=>`${this.id}/${e}`,this.getEcsParameters=(e,t)=>{const i=this.enableLocaleFilterForFeatureFlags?this.locale:void 0,n=(t&&t.profile?{userId:t.profile.objectId,tenantId:t.profile.tenantId}:void 0)||(()=>{var e;const t=null===(e=this.primaryUserCache)||void 0===e?void 0:e.get();return t&&t.userId&&t.tenantId?t:void 0})();return(0,mh.xb)({coreSettings:this.getCoreSettings(),experienceName:this.experienceName,platformService:this.platformService,user:n,locale:i,logger:e})},this.fetchEcsSettingsFromEcsClientProvider=()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var e;"EcsClient"===(null===(e=this.ecsClientProvider)||void 0===e?void 0:e.getClientType())&&(this.ecsClientProvider.clientStarted||(yield this.ecsClientProvider.startClient(!0)))}))}static createContext(e,t,i,a,s,o,r,c){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=new Lh(a),l=new Bh(r,a),d=new zh("g",t.experienceName,n,a,s,e,i,t.partitionCacheByExperience,r,l);yield d.createConfigProviderForMainThread(),d.createHostProvider(o,c),d.createLocalMigratedSettingsProvider(o),d.createMaglevHostProvider(),d.createPlatformProvider(s),d.createViewportOverrideProvider({viewportContext:o.viewportContext,entityType:null});const u=new Mh(o);return yield d.createEcsCachedProvider(u),yield d.createEcsClientProvider(u),d.createClientFiltersProviders(),yield d.createPolicyCachedProvider(u),d.createLocalStorageProvider(o),d.createApiServiceProvider(),d.createQspProvider(o),d.createClientPreferencesProvider(e),d.registerAllProviders(),n.cache(d.id,d),d}))}static createContextForWorker(e,t,i,n,a){const s=new Lh(t),o=new zh(e,e,s,t,i,n,a);return o.createConfigProviderForCDLWorker(),o.createPlatformProvider(i),o.createClientFiltersProviders(),o.registerAllProviders(),s.cache(o.id,o),o}createContextForUser(e,t){var i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if((null===(a=null===(i=this.primaryUserCache)||void 0===i?void 0:i.get())||void 0===a?void 0:a.userId)===e.profile.objectId)return this.cache.acquire(this.id);const n=this.getChildId(`u-${e.id}`),s=this.cache.acquire(n,(()=>this.clone(n)));s.createClientFiltersProviders();const o=new Mh(t);return yield s.createPolicyCachedProvider(o,e),s.registerAllProviders(),s}))}createContextForViewport(e){var t;if(this.logger.log("Acquiring context for viewport params: ",e),!this.viewportOverrideProvider||(null===(t=this.viewportOverrideProvider)||void 0===t?void 0:t.hasDifferences(e))){const t=this.getChildId(`v-${e.viewportContext}-${e.entityType}`);return this.cache.acquire(t,(()=>{const i=this.clone(t);return i.createViewportOverrideProvider(e),i.registerAllProviders(),i}))}return this.cache.acquire(this.id)}setPrimaryUser(e){var t,i,a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.logger.log(`Setting primary user to: ${null==e?void 0:e.id}`);let n=!1;e?n=(null===(t=this.primaryUserCache)||void 0===t?void 0:t.update({userId:null===(i=e.profile)||void 0===i?void 0:i.objectId,tenantId:null===(a=e.profile)||void 0===a?void 0:a.tenantId}))||!1:null===(s=this.primaryUserCache)||void 0===s||s.clear(),yield this.reinitializeEcsProvider(n)}))}initializeProvidersWithCachedPrimaryUser(){var e;const t=null===(e=this.primaryUserCache)||void 0===e?void 0:e.get();if(t){this.updatePlatformProviderSettings({region:t.region});const{preReleaseFeaturesAllowed:e}=this.getCoreSettings().get(S.J.Metadata),{enableSmbLicenseClientFilter:i}=this.getCoreSettings().get(S.J.Smb),n=Rh(t,!!i,{preReleaseFeaturesAllowed:e});this.initializeClientFiltersProviders(n)}}initializeProvidersWithDiscoveredUser(e,t,i){var a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enableSmbLicenseClientFilter:n}=this.getCoreSettings().get(S.J.Smb),s=Rh(e,!!n,i);if(yield this.initializeClientFiltersProviders(s),this.updatePlatformProviderSettings({region:null==e?void 0:e.region}),t){const{isTeamsSmb:t,eduLicenseSkuAndCategory:i,region:n}=e;null===(a=this.primaryUserCache)||void 0===a||a.update({isTeamsSmb:t,eduLicenseSkuAndCategory:i,region:n})}}))}initializeMaglevHostProvider(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield null===(t=this.maglevHostProvider)||void 0===t?void 0:t.initialize(e)}))}initializeMaglevHostProviderPostAltSettings(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield null===(t=this.maglevHostProvider)||void 0===t?void 0:t.onPreWarm(e)}))}initializeEcsProvider({authenticationUser:e,scenarioFactory:t,networkState:i,clientState:a,windowProvider:s,endpointsManager:o,alwaysFetchEcsSettings:r}){var c,l;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this.enable1JSEcsClient)return this.initializeEcsClientProvider({authenticationUser:e,scenarioFactory:t,networkState:i,clientState:a,windowProvider:s,endpointsManager:o,alwaysFetchEcsSettings:r});const n=yield this.getEcsParameters(this.logger,e),d=this.getCoreSettings(),u=new $h(d,this.loggerFactory,this.localStorage),m=new Dh(n,d,this.loggerFactory,t,s,a,i,o,u,(()=>{var e;return{timeSinceCacheExpired:(0,mh.mN)(null===(e=this.ecsCachedProvider)||void 0===e?void 0:e.getExpiration())}})),g=(null===(c=this.ecsCachedProvider)||void 0===c?void 0:c.cacheState)!==ih.NoData,h=!g||u.tooManyPastAttempts;h||r?(this.logger.log(`Initializing ECS provider: awaitInitialSync? ${h}, hasCacheData? ${g}, alwaysFetch? ${r}`),yield m.initialize(h)):this.logger.log("Cache is valid, delaying ECS fetch until WARM."),yield null===(l=this.ecsCachedProvider)||void 0===l?void 0:l.setProvider(m)}))}initializePolicyProvider(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enablePoliciesDefaultValues:t}=this.getCoreSettings().get(S.J.Core),i=new Ah(this.loggerFactory,e,this.configLoader,!!t);if(this.policyCachedProvider){const e=i.initialize();this.policyCachedProvider.cacheState===ih.NoData&&(this.logger.log("Policy cache is empty, waiting to fetch policies."),yield e),yield this.policyCachedProvider.setProvider(i)}}))}initializeWorkerProviders(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield this.createWorkerHostProvider(t),yield this.createEcsCachedProvider(e),yield this.createEcsClientProvider(e),yield this.createWorkerTestProvider(e),yield this.createWorkerHostTestOverridesProvider(t),this.registerProvider(Ng.Configuration,this.workerHostProvider),this.registerProvider(Ng.Configuration,this.ecsCachedProvider),this.registerProvider(Ng.TestOverride,this.workerTestProvider),this.registerProvider(Ng.TestOverride,this.workerHostTestOverridesProvider),this.settingsService.notifySettingsChanged()}))}initializeWorkerProvidersWithoutHostSettings(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield this.createEcsCachedProvider(e),yield this.createEcsClientProvider(e),yield this.createWorkerTestProvider(e),yield this.createWorkerHostTestOverridesProvider(t),this.registerProvider(Ng.Configuration,this.ecsCachedProvider),this.registerProvider(Ng.TestOverride,this.workerTestProvider),this.registerProvider(Ng.TestOverride,this.workerHostTestOverridesProvider),this.settingsService.notifySettingsChanged()}))}initializeHostWorkerProviders(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield this.createWorkerHostProvider(e),this.registerProvider(Ng.Configuration,this.workerHostProvider),this.settingsService.notifySettingsChanged()}))}initializeApiServiceProvider(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=this.getSelectedServiceConfigs();t&&(null===(e=this.apiServiceProvider)||void 0===e||e.setOverrides(t))}))}getLocalStorageTestOverrides(){var e;return null===(e=this.localStorageProvider)||void 0===e?void 0:e.getSettings()}getQspTestOverrides(){var e;return null===(e=this.qspProvider)||void 0===e?void 0:e.getSettings()}clone(e){const t=new zh(e,this.experienceName,this.cache,this.loggerFactory,this.platformService,this.clientPreferences,this.configLoader,this.partitionCacheByExperience);return this.scenarioFactory&&t.setScenarioFactory(this.scenarioFactory),t.configProvider=this.configProvider,t.ecsCachedProvider=this.ecsCachedProvider,t.ecsClientProvider=this.ecsClientProvider,t.hostProvider=this.hostProvider,t.localMigratedSettingsProvider=this.localMigratedSettingsProvider,t.maglevHostProvider=this.maglevHostProvider,t.clientFiltersMergeProvider=this.clientFiltersMergeProvider,t.clientFiltersOverrideProvider=this.clientFiltersOverrideProvider,t.policyCachedProvider=this.policyCachedProvider,t.qspProvider=this.qspProvider,t.localStorageProvider=this.localStorageProvider,t.apiServiceProvider=this.apiServiceProvider,t.platformProvider=this.platformProvider,t}initializeClientFiltersProviders(e){var t,i;const{enableClientFiltersProvider:n}=this.getCoreSettings().get(S.J.Core);n&&(null===(t=this.clientFiltersMergeProvider)||void 0===t||t.initialize(e),null===(i=this.clientFiltersOverrideProvider)||void 0===i||i.initialize(e))}getSelectedServiceConfigs(){var e,t,i,n,a,s,o,r;const c=this.getServiceSwitcherApiKey()||(null===(t=null===(e=this.getCoreSettings())||void 0===e?void 0:e.get(S.J.Host))||void 0===t?void 0:t.serviceSwitcherSelectedServiceId);if(!c)return;const l=null===(n=null===(i=this.getCoreSettings())||void 0===i?void 0:i.get(S.J.Core))||void 0===n?void 0:n.availableServiceSwitcherApis,d=null==l?void 0:l.find((e=>e.id===c));if(d)null===(r=(o=this.logger).infoToTelemetry)||void 0===r||r.call(o,"Service config found","service_switch_load",{newState:c},!0);else{const e=`No service config found for ${c}`;null===(s=(a=this.logger).errorToTelemetry)||void 0===s||s.call(a,e,"service_switch_load",{newState:c,error:e},!0)}return d}reinitializeEcsProvider(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this.enable1JSEcsClient)return this.reinitializeEcsClientProvider(e);const i=null===(t=this.ecsCachedProvider)||void 0===t?void 0:t.getProvider();if(!i)return;const n=yield this.getEcsParameters(this.logger);!i.isInitialized&&e?yield i.initialize(!0):yield i.updateEcsParametersAndFetchSettings(n)}))}get enable1JSEcsClient(){const e=this.getCoreSettings(),{enable1JSEcsClient:t}=e.get(S.J.Core,["enable1JSEcsClient"]);return Boolean(t)}initializeEcsClientProvider({authenticationUser:e,scenarioFactory:t,networkState:i,clientState:a,windowProvider:s,endpointsManager:o,alwaysFetchEcsSettings:r}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.ecsClientProvider)throw new Error("initializeEcsClientProvider() called without this.ecsClientProvider present");const n=yield this.getEcsParameters(this.logger,e),c=this.getCoreSettings(),l=new $h(c,this.loggerFactory,this.localStorage);this.ecsClientProvider.initializeClient(n,c,s,a,i,o,t,l);const d=this.ecsClientProvider.getCacheState(),u=d===ih.Valid||d===ih.Expired,m=!u||l.tooManyPastAttempts;m||r?(this.logger.log(`Initializing ECS provider: awaitInitialSync? ${m}, hasCacheData? ${u}, alwaysFetch? ${r}`),yield this.ecsClientProvider.startClient(m)):this.logger.log("Cache is valid, delaying ECS fetch until WARM.")}))}reinitializeEcsClientProvider(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if("EcsClient"!==(null===(t=this.ecsClientProvider)||void 0===t?void 0:t.getClientType()))return;const i=this.getEcsParameters(this.logger);!this.ecsClientProvider.clientStarted&&e?yield this.ecsClientProvider.startClient(!0):yield this.ecsClientProvider.updateParametersAndFetch(i)}))}}class Hh extends Ue{constructor(){super(h.Yg.CreateSettings,[]),this.registerShellHandlers=(e,t)=>{var i;null===(i=e.opener)||void 0===i||i.addEventListener(L.rY.GetSettings,(()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return t.getCurrentSettingsSnapshot().then((t=>e.opener.postMessage(L.rY.GetSettings,{settings:t})),(()=>e.opener.postMessage(L.rY.GetSettings,{settings:""})))}))))}}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{hostSettings:t}=e,{clientPreferences:i,config:n,configLoader:a,diagnosticsService:s,loggerFactory:o,logsCollectorService:r,platformService:c,windowProvider:l,localStorage:d,postTaskSchedulerDiagnosticsService:u}=mg("CreateCoreSettingsTask",e,"clientPreferences","config","configLoader","diagnosticsService","loggerFactory","logsCollectorService","platformService","windowProvider","localStorage","postTaskSchedulerDiagnosticsService"),m=yield zh.createContext(i,n,a,o,c,l,d,t),g=m.getCoreSettings();m.initializeProvidersWithCachedPrimaryUser();const h=m.getLogsProvider();e.coreSettingsContext=m,e.coreSettings=g,s.subscribeToCoreSettings(g),r.subscribeToCoreSettings(g),u.subscribeToCoreSettings(g);g.get(S.J.Core).enableMTMA||r.registerUserLogsProvider("",h),this.registerShellHandlers(l,h)}))}}class qh extends Ue{constructor(){super(h.Yg.CreateSettingsUserContext,["authenticationUser","coreSettingsContext","logsCollectorService","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettingsContext:i,logsCollectorService:n,windowProvider:a}=e,s=yield i.createContextForUser(t,a);e.coreSettingsContext=s,e.coreSettings=s.getCoreSettings();const o=s.getLogsProvider();return n.registerUserLogsProvider(t.id,o),e=>{switch(e){case"quit":case"signout":s.cleanup(e);break;default:return}}}))}}class Vh{constructor(e,t,i,n,a,s,o,r,c){this._commandHandler=e,this._client=t,this._experienceChangeReportingService=i,this._authenticationUser=n,this._hostCommunicationService=a,this._loggerFactory=s,this._activeWindowsService=o,this._shortcutRegistryService=r,this._config=c,this._logger=this._loggerFactory.newLogger("core-shortcut-service","core-shortcut-service"),this._registeredDesktopShortcuts=[]}addAppWideShortcut(e,t,i,n){var a;null===(a=this._shortcutRegistryService)||void 0===a||a.addAppWideShortcut(e,t,i,n)}removeAppWideShortcut(e){var t;null===(t=this._shortcutRegistryService)||void 0===t||t.removeAppWideShortcut(e)}getAppWideShortcutHandler(e){var t;return null===(t=this._shortcutRegistryService)||void 0===t?void 0:t.getAppWideShortcutHandler(e)}addDesktopClientShortcut(e,t,i,a){var s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this._config.enableShortcutRegistrationWithDesktopClient)return;if(!a)return void this._logger.warn(`Missing windowId for command: ${t}`);const n=yield this._hostCommunicationService.loadModule("windowcontrols"),o=yield null===(s=null==n?void 0:n.addShortcut)||void 0===s?void 0:s.call(n,a,e);return o&&(this._logger.log(`Added desktop shortcut for command ${t} and shortuctId ${o}`),this._registeredDesktopShortcuts.push({commandId:t,shortcutId:o,commandHandler:i,windowId:a})),o}))}removeDesktopClientShortcut(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this._config.enableShortcutRegistrationWithDesktopClient)return;this._logger.debug(`Removing desktop shortcut for commandId ${e}`);const n=this._registeredDesktopShortcuts.find((i=>i.commandId===e&&i.windowId===t));if(n){const a=yield this._hostCommunicationService.loadModule("windowcontrols");yield null===(i=null==a?void 0:a.removeShortcut)||void 0===i?void 0:i.call(a,n.windowId,n.shortcutId),this._logger.log(`Removed desktop shortcut for command ${e} and shortuctId ${n.shortcutId}`),this._registeredDesktopShortcuts=this._registeredDesktopShortcuts.filter((i=>!(i.commandId===e&&i.windowId===t)))}}))}addGlobalShortcut(e,t,i){var a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){return null===(a=this._shortcutRegistryService)||void 0===a?void 0:a.addGlobalShortcut(e,t,i)}))}removeGlobalShortcut(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){return null===(t=this._shortcutRegistryService)||void 0===t?void 0:t.removeGlobalShortcut(e)}))}addEventListener(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this._config.enableShortcutPropagation)return;const i=yield this.getMainWindow();(null==i?void 0:i.id)===e&&(this._mainShortcutServiceCallback=t)}))}processEvent(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this._config.enableShortcutPropagation)return;(yield this.getMainWindow())?null===(i=this._mainShortcutServiceCallback)||void 0===i||i.call(this,e):(this._mainShortcutServiceCallbackWithPayload=()=>{var t;null===(t=this._mainShortcutServiceCallback)||void 0===t||t.call(this,e)},this._subscribeToChangeReportingService()),yield this.openMainApp()}))}registerForDesktopClientKeyDownShortcuts(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this._config.enableShortcutRegistrationWithDesktopClient)return;const t=yield this._hostCommunicationService.loadModule("windowcontrols");this._disposeDesktopShortcutKeyDowEventRegistration=null===(e=null==t?void 0:t.registerForKeyDown)||void 0===e?void 0:e.call(t,(e=>this._handleDesktopShortcut(e)))}))}registerForGlobalShortcutActivated(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){return null===(e=this._shortcutRegistryService)||void 0===e?void 0:e.registerForGlobalShortcutActivated()}))}destroy(e){var t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(null===(t=this._shortcutRegistryService)||void 0===t||t.destroy(e),this._config.enableShortcutRegistrationWithDesktopClient&&(null===(i=this._disposeDesktopShortcutKeyDowEventRegistration)||void 0===i||i.call(this)),this._config.enableShortcutPropagation){const e=this._activeWindowsService.enableDecoupleCommandingFromApollo?this._activeWindowsService.getActiveWindows():yield(0,Lo.XD)(this._client),t=e.find((e=>e.isMainWindow&&e.layoutConfig.layoutMode===ve.lO.standard));t||(this._mainShortcutServiceCallback=void 0),0!==e.length&&this._authenticationUser&&(null==t?void 0:t.userContextId)===(0,He.b4)(this._authenticationUser)||(this._mainShortcutServiceCallbackWithPayload=void 0,this._mainShortcutServiceCallback=void 0,this._subscription&&this._subscription.unsubscribe())}}))}getMainWindow(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this._activeWindowsService.enableDecoupleCommandingFromApollo?this._activeWindowsService.getStandardMainWindow():yield(0,Lo.jW)(this._client)}))}openMainApp(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this._commandHandler({entity:{type:pe.py.default,action:pe.uk.default},command:{visibilityState:ve.fe.show,stateTransition:ve.su.flush,correlation:{source:k.D.Core}}})}))}_handleDesktopShortcut(e){const t=this._registeredDesktopShortcuts.find((t=>t.shortcutId===e.shortcutId));t?(this._logger.debug(`Executing command handler for desktop shortcut: ${t.commandId} / ${e.shortcutId}`),t.commandHandler()):this._logger.warn(`Can't execute desktop shortcut with id ${e.shortcutId}. No record found.`)}_subscribeToChangeReportingService(){const e=this._experienceChangeReportingService.observeChanges();this._subscription=e.pipe((0,l.U)((e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){if(e.type!==Mt.FV.LayoutRenderComplete)return;const t=yield this.getMainWindow();e.windowId===(null==t?void 0:t.id)&&this._onMainWindowLayoutRenderComplete()}))))).subscribe()}_onMainWindowLayoutRenderComplete(){var e;null===(e=this._mainShortcutServiceCallbackWithPayload)||void 0===e||e.call(this),this._mainShortcutServiceCallbackWithPayload=void 0,this._subscription&&this._subscription.unsubscribe()}}class Gh extends Ue{constructor(){super(h.Yg.CreateCoreShortcutService,["activeWindowsService","commandHandler","client","coreSettings","experienceChangeReportingService","hostCommunicationService","loggerFactory","shortcutRegistryService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{activeWindowsService:t,authenticationUser:i,commandHandler:n,client:a,coreSettings:s,experienceChangeReportingService:o,hostCommunicationService:r,loggerFactory:c,shortcutRegistryService:l}=e,{enableShortcutPropagation:d,enableShortcutRegistrationWithDesktopClient:u,enableGlobalShortcuts:m,enableAppWideShortcuts:g}=s.get(S.J.Shortcuts);(d||m||u||g)&&(e.coreShortcutService=new Vh(n,a,o,i,r,c,t,l,{enableShortcutPropagation:!!d,enableShortcutRegistrationWithDesktopClient:!!u,enableGlobalShortcuts:!!m,enableAppWideShortcuts:!!g}))}))}}class Jh extends Ue{constructor(){super(h.Yg.CreateCoreUtilities,["isEntityInView"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{isEntityInView:t}=e;e.coreUtilities={isEntityInView:t}}))}}class Kh{constructor(e,t){this.channelName=e,this.host=t,this.subscriptions=[],this.hostResumeEventHandler=()=>{this.closeChannel(),this.initializeChannel()},this.initializeChannel(),this.subcribeToHostLifecycleEvents()}canPostMessage(){return!!this.broadcastChannel}postMessage(e){return this.broadcastChannel?(this.broadcastChannel.postMessage(e),"success"):"failure"}subscribeToMessage(e){var t;this.subscriptions.push(e),null===(t=this.broadcastChannel)||void 0===t||t.addEventListener("message",(t=>e(t.data)))}dispose(){this.unsubscribeFromHostLifecycleEvents(),this.closeChannel(),this.subscriptions=[]}initializeChannel(){const e=new BroadcastChannel(this.channelName);this.broadcastChannel=e,this.subscriptions.forEach((t=>e.addEventListener("message",(e=>t(e.data)))))}closeChannel(){var e;null===(e=this.broadcastChannel)||void 0===e||e.close(),this.broadcastChannel=void 0}subcribeToHostLifecycleEvents(){this.host.addEventListener("resume",this.hostResumeEventHandler)}unsubscribeFromHostLifecycleEvents(){this.host.removeEventListener("resume",this.hostResumeEventHandler)}}class Qh{constructor(e,t){var i,n;this.logger=e,this.host=t,this.subscriptions=new Map,this.channel=new Kh(Qh.CrossTabsCommsBusKey,this.host),this.initializeSubscriptions(),null===(n=(i=this.logger).logNoPii)||void 0===n||n.call(i,"Initialized")}postMessage(e,t){if(!this.channel.canPostMessage())return"failure";const i=this.toCrossTabsMessagePayload(e,t);return this.channel.postMessage(i)}subscribeToMessage(e,t){const i=this.subscriptions.get(e)||new Set;i.add(t),this.subscriptions.set(e,i);const n=()=>{const i=this.subscriptions.get(e);(null==i?void 0:i.has(t))&&i.delete(t)};return()=>n()}dispose(){this.channel.dispose(),this.subscriptions.clear()}broadcastedMessageHandler(e){var t,i;null===(i=(t=this.logger).logNoPii)||void 0===i||i.call(t,`Message received: type=${e.messageType}, id={${e.messageId}}, correlationId={${e.correlationId}}`);const n=e.messageType;if(n){const t=this.subscriptions.get(n);t&&t.forEach((t=>t(Object.assign({},e))))}}initializeSubscriptions(){this.channel.subscribeToMessage((e=>this.broadcastedMessageHandler(e)))}toCrossTabsMessagePayload(e,t){return Object.assign({messageType:e,timestamp:Date.now(),messageId:(0,ee.GW)(),correlationId:(null==t?void 0:t.responseRequired)?(0,ee.GW)():void 0},t)}}Qh.CrossTabsCommsBusKey="CrossTabsBus";class Yh{constructor(e,t,i){this.baseCrossTabsService=e,this.logger=t,this.host=i,this.subscribeToTabsSearch()}areOtherTabsDetected(){return new Promise((e=>{let t=0;const i=this.baseCrossTabsService.subscribeToMessage("SearchTabsResponse",(()=>{t&&this.host.clearTimeout(t),i(),e(!0)}));"failure"===this.baseCrossTabsService.postMessage("SearchTabs",{responseRequired:!0})&&(i(),e(!1)),t=this.host.setTimeout((()=>{e(!1)}),1e3)}))}subscribeToTabsSearch(){this.baseCrossTabsService.subscribeToMessage("SearchTabs",(e=>{var t,i;this.baseCrossTabsService.postMessage("SearchTabsResponse",{correlationId:e.correlationId}),null===(i=(t=this.logger).logNoPii)||void 0===i||i.call(t,`SearchTabs received. CorrelationId: ${e.correlationId}`)}))}}const Xh=3e5;class Zh{constructor(e,t,i,n){this.baseCrossTabsService=e,this.logger=t,this.host=i,this.timestampOfLastCountTabsResponse=0,this.waitForTabsCountTimeoutMs=5e3,this.waitForTabsCountResponsesTimeoutMs=3e3,this.tabsRecountIntervalMs=Xh,this.tabClosingEventHandler=()=>{var e,t;null===(t=(e=this.logger).logNoPii)||void 0===t||t.call(e,"Tab might to be closing. Sending TabClosed message."),this.baseCrossTabsService.postMessage("TabClosed")},this.activeTabsCountBehaviorSubject=new s.X(1);const{disableActiveTabsCounting:a,crossTabsRecountIntervalMs:o,crossTabsWaitCountTabsResponseIntervalMs:r,crossTabsWaitForTabsCountTimeoutMs:c}=n.get(S.J.Core,["disableActiveTabsCounting","crossTabsRecountIntervalMs","crossTabsWaitCountTabsResponseIntervalMs","crossTabsWaitForTabsCountTimeoutMs"]);a||(this.tabsRecountIntervalMs=null!=o?o:Xh,this.waitForTabsCountResponsesTimeoutMs=null!=r?r:3e3,this.waitForTabsCountTimeoutMs=null!=c?c:5e3,this.initializeTabsCounting())}observeActiveTabsCount(){return this.activeTabsCountBehaviorSubject.asObservable()}getActiveTabsCount(){return this.activeTabsCountBehaviorSubject.getValue()}dispose(){var e,t;this.clearTabsCountingTimer(),this.clearWaitForTabsCountTimer(),null===(t=null===(e=this.countTabsPromise)||void 0===e?void 0:e.cancel)||void 0===t||t.call(e),this.unsubscribeFromHostLifecycleEvents(),this.activeTabsCountBehaviorSubject&&this.activeTabsCountBehaviorSubject.complete()}initializeTabsCounting(){this.initializeTabClosingHandlers(),this.baseCrossTabsService.subscribeToMessage("TabsCount",(e=>{var t,i;this.clearWaitForTabsCountTimer(),null===(i=(t=this.logger).logNoPii)||void 0===i||i.call(t,`TabsCount ${e.tabsCount} received. CorrelationId: ${e.correlationId}`),this.updateActiveTabsCount(e.tabsCount,e.lastResponseTimestamp),this.restartTabsCountingTimer()})),this.baseCrossTabsService.subscribeToMessage("CountTabs",(e=>{var t,i;this.baseCrossTabsService.postMessage("CountTabsResponse",{correlationId:e.correlationId}),null===(i=(t=this.logger).logNoPii)||void 0===i||i.call(t,`CountTabs received. CorrelationId: ${e.correlationId}`),this.startWaitForTabsCountTimer()})),this.restartTabsCountingTimer(),this.countTabs(!0)}countTabs(e=!1){if(this.countTabsPromise)return this.countTabsPromise.promise;let t;const i=new Promise((i=>{var n,a;let s=0;const o=(0,ee.GW)();let r=1,c=Date.now();const l=this.baseCrossTabsService.subscribeToMessage("CountTabsResponse",(e=>{e.correlationId===o&&(r++,c=Date.now())}));t=()=>{l(),s&&this.host.clearTimeout(s),s=0,i()};const d=this.baseCrossTabsService.postMessage("CountTabs",{correlationId:o}),u=Date.now(),m=()=>{var n,a,s,d;l();const m=this.getActiveTabsCount().toString();this.updateActiveTabsCount(r,c),this.baseCrossTabsService.postMessage("TabsCount",{tabsCount:r,correlationId:o,lastResponseTimestamp:c});const g=c>=u?c-u:-1;null===(a=(n=this.logger).infoToTelemetry)||void 0===a||a.call(n,`tabs counting timespan is ${g}`,"crosstabs_tabs_counting_timespan",{delta:g},!0),null===(d=(s=this.logger).infoToTelemetry)||void 0===d||d.call(s,`tabs count is ${r}`,"crosstabs_tabs_count",{currentState:e?void 0:m,newState:r.toString()},!0),t=void 0,i()};"failure"===d?(null===(a=(n=this.logger).errorToTelemetry)||void 0===a||a.call(n,"countTabs can't post message","crosstabs_tabs_counting_error"),m()):s=this.host.setTimeout((()=>{m()}),this.waitForTabsCountResponsesTimeoutMs)})).then((()=>{this.countTabsPromise=void 0}));return this.countTabsPromise={promise:i,cancel:()=>null==t?void 0:t()},this.countTabsPromise.promise}updateActiveTabsCount(e,t){var i,n;e&&e!==this.activeTabsCountBehaviorSubject.getValue()&&t>this.timestampOfLastCountTabsResponse?(this.timestampOfLastCountTabsResponse=t,this.activeTabsCountBehaviorSubject.next(e)):null===(n=(i=this.logger).logNoPii)||void 0===n||n.call(i,`Tabs count is not updated. timestampOfLastCountTabsResponse: ${this.timestampOfLastCountTabsResponse}, lastResponseTimestamp for update: ${t}`)}restartTabsCountingTimer(){this.clearTabsCountingTimer(),this.nextTabsRecountTimerId=this.host.setInterval((()=>{void 0===this.waitForTabsCountTimerId&&this.countTabs()}),this.tabsRecountIntervalMs)}clearTabsCountingTimer(){void 0!==this.nextTabsRecountTimerId&&(this.host.clearInterval(this.nextTabsRecountTimerId),this.nextTabsRecountTimerId=void 0)}startWaitForTabsCountTimer(){this.waitForTabsCountTimerId||(this.waitForTabsCountTimerId=this.host.setTimeout((()=>{this.waitForTabsCountTimerId=void 0,this.restartTabsCountingTimer(),this.countTabs()}),this.waitForTabsCountTimeoutMs))}clearWaitForTabsCountTimer(){void 0!==this.waitForTabsCountTimerId&&(this.host.clearTimeout(this.waitForTabsCountTimerId),this.waitForTabsCountTimerId=void 0)}initializeTabClosingHandlers(){this.host.addEventListener("beforeunload",this.tabClosingEventHandler),this.baseCrossTabsService.subscribeToMessage("TabClosed",(()=>{var e,t;this.clearWaitForTabsCountTimer(),null===(t=(e=this.logger).logNoPii)||void 0===t||t.call(e,"TabClosed received."),this.startWaitForTabsCountTimer()}))}unsubscribeFromHostLifecycleEvents(){this.host.removeEventListener("beforeunload",this.tabClosingEventHandler)}}class ep{constructor(e,t,i){var n,a;this.logger=e.newLogger("CrosstabService","services-io-browser-crosstabs"),this.basicCrossTabsService=new Qh(this.logger,t),this.tabsFinderHelper=new Yh(this.basicCrossTabsService,this.logger,t),this.tabsCounterHelper=new Zh(this.basicCrossTabsService,this.logger,t,i),this.loggingActiveTabsCountSubsciption=this.observeActiveTabsCount().subscribe((e=>{var t,i;null===(i=(t=this.logger).logNoPii)||void 0===i||i.call(t,`Active tabs count: ${e}`)})),null===(a=(n=this.logger).logNoPii)||void 0===a||a.call(n,"Initialized")}observeActiveTabsCount(){return this.tabsCounterHelper.observeActiveTabsCount()}getActiveTabsCount(){return this.tabsCounterHelper.getActiveTabsCount()}postMessage(e,t){return this.basicCrossTabsService.postMessage(e,t)}subscribeToMessage(e,t){return this.basicCrossTabsService.subscribeToMessage(e,t)}areOtherTabsDetected(){return this.tabsFinderHelper.areOtherTabsDetected()}dispose(){this.basicCrossTabsService.dispose(),this.tabsCounterHelper.dispose(),this.loggingActiveTabsCountSubsciption.unsubscribe()}}var tp=i(805012);class ip extends Ue{constructor(){super(h.Yg.CreateCrossTabsService,["coreSettings","localStorage","loggerFactory","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,localStorage:i,loggerFactory:n,windowProvider:a}=e,{enableCrossTabsCommunication:s}=t.get(S.J.Core,["enableCrossTabsCommunication"]);if(s){const s=function(e,t,i){var n;try{return new ep(e,t,i)}catch(t){const i=e.newLogger("CrosstabService","services-io-browser-crosstabs"),a="Can't be initialized.";return void(null===(n=i.errorToTelemetry)||void 0===n||n.call(i,a,"cross_tabs_init_failed",void 0,!0))}}(n,a,t);e.crossTabsService=s,s&&s.subscribeToMessage("T2WebOptOut",(()=>this.onT2WebOptOut(n,i,s)))}}))}onT2WebOptOut(e,t,i){var n;const a=e.newLogger("T2WebOutOutMessageHandler","t2-web-opt-out-message-handler");null===(n=a.logNoPii)||void 0===n||n.call(a,"T2WebOptOut message received, redirecting this tab to T1");new tp.BZ(t,e,i).redirectThisTabToT1("CrossTabMessage")}}var np=i(875950),ap=i(549426);const sp=["activeCalls","activeMeetings","activeWindow","activeWindowForEntity","activeWindows","allClientPreferences","appsInstalledByCurrentUser","appsUsage","attendeeCaptionsVisibility","bannerNotificationQueue","cachedAppList","callingScreenLayout","callingScreenStatus","clientPreferences","currentCallingState","currentEspSurfaceId","espState","fetchDynamicCommandsV2","isEntityInActiveWindow","isUbarRenderComplete","localizationSettings","lockedTiles","meetingRoomFrontOfRoomCallPanelsState","meetingRoomLayoutToggleState","mostRecentlyUsedTiles","pinnedMeetings","pinnedTiles","pptSharingSession","recentMeetings","requestImmersiveReader","shouldLaunchWhiteboardOnLoad","whiteboardSharingSession","whiteboardWalkUpState"],op=["addSharedPlatformCachedApps","executeEntityCommand","changeMonitorSlotContent","changeSlotsVisibility","performWindowHistoryNavigation","navigateToWindowHistoryIndex","recordAppActionUsage","recordAppSceneUsage","recordAppUsage","removeSharedPlatformCachedApps","removeUserActiveWindows","removeWindow","resizeHeaderSlot","resizeSlotDimensions","pushToWindowHistory","removeFromWindowHistory","saveReactiveVarsToHistory","setActiveCalls","setCallingScreenLayout","setCallingScreenStatus","setUbarRenderComplete","toggleHideMyselfVideo","togglePinMyself","toggleMyselfInGrid","toggleParticipantPin","updateActiveCalls","updateAttendeeCaptionsVisibility","updateClientPreferences","updateCurrentLocale","updateEntity","updateEntityState","updateExtendedEntityContainerState","updateMeetingRoomLayoutToggleState","updateSharedPlatformCachedApps","updateShouldLaunchWhiteboardOnLoad","updateWhiteboardWalkUpState","setMeetingRoomFrontOfRoomCallPanelsState","recordEspCompletedActions","recordDisplayedSurface","recordEligibleSurface"],rp=["appsInstalledByCurrentUserEvent","appsUsageUpdateEvent","callParticipantPinnedEventv2","dynamicCommandsUpdateEvent","launchTileUpdatedEvent"],cp=["activeWindow","activeWindowForEntity","activeWindows","allClientPreferences","cachedAppList","clientPreferences","currentEspSurfaceId","espGlobalState","isEntityInActiveWindow","localizationSettings","poppedOutWindowState"],lp=[...cp,"activeCalls","activeMeetings","appsInstalledByCurrentUser","appsUsage","bannerNotificationQueue","callingScreenLayout","callingScreenStatus","currentCallingState","fetchDynamicCommandsV2","lockedTiles","meetingRoomLayoutToggleState","mostRecentlyUsedTiles","pinnedMeetings","pinnedTiles","pptSharingSession","recentMeetings","requestImmersiveReader","whiteboardSharingSession","espState"],dp=["addSharedPlatformCachedApps","executeEntityCommand","changeMonitorSlotContent","changeSlotsVisibility","removeWindow","setPoppedOutWindowState","resizeHeaderSlot","performWindowHistoryNavigation","navigateToWindowHistoryIndex","removeSharedPlatformCachedApps","removeUserActiveWindows","resizeSlotDimensions","pushToWindowHistory","removeFromWindowHistory","saveReactiveVarsToHistory","updateClientPreferences","updateCurrentLocale","updateEntity","updateEntityState","updateExtendedEntityContainerState","updateSharedPlatformCachedApps","setEspGlobalState","createNotificationsWindow","removeNotificationsWindow"],up=[...dp,"setActiveCalls","setCallingScreenLayout","setCallingScreenStatus","toggleParticipantPin","toggleHideMyselfVideo","toggleMyselfInGrid","togglePinMyself","updateActiveCalls","updateMeetingRoomLayoutToggleState","recordEspCompletedActions","recordDisplayedSurface","recordEligibleSurface","recordAppActionUsage","recordAppSceneUsage","recordAppUsage"],mp=[],gp=[...mp,"appsInstalledByCurrentUserEvent","appsUsageUpdateEvent","callParticipantPinnedEventv2","callHideMyselfVideoEvent","dynamicCommandsUpdateEvent","launchTileUpdatedEvent","callMyselfVideoPinnedEvent"],hp=["chat","messages","installedAppsV2"],pp=[...sp,"lpcState","pinnedChannels","joinedTeamsAndChannels"],vp=(e,t,i)=>{const n=(0,np.p$)(e),{operation:a,selectionSet:{selections:s},variableDefinitions:o}=n,r=bp[a],c=(null==o?void 0:o.some((e=>!!e.defaultValue)))?function(e,t={}){const i={};for(const n of e){const e=n.variable.name.value;t.hasOwnProperty(e)?i[e]=t[e]:n.defaultValue&&(i[e]=(0,ap.M)(n.defaultValue))}return i}(o,t):t;return s.filter((e=>"Field"===e.kind&&!pp.includes(e.name.value))).map((e=>({id:r,fieldName:e.name.value,args:fp(e,c),schemaId:i})))};function fp(e,t){var i;if(!(null===(i=null==e?void 0:e.arguments)||void 0===i?void 0:i.length))return;const n={};for(const i of e.arguments){const e=(0,ap.M)(i.value,t);void 0!==e&&(n[i.name.value]=e)}return n}const bp={query:"ROOT_QUERY",mutation:"ROOT_MUTATION",subscription:"ROOT_SUBSCRIPTION"};var yp;!function(e){e[e.DefaultSchema=0]="DefaultSchema",e[e.ViewSchema=1]="ViewSchema"}(yp||(yp={}));var kp=i(208167);const Sp=i(79799);var wp=i(733879);class jp{constructor(e){this._inactiveOperations=new Map,this._forcedActiveOperations=new Map,this._windowToDataMap=new Map,this._dataToWindowMap=new Map,this._activeOperations=(null==e?void 0:e.activeOperationLimit)?new wp.Z({maxSize:e.activeOperationLimit,onEviction:this.markLeastRecentlyUsedOperation.bind(this)}):new Map}trackOperation(e,t,i=yp.DefaultSchema,n){const{fetchPolicy:a,variables:s}=e,o=e.query||e.mutation;if("no-cache"===a)return;if(e.mutation&&!e.keepRootFields)return;vp(o,s,i).forEach((e=>{const i=(e=>{const t=Sp(e);return(0,kp.Z)(t)})(e);this._activeOperations.set(i,e),"boolean"==typeof n&&this.forceActive(i,n),this.addDataForWindow(t,i),this._inactiveOperations.has(i)&&this._inactiveOperations.delete(i)}))}markDataForWindowAsInactive(e){const t=this._windowToDataMap.get(e)||[];this._windowToDataMap.delete(e),t.forEach((t=>{const i=this._dataToWindowMap.get(t);if(i&&(i.delete(e),i.size))return;const n=this._activeOperations.get(t);n&&this._inactiveOperations.set(t,n),this._dataToWindowMap.delete(t),this._activeOperations.delete(t)}))}flush(e=this._inactiveOperations.size){const t=[],i=[];let n=0;return this._inactiveOperations.forEach(((a,s)=>{n>=e||(t.push(a),i.push(s),hp.includes(a.fieldName)&&(n=e),n++)})),i.forEach((e=>this._inactiveOperations.delete(e))),{descriptors:t,hasMore:!!this._inactiveOperations.size}}DEBUG_ONLY_getInactiveOperations(){return this._inactiveOperations}addDataForWindow(e,t){let i=this._windowToDataMap.get(e);i||(i=new Set,this._windowToDataMap.set(e,i)),i.add(t);let n=this._dataToWindowMap.get(t);n||(n=new Set,this._dataToWindowMap.set(t,n)),n.add(e)}forceActive(e,t){var i;const n=(null!==(i=this._forcedActiveOperations.get(e))&&void 0!==i?i:0)+(t?1:-1);0!==n?this._forcedActiveOperations.set(e,n):this._forcedActiveOperations.delete(e)}markLeastRecentlyUsedOperation(e,t){var i;(null!==(i=this._forcedActiveOperations.get(e))&&void 0!==i?i:0)>0?this._activeOperations.set(e,t):this._inactiveOperations.set(e,t)}}class Cp{constructor(e,t,i,n){this.dataOpsRepository=e,this.scenarioFactory=t,this.windowProvider=n,this.clients=new Set,this.logger=i.newLogger("EvictionService","data-client-core")}register(e){this.clients.add(e)}unregister(e){this.clients.delete(e)}evict(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.lastEvictionResult={entriesEvicted:0,entriesNotEvicted:0,entriesGCed:0};let e=!0;do{e=yield this.evictByWindowRequestIdleCallback()}while(e)}))}DEBUG_ONLY_getInactiveOperations(){return this.dataOpsRepository.DEBUG_ONLY_getInactiveOperations()}DEBUG_ONLY_getClients(){return this.clients}DEBUG_ONLY_lastResult(){return this.lastEvictionResult}evictByWindowRequestIdleCallback(){return new Promise((e=>{this.windowProvider.requestIdleCallback((t=>{let i=!1,n=0;do{const e=performance.now(),a=t.timeRemaining();this.logger.debug("Time remaining at start",a);const s=this.scenarioFactory.newScenario(z.RG.CacheEviction);i=this.evictInternal(s);const o=t.timeRemaining(),r=performance.now();n=o>0?o:a-(r-e);const c={"Eviction.TimeRemaining":n};s.stop(c),this.logger.debug("Time remaining at end",n)}while(i&&n>10);e(i)}))}))}evictInternal(e){const{descriptors:t,hasMore:i}=this.dataOpsRepository.flush(10);let n=0,a=0;const s=this.groupCachesBySchema(),o=new Set;t.forEach((e=>{var t;const i=null!==(t=s.get(e.schemaId))&&void 0!==t?t:[];let r=!1;i.forEach((t=>{t.evict(e)&&(o.add(t),r=!0)})),r?n++:a++}));const r={"Eviction.EntriesEvicted":n,"Eviction.EntriesNotEvicted":a};e.mark("eviction",r);let c=0;o.forEach((e=>{const t=e.gc();c+=t.length}));const l={"Eviction.EntriesCollected":c};return e.mark("gc",l),this.logger.debug("Eviction results",{entriesEvicted:n,entriesNotEvicted:a,entriesGCed:c}),this.lastEvictionResult&&(this.lastEvictionResult.entriesEvicted+=n,this.lastEvictionResult.entriesNotEvicted+=a,this.lastEvictionResult.entriesGCed+=c),i}groupCachesBySchema(){const e=new Map;return this.clients.forEach((t=>{let i=e.get(t.schemaId);i||(i=new Set,e.set(t.schemaId,i)),i.add(t.cache)})),e}}var _p,Tp,Ip=i(561264);!function(e){e.core="core",e.window="window",e.mtmaCore="mtmaCore",e.mtmaUser="mtmaUser",e.mtmaWindow="mtmaWindow",e.viewSchema="viewSchema",e.embed="embed",e.cmd="cmd",e.other="other"}(_p||(_p={})),function(e){e.query="query",e.watchQuery="watchQuery",e.mutate="mutate",e.subscribe="subscribe",e.readQuery="readQuery",e.writeQuery="writeQuery",e.readFragment="readFragment",e.writeFragment="writeFragment"}(Tp||(Tp={}));var Np=i(801470),Ep=i(540780),Fp=i(286795),xp=i(490003),Dp=i(721589);class Ap extends Dp.h{constructor(e,t){super(e),this.definitionOverflowLogged=new Set,this.isDuplicateWrite=e=>this.lastWrite&&this.lastDiff&&this.lastWrite===this.lastDiff.precedingWrite&&e.result===this.lastDiff.result;const{loggerFactory:i,scenarioFactory:n,graphqlStoreStatsReporterService:a,storeType:s,enableApolloDoubleWriteFix:o}=t;this.storeType=s,this.enableApolloDoubleWriteFix=o,i&&(this.logger=i.newLogger("InMemoryCacheWrapper","frameworks-apollo")),n&&(this.scenarioFactory=n),a&&(this.graphqlStoreStatsReporterService=a)}write(e){var t,i,n,a,s,o,r;let c,l=0;try{if(this.lastWrite&&this.isDuplicateWrite(e)&&(null===(t=this.graphqlStoreStatsReporterService)||void 0===t||t.markDuplicateWrite(this.storeType,e.query,null!==(i=this.lastWrite.elapsed)&&void 0!==i?i:0),this.enableApolloDoubleWriteFix))return this.lastWrite.result;c=null===(n=this.graphqlStoreStatsReporterService)||void 0===n?void 0:n.markWriteStart(this.storeType,e.query);const o=super.write(e);return c&&(l=null!==(s=null===(a=this.graphqlStoreStatsReporterService)||void 0===a?void 0:a.markWriteEnd(c))&&void 0!==s?s:0),this.lastWrite={result:o,elapsed:l},o}catch(e){throw null===(o=this.logger)||void 0===o||o.error(e.message),c&&(null===(r=this.graphqlStoreStatsReporterService)||void 0===r||r.markWriteError(c)),e}}read(e){var t,i;let n;try{n=null===(t=this.graphqlStoreStatsReporterService)||void 0===t?void 0:t.markReadStart(this.storeType,e.query);const a=super.read(e);return n&&(null===(i=this.graphqlStoreStatsReporterService)||void 0===i||i.markReadEnd(n)),a}finally{this.logResultCacheOverflowOnce("read",e.query)}}modify(e){var t,i,n,a;let s;try{s=null===(t=this.graphqlStoreStatsReporterService)||void 0===t?void 0:t.markWriteStart(this.storeType,`modify ${e.id||"ROOT_QUERY"}`);const n=super.modify(e);return s&&(null===(i=this.graphqlStoreStatsReporterService)||void 0===i||i.markWriteEnd(s)),n}catch(e){throw null===(n=this.logger)||void 0===n||n.error(e.message),s&&(null===(a=this.graphqlStoreStatsReporterService)||void 0===a||a.markWriteError(s)),e}}diff(e){var t,i;let n;try{n=null===(t=this.graphqlStoreStatsReporterService)||void 0===t?void 0:t.markDiffStart(this.storeType,e.query);const a=super.diff(e);return n&&(null===(i=this.graphqlStoreStatsReporterService)||void 0===i||i.markDiffEnd(n)),this.lastDiff={result:a.result,precedingWrite:this.lastWrite},a}finally{this.logResultCacheOverflowOnce("diff",e.query)}}logResultCacheOverflowOnce(e,t){var i,n,a,s,o;const r=t.definitions[0],c=this.getLastResultCacheOverflow();if(!this.scenarioFactory||c<=0||"OperationDefinition"!==r.kind)return;let l;if(r.name||1!==r.selectionSet.selections.length||"FragmentSpread"!==r.selectionSet.selections[0].kind){l={definitionKind:"query",definitionName:null!==(o=null===(s=r.name)||void 0===s?void 0:s.value)&&void 0!==o?o:"(unnamed)",overflowSize:c,method:e}}else{l={definitionKind:"fragment",definitionName:null!==(a=null===(n=null===(i=r.selectionSet.selections[0])||void 0===i?void 0:i.name)||void 0===n?void 0:n.value)&&void 0!==a?a:"",overflowSize:c,method:e}}const d=`${l.definitionKind}-${l.definitionName}`;if(!this.definitionOverflowLogged.has(d)){this.scenarioFactory.createScenarioWithoutStarting(z.RG.ApolloResultCacheOverflow).stop(l),this.definitionOverflowLogged.add(d)}}getLastResultCacheOverflow(){var e,t,i;return(null!==(i=(null!==(t=(null!==(e=this.storeReader)&&void 0!==e?e:{}).executeSelectionSet)&&void 0!==t?t:{}).__DEBUG_ONLY_optimismCache)&&void 0!==i?i:{}).__DEBUG_ONLY_lastOverflow||0}}const Mp=Ap,Pp=(e={})=>{const{apolloLeakOptions:t,cache:i,loggerFactory:a,scenarioFactory:s,enableApolloDevtools:o,enableApolloDoubleWriteFix:r,storeType:c=_p.other,graphqlStoreStatsReporterService:l}=e,d=(0,n.__rest)(e,["apolloLeakOptions","cache","loggerFactory","scenarioFactory","enableApolloDevtools","enableApolloDoubleWriteFix","storeType","graphqlStoreStatsReporterService"]),u=new xp.f(Object.assign(Object.assign({},d),{cache:i||Op({apolloLeakOptions:t,loggerFactory:a,scenarioFactory:s,storeType:c,graphqlStoreStatsReporterService:l,enableApolloDoubleWriteFix:r}),assumeImmutableResults:!0,connectToDevTools:Boolean(o)}));return Rp(u,t),u},Op=(e={})=>{var t,{apolloLeakOptions:i,loggerFactory:a,scenarioFactory:s,graphqlStoreStatsReporterService:o,storeType:r,enableApolloDoubleWriteFix:c}=e,l=(0,n.__rest)(e,["apolloLeakOptions","loggerFactory","scenarioFactory","graphqlStoreStatsReporterService","storeType","enableApolloDoubleWriteFix"]);const d={loggerFactory:a,scenarioFactory:s,graphqlStoreStatsReporterService:o,storeType:r||_p.other,enableApolloDoubleWriteFix:c},u=new Mp(l,d);return null===(t=null==i?void 0:i.leakDetector)||void 0===t||t.track(vs.I.ApolloCache,u),Rp(u,i),u},Rp=(e,{userContextId:t,windowId:i,entityType:n,viewportContext:a}={})=>{e.apolloLeakInfo={apolloLeakInfoStartTime:(new Date).toISOString(),apolloLeakInfoEntityType:n,apolloLeakInfoUserContextId:t,apolloLeakInfoViewportContext:a,apolloLeakInfoWindowId:i}},Lp=e=>{e.apolloLeakInfo||(e.apolloLeakInfo={}),e.apolloLeakInfo.apolloLeakInfoEndTime=(new Date).toISOString()};var Up=i(275831),$p=i(809995),Wp=i(639533);function Bp(e){return function(t,{args:i,toReference:n,canRead:a}){if(a(t))return t;const s=e(i);return a(s)?n(s):void 0}}const zp={merge:["prejoinState","callTranscriptState","activeWindow","activeWindowForEntity","messages","userPreferences"],replace:["activeWindows","callingAlerts","workWeekDays","dateRange","activeCalls","listBreakoutRoomsWithDetails"]},Hp={Query:{fields:Object.assign(Object.assign({user:Bp((e=>({__typename:"User",id:null==e?void 0:e.userId}))),presence:Bp((e=>({__typename:"Presence",id:`${null==e?void 0:e.userId}_ups`}))),call:Bp((e=>({__typename:"Call",id:null==e?void 0:e.id}))),streamDetails:Bp((e=>({__typename:"StreamDetailsInfo",id:null==e?void 0:e.id}))),breakoutRoomsDetails:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]],read:Bp((e=>({__typename:"BreakoutRoomsDetails",id:null==e?void 0:e.coordinates.threadId})))},extensibilityAppPicker:{keyArgs:["scope","conversationId","config"]},searchForMentionV2:{keyArgs:["teamId","searchQuery","includeBots","channelText","teamText","generalText","channelType","hostTenantId","enableScheduledTags","enableOwnersTag"]},breakoutRoomSettings:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]]},listBreakoutRoomsWithDetails:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]]},breakoutRoomsClientState:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]]},localizationSettings:{keyArgs:["currentLocale"]},searchConversation:{keyArgs:["searchTerm","conversationId","filters"],merge:(e,t)=>t?e?Object.assign(Object.assign({},t),{Results:[...e.Results,...t.Results]}):t:e},myGroupSettings:{merge:(e,t)=>{if(!t)return[...e];if(!e)return[...t];const i=t[0],n=e[0];return[Object.assign(Object.assign({},i),n)]}}},zp.merge.reduce(((e,t)=>Object.assign({[t]:{merge:!0}},e)),{})),zp.replace.reduce(((e,t)=>Object.assign({[t]:{merge:!1}},e)),{}))},Subscription:{fields:{chatServiceEvent:{merge:!1},callRecordingStateChangedEvent:{merge:!1},callingServiceEvent:{merge:!1}}},CallParticipantsCounts:{keyFields:["teamsCallId"]},ParticipantCountsChanged:{keyFields:["teamsCallId"]},ParticipantsChanged:{keyFields:["teamsCallId"]},MessagesResult:{keyFields:!1},WindowHistoryItem:{keyFields:!1},SelectedDevices:{keyFields:!1},Window:{fields:{windowHistory:{merge:!1},activeEntities:{merge:!0},correlation:{merge:!0},extendedEntityContainerState:{merge:!0}}},DeviceList:{fields:{cameras:{merge:!1},camerasSupportingAutoFraming:{merge:!1},microphones:{merge:!1},selectedDevices:{merge:!0}}},Call:{fields:{extendedCallType:{merge:!0},capabilities:{merge:!0},breakoutRoomDetails:{merge:!0}}},RoomCoordinates:{keyFields:["threadId"]},BasicParticipant:{keyFields:["participantId"]},BreakoutRoomsDetails:{fields:{breakoutRooms:{merge:!1}}},BreakoutRoom:{fields:{clientActionState:{read:e=>e||null},participants:{merge:!1}}},CalendarEvent:{keyFields:["objectId"]},InDayEvents:{keyFields:["mailboxAddress","date"],fields:{events:{merge:!1}}},AllDayEvents:{keyFields:["mailboxAddress","date"],fields:{events:{merge:!1}}},Building:{keyFields:["address"]},RecurrenceEvents:{keyFields:["mailboxAddress","cleanGlobalObjectId"]},MeetingCompositeKey:{keyFields:["conversationId","messageId","eventId","modifiedStamp"]},Translation:{keyFields:!1},DiagnosticInfo:{keyFields:!1},EmailUser:{keyFields:["smtp"]},AuthenticationUserProfile:{keyFields:["objectId","tenantId"]},FluidPendingMention:{keyFields:["atMentionId"]},Participant:{keyFields:["participantId"]},Rectangle:{keyFields:!1},AudienceSceneExtent:{keyFields:!1},AudienceSceneParticipant:{keyFields:!1},ChatMessageMentionType:{keyFields:!1},Feed:{fields:{section:{keyArgs(e,{variables:t}){if(t)return t.section},merge(e,t){var i,n,a,s;return e?(null===(i=null==t?void 0:t.deltaRequestDetails)||void 0===i?void 0:i.deltaRequestId)&&t.deltaRequestDetails.deltaRequestId===(null==e?void 0:e.requestId)?Object.assign(Object.assign({},t),{dataReceivedOnClientTimestamp:e.dataReceivedOnClientTimestamp,items:[...e.items,...t.items]}):(null===(n=null==t?void 0:t.deltaRequestDetails)||void 0===n?void 0:n.deltaRequestId)===(null===(a=null==e?void 0:e.deltaRequestDetails)||void 0===a?void 0:a.deltaRequestId)&&(null==t?void 0:t.requestId)===(null==e?void 0:e.requestId)?t:(null===(s=t.deltaRequestDetails)||void 0===s?void 0:s.deltaRequestId)?e:t:t}}}},FeedItemType:{keyFields:["uri"]},FilesListResult:{keyFields:["threadId"]},PaymentDetails:{keyFields:["eventId"]},Channel:{fields:{defaultFileSettings:{merge:!0},membershipSummary:{merge:!0},spaceAdminSettings:{merge:!0}}},Team:{fields:{membershipSummary:{merge:!0},teamSettings:{merge:!0},teamGuestSettings:{merge:!0},teamSiteInformation:{merge:!0},sensitivityLabel:{merge:!0}}},TeamSettings:{fields:{funControl:{merge:!0}}}};function qp(e,t,i,n,a){if(i){const{config:{publicPath:i,buildType:s,buildVersion:o}}=n;if(!i)return;const r=window;if(r.__APOLLO_CLIENTS__||(r.__APOLLO_CLIENTS__=[]),r.__APOLLO_KEY_FIELDS__||(r.__APOLLO_KEY_FIELDS__=function(){const e={};for(const t of Object.keys(Hp))Hp[t].keyFields&&(e[t]=Hp[t].keyFields);return e}()),"production"===s)"multi-window"===a?r.__REMPL_APOLLO_DEVTOOLS_URL__=`/multi-window/apollo-devtools?version=${o}`:"react-web-client"===a&&(r.__REMPL_APOLLO_DEVTOOLS_URL__="/v2/apollo-devtools");else{const e=i.endsWith("/")?i:i.concat("/");r.__REMPL_APOLLO_DEVTOOLS_URL__=`${e}apollo-devtools.html`}r.__APOLLO_GLOBAL_OPERATIONS__||(r.__APOLLO_GLOBAL_OPERATIONS__={globalMutations:op,globalQueries:sp,globalSubscriptions:rp}),r.__APOLLO_CLIENTS__.push({client:e,clientId:t})}}class Vp extends Error{constructor(e,t){super(`Accessing client ${e}/${t} after destroy`)}}const Gp=new $p.i((()=>{throw new Error("This client has been destroyed!")}));class Jp{constructor(e,t,i,n,a){var s,o;this.name=n,this.storeType=a,this.disposed=!1,this.schemaId=yp.DefaultSchema,this.ctx=t,this.services=e,this._client=i,null===(s=this.services.leakDetector)||void 0===s||s.track(vs.I.DataClient,this),this.services.dataOpsTracker&&this.setupWatchQueryTracking(this.client),this.services.dataEvictionService&&(null===(o=this.services.dataEvictionService)||void 0===o||o.register(this)),this.registerClient(this.client)}get client(){if(!this._client)throw new Vp(this.constructor.name,this.name);return this._client}get cache(){return this.client.cache}updateContext(e,t){var i;this.ctx=e,null===(i=this._client)||void 0===i||i.setLink(t)}destroy(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){(null===(e=this.services)||void 0===e?void 0:e.dataEvictionService)&&this.services.dataEvictionService.unregister(this),yield this.destroyClient(),this.ctx=void 0,this.services=void 0}))}clearCache(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield null===(e=this._client)||void 0===e?void 0:e.clearStore()}))}getServices(){return this.services}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:null,selfIsMainClient:!1}}mutate(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=this.getApolloClientInstance(e.mutation);null===(t=this.maybeGetGraphQLStoreStatsReporterService(i))||void 0===t||t.trackCall(this.storeType,Tp.mutate);const n=this.patchOptions(e),a=yield i.mutate(n);return this.trackReadOperation(i,e),a}))}query(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=this.getApolloClientInstance(e.query);null===(t=this.maybeGetGraphQLStoreStatsReporterService(i))||void 0===t||t.trackCall(this.storeType,Tp.query);const n=this.patchOptions(e),a=yield i.query(n);return this.trackReadOperation(i,e),a}))}readQuery(e,t){var i;const n=this.getApolloClientInstance(e.query);null===(i=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===i||i.trackCall(this.storeType,Tp.readQuery);const a=n.readQuery(e,t);return this.trackReadOperation(n,e),a}subscribe(e){var t;const i=this.getApolloClientInstance(e.query);return null===(t=this.maybeGetGraphQLStoreStatsReporterService(i))||void 0===t||t.trackCall(this.storeType,Tp.subscribe),i.subscribe(e).map((t=>{var n;return this.trackReadOperation(i,e),null===(n=this.maybeGetGraphQLStoreStatsReporterService(i))||void 0===n||n.trackSubscribeEvent(this.storeType),t}))}watchQuery(e){var t;try{const i=this.getApolloClientInstance(e.query);null===(t=this.maybeGetGraphQLStoreStatsReporterService(i))||void 0===t||t.trackCall(this.storeType,Tp.watchQuery);const n=this.patchOptions(e);return i.watchQuery(n)}catch(e){return new Wp.y((t=>t.error(e)))}}writeQuery(e){var t;const i=this.getApolloClientInstance(e.query);return null===(t=this.maybeGetGraphQLStoreStatsReporterService(i))||void 0===t||t.trackCall(this.storeType,Tp.writeQuery),this.trackWriteOperation(i,e),i.writeQuery(e)}writeFragment(e){var t;const i=this.getApolloClientInstance(e.fragment);return null===(t=this.maybeGetGraphQLStoreStatsReporterService(i))||void 0===t||t.trackCall(this.storeType,Tp.writeFragment),this.trackWriteOperation(i,e),i.writeFragment(e)}readFragment(e,t){var i;const n=this.getApolloClientInstance(e.fragment);return null===(i=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===i||i.trackCall(this.storeType,Tp.readFragment),n.readFragment(e,t)}get defaultOptions(){return this.client.defaultOptions}set defaultOptions(e){this.client.defaultOptions=e}get disableNetworkFetches(){return this.client.disableNetworkFetches}set disableNetworkFetches(e){this.client.disableNetworkFetches=e}getApolloClientInstance(e){return this.client}patchOptions(e){const{context:t,patched:i}=e,a=(0,n.__rest)(e,["context","patched"]);return i?e:Object.assign(Object.assign({},a),{context:t?Object.assign(Object.assign({},this.ctx),t):this.ctx,patched:!0})}registerClient(e){e.dataClients||(e.dataClients=[]),e.dataClients.push(this)}unregisterClient(e){var t,i,n;return e.dataClients=null===(t=e.dataClients)||void 0===t?void 0:t.filter((e=>e!==this)),0===(null!==(n=null===(i=e.dataClients)||void 0===i?void 0:i.length)&&void 0!==n?n:0)}disposeClient(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=this.unregisterClient(e);if(n&&(Lp(e),Lp(e.cache),function(e){let t=window;for(t.__APOLLO_CLIENTS__&&(t.__APOLLO_CLIENTS__=t.__APOLLO_CLIENTS__.filter((t=>t.client!==e)));t;)t.__APOLLO_DEVTOOLS_GLOBAL_HOOK__&&t.__APOLLO_DEVTOOLS_GLOBAL_HOOK__.ApolloClient===e&&(t.__APOLLO_DEVTOOLS_GLOBAL_HOOK__.ApolloClient=void 0),t.__APOLLO_CLIENT__&&t.__APOLLO_CLIENT__===e&&(t.__APOLLO_CLIENT__=void 0),t=t.parent===t?null:t.parent}(e)),n&&t){const{scenarioFactory:t}=null!==(i=this.services)&&void 0!==i?i:{},n=null==t?void 0:t.newScenario(z.RG.ApolloClientDisposion);try{e.stop(),yield e.clearStore(),e.setLink(Gp),e.setResolvers([]),null==n||n.stop()}catch(e){null==n||n.fail({reason:String(e)})}}}))}disposeClients(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this._client&&(yield this.disposeClient(this._client,e),e&&(this._client=void 0))}))}destroyClient(){var e,t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.disposed){this.disposed=!0;const{enableApolloClientDisposion:i}=null!==(t=null===(e=this.services)||void 0===e?void 0:e.coreSettings.get(S.J.Core))&&void 0!==t?t:{};yield this.disposeClients(null!=i&&i)}}))}setupWatchQueryTracking(e){const t=e.cache;if(Jp.patchedCaches.has(t))return;const i=t.watch;t.watch=(n,...a)=>{this.trackReadOperation(e,n,!0);const s=i.call(t,n,...a);return()=>(this.trackReadOperation(e,n,!1),s())},Jp.patchedCaches.set(t,i)}trackReadOperation(e,t,i){var n;this.ctx&&this.services&&(e instanceof Jp||null===(n=this.services.dataOpsTracker)||void 0===n||n.trackOperation(t,this.name,this.schemaId,i))}trackWriteOperation(e,t){var i;this.ctx&&this.services&&(e instanceof Jp||null===(i=this.services.dataReleaseService)||void 0===i||i.trackWriteOperation(t))}maybeGetGraphQLStoreStatsReporterService(e){var t,i;return e instanceof Jp||!(null===(t=this.services)||void 0===t?void 0:t.graphqlStoreStatsReporterService)?null:null===(i=this.services)||void 0===i?void 0:i.graphqlStoreStatsReporterService}}Jp.patchedCaches=new WeakMap;const Kp=e=>e;class Qp extends Jp{constructor(e,t,i,n,a,s){super(e,n,i,a||"INVALID",s),this.parent=t}getApolloClientInstance(e){const t=(0,np.p$)(e);if("OperationDefinition"===t.kind||"FragmentDefinition"===t.kind){const{selectionSet:{selections:i}}=t,n=this.getSharedGlobalOperationsList(t),a=i.map((e=>"Field"===e.kind&&-1===n.indexOf(e.name.value)));if(a.every(Kp))return this.client;if(a.some(Kp)){const t=(0,oe.Tr)(this.className,h.jK.InvalidInput,"route",{operation:e},"Operation contains mix of shared and window private selections");throw console.log(t),t}}return this.parent}getSharedGlobalOperationsList(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation?this.parentMutations:"OperationDefinition"===e.kind&&"subscription"===e.operation?this.parentSubscriptions:this.parentQueries}}class Yp extends Qp{constructor(e,t,i,n,a){super(e,t,i,n,n.windowId,a)}get parentQueries(){return sp}get parentSubscriptions(){return rp}get parentMutations(){return op}get className(){return"ChildDataClient"}clone(e){throw new Error("Trying to clone child instance")}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:this.parent.__UNSAFE_getApolloClientReferencesForDebugPanel().self,selfIsMainClient:!1}}}class Xp extends Jp{constructor(e,t,i,n){super(e,i,t,i.windowId||"INVALID",n)}clone(e){throw new Error("Trying to clone child instance")}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:null,selfIsMainClient:!!this.ctx&&this.ctx.windowId===h.ew}}}class Zp extends Xp{constructor(){super(...arguments),this.schemaId=yp.ViewSchema}subscribe(e){const t=this.getApolloClientInstance(e.query),i=this.patchOptions(e);return t.subscribe(i)}}var ev=i(535425);class tv extends Jp{constructor(e,t,i,n){super(e,i,t({windowId:i.windowId||h.ew,entityType:i.entityType,viewportContext:i.windowProvider.viewportContext,name:"core",storeType:_p.core}),i.windowId||h.ew,_p.core),this.createApolloClient=t,this.overrideLink=null,this.viewSchemaClient=null,this.overrideLink=null,n&&(this.viewSchemaClient=n({windowId:i.windowId||h.ew,entityType:i.entityType,viewportContext:i.windowProvider.viewportContext,name:"core-viewSchema",storeType:_p.viewSchema}),this.registerClient(this.viewSchemaClient))}updateContext(e,t){super.updateContext(e,t),this.overrideLink=t}clone(e){return e.windowId===h.ew?new Xp(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.storeType):new Yp(this.getServices(),this,this.createApolloClient({windowId:e.windowId,entityType:e.entityType,viewportContext:e.windowProvider.viewportContext,name:`child-${e.windowId}`,overrideLink:this.overrideLink,storeType:_p.window}),Object.assign(Object.assign({},this.ctx),e),_p.window)}cloneForViewSchema(e){return ev(this.viewSchemaClient,"View schema must be avaliable"),new Zp(this.getServices(),this.viewSchemaClient,Object.assign(Object.assign({},this.ctx),e),_p.viewSchema)}disposeClients(e){const t=Object.create(null,{disposeClients:{get:()=>super.disposeClients}});return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all([t.disposeClients.call(this,e),(()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){this.viewSchemaClient&&(yield this.disposeClient(this.viewSchemaClient,e),e&&(this.viewSchemaClient=null))})))()])}))}}class iv extends Jp{constructor(e,t,i){super(e,i,t,i.windowId||h.ew,_p.embed)}clone(e){return new Xp(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.storeType)}}var nv=i(999207),av=i(551414),sv=i(571908);const ov={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"WriteCallingDefaults"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingDebugTool"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visible"}},{kind:"Field",name:{kind:"Name",value:"passiveBarHiddenParticipantsCount"}}]}},{kind:"Field",name:{kind:"Name",value:"streamPermissionsDebug"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"acknowledged"}},{kind:"Field",name:{kind:"Name",value:"acknowledgementRequired"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}},{kind:"Field",name:{kind:"Name",value:"pptSharingSession"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"_"}}]}},{kind:"Field",name:{kind:"Name",value:"isFake"}},{kind:"Field",name:{kind:"Name",value:"calls"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};const rv={callingDebugTool:{__typename:"CallingDebugTool",visible:!0,passiveBarHiddenParticipantsCount:0},streamPermissionsDebug:{__typename:"StreamPermissionsDebug",acknowledged:!1,acknowledgementRequired:!1,url:"https://www.microsoft.com/"},pptSharingSession:{__typename:"ActivePptSession",_:!1},isFake:!1,calls:[]},cv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"lpcState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}},{kind:"Field",name:{kind:"Name",value:"lastLoggedInUserMri"}}]}}]}}]},lv={Query:{lpcState:(e,t,{cache:i})=>i.readQuery({query:cv})},Mutation:{setLpcState(e,{newLpcState:t},{cache:i}){const n={lpcState:Object.assign(Object.assign({},t),{__typename:"LpcState"})};return i.writeQuery({query:cv,data:n}),n.lpcState}}};var dv=i(273586);const uv=(e,t,i)=>{(0,dv.k)(e),function(e,t){const i=t.newLogger("writeCallingDefaults","data-client-calling");(0,nv.tW)(e),(0,nv.bC)(e);try{e.writeQuery({query:ov,data:rv})}catch(e){i.error(`Fail to write calling defaults - ${e}`)}try{e.writeQuery({query:av.a,data:{shouldShowVideoEffectsPreview:!1}})}catch(e){i.error(`Fail to write default value of shouldShowVideoEffectsPreview - ${e}`)}try{e.writeQuery({query:sv.z,data:{shouldKeepPreviewWindowInSidePanelOpen:!1}})}catch(e){i.error(`Fail to write default value of shouldKeepPreviewWindowInSidePanelOpen - ${e}`)}}(e,t),function(e){e.writeQuery({query:cv,data:{lpcState:{__typename:"LpcState",isLivePersonaCardInitialized:!1,lastLoggedInUserMri:null}}})}(e),i&&mv(e,i,t)},mv=(e,t,i)=>{const n=i.newLogger("appDefaults","data-client-core"),a=t.length;n.log(`Writing ${a.toString()} app default values to the Apollo cache.`),t.forEach((t=>{var i,a;try{const{queryFieldName:i,gqlTypeName:n}=t,a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:`${n}DefaultQuery`},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:i},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}}]},s={[i]:{__typename:n}};e.writeQuery({query:a,data:s})}catch(e){const s=`Failed to write ${t.gqlTypeName} to cache as Query field ${t.queryFieldName}.`;null!==(a=null===(i=n.errorToTelemetry)||void 0===i?void 0:i.call(n,s,"webclient_framework_foundation_core_services_active_application_hooks",void 0,!0))&&void 0!==a||n.error(s)}}))};class gv extends Ed{constructor(e){super(),this.shellWindow=e,this.shellWindow.opener.addEventListener(L.rY.CentralDataLayerResponse,(e=>{this.onResponseReceived(e)}))}sendMessage(e){this.shellWindow.opener.postMessage(L.rY.CentralDataLayerRequest,{dataLayer:e})}}function hv(e){return new $p.i((t=>{const{query:i,variables:n,operationName:a}=t,s=t.getContext(),o={callerInfo:null==s?void 0:s.callerInfo,callerScenarioId:null==s?void 0:s.callerScenarioId};return e.execute(i,n,a,null==s?void 0:s.rendererId,null==s?void 0:s.windowId,o)}))}const pv={mutation:new Set(["notifyWorkerSyncCanStart","notifyActiveContextChangedToCDLWorker"]),query:new Set,subscription:new Set};var vv=i(19184),fv=i(431467);function bv({resolvers:e,contextValue:t}){return new $p.i(((i,n)=>{const a=function(e,t){const{query:i}=e,n=(0,np.p$)(i);if("OperationDefinition"!==n.kind)return;const{operation:a,selectionSet:{selections:s}}=n;if("mutation"!==a)return;const o=function(e,t){let i;return e.forEach((e=>{if("Field"===e.kind){const n=function(e,t){let i;return t.forEach((({Mutation:t})=>{t[e]&&(i=i||t[e])})),i}(e.name.value,t);if(n){if(i)throw new Error("There cannot be more than 1 matching forward resolver for a document");i={selection:e,resolver:n}}}})),i}(s,t);if(!o)return;return function(e){if(!e.arguments.every((({name:e,value:t})=>"Variable"!==t.kind||t.name.value===e.value))){const t=e.arguments.map((e=>e.name.value)).join(","),i=e.arguments.map((e=>e.value.name.value)).join(",");throw new Error(`Argument name mismatch. Mutation queries, which have forward mutation resolvers should \n                    have a 1-1 name match between the document variable names and the field resolver variable names.\n                    Allowed argument names ${t} does not match the supplied argument names ${i}`)}}(o.selection),o.resolver}(i,e);if(!a)return n(i);const s=i.getContext();return(0,fv.p)(a(i.variables,Object.assign(Object.assign({},t),s))).flatMap((e=>(i.variables=e,n(i))))}))}var yv=i(513830);function kv(){return new $p.i(((e,t)=>t(e).map((t=>{if(!t.data||!e.query)return t;const{definitions:i}=e.query,n=i.find((e=>e.kind===yv.h.OPERATION_DEFINITION));if(!n||!n.selectionSet)return t;try{const e=n.selectionSet.selections,i=Sv(wv(t.data),e);return t.data=i,t}catch(e){return t}}))))}function Sv(e,t){for(const i of t){if(i.kind!==yv.h.FIELD)continue;const t=i.name.value;if("__typename"!==t)if(t in e){if(null!==e[t]&&i.selectionSet&&i.selectionSet.selections){e[t]=wv(e[t]);const n=i.selectionSet.selections;Sv(e[t],n)}}else e[t]=null}return e}function wv(e){return Array.isArray(e)?e.slice():"object"==typeof e?Object.assign({},e):e}var jv=i(744401);function Cv(e){return"subscription"===e.operationType}function _v(e){const{operation:t,graphQLErrors:i,operationType:n}=e,a=t.getContext(),s={operationName:t.operationName,operationType:n,rendererId:a.windowId};return i&&i.length>0&&(s.errors=i.map((e=>function(e,t){let i=h.jK.UnhandledRuntimeException;const n={path:t};if(!e)return n;e.code?i=e.code:"Failed to fetch"===e.message&&(i=h.jK.FailedToFetch);if(n.code=i,e.hasOwnProperty("serverResponse")&&e.serverResponse){"number"==typeof e.serverResponse.status&&(n.status=e.serverResponse.status),n.mscv=e.serverResponse.headers["ms-cv"],n.xmsCorrelationId=e.serverResponse.headers["x-ms-correlation-id"];try{n.contextId=JSON.stringify(e.serverResponse.headers.contextid)}catch(e){}}return n}(e.originalError,e.path&&e.path.join("::"))))),s}function Tv(e,t,i){!Iv(e)&&i&&function(e,t,i){const n=_v(e);if(n.errors&&n.errors.length>0){!function(e,t){const{operation:i,operationType:n}=e;t.error(`'${i.operationName}' operation of type '${n}' failed.`)}(e,t);const a=Object.assign(Object.assign({},n),{errors:"","Panel.WindowID":n.rendererId});n.errors[0].code===h.jK.FailedToFetch?i.cancel(a):i.fail(a)}else i.stop({operationName:n.operationName,operationType:n.operationType,"Panel.WindowID":n.rendererId})}(e,t,i)}function Iv(e){return Cv(e)}function Nv(e,t,i,n,a){const s=e.newLogger("TrackRequestLink","data-resolvers-browser-common");return new $p.i(((e,o)=>{const{query:r}=e,{operation:c}=(0,am.S)(r,null),l=o(e);let d;return i&&(null==a||a.addOperation(e.operationName,c,"Request")),n&&(d=function(e,t){let i;return Iv(e)||(i=t.newScenario(z.RG.QueryExecution)),i}({operationType:c,operation:e},t)),new Wp.y((t=>{let o;try{o=l.subscribe({next:o=>{n&&(o.errors&&o.errors.length>0?Tv({operation:e,operationType:c,graphQLErrors:o.errors,response:o},s,d):function(e,t){if(!Cv(e)&&t){const i=_v(e);t.mark(z.ck.QueryResult,{operationName:i.operationName,operationType:i.operationType,"Panel.WindowID":i.rendererId})}}({operation:e,operationType:c,response:o},d)),i&&(null==a||a.addOperation(e.operationName,c,"Response")),t.next(o)},error:o=>{const r=(e=>e&&e.result?e.result.errors:e instanceof Error?[new jv._("Unhandled exception",void 0,void 0,void 0,void 0,e)]:[new jv._("Unknown error payload provided from forward link")])(o);n&&Tv({operation:e,operationType:c,graphQLErrors:r},s,d),i&&(null==a||a.addOperation(e.operationName,c,"Error")),t.error(o)},complete:()=>{n&&Tv({operationType:c,operation:e},s,d),d=void 0,t.complete()}})}catch(t){throw n&&Tv({operationType:c,operation:e,graphQLErrors:[new jv._("Unhandled exception in forward link",void 0,void 0,void 0,void 0,t)]},s,d),d=void 0,t}return()=>{n&&Tv({operationType:c,operation:e},s,d),d=void 0,o&&o.unsubscribe()}}))}))}const Ev=new class{constructor(){this.map=new Map}destroy(e){const t=this.map.get(e);t&&(t.subscriptions.forEach((e=>{e.next(void 0),e.complete()})),t.subscriptions.length=0,this.map.delete(e))}register(e){if(!this.map.has(e)){const t=new Wp.y((t=>{const{subscriptions:i}=this.map.get(e)||{};i&&i.push(t)}));this.map.set(e,{cancellationObservable:t,subscriptions:[]})}return this.map.get(e).cancellationObservable}};function Fv(e){Ev.destroy(e)}function xv(e,t){const i=e.newLogger("TrackSubscriptionLinks","data-resolvers-browser-common");return new $p.i(((e,n)=>{const{eventsWithoutCancellationListener:a}=t.get(S.J.Calling),{operationName:s,query:o}=e,{operation:r}=(0,am.S)(o,null);if("subscription"!==r||(null==a?void 0:a.includes(s)))return n(e);const c=(0,qe.v4)(),l=Ev.register(c);return i.debug(`Forwarding request ${c} for operation ${s}`),e.setContext({cancellationListener:l}),new Wp.y((t=>{let i;try{const a=n(e);i=a.subscribe({next:e=>{var i;(null===(i=null==e?void 0:e.errors)||void 0===i?void 0:i.length)&&Fv(c),t.next(e)},error:e=>{Fv(c),t.error(e)},complete:()=>{Fv(c),t.complete()}})}catch(e){throw Fv(c),e}return()=>{Fv(c),i&&i.unsubscribe()}}))}))}function Dv(e){Ev.destroy(e)}function Av(e,t=void 0,i=!1){const n=new Map,a=new Map;if(!e)throw new Error("Need an operation name to support");return new $p.i(((s,o)=>{if(!((e,t)=>{const{query:i}=e,n=(0,np.p$)(i);if(!n||"OperationDefinition"!==n.kind)return!1;const{selectionSet:{selections:a}}=n,{operation:s}=(0,am.S)(i,null);if("subscription"!==s)return!1;if(a.length>1)throw new Error("There cannot be more than 1 selection for this link");const o=a[0];if("Field"===o.kind&&o.name.value===t){if(o.arguments.every((({name:e,value:t})=>"Variable"!==t.kind||t.name.value===e.value)))return!0;throw new Error("Argument name must match value")}return!1})(s,e))return o(s);const r=(({operationName:e,variables:t})=>`${e}.${JSON.stringify(Object.keys(t).sort().map((e=>{const i=t[e];if(-1!==["boolean","string"].indexOf(typeof i)||null===i||Number.isSafeInteger(i))return[e,i];throw new Error("Unsupported argument type")})))}`)(s);return new Wp.y((e=>{const c=n.get(r);if(c)c.observersCollection.push(e),i&&a.has(r)&&e.next(a.get(r));else{let c="";if(t&&t.get(S.J.Calling).enableSubscriptionCancellationListener){c=(0,qe.v4)();const e=Ev.register(c);s.setContext((t=>Object.assign(Object.assign({},t),{cancellationListener:e})))}try{const t=o(s).subscribe({next:e=>{i&&a.set(r,e);n.get(r).observersCollection.slice().forEach((t=>{t.next(e)}))},error:e=>{const{observersCollection:t}=n.get(r);n.delete(r);for(const i of t)i.error(e)},complete:()=>{const{observersCollection:e}=n.get(r);n.delete(r);for(const t of e)t.complete()}});n.set(r,{observersCollection:[e],forwardSubscription:t,requestId:c})}catch(e){throw null!==c&&""!==c&&Dv(c),e}}return()=>{const t=n.get(r);if(!t)return;const{observersCollection:i,forwardSubscription:s,requestId:o}=t,c=i.indexOf(e);-1!==c&&(i.splice(c,1),0===i.length&&(n.delete(r),a.delete(r),null!==o&&""!==o&&Dv(o),s&&s.unsubscribe()))}}))}))}var Mv=i(337210),Pv=i(139130),Ov=i(853644);function Rv(e){return new $p.i((t=>{const{query:i,variables:n}=t,{operation:a}=(0,am.S)(i,null),s=t.getContext(),{schema:o,contextValue:r}=null!=e?e:s.incremental,c=Object.assign(Object.assign({},r),s);return"subscription"===a?(0,Ov.F)((()=>(0,Mv.L)({schema:o,document:i,contextValue:c,variableValues:n}))):new Wp.y((e=>{try{Promise.resolve((0,Pv.ht)({schema:o,document:i,variableValues:n,contextValue:c})).then((t=>{e.closed||(e.next(t),e.complete())}),(t=>{e.closed||e.error(t)}))}catch(t){e.closed||e.error(t)}}))}))}function Lv(e){const t=e();return new $p.i(((e,i)=>{const n=t.then((t=>t.request(e,i)));return new Wp.y((e=>{let t;return n.then((i=>{e.closed||(t=null==i?void 0:i.subscribe(e))}),(t=>{e.closed||e.error(t)})),()=>null==t?void 0:t.unsubscribe()}))}))}var Uv=i(550644),$v=i(403588),Wv=i(204456);const Bv=(e,t,i)=>(0,Wv.q)((({graphQLErrors:n,operation:a})=>{const s=e.newLogger(t,"data-client-core");n&&n.forEach((({path:e})=>{const t=a.operationName;if(e){const n=function(e){return e.map((e=>"number"==typeof e?`[${e.toString()}]`:`${e}`)).join(".")}(e),a=`Uncaught error in a GraphQL resolver for operation ${t}, at field selection path: ${n}`;i||!s.errorToTelemetry?s.error(a):s.errorToTelemetry(a,"cdl_links_data_client_core",void 0,!0)}else{const e=`Unknown uncaught error in a GraphQL resolver for operation ${t}`;i||!s.errorToTelemetry?s.error(e):s.errorToTelemetry(e,"cdl_links_data_client_core",void 0,!0)}}))}));function zv(e,t,i,n,a){if(!t||0===Object.keys(t).length)return!1;const{query:s}=e,o=(0,np.p$)(s);if(!o||o&&"OperationDefinition"!==o.kind)return!1;const{selectionSet:{selections:r}}=o,c=(0,am.S)(s,null);if(!c)return!1;const l=c.operation;let d=!1;return r.every((s=>{if("Field"===s.kind){if(n&&!function(e,t){if(!e.directives||0===e.directives.length||!t)return!0;const i=e.directives.find((e=>"skip"===e.name.value));if(i)return!Hv(i,t);const n=e.directives.find((e=>"include"===e.name.value));if(n)return Hv(n,t);return!0}(s,e.variables))return!0;if(function(e,t,i,n,a,s,o){var r;const c=e[i];if(!c){const e=o.newLogger("isDataLayerClientOperationSupported","data-client-core");return null===(r=e.errorToTelemetry)||void 0===r||r.call(e,`Missing operation type '${i}' for ${a} when looking for '${t}' for operation '${s}'`,"cdl_links_data_client_core",void 0,!0),!1}return c instanceof Set?function(e,t,i,n,a,s){var o;if(e.has(t))return!0;if(i){const e=s.newLogger("isDataLayerClientOperationSupported","data-client-core");null===(o=e.errorToTelemetry)||void 0===o||o.call(e,`Unexpected partially supported operation for '${n}' for operation '${a}' - unsupported selection = ${t}`,"cdl_links_data_client_core",void 0,!0)}return!1}(c,t,n,a,s,o):function(e,t,i,n,a,s){var o,r;if(e[t]){const r=e[t];if(r.active)return!0;if(i){const e=s.newLogger("isDataLayerClientOperationSupported","data-client-core");null===(o=e.errorToTelemetry)||void 0===o||o.call(e,`Unexpected partially supported operation for '${n}' for operation '${a}' - unsupported selection= ${t}, found only in '${r.configurationDescription}'`,"cdl_links_data_client_core",void 0,!0)}}else if(i){const e=s.newLogger("isDataLayerClientOperationSupported","data-client-core");null===(r=e.errorToTelemetry)||void 0===r||r.call(e,`Unexpected partially supported operation for '${n}' for operation '${a}' - unsupported selection = ${t} not found in any source`,"cdl_links_data_client_core",void 0,!0)}return!1}(c,t,n,a,s,o)}(t,s.name.value,l,d,a,e.operationName,i))return d=!0,!0}return!1}))}function Hv(e,t){var i;const n=null===(i=e.arguments)||void 0===i?void 0:i.find((e=>"if"===e.name.value));if(!n)return!1;if("Variable"===n.value.kind){const e=n.value.name.value;if(t.hasOwnProperty(e))return!!t[e]}return!1}class qv{static createSingletonLink(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(qv._singletonLink)throw new Error("Links are already created");return qv._singletonLink=$p.i.from(yield qv.createDefaultLinks(e)),qv._singletonLink}))}static createLink(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return $p.i.from(yield qv.createDefaultLinks(e))}))}static get singletonLink(){return qv._singletonLink}static createViewSchemaLink(e){this._viewSchemaImportPromise||(this._viewSchemaImportPromise=Promise.all([i.e(104526),i.e(290689),i.e(358377),i.e(87306),i.e(630483),i.e(897305),i.e(933181)]).then(i.bind(i,39073)));const t=!!e.coreSettings.get(S.J.Core).disableGraphQLErrorTelemetry;return $p.i.from([Bv(e.loggerFactory,"viewSchema_resolverUncaughtErrorBoundary__doNotAssignToGraphQLTeam",t),this.createLazyViewSchemaTerminatingLink(e,this._viewSchemaImportPromise)])}static createLazyViewSchemaTerminatingLink(e,t){let i;return this._viewSchemaImport&&this._viewSchemaExecutor?this._viewSchemaImport.createViewSchemaTerminatingLink(e,this._viewSchemaExecutor):new $p.i(((n,a)=>new Wp.y((s=>{let o,r=!1;return t.then((t=>(this._viewSchemaExecutor||(this._viewSchemaExecutor=new t.ViewSchemaExecutor),this._viewSchemaImport||(this._viewSchemaImport=t),i||(i=t.createViewSchemaTerminatingLink(e,this._viewSchemaExecutor)),i))).then((e=>{var t;r||(o=null===(t=e.request(n,a))||void 0===t?void 0:t.subscribe({next:s.next.bind(s),error:s.error.bind(s),complete:s.complete.bind(s)}))})).catch(s.error.bind(s)),()=>{r=!0,o&&o.unsubscribe()}}))))}static createPatchVariablesLink(e){return bv({contextValue:e,resolvers:[vv.s]})}static createTerminatingLink({config:e,contextValue:t,cdlWorkerService:a,dataClientTrackingService:s,loggerFactory:o,scenarioFactory:r,coreSettings:c,leakDetectorService:l,windowProvider:d},u){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const m=qv.createMainRendererTerminatingLink(e.clientId,o,r,d,c,l,s),{enableClassBasedErrors:g,enableSupermassiveWebLink:h,enableDirectiveCheck:p,disableEnhancedLinkDebugging:v}=c.get(S.J.Core),f={contextValue:t,enableClassBasedErrors:!!g},b=h?function(e,t){return Lv((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield(0,Rl.mT)((()=>Promise.all([i.e(87306),i.e(101827),i.e(253506)]).then(i.bind(i,757474))),"supermassive-incremental-link",t)).supermassiveIncrementalSchemaLink(e,t)}))))}(f,r):$p.i.concat(function(e,t){return Lv((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield(0,Rl.mT)((()=>Promise.all([i.e(358377),i.e(690912),i.e(101827),i.e(4387)]).then(i.bind(i,230881))),"incremental-link",t)).incrementalSchemaLink(e,t)}))))}(f,r),Rv()),y=o.newLogger("getAggregatedCDLAngularResolvers","data-client-core"),k=(0,$v.Om)(c,y,!!v);let w=$p.i.split((e=>function(e,t,i,n,a){const{enableCentralDataLayer:s}=i.get(S.J.Host);return!!s&&zv(e,t,n,a,"MainRenderer")}(e,k,c,o,!!p)),(0,Uv.z)(kv(),m),b);if((0,xu.Q6)(c)&&!u){const t=o.newLogger("createCDLWorkerTerminatingLink","data-client-core");w=yield qv.createCDLWorkerTerminatingLink(a,e,o,r,c,t,w)}return w}))}static createMainRendererTerminatingLink(e,t,i,n,a,s,o){const r=a.get(S.J.Cdl),{logCdlOperationsDuringWaitSettings:c}=a.get(S.J.Core),l=this.createDataLayerClientSettings(a);return hv(new om(e,t,i,new gv((0,R.J)()),s,"Angular",n,{enableRequestHealthMonitor:!!r.enableRequestHealthMonitor,failureCountThreshold:r.requestHealthMonitorFailureCountThreshold,timeoutCountThreshold:r.requestHealthMonitorTimeoutCountThreshold,timeoutLengthSeconds:r.requestHealthMonitorTimeoutLengthSeconds},void 0,void 0,{enableLoggingCdlOperationsDuringWait:null==c?void 0:c.enableLoggingCdlOperationsDuringWait,enableTrackingCdlOperationsDuringWait:null==c?void 0:c.enableTrackingCdlOperationsDuringWait,trackingCdlOperationsDuringWaitThresholdInMs:null==c?void 0:c.trackingCdlOperationsDuringWaitThresholdInMs,trackingCdlOperationsDuringWaitBufferSize:null==c?void 0:c.trackingCdlOperationsDuringWaitBufferSize},o,void 0,l))}static createDataLayerClientSettings(e){const{cdlSubscriptionAggregatorAllowList:t,loggableOperationVariablesAllowList:i,cdlSubscriptionAggregatorLogIntervalMS:n}=e.get(S.J.CdlWorker);return{cdlSubscriptionAggregatorAllowList:t||void 0,loggableOperationVariablesAllowList:i||void 0,cdlSubscriptionAggregatorLogIntervalMS:n||void 0}}static createCDLWorkerTerminatingLink(e,t,i,a,s,o,r){var c,l,d;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!e)return null===(c=o.warnToTelemetry)||void 0===c||c.call(o,"Not creating CDL Worker terminating link. Worker is enabled, but service is unavailable.","cdl_links_data_client_core",void 0,!0),r;const n=yield e.getCDLWorkerManager();if(!n)return null===(l=o.warnToTelemetry)||void 0===l||l.call(o,"Not creating CDL Worker terminating link. Worker is enabled, service is available but workerManager is not defined.","cdl_links_data_client_core",void 0,!0),r;const u=hv(yield e.getDataLayerClient());n.cdlWorkerSupportedResolvers||null===(d=o.errorToTelemetry)||void 0===d||d.call(o,"CDL link is configured but will not accept any operations. Worker is enabled, service is available, but workerManager.cdlWorkerSupportedResolvers is undefined.","cdl_links_data_client_core",void 0,!0);const{disableEnhancedLinkDebugging:m}=s.get(S.J.Core),g=(0,$v.Ng)(s,o,n.cdlWorkerSupportedResolvers,!!m),{enableDirectiveCheck:h}=s.get(S.J.Core);return r=$p.i.split((e=>function(e,t,i,n){return zv(e,t,i,n,"CDLWorker")}(e,g,i,!!h)),(0,Uv.z)(kv(),u),r),s.get(S.J.CdlWorker).enableControlPlaneLink&&(r=yield qv.createCDLWorkerControlPlaneTerminatingLink(e,t,i,a,r,s)),r}))}static createCDLWorkerControlPlaneTerminatingLink(e,t,i,a,s,o){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.getControlPlaneCommunicator(),r=hv(new om(t.clientId,i,a,n,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.createDataLayerClientSettings(o))),{enableDirectiveCheck:c}=o.get(S.J.Core);return s=$p.i.split((e=>function(e,t,i){return zv(e,pv,t,i,"CDLWorkerControl")}(e,i,!!c)),(0,Uv.z)(kv(),r),s),s}))}}qv._singletonLink=null,qv._viewSchemaExecutor=null,qv.createDefaultLinks=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{contextValue:t,loggerFactory:i,scenarioFactory:n,coreSettings:a,noCDLTerminatingLink:s}=e,o=yield qv.createTerminatingLink(e,s),r=qv.createPatchVariablesLink(t),c=a.get(S.J.Core).enableGraphQlOpsCount,l=a.get(S.J.Core).enableTrackRequestsLink,d=c||l?[Nv(i,n,c,l,t.graphqlOpsCountService)]:[],u=a.get(S.J.Calling).enableSubscriptionCancellationListener?[xv(i,a)]:[],m=Av("presenceUpdateEvent",a,!0),g=Av("callParticipantUpdatedEvent",a),h=Av("callParticipantsChangedEvent",a),p=Av("callParticipantsVoiceLevelsChangedEvent",a),v=Av("chatServiceEvent",a),f=Av("blockedContactChangedEvent",a,!0),b=!!a.get(S.J.Core).disableGraphQLErrorTelemetry;return[...d,...u,r,Bv(i,"resolverUncaughtErrorBoundary__doNotAssignToGraphQLTeam",b),m,g,h,p,v,f,o]}));var Vv=i(726905);const Gv=()=>(0,Vv.ZB)(["filter","typeFilter"]),Jv=()=>(0,Vv.ZB)(["filter","typeFilter"]);function Kv(e,t){return t("timestamp",e||{})||""}const Qv=()=>{const e=(0,Vv.ZB)(!1),{read:t,merge:i}=e,a=(0,n.__rest)(e,["read","merge"]);return Object.assign(Object.assign({},a),{merge:(e,t,n)=>{var a,s;if("function"==typeof i){const o=i(e,t,n),{readField:r}=n;let c=(0,B.uniqBy)(o.edges,(e=>r("id",e.node)));return c=c.filter((e=>!r("deleteTime",e.node))),Object.assign(Object.assign({},o),{edges:c,pageInfo:Object.assign(Object.assign({},null==o?void 0:o.pageInfo),{startCursor:r("timestamp",null===(a=(0,B.head)(c))||void 0===a?void 0:a.node),endCursor:r("timestamp",null===(s=(0,B.last)(c))||void 0===s?void 0:s.node)})})}return i},read:(...e)=>{const i=e[0],{readField:n}=e[1];if(!i||!t)return;if(!i.edges)return i;const a=[...i.edges].sort(((e,t)=>function(e,t,i){const n=null==e?void 0:e.node,a=null==t?void 0:t.node,s=Kv(n,i),o=Kv(a,i);return s?o?parseInt(o,10)-parseInt(s,10):-1:1}(e,t,n)));return Object.assign(Object.assign({},t(...e)),{edges:a})}})};const Yv=()=>{const e=(0,Vv.ZB)(!1),{merge:t}=e,i=(0,n.__rest)(e,["merge"]);return Object.assign(Object.assign({},i),{merge:(e,i,n)=>{if(Xv(t)){if(!e)return i;const{readField:a}=n,s=t(e,i,n),o="objectId",r=(0,B.uniqBy)(s.edges,(e=>a(o,e.node)));return Object.assign(Object.assign({},s),{edges:r,pageInfo:Object.assign({},s.pageInfo)})}return t}})},Xv=e=>"function"==typeof e,Zv=e=>{const t=Hp.Query||{fields:{}};return Object.assign(Object.assign(Object.assign({},Hp),e),{Query:Object.assign(Object.assign({},t),{fields:Object.assign(Object.assign({},t.fields),{chats:Gv(),recentsChats:Gv(),pinnedChats:Gv(),activities:Qv(),suggestedContactsInChatList:Jv(),frequentlyUsedContacts:Jv(),replyChainMessages:Object.assign(Object.assign({},(0,Vv.ZB)(["channelId","replychainId"])),{read:e=>e,merge:(e,t)=>t}),replyChainSummaries:Object.assign(Object.assign({},(0,Vv.ZB)(["channelId"])),{read:e=>e,merge:(e,t)=>t}),fluidMessages:{merge:(e,t)=>[...t]},feed:{merge:!0},calendarEventsV3WithPagination:Yv(),pinnedChannels:{merge:!1}})})})},ef=e=>"cache-and-network"===e||"network-only"===e?"cache-first":e;var tf=i(554836);const nf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quotedReply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quotedReply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}}]}}]}}]},af={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientChatForwardCardQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"forwardCard"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataClientChatForwardCardMessageFragment"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatForwardCardMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ForwardMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"isImportant"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"translatedSubject"}},{kind:"Field",name:{kind:"Name",value:"translatedContent"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}}]}}]}.definitions]};var sf=i(711676),of=i(708975);var rf=i(480389);var cf=i(719840),lf=i(914842),df=i(995873),uf=i(855767);const mf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"chat"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}},{kind:"Field",name:{kind:"Name",value:"chatType"}},{kind:"Field",name:{kind:"Name",value:"isSfB"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMeeting"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMuted"}},{kind:"Field",name:{kind:"Name",value:"isFederated"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isRetentionHorizonSet"}},{kind:"Field",name:{kind:"Name",value:"isModerator"}},{kind:"Field",name:{kind:"Name",value:"hasBotMember"}},{kind:"Field",name:{kind:"Name",value:"chatDisabledContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUIDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"}},{kind:"Field",name:{kind:"Name",value:"extendedData"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedTime"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizonBookmark"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userConsumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"botMembers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"creator"}},{kind:"Field",name:{kind:"Name",value:"meetingInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingInformationFields"}}]}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}}]}},...cf.T.definitions,...lf.v.definitions,...df.f.definitions,...uf.qL.definitions]},gf=e=>({__typename:"ChatDisabledContext",isUIDisabled:e.isUIDisabled,disabledReason:e.disabledReason,extendedData:e.extendedData,lastUpdatedTime:e.lastUpdatedTime}),hf=()=>({__typename:"ChatDisabledContext",isUIDisabled:!1,disabledReason:xe.Z4B.UnknownReason,extendedData:null,lastUpdatedTime:null}),pf=()=>({__typename:"ChatDisabledContext",isUIDisabled:!1,disabledReason:xe.Z4B.ChatDisabledDueToBotStatus,extendedData:null,lastUpdatedTime:null}),vf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fluidMessages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidMessages"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}}]}}]}}]},ff={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fluidManifestEntries"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locale"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidManifestEntries"},arguments:[{kind:"Argument",name:{kind:"Name",value:"locale"},value:{kind:"Variable",name:{kind:"Name",value:"locale"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locale"}},{kind:"Field",name:{kind:"Name",value:"entries"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}}]}}]}}]},bf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fluidPendingMentions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"componentHash"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidPendingMentions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"componentHash"},value:{kind:"Variable",name:{kind:"Name",value:"componentHash"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"atMentionId"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"contentId"}},{kind:"Field",name:{kind:"Name",value:"navigationPath"}}]}}]}}]};const yf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"composeState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"composeState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isExpanded"}}]}}]}}]},kf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"imageAltText"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"imageAltText"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};var Sf=i(63960),wf=i(790888);const jf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messagePaneScrolledToStartState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messagePaneScrolledToStartState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isScrolledToStart"}}]}}]}}]},Cf={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageFieldsForTranslation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"fromLanguage"}}]}}]}}]},_f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"twoWaySmsFriendlyName"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"twoWaySmsFriendlyName"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};var Tf=i(434217);const If={Query:{fluidManifestEntries:(e,{locale:t},{cache:i,loggerFactory:n})=>((e,t,i)=>{try{const i=e.readQuery({query:ff,variables:{locale:t}});return null==i?void 0:i.fluidManifestEntries}catch(e){return void i.newLogger("fluid-manifest-entries","data-client-chat").error("Failed to retrieve the cached fluid manifest json")}})(i,t,n)||null,requestImmersiveReader:(e,{conversationId:t,messageId:i,setFocusOnClose:n},a)=>function(e,t,i){return(0,R.J)().opener.open(Gt.B.OpenOnMainRenderer,Gt._.ImmersiveReader,{conversationId:e,messageId:t,setFocusOnClose:i}),!0}(t,i,n)},Conversation:Object.assign({isFederated(e){var t;return null!==(t=e.isFederated)&&void 0!==t?t:(0,sf.eX)(e.id)},isMeeting(e){var t;return null!==(t=e.isMeeting)&&void 0!==t?t:(0,sf.e9)(e.id)},isSfB(e){var t;return null!==(t=e.isSfB)&&void 0!==t?t:(0,of.Jn)(e.id)},chatDisabledContext:e=>(e=>{if(!e)return null;if(!e.chatDisabledContext){const t=e;return t&&t.isDisabled&&t.isOneOnOne&&t.hasBotMember?pf():hf()}return e.chatDisabledContext})(e)},{isHighImportance:()=>null,isUrgentImportance:()=>null,activeCallsCount:()=>null,datatid:()=>null,displayName:()=>null,hasActiveCalls:()=>null,hasFailedMessages:()=>null,otherMemberMris:()=>null,isNewChat:()=>null,isBotBlocked:()=>null,isBotUser:()=>null,isHidden:()=>null,isContactTagged:()=>null,pictureUpn:()=>null,pinnedIndex:()=>null,showAtMention:()=>null,showMarkers:()=>null,tooltipTitle:()=>null,longTitle:()=>null,pictureGroup:()=>null,lastMessageTime:()=>null,messagePreview:()=>null,messagePreviewAria:()=>null,isLastMessageText:()=>null,plGroupKey:()=>null,presenceSource:()=>null,hasActions:()=>null,canBeDiscarded:()=>null,canBotBeBlocked:()=>null,canBePinned:()=>null,canBeMuted:()=>null,canBeLeft:()=>null,canBeHidden:()=>null,canBeFavorited:()=>null,canTagContact:()=>null,canPopOut:()=>null,canManageApps:()=>null}),Mutation:{untranslateMessage:(e,{messageId:t},{cache:i,loggerFactory:n})=>function(e,t,i){if(!t)return null;const n=rf.Ps`
    fragment originalMessageFields on Message {
      id
      content
    }
  `;try{const i=e.readFragment({id:`Message:${t}`,fragment:n});return i?i.content:null}catch(e){return i.error(`Failed to get message from cache: ${e}`),null}}(i,t,n.newLogger("untranslateMessage","data-client-chat")),updateChatDisabledContext:(e,{convId:t,isUIDisabled:i,disabledReason:n,extendedData:a},{cache:s})=>((e,t,i,n,a)=>{const s={convId:t},o={__typename:"ChatDisabledContextResponse",message:"",success:!1,chatDisabledContext:hf()};try{const t=e.readQuery({query:mf,variables:s});if(!t||!t.chat)return o.message="Could not update chatDisabledContext for a null chat conversation",o;const r=Date.now().toString();t.chat.chatDisabledContext&&(o.chatDisabledContext=Object.assign({},t.chat.chatDisabledContext));const c={__typename:"ChatDisabledContext",isUIDisabled:i,disabledReason:n,extendedData:a,lastUpdatedTime:r},l={chat:Object.assign(Object.assign({},t.chat),{chatDisabledContext:c})};e.writeQuery({query:mf,variables:s,data:l}),o.success=!0,l&&l.chat&&l.chat.chatDisabledContext&&(o.chatDisabledContext=gf(l.chat.chatDisabledContext))}catch(e){o.message=`Exception: Failed to update chatDisabledContext for conversation ${t}. Exception Details: ${e.message}`}return o})(s,t,i,n,a),resetQuotedReply:(e,{convId:t},{cache:i})=>((e,t)=>(t.writeQuery({query:nf,variables:{convId:e},data:{quotedReply:null}}),!0))(t,i),setQuotedReply:(e,{convId:t,quotedReply:i},{cache:n})=>((e,{displayName:t,from:i,messageId:n,preview:a,timestamp:s},o)=>{const r={quotedReply:{__typename:"QuotedReply",displayName:t,from:i,messageId:n,preview:a,timestamp:s}};return o.writeQuery({query:nf,variables:{convId:e},data:r}),!0})(t,i,n),deleteForwardCard:(e,{convId:t},{cache:i,loggerFactory:n})=>((e,t,i)=>{const n={forwardCard:null};try{t.writeQuery({query:af,variables:{convId:e},data:n})}catch(e){return i.error("Failed to delete forward card from cache"),!1}return!0})(t,i,n.newLogger("deleteForwardCard","data-client-chat")),saveForwardCard:(e,{convId:t,message:i},{cache:n,loggerFactory:a})=>((e,t,i,n)=>{const{id:a=null,content:s="",version:o=null,originalArrivalTime:r=null,from:c="",messageType:l="RichText/Html",isImportant:d=!1,importance:u=xe.Ntc.Standard,imDisplayName:m="",clientMessageId:g=null,translatedSubject:h="",translatedContent:p="",sourceLanguageName:v="",sourceLanguageCode:f=""}=t,b={id:a,content:s,version:o,originalArrivalTime:r,from:c,messageType:l,isImportant:d,importance:u,imDisplayName:m,clientMessageId:g,translatedSubject:h,translatedContent:p,sourceLanguageName:v,sourceLanguageCode:f},y={forwardCard:Object.assign({__typename:"ForwardMessage"},b)};try{i.writeQuery({query:af,variables:{convId:e},data:y})}catch(e){return n.error("Failed to save forward card to cache"),!1}return!0})(t,i,n,a.newLogger("saveForwardCard","data-client-chat")),updateComposeState(e,{id:t,isExpanded:i},{cache:a,loggerFactory:s}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"ComposeMessageState",id:t,isExpanded:i};try{a.writeQuery({query:yf,variables:{id:t},data:{composeState:Object.assign(Object.assign({},e),{__typename:"ComposeMessageState"})}})}catch(e){s.newLogger("update-compose-state","data-client-chat").error(`Failed to write to client cache the compose state query. Error: ${e.message}`)}return e}))},setImageAltText(e,{altText:t},{cache:i,loggerFactory:a}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e={imageAltText:t};try{i.writeQuery({query:kf,data:e})}catch(e){a.newLogger("update-image-alt-text","data-client-chat").error(`Failed to write to client cache the image alt text query. Error: ${e.message}`)}return!0}))},insertHyperlink(e,{displayText:t,address:i},{cache:a,loggerFactory:s}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"FluidInsertedHyperlink",displayText:t,address:i};try{a.writeQuery({query:Sf.D,data:{insertedHyperlink:Object.assign(Object.assign({},e),{__typename:"FluidInsertedHyperlink"})}})}catch(e){s.newLogger("insert-hyperlink-dialog-data","data-client-chat").error(`Failed to write to client cache the insert hyperlink dialog data query. Error: ${e.message}`)}return!0}))},setTwoWaySmsFriendlyName(e,{twoWaySmsFriendlyName:t},{cache:i,loggerFactory:a}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e={twoWaySmsFriendlyName:t};try{i.writeQuery({query:_f,data:e})}catch(e){a.newLogger("update-tfl-two-way-sms-friendly-name","data-client-chat").error(`Failed to write to client cache the tfl two way sms friendly name query. Error: ${e.message}`)}return!0}))},updateMessagePaneScrolledToStartState(e,{id:t,isScrolledToStart:i},{cache:a,loggerFactory:s}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"MessagePaneScrolledToStartState",id:t,isScrolledToStart:i};try{a.writeQuery({query:jf,variables:{id:t},data:{messagePaneScrolledToStartState:Object.assign(Object.assign({},e),{__typename:"MessagePaneScrolledToStartState"})}})}catch(e){s.newLogger("update-chat-bottom-state","data-client-chat").error(`Failed to write to client cache the chat bottom state query. Error: ${e.message}`)}return e}))},setDlpDialogData(e,{isReport:t,isOverride:i,justification:a},{cache:s,loggerFactory:o}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"DlpDialogData",isReport:t,isOverride:i,justification:a};try{s.writeQuery({query:wf.C,data:{dlpDialogData:Object.assign(Object.assign({},e),{__typename:"DlpDialogData"})}})}catch(e){o.newLogger("set-dlp-dialog-data","data-client-chat").error(`Failed to write to client cache the set dlp dialog data query. Error: ${e.message}`)}return e}))},setFluidMessage:(e,{fluidMessage:t,remove:i},{cache:n,loggerFactory:a})=>(({messageId:e,originalArrivalTime:t},i,n,a)=>{try{const a=n.readQuery({query:vf}),s=i?function(e,t){var i;return{fluidMessages:(null===(i=null==e?void 0:e.fluidMessages)||void 0===i?void 0:i.filter((e=>e.messageId!==t)))||[]}}(a,e):function(e,t,i){const n=[],a={__typename:"FluidMessage",id:t,messageId:t,originalArrivalTime:i};let s=!1;if(null==e?void 0:e.fluidMessages)for(const t of e.fluidMessages)t.originalArrivalTime<a.originalArrivalTime&&!s&&(n.push(a),s=!0),n.push(t);return s||n.push(a),{fluidMessages:n}}(a,e,t);return n.writeQuery({query:vf,data:s}),!0}catch(e){return a.newLogger("set-fluid-messages-pending-load","data-client-chat").error(`Failed to write to client cache the set fluid message pending load query. Error: ${e.message}`),!1}})(t,!!i,n,a),setFluidManifestEntries:(e,{locale:t,entries:i},{cache:n,loggerFactory:a})=>((e,t,i,n)=>{try{const n={fluidManifestEntries:{__typename:"FluidManifestEntries",locale:e,entries:t,timestamp:Date.now()}};return i.writeQuery({query:ff,variables:{locale:e},data:n}),!0}catch(e){return n.newLogger("fluid-manifest-entries","data-client-chat").error(`Failed to write to client cache that set fluid manifest json query. Error: ${e.message}`),!1}})(t,i,n,a),updateFluidPendingMentions:(e,{componentHash:t,pendingMention:i,remove:n},{cache:a,loggerFactory:s})=>((e,t,i,n,a)=>{try{const a=Object.assign({__typename:"FluidPendingMention"},t),s={componentHash:e},o=n.readQuery({query:bf,variables:s}),r=((null==o?void 0:o.fluidPendingMentions)||[]).filter((e=>a.userPrincipalName!==e.userPrincipalName)),c=i?r:[...r,a];return n.writeQuery({query:bf,variables:s,data:{fluidPendingMentions:c}}),!0}catch(e){return a.newLogger("fluid-resolvers-update-pending-fluid-mentions","data-client-chat").error(`Failed to write pending mentions to the cache, error="${e.message}"`),!1}})(t,i,!!n,a,s),clearFluidPendingMentions:(e,{componentHash:t},{cache:i,loggerFactory:n})=>((e,t,i)=>{try{const i={componentHash:e};return t.writeQuery({query:bf,variables:i,data:{fluidPendingMentions:[]}}),!0}catch(e){return i.newLogger("fluid-resolvers-clear-fluid-pending-mentions","data-client-chat").error(`Failed to clear pending mentions from the cache, error="${e.message}"`),!1}})(t,i,n),resetSmartReplyFileSuggestion:(e,{convId:t},{cache:i,loggerFactory:n})=>((e,t,i)=>{const n={smartReplyFileSuggestion:null};try{return t.writeQuery({query:Tf.v,variables:{convId:e},data:n}),!0}catch(e){return i.newLogger("ResetSmartReplyFileSuggestion","data-client-chat").error(`Failed to reset smart reply file suggestion in cache: ${e}`),!1}})(t,i,n),setSmartReplyFileSuggestion:(e,{convId:t,fileSuggestion:i},{cache:n,loggerFactory:a})=>((e,{fileName:t,url:i},n,a)=>{try{const a={smartReplyFileSuggestion:{__typename:"SmartReplyFileSuggestion",fileName:t,url:i}};return n.writeQuery({query:Tf.v,variables:{convId:e},data:a}),!0}catch(e){return a.newLogger("SetSmartReplyFileSuggestion","data-client-chat").error(`Failed to set smart reply file suggestion in cache: ${e}`),!1}})(t,i,n,a)},Message:{deletionInfo:(e,t,{cache:i})=>(0,tf.sE)(i,e),translation:(e,t,{cache:i})=>{var n;try{const t=`Message:${e.id}`,a=null===(n=i.readFragment({id:t,fragment:Cf}))||void 0===n?void 0:n.translation;return a?Object.assign(Object.assign({},a),{__typename:"Translation"}):null}catch(e){return null}},diagnosticInfo:()=>({__typename:"DiagnosticInfo",diagnosticErrorCode:-1,diagnosticMessage:null})}},Nf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientCalendarSchedulingFormBlockingTasksQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"schedulingFormBlockingTasks"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}}]}}]},Ef={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientCalendarSchedulingFormTerminatingActionQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"schedulingFormTerminatingAction"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},Ff={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientCalendarSchedulingFormActiveTabQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"schedulingFormActiveTab"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]},xf={Query:{schedulingFormActiveTab(e,t,{cache:i,loggerFactory:n}){var a,s;try{const e=i.readQuery({query:Ff});return null!==(a=null==e?void 0:e.schedulingFormActiveTab)&&void 0!==a?a:null}catch(e){const t=n.newLogger("scheduling-form-active-tab","data-client-calendar");return null===(s=t.errorToTelemetry)||void 0===s||s.call(t,"schedulingFormActiveTab: Failed to fetch scheduling form active tab from cache.","calendar_form_active_tab"),null}},schedulingFormBlockingTasks(e,t,{cache:i,loggerFactory:n}){var a,s;try{const e=i.readQuery({query:Nf});return null!==(a=null==e?void 0:e.schedulingFormBlockingTasks)&&void 0!==a?a:[]}catch(e){const t=n.newLogger("scheduling-form-blocking-task","data-client-calendar");return null===(s=t.errorToTelemetry)||void 0===s||s.call(t,"schedulingFormBlockingTasks: Failed to fetch scheduling form blocking task from cache.","calendar_form_blocking_tasks"),[]}},schedulingFormTerminatingAction(e,t,{cache:i,loggerFactory:n}){var a,s,o;try{return null!==(s=null===(a=i.readQuery({query:Ef}))||void 0===a?void 0:a.schedulingFormTerminatingAction)&&void 0!==s?s:null}catch(e){const t=n.newLogger("scheduling-form-terminating-action","data-client-calendar");return null===(o=t.errorToTelemetry)||void 0===o||o.call(t,"schedulingFormTerminatingAction: Failed to fetch scheduling form terminating action from cache.","calendar_form_terminating_action"),null}}},Mutation:{addSchedulingFormBlockingTask(e,{input:{task:t}},{cache:i,loggerFactory:n}){var a,s,o,r;const c=n.newLogger("add-scheduling-form-blocking-task","data-client-calendar"),l=(0,qe.v4)();try{const e=null!==(s=null===(a=i.readQuery({query:Nf}))||void 0===a?void 0:a.schedulingFormBlockingTasks)&&void 0!==s?s:[],n=e.find((e=>e.type===t.type));if(n&&n.state===xe.vDg.Active)return null===(o=c.errorToTelemetry)||void 0===o||o.call(c,"addSchedulingFormBlockingTask: Failed to write scheduling form blocking task in cache. Existing active task of same type already exists.","calendar_form_blocking_tasks"),null;const r=(n?e.filter((e=>e.type!==t.type)):e).concat([Object.assign(Object.assign({__typename:"SchedulingFormTask"},t),{id:l})]);i.writeQuery({query:Nf,data:{schedulingFormBlockingTasks:r}})}catch(e){return null===(r=c.errorToTelemetry)||void 0===r||r.call(c,"addSchedulingFormBlockingTask: Failed to write scheduling form blocking task in cache.","calendar_form_blocking_tasks"),null}return Object.assign(Object.assign({},t),{id:l,__typename:"SchedulingFormTask"})},updateSchedulingFormBlockingTask(e,{input:{type:t,state:i}},{cache:n,loggerFactory:a}){var s,o,r,c;const l=a.newLogger("update-scheduling-form-blocking-task","data-client-calendar");try{let e=-1;const a=(null!==(o=null===(s=n.readQuery({query:Nf}))||void 0===s?void 0:s.schedulingFormBlockingTasks)&&void 0!==o?o:[]).map(((n,a)=>(null==n?void 0:n.type)===t?(e=a,Object.assign(Object.assign({},n),{state:i})):n));return-1===e?(null===(r=l.errorToTelemetry)||void 0===r||r.call(l,"updateSchedulingFormBlockingTask: Failed to update scheduling form blocking task in cache. Task does not exist.","calendar_form_blocking_tasks"),null):a[e]}catch(e){return null===(c=l.errorToTelemetry)||void 0===c||c.call(l,"updateSchedulingFormBlockingTask: Failed to update scheduling form blocking task in cache.","calendar_form_blocking_tasks"),null}},removeSchedulingFormBlockingTask(e,{input:{type:t}},{cache:i,loggerFactory:n}){var a,s,o;const r=n.newLogger("remove-scheduling-form-blocking-task","data-client-calendar");try{const e=null!==(s=null===(a=i.readQuery({query:Nf}))||void 0===a?void 0:a.schedulingFormBlockingTasks)&&void 0!==s?s:[],n=e.find((e=>e.type===t));if(!n)return null;const o=e.filter((e=>(null==e?void 0:e.type)!==t));return i.writeQuery({query:Nf,data:{schedulingFormBlockingTasks:o}}),n}catch(e){return null===(o=r.errorToTelemetry)||void 0===o||o.call(r,"removeSchedulingFormBlockingTask: Failed to remove scheduling form blocking task from cache.","calendar_form_blocking_tasks"),null}},setSchedulingFormActiveTab(e,{input:t},{cache:i,loggerFactory:n}){var a;const s=null===t?null:Object.assign(Object.assign({},t),{__typename:"SchedulingFormTab"});try{return i.writeQuery({query:Ff,data:{schedulingFormActiveTab:s}}),s}catch(e){const t=n.newLogger("scheduling-form-active-tab","data-client-calendar");return null===(a=t.errorToTelemetry)||void 0===a||a.call(t,"setSchedulingFormActiveTab: Failed to set scheduling form active tab in cache.","calendar_form_active_tab"),null}},setSchedulingFormTerminatingAction(e,{input:{type:t}},{cache:i,loggerFactory:n}){var a;const s=n.newLogger("set-scheduling-form-terminating-action","data-client-calendar");try{i.writeQuery({query:Ef,data:{schedulingFormTerminatingAction:t}})}catch(e){return null===(a=s.errorToTelemetry)||void 0===a||a.call(s,"setSchedulingFormTerminatingAction: Failed to update scheduling form terminating task in cache.","calendar_form_terminating_action"),!1}return!0}}};var Df=i(259287);var Af=i(454029);const Mf={Mutation:{addFileUpload(e,{fileToAdd:t},{cache:i}){const{fileContainerId:n}=t,a=(({uploadId:e,fileName:t,serviceName:i,context:n})=>({title:t,status:xe.XXy.PROGRESS,id:e,itemId:null,type:(0,Df.mD)(t),objectUrl:"",baseUrl:"",progress:1,fileId:"",isReferencedFile:!1,shareUrl:"",shareId:"",previewUrl:"",chicletBreadcrumbs:null,context:null!=n?n:null,permissionScope:null,previewHeight:null,previewWidth:null,progressComplete:null,state:xe.cj1.active,hasUploadFailed:!1,serviceName:i,externalFileShareInfo:"",sharepointIds:null,publication:null,site:null,__typename:"FileUpload"}))(t);return(0,Af.zz)([a],i,n),!0},removeFileUpload(e,{input:t},{cache:i}){const{uploadId:n,fileContainerId:a}=t;return(0,Af.Fj)(n,a,i),!0}}};var Pf=i(47101);const Of=e=>{if(e){const{appIcon:t,appId:i,appName:n,contentType:a,content:s,locale:o}=e;return{__typename:"PlatformCard",appIcon:t||null,appId:i||null,appName:n||null,content:s,contentType:a,locale:o||null}}return null};var Rf=i(381e3);var Lf=i(2300);var Uf=i(324029);var $f=i(933246);const Wf={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"platformAppsFetchPolicyFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchPolicy"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"forceNetworkFetch"}},{kind:"Field",name:{kind:"Name",value:"scope"}},{kind:"Field",name:{kind:"Name",value:"convId"}}]}}]},Bf="PlatformAppsFetchPolicy",zf="PlatformAppsFetchPolicyMetadata",Hf=rf.Ps`
  fragment PlatformAppsFetchPolicyMetadata_FetchPolicyIds on PlatformAppsFetchPolicyMetadata {
    fetchPolicyIds
  }
`,qf=rf.Ps`
  fragment PlatformAppsFetchPolicy_ForceNetwork on PlatformAppsFetchPolicy {
    forceNetworkFetch
  }
`,Vf=(e,t)=>{let i=`${Bf}:${e}`;return t&&(i=`${i}:${t}`),i},Gf=(e,t,i,n)=>{let a=!0;try{const a=Vf(t.scope,t.convId);e.writeFragment({id:a,fragment:Wf,data:t});const{enableContextlessFetchPolicyUpdates:s}=i.get(S.J.Extensibility);s&&Qf(e,a,n)}catch(e){a=!1}return a},Jf=(e,t,i)=>{let n=`${e}`;return t&&(n=`${n}:${t}`),{__typename:Bf,id:n,scope:e,forceNetworkFetch:i,convId:null!=t?t:null}},Kf=e=>{var t;try{const i=e.readFragment({id:zf,fragment:Hf});return null!==(t=null==i?void 0:i.fetchPolicyIds)&&void 0!==t?t:[]}catch(e){throw e}},Qf=(e,t,i)=>{var n;const a=i.newLogger("updateFetchPolicyIds","data-client-platform");try{let i=Kf(e);if(i.includes(t))return;i=i.concat(t),e.writeFragment({id:zf,fragment:Hf,data:{__typename:zf,fetchPolicyIds:i}})}catch(e){null===(n=a.errorToTelemetry)||void 0===n||n.call(a,`updateFetchPolicyIds: failed to update fetch policy ids when adding ${t}`,"platform_apps_fetch_policy_update_ids_resolver")}};var Yf=i(516102);var Xf=i(166031);var Zf=i(868521);const eb={__typename:"MessageExtensionsAppsState",toggleRefetch:!1},tb=(e,t)=>{try{const i=e.readQuery({query:Zf.F,variables:{convId:t}});if(!i)throw new Error("Unable to read ME apps state from cache");return i}catch(e){throw e}};var ib=i(511523);var nb=i(612034);var ab=i(24756);var sb=i(56818);var ob=i(858453),rb=i(210439);var cb=i(534380);const lb={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"customAppUploadResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"customAppUploadResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"customAppType"}}]}}]}}]};var db=i(607036);var ub=i(776806);var mb=i(836666);const gb="AppCaching resolver: ",hb={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformCachedAppListQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cachedAppList"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedSourceWindow"}},{kind:"Field",name:{kind:"Name",value:"apps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"globalAppId"}},{kind:"Field",name:{kind:"Name",value:"isCachedAndHidden"}},{kind:"Field",name:{kind:"Name",value:"lastLoaded"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}}]}}]}}]}}]},pb=(e,t,i,n,a)=>{if(!e)return!1;const{lastUpdatedSourceWindow:s}=e;try{const o=t.readQuery({query:hb}),r=i({input:e,cacheData:o,coreSettings:a,logger:n});if((0,B.isEqual)(r,null==o?void 0:o.cachedAppList.apps))null==n||n.warn("cache write skipped, data unchanged");else{null==n||n.log("cached app list updated, writing query");const e={cachedAppList:{__typename:"CachedAppList",id:"appcaching",apps:r,lastUpdatedSourceWindow:s}};t.writeQuery({query:hb,data:e})}return!0}catch(e){return!1}},vb=e=>{const t={};return e.forEach((e=>t[e.globalAppId]=e)),t},fb=e=>e.length&&e[0].appId?{"App.Id":e[0].appId}:void 0,bb=e=>{var t;const{cacheData:i,input:n,logger:a}=e;return(({apps:e},t,i)=>{var n;const a=vb(t),s=e.filter((e=>!a[e.globalAppId]));s.length!==e.length&&(null===(n=null==i?void 0:i.warnToTelemetry)||void 0===n||n.call(i,"duplicate apps found in mutation input","platform_app_caching_duplciate_apps_in_mutation_input",fb(e),!0));const o=t.concat(s.map((e=>{var t,i,n;return Object.assign(Object.assign({},e),{__typename:"CachedApp",lastLoaded:null!==(t=e.lastLoaded)&&void 0!==t?t:null,appId:null!==(i=e.appId)&&void 0!==i?i:null,appName:null!==(n=e.appName)&&void 0!==n?n:null})})));return o})(n,null!==(t=null==i?void 0:i.cachedAppList.apps)&&void 0!==t?t:[],a)},yb=e=>{var t;const{cacheData:i,input:{apps:n},logger:a}=e,s=vb(n);let o=[];return(null==i?void 0:i.cachedAppList.apps)&&(o=null==i?void 0:i.cachedAppList.apps.filter((e=>!s[e.globalAppId])),o.length===(null==i?void 0:i.cachedAppList.apps.length)&&(null===(t=null==a?void 0:a.errorToTelemetry)||void 0===t||t.call(a,"app to remove is not in the cached app list","platform_app_caching_missing_cached_app_on_update",fb(n),!0))),o},kb=(e,t,i)=>{let n,a=-1;for(const i of e)(!n||i.lastLoaded&&i.lastLoaded<n)&&(a=t.indexOf(i),n=i.lastLoaded);const s=[...t];return-1!==a&&(s.splice(a,1),null==i||i.log("app removed from global cache due to exceeding shared cache size")),s},Sb=e=>{const{cacheData:t,input:{apps:i},coreSettings:n,logger:a}=e,s=null==n?void 0:n.get(S.J.Extensibility),o=null==s?void 0:s.appCachingMaxSizeNS;let r=[];if(null==t?void 0:t.cachedAppList.apps){const e=vb(null==t?void 0:t.cachedAppList.apps);r=i.map((t=>{var i,n,s;let o;const r=e[t.globalAppId];r?o=r:(o=t,null==a||a.log("adding app to cache that was not found during update."));const c=null!==(i=t.lastLoaded)&&void 0!==i?i:null,l=t.isCachedAndHidden,d=null!==(n=o.appId)&&void 0!==n?n:null,u=null!==(s=o.appName)&&void 0!==s?s:null;return Object.assign(Object.assign({},o),{__typename:"CachedApp",lastLoaded:c,appId:d,isCachedAndHidden:l,appName:u})}));const n=vb(r);r=r.concat(t.cachedAppList.apps.filter((e=>!n[e.globalAppId])))}return o?((e,t,i)=>{const n=e.filter((e=>e.isCachedAndHidden));return!n.length||n.length<=t?e:kb(n,e,i)})(r,o,a):r};var wb=i(691584);var jb=i(315280);var Cb=i(743107);const _b={Query:{platformAppsBatchFetchPolicy:(e,{options:t},{cache:i})=>{const n=t.map((({scope:e,convId:t})=>((e,{scope:t,convId:i})=>{let n;try{const a=Vf(t,i),s=e.readFragment({id:a,fragment:Wf});n=null==s?void 0:s.forceNetworkFetch}catch(e){n=!1}return Jf(t,i,null!=n&&n)})(i,{scope:e,convId:t})));return n},messageExtensionsAppsState:()=>eb},Mutation:{toggleAppsRefetch:(e,{convId:t},{cache:i})=>{try{const e=tb(i,t),{messageExtensionsAppsState:n}=e,a=!n.toggleRefetch,s={messageExtensionsAppsState:Object.assign(Object.assign({},n),{toggleRefetch:a})};i.writeQuery({query:Zf.F,variables:{convId:t},data:s});return tb(i,t).messageExtensionsAppsState.toggleRefetch}catch(e){throw e}},updateTaskModuleResult:(e,{text:t,taskModuleId:i,draftId:n,card:a,conversationId:s,adaptiveCardTabResult:o,reason:r,entryPoint:c},{cache:l})=>{var d;try{const e={taskModuleResult:{__typename:"TaskModuleResult",text:null!=t?t:null,card:Of(a),adaptiveCardTabResult:null!==(d=o&&o.map((e=>Of(e))))&&void 0!==d?d:null,taskModuleId:i,draftId:null!=n?n:null,conversationId:null!=s?s:null,reason:r,entryPoint:c}};return l.writeQuery({query:Pf.sR,data:e}),!0}catch(e){return!1}},resetTaskModuleResult:(e,t,{cache:i})=>{try{return i.writeQuery({query:Pf.sR,data:{taskModuleResult:null}}),!0}catch(e){return!1}},updateAppDetailsResult:(e,{input:t},{cache:i})=>{try{if(!t)throw new Error("No appInstallDetails input received");const{appId:e,appInstallId:n,isAppInstalled:a,errorCode:s}=t,o={appDetailsResult:{__typename:"AppDetailsResult",appInstallId:n,appId:e,isAppInstalled:a,errorCode:s||null}};return i.writeQuery({query:Rf.i,data:o}),!0}catch(e){return!1}},updateInContextStoreLaunchInstalledAppResult:(e,{input:t},{cache:i})=>{try{let e;if(t){const{id:i,appId:n,capability:a,appDisplayName:s=null,draftId:o=null}=t;e={inContextStoreLaunchInstalledAppResult:{__typename:"InContextStoreLaunchInstalledAppResult",id:i,appId:n,capability:a,appDisplayName:s,draftId:o}}}else e={inContextStoreLaunchInstalledAppResult:null};return i.writeQuery({query:Lf.I,data:e}),!0}catch(e){return!1}},setPlatformAppsFetchPolicy:(e,{input:t},{cache:i,loggerFactory:n,coreSettings:a})=>((e,t,i,n)=>{var a;let s=!0;for(const o of t){let t=!0;const r={__typename:Bf,forceNetworkFetch:o.fetchSource===xe.p1$.Network,scope:o.scope,convId:null!==(a=o.convId)&&void 0!==a?a:null};t=Gf(e,r,i,n),s=s&&t}return s})(i,t,a,n),updateAllPlatformAppsFetchPolicies:(e,{fetchSource:t},{cache:i,loggerFactory:n,scenarioFactory:a})=>{var s;let o=!0;const r=n.newLogger("updateAllPlatformAppsFetchPolicies","data-client-platform"),c=a.newScenario(z.RG.UpdateAllPlatformAppsFetchPolicies),l=Kf(i),d=l.length;c.appendEventData({appCount:d});for(const e of l)try{i.writeFragment({id:e,fragment:qf,data:{__typename:Bf,forceNetworkFetch:t===xe.p1$.Network}})}catch(i){o=!1,null===(s=r.errorToTelemetry)||void 0===s||s.call(r,`updateAllPlatformAppsFetchPolicies: failed to update fetch policy for ${e} to ${t}`,"platform_apps_fetch_policy_update_all_resolver")}return o?(c.stop(),!0):(c.fail(),!1)},updateTabConfigurationResult:(e,{id:t,tabId:i},{cache:n})=>{try{const e={tabConfigurationResult:{__typename:"tabConfigurationResult",id:t,tabId:i}};return n.writeQuery({query:ib.s,variables:{threadId:t},data:e}),!0}catch(e){return!1}},updateTabDeletionResult:(e,{threadId:t,channelMeetingMessageId:i,tabId:n},{client:a})=>{try{const e={tabDeletionResult:{__typename:"TabDeletionResult",threadId:t,channelMeetingMessageId:i,tabId:n}};return a.writeQuery({query:nb.r,variables:{threadId:t,channelMeetingMessageId:i},data:e}),!0}catch(e){return!1}},updateMessageToParentResult:(e,{appId:t,message:i},{cache:n})=>{try{const e={messageToParentResult:{__typename:"messageToParentResult",appId:t,message:i}};return n.writeQuery({query:ab.y,variables:{appId:t},data:e}),!0}catch(e){return!1}},updateMessageToChildResult:(e,{appId:t,message:i},{cache:n})=>{try{const e={messageToChildResult:{__typename:"messageToChildResult",appId:t,message:i}};return n.writeQuery({query:sb.n,variables:{appId:t},data:e}),!0}catch(e){return!1}},updateAppButtonSettings:(e,{appId:t,action:i},{cache:n})=>{if(!t)throw new Error("Incorrect input received; id is required");try{const e={appButtonResult:{__typename:"AppButtonResult",appId:t,action:i}};return n.writeQuery({query:cb.E,variables:{appId:t},data:e}),!0}catch(e){return!1}},updateChangeSettings:(e,{id:t,status:i,appId:n,tabId:a},{cache:s})=>{if(!t)throw new Error("Incorrect input received; id is required");try{const e={changeSettingsResult:{__typename:"ChangeSettingsResult",id:t,status:i,appId:null!=n?n:null,tabId:null!=a?a:null}};return s.writeQuery({query:ob.L,variables:{id:t},data:e}),!0}catch(e){return!1}},triggerChangeSettings:(e,{id:t,message:i,appId:n,tabId:a},{cache:s})=>{if(!t)throw new Error("Incorrect input received; id is required");try{const e={changeSettingsTriggerResult:{__typename:"ChangeSettingsTriggerResult",id:t,message:i,appId:null!=n?n:null,tabId:null!=a?a:null}};return s.writeQuery({query:rb.N,variables:{id:t},data:e}),!0}catch(e){return!1}},updateSelectMediaResult:(e,{input:t},{cache:i})=>{var n;try{const{selectMediaError:e,mediaUrls:a}=t,s={selectMediaResult:{__typename:"SelectMediaResult",selectMediaError:null!=e?e:null,mediaUrls:null!==(n=a)&&void 0!==n?n:null}};return i.writeQuery({query:Yf.a,data:s}),!0}catch(e){return!1}},resetSelectMediaResult:(e,t,{cache:i})=>{try{return i.writeQuery({query:Yf.a,data:{selectMediaResult:null}}),!0}catch(e){return!1}},updateViewImagesResult:(e,{input:t},{cache:i})=>{try{const{viewImagesError:e,errorCode:n}=t,a={viewImagesResult:{__typename:"ViewImagesResult",viewImagesError:null!=e?e:null,errorCode:null!=n?n:null}};return i.writeQuery({query:Xf.R,data:a}),!0}catch(e){return!1}},resetViewImagesResult:(e,t,{cache:i})=>{try{return i.writeQuery({query:Xf.R,data:{viewImagesResult:null}}),!0}catch(e){return!1}},updateMapCoordinateResult:(e,{locationApiResult:t},{cache:i})=>{try{const{latitude:e,longitude:n,locationApiError:a}=t,s={mapCoordinateResult:{__typename:"MapCoordinateResult",latitude:null!=e?e:null,longitude:null!=n?n:null,locationApiError:null!=a?a:null}};return i.writeQuery({query:Uf.i,data:s}),!0}catch(e){return!1}},resetMapCoordinateResult:(e,t,{cache:i})=>{try{return i.writeQuery({query:Uf.i,data:{mapCoordinateResult:null}}),!0}catch(e){return!1}},resetSelectPeoplePickerResult:(e,t,{cache:i})=>{try{return i.writeQuery({query:$f.k,data:{selectPeoplePickerResult:[]}}),!0}catch(e){return!1}},updateSelectPeoplePickerResult:(e,{selectPeoplePickerResult:t},{cache:i})=>{try{const e={selectPeoplePickerResult:t.map((e=>({__typename:"SelectPeoplePickerResult",objectId:e.objectId,displayName:e.displayName||"",email:e.email||""})))};return i.writeQuery({query:$f.k,data:e}),!0}catch(e){return!1}},updateCustomAppUploadResult:(e,{input:t},{cache:i})=>{try{if(!t)throw new Error("No customAppUpload input received");const{customAppType:e}=t,n={customAppUploadResult:{__typename:"CustomAppUploadResult",customAppType:e}};return i.writeQuery({query:lb,data:n}),!0}catch(e){return!1}},updateShowLocationResult:(e,{response:t},{cache:i})=>{try{const e={showLocationResponse:null!=t?t:null};return i.writeQuery({query:db.F,data:e}),!0}catch(e){return!1}},resetShowLocationResponse:(e,t,{cache:i})=>{try{return i.writeQuery({query:db.F,data:{showLocationResponse:null}}),!0}catch(e){return!1}},updateWebhookConfirmationResult:(e,{input:t},{cache:i})=>{try{if(!t)throw new Error("No webhookConfirmation input received");const e={webhookConfirmationResult:t};return i.writeQuery({query:ub.S,data:e}),!0}catch(e){return!1}},setAppDevicePermissionsUpdated:(e,{input:t},{cache:i})=>{if(!t||!t.id||!t.status)throw new Error("Incorrect input received; id and status are required");try{const{id:e,status:n}=t,a={appDevicePermissionsUpdated:{__typename:"AppDevicePermissionsUpdated",id:e,status:n}};return i.writeQuery({query:mb.g,data:a,variables:{input:e}}),a.appDevicePermissionsUpdated}catch(e){return null}},addSharedPlatformCachedApps:(e,{input:t},{cache:i,loggerFactory:n})=>pb(t,i,bb,null==n?void 0:n.newLogger(`${gb}addSharedPlatformCachedApps`,"data-client-platform")),removeSharedPlatformCachedApps:(e,{input:t},{cache:i,loggerFactory:n})=>pb(t,i,yb,null==n?void 0:n.newLogger(`${gb}removeSharedPlatformCachedApps`,"data-client-platform")),updateSharedPlatformCachedApps:(e,{input:t},{cache:i,loggerFactory:n,coreSettings:a})=>pb(t,i,Sb,null==n?void 0:n.newLogger(`${gb}updateSharedPlatformCachedApps`,"data-client-platform"),a),setLocalFrameContext:(e,{localFrameContext:t},{cache:i})=>{var n,a,s,o,r;try{const e={localFrameContext:{__typename:"LocalFrameContext",id:t.id,threadId:null!==(n=t.threadId)&&void 0!==n?n:null,messageId:null!==(a=t.messageId)&&void 0!==a?a:null,tabId:null!==(s=t.tabId)&&void 0!==s?s:null,websiteUrl:null!==(o=t.websiteUrl)&&void 0!==o?o:null,contentUrl:null!==(r=t.contentUrl)&&void 0!==r?r:null}};return i.writeQuery({query:wb.O,data:e}),e.localFrameContext}catch(e){return null}},resetLocalFrameContext:(e,t,{cache:i})=>{try{return i.writeQuery({query:wb.O,data:{localFrameContext:null}}),null}catch(e){throw e}},setAppsBadgeRead:(e,{isRead:t},{cache:i})=>{try{return i.writeQuery({query:jb.Q,data:{appsBadgeRead:!!t}}),!0}catch(e){return!1}},setBackButtonHandlerState:(e,{backButtonHandlerState:t},{cache:i})=>{var n;try{const e={backButtonHandlerState:{__typename:"BackButtonHandlerState",id:t.id,registered:null!==(n=t.registered)&&void 0!==n&&n}};return i.writeQuery({query:Cb.i,data:e}),e.backButtonHandlerState}catch(e){return null}},resetBackButtonHandlerState:(e,t,{cache:i})=>{try{return i.writeQuery({query:Cb.i,data:{backButtonHandlerState:null}}),null}catch(e){throw e}}}};var Tb=i(651998),Ib=i(982459),Nb=i(810786),Eb=i(135103),Fb=i(107195);const xb="1ded03cb-ece5-4e7c-9f73-61c375528078",Db=10,Ab="emptyLinkedEntityId",Mb=()=>({__typename:"Entity",action:pe.uk.view,entityState:{__typename:"EntityState",flushableByLinkedEntity:!0},id:h.ew,linkedEntity:null,type:pe.py.blank,options:null,windowOptions:null});function Pb(){return{__typename:"ActiveEntities",subNavEntity:null,startEntity:null,headerEntity:null,mainEntity:Mb(),endEntity:null,entityExtension:null,monitorEntity:null,inAppNotificationsEntity:null}}function Ob(e,t){return!(!e||!t)&&(e.id===t.id&&e.type===t.type&&e.action===t.action)}function Rb(e,t){return Ob(e,t.subNavEntity)||Ob(e,t.headerEntity)||Ob(e,t.mainEntity)}function Lb(e,t){return!e&&!t||!(!e||!t)&&(e.id===t.id&&e.type===t.type&&e.action===t.action&&(null==e?void 0:e.entityState.flushableByLinkedEntity)===(null==t?void 0:t.entityState.flushableByLinkedEntity)&&(null==e?void 0:e.options)===(null==t?void 0:t.options)&&function(e,t){if(!e&&!t)return!0;if(e&&t)return e.action===t.action&&e.id===t.id&&e.type===t.type;return!1}(null==e?void 0:e.linkedEntity,null==t?void 0:t.linkedEntity))}function Ub(e,t,i){const n=new Map,a=new Map;for(const s of e){if(i&&!i(s))continue;const{mainEntity:e,endEntity:o}=s.activeEntities,r=s.userContextId;n.set(t(e,r),[s,e]);const{linkedEntity:c}=e;if(c&&a.set(t(c,r),[s,c]),o){n.set(t(o,r),[s,o]);const{linkedEntity:e}=o;e&&a.set(t(e,r),[s,e])}}return[n,a]}function $b(e,t){return`${e.type}-${e.id}-${t}`}function Wb(e){return!!e.activeEntities}function Bb(e,t){if(!t)return{subNavEntity:null,headerEntity:null,startEntity:null,mainEntity:null,endEntity:null,entityExtension:null,monitorEntity:null,inAppNotificationsEntity:null};const{__typename:i}=t,a=(0,n.__rest)(t,["__typename"]),s=Object.assign({},a);if(!e)return s;const{subNavEntity:o,headerEntity:r,startEntity:c,mainEntity:l,endEntity:d,entityExtension:u,monitorEntity:m,inAppNotificationsEntity:g}=e,{subNavEntity:h,headerEntity:p,startEntity:v,mainEntity:f,endEntity:b,entityExtension:y,monitorEntity:k,inAppNotificationsEntity:S}=t;return s.subNavEntity=Ob(o,h)?null:h,s.headerEntity=Ob(r,p)?null:p,s.startEntity=Ob(c,v)?null:v,s.mainEntity=Ob(l,f)?null:f,s.endEntity=Ob(d,b)?null:b,s.entityExtension=Ob(u,y)?null:y,s.monitorEntity=Ob(m,k)?null:k,s.inAppNotificationsEntity=Ob(g,S)?null:S,s}function zb(e,t){const i=Wb(e)?e.activeEntities:null,n=Wb(t)?t.activeEntities:null;if(!i||!n)return!0;const{subNavEntity:a,headerEntity:s,startEntity:o,mainEntity:r,endEntity:c,entityExtension:l,monitorEntity:d,inAppNotificationsEntity:u}=i,{subNavEntity:m,headerEntity:g,startEntity:h,mainEntity:p,endEntity:v,entityExtension:f,monitorEntity:b,inAppNotificationsEntity:y}=n;return!(e.userContextId===t.userContextId&&e.extendedEntityContainerState.containerState===t.extendedEntityContainerState.containerState&&function(e,t){var i,n,a,s;if(e&&t)return(null===(i=e.blockedCommand)||void 0===i?void 0:i.stateTransition)===(null===(n=t.blockedCommand)||void 0===n?void 0:n.stateTransition)&&(null===(a=e.blockedCommand)||void 0===a?void 0:a.visibilityState)===(null===(s=t.blockedCommand)||void 0===s?void 0:s.visibilityState)&&Lb(e.blockedEntity,t.blockedEntity)&&e.blockedEntityOptions===t.blockedEntityOptions;if(!e&&!t)return!0;return!1}(e.blockingEntityExtension,t.blockingEntityExtension)&&Lb(a,m)&&Lb(s,g)&&Lb(o,h)&&Lb(r,p)&&Lb(c,v)&&Lb(l,f)&&Lb(d,b)&&Lb(u,y))}function Hb(e,t,i,n){var a;const s=Gb(Wb(e)?e.activeEntities:null,Wb(t)?t.activeEntities:null);return i!==ve.su.none||"search"===(null===(a=s.endEntity)||void 0===a?void 0:a.type)||"search"===n.type&&qb(s)}function qb(e){return!(e.subNavEntity||e.headerEntity||e.startEntity||e.mainEntity||e.endEntity||e.entityExtension)}const Vb=e=>({subNavEntity:(null==e?void 0:e.subNavEntity)||null,headerEntity:(null==e?void 0:e.headerEntity)||null,startEntity:(null==e?void 0:e.startEntity)||null,mainEntity:(null==e?void 0:e.mainEntity)||null,endEntity:(null==e?void 0:e.endEntity)||null,entityExtension:(null==e?void 0:e.entityExtension)||null,monitorEntity:(null==e?void 0:e.monitorEntity)||null,inAppNotificationsEntity:(null==e?void 0:e.inAppNotificationsEntity)||null});function Gb(e,t,i=!1){if(!t)return Vb(e);const n=Object.assign({},t);if(!e)return n;const{subNavEntity:a,headerEntity:s,startEntity:o,mainEntity:r,endEntity:c,entityExtension:l,monitorEntity:d,inAppNotificationsEntity:u}=e,{subNavEntity:m,headerEntity:g,startEntity:h,mainEntity:p,endEntity:v,entityExtension:f,monitorEntity:b,inAppNotificationsEntity:y}=t,k=i?(e,t)=>Lb(e,t):(e,t)=>Ob(e,t);return n.subNavEntity=k(a,m)?null:null!=m?m:a,n.headerEntity=k(s,g)?null:null!=g?g:s,n.startEntity=k(o,h)?null:null!=h?h:o,n.mainEntity=k(r,p)?null:null!=p?p:r,n.endEntity=k(c,v)?null:null!=v?v:c,n.entityExtension=k(l,f)?null:null!=f?f:l,n.monitorEntity=k(d,b)?null:null!=b?b:d,n.inAppNotificationsEntity=k(u,y)?null:null!=y?y:u,n}function Jb(e){return!!(e.mainEntity||e.endEntity||e.entityExtension||e.monitorEntity)}function Kb(){return{__typename:"ExtendedEntityContainerState",containerState:ve.oq.Closed,isExternal:!1}}const Qb=()=>({id:(0,qe.v4)(),startTimestamp:Date.now().toString(),source:k.D.Unknown});function Yb(e){if(!e)return null;const{action:t=null,entityState:i={flushableByLinkedEntity:!0},id:n,linkedEntity:a=null,options:s=null,type:o,windowOptions:r=null}=Object.assign({},e);return{action:null!=t?t:pe.uk.view,entityState:{flushableByLinkedEntity:i.flushableByLinkedEntity,__typename:"EntityState"},id:n||null,linkedEntity:a&&Zb(a)||null,options:s,type:o,windowOptions:r?Object.assign(Object.assign({},r),{__typename:"WindowOptions"}):null,__typename:"Entity"}}function Xb(e,t,i){return{id:e.id||null,type:e.type,action:e.action,options:t||null,windowOptions:i?Object.assign(Object.assign({},i),{__typename:"WindowOptions"}):null,linkedEntity:e.linkedEntity&&Zb(e.linkedEntity)||null,entityState:{flushableByLinkedEntity:!0,__typename:"EntityState"},__typename:"Entity"}}function Zb(e){return{action:e.action||null,id:e.id?e.id:Ab,type:e.type,__typename:"LinkedEntity"}}const ey=e=>e?Object.assign(Object.assign({},e),{options:null}):null,ty=e=>Object.assign(Object.assign({},e),{subNavEntity:ey(e.subNavEntity),headerEntity:ey(e.headerEntity),startEntity:ey(e.startEntity),mainEntity:ey(e.mainEntity),endEntity:ey(e.endEntity)}),iy=e=>e?(0,He.b4)(e):null,ny=(e,t,i)=>{var n;const a=t&&(null===(n=e.getApp({entityType:t.type}))||void 0===n?void 0:n.manifest.id);a&&i.add(a)},ay=(e,t)=>{const{subNavEntity:i,headerEntity:n,startEntity:a,mainEntity:s,endEntity:o}=t,r=new Set;return ny(e,i,r),ny(e,n,r),ny(e,a,r),ny(e,s,r),ny(e,o,r),r};function sy({appsRegistryService:e,currentWindowId:t,newReactiveValues:i}){i&&(e.resetAllViewState(t),Object.keys(i).forEach((n=>{e.setReactiveValuesForApp(t,n,i[n])})))}const oy=e=>{if(!e)return;let t={};return t=Object.keys(e).reduce(((t,i)=>{const n=e[i];return Object.assign(Object.assign({},t),{[i]:n.read()})}),{}),t},ry=(e,t={resetMonitor:!0})=>{var i;return e.layoutConfig.slots=Object.assign(Object.assign({},cy()),!t.resetMonitor&&{monitor:null===(i=e.layoutConfig.slots)||void 0===i?void 0:i.monitor}),e},cy=()=>{const e={__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null};return{__typename:"SlotsLayoutConfig",contextualNotifications:e,end:e,header:e,main:e,monitor:e,nav:e,notifications:e,inAppNotifications:e,start:e,subNav:e,titleBar:e,toasts:e}};var ly=i(58826);function dy(e,t){return e.replace(/\n/g,`\n${"  ".repeat(t)}`)}function uy(e,t){if(!e)return"{}";if(t)return dy(uy(e),t);const{id:i,type:n,action:a,linkedEntity:s,entityState:o}=Object.assign({},e);return`{\n  id: ${i},\n  type: ${n},\n  action: ${a},${s?`\n  linkedEntity: {\n    id: ${s.id},\n    type: ${s.type}\n  },`:""}${o?`\n  entityState: {\n    flushableByLinkedEntity: ${o.flushableByLinkedEntity}\n  }`:""}\n}`}function my(e,t){return e?t?dy(my(e),t):`{\n  id: ${e.id},\n  startTimestamp: ${e.startTimestamp},\n  source: ${e.source}\n}`:"{}"}function gy(e,t){const{subNavEntity:i,headerEntity:n,startEntity:a,mainEntity:s,endEntity:o,monitorEntity:r,inAppNotificationsEntity:c,entityExtension:l}=e;i&&t.log(`subNavEntity: ${uy(i)}`),n&&t.log(`headerEntity: ${uy(n)}`),a&&t.log(`startEntity: ${uy(a)}`),t.log(`mainEntity: ${uy(s)}`),o&&t.log(`endEntity: ${uy(o)}`),r&&t.log(`monitorEntity: ${uy(r)}`),c&&t.log(`inAppNotificationsEntity: ${uy(c)}`),l&&t.log(`entityExtension: ${uy(l)}`)}function hy(e,t){const{id:i,correlation:n,isMainWindow:a,layoutConfig:s}=e,o=py(s);t.log(`{\n  id: ${i},\n  correlation: ${my(n,1)},\n  isMainWindow: ${a},\n  layoutMode: ${s.layoutMode},\n  layoutOverrides: ${null==o?void 0:o.toString()}\n}`),Wb(e)?(t.log("activeEntities for window:"),gy(e.activeEntities,t)):t.log("activeEntities: undefined")}const py=e=>e.slots&&Object.keys(e.slots).reduce(((t,i)=>{var n,a,s,o,r,c,l,d,u,m,g,h;return"__typename"===i||((null===(a=null===(n=e.slots)||void 0===n?void 0:n[i])||void 0===a?void 0:a.height)||(null===(o=null===(s=e.slots)||void 0===s?void 0:s[i])||void 0===o?void 0:o.width)||(null===(c=null===(r=e.slots)||void 0===r?void 0:r[i])||void 0===c?void 0:c.isHidden))&&t.push(`${i}:height(${null===(d=null===(l=e.slots)||void 0===l?void 0:l[i])||void 0===d?void 0:d.height}),width(${null===(m=null===(u=e.slots)||void 0===u?void 0:u[i])||void 0===m?void 0:m.width}),isHidden(${null===(h=null===(g=e.slots)||void 0===g?void 0:g[i])||void 0===h?void 0:h.isHidden})`),t}),[]);function vy(e,t){if(void 0===e)return t.log("undefined - app not ported to multi slot");if(null===e)return t.log("null - no app supports this entity");const{subNavEntity:i,headerEntity:n,startEntity:a,mainEntity:s,endEntity:o}=e;i&&t.log(`subNavEntity: ${uy(i)}`),n&&t.log(`headerEntity: ${uy(n)}`),a&&t.log(`startEntity: ${uy(a)}`),s&&t.log(`mainEntity: ${uy(s)}`),o&&t.log(`endEntity: ${uy(o)}`)}const fy=e=>{var t,i,n;return null!==(n=null!==(i=null!==(t=e.subNavEntity)&&void 0!==t?t:e.headerEntity)&&void 0!==i?i:e.startEntity)&&void 0!==n?n:e.mainEntity},by=({entity:e,currentEntities:t,shouldUseNewEntity:i})=>{var n;return i?{appEntity:null!==(n=e.linkedEntity)&&void 0!==n?n:e,contextEntity:e.linkedEntity?e:null}:t?{appEntity:fy(t),contextEntity:e}:{appEntity:e,contextEntity:null}},yy=e=>({infoPane:e.getPreferences("infoPane"),teamLayout:e.getPreferences("teamLayout")}),ky=({appsRegistryService:e,clientPreferences:t,contextEntity:i,coreSettings:n,entity:a,layoutMode:s})=>{if(!a)throw new Error("entity used to match app is null");const o=e.getApp({entityType:a.type});if(!o)return;if(!o.getAppViewEntities)return;const r=o.getAppViewEntities({contextEntity:i,coreSettings:n,entity:a,layoutMode:s,userPreferences:yy(t)});if(a.type===xe.pyR.activity&&i&&r){const a=e.getApp({entityType:i.type});if(!a||!a.getAppViewEntities)return r;const o=a.getAppViewEntities({entity:i,contextEntity:i,coreSettings:n,layoutMode:s,userPreferences:yy(t)});o&&Object.assign(r,{endEntity:o.endEntity})}return r},Sy={[xe.tF7.subNavEntity]:{children:[xe.tF7.headerEntity,xe.tF7.startEntity,xe.tF7.mainEntity,xe.tF7.endEntity]},[xe.tF7.headerEntity]:{children:[xe.tF7.startEntity,xe.tF7.mainEntity,xe.tF7.endEntity]},[xe.tF7.startEntity]:{children:[xe.tF7.mainEntity,xe.tF7.endEntity]},[xe.tF7.mainEntity]:{children:[xe.tF7.endEntity]},[xe.tF7.endEntity]:{children:null}},wy=e=>!(!e||e===xe.tF7.monitorEntity||e===xe.tF7.inAppNotificationsEntity);function jy(e){return e&&e.viewEntityName&&wy(null==e?void 0:e.viewEntityName)?e.viewEntityName:xe.tF7.subNavEntity}function Cy({executionContext:e,viewEntityName:t}){return jy(e)===t}function _y({executionContext:e,viewEntityName:t}){const i=jy(e),{children:n}=Sy[i];return!(!n||!n.includes(t))}var Ty=i(820140);const Iy=(e,t)=>({endEntity:Yb(e.endEntity),headerEntity:Yb(e.headerEntity),mainEntity:Yb(e.mainEntity)||t,startEntity:Yb(e.startEntity),subNavEntity:Yb(e.subNavEntity),monitorEntity:null,inAppNotificationsEntity:null,entityExtension:null,__typename:"ActiveEntities"}),Ny=(e,t,i,n,a)=>{var s;const{appsRegistryService:o,coreSettings:r,clientPreferences:c}=e,l=fy(t),d=o.getApp({entityType:null==l?void 0:l.type}),u=fy(a),m=o.getApp({entityType:null==u?void 0:u.type}),g=null===(s=null==d?void 0:d.onBeforeNavigationFromHistory)||void 0===s?void 0:s.call(d,t,{coreSettings:r,layoutMode:i,userPreferences:yy(c)},(null==m?void 0:m.manifest.id)===(null==d?void 0:d.manifest.id)?a:void 0);return g?(n.log(`${null==d?void 0:d.manifest.name} app declared history invalid. New set of entities:`),vy(g,n),Iy(g,Pb().mainEntity)):t},Ey=(e,t,i,n)=>{var a;const s=e.get((0,Ty.bM)(Ty.WD,i),"Experience");if(s)try{const e=JSON.parse(s);return n&&i!==e.userContextId?null:Ay(e.activeEntities,t)}catch(e){null===(a=t.errorToTelemetry)||void 0===a||a.call(t,`Could not restore active entities from local storage. Stored string was in an invalid JSON format. String: ${s}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0)}return null},Fy=({localStorage:e,logger:t,appsRegistryService:i,userContextId:n,entityType:a,appId:s})=>{var o,r;const c=s||(null===(o=i.getApp({entityType:a}))||void 0===o?void 0:o.manifest.id),l=e.get((0,Ty.bM)(`${Ty.av}-${c}`,n),"Experience");if(l)try{return Ay(JSON.parse(l),t)}catch(e){null===(r=t.errorToTelemetry)||void 0===r||r.call(t,`Could not restore active entities from local storage. Stored string was in an invalid JSON format error ${e}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0),t.log("String in local storage: ",l)}return null},xy=(e,t,i)=>{var n,a;const s=e.windowHistory.map((e=>Object.assign(Object.assign({},e),{activeEntities:ty(e.activeEntities),reactiveVars:{}})));if(t.setSafe((0,Ty.bM)(Ty.ax,e.userContextId),JSON.stringify(s),"Experience")){!t.setSafe((0,Ty.bM)(Ty.Hs,e.userContextId),JSON.stringify({windowHistoryIndex:e.currentWindowHistoryIndex,userContextId:e.userContextId}),"Experience")&&(null===(n=i.errorToTelemetry)||void 0===n||n.call(i,`Failed to save history index ${e.currentWindowHistoryIndex}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0))}else null===(a=i.errorToTelemetry)||void 0===a||a.call(i,`Failed to save main window history to local storage with history length ${s.length}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0)},Dy=({action:e,type:t,id:i,entityState:n,linkedEntity:a,options:s,windowOptions:o})=>e&&t?{action:e,entityState:{flushableByLinkedEntity:n&&n.flushableByLinkedEntity||!1,__typename:"EntityState"},id:i||null,linkedEntity:a&&a.type?{id:a.id||Ab,action:a.action||pe.uk.view,type:a.type,__typename:"LinkedEntity"}:null,options:s||null,type:t,windowOptions:o?{left:o.left||0,top:o.top||0,width:o.width||0,height:o.height||0,__typename:"WindowOptions"}:null,__typename:"Entity"}:null,Ay=(e,t)=>e.mainEntity?{__typename:"ActiveEntities",subNavEntity:e.subNavEntity&&Dy(e.subNavEntity)||null,headerEntity:e.headerEntity&&Dy(e.headerEntity)||null,startEntity:e.startEntity&&Dy(e.startEntity)||null,mainEntity:e.mainEntity&&Dy(e.mainEntity)||Mb(),endEntity:e.endEntity&&Dy(e.endEntity)||null,entityExtension:null,monitorEntity:null,inAppNotificationsEntity:null}:(t.log("No main entity in entities stored in local storage"),null),My=(e,t)=>e.reduce(((e,i)=>{const n=((e,t)=>{if(!e.activeEntities)return t.log("No activeEntities in window history item in local storage"),null;const i=Ay(e.activeEntities,t);return i?{activeEntities:i,reactiveVars:{},__typename:"WindowHistoryItem"}:null})(i,t);return n&&e.push(n),e}),[]);function Py(e,t,i=e.windowHistory.length-1,n){const{maxWindowHistoryLength:a}=n.get(S.J.Core);if(!Wb(e))return;const s=e.windowHistoryNavigationState,o=e.windowHistory;i<0&&(i=-1),e.currentWindowHistoryIndex=i;const r=o.length>0&&o[o.length-1].activeEntities.mainEntity,c=e.activeEntities.mainEntity,l=!!r&&Ob(r,c);s.canNavigateBack=!(0===o.length||1===o.length&&l)&&i>0,s.canNavigateForward=i<e.windowHistory.length-1;let d=i;i!==e.windowHistory.length-1&&(d=i-1),s.backHistory=Oy(0,d,e.windowHistory);const u=s.backHistory,m=e.activeEntities.mainEntity;u.length>0&&Ob(m,u[u.length-1].entity)&&(u.pop(),t.log("windowHistoryNavigationState back history entry was popped.")),s.backHistory=u.reverse().slice(0,a||Db),s.forwardHistory=Oy(i+1,e.windowHistory.length-1,e.windowHistory).slice(0,a||Db),t.log(`Reset windowHistoryNavigationState. size: ${e.windowHistory.length}, windowHistoryIndex: ${i}`),t.log(`Reset windowHistoryNavigationState. canNavigateBack: ${s.canNavigateBack}, canNavigateForward: ${e.windowHistoryNavigationState.canNavigateForward}, backHistory size: ${e.windowHistoryNavigationState.backHistory.length}, forwardHistory size: ${s.forwardHistory.length}`)}function Oy(e,t,i){if(!i)return[];const n=[];for(let a=e;a<=t;a++)n.push({__typename:"WindowHistoryNavigationItem",windowHistoryIndex:a,entity:i[a].activeEntities.mainEntity});return n}const Ry=(e,t,i)=>{const n=n=>!n||i(t.getApp({entityType:n.type}),{mainEntity:e.mainEntity,subNavEntity:e.subNavEntity});return n(e.mainEntity)&&n(e.subNavEntity)},Ly=(e,t,i)=>Ry(e,t,((e,t)=>{var n,a;try{return!(null===(n=null==e?void 0:e.onBeforeAddToNavigation)||void 0===n?void 0:n.shouldAddEntitiesToWindowHistory)||e.onBeforeAddToNavigation.shouldAddEntitiesToWindowHistory(t)}catch(t){return null===(a=i.errorToTelemetry)||void 0===a||a.call(i,`App ${e.manifest.name} failed to execute entity command hook 'ShouldAddEntitiesToWindowHistory' with ""${t.name}"" error`,"entity_command_hook",{errors:`${t.name}`},!0),!0}}));function Uy({appIdsForReactiveVarChange:e,context:t,isUserContextSwitch:i,logger:n,newActiveEntities:a,windowContentState:s,skipMoveToTop:o}){const{appsRegistryService:r,windowProvider:c,clientPreferences:l,coreSettings:d}=t,{currentWindowHistoryIndex:u,windowId:m}=s;let{windowHistory:g}=s;const{enableHostHistoryNavigation:h,maxWindowHistoryLength:p}=d.get(S.J.Core);i&&(n.log("User context switch, clearing out history"),g=[]),n.log(`handleWindowHistoryPush called: current length: ${g.length} current index ${u}`);const v=$y(a,r,l,d,s.layoutMode),f=ay(r,v);if(e&&!e.some((e=>f.has(e))))return n.log(`Not storing rv change to history b/c rv changes made for app not being stored in history ${e} `),[g,!1];if(!Ly(v,r,n))return n.log("Not saving to history b/c app shouldAddEntitiesToWindowHistory hook has returned false"),[g,!1];const b={};f.forEach((e=>{const{navigationalReactiveValues:t,nonNavigationalReactiveValues:i}=r.getAppViewStateForWindow(m,e)||{};(t||i)&&(b[e]=oy(Object.assign(Object.assign({},t),i)))}));let y=g;const k=g[u];if(!k||e||Jb(Bb(a,k.activeEntities))){if(!o&&u<g.length-1){n.log("Current index not at top stack");const e=g.splice(u,1);g.push(e[0]),n.log("Moving to top of stack: "),gy(e[0].activeEntities,n),n.log(`Pushed windowHistory navigation item at index ${u} to the top of the history stack.`)}const e={__typename:"WindowHistoryItem",activeEntities:Object.assign(Object.assign({},v),{monitorEntity:null,inAppNotificationsEntity:null}),reactiveVars:b};return y=[...g,e],h?(c.history.pushState({windowHistoryIndex:y.length-1},""),n.log(`Added browser history entry with windowHistoryIndex: ${y.length}.`)):p?y=y.slice(-p):0===p&&(y=[]),n.log(`windowHistory length after push ${y.length}`),[y,!0]}return n.log("Did not push to window history"),[y,!1]}const $y=(e,t,i,n,a)=>{const s=t.getApp({entityType:fy(e).type});return s&&s.manifest.shouldDeferNavigationToMainSlotApp?Wy(e,t,i,n,a):e},Wy=(e,t,i,n,a)=>{const{appEntity:s,contextEntity:o}=by({currentEntities:e,entity:e.mainEntity,shouldUseNewEntity:!0}),r=ky({appsRegistryService:t,clientPreferences:i,contextEntity:o,coreSettings:n,entity:s,layoutMode:a});return r&&r.mainEntity?Iy(r,e.mainEntity):e};function By(e,t,i,n=!0){var a;try{const{activeWindows:t=[]}=i.enableDecoupleCommandingFromApollo?{activeWindows:i.getActiveWindows()}:e.readQuery({query:ly.i8})||{};return n?(0,B.cloneDeep)(t):t}catch(e){return null===(a=t.errorToTelemetry)||void 0===a||a.call(t,`activeWindowsQuery cache read failed - ${e.message}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0),t.log("activeWindowsQuery entry not found in cache"),[]}}function zy(e,t,i,n,a,s,o){var r,c,l,d;const{activeWindowsService:u,cache:m,commandChangeReportingService:g}=e,p=a||(null==i?void 0:i.correlation.id)||(0,qe.v4)(),v=i?function(e,t,i,n){var a;let s;const o=t.slice(0);if(Wb(e)){const t=o.findIndex((t=>t.id===e.id));s=e,-1===t?o.push(s):o[t]=s}else{const t=e.windowHistory.length;if(t>0&&!e.windowHistory[t-1].activeEntities)throw null===(a=i.errorToTelemetry)||void 0===a||a.call(i,"Unable to resolve active entities, trying to pop back to empty window","webclient_framework_foundation_core_services_entity_commanding"),(0,oe.Tr)(h.w5.Commanding,h.jK.Undefined,"executeEntityCommand",e.correlation,"Unable to resolve to active entities");s=o.splice(o.findIndex((t=>t.id===e.id)),1)[0],i.log(`Window has no active entities so destroying for correlation ${n}`)}return o}(i,t,n,p):t;try{u.enableDecoupleCommandingFromApollo?(u.setActiveWindows(v,s),i&&(null==i?void 0:i.activeEntities)&&(null===(r=u.getWindowLayoutService(i.id))||void 0===r||r.modalManager.updateModalState(i)),i&&(null==i?void 0:i.activeEntities)&&(null===(c=u.getWindowLayoutService(i.id))||void 0===c||c.modalManager.setBlockingEntityExtension(null===(l=i.blockingEntityExtension)||void 0===l?void 0:l.entity))):m.writeQuery({query:ly.i8,data:{activeWindows:v}})}catch(e){return null===(d=n.errorToTelemetry)||void 0===d||d.call(n,`activeWindowsQuery cache write failed - ${e.message}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0),g.report({correlationId:p,type:Ge.B.Failure,context:{target:"executeEntityCommand",errorInfo:Je.y.WindowCacheFailedToUpdate,errorMessage:e.message}}),!1}return!i||i.isNotificationsWindow||o||(qy(v,i,n,e),Hy(e,v,i,p)),n.log(`After updating window cache, there are ${v.length} active windows`),!0}const Hy=({appsRegistryService:e,experienceChangeReportingService:t},i,n,a)=>{if(Wb(n)&&Gy(i,n.id)){const i=fy(n.activeEntities),s=e.getPlatformAppIdForEntity(i);t.report({correlationId:a,type:Mt.yU.AppSelectionChanged,context:{target:"entity-command-resolver",appId:s}})}},qy=(e,t,i,{appsRegistryService:n,clientPreferences:a,coreSettings:s,localStorage:o})=>{var r,c,l,d;const{enableWriteActiveEntitiesToLocalStorage:u,enableWriteAppHistoryToLocalStorage:m,enableWindowHistoryRestorationOnStandardMain:g}=s.get(S.J.Core);if(Wb(t)&&Gy(e,t.id)){const e=Object.assign(Object.assign({},t.activeEntities),{monitorEntity:null,inAppNotificationsEntity:null});if(((e,t,i)=>Ry(e,t,((e,t)=>{var n,a;try{return!(null===(n=null==e?void 0:e.onBeforeAddToNavigation)||void 0===n?void 0:n.shouldRestoreClientToEntities)||e.onBeforeAddToNavigation.shouldRestoreClientToEntities(t)}catch(t){return null===(a=i.errorToTelemetry)||void 0===a||a.call(i,`App ${e.manifest.name} failed to execute entity command hook 'ShouldRestoreClientToEntities' with ""${t.name}"" error`,"entity_command_hook",{errors:`${t.name}`},!0),!0}})))(e,n,i)&&u&&o.set((0,Ty.bM)(Ty.WD,t.userContextId),JSON.stringify({activeEntities:e,userContextId:t.userContextId}),"Experience"),m){const{activeEntities:i}=t,u=fy(i),m=n.getApp({entityType:u.type});if(null===(c=null===(r=null==m?void 0:m.onBeforeAddToNavigation)||void 0===r?void 0:r.shouldStoreLastVisitedInAppHistory)||void 0===c?void 0:c.call(r,i.mainEntity)){const i=null==m?void 0:m.manifest.id;o.set((0,Ty.bM)(`${Ty.av}-${i}`,t.userContextId),JSON.stringify(ty(e)),"Experience")}else if(null==m?void 0:m.manifest.shouldDeferNavigationToMainSlotApp){const r=n.getApp({entityType:i.mainEntity.type}),c=null==r?void 0:r.manifest;if(null===(d=null===(l=null==r?void 0:r.onBeforeAddToNavigation)||void 0===l?void 0:l.shouldStoreLastVisitedInAppHistory)||void 0===d?void 0:d.call(l,i.mainEntity)){const i=Wy(e,n,a,s,t.layoutConfig.layoutMode);o.set((0,Ty.bM)(`${Ty.av}-${null==c?void 0:c.id}`,t.userContextId),JSON.stringify(ty(i)),"Experience")}}}g&&xy(t,o,i)}},Vy=(e,t)=>e.find((e=>e.layoutConfig.layoutMode===t&&e.isMainWindow)),Gy=(e,t)=>{const i=Vy(e,ve.lO.standard);return t===h.ew||t===(null==i?void 0:i.id)},Jy=e=>e===h.ew;function Ky(e,t){const i=e.get(t);return i&&i[0]}function Qy(e,t){return e.find((e=>e.id===t))}function Yy(e,t,i,n,a){let s=Ky(t,$b(e,n));const{linkedEntity:o}=e;let r=!1;!s&&o&&(s=Ky(t,$b(o,n)),r=!!s),!s&&e.id&&(s=Ky(i,$b({id:e.id,type:e.type},n)),r=!!s);const{enableLinkedEntityMatching:c}=a.get(S.J.Core);return c&&!s&&o&&(s=Ky(i,$b(o,n)),r=!!s),[s,r]}const Xy="windowStateEvent";function Zy({pubsub:e,fromWindowId:t,isFromWindowMain:i,sourceWindowId:n,diff:a,targetWindow:s,targetVisibilityState:o,stateTransition:r,correlation:c,logger:l}){!function(e,t,i,n,a,s,o){Wb(s)&&s.id!==h.ew&&ek(t,a)&&(i.log(`Focusing window ${o} for correlation ${e.id}`),n.publish(`${Xy}-${o}`,{windowStateEvent:{isFocused:!0,correlation:e}}))}(c,a,l,e,o,s,n),function(e,t,i,n,a,s,o,r,c){!ek(t,r)||n||c.isMainWindow||c.id===i||o!==ve.su.flush&&o!==ve.su.forceFlush||(a.log(`Closing ${i} for correlation ${e.id}`),s.publish(`${Xy}-${i}`,{windowStateEvent:{correlation:e,shouldClose:!0}}))}(c,a,t,i,l,e,r,o,s)}function ek(e,t){return t===ve.fe.show||t===ve.fe.toggle&&Jb(e)}const tk=(e,t,i,n,a)=>{const s=e.activeEntities.monitorEntity,o=e.activeEntities;e.activeEntities=Ny(a,e.windowHistory[t].activeEntities,e.layoutConfig.layoutMode,i,o),(e=ry(e,{resetMonitor:null===s})).activeEntities=Object.assign(Object.assign({},e.activeEntities),{monitorEntity:s});const r=e.windowHistory[t].reactiveVars;return sy({appsRegistryService:a.appsRegistryService,currentWindowId:e.id,newReactiveValues:r}),Py(e,i,t,a.coreSettings),i.log("Window after navigating in history: "),hy(e,i),zy(a,n,e,i)},ik={Query:{},Mutation:{changeMonitorSlotContent:(e,{windowId:t,entityType:i,entityAction:n,entityOptions:a},s)=>{var o;const{cache:r,loggerFactory:c,activeWindowsService:l}=s,d=c.newLogger("changeSlotsVisibility-mutation","data-client-entity-command"),u=By(r,d,l),m=Qy(u,t);if(!m)return d.error("mutation fails as targetWindow is not found."),null;let g=!1,h=!1;return n===pe.uk.view?(m.activeEntities=Object.assign(Object.assign({},m.activeEntities),{monitorEntity:{id:null,action:n,type:i,entityState:{flushableByLinkedEntity:!1,__typename:"EntityState"},linkedEntity:null,options:a||null,windowOptions:null,__typename:"Entity"}}),h=!0):n===pe.uk.leave&&(null===(o=m.activeEntities.monitorEntity)||void 0===o?void 0:o.type)===i&&(m.activeEntities=Object.assign(Object.assign({},m.activeEntities),{monitorEntity:null}),h=!0),g=h&&zy(s,u,m,d),g&&Wb(m)?m:null},changeSlotsVisibility:(e,{slotNames:t,windowId:i,isHidden:n},a)=>{const{cache:s,loggerFactory:o,activeWindowsService:r}=a,c=o.newLogger("changeSlotsVisibility-mutation","data-client-entity-command"),l=By(s,c,r),d=Qy(l,i);if(!d)return c.error("mutation fails as targetWindow is not found."),null;let u=!1,m=!1;const g=t.reduce(((e,t)=>{var i;const a=(e=>e.replace(/-./g,(e=>e[1].toUpperCase())))(t),s=null===(i=d.layoutConfig.slots)||void 0===i?void 0:i[a];return m||(null==s?void 0:s.isHidden)===n||(m=!0),e[a]=Object.assign(Object.assign({},s),{isHidden:n}),e}),{});return m&&(d.layoutConfig.slots=Object.assign(Object.assign({__typename:"SlotsLayoutConfig"},d.layoutConfig.slots),g),u=zy(a,l,d,c)),u&&Wb(d)?d:null},resizeHeaderSlot:(e,{height:t,windowId:i},n)=>{var a,s,o,r,c;const{cache:l,loggerFactory:d,activeWindowsService:u}=n,m=d.newLogger("resizeHeaderSlot-mutation","data-client-entity-command"),g=By(l,m,u),h=Qy(g,i);if(!h)return null;let p=!1;return(null===(s=null===(a=h.layoutConfig.slots)||void 0===a?void 0:a.header)||void 0===s?void 0:s.height)!==t&&(h.layoutConfig.slots=Object.assign(Object.assign({},h.layoutConfig.slots),{__typename:"SlotsLayoutConfig",header:Object.assign(Object.assign({},null===(o=h.layoutConfig.slots)||void 0===o?void 0:o.header),{__typename:"SlotLayoutConfig",height:t,width:(null===(c=null===(r=h.layoutConfig.slots)||void 0===r?void 0:r.header)||void 0===c?void 0:c.width)||null})}),p=zy(n,g,h,m)),p&&Wb(h)?h:null},resizeSlotDimensions:(e,{windowId:t,slotName:i,width:n},a)=>{var s,o,r,c,l,d;const{cache:u,loggerFactory:m,activeWindowsService:g}=a,h=m.newLogger("resizeSlotDimensions-mutation","data-client-entity-command"),p=By(u,h,g),v=Qy(p,t);if(!v)return null;let f=!1;return i===xe.WLT.SUBNAV?v.layoutConfig.slots=Object.assign(Object.assign({},v.layoutConfig.slots),{__typename:"SlotsLayoutConfig",subNav:Object.assign(Object.assign({},null===(s=v.layoutConfig.slots)||void 0===s?void 0:s.subNav),{__typename:"SlotLayoutConfig",height:(null===(r=null===(o=v.layoutConfig.slots)||void 0===o?void 0:o.subNav)||void 0===r?void 0:r.height)||null,width:n})}):i===xe.WLT.END&&(v.layoutConfig.slots=Object.assign(Object.assign({},v.layoutConfig.slots),{__typename:"SlotsLayoutConfig",end:Object.assign(Object.assign({},null===(c=v.layoutConfig.slots)||void 0===c?void 0:c.end),{__typename:"SlotLayoutConfig",height:(null===(d=null===(l=v.layoutConfig.slots)||void 0===l?void 0:l.end)||void 0===d?void 0:d.height)||null,width:n})})),f=zy(a,p,v,h),f&&Wb(v)?v:null}}};function nk(e,t,i,n,a,s){const{enableOpenerHandleFlow:o}=a.get(S.J.Core);if(o&&Jb(e)){const o=!!ok(e,t,a),r=!!rk(e,dk),c=!!rk(e,mk),l=!!rk(e,hk),d=!!rk(e,pk),u=!!rk(e,vk),m=!!rk(e,fk),g=!!rk(e,bk),p=!!rk(e,_k),v=!!rk(e,Tk),f=!!rk(e,yk),b=!!rk(e,Fk),y=!!rk(e,Lk),k=!!rk(e,Dk),w=!!rk(e,Ak),j=!!rk(e,Mk),C=function(e,t,i){const{enableNewConsumerTasksChatTabNavigation:n}=t.get(S.J.Chat);return!n&&!!rk(e,(e=>gk(e,i)))}(e,a,s),_=function(e,t){const{enableAliasVisibilitySettingsCommand:i}=t.get(S.J.People);return!i&&!!rk(e,uk)}(e,a),T=function(e,t,i){const{enableReactTaskModuleForBIM:n,launchAngularDialog:a,enableReactWorkflowsInBIM:s,enableReactTaskModuleForHWC:o,enableModernPurchaseFlow:r}=t.get(S.J.Extensibility);return function(e,t,i){return t===h.ew&&!i&&!!rk(e,Ik)}(e,i,n)||function(e,t,i){return t===h.ew&&!i&&!!rk(e,Nk)}(e,i,o)||function(e,t){return!!t&&!!rk(e,xk)}(e,a)||function(e,t){return!(t||!rk(e,Ok)&&!rk(e,Rk))}(e,s)||function(e){return!!rk(e,Ek)}(e)||function(e,t){return!t&&!!rk(e,Pk)}(e,r)}(e,a,t),I=function(e,t){const{enableBrb:i}=t.get(S.J.Brb);return!i&&!!rk(e,Ck)}(e,a),N=function(e,t){const{enableHybridChannelList:i,msgEnableChannelsV2:n}=t.get(S.J.Host);return!(n||i||!rk(e,kk))}(e,a),E=function(e,t){const{isCalendarSurfaceHybridArchitectureEnabled:i}=t.get(S.J.Host),n=!!rk(e,jk);if(n&&i)return!1;return n}(e,a),F=function(e,t){const{isSchedulingFormHybridArchitecureEnabled:i}=t.get(S.J.Host),{enableMultiWindowCalendarSchedulingForm:n}=t.get(S.J.Calendar),a=!!rk(e,Sk);if(n&&a)return!1;return a&&!i}(e,a),x=function(e,t,i,n,a){const{isSchedulingFormHybridArchitecureEnabled:s}=a.get(S.J.Host),{enableMultiWindowCalendarSchedulingFormViewAndEdit:o}=a.get(S.J.Calendar),r=!!rk(e,wk);if(r&&n)return!1;if(s&&r)return!1;if(o&&r)return!(t!==h.ew||!i);return r}(e,t,i,n,a),D=function(e,t,i,n){const{isChatHybridArchitectureEnabled:a}=t.get(S.J.Host),s=rk(e,lk);let o=!!s;s&&(n.log(`Checking if opener should handle chat ${s.id}: isChatHybridArchitectureEnabled\n      ${a}, and isNotNewNorNoneOnMainContext ${i}`),o=!1===a&&i,n.log(`Opener should handle chat ${s.id} ${o}`));return o}(e,a,i,s);return o||r||c||l||d||u||m||g||p||v||f||b||y||k||w||j||C||_||T||I||N||E||F||x||D}return!1}function ak(e,t,i,n,a,s){let o=!1,r=null;return r=ok(t,n,s)||function(e,t){let i=null;return sk.forEach((t=>{const n=rk(e,t);n&&(i=n)})),i||rk(e,(e=>gk(e,t)))}(t,a),r&&(i.report({correlationId:e.id,type:Ge.B.NotHandled,context:{target:"openerHandleEntityChange"}}),o=!0),o}const sk=[fk,dk,mk,hk,pk,vk,bk,xk,kk,jk,function(e){return!(!e||e.type!==pe.py.schedulingform)},Dk,Ak,Ck,_k,Tk,Ik,lk,yk,Fk,Lk,Mk,Pk,Ok,Rk,uk,Ek];function ok(e,t,i){const n=ck.bind(null,i);return t===h.ew?rk(e,n):null}function rk(e,t){const{mainEntity:i,endEntity:n,entityExtension:a}=e;let s=null;return i&&t(i)&&(s=i),n&&t(n)&&(s=n),a&&t(a)&&(s=a),s}function ck(e,t){if(!t)return!1;switch(t.type){case pe.py.channels:return[pe.uk.leave,pe.uk.share].indexOf(t.action)>=0;case pe.py.channelroster:return t.action===pe.uk.manage;case pe.py.eduteamcreate:return t.action===pe.uk.view;case pe.py.teams:return t.action===pe.uk.delete;case pe.py.channelnotificationsettings:{const{enableChannelNotificationSettingsInT21:i}=e.get(S.J.Activity);return!i&&t.action===pe.uk.view}case pe.py.channelconnectors:{const{enableChannelConnectorV2:i}=e.get(S.J.TeamsAndChannels);return!i&&t.action===pe.uk.view}case pe.py.channelworkflows:{const{legacyChannelConnectorsToWorkflows:i}=e.get(S.J.TeamsAndChannels);return!i&&t.action===pe.uk.view}case pe.py.crosspostchannelselectiondialog:return t.action===pe.uk.view}return[pe.py.addchannel,pe.py.addmember,pe.py.addmembernewteam,pe.py.broadcastliveevent,pe.py.channeldeeplink,pe.py.channeldelete,pe.py.channeledit,pe.py.channelemail,pe.py.channelmoderators,pe.py.showChannelOwners,pe.py.restorechannel,pe.py.teamarchive,pe.py.teamcreate,pe.py.teamdeeplink,pe.py.teamedit,pe.py.teamjoincode,pe.py.teamleave,pe.py.teampicture,pe.py.teamrenewal,pe.py.teamrestore,pe.py.sharedchannelacceptinvitation,pe.py.sharedchanneldeclineinvitation,pe.py.showformemberdialog,pe.py.stopsharingchannelwithteam].indexOf(t.type)>=0}function lk(e){return e&&e.type===pe.py.chats}function dk(e){const t=!(!e||e.type!==pe.py.extensions||e.id!==ve.oz.organization);if(t&&!(null==e?void 0:e.linkedEntity))throw(0,oe.Tr)(h.w5.Commanding,h.jK.Undefined,"CommandChangeNotification",void 0,"Org chart entity defined without a linked entity. Cannot notify host of route change.");return t}function uk(e){return e.type===pe.py.settingsstore&&e.id===ve.oz.privacyManageVisibility}function mk(e){const t=!(!e||e.type!==pe.py.extensions||e.id!==pe.py.linkedin);if(t&&!(null==e?void 0:e.linkedEntity))throw(0,oe.Tr)(h.w5.Commanding,h.jK.Undefined,"CommandChangeNotification",void 0,"LinkedIn entity defined without a linked entity. Cannot notify host of route change.");return t}function gk(e,t){var i;if(e&&e.type===pe.py.extensions&&e.action===pe.uk.view&&(null===(i=e.linkedEntity)||void 0===i?void 0:i.type)===pe.py.chats){let i;try{(null==e?void 0:e.id)&&(i=JSON.parse(e.id||"").appId)}catch(e){t.warn("isConsumerTasksChatTab, failed to parse appId")}return!(i!==xb)}return!1}function hk(e){return(null==e?void 0:e.type)===pe.py.transcripttab}function pk(e){return(null==e?void 0:e.type)===pe.py.meetingrecaptab}function vk(e){return!(!e||e.type!==pe.py.platformapps||e.action!==pe.uk.list)}function fk(e){const t=!(!e||e.type!==pe.py.platformStage||e.action!==pe.uk.view),i=!(!e||e.type!==pe.py.platformTabGallery);return t||i}function bk(e){return!(!e||e.type!==pe.py.platformapps||e.action!==pe.uk.manage)}function yk(e){return!(!e||(e.type!==pe.py.file||e.action!==pe.uk.view&&e.action!==pe.uk.update)&&e.type!==pe.py.fileopensettings)}function kk(e){return!(!e||e.type!==pe.py.channels||!e.id)}function Sk(e){return!(!e||e.type!==pe.py.schedulingform||e.action!==pe.uk.create)}function wk(e){return!(!e||e.type!==pe.py.schedulingform||e.action!==pe.uk.view)}function jk(e){return!(!e||e.type!==pe.py.calendar)}function Ck(e){return!(!e||e.type!==pe.py.brbfeedbackdialog)}function _k(e){return!(!e||e.type!==pe.py.open3sfeedback)}function Tk(e){return!(!e||e.type!==pe.py.livepersonacard)}function Ik(e){return!(!e||e.type!==pe.py.taskmodule)}function Nk(e){return!(!e||e.type!==pe.py.hwctaskmodule)}function Ek(e){return!(!e||e.type!==pe.py.settingsdialog)}function Fk(e){return!(!e||e.type!==pe.py.accounts)}function xk(e){return!(!e||e.type!==pe.py.platformapp||e.action!==pe.uk.info)}function Dk(e){return!(!e||e.type!==pe.py.platformappdetails||e.action!==pe.uk.config&&e.action!==pe.uk.update)}function Ak(e){return!(!e||e.type!==pe.py.incontextstore||e.action!==pe.uk.config&&e.action!==pe.uk.update)}function Mk(e){return!(!e||e.type!==pe.py.platformapp||e.action!==pe.uk.view)}function Pk(e){return!(!e||e.type!==pe.py.platformsubscriptionplans||e.action!==pe.uk.info)}function Ok(e){return!(!e||e.type!==pe.py.workflows||e.action!==pe.uk.create)}function Rk(e){return!(!e||e.type!==pe.py.workflows||e.action!==pe.uk.manage)}function Lk(e){return!(!e||e.type!==pe.py.customapp||e.action!==pe.uk.create)}function Uk(e,t,{entity:i,stateTransition:n,logger:a,window:s,correlation:o,commandChangeReportingService:r,entityOptions:c}){var l,d;if(!s.blockingEntityExtension)throw(0,oe.Tr)(h.w5.Commanding,h.jK.Undefined,"executeEntityCommand",s.correlation,"Unable to resolve blockingEntityExtension");const u={activeEntities:t,windowHistory:[...s.windowHistory],currentWindowHistoryIndex:s.windowHistory.length-1,layoutMode:s.layoutConfig.layoutMode,userContextId:s.userContextId,windowId:s.id};a.log("Blocking command transition due to blockingEntityExtension");const m=Kb();u.activeEntities=Object.assign(Object.assign({},t),{entityExtension:s.blockingEntityExtension.entity});const g=Object.assign(Object.assign({},s.blockingEntityExtension),{blockedEntity:i,blockedEntityOptions:c||null,blockedCommand:{stateTransition:n,visibilityState:e,correlation:o,__typename:"EntityCommand"}});r.report({correlationId:o.id,type:Ge.B.CommandMetaDataAdded,context:{target:"blockTransitionAndShowExtension",transitionBlockedByExtension:!0}});const p=s.windowHistoryNavigationState,v=Object.assign(Object.assign({},p),{backHistory:[...null!==(l=p.backHistory)&&void 0!==l?l:[]],forwardHistory:[...null!==(d=p.forwardHistory)&&void 0!==d?d:[]]});return Object.assign(Object.assign(Object.assign({},s),u),{correlation:o,extendedEntityContainerState:m,blockingEntityExtension:g,windowHistoryNavigationState:v})}const $k=(e,t,i)=>{const n=e.activeEntities.entityExtension;if(!n)return t.error(`Unable to create hide command for extension in the given window. The window does not have an active extension. Window ID: ${e.id}`),null;const a=Qb();a.source=k.D.CoreResolvers;const s={correlation:a,stateTransition:ve.su.extend,visibilityState:ve.fe.hide};return i.report({type:Ge.B.CommandStart,correlationId:a.id,context:{target:"createAndRegisterHideExtensionCommand",entityCommand:{entity:n,command:Object.assign(Object.assign({},s),{correlation:Object.assign(Object.assign({},a),{startTimestamp:parseInt(a.startTimestamp,10)})})}}}),{entity:n,command:s}},Wk=(e,t,i)=>{var n;if(Wb(e)){const a=$k(e,t,i),s=null===(n=null==a?void 0:a.command.correlation)||void 0===n?void 0:n.id;s&&(t.log(`Closing external dialog, sending hide command with new correlation ${s}`),i.report({type:Ge.B.NotHandled,correlationId:s,context:{target:"sendHideExternalExtensionCommand"}}))}},Bk=(e,t,i,n,a)=>{const{commandChangeReportingService:s}=a;e.extendedEntityContainerState.isExternal?(i.log(`Routing externally - closing external dialog for correlation ${n.id}`),Wk(e,i,s)):(i.log(`Routing externally - closing BIM dialog from command with correlation ${n.id}`),((e,t,i,n,a)=>{Wb(t)&&zy(a,i,zk(t,n),e)})(i,e,t,n,a))};function zk(e,t){const{activeEntities:i}=e;return Object.assign(Object.assign({},e),{correlation:t,extendedEntityContainerState:Object.assign(Object.assign({},e.extendedEntityContainerState),{containerState:ve.oq.Closed}),activeEntities:Object.assign(Object.assign({},i),{entityExtension:null})})}const Hk="CN:",qk={Query:{},Mutation:{createNotificationsWindow:(e,t,i)=>Gk(e,t,i),removeNotificationsWindow:(e,t,i)=>Vk(e,t,i)}},Vk=(e,t,i)=>{var n,a;const{cache:s,loggerFactory:o,activeWindowsService:r}=i,c=o.newLogger("NotificationsResolver","data-client-entity-command");try{const e=By(s,c,r),t=e.filter((e=>!0!==e.isNotificationsWindow));if(t.length===e.length)return c.log(`${Hk}Cannot remove notifications window as it does not exist.`),!0;const a=zy(i,t,void 0,c);return!1===a&&(null===(n=c.errorToTelemetry)||void 0===n||n.call(c,`${Hk}Error updating windows cache after deleting notifications window`,"webclient_framework_foundation_resolvers_notifications",void 0,!0)),a}catch(e){return null===(a=c.errorToTelemetry)||void 0===a||a.call(c,`${Hk}Error occured trying to delete notifications window: ${e.message}`,"webclient_framework_foundation_resolvers_notifications",void 0,!0),!1}},Gk=(e,t,i)=>{var n,a;const{cache:s,loggerFactory:o,activeWindowsService:r}=i,c=o.newLogger("NotificationsResolver","data-client-entity-command");try{const e=By(s,c,r),t=e.find((e=>!0===e.isNotificationsWindow));if(t)return c.log(`${Hk}Notifications window has already been created. windowId: ${t.id}`),!0;const a=Vy(e,ve.lO.standard),o=Object.assign(Object.assign({},Qb()),{__typename:"Correlation",clientLaunchId:a?a.correlation.clientLaunchId:(0,qe.v4)()}),l=zy(i,e,Kk(o,null),c,o.id);return!1===l&&(null===(n=c.errorToTelemetry)||void 0===n||n.call(c,`${Hk}Error updating windows cache with newly created notifications window`,"webclient_framework_foundation_resolvers_notifications",void 0,!0)),l}catch(e){return null===(a=c.errorToTelemetry)||void 0===a||a.call(c,`${Hk}Error occured trying to create notifications window: ${e.message}`,"webclient_framework_foundation_resolvers_notifications",void 0,!0),!1}},Jk=({activeWindows:e,context:t,command:i,correlation:n,entity:a,entityOptions:s,logger:o,notificationsHandler:r,newEntity:c})=>{var l,d,u,m;const g=((e,t)=>{var i;let n;try{e&&(n=JSON.parse(e))}catch(e){null===(i=t.errorToTelemetry)||void 0===i||i.call(t,`${Hk}Ignoring error while parsing entity options for toasts.`,"webclient_framework_foundation_resolvers_notifications",void 0,!0)}return n})(s,o),p=(null==g?void 0:g.targetEntity.id)||i.correlation.id;o.log(`${Hk}${p}Received entity command to render notification. correlationId:${i.correlation.id} tartetEntityType:${null==g?void 0:g.targetEntity.type} actionType:${null==g?void 0:g.targetEntity.dataOptions.actionType} visibility:${i.visibilityState} isIncomingCall:${null==g?void 0:g.isIncomingCall} callId: ${null==g?void 0:g.callId} userContextId: ${null===(d=null===(l=null==g?void 0:g.targetEntity)||void 0===l?void 0:l.dataOptions)||void 0===d?void 0:d.userContextId}`);const{callId:v,crossClientScenarioName:f}=g||{};if(r.sendTelemetry({callId:v,toastScenarioClientId:n.id,callingScenarioName:f,stepName:z.ck.CommandResolutionStarted}),r.isInAppNotificationsEnabled(g))return((e,t,i,n,a,s,o)=>{var r,c;const l=Qy(e,h.ew);if(!l)return null===(r=o.errorToTelemetry)||void 0===r||r.call(o,`${Hk}Error occured trying to execute notifications command, targetWindow is not found`,"webclient_framework_foundation_resolvers_notifications",void 0,!0),null;let d=!1,u=!1;return a.action===pe.uk.view&&(t.visibilityState===xe.feW.hide&&(null===(c=l.activeEntities.inAppNotificationsEntity)||void 0===c?void 0:c.type)===a.type?(l.activeEntities=Object.assign(Object.assign({},l.activeEntities),{inAppNotificationsEntity:null}),u=!0):t.visibilityState===xe.feW.show&&(l.activeEntities=Object.assign(Object.assign({},l.activeEntities),{inAppNotificationsEntity:{id:a.id||n.id,action:a.action,type:a.type,entityState:{flushableByLinkedEntity:!1,__typename:"EntityState"},linkedEntity:null,options:s||null,windowOptions:null,__typename:"Entity"}}),u=!0)),d=u&&zy(i,e,l,o),d&&Wb(l)?l:null})(e,i,t,n,a,s,o);{const{enableInAppNotifications:e,enableBrowserToasts:i}=t.coreSettings.get(S.J.Notifications);if(e||i)return r.sendTelemetry({toastScenarioClientId:n.id,stepName:z.ck.ToastRenderCancelled,reason:`in app notifications disabled for: ${a.type}`}),null}if(!r.isCustomNotificationsEnabled(g))return function(e,t,i,n,a,s){var o;const r=!!n.coreSettings.get(S.J.Core).enableCommandToHostCommService;return r&&a.sendCommandToHost(e,t,i,s,null===(o=n.vdiServiceProvider)||void 0===o?void 0:o.provide()),null}(i,n.id,a,t,r,g);let b;const y=e.findIndex((e=>!0===e.isNotificationsWindow));-1===y?(null===(u=o.warnToTelemetry)||void 0===u||u.call(o,`${Hk}${p}Notifications window does not exist to display this notification. Creating a new one now...`,"webclient_framework_foundation_resolvers_notifications",void 0,!0),r.sendTelemetry({callId:v,toastScenarioClientId:n.id,callingScenarioName:f,stepName:z.ck.RecreatingNotificationsWindow}),b=Kk(n,null)):(b=e[y],r.sendTelemetry({callId:v,toastScenarioClientId:n.id,callingScenarioName:f,stepName:z.ck.NotificationsWindowFound})),c.id=(0,qe.v4)(),((e,t)=>{t.activeEntities.mainEntity=e})(c,b);return!1===zy(t,e,b,o,n.id)?(null===(m=o.errorToTelemetry)||void 0===m||m.call(o,`${Hk}${p}Error updating the active windows cache with notifications window. correlationId:${n.id}`,"webclient_framework_foundation_resolvers_notifications",void 0,!0),r.sendTelemetry({callId:v,toastScenarioClientId:n.id,callingScenarioName:f,stepName:z.ck.FailedToUpdateWindowsCache}),null):(r.sendTelemetry({callId:v,toastScenarioClientId:n.id,callingScenarioName:f,stepName:z.ck.CommandResolved}),b)};function Kk(e,t){const i={__typename:"Entity",id:null,type:pe.py.toasts,action:pe.uk.view,options:null,windowOptions:null,linkedEntity:null,entityState:{__typename:"EntityState",flushableByLinkedEntity:!0}};return{__typename:"Window",id:(0,qe.v4)(),windowOptions:null,windowHistory:[],currentWindowHistoryIndex:0,windowHistoryNavigationState:{__typename:"WindowHistoryNavigationState",canNavigateBack:!1,canNavigateForward:!1,backHistory:[],forwardHistory:[]},correlation:Object.assign(Object.assign({},e),{__typename:"Correlation"}),extendedEntityContainerState:Kb(),blockingEntityExtension:null,isMainWindow:!1,isNotificationsWindow:!0,isInitialWindowStateHidden:!1,userContextId:t,layoutConfig:{__typename:"LayoutConfig",layoutMode:ve.lO.minimal,isFullscreen:!1,slots:{__typename:"SlotsLayoutConfig",contextualNotifications:null,end:null,header:null,main:{__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null},nav:null,notifications:null,inAppNotifications:null,start:null,subNav:null,titleBar:null,toasts:null,monitor:null}},activeEntities:{__typename:"ActiveEntities",mainEntity:i,subNavEntity:null,headerEntity:null,startEntity:null,endEntity:null,entityExtension:null,monitorEntity:null,inAppNotificationsEntity:null}}}const Qk="webclient_framework_foundation_core_services_entity_commanding";function Yk(e,t,i,n,a){let s;const{windowHistory:o,activeEntities:r}=e;let c=o;const{appsRegistryService:l,coreSettings:d}=i,{enableOpenerHandleFlow:u}=d.get(S.J.Core),m=o.slice().reverse().find((e=>{return t=r,i=e.activeEntities,n=fy(t),a=fy(i),!(n.type===a.type&&n.action===a.action);var t,i,n,a}));if(m){s=m.activeEntities,a.log(`Found app switch in window history ${t.id}. Switching to: `),gy(s,a),sy({appsRegistryService:l,currentWindowId:e.id,newReactiveValues:m.reactiveVars});const n={activeEntities:r,windowHistory:o,currentWindowHistoryIndex:e.currentWindowHistoryIndex,layoutMode:e.layoutConfig.layoutMode,userContextId:e.userContextId,windowId:e.id};(!u||s.mainEntity.type!==pe.py.blank)&&([c]=Uy({context:i,isUserContextSwitch:!1,logger:a,newActiveEntities:s,windowContentState:n}))}else if(a.log(`No app switch found in history ${t.id}`),e.id===h.ew){const o=l.getDefaultCommand(i.coreSettings);if(o){a.log(`Using default command for main window ${t.id}`);const s=Qb();return s.source=k.D.CoreResolvers,a.log(`Sending new command with correlation ${s.id}`),wS({entity:o,command:{stateTransition:xe.suD.forceFlush,visibilityState:xe.feW.show,correlation:s},windowId:e.id,clientLaunchId:e.correlation.clientLaunchId},i,n)||Object.assign(Object.assign({},e),{correlation:t,activeEntities:void 0})}s=Pb()}else a.log(`No app switch found in child window ${e.id}, so should close ${t.id}`);return Object.assign(Object.assign({},e),{correlation:t,activeEntities:s,windowHistory:c})}function Xk({commandChangeReportingService:e,correlation:t,entitiesMap:i,entity:n,logger:a,userContextId:s,window:o},r){const{id:c}=t;return a.log(`Hiding main entity and popping history - ${uy(n)} and correlation ${c}`),e.report({correlationId:t.id,type:Ge.B.CommandMetaDataAdded,context:{target:"hideMainEntity",popWindowHistory:!0}}),function({window:e,entitiesMap:t,correlation:i,logger:n,userContextId:a,context:s}){let o;const{windowHistory:r,activeEntities:c}=e,{appsRegistryService:l,coreSettings:d}=s;let u=r[r.length-1];if(qb(Gb(c,(null==u?void 0:u.activeEntities)||null))&&(r.pop(),u=r[r.length-1]),u&&n.log("Using most recent item in history: "),u&&gy(u.activeEntities,n),u){if(Ky(t,$b(u.activeEntities.mainEntity,a))||u.activeEntities.endEntity&&Ky(t,$b(u.activeEntities.endEntity,a)))return n.log(`Active entities from history already exists in another window so emptying out current window ${e.id}`),o=void 0,l.resetAllViewState(e.id),Object.assign(Object.assign({},e),{correlation:i,activeEntities:o});o=Ny(s,u.activeEntities,e.layoutConfig.layoutMode,n,c),sy({appsRegistryService:l,currentWindowId:e.id,newReactiveValues:u.reactiveVars}),Py(e,n,void 0,d)}else e.id===h.ew&&(n.log("No window history in main to pop so setting window to blank"),o=Pb(),l.resetAllViewState(e.id));return n.log(`Popping window history, window history length: ${r.length}`),Object.assign(Object.assign({},e),{correlation:i,activeEntities:o})}({window:o,entitiesMap:i,correlation:t,logger:a,userContextId:s,context:r})}function Zk({activeEntities:e,correlation:t,entity:i,logger:n,window:a}){const s=a;return Ob(e.startEntity,i)?(n.log(`Hiding start entity - ${uy(i)} and correlation ${t.id}`),Object.assign(Object.assign({},s),{activeEntities:Object.assign(Object.assign({},e),{startEntity:null}),correlation:t})):Ob(e.endEntity,i)?(n.log(`Hiding end entity - ${uy(i)} and correlation ${t.id}`),Object.assign(Object.assign({},s),{activeEntities:Object.assign(Object.assign({},e),{endEntity:null}),correlation:t})):void 0}function eS(e,t,i){var{commandChangeReportingService:a,correlation:s,enableMultiSlotHide:o,entitiesMap:r,entity:c,logger:l,stateTransition:d,window:u}=e,m=(0,n.__rest)(e,["commandChangeReportingService","correlation","enableMultiSlotHide","entitiesMap","entity","logger","stateTransition","window"]);if(Wb(u)){const{activeEntities:e}=u;if(u.blockingEntityExtension&&d!==xe.suD.extend)return Uk(xe.feW.hide,e,Object.assign({commandChangeReportingService:a,correlation:s,enableMultiSlotHide:o,entitiesMap:r,entity:c,logger:l,stateTransition:d,window:u},m));if(d===xe.suD.forceFlush&&Rb(c,e))return function({commandChangeReportingService:e,correlation:t,logger:i,window:n},a,s){const{id:o}=t;if(!Wb(n))return n;i.log(`Closing app with correlation correlation ${o}`);const r=Yk(n,t,a,s,i),c=Wb(r)?fy(r.activeEntities):void 0;return e.report({correlationId:t.id,type:Ge.B.CommandMetaDataAdded,context:{target:"closeApp",popWindowHistory:!1,entityDisplayedAfterHide:Wb(r)?{mainEntity:r.activeEntities.mainEntity,contextEntity:c}:void 0}}),r}(Object.assign({commandChangeReportingService:a,correlation:s,enableMultiSlotHide:o,entitiesMap:r,entity:c,logger:l,stateTransition:d,window:u},m),t,i);if((!o||d===xe.suD.flush)&&Ob(e.mainEntity,c))return a.report({correlationId:s.id,type:Ge.B.Hidden,context:{target:"handleHideCommandAction"}}),Xk(Object.assign({commandChangeReportingService:a,correlation:s,enableMultiSlotHide:o,entitiesMap:r,entity:c,logger:l,stateTransition:d,window:u},m),t);if(!o||d===xe.suD.none){const t=Zk({entity:c,logger:l,window:u,correlation:s,activeEntities:e});if(t)return a.report({correlationId:s.id,type:Ge.B.Hidden,context:{target:"handleHideCommandAction"}}),t}if(Ob(e.entityExtension,c))return l.log(`Closing extended entity container with correlation ${s.id}`),zk(u,s);a.report({correlationId:s.id,type:Ge.B.Incomplete,context:{target:"handleHideCommandAction"}}),l.warn(`Hide command issued for an entity but that entity is not present - ${uy(c)}`)}else l.warn(`Hide command issued for an entity but are no active entities - ${uy(c)}`);return u}function tS({appViewEntities:e,commandChangeReportingService:t,coreSettings:i,correlation:n,enableMultiSlotNone:a,entity:s,executionContext:o,logger:r,userContextId:c,window:l}){var d;let u;const m={activeEntities:oS(l),windowHistory:[...l.windowHistory],currentWindowHistoryIndex:l.currentWindowHistoryIndex,layoutMode:l.layoutConfig.layoutMode,userContextId:l.userContextId,windowId:l.id},{enableMTMACommanding:g}=i.get(S.J.Core);if(g&&c!==l.userContextId)throw null===(d=r.errorToTelemetry)||void 0===d||d.call(r,"Different user context sent for toggle command",Qk),new Error("Different user context sent for toggle command");if(Wb(l)){const{activeEntities:i}=l,c=Zk({activeEntities:i,correlation:n,entity:s,logger:r,window:l});if(c)return function({commandChangeReportingService:e,correlation:t,logger:i,newEntity:n}){e.report({correlationId:t.id,type:Ge.B.Toggled,context:{target:"logHideToggle"}}),i.log(`Toggling entity (hide) - ${uy(n)} and correlation ${t.id}`)}({commandChangeReportingService:t,logger:r,newEntity:s,correlation:n}),c;Ob(i.mainEntity,s)||(t.report({correlationId:n.id,type:Ge.B.Incomplete,context:{target:"handleToggleCommandAction"}}),r.log(`Toggling end entity (show) - ${uy(s)} and correlation ${n.id}`),u=rS({activeEntities:i,appViewEntities:e,correlation:n,enableMultiSlotNone:a,executionContext:o,logger:r,newEntity:s,windowContentState:m}).activeEntities)}else t.report({correlationId:n.id,type:Ge.B.Incomplete,context:{target:"handleToggleCommandAction"}}),r.warn(`Toggle command only supported when active entities set - ${s}`);return Object.assign(Object.assign({},l),{correlation:n,activeEntities:u})}function iS({activeEntities:e,stateTransition:t,executionContext:i}){const n=e.mainEntity.entityState.flushableByLinkedEntity,a=!e.endEntity||e.endEntity.entityState.flushableByLinkedEntity,s=_y({executionContext:i,viewEntityName:xe.tF7.mainEntity});return t===xe.suD.forceFlow||s&&n&&t===xe.suD.flow||!s&&a&&t===xe.suD.flow}function nS({mainEntity:e,entity:t,stateTransition:i,matchedLinkedEntity:n}){const a=e.entityState.flushableByLinkedEntity;return i===xe.suD.forceFlush||a&&(i===xe.suD.flush||i===xe.suD.new)||n&&t.type!==pe.py.byodchat&&t.type!==pe.py.chats&&t.type!==pe.py.devicesettings&&t.type!==pe.py.contentcamerasetup&&t.type!==pe.py.transcript&&t.type!==pe.py.meetingdetails&&t.type!==pe.py.roster&&t.type!==pe.py.byodroster&&t.type!==pe.py.breakoutroomspanel&&t.type!==pe.py.yammerqna&&t.type!==pe.py.accessibilitypanel&&t.type!==pe.py.extensions&&t.type!==pe.py.videobackgrounds&&t.type!==pe.py.roomremote}function aS(e,t){const i={__typename:"Entity",action:xe.ukP.view,entityState:{__typename:"EntityState",flushableByLinkedEntity:!0},id:null,linkedEntity:null,type:pe.py.hybridplaceholder,options:null,windowOptions:null};return t===xe.c$2.Activity||t===xe.c$2.NonHybridLeftRail?i:Yb(e)}function sS({currentEntity:e,entityFromAppViewEntities:t,isExecutionContextUpstreamOfEntity:i}){const n=!e||e.entityState.flushableByLinkedEntity;return i&&n&&!!t}function oS(e){return Wb(e)?e.activeEntities:void 0}function rS({activeEntities:e,appViewEntities:t,correlation:i,enableMultiSlotNone:n,executionContext:a,logger:s,newEntity:o,windowContentState:r}){return n&&t?(s.log("Using multi slot none behavior"),function({activeEntities:e,appViewEntities:t,executionContext:i,logger:n,windowContentState:a}){return t.endEntity||t.startEntity||n.warn("Attempting to show side rail slots (start or end) but appViewEntities has returned null for startEntity and endEntity"),Object.assign(Object.assign({},a),{activeEntities:Object.assign(Object.assign({},e),{startEntity:sS({currentEntity:e.startEntity,entityFromAppViewEntities:t.startEntity,isExecutionContextUpstreamOfEntity:_y({executionContext:i,viewEntityName:xe.tF7.startEntity})||Cy({executionContext:i,viewEntityName:xe.tF7.startEntity})})?Yb(t.startEntity):e.startEntity,endEntity:sS({currentEntity:e.endEntity,entityFromAppViewEntities:t.endEntity,isExecutionContextUpstreamOfEntity:_y({executionContext:i,viewEntityName:xe.tF7.endEntity})||Cy({executionContext:i,viewEntityName:xe.tF7.endEntity})})?Yb(t.endEntity):e.endEntity})})}({activeEntities:e,appViewEntities:t,logger:s,executionContext:a,windowContentState:r})):(s.log("Falling back to default none behavior"),function(e,t,i,n,a){return n.log(`Adding as end entity - ${uy(i)} and correlation ${a}`),Object.assign(Object.assign({},e),{activeEntities:Object.assign(Object.assign({},t),{endEntity:i})})}(r,e,o,s,i.id))}function cS(e,t){var i,a,s,{appViewEntities:o,correlation:r,enableMultiSlotNone:c,entity:l,executionContext:d,isCurrentEntitiesInvalid:u,isInputDefaultEntity:m,logger:g,matchedLinkedEntity:h,sourceHint:p,stateTransition:v,window:f,userContextId:b}=e,y=(0,n.__rest)(e,["appViewEntities","correlation","enableMultiSlotNone","entity","executionContext","isCurrentEntitiesInvalid","isInputDefaultEntity","logger","matchedLinkedEntity","sourceHint","stateTransition","window","userContextId"]);const{coreSettings:k}=t,w=oS(f);let j=f.extendedEntityContainerState,C={activeEntities:w,windowHistory:[...f.windowHistory],currentWindowHistoryIndex:f.currentWindowHistoryIndex,layoutMode:f.layoutConfig.layoutMode,userContextId:f.userContextId,windowId:f.id};if(f.blockingEntityExtension&&w&&v!==xe.suD.extend)return Uk(xe.feW.show,w,Object.assign({appViewEntities:o,correlation:r,enableMultiSlotNone:c,entity:l,executionContext:d,isCurrentEntitiesInvalid:u,isInputDefaultEntity:m,logger:g,matchedLinkedEntity:h,sourceHint:p,stateTransition:v,window:f,userContextId:b},y));if(!w||nS({mainEntity:w.mainEntity,entity:l,stateTransition:v,matchedLinkedEntity:h}))C=function({appViewEntities:e,context:t,correlation:i,isInputDefaultEntity:n,isCurrentEntitiesInvalid:a,logger:s,newEntity:o,sourceHint:r,userContextId:c,window:l,windowContentState:d}){var u;const{subNavEntity:m=null,headerEntity:g=null,startEntity:h=null,mainEntity:p=null,endEntity:v=null,monitorEntity:f=null,inAppNotificationsEntity:b=null}=Object.assign({},e),{coreSettings:y}=t,{activeEntities:k}=d,{action:w,type:j}=o,{enableMTMACommanding:C}=y.get(S.J.Core),_=!!C&&c!==l.userContextId,T=j===xe.pyR.default&&w===xe.ukP.view;if(!_&&!a&&((w===xe.ukP.default||T)&&k&&j===fy(k).type||d.activeEntities&&n))return d;const I={__typename:"ActiveEntities",subNavEntity:aS(m,r),headerEntity:Yb(g),startEntity:Yb(h),mainEntity:null!==(u=Yb(p))&&void 0!==u?u:o,endEntity:Yb(v),entityExtension:null,monitorEntity:f,inAppNotificationsEntity:b},[N,E]=Uy({context:t,logger:s,windowContentState:d,newActiveEntities:I,isUserContextSwitch:_});return s.log(`Flushing window - ${uy(o)} and correlation ${i.id}`),{activeEntities:I,windowHistory:N,currentWindowHistoryIndex:E?N.length-1:d.currentWindowHistoryIndex,layoutMode:l.layoutConfig.layoutMode,userContextId:c,windowId:l.id}}({appViewEntities:o,context:t,correlation:r,isCurrentEntitiesInvalid:u,isInputDefaultEntity:m,logger:g,newEntity:l,sourceHint:p,userContextId:b,window:f,windowContentState:C});else if(iS({activeEntities:w,stateTransition:v,executionContext:d}))C=function({activeEntities:e,appViewEntities:t,context:i,executionContext:n,logger:a,window:s,windowContentState:o}){var r;const c=_y({executionContext:n,viewEntityName:xe.tF7.headerEntity}),l=c||_y({executionContext:n,viewEntityName:xe.tF7.startEntity}),d=l||_y({executionContext:n,viewEntityName:xe.tF7.mainEntity}),u=d||_y({executionContext:n,viewEntityName:xe.tF7.endEntity});a.log(`Issuing flow command on window - headerEntity ${c}, startEntity ${l}, \n        mainEntity ${d}, endEntity ${u}`);const m=Object.assign(Object.assign({},e),{headerEntity:c?Yb(null==t?void 0:t.headerEntity):e.headerEntity,startEntity:l?Yb(null==t?void 0:t.startEntity):e.startEntity,mainEntity:d&&null!==(r=Yb(null==t?void 0:t.mainEntity))&&void 0!==r?r:e.mainEntity,endEntity:u?Yb(null==t?void 0:t.endEntity):e.endEntity}),[g]=Uy({context:i,isUserContextSwitch:!1,logger:a,newActiveEntities:m,windowContentState:o});return{activeEntities:m,windowHistory:g,currentWindowHistoryIndex:g.length-1,layoutMode:s.layoutConfig.layoutMode,userContextId:s.userContextId,windowId:s.id}}({activeEntities:w,appViewEntities:o,context:t,executionContext:d,logger:g,window:f,windowContentState:C});else if(function(e,t,i){return!!e&&(Ob(e.mainEntity,t)||Ob(e.endEntity,t))&&i!==xe.suD.extend}(w,l,v))!function(e,t,i,n){e!==ve.su.new&&t.log(`Entity already exists in the active entities no state transition made - ${uy(i)} and correlation ${n}`)}(v,g,l,r.id),C=function(e,t,i,a,s){const{activeEntities:o}=i;if(!o)return i;const{mainEntity:r,endEntity:c}=o,l=Object.assign({},o),{entityState:d}=a,u=(0,n.__rest)(a,["entityState"]);Ob(r,a)?l.mainEntity=Object.assign(Object.assign({},r),u):c&&Ob(c,a)&&(l.endEntity=Object.assign(Object.assign({},c),u));const[m]=Uy({context:e,isUserContextSwitch:!1,logger:t,newActiveEntities:o,windowContentState:i});return{activeEntities:l,windowHistory:m,currentWindowHistoryIndex:m.length-1,layoutMode:s.layoutConfig.layoutMode,userContextId:s.userContextId,windowId:s.id}}(t,g,C,l,f);else if(v===xe.suD.extend){const e=function({activeEntities:e,extendedEntityContainerState:t,logger:i,newEntity:n,windowContentState:a}){const s=t.containerState===ve.oq.Confirmed,o=t.containerState===ve.oq.Error,r=e.entityExtension&&t.isExternal;if(n.type===xe.pyR.platformapp&&n.action===xe.ukP.create||n.type===xe.pyR.devicedetails&&n.action===xe.ukP.view||n.type===xe.pyR.storecartcheckout&&n.action===xe.ukP.view||n.type===xe.pyR.storecart&&n.action===xe.ukP.view||!e.entityExtension||s||o||r)return t=Kb(),a.activeEntities=Object.assign(Object.assign({},e),{entityExtension:n}),[t,a];i.log(`Not showing extension: exists ${!!e.entityExtension}, isConfirmed ${s}, \n  hasError ${o}, hasExternalDialog ${r}`)}({activeEntities:w,extendedEntityContainerState:j,logger:g,newEntity:l,windowContentState:C});if(!e)throw new Error(`Extension already rendered, only one extension command request can be processed at a time. \n        Extension shown: ${null===(i=w.entityExtension)||void 0===i?void 0:i.type}; Extension requested: ${l.type}.`);j=e[0],C=e[1]}else C=rS({activeEntities:w,appViewEntities:o,correlation:r,enableMultiSlotNone:c,newEntity:l,executionContext:d,logger:g,windowContentState:C});if(function(e,t,i,n){const{enableMTMACommanding:a}=e.get(S.J.Core);return!(!a||t||!i||!n.userContextId||i===n.userContextId)}(k,v===xe.suD.flush||v===xe.suD.forceFlush||v===xe.suD.extend,b,f))throw new Error("Different user context sent for non-flush and non-extend command");const _=f.windowHistoryNavigationState,T=Object.assign(Object.assign({},_),{backHistory:[...null!==(a=_.backHistory)&&void 0!==a?a:[]],forwardHistory:[...null!==(s=_.forwardHistory)&&void 0!==s?s:[]]});return Object.assign(Object.assign(Object.assign({},f),C),{correlation:r,extendedEntityContainerState:j,windowHistoryNavigationState:T})}function lS(e,t,i,n){switch(e){case xe.feW.hide:return eS(t,i,n);case xe.feW.toggle:return tS(t);case xe.feW.show:case xe.feW.showWithoutFocusing:return cS(t,i)}}function dS(e,t){if(void 0!==t){const i=t?Zb(t):null;e.linkedEntity=i}}function uS(e,t,i,n,a){const{visibilityState:s,stateTransition:o,layoutMode:r,targetWindow:c}=e;if(s!==xe.feW.hide){if(n&&o===xe.suD.new)return(0,qe.v4)();if(a&&i===h.ew||c===xe.PHN.main){if(!Vy(t,null!=r?r:ve.lO.standard))return(0,qe.v4)()}else if(function(e,t){return t===h.ew&&!Qy(e,h.ew)}(t,i))return h.ew}}function mS({activeWindows:e,command:t,coreSettings:i,correlation:n,entitiesMap:a,entity:s,isNewContextSupportEnabled:o,layoutMode:r,linkedEntitiesMap:c,logger:l,userContextId:d,windowId:u,webNrcEnabled:m}){const{stateTransition:g,targetWindow:p}=t,v=g===xe.suD.forceFlush||p===xe.PHN.main,f=g===xe.suD.flow,b=g===xe.suD.extend,[y,k]=!o||v||f||b?[void 0,!1]:Yy(s,a,c,d,i);y&&(l.log(`Entity matched matched via linked entity ${k} for correlation ${n.id} to window`),hy(y,l));const S=y||function({command:e,activeWindows:t,windowId:i,correlation:n,logger:a,isNewContextSupportEnabled:s,layoutMode:o,userContextId:r,webNrcEnabled:c}){const l=uS(e,t,i,s,c);return void 0!==l?(a.log(`Creating new window with id ${l} for correlation ${n.id}`),function(e,t,i,n,a,s,o){const{visibilityState:r,stateTransition:c,targetWindow:l}=a;return{__typename:"Window",id:t,windowOptions:null,windowHistory:[],currentWindowHistoryIndex:0,windowHistoryNavigationState:{__typename:"WindowHistoryNavigationState",canNavigateBack:!1,canNavigateForward:!1,backHistory:[],forwardHistory:[]},correlation:Object.assign(Object.assign({},e),{__typename:"Correlation"}),extendedEntityContainerState:Kb(),blockingEntityExtension:null,isMainWindow:!o||c!==ve.su.new&&n===h.ew||l===xe.PHN.main,isNotificationsWindow:!1,isInitialWindowStateHidden:r===ve.fe.showWithoutFocusing,userContextId:s,layoutConfig:{__typename:"LayoutConfig",layoutMode:null!=i?i:t===h.ew||c!==ve.su.new||l===xe.PHN.main?ve.lO.standard:ve.lO.focus,isFullscreen:!1,slots:cy()}}}(n,l,o,i,e,r,s)):Jy(i)||e.targetWindow===xe.PHN.main?(a.log(`Retrieving mainWindow with layoutMode ${o} for correlation ${n.id}`),Vy(t,null!=o?o:ve.lO.standard)):(a.log(`Retrieving window with id ${i} for correlation ${n.id}`),Qy(t,i))}({activeWindows:e,command:t,correlation:n,isNewContextSupportEnabled:o,layoutMode:r,logger:l,userContextId:d,windowId:u,webNrcEnabled:m});if(!S)throw function(e,t){var i;return null===(i=t.errorToTelemetry)||void 0===i||i.call(t,"Unable to get source window",Qk,void 0,!0),(0,oe.Tr)(h.w5.Commanding,h.jK.UndefinedWindowError,"CommandResolvers",e,"Unable to find applicable target window")}(n,l);return[S,k]}function gS(e,t,i,n,a){const s=Xb(e),{webNrcEnabled:o}=a.get(S.J.Host),r=o?e=>e.id!==h.ew:void 0,[c,l]=Ub(t,$b,r),[d]=Yy(s,c,l,n,a);return d&&(i.log(`Found window for entity ${uy(s)}`),hy(d,i)),d||null}function hS(e,t,i,n){const a=e.activeEntities;return!!(null==a?void 0:a.entityExtension)&&(a.entityExtension=null,e.extendedEntityContainerState.containerState=ve.oq.Error,zy(t,i,e,n))}const pS=(e,t,i,a,s,o)=>{const{appsRegistryService:r,cache:c,commandChangeReportingService:l,localStorage:d,coreSettings:u,windowId:m}=i,g=(0,n.__rest)(i,["appsRegistryService","cache","commandChangeReportingService","localStorage","coreSettings","windowId"]),h=Object.assign(Object.assign({},e),{extendedEntityContainerState:Object.assign(Object.assign({},e.extendedEntityContainerState),t)}),p=e.blockingEntityExtension;h.blockingEntityExtension=null;const v=zy(i,s,h,a),f=((e,t,i)=>{const n=null==e?void 0:e.blockedEntity,a=null==e?void 0:e.blockedCommand,s=null==e?void 0:e.blockedEntityOptions;if(!n||!a)return t.warn("Unable to re-create the command which was blocked and saved."),null;const o=Qb();o.source=k.D.CoreResolvers;const r={entity:n,command:Object.assign(Object.assign({},a),{correlation:o}),entityOptions:s};return i.report({type:Ge.B.CommandStart,correlationId:r.command.correlation.id,context:{target:"createAndRegisterBlockedCommandOnConfirm",entityCommand:Object.assign(Object.assign({},r),{entityOptions:s?JSON.parse(s):void 0})}}),r})(p,a,l);if(f){const{entity:e,command:t,entityOptions:i}=f;return!!wS({entity:e,command:t,entityOptions:i,windowId:m,clientLaunchId:h.correlation.clientLaunchId},Object.assign({appsRegistryService:r,cache:c,commandChangeReportingService:l,coreSettings:u,localStorage:d,windowId:m},g),o)}return v},vS=({entity:e,windowId:t},i)=>{const{cache:n,loggerFactory:a,activeWindowsService:s}=i,o=a.newLogger("removeFromWindowHistory-mutation","data-client-entity-command"),r=Xb(e);o.log(`Removing entity from history: ${uy(r)}`);const c=By(n,o,s),l=Qy(c,t);return l?((({window:e,entity:t,logger:i,context:n,activeWindows:a})=>{const{localStorage:s,coreSettings:o,appsRegistryService:r}=n;let c=0,l=!1;const d=[];e.windowHistory.forEach(((i,n)=>{Rb(t,i.activeEntities)?n<e.currentWindowHistoryIndex?c++:n===e.currentWindowHistoryIndex&&(l=!0):d.push(i)}));const u=e.currentWindowHistoryIndex===e.windowHistory.length-1||l?void 0:e.currentWindowHistoryIndex-c;if(e.windowHistory=d,Py(e,i,u,o),Gy(a,e.id)){const{enableWindowHistoryRestorationOnStandardMain:n,enableWriteAppHistoryToLocalStorage:a,enableWriteActiveEntitiesToLocalStorage:c,enableMTMACommanding:l}=o.get(S.J.Core);if(n&&xy(e,s,i),a&&r.appsWithAppHistoryStored.forEach((n=>{const a=Fy({localStorage:s,logger:i,appsRegistryService:r,userContextId:e.userContextId,entityType:void 0,appId:n});a&&Rb(t,a)&&s.remove((0,Ty.bM)(`${Ty.av}-${n}`,e.userContextId),"Experience")})),c){const n=Ey(s,i,e.userContextId,l);n&&Rb(t,n)&&s.remove((0,Ty.bM)(Ty.WD,e.userContextId),"Experience")}}})({window:l,entity:r,logger:o,context:i,activeWindows:c}),zy(i,c,l,o,void 0,void 0,!0)):(o.warn(`Could not retrieve window with id ${t}`),!1)},fS=({logger:e,appsRegistryService:t,coreSettings:i,layoutMode:n})=>{const a=t.getDefaultCommand(i,n);return a?(e.log("Default command found"),a):(e.error("No default command defined"),null)},bS=({context:e,correlation:t,logger:i,newEntity:n,shouldUseNewEntity:a,sourceWindow:s,stateTransition:o})=>{const{commandChangeReportingService:r,clientPreferences:c,appsRegistryService:l,coreSettings:d}=e,{appEntity:u,contextEntity:m}=by({currentEntities:Wb(s)?s.activeEntities:void 0,entity:n,shouldUseNewEntity:a});t&&r.report({type:Ge.B.CommandBeforeGetAppViewEntities,context:{target:"executeEntityCommand"},correlationId:t.id});let g=null;try{g=ky({appsRegistryService:l,clientPreferences:c,contextEntity:m,coreSettings:d,entity:u,layoutMode:s.layoutConfig.layoutMode}),(({appViewEntities:e,stateTransition:t,appEntity:i,linkedEntity:n})=>t!==ve.su.none&&null===e&&i===n)({appEntity:u,appViewEntities:g,linkedEntity:n.linkedEntity,stateTransition:o})&&(i.log(`Initial getAppViewEntities for ${u} returned null`),g=ky({entity:n,clientPreferences:c,contextEntity:null,coreSettings:d,layoutMode:s.layoutConfig.layoutMode,appsRegistryService:l}))}catch(e){t&&r.report({type:Ge.B.Failure,context:{errorInfo:Je.y.CommandGetAppViewEntitiesFailure,errorMessage:e.message,target:"executeEntityCommand"},correlationId:t.id})}return g},yS=({isInputDefaultEntity:e,sourceWindow:t,context:i,userContextId:n,newEntity:a,matchedLinkedEntity:s,stateTransition:o,executionContext:r,correlation:c,logger:l})=>{var d;const{localStorage:u,coreSettings:m,appsRegistryService:g,clientPreferences:h}=i,{enableWriteActiveEntitiesToLocalStorage:p,enableMTMACommanding:v,enableWriteAppHistoryToLocalStorage:f}=m.get(S.J.Core);let b=null,y=!1;e&&t.isMainWindow&&p?b=Ey(u,l,n,v):a.action===xe.ukP.default&&t.isMainWindow&&f&&(b=Fy({localStorage:u,logger:l,appsRegistryService:g,userContextId:n,entityType:a.type}));const k=Wb(t)?t.activeEntities:void 0;if(b){l.log("Got appViewEntities from local storage history: "),vy(b,l);const e=_S(b,g),i=_S(k,g),n=null===(d=null==e?void 0:e.onBeforeNavigationFromHistory)||void 0===d?void 0:d.call(e,b,{coreSettings:m,layoutMode:t.layoutConfig.layoutMode,userPreferences:yy(h)},(null==i?void 0:i.manifest.id)===(null==e?void 0:e.manifest.id)?k:void 0);y=!!n,y&&(l.log("App declared history invalid. New set of entities:"),vy(n,l)),b=n||b}else{const e=(({currentEntities:e,newEntity:t,matchedLinkedEntity:i,stateTransition:n,executionContext:a})=>!e||nS({entity:t,mainEntity:e.mainEntity,matchedLinkedEntity:i,stateTransition:n})||iS({activeEntities:e,stateTransition:n,executionContext:a}))({currentEntities:k,newEntity:a,matchedLinkedEntity:s,stateTransition:o,executionContext:r});l.log(`Should use entity from command input for getAppViewEntities ${e} `),b=bS({context:i,correlation:c,logger:l,newEntity:a,shouldUseNewEntity:e,sourceWindow:t,stateTransition:o})}return{appViewEntities:b,isCurrentEntitiesInvalid:y}},kS=({context:e,correlation:t,logger:i,newEntity:n,pubsub:a,sourceWindow:s,stateTransition:o,userContextId:r})=>{i.log(`Targeting main window, but userContextId of command ${r} does not match main window user ${s.userContextId}`);const{coreSettings:c,appsRegistryService:l}=e,d=(({appsRegistryService:e,coreSettings:t,newEntity:i,stateTransition:n})=>{var a,s,o;let r=!1;return n===xe.suD.flush&&(r=(null===(o=null===(a=e.getApp({entityType:i.type}))||void 0===a?void 0:(s=a.manifest).getAllowUserWindowingPreference)||void 0===o?void 0:o.call(s,{coreSettings:t,entity:i}))||!1),r})({appsRegistryService:l,coreSettings:c,newEntity:n,stateTransition:o});return i.log(`allowUserWindowingPreference: ${d}`),d?(i.log("Popping out"),wS({entity:n,command:{stateTransition:xe.suD.new,visibilityState:xe.feW.show,correlation:t},windowId:s.id,clientLaunchId:s.correlation.clientLaunchId,executionContext:{userContextId:r},entityOptions:n.options},e,a),null):(({correlation:e,sourceWindow:t,logger:i,context:n,pubsub:a,userContextId:s,newEntity:o})=>{i.log("Launching switch account dialog");const{authenticationService:r}=n;return s?(r.getUser({accountId:s,correlation:e}).then((r=>(i.log(`Got user from auth service ${r.id}`),wS({entity:{type:xe.pyR.switchaccountdialog,action:xe.ukP.view},command:{stateTransition:xe.suD.extend,visibilityState:xe.feW.show,correlation:e},entityOptions:JSON.stringify({originalCorrelation:e,originalEntity:o,userContextId:s,userName:r.userName}),windowId:t.id,clientLaunchId:t.correlation.clientLaunchId},n,a)))).catch((e=>{var t;null===(t=i.errorToTelemetry)||void 0===t||t.call(i,"Unable to getUser from auth",Qk,void 0,!0)})),null):(i.log("UserContextId is undefined so unable to launch switch account dialog"),null)})({correlation:t,sourceWindow:s,logger:i,context:e,pubsub:a,userContextId:r,newEntity:n})},SS=({command:e,context:t,correlation:i,entitiesMap:n,entityOptions:a,executionContext:s,logger:o,matchedLinkedEntity:r,pubsub:c,sourceHint:l,sourceWindow:d,userContextId:u,windowOptions:m,newEntity:g})=>{const{coreSettings:h,commandChangeReportingService:p}=t,{enableEmptyWindowDialogForDeeplink:v}=h.get(S.J.Core),{stateTransition:f,targetWindow:b}=e;if(f===xe.suD.extend){if(f===xe.suD.extend&&v&&!Wb(d)&&d.isMainWindow){const e=(({context:e,correlation:t,entitiesMap:i,entityOptions:n,executionContext:a,logger:s,matchedLinkedEntity:o,pubsub:r,sourceHint:c,sourceWindow:l,userContextId:d,windowOptions:u})=>{const{authenticationUser:m,coreSettings:g,appsRegistryService:h,commandChangeReportingService:p,clientPreferences:v,windowProvider:f}=e,{enableMultiSlotHide:b,enableMultiSlotNone:y}=g.get(S.J.Core);if((null==m?void 0:m.role)===zo.w4.Anonymous){const e=Je.y.EmptyWindowError;return s.log(`Anonymous user - extension command error ${e}`),p.report({correlationId:t.id,type:Ge.B.Incomplete,context:{errorInfo:e,target:"executeEntityCommand"}}),null}s.log("Extension command - creating main window");const k=fS({logger:s,appsRegistryService:h,coreSettings:g,layoutMode:l.layoutConfig.layoutMode});if(!k)throw new Error("No default entity. Unable to show extension");const w=Xb(k,n,u),{appViewEntities:j,isCurrentEntitiesInvalid:C}=yS({isInputDefaultEntity:!0,sourceWindow:l,context:e,userContextId:d,newEntity:w,matchedLinkedEntity:!1,stateTransition:xe.suD.flush,executionContext:a,correlation:t,logger:s});return s.log(`Extension command - flushing with entity ${uy(w)}`),vy(j,s),l=lS(xe.feW.show,{appsRegistryService:h,appViewEntities:j||void 0,clientPreferences:v,commandChangeReportingService:p,correlation:t,coreSettings:g,enableMultiSlotHide:b,enableMultiSlotNone:y,entitiesMap:i,entity:w,entityOptions:n,executionContext:a,host:f,isCurrentEntitiesInvalid:C,isInputDefaultEntity:!0,logger:s,matchedLinkedEntity:o,sourceHint:c,stateTransition:xe.suD.flush,userContextId:d,window:l},e,r),s.log("Extension command - created source window"),hy(l,s),l})({context:t,correlation:i,entitiesMap:n,entityOptions:a,executionContext:s,logger:o,matchedLinkedEntity:r,pubsub:c,sourceHint:l,sourceWindow:d,userContextId:u,windowOptions:m});if(!e)return null;if(!Wb(d=e))return o.log("Tried creating main window for dialog but window is empty"),p.report({correlationId:i.id,type:Ge.B.Incomplete,context:{errorInfo:Je.y.EmptyWindowError,target:"executeEntityCommand"}}),null}if(!(y=g,y.type===xe.pyR.switchaccountdialog&&y.action===xe.ukP.view||d.userContextId===u))return o.log("User context of source window does not match user context of command. Rejecting command"),p.report({correlationId:i.id,type:Ge.B.Incomplete,context:{errorInfo:Je.y.UserContextMismatch,target:"executeEntityCommand"}}),null}else if((({sourceWindow:e,stateTransition:t,targetWindowType:i,userContextId:n})=>i===xe.PHN.main&&(t===xe.suD.forceFlush||t===xe.suD.flush)&&e.userContextId!==n)({sourceWindow:d,stateTransition:f,targetWindowType:b,userContextId:u}))return kS({context:t,correlation:i,logger:o,newEntity:g,pubsub:c,sourceWindow:d,stateTransition:f,userContextId:u});var y;return d},wS=({clientLaunchId:e,command:t,entity:i,entityOptions:n,executionContext:a,windowId:s,windowOptions:o},r,c)=>{var l,d,u,m,g,p,v,f;const{appsRegistryService:b,authenticationUser:y,cache:k,clientPreferences:w,commandChangeReportingService:j,coreSettings:C,experienceChangeReportingService:_,loggerFactory:T,notificationsHandler:I,windowProvider:N,scenarioFactory:E,activeWindowsService:F}=r,x=T.newLogger("executeEntityCommand-mutation","data-client-entity-command"),{visibilityState:D,stateTransition:A,correlation:M,layoutMode:P}=t;try{const f=s||h.ew,T=((e,t)=>t?Object.assign(Object.assign({},t),{clientLaunchId:null!=e?e:null,__typename:"Correlation"}):Object.assign(Object.assign({},Qb()),{clientLaunchId:null!=e?e:null,__typename:"Correlation"}))(null!=e?e:null,M);j.report({correlationId:T.id,type:Ge.B.CommandResolutionStarted,context:{target:"executeEntityCommand"}});const O=By(k,x,F),[R,L]=Ub(O,$b,(e=>!Gy(O,e.id)&&!((e,t)=>{const i=Vy(e,ve.lO.minimal);return t===(null==i?void 0:i.id)})(O,e.id)&&!((e,t)=>{const i=Vy(e,ve.lO.minimode);return t===(null==i?void 0:i.id)})(O,e.id))),U=(e=>e.action===pe.uk.default&&e.type===pe.py.default)(i),$=(e=>e.action===pe.uk.view&&e.type===pe.py.default)(i),W=null==M?void 0:M.sourceHint,B=(({entity:e,isInputDefaultEntity:t,isInputDefaultViewEntity:i,logger:n,appsRegistryService:a,coreSettings:s,layoutMode:o})=>t||i?fS({logger:n,appsRegistryService:a,coreSettings:s,layoutMode:o}):e)({entity:i,isInputDefaultEntity:U,isInputDefaultViewEntity:$,logger:x,appsRegistryService:b,coreSettings:C,layoutMode:P});if(!B)return null===(l=x.errorToTelemetry)||void 0===l||l.call(x,"Unable to use entity from command input",Qk,void 0,!0),null;const H=Xb(B,n,o);if(function(e){return e.type===pe.py.toasts}(H))return Jk({activeWindows:O,context:r,command:t,correlation:T,entity:i,entityOptions:n,logger:x,notificationsHandler:I,newEntity:H});x.log(`Command received for entity ${uy(H)}`),x.log(`Command received :${function(e){return`{\n  visibilityState: ${e.visibilityState},\n  stateTransition: ${e.stateTransition},\n  correlation: ${my(e.correlation,1)},\n  layoutMode: ${e.layoutMode},\n  targetWindow: ${e.targetWindow}\n}`}(t)}`),x.log(`Command with id ${T.id} received on window context ${f}`),x.log(`Command received with execution context: ${null==a?void 0:a.viewEntityName}`),((e,t,i,n)=>{var a;const{stateTransition:s,targetWindow:o}=e,{enableCommandingMainWindowTargeting:r}=n.get(S.J.Core);if(o&&!r||o===xe.PHN.main&&s!==xe.suD.extend&&s!==xe.suD.forceFlush&&s!==xe.suD.flush)throw null===(a=t.errorToTelemetry)||void 0===a||a.call(t,`Invalid command targetWindow ${o} stateTransition ${s}`,Qk,void 0,!0),(0,oe.Tr)(h.w5.Commanding,h.jK.InvalidInput,"CommandResolvers",i,`Invalid command ${o} stateTransition ${s}`)})(t,x,T,C);const{isNewContextSupportEnabled:q,webNrcEnabled:V}=C.get(S.J.Host),{enableMultiSlotHide:G,enableMultiSlotNone:J,enableWindowNotUpdatedEvent:K,enableMTMACommanding:Q,forceFocusLayoutMode:Y,enableWindowHistoryRestorationOnStandardMain:X,enableT21WebNewContextsOverride:Z}=C.get(S.J.Core),ee=Vy(O,xe.lOW.standard),te=Q&&((null==a?void 0:a.userContextId)||iy(y)||A===xe.suD.extend&&ee&&ee.userContextId)||null;x.log(`isNewContextSupportEnabled ${q}, enableMultiSlotHide ${G}, enableMultiSlotNone ${J}`);let ie=q;q||Z&&H.type===pe.py.brbfeedbackdialog&&(ie=!0);const ne=((e,t)=>t?ve.lO.focus:e&&(e.layoutMode||ve.lO.focus))(N.Cypress,!!Y),ae=mS({activeWindows:O,command:t,coreSettings:C,correlation:T,entitiesMap:R,entity:H,isNewContextSupportEnabled:null==ie||ie,layoutMode:null!=ne?ne:P,linkedEntitiesMap:L,logger:x,userContextId:te,windowId:f,webNrcEnabled:null!=V&&V});let[se]=ae;const[,re]=ae;let ce=!1;X&&se&&!Wb(se)&&se.isMainWindow&&se.layoutConfig.layoutMode===xe.lOW.standard&&(se=((e,t,i,n,a)=>{var s,o;const r=t.get((0,Ty.bM)(Ty.Hs,n),"Experience");if(r)try{const c=JSON.parse(r);if(a&&n!==c.userContextId)return null===(s=i.warnToTelemetry)||void 0===s||s.call(i,"User context of window doesn't match user context of stored history","webclient_framework_foundation_core_services_entity_commanding",void 0,!0),e;const l=parseInt(c.windowHistoryIndex,10);if(isNaN(l))return null===(o=i.warnToTelemetry)||void 0===o||o.call(i,`Store window history has invalid history index. CurrentWindowHistoryIndex ${c.windowHistoryIndex}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0),e;const d=t.get((0,Ty.bM)(Ty.ax,n),"Experience");if(d){const t=My(JSON.parse(d),i);return Object.assign(Object.assign({},e),{windowHistory:t,currentWindowHistoryIndex:l})}i.warn("Could not restore history from storage")}catch(e){i.errorToTelemetry&&i.errorToTelemetry(`Could not restore main window nav history from local storage ${e.message}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0)}else i.warn("Could not restore main window nav history index from local storage. IndexAndUserFromStorage is null");return e})(se,r.localStorage,x,te,Q),se.windowHistory.length>0&&(x.log("Restored main window navigation history from local storage"),ce=!0));const le=SS({command:t,context:r,correlation:T,entitiesMap:R,entityOptions:n,executionContext:a,logger:x,matchedLinkedEntity:re,pubsub:c,sourceHint:W,sourceWindow:se,userContextId:te,windowOptions:o,newEntity:H});if(null===le)return null;se=le;const{appViewEntities:de,isCurrentEntitiesInvalid:ue}=yS({isInputDefaultEntity:U,sourceWindow:se,context:r,userContextId:te,newEntity:H,matchedLinkedEntity:re,stateTransition:A,executionContext:a,correlation:T,logger:x});if(j.report({type:Ge.B.CommandAfterGetAppViewEntitiesSucceeded,context:{target:"executeEntityCommand"},correlationId:T.id}),x.log("Final appViewEntities: "),vy(de,x),x.log(`Before updating cache, There are ${O.length} active windows`),x.log("Source window: "),hy(se,x),null===de)throw null===(d=x.errorToTelemetry)||void 0===d||d.call(x,"No app supports entity command",Qk,void 0,!0),new Error("no app view entities for entity input");let me=lS(D,{appsRegistryService:b,appViewEntities:de,clientPreferences:w,commandChangeReportingService:j,correlation:T,coreSettings:C,enableMultiSlotHide:G,enableMultiSlotNone:J,entitiesMap:R,entity:H,entityOptions:n,executionContext:a,host:N,isCurrentEntitiesInvalid:ue,isInputDefaultEntity:U,logger:x,matchedLinkedEntity:re,sourceHint:W,stateTransition:A,userContextId:te,window:se},r,c);x.log("Target window: "),hy(me,x),Wb(se)&&Wb(me)&&(null===(u=se.activeEntities)||void 0===u?void 0:u.monitorEntity)&&(me.activeEntities.monitorEntity=null===(m=se.activeEntities)||void 0===m?void 0:m.monitorEntity),Wb(se)&&Wb(me)&&(null===(g=se.activeEntities)||void 0===g?void 0:g.inAppNotificationsEntity)&&t.visibilityState!==ve.fe.hide&&(me.activeEntities.inAppNotificationsEntity=null===(p=se.activeEntities)||void 0===p?void 0:p.inAppNotificationsEntity);const ge=function(e,t){return Bb(Wb(e)?e.activeEntities:null,Wb(t)?t.activeEntities:null)}(se,me);!function(e,t,i,n,a,s,o){const r=(0,hs.YR)(e,i);o.log(`ViewportContext: ${r}`);const c={"Panel.WindowID":t,"Window.ViewportContext":r};a.report({correlationId:n,type:Ge.B.ScenarioEventDataAppended,context:{target:"setViewportContextOnLaunchScenarios",eventData:c}});const l=s.findScenario(z.RG.WindowLaunchTime);null==l||l.appendEventData(c)}(me.isMainWindow,me.id,me.layoutConfig.layoutMode,T.id,j,E,x),j.report({correlationId:T.id,type:Ge.B.CommandMetaDataAdded,context:{target:"executeEntityCommand",isCommandTargetedToMainWindow:me.id===h.ew,shouldNavigate:Hb(se,me,A,H)}});const he=se.id===h.ew&&A!==xe.suD.new&&A!==xe.suD.none,fe=A===xe.suD.flow||A===xe.suD.none;if(nk(ge,f,he,fe,C,x)){x.log(`Opener will handle the requested entity change with correlationId ${T.id} and entityId ${i.id}`);let e=!0;ge.entityExtension&&(me.extendedEntityContainerState.isExternal=!0,e=zy(r,O,me,x));const t=Qy(O,h.ew);if(t&&(e=>!(!e.activeEntities.entityExtension||e.extendedEntityContainerState.containerState===ve.oq.Closed))(t)&&Bk(t,O,x,T,r),e)try{return(({correlation:e,diff:t,commandChangeReportingService:i,windowId:n,logger:a,targetWindow:s,context:o,activeWindows:r})=>{var c;if(ak(e,t,i,n,a,o.coreSettings))return null;throw hS(s,o,r,a),null===(c=a.errorToTelemetry)||void 0===c||c.call(a,"Unable to update cache, opener did not handle change",Qk),(0,oe.Tr)(h.w5.Commanding,h.jK.UnhandledRuntimeException,"executeEntityCommand",void 0,"Unable to update cache, opener did not handle the entity change")})({correlation:T,diff:ge,commandChangeReportingService:j,windowId:f,logger:x,targetWindow:me,context:r,activeWindows:O})}catch(e){throw hS(me,r,O,x),null===(v=x.errorToTelemetry)||void 0===v||v.call(x,"Unable to update cache, errored while having opener handle change",Qk,{errors:`${e.message}`}),(0,oe.Tr)(h.w5.Commanding,h.jK.UnhandledRuntimeException,"executeEntityCommand",e,"Unable to update cache, opener threw an exception and did not handle the entity change")}}if(((e,t,i)=>{const n=Wb(e)?e.activeEntities.entityExtension:null,a=Wb(t)?t.activeEntities.entityExtension:null;return!(t.extendedEntityContainerState.containerState===ve.oq.Closed||!(n&&Jb(i)||!a))})(se,me,ge)&&(me=((e,t,i,n,a)=>{let s=e;return e.extendedEntityContainerState.isExternal?i.log(`Internal routing - closing external dialog for correlation ${a.id}`):(i.log(`Internal routing - closing internal dialog for correlation ${a.id}`),Wb(e)&&(s=zk(e,a))),e.id===h.ew&&(i.log(`Internal routing - send close extension to angular for correlation ${a.id}`),Wk(t,i,n)),s})(me,se,x,j,T)),x.log(`Handling the requested entity command internally for correlation ${T.id}`),Zy({pubsub:c,fromWindowId:f,isFromWindowMain:Gy(O,f),sourceWindowId:se.id,diff:ge,targetWindow:me,targetVisibilityState:D,stateTransition:A,correlation:T,logger:x}),Py(me,x,ce?me.currentWindowHistoryIndex:void 0,C),K&&!zb(se,me))return j.report({correlationId:T.id,type:Ge.B.WindowNotUpdated,context:{target:"executeEntityCommand"}}),null;if(se.correlation.id!==T.id){const e=Wb(se)?se.activeEntities:void 0;e&&j.report({correlationId:T.id,type:Ge.B.ScenarioEventDataAppended,context:{target:"executeEntityCommand",eventData:{fromMainEntityType:e.mainEntity.type,fromMainEntityAction:e.mainEntity.action}}}),j.report({correlationId:se.correlation.id,type:Ge.B.Abandoned,context:{target:"executeEntityCommand"}}),_.report({correlationId:T.id,type:Mt.yU.ActiveEntitiesDestroyed,context:{target:"entity-command-resolver"},windowId:se.id})}!Ob(Wb(me)?me.activeEntities.mainEntity:null,Wb(se)?se.activeEntities.mainEntity:null)&&Wb(se)&&(me=ry(me,{resetMonitor:null===se.activeEntities.monitorEntity}));const be=()=>{const e=function(e){const t=[];return Object.keys(e).map((i=>{const n=e[i];n&&t.push(n)})),t}(ge);e.length>0&&_.report({correlationId:T.id,type:Mt.yU.ActiveEntitiesResolved,context:{target:"entity-command-resolver",entities:e},windowId:me.id}),j.report({correlationId:T.id,type:Ge.B.WindowUpdated,context:{target:"executeEntityCommand"}})},ye=zy(r,O,me,x,T.id,be);return ye&&!F.enableDecoupleCommandingFromApollo&&be(),ye&&Wb(me)?me:null}catch(e){throw null===(f=x.errorToTelemetry)||void 0===f||f.call(x,`Unable to execute entity command ${D} ${A} -  ${e.message}`,Qk,{mainEntityType:i.type,mainEntityAction:i.action,correlationId:M.id},!0),e}},jS=(e,t,i,a)=>{var{cache:s,windowId:o,commandChangeReportingService:r}=i,c=(0,n.__rest)(i,["cache","windowId","commandChangeReportingService"]);if(!e.activeEntities.entityExtension)return!1;const l=$k(e,t,r);if(l){const{entity:t,command:i}=l;return wS({entity:t,command:i,windowId:o,clientLaunchId:e.correlation.clientLaunchId},Object.assign({cache:s,windowId:o,commandChangeReportingService:r},c),a)}return!1},CS=e=>({Query:{activeWindow(e,{windowId:t},{cache:i,coreSettings:n,loggerFactory:a,activeWindowsService:s}){const o=a.newLogger("activeWindow","data-client-entity-command"),{webNrcEnabled:r}=n.get(S.J.Host),c=t||h.ew;let l;const d=By(i,o,s,!1);if(l=c===h.ew&&r?Vy(d,xe.lOW.standard):d.find((e=>e.id===c)),!l)throw new Error(`Requesting activeWindow for unknown windowId ${c}`);return l},activeWindowForEntity(e,{entity:t},{cache:i,loggerFactory:n,authenticationUser:a,coreSettings:s,activeWindowsService:o}){const r=n.newLogger("activeWindowForEntity-query","data-client-entity-command"),c=By(i,r,o),{enableMTMACommanding:l}=s.get(S.J.Core);return gS(t,c,r,l?iy(a):null,s)},isEntityInActiveWindow(e,{entity:t,windowId:i},{cache:n,loggerFactory:a,activeWindowsService:s}){var o;const r=a.newLogger("isEntityInActiveWindow-query","data-client-entity-command"),c=Qy(By(n,r,s),i),l=Xb(t);if(r.log(`Querying window ${i} for entity: ${uy(l)}`),!c)return null===(o=r.errorToTelemetry)||void 0===o||o.call(r,`No window found for windowId ${i}`,Qk,void 0,!0),!1;const d=function(e,t){return Ob(e,t.subNavEntity)||Ob(e,t.headerEntity)||Ob(e,t.startEntity)||Ob(e,t.mainEntity)||Ob(e,t.endEntity)}(l,c.activeEntities);return r.log(`entityExist: ${d}`),d}},Mutation:{navigateToWindowHistoryIndex:(e,t,i)=>(({windowId:e,windowHistoryIndex:t},i)=>{var n;const{cache:a,loggerFactory:s,activeWindowsService:o}=i,r=s.newLogger("navigateToWindowHistoryIndex-mutation","data-client-entity-command");r.log(`Navigating to windowHistoryIndex ${t} on window ${e}.`);const c=By(a,r,o),l=Qy(c,e);if(!l)throw new Error("Could not find window.");return!(0===(null===(n=l.windowHistory)||void 0===n?void 0:n.length)||t<0||t>l.windowHistory.length-1)&&tk(l,t,r,c,i)})(t,i),performWindowHistoryNavigation:(e,t,i)=>(({windowId:e,navigationDirection:t},i)=>{var n;const{cache:a,loggerFactory:s,activeWindowsService:o}=i,r=s.newLogger("performWindowHistoryNavigation-mutation","data-client-entity-command");r.log(`Navigating ${e} with direction ${t}.`);const c=By(a,r,o),l=Qy(c,e);if(!l)throw new Error("Could not find window.");if(0===(null===(n=l.windowHistory)||void 0===n?void 0:n.length))return!1;let d=l.currentWindowHistoryIndex;const u=e=>r.warn(`Could not navigate ${t}. Index ${e} is out of the bounds of the window history.`);if(t===xe.fEB.back){if(d--,d<0)return u(d),!1}else if(++d,d>l.windowHistory.length-1)return u(d),!1;return tk(l,d,r,c,i)})(t,i),pushToWindowHistory:(e,t,i)=>(({entity:e,entityOptions:t,windowId:i},n)=>{var a;const{cache:s,loggerFactory:o,activeWindowsService:r,coreSettings:c}=n,l=o.newLogger("pushToWindowHistory-mutation","data-client-entity-command"),d=Xb(e,t);l.log(`Saving entity to history: ${uy(d)}`);const u=By(s,l,r),m=Qy(u,i);if(!m)return l.warn(`Could not retrieve window with id ${i}`),!1;const g=bS({context:n,logger:l,newEntity:d,shouldUseNewEntity:!0,sourceWindow:m,stateTransition:xe.suD.flush}),{subNavEntity:h=null,headerEntity:p=null,startEntity:v=null,mainEntity:f=null,endEntity:b=null,monitorEntity:y=null,inAppNotificationsEntity:k=null}=Object.assign({},g),S={__typename:"ActiveEntities",subNavEntity:aS(h,void 0),headerEntity:Yb(p),startEntity:Yb(v),mainEntity:null!==(a=Yb(f))&&void 0!==a?a:d,endEntity:Yb(b),entityExtension:null,monitorEntity:y,inAppNotificationsEntity:k},w={activeEntities:m.activeEntities,windowHistory:m.windowHistory,currentWindowHistoryIndex:m.currentWindowHistoryIndex,layoutMode:m.layoutConfig.layoutMode,userContextId:m.userContextId,windowId:m.id},[j]=Uy({context:n,isUserContextSwitch:!1,logger:l,newActiveEntities:S,windowContentState:w,skipMoveToTop:!0});return m.windowHistory=j,Py(m,l,void 0,c),zy(n,u,m,l)})(t,i),removeFromWindowHistory:(e,t,i)=>vS(t,i),updateEntity(e,{entity:t,entityOptions:i,viewEntityName:n,windowId:a},s){const{cache:o,loggerFactory:r,activeWindowsService:c}=s,l=a||h.ew,d=r.newLogger("updateEntity-mutation","data-client-entity-command"),u=By(o,d,c),m=Qy(u,l);if(!m)return d.warn("Trying to update entity in window that does not exist"),!1;if(m.userContextId&&s.authenticationUser&&m.userContextId!==iy(s.authenticationUser))return d.warn("Trying to update entity in for a different user context than currently present on the window"),!1;const g=Xb(t,i);return d.log(`Updating entity with input: ${uy(g)}`),function({entity:e,window:t,viewEntityName:i,context:n,logger:a}){var s;const{coreSettings:o}=n,r=qb(Gb(t.activeEntities,(null===(s=t.windowHistory[t.windowHistory.length-1])||void 0===s?void 0:s.activeEntities)||null,!0));if(t.activeEntities[i]=Object.assign(Object.assign({},t.activeEntities[i]),e),r){t.windowHistory.pop(),Py(t,a,void 0,o);const e={activeEntities:t.activeEntities,windowHistory:t.windowHistory,currentWindowHistoryIndex:t.currentWindowHistoryIndex,layoutMode:t.layoutConfig.layoutMode,userContextId:t.userContextId,windowId:t.id},[i]=Uy({context:n,isUserContextSwitch:!1,logger:a,newActiveEntities:t.activeEntities,windowContentState:e});t.windowHistory=i,Py(t,a,void 0,o)}}({window:m,entity:g,viewEntityName:n,context:s,logger:d}),zy(s,u,m,d)},updateEntityState(e,{entity:t,entityState:i},n){const{authenticationUser:a,cache:s,coreSettings:o,loggerFactory:r,activeWindowsService:c}=n,{enableMTMACommanding:l}=o.get(S.J.Core),d=r.newLogger("updateEntityState-mutation","data-client-entity-command"),u=By(s,d,c),m=gS(t,u,d,l?iy(a):null,o);if(!m)return d.warn("Trying to update flushable entity that does not exist"),!1;return function(e,t,i,n){const{mainEntity:a,endEntity:s}=e.activeEntities,{flushableByLinkedEntity:o,linkedEntityUpdate:r}=i;Ob(a,t)?(null!=o&&(a.entityState.flushableByLinkedEntity=o),dS(a,r)):s&&Ob(s,t)?(n.log("Updating entity state for end entity"),dS(s,r)):n.warn(`Updating entity state for entity the does not exist ${t}`)}(m,Xb(t),i,d),zy(n,u,m,d),!0},updateExtendedEntityContainerState(t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{cache:t,loggerFactory:n,windowId:s,windowProvider:o,activeWindowsService:r}=a,c=n.newLogger("updateExtendedEntityContainerState-mutation","data-client-entity-command"),l=By(t,c,r),d=Qy(l,s);if(d)if(((e,t)=>{var i;return e===ve.oq.Confirmed&&(null===(i=t.blockingEntityExtension)||void 0===i?void 0:i.entity)&&Ob(t.activeEntities.entityExtension,t.blockingEntityExtension.entity)})(i.containerState,d))d.id===h.ew&&o.opener.postMessage(w.W.MainWindowBlockedState,{isBlocked:"Confirmed",entity:null}),pS(d,i,a,c,l,e);else{if(i.containerState!==ve.oq.Closed)return d.extendedEntityContainerState=Object.assign(Object.assign({},d.extendedEntityContainerState),i),zy(a,l,d,c);jS(d,c,a,e)}return!1}))},executeEntityCommand:(t,i,n)=>wS(i,n,e),addBlockingExtension:(t,{entity:i,entityOptions:a,windowId:s,removeBlock:o},r)=>{var{cache:c,loggerFactory:l,windowProvider:d,activeWindowsService:u,coreSettings:m}=r,g=(0,n.__rest)(r,["cache","loggerFactory","windowProvider","activeWindowsService","coreSettings"]);const p=l.newLogger("addBlockingExtension-mutation","data-client-entity-command");p.log(`${o?"Removing":"Adding"} an entity extension blocker of type ${i.type}`);const v=By(c,p,u),f=Qy(v,s);if(f){const t=Object.assign(Object.assign({},i),{id:i.id||null,linkedEntity:null,options:a||null,windowOptions:null,__typename:"Entity",entityState:{flushableByLinkedEntity:!1,__typename:"EntityState"}});if(o&&f.blockingEntityExtension)return((e,t,i,n,a,s)=>{const{windowProvider:o}=s;if(!t.blockingEntityExtension||!Ob(t.blockingEntityExtension.entity,e))return!1;const r=Object.assign(Object.assign({},t),{blockingEntityExtension:null}),c=zy(s,i,r,n);return r.id===h.ew&&o.opener.postMessage(w.W.MainWindowBlockedState,{isBlocked:"Unblocked",entity:null}),jS(t,n,s,a),c})(t,f,v,p,e,Object.assign({cache:c,loggerFactory:l,windowProvider:d,activeWindowsService:u,coreSettings:m},g));if(!o)return((e,t,i,n,a)=>{var s;const{windowProvider:o}=a,r={entity:e,__typename:"BlockingEntityExtension",blockedEntity:null,blockedCommand:null,blockedEntityOptions:null},c=Object.assign(Object.assign({},t),{blockingEntityExtension:r});if(c.id===h.ew)try{o.opener.postMessage(w.W.MainWindowBlockedState,{isBlocked:"Blocked",entity:r.entity,entityOptions:e.options&&JSON.parse(e.options)})}catch(e){null===(s=n.errorToTelemetry)||void 0===s||s.call(n,"Unable to parse and post addBlockingExtension to main window",Qk)}return zy(a,i,c,n)})(t,f,v,p,Object.assign({cache:c,windowProvider:d,loggerFactory:l,activeWindowsService:u,coreSettings:m},g))}return!1},setWindowFullscreen:(e,{isFullscreen:t,windowId:i},n)=>{const{cache:a,loggerFactory:s,activeWindowsService:o}=n,r=s.newLogger("setWindowFullscreen-mutation","data-client-entity-command"),c=By(a,r,o),l=Qy(c,i);if(!l)return null;let d=!1;return l.layoutConfig.isFullscreen!==t&&(l.layoutConfig.isFullscreen=t,d=zy(n,c,l,r)),d&&Wb(l)?l:null},removeUserActiveWindows:(e,{userContextId:t},i)=>{const{cache:n,loggerFactory:a,activeWindowsService:s}=i,o=a.newLogger("removeUserActiveWindowsMutation-mutation","data-client-entity-command"),r=((e,t)=>e.filter((e=>e.isMainWindow||e.userContextId!==t)))(By(n,o,s),t);return zy(i,r,void 0,o)},saveReactiveVarsToHistory(e,{windowId:t,appIds:i},n){const{cache:a,loggerFactory:s,activeWindowsService:o}=n,r=s.newLogger("saveReactiveVarsToHistory-mutation","data-client-entity-command"),c=t||h.ew,l=By(a,r,o),d=Qy(l,c);if(!d)return r.warn("Trying to save reactive var history for window that does not exist"),!1;if(0===d.windowHistory.length)return!1;const u={activeEntities:d.activeEntities,windowHistory:d.windowHistory,currentWindowHistoryIndex:d.currentWindowHistoryIndex,layoutMode:d.layoutConfig.layoutMode,userContextId:d.userContextId||null,windowId:d.id},[m,g]=Uy({appIdsForReactiveVarChange:i,context:n,isUserContextSwitch:!1,logger:r,newActiveEntities:d.activeEntities,windowContentState:u});if(!g)return r.log("Did not update history"),!1;const p=Object.assign(Object.assign({},d),{windowHistory:m});return Py(p,r,void 0,n.coreSettings),zy(n,l,p,r),!0}}}),_S=(e,t)=>{if(e){const i=fy(e);return t.getApp({entityType:i.type})}};var TS=i(790997),IS=i(331713),NS=i(593196),ES=i(748429),FS=i(216023);const xS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientVirtualEventsVirtualEventActionQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"virtualEventAction"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},DS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientVirtualEventsVirtualEventSchedulingFormDataQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"virtualEventSchedulingFormData"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasUnsavedChanges"}}]}}]}}]},AS={Query:{virtualEventAction(e,t,{cache:i,loggerFactory:n}){var a,s,o;try{return null!==(s=null===(a=i.readQuery({query:xS}))||void 0===a?void 0:a.virtualEventAction)&&void 0!==s?s:null}catch(e){const t=n.newLogger("virtual-event-action","data-client-virtual-events");return null===(o=t.errorToTelemetry)||void 0===o||o.call(t,"virtualEventAction: Failed to fetch virtual event action from cache.","virtual_event_form_action"),null}},virtualEventSchedulingFormData(e,t,{cache:i,loggerFactory:n}){var a,s,o;try{return null!==(s=null===(a=i.readQuery({query:DS}))||void 0===a?void 0:a.virtualEventSchedulingFormData)&&void 0!==s?s:null}catch(e){const t=n.newLogger("virtual-event-scheduling-form-data","data-client-virtual-events");return null===(o=t.errorToTelemetry)||void 0===o||o.call(t,"virtualEventSchedulingFormData: Failed to fetch virtual event scheduling form data from cache.","virtual_event_scheduling_form_data"),null}}},Mutation:{setVirtualEventAction(e,{input:{type:t}},{cache:i,loggerFactory:n}){var a;const s=n.newLogger("set-virtual-event-action","data-client-virtual-events");try{i.writeQuery({query:xS,data:{virtualEventAction:t}})}catch(e){return null===(a=s.errorToTelemetry)||void 0===a||a.call(s,"setVirtualEventStateAction: Failed to update virtual event action task in cache.","virtual_event_form_action"),null}return t},updateVirtualEventSchedulingFormData(e,{virtualEventSchedulingFormDataInput:t},{cache:i,loggerFactory:n}){var a,s;const o=n.newLogger("update-virtual-event-scheduling-form-data","data-client-virtual-events"),r={virtualEventSchedulingFormData:{__typename:"VirtualEventSchedulingFormData",hasUnsavedChanges:null!==(a=t.hasUnsavedChanges)&&void 0!==a&&a}};try{i.writeQuery({query:DS,data:r})}catch(e){return null===(s=o.errorToTelemetry)||void 0===s||s.call(o,"updateVirtualEventSchedulingFormData: Failed to update virtual event scheduling form data in cache.","virtual_event_scheduling_form_data"),null}return r.virtualEventSchedulingFormData}}};var MS=i(69585),PS=i(71119);const OS={Mutation:{updateArchiveTeamInfo:(e,{info:t},{cache:i})=>{if(!t)throw new Error("No archiveTeamInfo received");try{const{archiveSharepointSite:e}=t,n={archiveTeamResult:{__typename:"ArchiveTeamResult",archiveSharepointSite:!!e}};return i.writeQuery({query:PS.r,data:n}),!0}catch(e){return!1}}}};class RS{constructor(){}static create(e){if(RS._clientResolvers)throw new Error("ClientResolvers are already created");return RS._clientResolvers=function(e){return(0,B.merge)((0,TS.w)(),Ib.w,xf,If,(0,Tb.wf)(),function(){let e;const t=t=>a=>(s,o,r)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!e){const{broadcastClientResolvers:t}=yield Promise.all([i.e(108182),i.e(847947),i.e(810078),i.e(80680),i.e(372276),i.e(791789)]).then(i.bind(i,312799));e=t()}return e[t][a](s,o,r)}));return{Query:{broadcastLayout:t("Query")("broadcastLayout"),attendeeCaptionsVisibility:t("Query")("attendeeCaptionsVisibility")},Mutation:{setBroadcastActiveSectionSource:t("Mutation")("setBroadcastActiveSectionSource"),updateBroadcastLayout:t("Mutation")("updateBroadcastLayout"),selectBroadcastSection:t("Mutation")("selectBroadcastSection"),clearBroadcastSource:t("Mutation")("clearBroadcastSource"),createDebugBroadcast:t("Mutation")("createDebugBroadcast"),updateAttendeeCaptionsVisibility:t("Mutation")("updateAttendeeCaptionsVisibility")}}}(),function(e){let t;const a=a=>s=>(o,r,c)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!t){const{clientResolvers:n}=yield Promise.all([i.e(108182),i.e(847947),i.e(810078),i.e(80680),i.e(372276),i.e(791789)]).then(i.bind(i,312799));t=n(e)}return t[a][s](o,r,c)}));return{CallingIntent:{isFake:a("CallingIntent")("isFake")},CallLogParticipant:{hasDisplayName:a("CallLogParticipant")("hasDisplayName"),displayName:a("CallLogParticipant")("displayName")},Query:{whiteboardSharingSession:a("Query")("whiteboardSharingSession"),pptSharingSession:a("Query")("pptSharingSession"),bulkMoveStatus:a("Query")("bulkMoveStatus"),anonymousDisplayName:a("Query")("anonymousDisplayName"),prejoinState:a("Query")("prejoinState"),byodState:a("Query")("byodState"),callingScreenStatus:a("Query")("callingScreenStatus"),callingScreenLayout:a("Query")("callingScreenLayout"),poppedOutWindowState:a("Query")("poppedOutWindowState"),pinnedParticipantIds:a("Query")("pinnedParticipantIds"),videoScanType:a("Query")("videoScanType"),captionFontSize:a("Query")("captionFontSize"),debugVideoEffectState:a("Query")("debugVideoEffectState"),selectedBackgroundsInfo:a("Query")("selectedBackgroundsInfo"),getHardwareOutDevices:a("Query")("getHardwareOutDevices"),avatarInfo:a("Query")("avatarInfo"),selectedAvatarInfo:a("Query")("selectedAvatarInfo"),activeVideoEffects:a("Query")("activeVideoEffects"),videoEffectsCurrentInfo:a("Query")("videoEffectsCurrentInfo"),currentCallingState:a("Query")("currentCallingState"),compositorRegions:a("Query")("compositorRegions"),avatarAppAvailabilityInfo:a("Query")("avatarAppAvailabilityInfo"),myselfSettings:a("Query")("myselfSettings"),immersiveViewModeAppAvailabilityInfo:a("Query")("immersiveViewModeAppAvailabilityInfo"),debugClosedCaptionsEvent:a("Query")("debugClosedCaptionsEvent"),isCallingScreenReady:a("Query")("isCallingScreenReady"),isUbarRenderComplete:a("Query")("isUbarRenderComplete")},Mutation:{acceptStreamPermissionsDebug:a("Mutation")("acceptStreamPermissionsDebug"),sendToDebugHardwareOutDevice:a("Mutation")("sendToDebugHardwareOutDevice"),stopDebugHardwareOutDevice:a("Mutation")("stopDebugHardwareOutDevice"),setDebugSpeakerVolume:a("Mutation")("setDebugSpeakerVolume"),setDebugToolVisible:a("Mutation")("setDebugToolVisible"),updateMeetingRoomLayoutToggleState:a("Mutation")("updateMeetingRoomLayoutToggleState"),updateShouldLaunchWhiteboardOnLoad:a("Mutation")("updateShouldLaunchWhiteboardOnLoad"),setDebugToolHiddenParticipantsCount:a("Mutation")("setDebugToolHiddenParticipantsCount"),setBulkMoveStatus:a("Mutation")("setBulkMoveStatus"),createDebugBreakoutRooms:a("Mutation")("createDebugBreakoutRooms"),createDebugCall:a("Mutation")("createDebugCall"),addDebugSuggestedUser:a("Mutation")("addDebugSuggestedUser"),joinDebugCallFromIntent:a("Mutation")("joinDebugCallFromIntent"),createDebugCallingIntent:a("Mutation")("createDebugCallingIntent"),createDebugConversation:a("Mutation")("createDebugConversation"),updateDebugCall:a("Mutation")("updateDebugCall"),stopDebugCall:a("Mutation")("stopDebugCall"),stopSpotlightSelfDebugCall:a("Mutation")("stopSpotlightSelfDebugCall"),updateDebugMeetingRoomRemoteSelectedLayoutChanged:a("Mutation")("updateDebugMeetingRoomRemoteSelectedLayoutChanged"),updateDebugSwapScreensButtonState:a("Mutation")("updateDebugSwapScreensButtonState"),toggleHoldDebugCall:a("Mutation")("toggleHoldDebugCall"),addDebugParticipant:a("Mutation")("addDebugParticipant"),createDebugParticipants:a("Mutation")("createDebugParticipants"),toggleDebugLocalMute:a("Mutation")("toggleDebugLocalMute"),startDebugRecording:a("Mutation")("startDebugRecording"),stopDebugRecording:a("Mutation")("stopDebugRecording"),setCallTranscriptStateDebug:a("Mutation")("setCallTranscriptStateDebug"),sendCallTranscriptEntryEventDebug:a("Mutation")("sendCallTranscriptEntryEventDebug"),sendClosedCaptionsEntryEventDebug:a("Mutation")("sendClosedCaptionsEntryEventDebug"),sendClosedCaptionsStatusEventDebug:a("Mutation")("sendClosedCaptionsStatusEventDebug"),setDebugClosedCaptionsEvent:a("Mutation")("setDebugClosedCaptionsEvent"),removeDebugParticipant:a("Mutation")("removeDebugParticipant"),toggleDebugVideo:a("Mutation")("toggleDebugVideo"),toggleDebugScreenShare:a("Mutation")("toggleDebugScreenShare"),updateDebugParticipant:a("Mutation")("updateDebugParticipant"),updateDebugPinParticipantFromOutside:a("Mutation")("updateDebugPinParticipantFromOutside"),updateDebugCortanaToggleButton:a("Mutation")("updateDebugCortanaToggleButton"),updateDebugContentCameraSharing:a("Mutation")("updateDebugContentCameraSharing"),toggleDebugMuteSpeaker:a("Mutation")("toggleDebugMuteSpeaker"),updateDebugContentCameraState:a("Mutation")("updateDebugContentCameraState"),triggerDebugCallingScreenGalleryTypeChange:a("Mutation")("triggerDebugCallingScreenGalleryTypeChange"),toggleVoiceLevel:a("Mutation")("toggleVoiceLevel"),setDebugDevicesList:a("Mutation")("setDebugDevicesList"),setDebugCallingQualityFeedback:a("Mutation")("setDebugCallingQualityFeedback"),setAnonymousDisplayName:a("Mutation")("setAnonymousDisplayName"),setPrejoinState:a("Mutation")("setPrejoinState"),triggerSubscribedCallChangedDebugEvent:a("Mutation")("triggerSubscribedCallChangedDebugEvent"),updateMeetingBrandingInfoCache:a("Mutation")("updateMeetingBrandingInfoCache"),setAcceptStreamPermissionsDebugResponse:a("Mutation")("setAcceptStreamPermissionsDebugResponse"),setStreamPermissionsDebugAcknowledged:a("Mutation")("setStreamPermissionsDebugAcknowledged"),setStreamPermissionsDebugAcknowledgedRequired:a("Mutation")("setStreamPermissionsDebugAcknowledgedRequired"),setByodState:a("Mutation")("setByodState"),setCallingScreenStatus:a("Mutation")("setCallingScreenStatus"),setCallingScreenLayout:a("Mutation")("setCallingScreenLayout"),setIsCallingScreenReady:a("Mutation")("setIsCallingScreenReady"),setPoppedOutWindowState:a("Mutation")("setPoppedOutWindowState"),setUbarRenderComplete:a("Mutation")("setUbarRenderComplete"),setPinnedParticipantIds:a("Mutation")("setPinnedParticipantIds"),updateMyselfSettings:a("Mutation")("updateMyselfSettings"),setVideoScanType:a("Mutation")("setVideoScanType"),updateCaptionFontSize:a("Mutation")("updateCaptionFontSize"),setDebugDeviceBlurringCapability:a("Mutation")("setDebugDeviceBlurringCapability"),setDebugVideoBackgroundImages:a("Mutation")("setDebugVideoBackgroundImages"),triggerBluetoothStateChangedDebugEvent:a("Mutation")("triggerBluetoothStateChangedDebugEvent"),triggerRaiseHandStateChangedEvent:a("Mutation")("triggerRaiseHandStateChangedEvent"),toggleDebugVideoEffect:a("Mutation")("toggleDebugVideoEffect"),updateMeetingLockDebug:a("Mutation")("updateMeetingLockDebug"),updateSelectedBackgroundsInfo:a("Mutation")("updateSelectedBackgroundsInfo"),setShouldReloadVideoApp:a("Mutation")("setShouldReloadVideoApp"),setShouldShowVideoApp:a("Mutation")("setShouldShowVideoApp"),setShouldShowVideoEffectsPreview:a("Mutation")("setShouldShowVideoEffectsPreview"),setShouldKeepPreviewWindowInSidePanelOpen:a("Mutation")("setShouldKeepPreviewWindowInSidePanelOpen"),setVideoAppPostMessageEvent:a("Mutation")("setVideoAppPostMessageEvent"),setAvatarAppPostMessageEvent:a("Mutation")("setAvatarAppPostMessageEvent"),setVideoNotification:a("Mutation")("setVideoNotification"),setAvatarErrorNotification:a("Mutation")("setAvatarErrorNotification"),setAvatarQuickPickerErrorNotification:a("Mutation")("setAvatarQuickPickerErrorNotification"),setShouldSetAvatarRendererTimeout:a("Mutation")("setShouldSetAvatarRendererTimeout"),setIsTurningOnVideoFromPreview:a("Mutation")("setIsTurningOnVideoFromPreview"),setShouldRefreshVideoFilters:a("Mutation")("setShouldRefreshVideoFilters"),toggleParticipantPin:a("Mutation")("toggleParticipantPin"),setScaling:a("Mutation")("setScaling"),scalingModeUpdated:a("Mutation")("scalingModeUpdated"),updateAvatarInfo:a("Mutation")("updateAvatarInfo"),updateSelectedAvatarInfo:a("Mutation")("updateSelectedAvatarInfo"),setLastSelectedCameraId:a("Mutation")("setLastSelectedCameraId"),setIsAvatarAppLoaded:a("Mutation")("setIsAvatarAppLoaded"),updateActiveVideoEffects:a("Mutation")("updateActiveVideoEffects"),updateVideoEffectsCurrentInfo:a("Mutation")("updateVideoEffectsCurrentInfo"),meetingDebugGoLive:a("Mutation")("meetingDebugGoLive"),setDebugStageRoomOutcome:a("Mutation")("setDebugStageRoomOutcome"),setShouldShowPopupPreview:a("Mutation")("setShouldShowPopupPreview"),setShouldAvatarMenuItemSelected:a("Mutation")("setShouldAvatarMenuItemSelected"),updateCallingState:a("Mutation")("updateCallingState"),setCompositorRegion:a("Mutation")("setCompositorRegion"),removeCompositorRegion:a("Mutation")("removeCompositorRegion"),setAvatarAppAvailabilityInfo:a("Mutation")("setAvatarAppAvailabilityInfo"),setIsAvatarMRULoaded:a("Mutation")("setIsAvatarMRULoaded"),setMeetingCollab:a("Mutation")("setMeetingCollab"),toggleMeetingCollab:a("Mutation")("toggleMeetingCollab"),stopSharingTriggeredOnStage:a("Mutation")("stopSharingTriggeredOnStage"),setImmersiveViewModeAppAvailabilityInfo:a("Mutation")("setImmersiveViewModeAppAvailabilityInfo")}}}(e),IS.s,ik,CS(e),qk,lv,Nb.D,Eb.w,_b,Mf,Fb.s,NS.s,FS.s,AS,ES.w,MS.s,OS)}(e),RS._clientResolvers}static get clientResolvers(){return RS._clientResolvers}}RS._clientResolvers=null;class LS extends Qp{constructor(e,t,i,n,a){var s;super(e,t,i({windowId:n.windowId,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:`mtma-user-${(null===(s=null==n?void 0:n.authenticationUser)||void 0===s?void 0:s.id)||"nouser"}-${n.windowId}`,storeType:a}),n,n.windowId,a)}get parentQueries(){return lp}get parentSubscriptions(){return gp}get parentMutations(){return up}get className(){return"MTMAWindowDataClient"}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:this.parent.__UNSAFE_getApolloClientReferencesForDebugPanel().self,selfIsMainClient:!1}}clone(e){throw new Error("Trying to clone child instance")}}class US extends Jp{constructor(e,t,i,n){super(e,i,t({windowId:i.windowId||h.ew,entityType:i.entityType,viewportContext:i.windowProvider.viewportContext,name:"mtma-core",storeType:_p.mtmaCore}),i.windowId||h.ew,_p.mtmaCore),this.createApolloClient=t,this.viewSchemaClient=null,n&&(this.viewSchemaClient=n({windowId:i.windowId||h.ew,entityType:i.entityType,viewportContext:i.windowProvider.viewportContext,name:"mtma-core-viewSchema",storeType:_p.viewSchema}),this.registerClient(this.viewSchemaClient))}clone(e){return e.windowId===h.ew?new Xp(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.storeType):new LS(this.getServices(),this,this.createApolloClient,Object.assign(Object.assign({},this.ctx),e),_p.mtmaWindow)}cloneForViewSchema(e){return ev(this.viewSchemaClient,"View schema must be avaliable"),new Zp(this.getServices(),this.viewSchemaClient,Object.assign(Object.assign({},this.ctx),e),_p.viewSchema)}disposeClients(e){const t=Object.create(null,{disposeClients:{get:()=>super.disposeClients}});return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all([t.disposeClients.call(this,e),(()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){this.viewSchemaClient&&(yield this.disposeClient(this.viewSchemaClient,e),e&&(this.viewSchemaClient=null))})))()])}))}}class $S extends Qp{constructor(e,t,i,n,a){var s;const o=`${(null===(s=n.authenticationUser)||void 0===s?void 0:s.id)||"nouser"}-${n.windowId}`;super(e,t,i({windowId:n.windowId||h.ew,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:`mtma-user-${o}`,storeType:_p.mtmaUser}),n,n.windowId||h.ew,_p.mtmaUser),this.createApolloClient=i,this.viewSchemaClient=null,a&&(this.viewSchemaClient=a({windowId:n.windowId||h.ew,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:`mtma-user-viewSchema-${o}`,storeType:_p.viewSchema}),this.registerClient(this.viewSchemaClient))}get parentQueries(){return cp}get parentSubscriptions(){return mp}get parentMutations(){return dp}get className(){return"MTMAUserDataClient"}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:this.parent.__UNSAFE_getApolloClientReferencesForDebugPanel().self,selfIsMainClient:!1}}clone(e){return new LS(this.getServices(),this,this.createApolloClient,Object.assign(Object.assign({},this.ctx),e),_p.mtmaWindow)}cloneForViewSchema(e){return ev(this.viewSchemaClient,"View schema must be available"),new Zp(this.getServices(),this.viewSchemaClient,Object.assign(Object.assign({},this.ctx),e),_p.viewSchema)}disposeClients(e){const t=Object.create(null,{disposeClients:{get:()=>super.disposeClients}});return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all([t.disposeClients.call(this,e),(()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){this.viewSchemaClient&&(yield this.disposeClient(this.viewSchemaClient,e),e&&(this.viewSchemaClient=null))})))()])}))}}class WS{constructor(){this._cache=new Map,this.getOrCreateServiceInstance=(e,t)=>{let i;return this._cache.has(e)?i=this._cache.get(e):(i=t(),this._cache.set(e,i)),i},this.clear=()=>{this._cache.clear()}}}const BS=new WS,zS=BS.getOrCreateServiceInstance;var HS,qS;!function(e){e.AddressService="AddressService",e.AiInsightsFeedbackService="AiInsightsFeedbackService",e.AiInsightsSdsService="AiInsightsSdsService",e.AppBasedLinkService="AppBasedLinkService",e.AppsPlatformService="AppsPlatformService",e.AppsStoreService="AppsStoreService",e.AppSuggestionsService="AppSuggestionsService",e.AsyncMediaService="AsyncMediaService",e.AtpSafelinksService="AtpSafelinksService",e.AugloopService="AugloopService",e.SubstrateBotPlatformService="SubstrateBotPlatformService",e.ComposeAugloopService="ComposeAugloopService",e.AzureMapsService="AzureMapsService",e.BadgeCountService="BadgeCountService",e.BiometricEnrollmentService="BiometricEnrollmentService",e.BiometricFaceEnrollmentService="BiometricFaceEnrollmentService",e.BotsPlatformService="BotsPlatformService",e.BrbService="BrbService",e.BreakoutRoomMiddleTierService="BreakoutRoomMiddleTierService",e.BroadcastAttendeeService="BroadcastAttendeeService",e.BroadcastCaptionsService="BroadcastCaptionsService",e.BroadcastSignalRService="BroadcastSignalRService",e.BroadcastStreamingAttendeeService="BroadcastStreamingAttendeeService",e.CalendarService="CalendarService",e.CallBlockingService="CallBlockingService",e.CallingAnonymousDisplayNameService="CallingAnonymousDisplayNameService",e.CallingAppEventsService="CallingAppEventsService",e.CallingBannerServiceAdapter="CallingBannerServiceAdapter",e.CallingDialogServiceAdapter="CallingDialogServiceAdapter",e.CallingNotificationServiceAdapter="CallingNotificationServiceAdapter",e.CallingService="CallingService",e.CallingConversationService="CallingConversationService",e.CallRecordingService="CallRecordingService",e.ChatService="ChatService",e.ChatServiceEndpointProvider="ChatServiceEndpointProvider",e.CloudStorageFoldersService="CloudStorageFoldersService",e.CmdMeetingIntelligenceService="CmdMeetingIntelligenceService",e.CollabCloudService="CollabCloudService",e.CollabObjectService="CollabObjectService",e.CommonSubstrateService="CommonSubstrateService",e.CommunitySettingsService="CommunitySettingsService",e.ConnectedAccountsService="ConnectedAccountsService",e.ConnectedCalendarSettingsService="ConnectedCalendarSettingsService",e.ConsumerGroupsService="ConsumerGroupsService",e.CSAService="CSAService",e.DeveloperSwitchersService="DeveloperSwitchersService",e.DiscoverSurfaceFeedbackService="DiscoverSurfaceFeedbackService",e.DiscoverSurfaceService="DiscoverSurfaceService",e.DistributionListService="DistributionListService",e.DriveItemShareService="DriveItemShareService",e.DynamicsMarketingService="DynamicsMarketingService",e.DynamicsVirtualEventsService="DynamicsVirtualEventsService",e.EmoticonService="EmoticonService",e.EspService="EspService",e.ExampleService="ExampleService",e.ExternalAccountsResponseService="ExternalAccountsResponseService",e.ExternalAccountsService="ExternalAccountsService",e.ExternalCalendarEmailAddressService="ExternalCalendarEmailAddressService",e.FileDownloadManagerService="FileDownloadManagerService",e.FilesBackfillThreadPropertiesService="FilesBackfillThreadPropertiesService",e.FilesRedeemService="FilesRedeemService",e.FilesReferenceService="FilesReferenceService",e.FilesSharepointUrlService="FilesSharepointUrlService",e.FilesValidDomainsService="FilesValidDomainsService",e.FilesSiteResourceInfoService="FilesSiteResourceInfoService",e.FileUploadPreviewService="FileUploadPreviewService",e.FileUploadService="FileUploadService",e.FloodgateService="FloodgateService",e.FluidService="FluidService",e.GalleryService="GalleryService",e.GiphyService="GiphyService",e.GoogleCalendarAuthenticationService="GoogleCalendarAuthenticationService",e.GoogleContactsAuthenticationService="GoogleContactsAuthenticationService",e.GuardiansService="GuardiansService",e.HealthScenarioService="HealthScenarioService",e.ImageProxyService="ImageProxyService",e.ImmersiveReaderService="ImmersiveReaderService",e.ImplicitContactsService="ImplicitContactsService",e.ImportMsaContactsService="ImportMsaContactsService",e.InstantAnswersService="InstantAnswersService",e.InviteLinksService="InviteLinksService",e.ItemDeleteService="ItemDeleteService",e.ItemDetailsService="ItemDetailsService",e.ItemUploadService="ItemUploadService",e.LiveStateBroadcastService="LiveStateBroadcastService",e.LiveStreamRenderingService="LiveStreamRenderingService",e.LmsIntegrationService="LmsIntegrationService",e.LockedTeamsService="LockedTeamsService",e.LogsFilesService="LogsFilesService",e.LokiMetaPreviewService="LokiMetaPreviewService",e.LokiService="LokiService",e.ManageTenantService="ManageTenantService",e.MeetingArtifactsService="MeetingArtifactsService",e.MeetingBotService="MeetingBotService",e.MeetingIntelligenceService="MeetingIntelligenceService",e.MeetingOptionsClientDataService="MeetingOptionsClientDataService",e.MeetingOptionsService="MeetingOptionsService",e.MeetingQuestionsAndAnswersService="MeetingQuestionsAndAnswersService",e.MeetingRecapService="MeetingRecapService",e.MeetingRecapWorkingSetFilesService="MeetingRecapWorkingSetFilesService",e.MeetingRecapSwaService="MeetingRecapSwaService",e.MeetingRoomAppEventsService="MeetingRoomAppEventsService",e.MeetingTemplateService="MeetingTemplateService",e.MonetizationService="MonetizationService",e.MRUItemService="MRUItemService",e.MsaAuthenticationService="MsaAuthenticationService",e.OdcFilePreviewService="OdcFilePreviewService",e.OdsService="OdcService",e.OrganizationInfoService="OrganizationInfoService",e.OSearchService="OSearchService",e.PaymentsService="PaymentsService",e.PeoplePickerService="PeoplePickerService",e.PeopleSearchService="PeopleSearchService",e.PeopleService="PeopleService",e.PeopleTargetingService="PeopleTargetingService",e.PersonalFileDetailsService="PersonalFileDetailsService",e.PetrolService="PetrolService",e.PoliciesService="PoliciesService",e.PresenceService="PresenceService",e.ODSLProcessingEngine="ODSLProcessingEngine",e.PstnService="PstnService",e.RefreshSiteUrlService="RefreshSiteUrlService",e.ReportConcernService="ReportConcernService",e.SCISService="SCISService",e.SearchPrefetchService="SearchPrefetchService",e.SensitivityLabelPolicySettingsService="SensitivityLabelPolicySettingsService",e.SharepointRestClient="SharepointRestClient",e.SharepointShareService="SharepointShareService",e.ShareService="ShareService",e.SignalsService="SignalsService",e.SmbUserIntentService="SmbUserIntentService",e.StatefulLongPoll="StatefulLongPoll",e.StoreDevicesService="StoreDevicesService",e.StoreService="StoreService",e.StyleMyRoomService="StyleMyRoomService",e.SubstrateFilesSearchService="SubstrateFilesSearchService",e.SubstrateMeetingRecommendationsService="SubstrateMeetingRecommendationsService",e.SubstrateMeetingSearchService="SubstrateMeetingSearchService",e.SubstrateMeetingSummarySearchService="SubstrateMeetingSummarySearchService",e.SubstrateRecommendationsService="SubstrateRecommendationsService",e.SubstrateSearchService="SubstrateSearchService",e.SubstrateSuggestionsService="SubstrateSuggestionsService",e.TargetingHierarchyService="TargetingHierarchyService",e.TeamCalendarService="TeamCalendarService",e.TeamsAndChannelsService="TeamsAndChannelsService",e.TenantAnalyticsService="TenantAnalyticsService",e.TenantMembershipService="TenantMembershipService",e.TenantPrivacyProfileService="TenantPrivacyProfileService",e.TenantService="TenantService",e.TFLUserService="TFLUserService",e.ThirdPartyCalendarService="ThirdPartyCalendarService",e.ToastImageService="ToastImageService",e.TpnNoticeService="TpnNoticeService",e.TranscriptFeedbackService="TranscriptFeedbackService",e.TranscriptService="TranscriptService",e.TranscriptSettingsStoreService="TranscriptSettingsStoreService",e.TranslateService="TranslateService",e.UnifiedConsentService="UnifiedConsentService",e.UrlPreviewService="UrlPreviewService",e.UserLicenseService="UserLicenseService",e.UserProfileService="UserProfileService",e.VideoMessageCameraCommandService="VideoMessageCameraCommandService",e.VideoFileService="VideoFileService",e.VideoMessageUploadService="VideoMessageUploadService",e.VirtualEventsService="VirtualEventsService",e.MeetingSchedulingService="MeetingSchedulingService",e.VoicemailService="VoicemailService",e.WebinarService="WebinarService",e.WaffleService="WaffleService"}(HS||(HS={})),function(e){e.ExampleGlobalService="ExampleGlobalService",e.GlobalCallingService="GlobalCallingService",e.GlobalTaskbarService="GlobalTaskbarService",e.MTMAUserDataService="MTMAUserDataService",e.WebAppSwitcherService="WebAppSwitcherService"}(qS||(qS={}));const VS=(e,t)=>i=>(0,Rl.mT)(e,t,i),GS=()=>Promise.all([i.e(400010),i.e(177422),i.e(832841),i.e(104526),i.e(290689),i.e(826310),i.e(29311),i.e(653565),i.e(184049),i.e(812946),i.e(816702)]).then(i.bind(i,863538)),JS=VS((()=>i.e(585108).then(i.bind(i,224833))),"services-app-based-link"),KS=VS((()=>i.e(805203).then(i.bind(i,586364))),"services-apps-platform"),QS=VS((()=>Promise.all([i.e(923870),i.e(761944)]).then(i.bind(i,105882))),"services-store-apps"),YS=VS((()=>i.e(733885).then(i.bind(i,644763))),"services-app-suggestions"),XS=VS((()=>i.e(591494).then(i.bind(i,197612))),"services-atp-safelinks"),ZS=VS((()=>i.e(771401).then(i.bind(i,83873))),"services-async-media"),ew=VS((()=>Promise.all([i.e(186291),i.e(267987),i.e(165441)]).then(i.bind(i,454082))),"services-augloop"),tw=VS((()=>Promise.all([i.e(657542),i.e(23787)]).then(i.bind(i,55006))),"services-substrate-bot-platform"),iw=VS((()=>Promise.all([i.e(758755),i.e(655377),i.e(987927)]).then(i.bind(i,591949))),"services-azure-maps"),nw=VS((()=>Promise.all([i.e(299243),i.e(156255)]).then(i.bind(i,410499))),"services-biometric-enrollment"),aw=VS((()=>i.e(820672).then(i.bind(i,316246))),"services-bots-platform"),sw=VS((()=>i.e(340060).then(i.bind(i,66749))),"services-brb"),ow=VS((()=>i.e(911846).then(i.bind(i,834740))),"services-breakout-rooms"),rw=VS((()=>i.e(851710).then(i.bind(i,986462))),"services-transcript"),cw=VS((()=>i.e(819211).then(i.bind(i,32337))),"services-transcript-setting-store"),lw=VS((()=>i.e(851710).then(i.bind(i,986462))),"services-transcript-feedback"),dw=VS((()=>i.e(116205).then(i.bind(i,731553))),"services-ai-insights-feedback"),uw=VS((()=>i.e(116205).then(i.bind(i,731553))),"services-ai-insights-sds"),mw=VS((()=>i.e(512159).then(i.bind(i,958168))),"services-style-my-room"),gw=VS((()=>i.e(363685).then(i.bind(i,440464))),"services-broadcast-attendee"),hw=VS((()=>i.e(620188).then(i.bind(i,343588))),"services-broadcast-streaming-attendee"),pw=VS((()=>i.e(128560).then(i.bind(i,554256))),"services-broadcast-captions"),vw=VS((()=>Promise.all([i.e(653565),i.e(12549)]).then(i.bind(i,852547))),"services-broadcast-signalr"),fw=VS((()=>Promise.all([i.e(104526),i.e(290689),i.e(252696),i.e(525596),i.e(993376)]).then(i.bind(i,975933))),"services-io-calendar"),bw=VS((()=>i.e(634692).then(i.bind(i,172038))),"services-chat-endpoint-provider"),yw=VS((()=>Promise.all([i.e(810882),i.e(477209)]).then(i.bind(i,943064))),"services-chat"),kw=VS((()=>Promise.all([i.e(810882),i.e(477209)]).then(i.bind(i,943064))),"services-calling-conversation"),Sw=VS((()=>i.e(976808).then(i.bind(i,864933))),"services-report-concern"),ww=(VS((()=>Promise.all([i.e(400010),i.e(177422),i.e(832841),i.e(104526),i.e(290689),i.e(826310),i.e(29311),i.e(653565),i.e(184049),i.e(816702),i.e(175925)]).then(i.bind(i,658294))),"services-calling"),VS((()=>i.e(293740).then(i.bind(i,633398))),"services-cmd-meeting-intelligence")),jw=VS((()=>i.e(656737).then(i.bind(i,353180))),"services-collab-object"),Cw=VS((()=>i.e(458771).then(i.bind(i,669936))),"services-community-settings"),_w=VS((()=>i.e(32034).then(i.bind(i,450326))),"services-connected-accounts"),Tw=VS((()=>i.e(900675).then(i.bind(i,592275))),"services-io-connected-calendar"),Iw=VS((()=>Promise.all([i.e(366232),i.e(384977)]).then(i.bind(i,199339))),"services-store-devices"),Nw=VS((()=>i.e(500923).then(i.bind(i,848249))),"services-distribution-list"),Ew=VS((()=>i.e(805794).then(i.bind(i,615277))),"services-dynamics-marketing"),Fw=VS((()=>i.e(106652).then(i.bind(i,347756))),"services-dynamics-virtual-events"),xw=VS((()=>i.e(178832).then(i.bind(i,989186))),"services-emoticon"),Dw=VS((()=>i.e(421174).then(i.bind(i,787131))),"services-esp"),Aw=VS((()=>i.e(469081).then(i.bind(i,409456))),"services-external-accounts"),Mw=VS((()=>i.e(235430).then(i.bind(i,17686))),"services-external-accounts-response"),Pw=VS((()=>i.e(579197).then(i.bind(i,878146))),"services-external-calendar-email-address"),Ow=VS((()=>i.e(203137).then(i.bind(i,144307))),"services-files"),Rw=VS((()=>i.e(622121).then(i.bind(i,816677))),"services-file-upload"),Lw=VS((()=>i.e(302653).then(i.bind(i,535335))),"services-file-download-manager"),Uw=VS((()=>i.e(251425).then(i.bind(i,820745))),"services-fluid"),$w=VS((()=>i.e(273806).then(i.bind(i,812110))),"services-giphy"),Ww=VS((()=>i.e(194248).then(i.bind(i,672081))),"services-gallery"),Bw=VS((()=>i.e(183483).then(i.bind(i,663757))),"services-google-calendar-authentication"),zw=VS((()=>i.e(183483).then(i.bind(i,663757))),"services-google-contacts-authentication"),Hw=VS((()=>i.e(787480).then(i.bind(i,654282))),"services-image-proxy"),qw=VS((()=>i.e(142705).then(i.bind(i,433559))),"immersive-reader-service"),Vw=VS((()=>i.e(670972).then(i.bind(i,476080))),"services-import-msa-contacts"),Gw=VS((()=>i.e(517965).then(i.bind(i,823050))),"services-instant-answers"),Jw=VS((()=>i.e(723088).then(i.bind(i,233985))),"services-invite-links"),Kw=VS((()=>Promise.all([i.e(463268),i.e(761953),i.e(840651),i.e(96978)]).then(i.bind(i,990942))),"services-live-state-broadcast"),Qw=VS((()=>Promise.all([i.e(835503),i.e(228978),i.e(834117),i.e(368621),i.e(814408)]).then(i.bind(i,856263))),"services-live-stream-renderer"),Yw=VS((()=>i.e(322581).then(i.bind(i,866178))),"services-lms-integration"),Xw=VS((()=>i.e(288475).then(i.bind(i,678186))),"services-tenant-analytics"),Zw=VS((()=>i.e(989829).then(i.bind(i,872473))),"services-loki"),ej=VS((()=>Promise.all([i.e(104526),i.e(290689),i.e(926934)]).then(i.bind(i,523307))),"services-discover-surface"),tj=VS((()=>Promise.all([i.e(104526),i.e(290689),i.e(254964)]).then(i.bind(i,813095))),"services-discover-surface-feedback"),ij=VS((()=>i.e(103998).then(i.bind(i,52074))),"services-guardians"),nj=VS((()=>i.e(443091).then(i.bind(i,744064))),"services-health"),aj=VS((()=>i.e(251074).then(i.bind(i,914125))),"services-locked-teams"),sj=VS((()=>i.e(188975).then(i.bind(i,771975))),"services-logs-files"),oj=VS((()=>i.e(202066).then(i.bind(i,963632))),"services-manage-tenant"),rj=VS((()=>i.e(345626).then(i.bind(i,706506))),"services-meeting-artifacts"),cj=VS((()=>i.e(694945).then(i.bind(i,508605))),"services-meeting-intelligence"),lj=VS((()=>Promise.all([i.e(234707),i.e(924251)]).then(i.bind(i,41197))),"services-meeting-recap"),dj=VS((()=>Promise.all([i.e(865492),i.e(820516)]).then(i.bind(i,377735))),"services-meeting-options"),uj=VS((()=>i.e(649880).then(i.bind(i,800217))),"services-meeting-recap-swa"),mj=VS((()=>i.e(259164).then(i.bind(i,549657))),"services-meeting-recap-working-set-files"),gj=VS((()=>Promise.all([i.e(865492),i.e(88137)]).then(i.bind(i,195356))),"services-meeting-templates"),hj=VS((()=>i.e(950104).then(i.bind(i,464808))),"services-msa-authentication"),pj=VS((()=>i.e(716151).then(i.bind(i,153790))),"services-people"),vj=(VS((()=>i.e(37342).then(i.bind(i,943194))),"services-viva-insights"),VS((()=>i.e(716313).then(i.bind(i,958592))),"services-people-picker")),fj=VS((()=>i.e(454165).then(i.bind(i,423344))),"services-people-targeting"),bj=VS((()=>i.e(350718).then(i.bind(i,266012))),"services-files-personal"),yj=VS((()=>i.e(214988).then(i.bind(i,922691))),"services-example"),kj=VS((()=>i.e(342461).then(i.bind(i,814671))),"services-petrol"),Sj=VS((()=>Promise.all([i.e(974153),i.e(794166)]).then(i.bind(i,829116))),"services-floodgate"),wj=VS((()=>i.e(343607).then(i.bind(i,673603))),"services-ods"),jj=VS((()=>i.e(304609).then(i.bind(i,432468))),"services-policies"),Cj=VS((()=>i.e(676130).then(i.bind(i,493565))),"services-presence"),_j=VS((()=>Promise.all([i.e(104526),i.e(290689),i.e(23363)]).then(i.bind(i,370007))),"scis-service"),Tj=VS((()=>Promise.all([i.e(104526),i.e(290689),i.e(657542),i.e(293785),i.e(762498),i.e(79506)]).then(i.bind(i,572693))),"services-search"),Ij=VS((()=>Promise.all([i.e(657542),i.e(574771),i.e(172842)]).then(i.bind(i,44135))),"services-search-meeting-summary"),Nj=VS((()=>Promise.all([i.e(657542),i.e(419161)]).then(i.bind(i,799427))),"search-substrate"),Ej=VS((()=>i.e(902078).then(i.bind(i,659417))),"services-substrate-meeting-recommendations"),Fj=VS((()=>Promise.all([i.e(657542),i.e(501129)]).then(i.bind(i,461500))),"services-substrate-recommendations"),xj=VS((()=>i.e(864574).then(i.bind(i,490749))),"services-sharepoint-client"),Dj=VS((()=>i.e(130288).then(i.bind(i,878827))),"services-sharepoint-share"),Aj=VS((()=>i.e(215793).then(i.bind(i,442145))),"services-share"),Mj=VS((()=>i.e(792876).then(i.bind(i,220179))),"services-signals"),Pj=VS((()=>i.e(463473).then(i.bind(i,865656))),"services-smb-user-intent"),Oj=VS((()=>Promise.all([i.e(366232),i.e(923870),i.e(659098)]).then(i.bind(i,913181))),"services-store"),Rj=VS((()=>Promise.all([i.e(104526),i.e(290689),i.e(657542),i.e(293785),i.e(762498),i.e(79506),i.e(538431)]).then(i.bind(i,437235))),"services-suggestions"),Lj=VS((()=>Promise.all([i.e(657542),i.e(293785),i.e(734949)]).then(i.bind(i,514639))),"services-implicit-contacts"),Uj=VS((()=>i.e(74801).then(i.bind(i,420087))),"services-targeting-hierarchy"),$j=VS((()=>i.e(362437).then(i.bind(i,853373))),"services-tenant-membership"),Wj=VS((()=>i.e(172557).then(i.bind(i,960832))),"services-tenant-service"),Bj=VS((()=>i.e(277412).then(i.bind(i,563779))),"services-third-party-calendar"),zj=VS((()=>i.e(254692).then(i.bind(i,407343))),"services-toast-image"),Hj=(VS((()=>i.e(751309).then(i.bind(i,799293))),"services-teams-and-channels"),VS((()=>i.e(16014).then(i.bind(i,340821))),"services-translate")),qj=VS((()=>i.e(606408).then(i.bind(i,888360))),"services-tpn-notice"),Vj=VS((()=>i.e(439613).then(i.bind(i,212626))),"unified-consent-state"),Gj=VS((()=>i.e(114826).then(i.bind(i,733621))),"services-url-preview"),Jj=VS((()=>i.e(613549).then(i.bind(i,531377))),"services-user-profile"),Kj=VS((()=>Promise.all([i.e(958828),i.e(743719),i.e(247364),i.e(923731),i.e(433329),i.e(711340),i.e(446977),i.e(890032),i.e(983436),i.e(551886),i.e(832717),i.e(400010),i.e(503951),i.e(44716),i.e(662286),i.e(813177),i.e(579759),i.e(104526),i.e(290689),i.e(680562),i.e(742262),i.e(574803),i.e(160235),i.e(29311),i.e(490130),i.e(79445),i.e(448073),i.e(277110),i.e(127919),i.e(829970),i.e(562148),i.e(626976),i.e(343831),i.e(631900),i.e(53502),i.e(251451),i.e(375119),i.e(32739),i.e(496769),i.e(218831),i.e(92854),i.e(275873),i.e(568740)]).then(i.bind(i,200385))),"services-voicemail"),Qj=VS((()=>i.e(948693).then(i.bind(i,620491))),"services-item-crud"),Yj=VS((()=>i.e(551792).then(i.bind(i,564347))),"services-webinar"),Xj=VS((()=>Promise.all([i.e(104526),i.e(290689),i.e(178815)]).then(i.bind(i,96423))),"services-meeting-bot"),Zj=VS((()=>i.e(729961).then(i.bind(i,25421))),"services-virtual-events"),eC=VS((()=>i.e(195270).then(i.bind(i,28970))),"services-meeting-scheduling-service"),tC=VS((()=>i.e(223935).then(i.bind(i,381374))),"services-developer-switchers"),iC=VS((()=>i.e(478053).then(i.bind(i,224078))),"services-search-prefetch"),nC=VS((()=>i.e(684615).then(i.bind(i,72441))),"services-call-recording"),aC=VS((()=>i.e(59616).then(i.bind(i,525103))),"services-user-license"),sC=VS((()=>i.e(376049).then(i.bind(i,320262))),"services-payment"),oC=VS((()=>i.e(417341).then(i.bind(i,130082))),"services-monetization"),rC=VS((()=>i.e(57264).then(i.bind(i,319759))),"services-mru"),cC=VS((()=>i.e(701035).then(i.bind(i,3412))),"services-collab-cloud"),lC=VS((()=>i.e(655402).then(i.bind(i,150560))),"tfl-user-service"),dC=VS((()=>i.e(172042).then(i.bind(i,760874))),"services-sensitivity-label-policy-settings"),uC=VS((()=>i.e(883548).then(i.bind(i,774294))),"services-meeting-questions-and-answers"),mC=VS((()=>i.e(864438).then(i.bind(i,992775))),"services-io-web-app-switcher"),gC=VS((()=>i.e(145332).then(i.bind(i,714481))),"services-io-mtma-user-data"),hC=VS((()=>i.e(112279).then(i.bind(i,537643))),"services-io-waffle"),pC=VS((()=>i.e(669733).then(i.bind(i,788241))),"services-io-organization-info"),vC=VS((()=>i.e(949584).then(i.bind(i,297835))),"services-video-message-upload"),fC=VS((()=>i.e(658438).then(i.bind(i,237727))),"services-io-browser-video-message-camera-command"),bC=e=>()=>e.userServicesCache(HS.AsyncMediaService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,gtmRegistry:i,discover:n,coreSettings:a,loggerFactory:s,scenarioFactory:o,endpointsManager:r}=e,{AsyncMediaService:c}=yield ZS(o);return new c(t,i,n,a,s,r,o)})))(e))),yC=e=>()=>e.userServicesCache(HS.SharepointRestClient,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:i,scenarioFactory:n}=e,{SharepointRestClient:a}=yield xj(n);return new a(t,i)})))(e))),kC=(e,t)=>()=>e.userServicesCache(HS.BotsPlatformService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:i,scenarioFactory:n,gtmRegistry:a,send:s,discover:o,platformService:r,i18n:c,coreSettings:l}=e,d=yield t(),{BotsPlatformService:u}=yield aw(n);return new u(i,d,a.bind(s,N.Pn.middleTier),o,n,r,c,l)})))(e,t))),SC=e=>()=>e.userServicesCache(HS.ConnectedAccountsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:i,scenarioFactory:n,send:a,coreSettings:s,i18n:o,endpointsManager:r}=e,{ConnectedAccountsService:c}=yield _w(n);return new c(t,i,n,s,a,o,r)})))(e))),wC=e=>()=>e.userServicesCache(HS.GoogleCalendarAuthenticationService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:i,windowProvider:n,scenarioFactory:a,platformService:s,coreSecurityService:o}=e,{GoogleCalendarAuthenticationService:r}=yield Bw(a);return new r(n,t,i,a,s,o)})))(e))),jC=e=>()=>e.userServicesCache(HS.GoogleContactsAuthenticationService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:i,windowProvider:n,scenarioFactory:a,platformService:s,coreSecurityService:o}=e,{GoogleContactsAuthenticationService:r}=yield zw(a);return new r(n,t,i,a,s,o)})))(e))),CC=e=>()=>e.userServicesCache(HS.MsaAuthenticationService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:i,windowProvider:n}=e,{MsaAuthenticationService:a}=yield hj(i);return new a(t,i,n)})))(e))),_C=(e,t,i,a)=>()=>e.userServicesCache(HS.ExternalAccountsService,(()=>((e,t,i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,localStorage:s,platformService:o,scenarioFactory:r}=e,c=yield t(),l=yield i(),d=yield a(),{ExternalAccountsService:u}=yield Aw(r);return new u(n,c,l,d,r,o,s)})))(e,t,i,a))),TC=(e,t,i)=>()=>e.userServicesCache(HS.ThirdPartyCalendarService,(()=>((e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,scenarioFactory:a,authenticationService:s,localStorage:o}=e,r=yield t(),c=yield i(),{ThirdPartyCalendarService:l}=yield Bj(a);return new l(n,s,r,c,a,o)})))(e,t,i))),IC=e=>()=>e.userServicesCache(HS.CallingAppEventsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:i,windowProvider:n}=e,{CallingAppEventsService:a,ObservableFactory:s}=yield GS();return new a(t,new s,i,n)})))(e))),NC=(e,t)=>()=>e.userServicesCache(HS.CallingBannerServiceAdapter,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:i,i18n:n}=e,a=yield t(),{CallingBannerServiceAdapter:s}=yield GS();return new s(i,a,n)})))(e,t))),EC=(e,t)=>()=>e.userServicesCache(HS.CallingDialogServiceAdapter,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:i,scenarioFactory:n}=e,a=yield t(),{CallingDialogServiceAdapter:s}=yield GS();return new s(i,n,a)})))(e,t))),FC=(e,t)=>()=>e.userServicesCache(HS.CallingNotificationServiceAdapter,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:i,coreSettings:n,hostCommunicationService:a,platformService:s,scenarioFactory:o,coreShortcutService:r}=e,c=yield t(),{CallingLoggingService:l,CallingNotificationServiceAdapter:d}=yield GS();return new d(i,n,c,a,new l(i,o,n,s),r)})))(e,t))),xC=e=>()=>e.userServicesCache(HS.DiscoverSurfaceService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:i,endpointsManager:n}=e,{DiscoverSurfaceService:a}=yield ej(i);return new a(t,n,i)})))(e))),DC=e=>()=>e.userServicesCache(HS.UserLicenseService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,endpointsManager:i,loggerFactory:n,scenarioFactory:a}=e,{UserLicenseService:s}=yield aC(a);return new s(t,i,n,a)})))(e))),AC=(e,t)=>()=>e.userServicesCache(HS.SmbUserIntentService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:i,loggerFactory:n,scenarioFactory:a,localStorage:s,windowProvider:o}=e,r=yield t(),{SmbUserIntentService:c}=yield Pj(a);return new c(n,i,s,r,o,a)})))(e,t))),MC=e=>()=>e.userServicesCache(HS.TenantPrivacyProfileService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,authenticationService:i,coreSettings:n,scenarioFactory:a,endpointsManager:s,localStorage:o,discover:r}=e,{CallingIdentityAdapterService:c,ClientDatabaseService:l,AggregatedSettingsStoreService:d,ACSCallingAuthenticationServiceAdapter:u,CallingAuthenticationServiceAdapter:m,TenantPrivacyProfileService:g}=yield GS(),h=new l(t,o),p=new d(t,n),v=yield i.getUser();return new g(t,i,new c(n.get(S.J.Calling).enableACSEmbed?new u(r,v,t):new m(i,r,v,t,n),p,t),n,h,a,s)})))(e))),PC=e=>()=>{var t;const{coreSettings:i}=e;if(!(null===(t=null==i?void 0:i.get(S.J.CMDMeetingArtifactsService))||void 0===t?void 0:t.enableCMDMeetingArtifactsService))throw new Error("FF enableCMDMeetingArtifactsService is disabled");return e.userServicesCache(HS.CollabObjectService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,coreSettings:i,loggerFactory:n,endpointsManager:a,scenarioFactory:s,discover:o}=e,{CollabObjectService:r}=yield jw(s);return new r(t,i,n,a,o)})))(e)))},OC=e=>()=>e.userServicesCache(HS.StoreDevicesService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:i,endpointsManager:n}=e,{StoreDevicesService:a}=yield Iw(i);return new a(n,t,i)})))(e))),RC=e=>()=>e.userServicesCache(HS.OrganizationInfoService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:i}=e,{OrganizationInfoService:n}=yield pC(i);return new n(t)})))(e))),LC=e=>()=>e.userServicesCache(HS.MeetingRoomAppEventsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:i,windowProvider:n}=e,{ObservableFactory:a,MeetingRoomAppEventsService:s}=yield GS();return new s(t,new a,i,n)})))(e))),UC=e=>()=>e.userServicesCache(HS.AppsStoreService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,coreSettings:i,endpointsManager:n}=e,{AppsStoreService:a}=yield QS(t);return new a(t,i,n)})))(e))),$C=e=>()=>e.userServicesCache(HS.AiInsightsFeedbackService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i,loggerFactory:n}=e,{AiInsightsFeedbackService:a}=yield dw(t);return new a(i,n,t)})))(e))),WC=e=>()=>e.userServicesCache(HS.AiInsightsSdsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i,loggerFactory:n}=e,{AiInsightsSdsService:a}=yield uw(t);return new a(i,n,t)})))(e))),BC=(e,t)=>()=>e.userServicesCache(HS.AppBasedLinkService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:i,scenarioFactory:n,loggerFactory:a}=e,{AppBasedLinkService:s}=yield JS(n);return new s(i,yield t(),n,a)})))(e,t))),zC=e=>()=>e.userServicesCache(HS.AppsPlatformService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,coreSettings:i,endpointsManager:n,localStorage:a,authenticationService:s}=e,{enableMetaOsSdkIntegration:o}=i.get(S.J.Extensibility),{AppsPlatformService:r,AppsPlatformServiceMetaOS:c}=yield KS(t);return o?new c(i,n,t,s):new r(i,n,a)})))(e))),HC=e=>()=>e.userServicesCache(HS.AppSuggestionsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i,coreSettings:n,loggerFactory:a}=e,{AppSuggestionsService:s}=yield YS(t);return new s(n,i,a)})))(e))),qC=(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:i,i18n:n,loggerFactory:a,scenarioFactory:s,windowProvider:o,coreSettings:r,pubsub:c}=e,{enableAugLoopService:l,runtimeFlights:d,resource:u,serviceUrl:m}=r.get(S.J.Augloop),{AugloopService:g}=yield ew(s),h=new g(i,o,c,a,s,n,r),p=t?{appName:"Word",appPlatform:"Web"}:void 0;return l&&m&&u&&(yield h.initialize(m,u,d||[],p)),h})),VC=(e,t)=>()=>t?e.userServicesCache(HS.ComposeAugloopService,(()=>qC(e,!0))):e.userServicesCache(HS.AugloopService,(()=>qC(e))),GC=e=>()=>e.userServicesCache(HS.SubstrateBotPlatformService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:i}=e,{SubstrateBotPlatformService:n}=yield tw(i);return new n(t)})))(e))),JC=e=>()=>e.userServicesCache(HS.AzureMapsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,i18NextWrapper:i,scenarioFactory:n,coreSettings:a}=e,{AzureMapsService:s}=yield iw(n);return new s(t,a,i)})))(e))),KC=e=>()=>e.userServicesCache(HS.BadgeCountService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,config:i,discover:n,platformService:a,scenarioFactory:s}=e,{BadgeCountService:o}=yield yw(s);return new o(a,t,n,i)})))(e))),QC=e=>()=>e.userServicesCache(HS.BrbService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{activeWindowsService:t,scenarioFactory:i,loggerFactory:n,coreSettings:a,logsCollectorService:s,authenticationService:o,platformService:r,discover:c,windowProvider:l,hostCommunicationService:d,endpointsManager:u,authenticationUser:m,i18n:g}=e,{BrbService:h}=yield sw(i);return new h(n,a,s,o,r,c,l,d,u,i,g,t,m)})))(e))),YC=e=>()=>e.userServicesCache(HS.BreakoutRoomMiddleTierService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{BreakoutRoomMiddleTierService:n}=yield ow(t);return new n(i)})))(e))),XC=e=>()=>e.userServicesCache(HS.AtpSafelinksService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,endpointsManager:i,gtmRegistry:n,localStorage:a,loggerFactory:s,scenarioFactory:o,send:r}=e,{AtpSafelinksService:c}=yield XS(o);return new c(n.bind(r,N.Pn.middleTier),o,s,a,t,i)})))(e))),ZC=e=>()=>e.userServicesCache(HS.BroadcastAttendeeService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,coreSettings:i,loggerFactory:n,scenarioFactory:a,windowProvider:s}=e,{BroadcastAttendeeService:o}=yield gw(a);return new o(t,n,a,s,i)})))(e))),e_=e=>()=>e.userServicesCache(HS.BroadcastStreamingAttendeeService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:i}=e,{BroadcastStreamingAttendeeService:n}=yield hw(i);return new n(t)})))(e))),t_=e=>()=>e.userServicesCache(HS.BroadcastCaptionsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,send:i,endpointsManager:n,scenarioFactory:a,windowProvider:s,loggerFactory:o}=e,{BroadcastCaptionsService:r}=yield pw(a);return new r(s,o,a,t,i,n)})))(e))),i_=e=>()=>e.userServicesCache(HS.BroadcastSignalRService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:i,endpointsManager:n,windowProvider:a}=e,{BroadcastSignalRService:s}=yield vw(t);return new s(i,n,t,a)})))(e)));var n_=i(486390);const a_=(e,t)=>i=>{t({payload:i,pubsub:e})},s_=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,gtmRegistry:a,loggerFactory:s,pubsub:o,send:r,windowProvider:c}=e,{CallBlockingService:l}=yield i.e(667417).then(i.bind(i,865704));return new l(t,n,a.bind(r,N.Pn.middleTier),s.newLogger("CallBlockingService","data-services-common"),c,a_(o,o_))})),o_=({payload:e,pubsub:t})=>{t.publish(n_.oo,e.newBlockedMris)};class r_{constructor(){this._displayName=null,this.getDisplayName=()=>this._displayName,this.setDisplayName=e=>{this._displayName=e}}}const c_=e=>()=>e.userServicesCache(HS.CallingAnonymousDisplayNameService,(()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return new r_})))),l_=e=>()=>e.userServicesCache(HS.CmdMeetingIntelligenceService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{CmdMeetingIntelligenceService:n}=yield ww(t);return new n(i)})))(e))),d_=e=>()=>e.userServicesCache(HS.CommunitySettingsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{CommunitySettingsService:n}=yield Cw(t);return new n(i)})))(e))),u_=e=>()=>e.userServicesCache(HS.ConnectedCalendarSettingsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,scenarioFactory:i,endpointsManager:n}=e,{ConnectedCalendarSettingsService:a}=yield Tw(i);return new a(i,t,n)})))(e))),m_=e=>()=>{const{coreSettings:t}=e,{enableCMDServiceForTokenRetriveAndVoiceSignatureStore:i}=t.get(S.J.BiometricEnrollment),{isCMDSvcEnabledForBiometricStorage:a}=t.get(S.J.Host);return i||a?e.userServicesCache(HS.BiometricEnrollmentService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,authenticationService:i,coreSettings:n,loggerFactory:a,platformService:s,scenarioFactory:o,i18n:r,endpointsManager:c}=e,{VoiceBiometricEnrollmentService:l}=yield nw(o);return new l(t,i,n,a,s,r,c)})))(e))):e.userServicesCache(HS.BiometricEnrollmentService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:i,loggerFactory:n,platformService:a,scenarioFactory:s,send:o,coreSettings:r,i18n:c,endpointsManager:l}=e,{BiometricEnrollmentService:d}=yield nw(s);return new d(t,i,n,a,o,r,c,l)})))(e)))},g_=e=>()=>e.userServicesCache(HS.BiometricFaceEnrollmentService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,authenticationService:i,coreSettings:n,loggerFactory:a,platformService:s,scenarioFactory:o,endpointsManager:r}=e,{BiometricFaceEnrollmentService:c}=yield nw(o);return new c(t,i,n,a,s,r)})))(e))),h_=e=>()=>e.userServicesCache(HS.DeveloperSwitchersService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,config:i,localStorage:n,loggerFactory:a,rebootService:s,scenarioFactory:o,windowProvider:r}=e,{DeveloperSwitchersService:c}=yield tC(o);return new c(s,r,a.newLogger("DeveloperSwitchersService","data-services-common"),t,n,i)})))(e))),p_=e=>()=>e.userServicesCache(HS.DistributionListService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:i,loggerFactory:n,coreSettings:a,scenarioFactory:s}=e,{DistributionListService:o}=yield Nw(s);return new o(n,t.bind(i,N.Pn.middleTier),a)})))(e))),v_=e=>()=>e.userServicesCache(HS.DynamicsMarketingService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:i,send:n,scenarioFactory:a}=e,{DynamicsMarketingService:s}=yield Ew(a);return new s(t,i,n)})))(e))),f_=e=>()=>e.userServicesCache(HS.DynamicsVirtualEventsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:i,send:n,i18NextWrapper:a,scenarioFactory:s,loggerFactory:o,discover:r}=e,{DynamicsVirtualEventsService:c}=yield Fw(s);return new c(t,i,n,a,o,r)})))(e))),b_=e=>()=>e.userServicesCache(HS.EmoticonService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,localStorage:i,scenarioFactory:n,coreSettings:a,i18n:s,windowProvider:o,config:r}=e,{EmoticonService:c}=yield xw(n),l=new c(s.locale,i,a,t.newLogger("EmoticonService","data-services-common"),n,s,o,null==r?void 0:r.experienceName);return yield l.isInitialized,l})))(e))),y_=e=>()=>e.userServicesCache(HS.EspService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:i}=e,{EspService:n}=yield Dw(i);return new n(t)})))(e))),k_=e=>()=>e.userServicesCache(HS.ExampleService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{ExampleService:i}=yield yj(t);return new i})))(e))),S_=(e,t)=>()=>e.userServicesCache(HS.ExternalAccountsResponseService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:i,scenarioFactory:n}=e,a=yield t(),{ExternalAccountsResponseService:s}=yield Mw(n);return new s(i,a,n)})))(e,t))),w_=e=>()=>e.userServicesCache(HS.FluidService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:i,endpointsManager:n,send:a,scenarioFactory:s}=e,{FluidService:o}=yield Uw(s);return new o(t,i,n,a)})))(e))),j_=e=>()=>e.userServicesCache(HS.GalleryService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,discover:i,send:n,scenarioFactory:a}=e,{GalleryService:s}=yield Ww(a);return new s(n,t,i,a)})))(e))),C_=e=>()=>e.userServicesCache(HS.GiphyService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,gtmRegistry:i,endpointsManager:n,send:a,scenarioFactory:s,i18n:o}=e,{GiphyService:r}=yield $w(s);return new r(i.bind(a,N.Pn.middleTier),t,o.locale,n)})))(e))),__=e=>()=>e.userServicesCache(HS.GuardiansService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:i,send:n,scenarioFactory:a,loggerFactory:s,i18n:o}=e,{GuardiansService:r}=yield ij(a);return new r(t,s,i,n,o)})))(e))),T_=e=>()=>e.userServicesCache(HS.ImageProxyService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,gtmRegistry:i,send:n,scenarioFactory:a}=e,{ImageProxyService:s}=yield Hw(a);return new s(i,n,t)})))(e))),I_=e=>()=>e.userServicesCache(HS.ImmersiveReaderService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:i}=e,{ImmersiveReaderService:n}=yield qw(i);return new n(t)})))(e))),N_=(e,t)=>()=>t.userServicesCache(HS.ImportMsaContactsService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:i,endpointsManager:n,scenarioFactory:a}=t,{ImportMsaContactsService:s}=yield Vw(a);return new s(yield e(),i,n,a)})))(e,t))),E_=e=>()=>e.userServicesCache(HS.ImplicitContactsService,(()=>(({discover:e,gtmRegistry:t,send:i,scenarioFactory:a})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{ImplicitContactsService:n}=yield Lj(a);return new n(i,e,t,a)})))(e))),F_=e=>()=>e.userServicesCache(HS.InstantAnswersService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,send:i,scenarioFactory:n,loggerFactory:a,i18n:s}=e,{InstantAnswersService:o}=yield Gw(n);return new o(a,n,t,i,s)})))(e))),x_=e=>()=>e.userServicesCache(HS.InviteLinksService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{InviteLinksService:n}=yield Jw(t);return new n(i)})))(e))),D_=e=>()=>e.userServicesCache(HS.LiveStateBroadcastService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{pubsub:t,scenarioFactory:i,loggerFactory:n,coreSettings:a,authenticationService:s,platformService:o,discover:r}=e,{LiveStateBroadcastService:c}=yield Kw(i);return new c(t,n,a,s,o,i,r)})))(e))),A_=e=>()=>e.userServicesCache(HS.LiveStreamRenderingService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,authStateProvider:i,discover:n,send:a,scenarioFactory:s,loggerFactory:o,pubsub:r,platformService:c,clientState:l,coreSettings:d,endpointsManager:u,networkState:m}=e,{LiveStreamRenderingService:g}=yield Qw(s),{ACSCallingAuthenticationServiceAdapter:h,CallingAuthenticationServiceAdapter:p}=yield GS(),v=yield t.getUser();return new g(o,d.get(S.J.Calling).enableACSEmbed?new h(n,v,o):new p(t,n,v,o,d,i),c,l,r,a,d,s,u,m)})))(e))),M_=e=>()=>e.userServicesCache(HS.LmsIntegrationService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:i,send:n,scenarioFactory:a}=e,{LmsIntegrationService:s}=yield Yw(a);return new s(t,i,n)})))(e))),P_=e=>()=>e.userServicesCache(HS.LockedTeamsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:i,send:n,scenarioFactory:a}=e,{LockedTeamsService:s}=yield aj(a);return new s(t,i,n)})))(e))),O_=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:i,logsCollectorService:n,coreSettings:a}=e,{LogsFilesService:s}=yield sj(t);return new s(i,n,a,void 0)})),R_=e=>()=>e.userServicesCache(HS.LogsFilesService,(()=>O_(e))),L_=e=>()=>e.userServicesCache(HS.LokiService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:i,scenarioFactory:n,coreSettings:a,endpointsManager:s}=e,{LokiService:o}=yield Zw(n);return new o(i,t,a,s)})))(e))),U_=e=>()=>e.userServicesCache(HS.ManageTenantService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,endpointsManager:i,loggerFactory:n,scenarioFactory:a}=e,{ManageTenantService:s}=yield oj(a);return new s(t,n,a,i)})))(e))),$_=e=>()=>e.userServicesCache(HS.MeetingArtifactsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:i,coreSettings:n,scenarioFactory:a,i18n:s,loggerFactory:o}=e,{MeetingArtifactsService:r}=yield rj(a);return new r(i,t,n,s,o,a)})))(e))),W_=(e,t,i)=>()=>{var a;const{coreSettings:s}=e;if(!(null===(a=null==s?void 0:s.get(S.J.MeetingBot))||void 0===a?void 0:a.enableMeetingBot))throw new Error("enableMeetingBot flag is disabled");return e.userServicesCache(HS.MeetingBotService,(()=>((e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n,cmdApolloClient:a,authenticationService:s,coreSettings:o,loggerFactory:r,localStorage:c,platformService:l,windowProvider:d,entityCommanding:u,i18n:m,authenticationUser:g}=e,{MeetingBotService:h}=yield Xj(n);return new h(s,yield t(),o,yield i(),r,n,d,c,l,a,u,m,g)})))(e,t,i)))},B_=e=>()=>e.userServicesCache(HS.MeetingIntelligenceService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i,loggerFactory:n}=e,{MeetingIntelligenceService:a}=yield cj(t);return new a(i,n,t)})))(e))),z_=e=>()=>e.userServicesCache(HS.PeopleService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{PeopleService:n}=yield pj(t);return new n(i)})))(e))),H_=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{windowProvider:t,coreSettings:n,scenarioFactory:a,loggerFactory:s}=e,{MeetingOptionsClientDataService:o}=yield Promise.all([i.e(865492),i.e(820516)]).then(i.bind(i,642927)),r=z_(e);return new o(t,yield r(),n,a,s)})),q_=e=>()=>e.userServicesCache(HS.MeetingOptionsClientDataService,(()=>H_(e))),V_=e=>()=>e.userServicesCache(HS.MeetingOptionsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:i,scenarioFactory:n,coreSettings:a,gtmRegistry:s,discover:o,endpointsManager:r}=e,{MeetingOptionsService:c}=yield dj(n);return new c(t,i,n,a,s,o,r)})))(e))),G_=e=>()=>e.userServicesCache(HS.MeetingQuestionsAndAnswersService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:i,endpointsManager:n}=e,{MeetingQuestionsAndAnswersService:a}=yield uC(i);return new a(n,t,i)})))(e))),J_=e=>()=>e.userServicesCache(HS.MeetingRecapService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{MeetingRecapService:n}=yield lj(t);return new n(i)})))(e))),K_=e=>()=>e.userServicesCache(HS.MeetingRecapSwaService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,scenarioFactory:i,authenticationService:n,loggerFactory:a,endpointsManager:s,coreSettings:o}=e,{MeetingRecapSwaService:r}=yield uj(i);return new r(s,n,t,o,a)})))(e))),Q_=e=>()=>e.userServicesCache(HS.MeetingRecapWorkingSetFilesService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{MeetingRecapWorkingSetFilesService:n}=yield mj(t);return new n(i)})))(e))),Y_=e=>()=>e.userServicesCache(HS.MeetingTemplateService,(()=>(({scenarioFactory:e,send:t,authenticationService:i,coreSettings:a,discover:s,loggerFactory:o,endpointsManager:r})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{MeetingTemplateService:n}=yield gj(e);return new n(t,i,a,e,s,r,o)})))(e))),X_=e=>()=>e.userServicesCache(HS.PaymentsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:i,authenticationService:n,coreSettings:a,i18n:s,loggerFactory:o}=e,{PaymentService:r}=yield sC(t);return new r(i,n,a,o,t,s)})))(e))),Z_=e=>()=>e.userServicesCache(HS.PeoplePickerService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{PeoplePickerService:n}=yield vj(t);return new n(i)})))(e))),eT=e=>()=>e.userServicesCache(HS.PeopleTargetingService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,loggerFactory:i,send:n,coreSettings:a,scenarioFactory:s,discover:o}=e,{PeopleTargetingService:r}=yield fj(s);return new r(t,i,n,a,o)})))(e))),tT=e=>()=>e.userServicesCache(HS.PoliciesService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,endpointsManager:i,loggerFactory:n,networkState:a,scenarioFactory:s}=e,{PoliciesService:o}=yield jj(s);return new o(i,t,n,a,s)})))(e))),iT=e=>()=>e.userServicesCache(HS.PresenceService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,pubsub:i,send:n,scenarioFactory:a,platformService:s,config:o}=e,{PresenceService:r}=yield Cj(a);return new r(t.bind(n,N.Pn.unifiedPresence),i,s,o)})))(e)));class nT extends Error{constructor(e,t){super(`${t} - ${e}`)}}class aT{process(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.validateInput(t),this.validateConfig(e),this.executeStatements(e,t)}))}executeStatements(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=[];for(const a of(null===(i=t.odsl)||void 0===i?void 0:i.statements)||[]){const t=e[a.name];if(!t)throw new nT(`No matching manifest found for statement '${a.name}'`,"ODSLProcessor-01");const i=t(this.processStatement(a));n.push(i)}return n}))}processStatement(e){const t={};Object.keys(e.arguments).forEach((i=>{const n=e.arguments[i];switch(n.type){case"number":n.number&&(t[i]=n.number);break;case"boolean":n.boolean&&(t[i]=n.boolean);break;case"string":n.string&&(t[i]=n.string)}}));return t}validateConfig(e){if(!e)throw new nT("No manifest found","ODSLProcessor-04")}validateInput(e){if(!e)throw new nT("No input found","ODSLProcessor-05");if(!e.odsl)throw new nT("No ODSL found in input","ODSLProcessor-06");if(!e.entities)throw new nT("No entities found in input","ODSLProcessor-07")}}const sT=e=>()=>e.userServicesCache(HS.ODSLProcessingEngine,(()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return new aT})))),oT=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,loggerFactory:a}=e,{AddressService:s}=yield i.e(821836).then(i.bind(i,76173));return new s(t.bind(n,N.Pn.middleTier),a)})),rT=e=>()=>e.userServicesCache(HS.AddressService,(()=>oT(e))),cT=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n}=e,{PstnService:a}=yield i.e(893393).then(i.bind(i,787205));return new a(t.bind(n,N.Pn.middleTier))})),lT=e=>()=>e.userServicesCache(HS.PstnService,(()=>cT(e))),dT=e=>()=>e.userServicesCache(HS.SCISService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,authenticationService:i,platformService:n,scenarioFactory:a,loggerFactory:s}=e,{SCISService:o}=yield _j(a);return new o(t,i,n,a,s)})))(e))),uT=e=>()=>e.userServicesCache(HS.SearchPrefetchService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:i,authenticationService:n}=e,{SearchPrefetchService:a}=yield iC(t);return new a(n,i)})))(e))),mT=e=>()=>e.userServicesCache(HS.ShareService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,discover:i,gtmRegistry:n,scenarioFactory:a,send:s,i18n:o}=e,{ShareService:r}=yield Aj(a);return new r(t,i,n,s,o)})))(e))),gT=(e,t,i)=>()=>e.userServicesCache(HS.StoreService,(()=>((e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n,loggerFactory:a,gtmRegistry:s,localStorage:o,coreSettings:r,authenticationService:c,platformService:l,endpointsManager:d,windowProvider:u,i18n:m}=e,{StoreService:g}=yield Oj(n);return new g(n,a,s,o,r,c,l,d,u,m,yield t(),yield i())})))(e,t,i))),hT=e=>()=>e.userServicesCache(HS.StyleMyRoomService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,i18n:i,scenarioFactory:n,endpointsManager:a}=e,{StyleMyRoomService:s}=yield mw(n);return new s(t,a,i)})))(e))),pT=e=>()=>e.userServicesCache(HS.TenantMembershipService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{TenantMembershipService:n}=yield $j(t);return new n(t,i)})))(e))),vT=e=>()=>e.userServicesCache(HS.TenantService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{TenantService:n}=yield Wj(t);return new n(t,i)})))(e))),fT=e=>()=>e.userServicesCache(HS.TenantAnalyticsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:i,loggerFactory:n}=e,{TenantAnalyticsService:a}=yield Xw(i);return new a(n,t)})))(e))),bT=e=>()=>e.userServicesCache(HS.TranscriptService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i,coreSettings:n,loggerFactory:a}=e,{TranscriptService:s}=yield rw(t);return new s(i,a,t,n)})))(e))),yT=e=>()=>e.userServicesCache(HS.TranscriptFeedbackService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{TranscriptFeedbackService:i}=yield lw(t);return new i})))(e))),kT=e=>()=>e.userServicesCache(HS.TranscriptSettingsStoreService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:i,endpointsManager:n,authenticationUser:a}=e,{SettingsStoreService:s}=yield cw(i);return new s(t,i,n,a)})))(e))),ST=e=>()=>e.userServicesCache(HS.TranslateService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,endpointsManager:i,coreSettings:n,scenarioFactory:a,send:s}=e,{TranslateService:o}=yield Hj(a);return new o(t.bind(s,N.Pn.middleTier),a,n,i)})))(e))),wT=e=>()=>e.userServicesCache(HS.TargetingHierarchyService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:i,discover:n,loggerFactory:a,scenarioFactory:s,send:o}=e,{TargetingHierarchyService:r}=yield Uj(s);return new r(t,a,o,i,n)})))(e))),jT=e=>()=>e.userServicesCache(HS.ToastImageService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{ToastImageService:n}=yield zj(t);return new n(i)})))(e)));var CT=i(699532);const _T=e=>()=>e.userServicesCache(HS.TeamsAndChannelsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t}=e;return new CT.K(t)})))(e))),TT=e=>()=>e.userServicesCache(HS.TpnNoticeService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,platformService:i,scenarioFactory:n}=e,{TpnNoticeService:a}=yield qj(n);return new a(t,i)})))(e))),IT=(e,t)=>()=>e.userServicesCache(HS.UrlPreviewService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:i,endpointsManager:n,send:a,coreSettings:s,scenarioFactory:o}=e,{UrlPreviewService:r}=yield Gj(o);return new r(i,a,s,yield t(),n,o)})))(e,t))),NT=e=>()=>e.userServicesCache(HS.UserProfileService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{UserProfileService:n}=yield Jj(t);return new n(i)})))(e))),ET=e=>()=>e.userServicesCache(HS.VirtualEventsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:i,authenticationService:n,coreSettings:a,discover:s,loggerFactory:o,endpointsManager:r}=e,{VirtualEventsService:c,MockVirtualEventsService:l}=yield Zj(t),{enableIntegrationsTab:d,forceUseMockAPIs:u}=a.get(S.J.VirtualEvents);return u?new l:new c(i,n,a,s,o,d?r:void 0)})))(e))),FT=e=>()=>e.userServicesCache(HS.MeetingSchedulingService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{MeetingSchedulingService:n}=yield eC(t);return new n(i)})))(e)));var xT=i(451890);const DT=({payload:e,pubsub:t})=>{t.publish(xT.Gq,e)},AT=e=>()=>e.userServicesCache(HS.VoicemailService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:i,loggerFactory:n,scenarioFactory:a,pubsub:s,send:o,windowProvider:r}=e,{VoicemailService:c}=yield Kj(a);return new c(t,i,o,n,r,a_(s,DT))})))(e))),MT=e=>()=>e.userServicesCache(HS.WebinarService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:i,authenticationService:n,coreSettings:a,discover:s,i18n:o,loggerFactory:r}=e,{WebinarService:c}=yield Yj(t);return new c(i,n,a,r,t,o,s)})))(e))),PT=e=>()=>e.userServicesCache(HS.CallRecordingService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:i,endpointsManager:n}=e,{CallRecordingService:a}=yield nC(t);return new a(i,n)})))(e))),OT=e=>()=>e.userServicesCache(HS.MonetizationService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:i,scenarioFactory:n,loggerFactory:a,discover:s,coreSettings:o,localStorage:r}=e,{MonetizationService:c}=yield oC(n);return new c(t,i,a,s,o,r)})))(e))),RT=e=>()=>e.userServicesCache(HS.MRUItemService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:i,scenarioFactory:n,coreSettings:a}=e,{MRUService:s}=yield rC(n);return new s(t,i,a)})))(e))),LT=(e,t)=>()=>e.userServicesCache(HS.DiscoverSurfaceFeedbackService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:i,windowProvider:n,loggerFactory:a}=e,{DiscoverSurfaceFeedbackService:s}=yield tj(i);return new s(yield t(),n,a)})))(e,t))),UT=e=>()=>{var t;const{coreSettings:i}=e;if(!(null===(t=null==i?void 0:i.get(S.J.Extensibility))||void 0===t?void 0:t.enableCollabCloudApis))throw new Error("enableCollabCloudApis flag is disabled");return e.userServicesCache(HS.CollabCloudService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{CollabCloudService:n}=yield cC(t);return new n(i)})))(e)))},$T=e=>()=>e.userServicesCache(HS.TFLUserService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i,localStorage:n,loggerFactory:a}=e,{TFLUserService:s}=yield lC(t);return new s(a,n,i)})))(e))),WT=e=>()=>e.userServicesCache(HS.SensitivityLabelPolicySettingsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,discover:i,gtmRegistry:n,authenticationUser:a,scenarioFactory:s,send:o}=e,{SensitivityLabelPolicySettingsService:r}=yield dC(s);return new r(s,t,n,o,i,a)})))(e))),BT=e=>()=>e.userServicesCache(HS.WaffleService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:i}=e,{WaffleService:n}=yield hC(i);return new n(t)})))(e))),zT=e=>()=>e.userServicesCache(HS.VideoMessageCameraCommandService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{VideoMessageCameraCommandService:i}=yield fC(t);return new i})))(e))),HT=(e,t,i)=>()=>e.userServicesCache(HS.PetrolService,(()=>((e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{platformService:n,authenticationService:a,coreSettings:s,send:o,scenarioFactory:r,loggerFactory:c,hostCommunicationService:l,i18n:d}=e,{PetrolService:u}=yield kj(r);return new u(a,r,c,n,s,o,yield t(),yield i(),l,d)})))(e,t,i))),qT=(e,t)=>()=>e.userServicesCache(HS.FloodgateService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:i,scenarioFactory:n,coreSettings:a,clientState:s,i18NextWrapper:o,windowProvider:r,platformService:c,authenticationUser:l}=e,d=yield t(),{FloodGateService:u}=yield Sj(n);return new u(i,n,s,a,d,o,c,r,l)})))(e,t))),VT=(e,t,i)=>()=>e.userServicesCache(HS.OdsService,(()=>((e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:n,scenarioFactory:a,loggerFactory:s,endpointsManager:o,logsCollectorService:r,coreSettings:c,platformService:l,hostCommunicationService:d,i18n:u}=e,{OdsService:m}=yield wj(a);return new m(n,s,o,r,c,l,yield t(),d,yield i(),u)})))(e,t,i))),GT=e=>()=>e.userServicesCache(HS.LokiMetaPreviewService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:i,loggerFactory:n,scenarioFactory:a}=e,{LokiMetaPreviewService:s}=yield Tj(a);return new s(i,t,n)})))(e))),JT=e=>()=>e.userServicesCache(HS.OdcFilePreviewService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:i,loggerFactory:n,scenarioFactory:a}=e,{OdcFilePreviewService:s}=yield Tj(a);return new s(i,t,n)})))(e))),KT=e=>()=>e.userServicesCache(HS.OSearchService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,discover:i,loggerFactory:n,scenarioFactory:a,coreSettings:s,endpointsManager:o}=e,{OSearchService:r}=yield Tj(a);return new r(t,o,i,n,s)})))(e))),QT=e=>()=>e.userServicesCache(HS.PeopleSearchService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,endpointsManager:i,gtmRegistry:n,loggerFactory:a,scenarioFactory:s,discover:o,coreSettings:r}=e,{PeopleSearchService:c}=yield Tj(s);return new c(n.bind(t,N.Pn.middleTier),i,a,o,r)})))(e))),YT=e=>()=>e.userServicesCache(HS.SubstrateFilesSearchService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:i,platformService:n,loggerFactory:a,scenarioFactory:s,i18n:o}=e,{SubstrateFilesSearchService:r}=yield Tj(s);return new r(i,t,n,s,a,o)})))(e))),XT=e=>()=>e.userServicesCache(HS.SubstrateRecommendationsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:i}=e,{SubstrateRecommendationsService:n}=yield Fj(i);return new n(t)})))(e))),ZT=e=>()=>e.userServicesCache(HS.SubstrateSearchService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:i,loggerFactory:n,platformService:a,scenarioFactory:s,windowProvider:o,coreSettings:r,endpointsManager:c,i18n:l}=e,{SubstrateSearchService:d}=yield Tj(s);return new d(i,t,a,s,n,o,r,c,l)})))(e))),eI=e=>()=>e.userServicesCache(HS.SubstrateSuggestionsService,(()=>(({authenticationService:e,endpointsManager:t,coreSettings:i,discover:a,gtmRegistry:s,send:o,scenarioFactory:r,platformService:c})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{SubstrateSuggestionsService:n}=yield Rj(r);return new n(o,t,e,i,a,s,c)})))(e))),tI=e=>()=>e.userServicesCache(HS.SubstrateMeetingSearchService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:i,loggerFactory:n,platformService:a,scenarioFactory:s}=e,{SubstrateMeetingSearchService:o}=yield Tj(s);return new o(i,t,a,s,n)})))(e))),iI=e=>()=>e.userServicesCache(HS.SubstrateMeetingSummarySearchService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,loggerFactory:i,platformService:n,scenarioFactory:a,coreSettings:s,endpointsManager:o,i18n:r}=e,{SubstrateMeetingSummarySearchService:c}=yield Ij(a);return new c(t,n,a,i,s,o,r)})))(e))),nI=e=>()=>e.userServicesCache(HS.ChatService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,coreSettings:i,scenarioFactory:n}=e,{ChatService:a}=yield yw(n);return new a(i,t)})))(e))),aI=(e,t)=>()=>e.userServicesCache(HS.ChatServiceEndpointProvider,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:i}=e,n=yield t(),{ChatServiceEndpointProvider:a}=yield bw(i);return new a(n,i)})))(e,t))),sI=e=>()=>e.userServicesCache(HS.ConsumerGroupsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,scenarioFactory:i,endpointsManager:n,loggerFactory:a}=e,{ConsumerGroupsService:s}=yield yw(i);return new s(n,a,i,t)})))(e))),oI=e=>()=>e.userServicesCache(HS.CSAService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:i,coreSettings:n,scenarioFactory:a,endpointsManager:s,i18n:o,discover:r}=e,{createCSAService:c}=yield yw(a);return c(t,i,n,o,s,r)})))(e))),rI=e=>()=>e.userServicesCache(HS.StatefulLongPoll,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{StatefulLongPoll:i}=yield yw(t);return new i})))(e))),cI=e=>()=>e.userServicesCache(HS.ReportConcernService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:i,gtmRegistry:n,platformService:a}=e,{ReportConcernService:s}=yield Sw(t);return new s(n.bind(i,N.Pn.middleTier),a)})))(e))),lI=e=>()=>e.userServicesCache(HS.CallingConversationService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:i,loggerFactory:n}=e,{CallingConversationService:a}=yield kw(i);return new a(t,n)})))(e))),dI=(e,t)=>()=>e.userServicesCache(HS.SharepointShareService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:i,coreSettings:n,loggerFactory:a,send:s,scenarioFactory:o}=e,{SharepointShareService:r}=yield Dj(o);return new r(s,i,a,n,yield t())})))(e,t))),uI=(e,t)=>()=>e.userServicesCache(HS.FilesRedeemService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:i,coreSettings:n,loggerFactory:a,send:s,scenarioFactory:o}=e,{FilesRedeemService:r}=yield Dj(o);return new r(s,i,a,n,yield t())})))(e,t))),mI=(e,t,i)=>()=>i.userServicesCache(HS.FilesSharepointUrlService,(()=>((e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n,coreSettings:a}=i,{FilesSharepointUrlService:s}=yield Dj(n);return new s(yield e(),yield t(),a)})))(e,t,i))),gI=(e,t)=>()=>t.userServicesCache(HS.FilesReferenceService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:i,coreSettings:n}=t,{FilesReferenceService:a}=yield Ow(i);return new a(yield e(),n)})))(e,t))),hI=(e,t)=>()=>e.userServicesCache(HS.FileUploadPreviewService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:i,scenarioFactory:n}=e,{FileUploadPreviewService:a}=yield Rw(n);return new a(yield t(),i)})))(e,t))),pI=(e,t)=>()=>e.userServicesCache(HS.FileUploadService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:i,scenarioFactory:n,coreSettings:a}=e,{FileUploadService:s}=yield Rw(n);return new s(yield t(),a,i)})))(e,t))),vI=e=>()=>e.userServicesCache(HS.FileDownloadManagerService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:i}=e,{FileDownloadManagerService:n}=yield Lw(t);return new n(i.newLogger("fileDownloadManagerService","data-services-common"))})))(e))),fI=(e,t)=>()=>e.userServicesCache(HS.PersonalFileDetailsService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:i,gtmRegistry:n,loggerFactory:a,scenarioFactory:s,send:o,endpointsManager:r,coreSettings:c}=e,l=yield t(),{PersonalFileDetailsService:d}=yield bj(s),u=new Kl.q(i);return new d(l,s,a,n.bind(u.authorize(o,"x-skypetoken"),N.Pn.middleTier),r,c)})))(e,t))),bI=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,discover:a,endpointsManager:s,coreSettings:o}=e,{RefreshSiteUrlService:r}=yield i.e(606545).then(i.bind(i,18204));return new r(t,a,n,s,o)})),yI=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:n,loggerFactory:a,send:s,endpointsManager:o,coreSettings:r}=e,{CloudStorageFoldersService:c}=yield i.e(134125).then(i.bind(i,95391));return new c(t,n,a,s,o,r)})),kI=e=>()=>e.userServicesCache(HS.CloudStorageFoldersService,(()=>yI(e))),SI=e=>()=>e.userServicesCache(HS.FilesBackfillThreadPropertiesService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:i,scenarioFactory:n,loggerFactory:a,send:s}=e,{FilesBackfillThreadPropertiesService:o}=yield Ow(n),r=new Kl.q(t);return new o(a,i.bind(r.authorize(s,"x-skypetoken"),N.Pn.middleTier))})))(e)));var wI=i(872177);const jI=(e,t=Dr.l)=>(i,n=wI.hO.BEARER)=>{var a,s;return i?null!==(s=null===(a=e.authorizeV2)||void 0===a?void 0:a.call(e,t,i,{scheme:n}))&&void 0!==s?s:e.authorize(t,i):t},CI=(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:i,authenticationService:n,loggerFactory:a,coreSettings:s}=t,o=_I(s),r=TI(s,o)||"",c=II(s,o)||"",l=jI(n),{ItemUploadService:d,ItemDeleteService:u,ItemDetailsService:m}=yield Qj(i),g=a.newLogger(e,"data-services-common");switch(e){case HS.ItemUploadService:return new d(l,o,r,c,g);case HS.ItemDeleteService:return new u(l,o,g);case HS.ItemDetailsService:return new m(l,o,g,s);default:return}})),_I=e=>!!e.get(S.J.Files).preferGraphOverVroom,TI=(e,t)=>t?e.get(S.J.Files).graphEndpointBaseUrl:e.get(S.J.Files).vroomEndpointBaseUrl,II=(e,t)=>t?e.get(S.J.Files).graphAuthScope:e.get(S.J.Files).vroomAuthScope,NI=e=>()=>e.userServicesCache(HS.ItemUploadService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return yield CI(HS.ItemUploadService,e)})))(e))),EI=e=>()=>e.userServicesCache(HS.ItemDeleteService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return yield CI(HS.ItemDeleteService,e)})))(e))),FI=e=>()=>e.userServicesCache(HS.ItemDetailsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return yield CI(HS.ItemDetailsService,e)})))(e))),xI=e=>()=>e.userServicesCache(HS.DriveItemShareService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{DriveItemShareService:i}=yield Dj(t),{authenticationService:n,coreSettings:a}=e,s=_I(a);return new i(jI(n),s)})))(e))),DI=(e,t)=>()=>e.userServicesCache(HS.VideoFileService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:i,loggerFactory:n,send:a,scenarioFactory:s}=e,{VideoFileService:o}=yield Dj(s);return new o(a,n,i,yield t())})))(e,t))),AI=e=>()=>e.userServicesCache(HS.FilesValidDomainsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:i,loggerFactory:n,localStorage:a,coreSettings:s}=e,{FilesValidDomainsService:o}=yield Ow(i);return new o(t,n,a,s)})))(e))),MI=e=>()=>e.userServicesCache(HS.FilesSiteResourceInfoService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:i,loggerFactory:n}=e,{FilesSiteResourceInfoService:a}=yield Ow(i);return new a(t,n)})))(e))),PI=(e,t)=>()=>e.userServicesCache(HS.VideoMessageUploadService,(()=>((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:i,scenarioFactory:n,offlineCacheManager:a}=e,{VideoMessageUploadService:s}=yield vC(n);return new s(yield t(),a,n,i)})))(e,t))),OI=e=>()=>e.userServicesCache(HS.CalendarService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:i,authenticationService:n,coreSettings:a,discover:s,loggerFactory:o,platformService:r,i18n:c}=e,{CalendarService:l}=yield fw(t);return new l(i,n,s,a,o,r,c)})))(e))),RI=e=>()=>e.userServicesCache(HS.ExternalCalendarEmailAddressService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:i}=e,{ExternalCalendarEmailAddressService:n}=yield Pw(t);return new n(i)})))(e))),LI=e=>()=>e.userServicesCache(HS.TeamCalendarService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:i,authenticationService:n,coreSettings:a,discover:s,loggerFactory:o,platformService:r,i18n:c}=e,{TeamCalendarService:l}=yield fw(t);return new l(i,n,s,a,o,r,c)})))(e))),UI=e=>()=>e.userServicesCache(HS.SubstrateMeetingRecommendationsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:i,authenticationService:n,loggerFactory:a}=e,{SubstrateMeetingRecommendationsService:s}=yield Ej(t);return new s(i,n,a)})))(e))),$I=e=>()=>e.userServicesCache(HS.CommonSubstrateService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:i,platformService:n,authenticationService:a,endpointsManager:s,windowProvider:o,coreSettings:r}=e,{CommonSubstrateService:c}=yield Nj(t);return new c(o,i,a,n,r,s)})))(e))),WI=e=>()=>e.userServicesCache(HS.SignalsService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,config:i,coreSettings:n,scenarioFactory:a,send:s}=e;if(!i)throw new Error("config not set on IUserServicesFactoryContext");const{SignalsService:o}=yield Mj(a);return new o(t,n,s,i)})))(e))),BI=e=>()=>e.globalServicesCache(qS.ExampleGlobalService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{ExampleService:i}=yield yj(t);return new i})))(e))),zI=e=>()=>e.globalServicesCache(qS.GlobalCallingService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{GlobalCallingService:t}=yield Promise.all([i.e(400010),i.e(177422),i.e(832841),i.e(104526),i.e(290689),i.e(826310),i.e(29311),i.e(653565),i.e(184049),i.e(816702),i.e(175925)]).then(i.bind(i,658294));return new t(e)})))(e))),HI=e=>()=>e.globalServicesCache(qS.MTMAUserDataService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:i,hostCommunicationService:n,loggerFactory:a,scenarioFactory:s,workerCacheManager:o}=e,{MTMAUserDataService:r}=yield gC(s),c=new r({authenticationService:t,hostCommunicationService:n,loggerFactory:a,workerCacheManager:o,coreSettings:i});return i.get(S.J.CdlWorker).enableMTMAUserDataInMaglevStorage&&(yield c.startup()),c})))(e))),qI=e=>()=>e.globalServicesCache(qS.WebAppSwitcherService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{crossTabsService:t,localStorage:i,loggerFactory:n,scenarioFactory:a}=e,{WebAppSwitcherService:s}=yield mC(a);return new s(i,n,t)})))(e)));var VI=i(342097);class GI{constructor(e,t,i,n){this.coreSettings=t,this.hostCommunicationService=i,this.i18n=n,this.mainAccountId="",this.badgeCounts=new Map,this.presenceCache=new Map,this.getBadge=e=>({icon:{countBadge:{value:e}}}),this.getGlyphBadge=e=>({icon:{glyphBadge:{glyph:e}}}),this.logger=e.newLogger(VI.d5,"services-io-taskbar")}setPresenceForCurrentAccount(e,t){this.logger.log(`Set presence for with accountId: ${e} and presence: ${t.status}`),this.presenceCache.set(e,t.status),0===this.badgeCounts.get(e)&&this.showPresenceForCurrentAccount(e)}showBadgeForCurrentAccount(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let i=!1;return this.enableCoherenceBadgeForWindows&&(this.logger.log(`Show badge for current account event accountId: ${e} with badgeCount: ${t}`),this.badgeCounts.set(e,t),this.mainAccountId&&this.mainAccountId===e&&(this.logger.log("Main account badge update"),yield this.showBadgeCommand(this.getBadge(t)),i=!0)),i}))}resetBadge(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("Reset badge event"),yield this.showBadgeCommand(this.getBadge(0))}))}showBadge(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let i=!1;if(this.enableCoherenceBadgeForMac){this.logger.log(`Show badge event with accountId: ${e} and badgeCount: ${t}`),this.badgeCounts.set(e,t);const n=Array.from(this.badgeCounts.values()).reduce(((e,t)=>e+t),0);yield this.showBadgeCommand(this.getBadge(n)),i=!0}return i}))}updateMainAccountId(e){this.logger.log(`Main account id updated event ${e}`),this.mainAccountId=e}restoreBadge(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=this.badgeCounts.get(e),i=t||0;return this.logger.log(`Restored badge event for account id ${e} with badge count ${i}`),this.showBadgeForCurrentAccount(e,i)}))}showPresenceForCurrentAccount(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let t=!1;this.logger.log(`Show presence for current account ${e}`);const i=this.presenceCache.get(e);if(!this.enablePresenceStatusTaskbar)return t;if(i){this.logger.log(`Show presence update event with presence: ${i}`);const e=this.getGlyphBadge(i);e.altText=this.i18n.stringTranslate("toastNotifications","taskbar_presence_status",{presenceStatus:i}),yield this.showBadgeCommand(e),t=!0}else this.logger.log(`No presence available for account ${e}`),yield this.resetBadge();return t}))}restorePresenceForAccount(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=this.badgeCounts.get(e);let i=!1;if(0===(t||0)){const t=this.presenceCache.get(e),n=t||I.t.unknown;this.logger.log(`Restored presence event for account id ${e} with badge presence ${n}`),i=yield this.showPresenceForCurrentAccount(e)}return i}))}get enableTaskbarBadgeMaglev(){return!!this.coreSettings.get(S.J.Core).enableTaskbarBadgeMaglev}get enableCoherenceBadgeForWindows(){return!!this.coreSettings.get(S.J.Notifications).enableCoherenceBadgeForWindows}get enableCoherenceBadgeForMac(){return!!this.coreSettings.get(S.J.Notifications).enableCoherenceBadgeForMac}get enablePresenceStatusTaskbar(){return!!this.coreSettings.get(S.J.Notifications).enablePresenceStatusTaskbar}showBadgeCommand(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.enableTaskbarBadgeMaglev)return void this.logger.log(VI.vc.NotEnabled);const t=yield this.hostCommunicationService.loadModule("taskbar");if(t){if(t.showBadge)return this.logger.log(VI.Bd.UpdatedEvent),t.showBadge(e);this.logger.log(VI.vc.MethodNotAvailable)}else this.logger.log(VI.vc.ModuleUnableToLoad)}))}}const JI=e=>()=>e.globalServicesCache(qS.GlobalTaskbarService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,coreSettings:i,hostCommunicationService:n,i18n:a}=e;return new GI(t,i,n,a)})))(e))),KI=e=>()=>e.userServicesCache(HS.HealthScenarioService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:i,localStorage:n}=e,{HealthScenarioService:a}=yield nj(i);return new a(t,n)})))(e))),QI=e=>()=>e.userServicesCache(HS.UnifiedConsentService,(()=>(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:i,authenticationService:n,cacheStorage:a,loggerFactory:s}=e,{UnifiedConsentService:o}=yield Vj(i);return new o(t,n,a,s)})))(e))),YI=(e,t)=>{const{calendarServices:i,chatServices:a,fileServices:s,getAppsStoreService:o,getAsyncMediaService:r,getBotsPlatformService:c,getCallingAppEventsService:l,getCallingBannerService:d,getCallingDialogService:u,getCallingNotificationService:m,getCollabObjectService:g,getConnectedAccountsService:h,getDiscoverSurfaceService:p,getExternalAccountsService:v,getGoogleCalendarAuthenticationService:f,getMeetingRoomAppEventsService:b,getMsaAuthenticationService:y,getSharepointRestClient:k,getSmbUserIntentService:S,getTenantPrivacyProfileService:w,getThirdPartyCalendarService:j,getUserLicenseService:C,getStoreDevicesService:_,getOrganizationInfoService:T,videoMessageServices:I}=(e=>{const t=bC(e),i=eN(e),n=yC(e),a=kC(e,i.getChatService),s=tN(e,t,i.getChatService,n),o=iN(e,t),r=SC(e),c=wC(e),l=jC(e),d=CC(e),u=_C(e,c,l,r),m=TC(e,c,r),g=nN(e),h=IC(e),p=NC(e,h),v=EC(e,h),f=FC(e,h),b=xC(e),y=DC(e),k=AC(e,y),S=MC(e),w=PC(e),j=OC(e),C=RC(e),_=LC(e);return{calendarServices:g,chatServices:i,fileServices:s,getAppsStoreService:UC(e),getAsyncMediaService:t,getBotsPlatformService:a,getCallingAppEventsService:h,getCallingBannerService:p,getCallingDialogService:v,getCallingNotificationService:f,getCollabObjectService:w,getConnectedAccountsService:r,getDiscoverSurfaceService:b,getExternalAccountsService:u,getGoogleCalendarAuthenticationService:c,getMeetingRoomAppEventsService:_,getMsaAuthenticationService:d,getSharepointRestClient:n,getSmbUserIntentService:k,getTenantPrivacyProfileService:S,getThirdPartyCalendarService:m,getUserLicenseService:y,getStoreDevicesService:j,getOrganizationInfoService:C,videoMessageServices:o}})(e),N={getCallingAppEventsService:l,getCallingBannerService:d,getCallingDialogService:u,getCallingNotificationService:m,getTenantPrivacyProfileService:w,getCalendarService:i.getCalendarService,getMeetingRoomAppEventsService:b},E=((e,t,i)=>(a,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=null==s?void 0:s.scenario;null==n||n.mark(z.ck.GetGlobalCallingService);const o=yield i.getGlobalCallingService();null==n||n.mark(z.ck.GlobalCallingServiceInitAccount);const r=yield o.initAccount({entryPoint:a,accountCtx:e,deps:t,telemetryContext:s});return Object.assign(Object.assign({},r),{dispose:(t,i)=>o.disposeAccount(t,i,e.authenticationUser)})})))(e,N,t),F=((e,t,i)=>()=>i.getGlobalCallingService().then((i=>i.deprecated_onAccountInitialized(e,t).then((t=>Object.assign(Object.assign({},t),{dispose:(t,n)=>i.disposeAccount(t,n,e.authenticationUser)}))))))(e,N,t);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},a),{getAiInsightsFeedbackService:$C(e),getAiInsightsSdsService:WC(e),getAppBasedLinkService:BC(e,c),getAppsPlatformService:zC(e),getAppsStoreService:o,getAppSuggestionsService:HC(e),getAsyncMediaService:r,getAugloopService:VC(e),getSubstrateBotPlatformService:GC(e),getComposeAugloopService:VC(e,!0),getAzureMapsService:JC(e),getBadgeCountService:KC(e),getBotsPlatformService:c,getBrbService:QC(e),getBreakoutRoomMiddleTierService:YC(e),getAtpSafelinksService:XC(e),getBroadcastAttendeeService:ZC(e),getBroadcastStreamingAttendeeService:e_(e),getBroadcastCaptionsService:t_(e),getBroadcastSignalRService:i_(e)}),i),{getCallBlockingService:(x=e,()=>x.userServicesCache(HS.CallBlockingService,(()=>s_(x)))),getCallingAnonymousDisplayNameService:c_(e),getCallingAppEventsService:l,getCallingBannerService:d,getCallingDialogService:u,getCallingNotificationService:m,getCallingService:E,deprecated_getCallingServiceOnInitialized:F,getCmdMeetingIntelligenceService:l_(e),getCollabObjectService:g,getCommunitySettingsService:d_(e),getConnectedAccountsService:h,getConnectedCalendarSettingsService:u_(e),getBiometricEnrollmentService:m_(e),getBiometricFaceEnrollmentService:g_(e),getDeveloperSwitchersService:h_(e),getDistributionListService:p_(e),getDynamicsMarketingService:v_(e),getDynamicsVirtualEventsService:f_(e),getEmoticonService:b_(e),getEspService:y_(e),getExampleService:k_(e),getExternalAccountsService:v,getExternalAccountsResponseService:S_(e,h)}),s),I),{getFluidService:w_(e),getGalleryService:j_(e),getGiphyService:C_(e),getGoogleCalendarAuthenticationService:f,getGoogleContactsAuthenticationService:jC(e),getGuardiansService:__(e),getHealthScenarioService:KI(e),getImageProxyService:T_(e),getImmersiveReaderService:I_(e),getImportMsaContactsService:N_(y,e),getImplicitContactsService:E_(e),getInstantAnswersService:F_(e),getInviteLinksService:x_(e),getLiveStateBroadcastService:D_(e),getLiveStreamRenderingService:A_(e),getLmsIntegrationService:M_(e),getLockedTeamsService:P_(e),getLogsFilesService:R_(e),getLokiService:L_(e),getManageTenantService:U_(e),getMeetingArtifactsService:$_(e),getMeetingBotService:W_(e,i.getCalendarService,a.getChatService),getMeetingIntelligenceService:B_(e),getMeetingOptionsClientDataService:q_(e),getMeetingOptionsService:V_(e),getMeetingQuestionsAndAnswersService:G_(e),getMeetingRecapService:J_(e),getMeetingRecapSwaService:K_(e),getMeetingRecapWorkingSetFilesService:Q_(e),getMeetingRoomAppEventsService:b,getMeetingTemplateService:Y_(e),getMsaAuthenticationService:y,getPaymentService:X_(e),getPeoplePickerService:Z_(e),getPeopleService:z_(e),getPeopleTargetingService:eT(e)}),XI(e,S,C)),{getPoliciesService:tT(e),getPresenceService:iT(e)}),ZI(e)),{getODSLProcessingEngine:sT(e),getAddressService:rT(e),getPstnService:lT(e),getSCISService:dT(e),getSearchPrefetchService:uT(e)}),aN(e)),{getSharepointRestClient:k,getShareService:mT(e),getSmbUserIntentService:S,getStoreService:gT(e,_,o),getStoreDevicesService:_,getStyleMyRoomService:hT(e),getTenantMembershipService:pT(e),getTenantService:vT(e),getTenantAnalyticsService:fT(e),getTenantPrivacyProfileService:w,getTranscriptService:bT(e),getTranscriptFeedbackService:yT(e),getTranscriptSettingsStoreService:kT(e),getTranslateService:ST(e),getTargetingHierarchyService:wT(e),getThirdPartyCalendarService:j,getToastImageService:jT(e),getTeamsAndChannelsService:_T(e),getTpnNoticeService:TT(e),getUrlPreviewService:IT(e,s.getFilesReferenceService),getUserProfileService:NT(e),getVirtualEventsService:ET(e),getMeetingSchedulingService:FT(e),getVoicemailService:AT(e),getWebinarService:MT(e),getCallRecordingService:PT(e),getUserLicenseService:C,getDiscoverSurfaceService:p,getMonetizationService:OT(e),getMRUItemService:RT(e),getDiscoverSurfaceFeedbackService:LT(e,p),getCollabCloudService:UT(e),getTFLUserService:$T(e),getSensitivityLabelPolicySettingsService:WT(e),getWaffleService:BT(e),getOrganizationInfoService:T,getVideoMessageCameraCommandService:zT(e)});var x},XI=(e,t,i)=>{const n=HT(e,t,i);return{getPetrolService:n,getFloodgateService:qT(e,n),getOdsService:VT(e,t,i)}},ZI=e=>({getLokiMetaPreviewService:GT(e),getOdcFilePreviewService:JT(e),getOSearchService:KT(e),getPeopleSearchService:QT(e),getSubstrateFilesSearchService:YT(e),getSubstrateRecommendationsService:XT(e),getSubstrateSearchService:ZT(e),getSubstrateSuggestionsService:eI(e),getSubstrateMeetingSearchService:tI(e),getSubstrateMeetingSummarySearchService:iI(e)}),eN=e=>{const t=nI(e),i=aI(e,t),n=sI(e),a=oI(e),s=rI(e);return{getChatService:t,getChatServiceEndpointProvider:i,getConsumerGroupsService:n,getCSAService:a,getReportConcernService:cI(e),getStatefulLongPoll:s,getUnifiedConsentService:QI(e),getCallingConversationService:lI(e)}},tN=(e,t,i,n)=>{const a=dI(e,n),s=uI(e,n),o=mI(a,s,e);return{getFilesRedeemService:s,getFilesReferenceService:gI(o,e),getFilesSharepointUrlService:o,getFileUploadPreviewService:hI(e,t),getFileUploadService:pI(e,n),getFileDownloadManagerService:vI(e),getPersonalFileDetailsService:fI(e,i),getRefreshSiteUrlService:(r=e,()=>r.userServicesCache(HS.RefreshSiteUrlService,(()=>bI(r)))),getCloudStorageFoldersService:kI(e),getFilesBackfillThreadPropertiesService:SI(e),getSharepointShareService:a,getItemUploadService:NI(e),getItemDeleteService:EI(e),getItemDetailsService:FI(e),getDriveItemShareService:xI(e),getVideoFileService:DI(e,n),getFilesValidDomainsService:AI(e),getFilesSiteResourceInfoService:MI(e)};var r},iN=(e,t)=>({getVideoMessageUploadService:PI(e,t)}),nN=e=>({getCalendarService:OI(e),getExternalCalendarEmailAddressService:RI(e),getTeamCalendarService:LI(e),getMeetingRecommendationsService:UI(e)}),aN=e=>({getCommonSubstrateService:$I(e),getSignalsService:WI(e)});function sN(e){const t=(i=Object.assign({globalServicesCache:zS},e),{getExampleGlobalService:BI(i),getGlobalCallingService:zI(i),getLogsFilesService:(n=i,()=>n.globalServicesCache(HS.LogsFilesService,(()=>O_(n)))),getGlobalMTMAUserDataService:HI(i),getGlobalWebAppSwitcherService:qI(i),getGlobalTaskbarService:JI(i)});var i,n;return Object.assign(Object.assign({entityType:"unknown",windowId:""},e),t)}class oN{static createGlobalDataRequestContext(e){if(oN._globalRequestContext)throw new Error("GlobalDataRequestContext is already created!");return oN._globalRequestContext=sN(e),oN._globalRequestContext}static createUserDataRequestContext(e,t){if(!oN._globalRequestContext)throw new Error("GlobalDataRequestContext has not been created!");return function(e,t,i){const n=Object.assign(Object.assign({},e),{userServicesCache:(new WS).getOrCreateServiceInstance}),{appsRegistryService:a,appStateService:s,authenticationService:o,authenticationUser:r,authStateProvider:c,cacheStorage:l,clientPreferences:d,clientState:u,commandChangeReportingService:m,coreSettings:g,discover:h,experienceChangeReportingService:p,hostCommunicationService:v,localStorage:f,loggerFactory:b,offlineCacheManager:y,platformService:k,pubsub:S,rebootService:w,scenarioFactory:j,userBiService:C,windowProvider:_,i18n:T,brbServiceManager:I,entityCommanding:N,userTrackingService:E,mediaAuthService:F}=e;return Object.assign(Object.assign(Object.assign({},t),{appsRegistryService:a,appStateService:s,authenticationUser:r,authenticationService:o,authStateProvider:c,cacheStorage:l,clientPreferences:d,clientState:u,commandChangeReportingService:m,coreSettings:g,discover:h,entityType:"unknown",experienceChangeReportingService:p,hostCommunicationService:v,localStorage:f,loggerFactory:b,mediaAuthService:F,offlineCacheManager:y,platformService:k,pubsub:S,rebootService:w,scenarioFactory:j,userBiService:C,windowId:"",windowProvider:_,i18n:T,brbServiceManager:I,entityCommanding:N,userTrackingService:E}),YI(Object.assign(Object.assign({},n),{cmdApolloClient:i}),t))}(e,oN._globalRequestContext,t)}static get globalRequestContext(){return oN._globalRequestContext}}function rN(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(e.config.enableEmbedDataClient)return function(e,t,i){var a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{dataEvictionService:n,platformService:s,coreSettings:o,config:r}=e,{enableApolloDevtools:c}=o.get(S.J.Diagnostics),l=new Ip.pS,{defaultContext:d,link:u}=yield hN(e,i,l),m=null===(a=d.leakDetectorService)||void 0===a?void 0:a.create(),g=cN(e,l,m,u,d.loggerFactory,d.scenarioFactory)({windowId:h.ew,entityType:i,viewportContext:e.windowProvider.viewportContext,name:"embed",storeType:_p.embed});return qp(g,"embed",Boolean(c),s,r.experienceName),new iv({pubsub:l,leakDetector:m,scenarioFactory:d.scenarioFactory,coreSettings:d.coreSettings,dataOpsTracker:t,dataEvictionService:pN(n)?n:void 0,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},g,d)}))}(e,t,i);const{enableMTMA:a}=e.coreSettings.get(S.J.Core);return a?function(e,t,i){var a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:n,dataEvictionService:s}=e,o=new Ip.pS,{defaultContext:r,link:c}=yield hN(e,i,o,{noCDLTerminatingLink:!0}),l=null===(a=r.leakDetectorService)||void 0===a?void 0:a.create(),d=cN(e,o,l,c,r.loggerFactory,r.scenarioFactory),{enableApolloDataEviction:u,enableViewSchema:m}=n.get(S.J.Core);let g;return m&&(g=dN(e,o,l,qv.createViewSchemaLink(e),r.loggerFactory,r.scenarioFactory)),new US({pubsub:o,leakDetector:l,scenarioFactory:r.scenarioFactory,coreSettings:r.coreSettings,dataOpsTracker:u?t:void 0,dataEvictionService:u&&pN(s)?s:void 0,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},d,r,g)}))}(e,t,i):function(e,t,i){var a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:n,dataEvictionService:s}=e,o=new Ip.pS,{defaultContext:r,link:c}=yield hN(e,i,o),l=null===(a=r.leakDetectorService)||void 0===a?void 0:a.create(),d=cN(e,o,l,c,r.loggerFactory,r.scenarioFactory),{enableApolloDataEviction:u,enableViewSchema:m}=n.get(S.J.Core);let g;return m&&(g=dN(e,o,l,qv.createViewSchemaLink(e),r.loggerFactory,r.scenarioFactory)),new tv({pubsub:o,leakDetector:l,scenarioFactory:r.scenarioFactory,coreSettings:r.coreSettings,dataOpsTracker:u?t:void 0,dataEvictionService:u&&pN(s)?s:void 0,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},d,r,g)}))}(e,t,i)}))}function cN(e,t,i,n,a,s,o,r){const{appsRegistryService:c,coreSettings:l,platformService:d,config:u,graphqlStoreStatsReporterService:m}=e;let g;g=o||RS.create(t);const{maxApolloResultCacheSize:h,enableApolloDoubleWriteFix:p}=l.get(S.J.Core),{enableApolloDevtools:v}=l.get(S.J.Diagnostics),f=null!=h?h:void 0;return({windowId:e,entityType:t,viewportContext:o,name:l,overrideLink:h,storeType:b})=>{const y=c.getRegisteredAppsTypePolicies(e),k=lN({leakDetector:i,windowId:e,entityType:t,viewportContext:o,userContextId:r},h||n,g,f,a,s,y,v,b,m,p);return qp(k,l,Boolean(v),d,u.experienceName),k}}const lN=(e,t,i,n,a,s,o,r,c,l,d)=>{const u=Op({typePolicies:Zv(null==o?void 0:o.typePolicies),possibleTypes:Ep.g_h,dataIdFromObject:Np.X,resultCacheMaxSize:n,apolloLeakOptions:e,loggerFactory:a,scenarioFactory:s,storeType:c,graphqlStoreStatsReporterService:l,enableApolloDoubleWriteFix:d}),m=Pp({cache:u,link:t,resolvers:i,defaultOptions:{watchQuery:{nextFetchPolicy:ef}},apolloLeakOptions:e,loggerFactory:a,enableApolloDevtools:r,storeType:c,graphqlStoreStatsReporterService:l,notifyOnTeardown:!1,enableApolloDoubleWriteFix:d});return uv(u,a,null==o?void 0:o.defaultTypeName),m};function dN(e,t,i,n,a,s){const{coreSettings:o,platformService:r,config:c,graphqlStoreStatsReporterService:l}=e,{maxApolloResultCacheSize:d,enableApolloDoubleWriteFix:u}=o.get(S.J.Core),{enableApolloDevtools:m}=o.get(S.J.Diagnostics),g=null!=d?d:void 0;return({windowId:e,entityType:t,viewportContext:o,name:d,overrideLink:h,storeType:p})=>{const v=uN({leakDetector:i,windowId:e,entityType:t,viewportContext:o},h||n,{},g,a,s,p,l,u);return qp(v,d,Boolean(m),r,c.experienceName),v}}const uN=(e,t,i,n,a,s,o,r,c)=>{const l=Op({typePolicies:{PresenceAvailability:{merge:!0},PresenceOutOfOfficeStatus:{merge:!0},PresenceStatusNote:{merge:!0},ViewData:{merge:!0}},possibleTypes:Fp.g,dataIdFromObject:Np.X,resultCacheMaxSize:n,apolloLeakOptions:e,loggerFactory:a,scenarioFactory:s,storeType:o,graphqlStoreStatsReporterService:r});return Pp({cache:l,link:t,resolvers:i,defaultOptions:{watchQuery:{nextFetchPolicy:ef}},apolloLeakOptions:e,loggerFactory:a,storeType:o,graphqlStoreStatsReporterService:r,enableApolloDoubleWriteFix:c})},mN=(e,t,i)=>{const{activeWindowsService:n,appsRegistryService:a,appStateService:s,cdlAppStateService:o,authenticationService:r,authenticationUser:c,cacheStorage:l,clientPreferences:d,clientState:u,commandChangeReportingService:m,coreSettings:g,discover:p,dataEvictionService:v,experienceChangeReportingService:f,hostCommunicationService:b,leakDetectorService:y,localStorage:k,loggerFactory:S,notificationsHandler:w,offlineCacheManager:j,platformService:C,rebootService:_,scenarioFactory:T,userBiService:I,windowProvider:N,i18n:E,brbServiceManager:F,entityCommanding:x,userTrackingService:D}=e;return{activeWindowsService:n,appsRegistryService:a,appStateService:s,cdlAppStateService:o,authenticationService:r,authenticationUser:c,cacheStorage:l,clientPreferences:d,clientState:u,commandChangeReportingService:m,coreSettings:g,discover:p,dataEvictionService:v,entityType:i,experienceChangeReportingService:f,hostCommunicationService:b,leakDetectorService:y,localStorage:k,loggerFactory:S,notificationsHandler:w,offlineCacheManager:j,platformService:C,pubsub:t,rebootService:_,scenarioFactory:T,userBiService:I,windowId:h.ew,windowProvider:N,i18n:E,brbServiceManager:F,entityCommanding:x,userTrackingService:D}},gN=(e,t)=>{const i=(0,Up.v)(((t,i)=>Object.assign(Object.assign({},e),i)));return $p.i.from([i,t])};function hN(e,t,i,{noCDLTerminatingLink:a}={}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{networkState:n}=e,s=(0,_l.UZ)(Dr.l,n.observeIsOnline()),o=Object.assign(Object.assign({},e),{pubsub:i,send:s}),r=oN.createGlobalDataRequestContext(o),c=yield qv.createSingletonLink(Object.assign({contextValue:r,noCDLTerminatingLink:a},o));return{defaultContext:mN(e,i,t),link:c}}))}function pN(e){if(!e)return!1;const t=e;return"function"==typeof t.register&&"function"==typeof t.unregister}class vN extends Ue{constructor(){super(h.Yg.CreateDataClient,["scenarioFactory","loggerFactory","windowProvider","coreSettings","platformService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:i,windowProvider:n,coreSettings:a,platformService:s}=e,{enableApolloDataEviction:o,maxApolloCacheOperationCount:r}=e.coreSettings.get(S.J.Core),c=new jp({activeOperationLimit:r});e.dataCleanupService=c,o&&(e.dataEvictionService=new Cp(c,t,i,n));const l=yield rN(Object.assign(Object.assign({},e),{pulsar:this.createDataClientPulsarInstance(a,i,s)}),c,xe.pyR.default);e.client=l}))}createDataClientPulsarInstance(e,t,i){const{enablePulsarTelemetry:n,logToOTLCollector:a}=e.get(S.J.Pulsar),s=new ts(Qa.TEAMS_RESOLVER,{sessionId:i.host.sessionId,spanExporter:new is,loggerFactory:t,logToOTLCollector:!!a});return n&&s.initialize(),s}}var fN;!function(e){e[e.SingleAccount=0]="SingleAccount",e[e.MultipleAccounts=1]="MultipleAccounts"}(fN||(fN={}));var bN=i(541986),yN=i(719388);const kN={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeWindow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},SN={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}}]}}]}}]};var wN,jN,CN,_N;!function(e){e[e.Other=1]="Other",e[e.Main=2]="Main",e[e.Flyout=3]="Flyout",e[e.Minimode=4]="Minimode"}(wN||(wN={})),function(e){e.MatchingPendingIntentFound="MatchingPendingIntentFound",e.IntentOverriddenByOnBeforeAuth="IntentOverriddenByOnBeforeAuth",e.IntentOverriddenByOnAfterAuth="IntentOverriddenByOnAfterAuth"}(jN||(jN={})),function(e){e[e.NoOverride=0]="NoOverride",e[e.OverrideCloud=1]="OverrideCloud",e[e.OverrideIntent=2]="OverrideIntent",e[e.OverrideUserContext=3]="OverrideUserContext",e[e.TerminateNavigation=4]="TerminateNavigation"}(CN||(CN={})),function(e){e[e.MainWindow=0]="MainWindow",e[e.SourceWindow=1]="SourceWindow"}(_N||(_N={}));const TN=(e,t)=>{var i;const n=null==t?void 0:t.get(S.J.Auth).cloudDomainMap;if(!n)return;const a=null===(i=n.find((t=>t.domain===e)))||void 0===i?void 0:i.cloud;return a?zo.G7[a]:void 0};function IN(e){const t=e.get(S.J.Metadata).environment;if(!t)throw new ze.G(ze.$.GET_CURRENT_CLOUD_FAILED);return t}function NN(e,t){return!!e&&TN(e,t)!==IN(t)}function EN({coreSettings:e,logger:t,userContextId:i,waitForRenderingContextReady:a}){var s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=!!(null===(s=null==e?void 0:e.get(S.J.Auth))||void 0===s?void 0:s.enableIntegratedAuthApp);return t.log(`getUserContext(${i})`),a(n,i)}))}function FN(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,correlation:i,logger:a,waitForRenderingContextReady:s}=e,o=yield EN({coreSettings:t,logger:a,waitForRenderingContextReady:s}),r=yield function(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{return yield e.getUser({correlation:{id:t.id,scenarioName:t.scenarioName,source:t.source},accountId:i})}catch(e){return}}))}(o.authenticationService,i),c=null==r?void 0:r.id;return a.log(`getMainWindowUserId returns ${c}`),c}))}function xN(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,correlation:i,userContextId:n,userContextAccountType:a}=e,s=e=>t.report({type:e,correlationId:i.id,context:{target:"get-deeplink-user-context",eventData:{commandSource:i.source,deeplinkGetUserContextAccountType:_N[a],deeplinkGetUserContextId:n,scenarioPhase:"Core"}}});try{s(Ge.B.WaitForUserContextStarted);const t=yield EN(e);return s(Ge.B.WaitForUserContextCompleted),{context:{client:t.client},userContextId:n,userContextAccountType:a}}catch(e){return void t.report({type:Ge.B.WaitForUserContextFailed,correlationId:i.id,context:{target:"get-deeplink-user-context",errorInfo:Je.y.CreateUserContextError,eventData:{commandSource:i.source,deeplinkGetUserContextAccountType:_N[a],deeplinkGetUserContextId:n,scenarioPhase:"Core",errors:e instanceof Re.G&&Re.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():`${e}`}}})}}))}function DN(e,t,i,a,s,o){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{id:n,source:r}=s;t.report({type:Ge.B.IntentExecuted,correlationId:n,context:{target:"launch-cloud",eventData:{commandSource:r,scenarioPhase:"Core"}}});try{const s=yield a.loadModule("core");if(!(null==s?void 0:s.launchCloud))throw Error("launchCloud not implemented in auth module");yield s.launchCloud({cloudType:e,deepLink:i,userContextId:o,correlation:{id:n,source:r}}),t.report({type:Ge.B.IntentTransferredCrossCloud,correlationId:n,context:{target:"launch-cloud",eventData:{commandSource:r,scenarioPhase:"Core"}}})}catch(e){const i=new ze.G(ze.$.LAUNCH_CLOUD_DEEPLINK_ERROR,e);throw t.report({type:Ge.B.Failure,correlationId:n,context:{target:"launch-cloud",errorInfo:Je.y.DeeplinkLaunchCrossCloudError,eventData:{commandSource:r,scenarioPhase:"Core",errorCode:i.toTelemetryEntry()}}}),i}}))}const AN={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeAuthenticatedUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reason"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeAuthenticatedUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"reason"},value:{kind:"Variable",name:{kind:"Name",value:"reason"}}}]}]}}]},MN="intent-service";function PN(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){i.log(`Executing Intent in windowId: ${a}`);const n=function(e,t){if(t){const i=(0,B.cloneDeep)(e.entityCommand);return i.command.stateTransition=ve.su.flush,i.command.__UNSAFE_windowId=t,i}return e.entityCommand}(t,a),s=yield e(n,t.scenarioCorrelation.clientLaunchId);return i.log(`Command execution happened in windowId: ${s}`),s}))}function ON(e,t,i,n,a){return{shouldRenderContent:!0,scenarioCorrelation:t,entityCommand:at({entity:i,entityOptions:a,command:{visibilityState:ve.fe.show,stateTransition:ve.su.forceFlush,layoutMode:n,correlation:t.correlation}}),metadata:{allowAnonymous:!1,deepLink:e},options:{shouldSkipOverridingWindowing:!0,shouldSkipMinimodeOverride:!0}}}function RN(e){const t=e.entityCommand.entity.type,i=e.entityCommand.command.layoutMode;return i===ve.lO.minimode?wN.Minimode:t===pe.py.flyout||i===ve.lO.minimal?wN.Flyout:i===ve.lO.focus?wN.Other:wN.Main}function LN({commandHandler:e,commandChangeReportingService:t,error:i,errorInfo:a,errorMessage:s,fallbackError:o,intent:r,logger:c,newCommandType:l,windowId:d}){var u;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(null===(u=c.errorToTelemetry)||void 0===u||u.call(c,s,"webclient_framework_foundation_core_services_intent"),t.report({type:l,correlationId:r.scenarioCorrelation.correlation.id,context:{target:MN,errorInfo:a,eventData:{errors:i instanceof Re.G&&Re.G.isFunction(i.toTelemetryEntry)?i.toTelemetryEntry():`${i}`}}}),r.shouldRenderContent)return function(e,t,i,a,s,o){var r;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n;try{if(!(i instanceof Re.G))throw i;n=i.serialize()}catch(e){null===(r=t.errorToTelemetry)||void 0===r||r.call(t,`Failed to serialize error: ${e}`,"webclient_framework_foundation_core_services_intent"),n=null==o?void 0:o.serialize()}const c=Object.assign(Object.assign({},a),{entityCommand:{entity:{type:pe.py.error,action:pe.uk.view},entityOptions:{serializedError:n},command:Object.assign(Object.assign({},a.entityCommand.command),{layoutMode:ve.lO.focus})}});return PN(e,c,t,s)}))}(e,c,i,r,d,o)}))}var UN;function $N(e,t){const i=pe.py.identity;let n=e.entityCommand.command;return t===ve.fe.show?n={visibilityState:ve.fe.show,stateTransition:ve.su.new,layoutMode:ve.lO.focus,correlation:e.scenarioCorrelation.correlation}:t===ve.fe.hide&&(n={visibilityState:ve.fe.hide,stateTransition:ve.su.flush,layoutMode:ve.lO.focus,correlation:e.scenarioCorrelation.correlation}),{shouldRenderContent:!0,scenarioCorrelation:e.scenarioCorrelation,entityCommand:{command:n,entity:{type:i,action:pe.uk.loading},entityOptions:{tenantId:e.metadata.tenantId}},metadata:e.metadata}}!function(e){e[e.pending=0]="pending",e[e.fulfilled=1]="fulfilled",e[e.rejected=2]="rejected"}(UN||(UN={}));const WN=(e,t)=>{var i,n,a,s;const o=null!==(n=null===(i=null==t?void 0:t.get(S.J.Auth))||void 0===i?void 0:i.enableLoadingScreenInMeetings)&&void 0!==n&&n,r=null!==(s=null===(a=null==t?void 0:t.get(S.J.Auth))||void 0===a?void 0:a.enableMTO)&&void 0!==s&&s;return!e.shouldRenderContent||!(o&&r)||e.scenarioCorrelation.correlation.source===k.D.ExternalCommand||!(e.entityCommand.entity.type===pe.py.meetings||e.entityCommand.entity.type===pe.py.callingdeeplink||e.entityCommand.entity.type===pe.py.channels)};function BN(e){const t=(0,B.cloneDeep)((0,B.omit)(e,["options"]));return e.shouldRenderContent?Object.assign(Object.assign({},t),{metadata:(0,B.omit)(t.metadata,["accountToUse"])}):t}function zN(e,t,i,a,s){var o,r,c,l,d;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n,u,m;switch(a){case"onBeforeIntentAuthenticated":n=yield null===(o=i.onBeforeIntentAuthenticated)||void 0===o?void 0:o.execute(s);break;case"onAfterIntentAuthenticated":n=yield null===(r=i.onAfterIntentAuthenticated)||void 0===r?void 0:r.execute(s);break;default:{const e=`evaluateHook(${a}): Unknown hook and options.`;throw null===(c=t.errorToTelemetry)||void 0===c||c.call(t,e,"webclient_framework_foundation_core_services_intent",void 0,!0),new Error(e)}}if(!n){const e=`evaluateHook(${a}): Undefined app hook response.`;throw null===(l=t.errorToTelemetry)||void 0===l||l.call(t,e,"webclient_framework_foundation_core_services_intent",void 0,!0),new Error(e)}switch(n.overrideType){case CN.NoOverride:m=!1,u=s.intent;break;case CN.OverrideCloud:m=!0,u=Object.assign(Object.assign({},s.intent),{metadata:Object.assign(Object.assign({},s.intent.metadata),{cloud:n.cloud})});break;case CN.OverrideIntent:m=!0,u=n.intent;break;case CN.OverrideUserContext:m=!1,u=Object.assign(Object.assign({},s.intent),{metadata:Object.assign(Object.assign({},s.intent.metadata),{userContextId:n.userContextId})});break;case CN.TerminateNavigation:m=!0,u=void 0;break;default:const e=`evaluateHook(${a}): Invalid app hook override type.`;throw null===(d=t.errorToTelemetry)||void 0===d||d.call(t,e,"webclient_framework_foundation_core_services_intent",void 0,!0),new Error(e)}if(e.report({correlationId:s.intent.scenarioCorrelation.correlation.id,type:Ge.B.IntentHookResolved,context:{target:MN}}),u&&s.intent.shouldRenderContent!==u.shouldRenderContent)throw new ze.G(ze.$.INVALID_INTENT_OVERRIDE);return{intentOverridenByHook:m,intent:u}}))}var HN=i(663945);const qN=(e,t,i,a,s,o,r)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var c,l,d;const u={};u["Foundation.deeplinkWindowTarget"]=(e=>{const t=e.entityCommand.command,{stateTransition:i,layoutMode:n,targetWindow:a}=t;switch(n){case ve.lO.minimal:return"flyout";case ve.lO.minimode:return"minimode";default:return i===ve.su.new?"child":i===ve.su.flush||i===ve.su.forceFlush||a===ve.PH.main?"main":void 0}})(e),u["Foundation.accountType"]=yield((e,t,i,a,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=yield FN({coreSettings:i,logger:a,waitForRenderingContextReady:s,correlation:e.scenarioCorrelation.correlation});return n?t&&e.metadata.userContextId?e.metadata.userContextId===n?"main":"background":"unknown":"preauth"})))(e,t,i,a,s);const m=(null===(d=null===(c=o.getApp({entityType:e.entityCommand.entity.type}))||void 0===c?void 0:(l=c.manifest).getAllowUserWindowingPreference)||void 0===d?void 0:d.call(l,{coreSettings:i,entity:e.entityCommand.entity}))||!1;u["Foundation.isUserPreferenceOverriddenByApp"]=!m,r.recordPanelAction({actionGesture:HN.uS.auto,actionOutcome:HN.$K.open,actionScenario:HN.Tk.deeplink,actionScenarioType:HN.Yu.deeplink,moduleType:HN.PO.intent,moduleName:HN.rA.intentService,dataBag:{id:"",data:Object.assign({},u),dispose:()=>{}},mainEntityType:e.entityCommand.entity.type,mainEntityAction:e.entityCommand.entity.action},a)})),VN="intent-service",GN="none";class JN{constructor(e,t,i,n,a,s,o,r,c,l,d,u,m){this.appsRegistryService=t,this.coreSettings=i,this.commandHandler=n,this.client=a,this.waitForRenderingContextReady=s,this.commandChangeReportingService=o,this.experienceChangeReportingService=r,this.scenarioFactory=c,this.hostComms=l,this.host=d,this.activeWindowsService=u,this.userBiService=m,this.pendingIntentMap=new Map,this.logger=e.newLogger("IntentService","core-services-deeplink"),u.enableDecoupleCommandingFromApollo?this.observeActiveWindows():this.observeActiveWindowsDeprecated(),this.hasCreatedNonMainWindow=!1}execute(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let i,n,a;if(this.logInternal("execute: Original intent:",e),e.shouldRenderContent){a=RN(e),yield this.cleanupActiveWindowsIfNeeded(a);const t=this.pendingIntentMap.get(a);t&&(i=t.windowId,n=jN.MatchingPendingIntentFound,this.logInternal(`execute: Replacing intent for window id: ${i} with layout type ${a}:`,e)),this.pendingIntentMap.set(a,{intent:(0,B.cloneDeep)(e),windowId:i})}this.logInternal("execute: Intent for evaluation:",e),this.commandChangeReportingService.report({correlationId:e.scenarioCorrelation.correlation.id,type:Ge.B.IntentReceived,context:{target:VN,eventData:{mainEntityType:e.shouldRenderContent?e.entityCommand.entity.type:GN,mainEntityAction:e.shouldRenderContent?e.entityCommand.entity.action:GN,errorCode:n}}}),e=function(e,t){var i,n;const{coreSettings:a,appsRegistryService:s}=t,{enableMinimodeWindow:o}=a.get(S.J.Core);o&&e.shouldRenderContent&&!(null===(i=e.options)||void 0===i?void 0:i.shouldSkipMinimodeOverride)&&e.entityCommand.command.stateTransition!==ve.su.extend&&e.entityCommand.command.stateTransition!==ve.su.none&&"com.microsoft.teams.chat"===(null===(n=s.getApp({entityType:e.entityCommand.entity.type}))||void 0===n?void 0:n.manifest.id)&&(e.entityCommand.command.layoutMode=ve.lO.minimode);return e}(e,{coreSettings:this.coreSettings,appsRegistryService:this.appsRegistryService});const{intentExecuted:s,targetWindowId:o}=yield this.executeInternal(e,i);if(e.shouldRenderContent&&a)s?(this.logger.log("execute: Intent was not overriden and executed. Removing from state."),this.pendingIntentMap.delete(a)):(this.pendingIntentMap.set(a,{intent:(0,B.cloneDeep)(e),windowId:o}),this.logInternal(`execute: updated window ID: ${o}: For pending intent:`,e)),(null===(t=e.options)||void 0===t?void 0:t.isFromDeeplink)&&(yield this.sendDeeplinkUserBi(e,s));else if(!e.shouldRenderContent){const t=this.scenarioFactory.findScenario(z.RG.ApplicationLaunchTime);null==t||t.stop({mainEntityType:GN,reason:"nrc_background_launch"}),this.commandChangeReportingService.report({type:Ge.B.Blanked,correlationId:e.scenarioCorrelation.correlation.id,context:{target:"intent-service",eventData:{systemInitiated:!0,mainEntityType:GN}}})}this.experienceChangeReportingService.report({correlationId:e.scenarioCorrelation.correlation.id,type:Mt.yU.NavigationIntentExecuted,context:{target:"intent-service",shouldRenderContent:e.shouldRenderContent}})}))}checkForPendingIntent(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){for(const[i,{intent:n,windowId:a}]of Array.from(this.pendingIntentMap)){const s=(0,B.cloneDeep)(n);if(s){this.commandChangeReportingService.report({correlationId:e.id,type:Ge.B.IntentReceived,context:{target:VN,eventData:{mainEntityType:s.entityCommand.entity.type,mainEntityAction:s.entityCommand.entity.action}}}),s.entityCommand.command.visibilityState=ve.fe.showWithoutFocusing,s.metadata.userContextId=t,s.entityCommand.command.correlation=e,s.scenarioCorrelation.correlation=e,this.logInternal("checkForPendingIntent: Executing pending intent:",s);const{intentExecuted:n}=yield this.executeInternal(s,a,!0);n&&(this.logger.log("checkForPendingIntent: Intent was not overriden and executed. Removing from state."),this.pendingIntentMap.delete(i))}}}))}switchAccount(e,t,i,a,s){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.logger.log("switchAccount"),this.execute({shouldRenderContent:!0,scenarioCorrelation:t,entityCommand:at({entity:i,entityOptions:s,command:{visibilityState:ve.fe.show,stateTransition:ve.su.forceFlush,layoutMode:ve.lO.standard,correlation:t.correlation}}),metadata:{allowAnonymous:!1,deepLink:e,userContextId:a},options:{shouldSkipOverridingWindowing:!0,shouldSkipMinimodeOverride:!0}})}))}launchMainApp(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("launchMainApp"),yield this.execute(ON(e,t,i,ve.lO.standard,a))}))}launchMinimode(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("launchMinimode"),yield this.execute(ON(e,t,i,ve.lO.minimode))}))}prewarmFlyout(e,t=!1){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("prewarmFlyout"),yield this.execute({shouldRenderContent:!0,scenarioCorrelation:e,entityCommand:at({entity:{type:pe.py.default,action:pe.uk.default},command:{visibilityState:ve.fe.showWithoutFocusing,stateTransition:ve.su.flush,layoutMode:t?ve.lO.minimode:ve.lO.minimal,correlation:e.correlation}}),metadata:{allowAnonymous:!1,deepLink:fo.n0.flyout},options:{shouldSkipOverridingWindowing:!0,shouldSkipMinimodeOverride:!0}})}))}cleanupActiveWindowsIfNeeded(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{switch(e){case wN.Other:const e=this.pendingIntentMap.get(wN.Main);e&&(this.logger.log(`Closing main window with id=${e.windowId}.`),yield this.client.mutate({mutation:kN,variables:{windowId:e.windowId}}));case wN.Main:const t=this.pendingIntentMap.get(wN.Other);t&&(this.logger.log(`Closing other window with id=${t.windowId}.`),yield this.client.mutate({mutation:kN,variables:{windowId:t.windowId}}))}}catch(t){this.logger.warn(`cleanupActiveWindowsIfNeeded: Failed to remove window of type ${e}: ${t.message}`)}}))}observeActiveWindows(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.activeWindowsService.getActiveWindowsObservable().subscribe(this.handleNewActiveWindows.bind(this))}))}observeActiveWindowsDeprecated(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.client.watchQuery({query:SN}).subscribe((e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!e.loading&&!e.errors){const{data:{activeWindows:t}}=e;this.handleNewActiveWindows(t)}}))))}))}handleNewActiveWindows(e){var t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(null===(i=null===(t=this.coreSettings)||void 0===t?void 0:t.get(S.J.Core))||void 0===i?void 0:i.enableAnonymousCallerSignout){const t=(e=>e.some((e=>!e.isMainWindow)))(e);if(this.hasCreatedNonMainWindow){const e=yield EN({coreSettings:this.coreSettings,logger:this.logger,waitForRenderingContextReady:this.waitForRenderingContextReady});yield((e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(!e&&i){const e={id:(0,$r.pW)(),source:"intent-service",scenarioName:z.RG.AuthWebLogout};yield t.mutate({mutation:AN,variables:{reason:"AnonymousSessionEnd"},context:{correlation:e}})}})))(t,this.client,(e=>{var t;return(null===(t=null==e?void 0:e.authenticationUser)||void 0===t?void 0:t.type)===zo.Ch.Anonymous})(e))}else this.hasCreatedNonMainWindow=t}this.checkAndCleanupIfWindowRemoved(e.map((e=>e.id)))}))}checkAndCleanupIfWindowRemoved(e){for(const[t,{intent:i,windowId:n}]of Array.from(this.pendingIntentMap))n&&!e.find((e=>e===n))&&(this.logInternal(`checkAndCleanupIfWindowRemoved: window id: ${n} no longer exists, removing intent:`,i),this.pendingIntentMap.delete(t))}executeInternal(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const a=yield this.executeOnCrossCloudMeeting(e,t);if(a)return a;let s=this.commandHandler;this.logInternal(`executeInternal: windowId: ${t}: Original intent:`,e);const{intentOverridenByHook:o,newTargetWindowId:r,errorCode:c,targetCloud:l,targetUserContextId:d}=yield this.evaluateOnBeforeIntentAuthHook(e,s,t);let u,m,g=c;if(o)return this.logger.log("executeInternal: Intent overriden by onBeforeIntentAuthenticated."),l?(this.logger.log("executeInternal: overridden to target cloud. LaunchCloud and return early."),yield DN(l,this.commandChangeReportingService,e.metadata.deepLink,this.hostComms,e.scenarioCorrelation.correlation,e.metadata.userContextId),{intentExecuted:!0,targetWindowId:r}):{intentExecuted:!1,targetWindowId:r};if(e.metadata.userContextId!==d&&(this.logger.log("executeInternal: userContextId overriden by onBeforeIntentAuthenticated."),e.metadata.userContextId=d),!e.shouldRenderContent&&!e.metadata.userContextId)return this.logger.log("executeInternal: userContextId is still undefined. Returning early."),{intentExecuted:!1,targetWindowId:r};this.commandChangeReportingService.report({type:Ge.B.WaitForUserContextStarted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:VN}});try{u=yield EN({coreSettings:this.coreSettings,logger:this.logger,userContextId:e.metadata.userContextId,waitForRenderingContextReady:this.waitForRenderingContextReady})}catch(i){return{intentExecuted:!0,targetWindowId:yield LN({commandHandler:this.commandHandler,commandChangeReportingService:this.commandChangeReportingService,error:new ze.G(ze.$.CREATE_USER_CONTEXT_FAILED_GENERIC,i,e.metadata.userContextId),errorInfo:Je.y.CreateUserContextError,errorMessage:`getUserContext(${e.metadata.userContextId}) failed, executing original intent ${i}.`,fallbackError:new ze.G(ze.$.CREATE_USER_CONTEXT_FAILED_GENERIC,void 0,e.metadata.userContextId),intent:e,logger:this.logger,newCommandType:Ge.B.WaitForUserContextFailed,windowId:t})}}if(this.commandChangeReportingService.report({type:Ge.B.WaitForUserContextCompleted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:VN}}),null==u?void 0:u.authenticationUser){const i=u;s=(e,t)=>xi(Object.assign(Object.assign({},i),{entityCommandInput:e,clientLaunchId:t}));const{intentOverridenByHook:n,targetWindowId:a,errorCode:o}=yield this.evaluateOnAfterIntentAuthenticatedHook(e,s,u,t);if(o&&(g=o),n)return this.logger.log("executeInternal: Intent overriden by onAfterIntentAuthenticated."),{intentExecuted:!1,targetWindowId:a}}else this.logger.log(`executeInternal: user context / authentication user is not defined for userContextId: ${e.metadata.userContextId}  - skip execution of onAfterIntentAuthenticated`);if(this.logInternal(`executeInternal: windowId: ${t}: Executing original intent:`,e),e.shouldRenderContent){const a=yield FN({coreSettings:this.coreSettings,logger:this.logger,waitForRenderingContextReady:this.waitForRenderingContextReady,correlation:e.scenarioCorrelation.correlation});if(this.logInternal(`executeInternal: The intent is targeting userContextId ${e.metadata.userContextId}, and the mainWindowUserId is ${a}:`,e),this.shouldGoToAccountListWindow(e,a))return yield function(e,t,i,a){var s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){a.metadata.accountToUse=void 0,a.entityCommand.command.stateTransition=ve.su.new,a.entityCommand.command.layoutMode=ve.lO.focus;const n=(0,B.cloneDeep)(a);return n.entityCommand.entity={id:`${a.entityCommand.command.layoutMode}`,type:pe.py.identity,action:pe.uk.list,linkedEntity:{type:a.entityCommand.entity.type,action:a.entityCommand.entity.action,id:null!==(s=a.entityCommand.entity.id)&&void 0!==s?s:a.entityCommand.command.correlation.id}},n.entityCommand.command=Object.assign(Object.assign({},a.entityCommand.command),{layoutMode:ve.lO.focus,stateTransition:ve.su.new,visibilityState:ve.fe.show}),t.log(`goToAccountListWindow: Executing account list intent: {${n.entityCommand.entity.type}, ${n.entityCommand.entity.action}, ${n.entityCommand.command.layoutMode}, ${n.entityCommand.command.visibilityState}}`),e.report({correlationId:n.scenarioCorrelation.correlation.id,type:Ge.B.IntentExecuted,context:{target:MN,eventData:{mainEntityType:n.entityCommand.entity.type,mainEntityAction:n.entityCommand.entity.action}}}),PN(i,n,t)}))}(this.commandChangeReportingService,this.logger,s,e),{intentExecuted:!1,targetWindowId:void 0};!function(e,t,i,n,a,s){var o,r,c,l,d,u;if(null===(o=i.options)||void 0===o?void 0:o.shouldSkipOverridingWindowing)return;if(!(null===(r=e.get(S.J.Core))||void 0===r?void 0:r.enableDeeplinkOptionAllowUserWindowingPreference))return;if(!s)return void a.log("Main window user context id is undefined");if(NN(i.metadata.homeCloud,e))return;const m=RN(i);if(a.log(`PendingIntentType: ${m}`),m===wN.Flyout||m===wN.Minimode)return;const g=i.entityCommand.command;switch(a.log(`StateTransition: ${g.stateTransition}`),g.stateTransition){case ve.su.none:case ve.su.extend:case ve.su.flow:return}if(a.log(`EntityType: ${i.entityCommand.entity.type}`),i.entityCommand.entity.type===pe.py.default||i.entityCommand.entity.action===pe.uk.default||i.entityCommand.entity.type===pe.py.identity)return;const h=(null===(d=null===(c=n.getApp({entityType:i.entityCommand.entity.type}))||void 0===c?void 0:(l=c.manifest).getAllowUserWindowingPreference)||void 0===d?void 0:d.call(l,{coreSettings:e,entity:i.entityCommand.entity}))||!1;if(a.log(`AllowUserWindowingPreference: ${h}`),i.metadata.userContextId)if(i.metadata.userContextId===s){if(a.log("User context of intent matches main window user"),h){const e=t.getPreferences("windowing").shouldOpenContentInNewWindow;a.log(`ShouldOpenContentInNewWindow ${e}`),e?(g.layoutMode=ve.lO.focus,g.stateTransition=ve.su.new):(g.layoutMode=ve.lO.standard,g.stateTransition=ve.su.flush)}}else a.log("User context of intent does not match main window user"),h||g.stateTransition===ve.su.new?(g.layoutMode=ve.lO.focus,g.stateTransition=ve.su.new):(g.layoutMode=ve.lO.standard,g.stateTransition=ve.su.forceFlush,g.targetWindow=ve.PH.main);else null===(u=a.errorToTelemetry)||void 0===u||u.call(a,"Unexpected undefined userContextId for intent in override","webclient_framework_foundation_core_services_intent",void 0,!0)}(this.coreSettings,u.clientPreferences,e,this.appsRegistryService,this.logger,a),function(e,t,i,a,s,o){var r,c;(0,n.__awaiter)(this,void 0,void 0,(function*(){s&&i.entityCommand.entity.type===pe.py.default&&(a.log("checkForPendingIntent: Translating default entity to a real entity"),i.entityCommand.entity=null!==(c=e.getDefaultCommand(null!==(r=null==o?void 0:o.coreSettings)&&void 0!==r?r:t,i.entityCommand.command.layoutMode))&&void 0!==c?c:i.entityCommand.entity)}))}(this.appsRegistryService,this.coreSettings,e,this.logger,i,u),m=yield PN(s,e,this.logger,t)}return this.logInternal(`executeInternal: windowId: ${t}: Executed intent:`,e),this.commandChangeReportingService.report({correlationId:e.scenarioCorrelation.correlation.id,type:Ge.B.IntentExecuted,context:{target:VN,eventData:{mainEntityType:e.shouldRenderContent?e.entityCommand.entity.type:GN,mainEntityAction:e.shouldRenderContent?e.entityCommand.entity.action:GN,errorCode:g}}}),{intentExecuted:!0,targetWindowId:m}}))}executeOnCrossCloudMeeting(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=this.coreSettings.get(S.J.Metadata).environment;if(e.shouldRenderContent&&e.entityCommand.entity.type===pe.py.callingdeeplink&&i&&e.metadata.homeCloud&&TN(e.metadata.homeCloud,this.coreSettings)!==i&&!1===this.coreSettings.get(S.J.HostCapabilities,["crossCloudMeetingEnabled"]).crossCloudMeetingEnabled){return{intentExecuted:!0,targetWindowId:yield LN({commandHandler:this.commandHandler,commandChangeReportingService:this.commandChangeReportingService,error:new ze.G(ze.$.EXPERIENCE_DISABLED,void 0,e.metadata.userContextId),errorInfo:Je.y.DeeplinkExecutionTerminated,errorMessage:"Deeplink callingdeeplink execution was terminated, because crossCloudMeetingEnabled is disabled.",intent:e,logger:this.logger,newCommandType:Ge.B.Failure,windowId:t})}}}))}evaluateOnBeforeIntentAuthHook(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.commandChangeReportingService.report({type:Ge.B.OnBeforeIntentAuthenticatedStarted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:VN}});const{intentOverridenByHook:a,targetWindowId:s,errorCode:o,targetCloud:r,targetUserContextId:c}=yield function(e,t,i,a,s,o,r,c,l){var d,u;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n=UN.pending,m={};if(WN(t,o))return m=yield e(),m;a.log("Proceed with loading screen display if threshold exceeds.");const g=null!==(u=null===(d=null==o?void 0:o.get(S.J.Auth))||void 0===d?void 0:d.thresholdToShowLoadingScreenInMs)&&void 0!==u?u:2e3;let h;const p=s.setTimeout((()=>{n!==UN.pending||h||(r.report({type:Ge.B.OnLoadingScreenDisplayStarted,correlationId:t.scenarioCorrelation.correlation.id,context:{target:c}}),PN(i,$N(t,ve.fe.show),a,l).then((e=>{h=e})).catch((e=>a.warn(`Error while launching loading screen: ${e}`))))}),g);try{m=yield e(),n=UN.fulfilled}catch(e){throw n=UN.rejected,e}finally{s.clearTimeout(p),h&&(PN(i,$N(t,ve.fe.hide),a,h).catch((e=>a.warn(`Error while closing loading screen: ${e}`))),r.report({type:Ge.B.OnLoadingScreenDisplayCompleted,correlationId:t.scenarioCorrelation.correlation.id,context:{target:c}}))}return m}))}((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.evaluateHook("onBeforeIntentAuthenticated",{intent:BN(e),context:{client:this.client,coreSettings:this.coreSettings,scenarioFactory:this.scenarioFactory}},t,i)}))),e,t,this.logger,this.host,this.coreSettings,this.commandChangeReportingService,VN,i);return this.commandChangeReportingService.report({type:Ge.B.OnBeforeIntentAuthenticatedCompleted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:VN,eventData:{errorCode:o}}}),{intentOverridenByHook:a,newTargetWindowId:s,errorCode:o,targetCloud:r,targetUserContextId:c}}))}evaluateHook(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n,s;this.logger.log(`evaluateHook(${e}): windowId: ${a}: Begin evaluation`);let o=!1;for(const r of function(e,t,i){const n=[];for(const a of e.registeredApps){const e=a[t];if(e)for(const t of Array.from(e.filter))"*"!==t&&t!==i||n.push(a)}return n}(this.appsRegistryService,e,t.intent.shouldRenderContent?t.intent.entityCommand.entity.type:void 0)){this.logger.log(`evaluateHook(${e}) - Matching app found: ${r.manifest.id}`),this.commandChangeReportingService.report({correlationId:t.intent.scenarioCorrelation.correlation.id,type:Ge.B.IntentHookStarted,context:{target:VN,eventData:{matchingApp:r.manifest.id}}});try{const i=yield zN(this.commandChangeReportingService,this.logger,r,e,t);o=i.intentOverridenByHook,n=i.intent,s=o?"onBeforeIntentAuthenticated"===e?jN.IntentOverriddenByOnBeforeAuth:jN.IntentOverriddenByOnAfterAuth:void 0}catch(i){this.logger.warn(`evaluateHook(${e}) windowId: ${a}: - Evaluating hook threw an error: ${i}. Executing error intent.`),s="onBeforeIntentAuthenticated"===e?Je.y.OnBeforeIntentAuthenticatedRejected:Je.y.OnAfterIntentAuthenticatedRejected;return{intentOverridenByHook:!0,targetWindowId:yield LN({commandHandler:this.commandHandler,commandChangeReportingService:this.commandChangeReportingService,error:i,errorInfo:s,errorMessage:`evaluateHook(${e}) windowId: ${a}: - Evaluating hook threw an error: ${i}. Falling back to original intent.`,fallbackError:new ze.G(ze.$.UNKNOWN),logger:this.logger,intent:t.intent,newCommandType:Ge.B.IntentHookRejected,windowId:a}),errorCode:s}}if(o){if(!n)return this.logger.warn(`evaluateHook(${e}) windowId: ${a}: - Hook overriden to undefined. Stopping further processing`),this.commandChangeReportingService.report({correlationId:t.intent.scenarioCorrelation.correlation.id,type:Ge.B.Failure,context:{target:VN,errorInfo:"onBeforeIntentAuthenticated"===e?Je.y.OnBeforeIntentAuthenticatedReturnedUndefined:Je.y.OnAfterIntentAuthenticatedReturnedUndefined}}),{intentOverridenByHook:!0,targetWindowId:a};if(n.metadata.cloud)return{intentOverridenByHook:o,targetWindowId:void 0,targetCloud:n.metadata.cloud,errorCode:s};if(t.intent.shouldRenderContent&&n.shouldRenderContent){this.logInternal(`evaluateHook(${e}), windowId: ${a}: - Executing overriden intent:`,n),this.commandChangeReportingService.report({correlationId:n.scenarioCorrelation.correlation.id,type:Ge.B.IntentExecuted,context:{target:VN,eventData:{mainEntityType:n.shouldRenderContent?n.entityCommand.entity.type:GN,mainEntityAction:n.shouldRenderContent?n.entityCommand.entity.action:GN,errorCode:s}}});return{intentOverridenByHook:o,targetWindowId:yield PN(i,n,this.logger,a),errorCode:s}}}}return this.logger.log(`evaluateHook(${e}): windowId: ${a}: Completing evaluation. Intent was not overriden.`),this.commandChangeReportingService.report({correlationId:t.intent.scenarioCorrelation.correlation.id,type:Ge.B.IntentHookCompleted,context:{target:VN}}),{intentOverridenByHook:!1,targetWindowId:a,errorCode:s,targetUserContextId:null==n?void 0:n.metadata.userContextId}}))}logInternal(e,t){this.logger.log(`${e} {${t.shouldRenderContent?`${t.entityCommand.entity.type}, ${t.entityCommand.entity.action}, ${t.entityCommand.command.layoutMode}, ${t.entityCommand.command.visibilityState}}`:"nrc"}`)}evaluateOnAfterIntentAuthenticatedHook(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.commandChangeReportingService.report({type:Ge.B.OnAfterIntentAuthenticatedStarted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:VN}});const{intentOverridenByHook:n,targetWindowId:s,errorCode:o}=yield this.evaluateHook("onAfterIntentAuthenticated",{intent:BN(e),context:{authenticatedUser:i.authenticationUser,client:i.client,localStorage:i.localStorage,coreSettings:this.coreSettings,experienceChangeReportingService:i.experienceChangeReportingService}},t,a);return this.commandChangeReportingService.report({type:Ge.B.OnAfterIntentAuthenticatedCompleted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:VN,eventData:{errorCode:o}}}),{intentOverridenByHook:n,targetWindowId:s,errorCode:o}}))}shouldGoToAccountListWindow(e,t){var i,n,a,s;const o=(null===(a=null===(i=this.appsRegistryService.getApp({entityType:e.entityCommand.entity.type}))||void 0===i?void 0:(n=i.manifest).getAllowUserWindowingPreference)||void 0===a?void 0:a.call(n,{coreSettings:this.coreSettings,entity:e.entityCommand.entity}))||!1;return!!(null===(s=this.coreSettings.get(S.J.Core))||void 0===s?void 0:s.enableDeeplinkOptionAccountToUse)&&e.metadata.accountToUse===fo.TS.UserChoiceFallback&&!!t&&e.metadata.userContextId===t&&(o||e.entityCommand.command.stateTransition===ve.su.new)}sendDeeplinkUserBi(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){qN(e,t,this.coreSettings,this.logger,this.waitForRenderingContextReady,this.appsRegistryService,this.userBiService)}))}}const KN=["#/apps","#/conversations","#/debug","#/modern-calling","#/scheduling-form"],QN=["ctx=channel","ctx=chat","MyLearning"],YN=["/_","/alerts","/analytics/myteams","/apps","/bizChatCopilotApp","/broadcast-intermediate-screen","/broadcastPlaybackScreen","/calendar","/calendarv2","/calendarv2owa","/calling-intermediate-screen","/calling","/callingProtocol","/calls","/channel-hub","/channelDashboard","/channels","/chatProtocol","/chats","/communities","/communitiesDashboard","/communitiesOnboarding","/debug","/deepLinkAutoInstallNotification","/deepLinkDiscoverAppsNotifications","/deepLinkFreemiumUpgrade","/deepLinkLobNotifications","/deepLinkOnboardingNotifications","/deviceLicenseError","/discover","/discoverSurface","/download","/error","/files/oneupviewer","/force_resync_data","/freemium-upsell","/getUserMedia","/guestLicense","/help","/l/app","/l/auth-callback","/l/auth/google","/l/call","/l/claim","/l/community","/l/file","/l/fileDownload","/l/help","/l/home","/l/invite","/l/manage-teams","/l/meeting-share","/l/meeting","/l/meetingrecap","/l/meetnow-join","/l/meetup-join","/l/present","/l/search","/l/settings/recognition","/l/stage","/l/task","/l/virtualevent","/l/virtualevent/new","/l/voiceassistant","/licenseError","/manageteams/myinvites","/manageteams/myteams","/manageTenant","/meet","/meeting/meet/list","/message","/modern-calling","/my","/non-members-placeholder","/oops","/people","/post-calling","/post-echo-bot-call","/pre-join-calling","/rigel-console-broadcast","/rigel-console-cortana","/rigel-console-home-page","/rigel-console-join-by-code","/rigel-console-post-call","/rigel-console-pre-call","/rigel-console","/scheduling-form","/school","/search","/sections","/sfbfrequickstartvideo","/smart-devices-guest-screen","/smart-devices-home-screen","/smart-devices-login-screen","/smbWelcome","/start-meeting","/subscriptionManagement","/surface-hub-home-screen","/team-overview","/teamCreate","/teamDashboard","/teamsGallery","/tenantSwitch","/toolkit","/unsupportedBrowser","/unsupportedIE","/v2/"],XN=["callto:","ftp:","ftps:","http:","https:","im:","mailto:","msteams:","onenote:","sip:","sips:","tel:","vscode-insiders:","vscode:","vsls:"],ZN=e=>KN.find((t=>e.startsWith(t))),eE=e=>QN.find((t=>e.endsWith(t))),tE=e=>{const t=fo.Hl.find((t=>e.startsWith(t)));return t||YN.find((t=>e.startsWith(t)))},iE=e=>XN.find((t=>e===t));function nE(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,coreSettings:i,experienceBasePath:a,location:s,scenarioCorrelation:o,loggerFactory:r,userContextId:c}=e,l=r.newLogger("DeeplinkUtilities","core-services-deeplink"),d=Mo({coreSettings:i,experienceBasePath:a,location:s,loggerFactory:r});t.report({type:Ge.B.ScenarioEventDataAppended,correlationId:o.correlation.id,context:{target:"deeplink-parsing",eventData:{homeCloud:null==d?void 0:d.homeCloud}}});let u,m=!1;if(d&&d.isDesktopDeeplink){const t=yield function(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,deepLink:i,homeCloud:n,logger:a,scenarioCorrelation:s,userContextId:o,windowType:r}=e,c=fo.n0[i];if(c){let e;switch(a.log(`Static deeplink: ${c}`),i){case fo.n0.flyout:const t=ve.lO.minimal;e=sE({scenarioCorrelation:s,userContextId:o,deepLink:i,homeCloud:n,entity:lE(t),layoutMode:t});break;case fo.n0.default:{let t=ve.lO.standard;r!==fo.fo.mini&&r!==fo.fo.main||(t=ve.lO.minimode),e=sE({scenarioCorrelation:s,userContextId:o,deepLink:i,homeCloud:n,entity:lE(t),layoutMode:t});break}case fo.n0.core:e=sE({scenarioCorrelation:s,userContextId:o,deepLink:i,homeCloud:n})}return uE({commandChangeReportingService:t,correlationId:s.correlation.id,deeplinkType:c,mainEntityType:(null==e?void 0:e.shouldRenderContent)?null==e?void 0:e.entityCommand.entity.type:void 0,mainEntityAction:(null==e?void 0:e.shouldRenderContent)?null==e?void 0:e.entityCommand.entity.action:void 0,loadingWindowType:r}),{terminateDeeplink:!1,intent:e}}const l=yield dE(Object.assign(Object.assign({},e),{deepLink:i}));if(l.intent||l.terminateDeeplink)return l;return{terminateDeeplink:!1,intent:aE(i,s,o,n)}}))}(Object.assign(Object.assign({},e),{userContextId:c||d.userContextId,deepLink:d.deepLink,homeCloud:d.homeCloud,logger:l,windowType:d.windowType}));m=t.terminateDeeplink,u=t.intent}else if(d){const t=yield dE(Object.assign(Object.assign({},e),{deepLink:d.deepLink,userContextId:c||d.userContextId,logger:l}));m=t.terminateDeeplink,u=t.intent}if(m)return{terminateDeeplink:m,intent:u};if(u||(u=function(e,t,i){const{hash:n,pathname:a}=e;let s;if(n&&!(0,B.isEmpty)(n)){const e=n.indexOf("?");s=e>=0?n.substr(0,e):n}else s=a;return aE(s,t,i)}(s,o,c)),!u&&d){const t=Io(d.deepLink,e.coreSettings),i=(e=>{const{pathname:t,protocol:i,hash:n}=e,a={hashstart:void 0,hashend:void 0,pathname:void 0,protocol:void 0};return a.protocol=iE(i),a.pathname=tE(t),a.hashstart=ZN(n),a.hashend=eE(n),void 0===a.pathname&&void 0===a.protocol&&void 0===a.hashstart&&void 0===a.hashend?"unsupported":(0,U.u4)(a)})(t);l.errorToTelemetry&&l.errorToTelemetry(i,"webclient_framework_foundation_core_services_deeplink",void 0,!0),u=yield function({commandChangeReportingService:e,originalDeeplink:t,coreSettings:i,hostCommunicationService:a,logger:s,scenarioCorrelation:o,userContextId:r}){var c;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enableUnsupportedDeeplinkDialog:n,clientPreviewOptOutStrategy:l}=i.get(S.J.Core);if(s.log(`enableUnsupportedDeeplinkDialog: ${n}`),n){let i=l===N.a5.Web;if(l===N.a5.Desktop){const e=yield a.loadModule("appswitcher"),t=yield null===(c=null==e?void 0:e.getPearInstallState)||void 0===c?void 0:c.call(e,Bi.OP.Teams1);s.log(`t1InstallState: ${t}`),i=t===Bi.Jv.InstalledNotActive||t===Bi.Jv.InstalledActive}if(i){s.log("Returning unsupported deeplink command");const i=sE({scenarioCorrelation:o,userContextId:r,deepLink:t.toString(),entity:{type:pe.py.unsupporteddeeplinkdialog,action:pe.uk.view},layoutMode:ve.lO.standard,stateTransition:ve.su.extend,entityOptions:{originalDeeplink:t}}),{pathname:n}=t,a=fo.Hl.find((e=>n.startsWith(e))),c=null!=a?a:"unsupported";return uE({commandChangeReportingService:e,correlationId:o.correlation.id,deeplinkType:c,mainEntityType:null==i?void 0:i.entityCommand.entity.type,mainEntityAction:null==i?void 0:i.entityCommand.entity.action}),i}}}))}({commandChangeReportingService:e.commandChangeReportingService,originalDeeplink:t,coreSettings:e.coreSettings,hostCommunicationService:e.hostCommunicationService,logger:l,scenarioCorrelation:o,userContextId:c})}return{terminateDeeplink:!1,intent:u}}))}function aE(e,t,i,n){const a=Ro(e);if(a)return sE({scenarioCorrelation:t,userContextId:i,deepLink:mE(e||fo.n0.default),entity:a,homeCloud:n})}function sE(e){const{scenarioCorrelation:t,userContextId:i,deepLink:n,homeCloud:a,entity:s,layoutMode:o,stateTransition:r=ve.su.flush,entityOptions:c}=e;return s?{shouldRenderContent:!0,scenarioCorrelation:t,entityCommand:at({entity:s,command:{visibilityState:ve.fe.show,stateTransition:r,layoutMode:o,correlation:t.correlation},entityOptions:c,metadata:{deepLink:n}}),metadata:{allowAnonymous:!1,deepLink:n,homeCloud:a,userContextId:i}}:{shouldRenderContent:!1,scenarioCorrelation:t,metadata:{allowAnonymous:!1,deepLink:fo.n0.core,homeCloud:a,userContextId:i}}}function oE(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let i,a,s,o,r=!1;const{appsRegistryService:c,commandChangeReportingService:l,coreSettings:d,homeCloud:u,normalizedDeeplink:m,rawDeeplink:g,scenarioCorrelation:h,loggerFactory:p,logger:v,client:f,scenarioFactory:b,preferredCommandInput:y,userContextId:k,sourceViewEntity:w,forceInCloudExecution:j,getExperienceAccountMode:C,waitForRenderingContextReady:_}=e,T=d.get(S.J.Core).enableOriginValidationForIncomingIntents;if(!j&&T&&!(0,bN.H)(m.toString(),d,!0))return{terminateDeeplink:!1,matchType:"originValidationForIncomingIntents",intent:void 0,reason:"Not a valid deeplink",errorCode:Kt.InvalidOrigin};try{let t;const{pathname:o}=m,j="/"===o[0]?o.substr(1):o,T=function(e){if(e.hash){const t=new URL(e.hash.substring(1),e.origin),i={pathname:t.pathname};return t.search&&(i.search=(0,yo.parse)(t.search)),i}}(m);for(const e of c.registeredApps){const{match:n,matchType:a,matchingCondition:s}=rE(e,j,m,T);if(n){t=s,i=a;break}}if(t){const i=e=>{l.report({correlationId:h.correlation.id,type:e,context:{target:"delegate-deeplink-to-app"}})};i(Ge.B.DeeplinkParseByAppStarted);const o=yield t.execute({context:{__doNotUse_globalDataClient:f,coreSettings:d,getExperienceAccountMode:C,getUserContexts:()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return function(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{getExperienceAccountMode:t,userContextId:i}=e,n=[],a=yield FN(e);if(i&&i!==a&&t()!==fN.SingleAccount){const t=yield xN(Object.assign(Object.assign({},e),{userContextId:i,userContextAccountType:_N.SourceWindow}));t&&n.push(t)}if(a){const t=yield xN(Object.assign(Object.assign({},e),{userContextId:a,userContextAccountType:_N.MainWindow}));t&&n.push(t)}return n}))}({commandChangeReportingService:l,coreSettings:d,correlation:h.correlation,getExperienceAccountMode:C,logger:v,userContextId:k,waitForRenderingContextReady:_})})),loggerFactory:p,scenarioFactory:b},deeplinkUrl:g,homeCloud:u,preferredCommandInput:y,sourceViewEntity:w,parsedDeeplinkHash:T});if(i(Ge.B.DeeplinkParseByAppSucceeded),o){const t=yield function(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:i,userContextId:n}=e;if(!(null===(t=i.get(S.J.Core))||void 0===t?void 0:t.enableDeeplinkOptionAccountToUse))return{userContextId:n};if(NN(e.homeCloud,i))return{userContextId:n};const a=yield FN(e);if(!a)return{accountToUse:void 0,userContextId:n};const{accountToUse:s,getExperienceAccountMode:o}=e;if(o()===fN.SingleAccount)return{accountToUse:fo.TS.MainWindowAccount,userContextId:a};switch(s){case fo.TS.UserChoiceFallback:return{userContextId:void 0};case fo.TS.MainWindowAccount:return{userContextId:a};case fo.TS.SourceWindowAccount:default:return{userContextId:n}}}))}(Object.assign(Object.assign({},e),{correlation:h.correlation,userContextId:k,waitForRenderingContextReady:_,accountToUse:o.metadata.accountToUse}));a=Object.assign(Object.assign({},o),{shouldRenderContent:!0,entityCommand:Object.assign(Object.assign(Object.assign({},o.entityCommand),{command:Object.assign(Object.assign({},o.entityCommand.command),{correlation:h.correlation})}),g&&{metadata:{deepLink:g.toString()}}),scenarioCorrelation:h,metadata:Object.assign(Object.assign(Object.assign({},o.metadata),{deepLink:g.toString(),homeCloud:u}),t)})}else r=!0,s=Kt.DeeplinkTerminatedByApp}else s=Kt.DeeplinkNotHandledByRegisteredApps}catch(e){s=Kt.OnBeforeDeeplinkParsedFailed,o=e.message;const i=e.reason,n=`${Jt}/${s}/${(0,se.A)(o)}/${i}`;null===(t=v.errorToTelemetry)||void 0===t||t.call(v,n,"webclient_framework_foundation_core_services_deeplink",void 0,!0)}return{matchType:i,terminateDeeplink:r,intent:a,errorCode:s,reason:o}}))}function rE(e,t,i,n){if(!e.onBeforeDeeplinkParsed)return{match:!1};for(const a of e.onBeforeDeeplinkParsed){const{filter:s}=a;if(cE(s)){if(s(i,n))return{match:!0,matchType:`${e.manifest.name}#filterFn`,matchingCondition:a}}else{const e="/"===s[0]?s.substr(1):s;if(t.startsWith(e))return{match:!0,matchType:e,matchingCondition:a}}}return{match:!1}}function cE(e){return(0,B.isFunction)(e)}function lE(e){return e===ve.lO.minimode||e===ve.lO.minimal?{type:pe.py.flyout,action:pe.uk.default}:{action:pe.uk.default,type:pe.py.default}}function dE(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,coreSettings:i,deepLink:n,isInternalDeeplink:a,logger:s,scenarioCorrelation:o,userBiService:r}=e,c=Io(n,i),l=(0,bN.P)(c,i),{matchType:d,terminateDeeplink:u,intent:m,errorCode:g,reason:h}=yield oE(Object.assign(Object.assign({},e),{normalizedDeeplink:l,rawDeeplink:c,logger:s}));return function(e,t,i,n,a){const{pathname:s,search:o}=n,r="/"===s[0]?s.substr(1):s,c=fo.Hl.find((e=>{const t="/"===e[0]?e.substr(1):e;return r.startsWith(t)}));if(!c)return;const l={};l["DataBag.joinLinkType"]=c.toString();const d=new URLSearchParams(o);l["DataBag.deeplinkId"]=d.get("deeplinkId"),l["DataBag.joinLinkVariant"]=d.get("v"),e.recordPanelAction({actionGesture:HN.uS.open,actionOutcome:HN.$K.open,actionScenario:HN.Tk.deeplink,actionScenarioType:HN.Yu.deeplink,moduleType:HN.PO.deeplink,moduleName:HN.rA.deeplinkService,panelType:i?HN.wh.Internal:HN.wh.External,dataBag:{id:"",data:Object.assign({},l),dispose:()=>{}},mainEntityType:null==a?void 0:a.entityCommand.entity.type,mainEntityAction:null==a?void 0:a.entityCommand.entity.action},t)}(r,s,a,l,m),(null==m?void 0:m.shouldRenderContent)?s.log(`Deeplink parsed to intent: { type: ${m.entityCommand.entity.type}, action: ${m.entityCommand.entity.action} }`):s.log("Returning default entity to be executed as fallback"),uE({commandChangeReportingService:t,correlationId:o.correlation.id,deeplinkType:d,mainEntityType:null==m?void 0:m.entityCommand.entity.type,mainEntityAction:null==m?void 0:m.entityCommand.entity.action,errorCode:g,reason:h}),{terminateDeeplink:u,intent:m}}))}function uE(e){const{commandChangeReportingService:t,correlationId:i,deeplinkType:n,mainEntityType:a,mainEntityAction:s,errorCode:o,reason:r,loadingWindowType:c}=e,l="deeplink-parsing";t.report({correlationId:i,type:Ge.B.DeeplinkParsed,context:{target:l,eventData:{deeplinkType:n,loadingWindowType:c,mainEntityType:a,mainEntityAction:s,errorCode:o,reason:r}}}),t.report({type:Ge.B.ScenarioEventDataAppended,correlationId:i,context:{target:l,eventData:{deeplinkType:n,loadingWindowType:c,mainEntityType:a,mainEntityAction:s,errorCode:o,reason:r}}})}const mE=e=>decodeURIComponent(e).replace(/[^A-Za-z0-9/.?&=#\+\-,_:@{}"]/g,"");class gE{constructor(e,t,i,n,a,s,o,r,c,l,d,u,m,g,h,p,v){this._client=n,this._waitForRenderingContextReady=a,this._host=s,this._appsRegistryService=o,this._config=r,this._correlation=c,this._scenarioFactory=l,this._userBiService=d,this._commandChangeReportingService=u,this._hostComms=m,this._localStorage=g,this._experienceChangeReportingService=h,this._acountModeTrackingService=p,this._activeWindowsService=v,this._logger=e.newLogger("DeepLinkService","core-services-deeplink"),this._intentService=new JN(e,this._appsRegistryService,t,i,this._client,this._waitForRenderingContextReady,this._commandChangeReportingService,this._experienceChangeReportingService,this._scenarioFactory,this._hostComms,this._host,this._activeWindowsService,this._userBiService),this._loggerFactory=e,this._coreSettings=t}init(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this._host.addEventListener("hashchange",(()=>{const e=function(e,t,i){return{clientLaunchId:Fo({location:e,clientLaunchId:i}),correlation:xo(e,t),deeplinkId:Do(e,"deeplinkId")}}(this._host.location,k.D.ExternalCommand);return this._handleUrl(!1,e)})),this._handleUrl(!0,{clientLaunchId:Fo({location:this._host.location}),correlation:Object.assign({scenarioName:z.RG.ClientStart},this._correlation),deeplinkId:Do(this._host.location,"deeplinkId")})}))}executeFromUrlAsync(e,t,i,a,s,o,r){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n;try{const c=new URL(e);n={correlation:(null==t?void 0:t.correlation)?tt(t.correlation):xo(c,k.D.InternalDeeplink),clientLaunchId:a},a&&this.sendDeeplinkReceivedSignal(n,i);const l=IN(this._coreSettings),d=function(e,t){return TN(e.host,t)}(c,this._coreSettings),u=this._coreSettings.get(S.J.Core).enableCrossCloudLaunch;if(!r&&!this._isValidDeepLinkUrlForInCloudOrCrossCloudExecution(e,d))return this.stopNavigationScenarios(n,Ge.B.Incomplete,Je.y.DeeplinkIntentParseFailure,`Current cloud: ${l}, deeplinkCloud: ${d}, enableCrossCloudLaunch: ${u}`),!1;if(!r&&u&&d&&d!==l)return yield DN(d,this._commandChangeReportingService,e,this._hostComms,n.correlation,s),!0;const{terminateDeeplink:m,intent:g}=yield this._getNavigationIntentAsync(c,!0,n,t,s,o,r);return m?(this.stopNavigationScenarios(n,Ge.B.Incomplete,Je.y.DeeplinkExecutionTerminated),!0):g?(g.options={isFromDeeplink:!0},yield this._intentService.execute(g),!0):(this.stopNavigationScenarios(n,Ge.B.Incomplete,Je.y.DeeplinkIntentParseFailure),!1)}catch(e){const t=`${Jt}${Kt.ToNavigationIntentFailed} ${(0,U.u4)(e)}`;throw n&&this.stopNavigationScenarios(n,Ge.B.Failure,Je.y.DeeplinkIntentParseFailure,t),new Error(t)}}))}checkForPendingIntent(e,t,i){const n=tt({source:e,scenarioName:z.RG.NavigationCommand});return t&&this.sendDeeplinkReceivedSignal({clientLaunchId:t,correlation:n},{type:"pendingIntent"}),this._intentService.checkForPendingIntent(n,i)}launchMainApp(e,t,i,n){const a={correlation:tt(Object.assign({scenarioName:z.RG.NavigationCommand},e)),clientLaunchId:Fo({clientLaunchId:t})};a.clientLaunchId&&this.sendDeeplinkReceivedSignal(a,{type:"default"});const s=null!=i?i:{type:pe.py.default,action:pe.uk.default};return this._intentService.launchMainApp(Ao(s),a,s,n)}launchMinimode(e,t,i){const n={correlation:tt(Object.assign({scenarioName:z.RG.NavigationCommand},e)),clientLaunchId:Fo({clientLaunchId:t})};n.clientLaunchId&&this.sendDeeplinkReceivedSignal(n,{type:"default"});const a=null!=i?i:{type:pe.py.default,action:pe.uk.default};return this._intentService.launchMinimode(Ao(a),n,a)}switchAccount(e,t,i,a,s,o){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n={correlation:tt(Object.assign({scenarioName:z.RG.NavigationCommand},e)),clientLaunchId:Fo({clientLaunchId:i})};n.clientLaunchId&&this.sendDeeplinkReceivedSignal(n,{type:"switchAccount"});const r=null!=a?a:{type:pe.py.default,action:pe.uk.default};return s&&s!==IN(this._coreSettings)?DN(s,this._commandChangeReportingService,Ao(r),this._hostComms,n.correlation,t):this._intentService.switchAccount(Ao(r),n,r,t,o)}))}prewarmFlyout(e,t=!1){const i={correlation:tt({source:e,scenarioName:z.RG.NavigationCommand}),clientLaunchId:Fo({})},n=t?"minimode":"flyout";return this.sendDeeplinkReceivedSignal(i,{type:n}),this._intentService.prewarmFlyout(i,t)}executeIntent(e){const t={correlation:tt(Object.assign(Object.assign({},e.entityCommand.command.correlation),{scenarioName:z.RG.NavigationCommand})),clientLaunchId:Fo({})};return this.sendDeeplinkReceivedSignal(t,{type:`${e.entityCommand.entity.type}/${e.entityCommand.entity.action}`}),this._intentService.execute(Object.assign(Object.assign({},e),{entityCommand:Object.assign(Object.assign({},e.entityCommand),{command:Object.assign(Object.assign({},e.entityCommand.command),{correlation:t.correlation})}),metadata:Object.assign(Object.assign({},e.metadata),{deepLink:Ao(e.entityCommand.entity)}),scenarioCorrelation:t,shouldRenderContent:!0}))}_handleUrl(e,t){var i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this._lastDesktopClientId&&this._lastDesktopClientId===t.clientLaunchId)return void(null===(a=(i=this._logger).errorToTelemetry)||void 0===a||a.call(i,"Navigation received with duplicate clientId. Terminating flow.","webclient_framework_foundation_core_services_deeplink",void 0,!0));this._lastDesktopClientId=t.clientLaunchId;const n=this._host.location;t.correlation.scenarioName&&t.clientLaunchId&&this.sendDeeplinkReceivedSignal(t);const{terminateDeeplink:s,intent:o}=yield this._getNavigationIntentAsync(n,!1,t);let r=o;return s?(yield this._notifyIntentHandled(),this.stopNavigationScenarios(t,Ge.B.Incomplete,Je.y.DeeplinkExecutionTerminated),void this._clearHashFromLocation()):(!r&&this._config.shouldExecuteDefaultCommand&&(r=sE({scenarioCorrelation:t,userContextId:void 0,deepLink:fo.n0.default,entity:lE(),layoutMode:ve.lO.standard})),r?(yield this._notifyIntentHandled(),e&&this._experienceChangeReportingService.report({correlationId:t.correlation.id,type:Mt.yU.InitialDeeplinkResolved,context:{target:"deeplink-service-handle-url",shouldRenderContent:r.shouldRenderContent}}),r.options={shouldSkipMinimodeOverride:e,isFromDeeplink:!0},this._clearHashFromLocation(),this._intentService.execute(r)):(this.stopNavigationScenarios(t,Ge.B.Failure,Je.y.DeeplinkIntentParseFailure),void this._clearHashFromLocation()))}))}_isValidDeepLinkUrlForInCloudOrCrossCloudExecution(e,t){var i,n;try{const i=this._coreSettings.get(S.J.Core).validCloudsForInternalDeeplinks||[];return(!t||i.includes(t))&&(0,bN.H)(e,this._coreSettings)}catch(e){const t=`${Jt}${Kt.InvalidDeepLinkUrl}::${null==e?void 0:e.name}`;return null===(n=(i=this._logger).errorToTelemetry)||void 0===n||n.call(i,t,"webclient_framework_foundation_core_services_deeplink",void 0,!0),!1}}_notifyIntentHandled(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield this._hostComms.loadModule("core");yield null===(e=null==t?void 0:t.intentHandled)||void 0===e?void 0:e.call(t)}catch(e){this._logger.warn("Failed to notify host that intent was handled")}}))}_clearHashFromLocation(){const{clientPreviewOptOutStrategy:e}=this._coreSettings.get(S.J.Core);if(e!==N.a5.Web)return;const t=this._host.location;if(t.hash){this._logger.log("Clearing hash from location");const e=new URL(t.href);e.hash="",this._host.history.pushState("",this._host.document.title,e)}}_getNavigationIntentAsync(e,t,i,a,s,o,r){var c,l;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{return yield nE({appsRegistryService:this._appsRegistryService,experienceBasePath:this._config.basePath,coreSettings:this._coreSettings,hostCommunicationService:this._hostComms,location:e,scenarioCorrelation:i,loggerFactory:this._loggerFactory,userBiService:this._userBiService,isInternalDeeplink:t,commandChangeReportingService:this._commandChangeReportingService,intentPersistenceService:new yN.I(this._localStorage),userContextId:s,client:this._client,preferredCommandInput:a,sourceViewEntity:o,scenarioFactory:this._scenarioFactory,forceInCloudExecution:r,getExperienceAccountMode:()=>this._acountModeTrackingService?this._acountModeTrackingService.getAccountMode():fN.SingleAccount,waitForRenderingContextReady:this._waitForRenderingContextReady})}catch(e){null===(l=(c=this._logger).errorToTelemetry)||void 0===l||l.call(c,`${Jt}${Kt.ToNavigationIntentFailed}`,"webclient_framework_foundation_core_services_deeplink",void 0,!0)}return{terminateDeeplink:!1}}))}sendDeeplinkReceivedSignal({clientLaunchId:e,correlation:t,deeplinkId:i},n){this._scenarioFactory.findScenarioByNameAndId(z.RG.NavigationCommand,e)&&(t.scenarioName=z.RG.NavigationCommand),this._commandChangeReportingService.report({type:Ge.B.NavigationCommandStart,correlationId:t.id,context:{target:"deeplink-service",clientLaunchId:e,correlation:t,eventData:Object.assign({deeplinkId:i,scenarioPhase:"Core"},n)}})}stopNavigationScenarios(e,t,i,n){this._logger.warn("Navigation intent not found");const a=this._scenarioFactory.findScenario(z.RG.ApplicationLaunchTime);null==a||a.fail({errorCode:i}),this._commandChangeReportingService.report({type:t,correlationId:e.correlation.id,context:{target:"deeplink-service-handle-url",errorInfo:i,errorMessage:n}})}}class hE extends Ue{constructor(){super(h.Yg.CreateDeeplinkService,["activeWindowsService","appsRegistryService","client","commandChangeReportingService","commandHandler","config","coreSettings","correlation","experienceChangeReportingService","hostCommunicationService","localStorage","loggerFactory","scenarioFactory","userBiService","waitForRenderingContextReady","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:i,commandChangeReportingService:n,commandHandler:a,config:s,coreSettings:o,correlation:r,experienceChangeReportingService:c,hostCommunicationService:l,localStorage:d,loggerFactory:u,scenarioFactory:m,userBiService:g,waitForRenderingContextReady:h,windowProvider:p,activeWindowsService:v}=e;e.deeplinkService=new gE(u,o,a,i,h,p,t,s,r,m,g,n,l,d,c,e.userTrackingService,v)}))}}const pE="default";class vE extends Ue{constructor(){super(h.Yg.CreateDefaultCacheStorageAndCacheManagers,["config","loggerFactory","windowProvider","coreSettings","scenarioFactory"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,config:i,loggerFactory:n,coreSettings:a,scenarioFactory:s}=e,o=new td(t.caches,pE,pE,i.experienceName);e.cacheStorage=o,e.offlineCacheManager=new id(o,n);(0,xu.Q6)(a)&&(e.workerCacheManager=Tu(i.experienceName,n.newLogger("CreateDefaultCacheStorageAndCacheManagersTask","core-services-tasks"),s))}))}}const fE="tmp";class bE{constructor(e,t,i,n,a){this.tid=e,this.oid=t,this.experienceName=i,this.windowProvider=n,this.logger=a.newLogger("LocalStorageService","services-io-browser-local-storage")}set(e,t,i="UserAndExperience"){const n=this.getFormatKey(e,i);return this.windowProvider.localStorage.setItem(n,t)}setSafe(e,t,i="UserAndExperience"){var n,a;try{return this.set(e,t,i),!0}catch(t){return null===(a=(n=this.logger).errorToTelemetry)||void 0===a||a.call(n,`Failed to set key '${e}'`,"webclient_framework_localstorage_setsafe",{errorCode:null==t?void 0:t.name},!0),!1}}get(e,t="UserAndExperience"){const i=this.getFormatKey(e,t);return this.windowProvider.localStorage.getItem(i)}remove(e,t="UserAndExperience"){const i=this.getFormatKey(e,t);return this.windowProvider.localStorage.removeItem(i)}clear(e){if(e){const t=e.map((e=>this.getFormatKey("",e)));Object.keys(this.windowProvider.localStorage).filter((e=>e.startsWith(fE)&&t.some((t=>e.startsWith(t))))).forEach((e=>this.windowProvider.localStorage.removeItem(e)))}else this.windowProvider.localStorage.clear()}calculateUsageStats(){const e={Global:{},User:{},Experience:{},UserAndExperience:{},Unmanaged:{}};return Object.keys(this.windowProvider.localStorage).forEach((t=>{const i=this.getCategoryFromKey(t);i&&(e[i][t]=(this.windowProvider.localStorage[t].length+t.length)/512)})),e}getCategoryFromKey(e){let t=this.getFormatKey("","UserAndExperience");return e.startsWith(t)?"UserAndExperience":(t=this.getFormatKey("","User"),e.startsWith(t)?"User":(t=this.getFormatKey("","Experience"),e.startsWith(t)?"Experience":(t=this.getFormatKey("","Global"),e.startsWith(t)?"Global":"Unmanaged")))}getFormatKey(e,t){switch(t){case"Experience":return`${fE}.${this.experienceName}.${e}`;case"User":return`${fE}.${this.tid}.${this.oid}.${e}`;case"Global":return`${fE}.${e}`;default:return`${fE}.${this.tid}.${this.oid}.${this.experienceName}.${e}`}}}const yE="default";class kE extends Ue{constructor(){super(h.Yg.CreateDefaultLocalStorage,["config","loggerFactory","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:i,config:n}=e,a=new bE(yE,yE,n.experienceName,t,i);e.localStorage=a}))}}class SE extends Ue{constructor(){super(h.Yg.DisableExperience,["platformService","coreSettings","loggerFactory"])}execute(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{platformService:i,coreSettings:n,loggerFactory:a}=e,s=null===(t=i.config)||void 0===t?void 0:t.browser,{supportedBrowsers:o}=n.get(S.J.Core);if(s&&o){if(!!!(null==o?void 0:o.find((e=>e===s))))throw(0,oe.Tr)(h.w5.Core,h.jK.Disabled,"DisableUnsupportedBrowsersTask",void 0,`Browser "${s}" is not supported.`)}else s||a.newLogger("DisableUnsupportedBrowsersTask","core-services-tasks").warn("Unable to detect Browser.")}))}}class wE extends Ue{constructor(){super(h.Yg.CreateDiscovery,["authenticationService","loggerFactory","coreSettings","scenarioFactory","appStateService","networkState","hostCommunicationService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{onDiscoverSuccess:t,onDiscoverFail:i}=this.getDiscoverCallback(e),{authenticationService:n,loggerFactory:a,coreSettings:s,scenarioFactory:o,appStateService:r,networkState:c,authStateProvider:l,i18n:d,hostCommunicationService:u}=e,m=(0,_l.Gg)(r);e.discover=Cl(n,a,Dr.l,s,o,m,c,u,d,l,void 0,t,i,void 0,void 0)}))}getDiscoverCallback(e){var t;let i,n;return(null===(t=e.platformService)||void 0===t?void 0:t.config.hostingParent)===Ps.GJ.Outlook&&(i=()=>{e.windowProvider.sessionStorage.removeItem(wI.v4),e.windowProvider.sessionStorage.removeItem(wI.F_)},n=t=>{t||"true"!==e.windowProvider.sessionStorage.getItem(wI.F_)||(e.windowProvider.sessionStorage.setItem(wI.v4,"true"),e.windowProvider.location.reload())}),{onDiscoverSuccess:i,onDiscoverFail:n}}}var jE;!function(e){e[e.Success=0]="Success",e[e.InvalidArguments=1]="InvalidArguments",e[e.GroupNameExists=2]="GroupNameExists"}(jE||(jE={}));class CE{constructor(e){this.isCompleted=!1,this.subscriptions=new Set,this.observedValue=e,this.observable$=new hd((e=>(this.subscriptions.add(e),()=>{this.subscriptions.has(e)&&this.subscriptions.delete(e)})))}get observable(){return this.observable$}subscribe(e,t){return this.isCompleted&&t.error("Subject: tried to subscribe to a complete observable"),this.observable$.subscribe(e)}onNext(e){this.observedValue=e,this.subscriptions.forEach((t=>{t.next(Object.assign({},e))}))}onComplete(){this.isCompleted=!0,this.subscriptions.forEach((e=>{e.closed||e.complete()}))}onError(e){this.isCompleted=!0,this.subscriptions.forEach((t=>{t.error(e)}))}get value(){return this.observedValue}}class _E{constructor(){this._endpointsHealthCache={},this._groupsHealthCache={},this.getEndpointHealth=(e,t)=>{if(e&&t){const i=this._endpointsHealthCache[this._getCacheKey(e,t)];return i?Object.assign({},i.value):void 0}},this.observeEndpointHealth=(e,t)=>e&&t?this._getHealthRecord(e,t).observable:void 0,this.observeAggregatedHealth=e=>e?this._getHealthRecord(e,void 0).observable:void 0,this.dumpState=()=>JSON.stringify(Object.assign(Object.assign({},this._endpointsHealthCache),this._groupsHealthCache),((e,t)=>t instanceof CE?t.value:t)),this.updateRemoteEndpointHealth=e=>{if(!e.serviceName)return;const t=this._getHealthRecord(e.serviceName,e.endpointName);t.value.isHealthy!==e.isHealthy&&(t.value.isHealthy=e.isHealthy,t.onNext(t.value))},this._getCacheKey=(e,t)=>`${e}_${t||""}`,this._getHealthRecord=(e,t)=>(t?this._endpointsHealthCache[this._getCacheKey(e,t)]:this._groupsHealthCache[this._getCacheKey(e,t)])||this._startTrackingHealth(e,t),this._startTrackingHealth=(e,t)=>{if(t){const i=new CE({serviceName:e,endpointName:t,isHealthy:void 0});return this._endpointsHealthCache[this._getCacheKey(e,t)]=i,i}{const i=new CE({groupName:e,isHealthy:void 0});return this._groupsHealthCache[this._getCacheKey(e,t)]=i,i}}}getAggregatedHealth(e){if(e){const t=this._groupsHealthCache[this._getCacheKey(e,void 0)];return t?Object.assign({},t.value):void 0}}dispose(){this._endpointsHealthCache={},this._groupsHealthCache={}}}class TE{constructor(e,t){this._endpointsManager=e,this._logger=t,this._subscriptions=[],this._aggregatedHealthMap=new Map,this._remoteEndpointsHealthCache=new _E,this.observeEndpointHealth=(e,t)=>this._getLocalEndpointHealth(e,t)?this._getLocalEndpointObservable(e,t):this._getRemoteEndpointHealth(e,t)?this._getRemoteEndpointObservable(e,t):this._getLocalEndpointObservable(e,t),this.getEndpointHealth=(e,t)=>this._getLocalEndpointHealth(e,t)||this._getRemoteEndpointHealth(e,t),this.observeAggregatedHealth=e=>{var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.observable},this.getAggregatedHealth=e=>this._getLocalAggregatedHealth(e)||this._getRemoteAggregatedHealth(e),this.dumpState=()=>(0,U.LQ)(`{ "aggregated endpoints health": [\n      ${this._printAggregatedHealth(this._aggregatedHealthMap)}\n    ],\n    "endpoints health": [\n      ${this._endpointsManager.health.dumpState()}\n    ]},\n    "remote endpoints health": ${this._remoteEndpointsHealthCache.dumpState()}`),this.getWorkerDumpState=()=>this._requestWorkerStateDumpCallback?(this._deferredWorkerStateDump=(0,wd.P)(),this._requestWorkerStateDumpCallback(),this._deferredWorkerStateDump.promise):Promise.reject("Worker endpoints health snapshot can't be requested"),this.getEndpointsHealthUpdateHandler=()=>({handleEndpointHealthUpdate:this._remoteEndpointsHealthCache.updateRemoteEndpointHealth,handleStateDump:this._handleWorkerStateDumpResponse,onStateDumpRequest:this._setWorkerStateDumpRequestCallback}),this._getLocalEndpointHealth=(e,t)=>this._endpointsManager.health.getEndpointHealth(e,t),this._getLocalEndpointObservable=(e,t)=>this._endpointsManager.health.observeEndpointHealth(e,t),this._getRemoteEndpointHealth=(e,t)=>this._remoteEndpointsHealthCache.getEndpointHealth(e,t),this._getRemoteEndpointObservable=(e,t)=>this._remoteEndpointsHealthCache.observeEndpointHealth(e,t),this._updateAggregatedHealth=(e,t,i)=>{const n=e.healthSubject.value,a=[];if(n.endpoints)for(const e of n.endpoints)if(e.endpointName===t.endpointName&&e.serviceName===t.serviceName)a.push(t);else{const t=this._endpointsManager.health.getEndpointHealth(e.serviceName,e.endpointName);t&&a.push(t)}try{const t=i(a);t!==n.isHealthy&&(n.isHealthy=t,e.healthSubject.onNext(n))}catch(e){this._logger.error(`Error happened in aggregated group health policy. Group: ${n.groupName}. Error: ${JSON.stringify(e.reason||e)}`)}},this._printAggregatedHealth=e=>{let t="";return e.forEach((e=>{t=`${t},${JSON.stringify(e.healthSubject.value)}`})),t?(0,U.LQ)(t):""},this._handleWorkerStateDumpResponse=e=>{this._logger.log("Received worker endpoints health state dump."),this._deferredWorkerStateDump&&(this._deferredWorkerStateDump.resolve(e),this._deferredWorkerStateDump=void 0)},this._setWorkerStateDumpRequestCallback=e=>{this._requestWorkerStateDumpCallback=e}}createAggregatedHealthGroup(e,t,i){if(!e||0===e.length||!t||0===t.length)return this._logger.error(`createAggregatedHealthGroup: Group name is empty or no endpoints are provided. groupName: ${e}; endpoints: ${t&&JSON.stringify(t)}`),jE.InvalidArguments;if(this.getAggregatedHealth(e))return this._logger.error(`createAggregatedHealthGroup: Group name already exists. groupName: ${e}`),jE.GroupNameExists;const n={healthSubject:new CE({groupName:e,endpoints:t,isHealthy:void 0})};return this._aggregatedHealthMap.set(e,n),t.forEach((t=>{var n;const a=null===(n=this.observeEndpointHealth(t.serviceName,t.endpointName))||void 0===n?void 0:n.subscribe((t=>{const n=this._aggregatedHealthMap.get(e);n||this._logger.error(`Can't update group health. Group '${e}' is not registered`),n&&this._updateAggregatedHealth(n,t,i)}));a&&this._subscriptions.push(a)})),jE.Success}dispose(){var e;this._subscriptions.map((e=>e.unsubscribe())),this._subscriptions=[],this._aggregatedHealthMap.clear(),this._remoteEndpointsHealthCache.dispose(),this._requestWorkerStateDumpCallback=void 0,null===(e=this._deferredWorkerStateDump)||void 0===e||e.reject("CombinedEndpointsHealthService is disposed"),this._deferredWorkerStateDump=void 0}_getLocalAggregatedHealth(e){var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.value}_getRemoteAggregatedHealth(e){return this._remoteEndpointsHealthCache.getAggregatedHealth(e)}}class IE{constructor(e,t){this._endpointsManager=e,this._logger=t,this._subscriptions=[],this._aggregatedHealthMap=new Map,this.observeEndpointHealth=(e,t)=>this._endpointsManager.health.observeEndpointHealth(e,t),this.getEndpointHealth=(e,t)=>this._endpointsManager.health.getEndpointHealth(e,t),this.observeAggregatedHealth=e=>{var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.observable},this.getAggregatedHealth=e=>{var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.value},this.dumpState=()=>`{ "aggregated endpoints health": [\n      ${this._printAggregatedHealth(this._aggregatedHealthMap)}\n    ],\n    "endpoints health": [\n      ${this._endpointsManager.health.dumpState()}\n    ]}`,this._updateAggregatedHealth=(e,t,i)=>{const n=e.healthSubject.value,a=[];if(n.endpoints)for(const e of n.endpoints)if(e.endpointName===t.endpointName&&e.serviceName===t.serviceName)a.push(t);else{const t=this._endpointsManager.health.getEndpointHealth(e.serviceName,e.endpointName);t&&a.push(t)}try{const t=i(a);t!==n.isHealthy&&(n.isHealthy=t,e.healthSubject.onNext(n))}catch(e){this._logger.error(`Error happened in aggregated group health policy. Group: ${n.groupName}. Error: ${JSON.stringify(e.reason||e)}`)}},this._printAggregatedHealth=e=>{let t="";return e.forEach((e=>{t=`${t},${JSON.stringify(e.healthSubject.value)}`})),t?(0,U.LQ)(t):""}}createAggregatedHealthGroup(e,t,i){if(!e||0===e.length||!t||0===t.length)return this._logger.error(`createAggregatedHealthGroup: Group name is empty or no endpoints are provided. groupName: ${e}; endpoints: ${t&&JSON.stringify(t)}`),jE.InvalidArguments;if(this.getAggregatedHealth(e))return this._logger.error(`createAggregatedHealthGroup: Group name already exists. groupName: ${e}`),jE.GroupNameExists;const n={healthSubject:new CE({groupName:e,endpoints:t,isHealthy:void 0})};return this._aggregatedHealthMap.set(e,n),t.forEach((t=>{var n;const a=null===(n=this.observeEndpointHealth(t.serviceName,t.endpointName))||void 0===n?void 0:n.subscribe((t=>{const n=this._aggregatedHealthMap.get(e);n||this._logger.error(`Can't update group health. Group '${e}' is not registered`),n&&this._updateAggregatedHealth(n,t,i)}));a&&this._subscriptions.push(a)})),jE.Success}dispose(){this._subscriptions.map((e=>e.unsubscribe())),this._subscriptions=[],this._aggregatedHealthMap.clear()}}var NE=i(412938),EE=i(994593);const FE=({url:e,method:t,body:i,headers:n,credentials:a,timeout:s,signal:o},r,c)=>{if(null==o?void 0:o.aborted)throw(0,wr.T)(Sr.A.RequestCancelled);return jr(EE(e,{method:t,headers:n&&new Headers(n),body:i,signal:o,credentials:a}),r,null!=s?s:c.defaultRequestTimeoutInMs).then((e=>{var t;const i={};return null===(t=e.headers)||void 0===t||t.forEach(((e,t)=>i[t]=e)),{status:e.status,headers:i,body:e,url:e.url}}))},xE="failed to fetch";const DE=(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const i=e.operationLogger.logStep(pr.nz.AuthDecorate);try{const n=yield t(e);return i(pr.qb[pr.qb.OK]),n}catch(e){throw i(Sr.A.AuthFailed),(0,wr.T)(Sr.A.AuthFailed,void 0,e)}})),AE=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=t.operationLogger.beginStep(pr.nz.AuthResolve,t);try{const a=i(e,t);return a.then((t=>(t&&n(pr.qb[e.status],e),t))),yield a}catch(t){throw n(pr.qb[e.status],e),(0,wr.T)(Sr.A.AuthResolveFailed,e,t)}}));function ME(e,t=pr.qb.NOT_FOUND){return Array.isArray(t)?t.some((t=>PE(e,t))):PE(e,t)}function PE(e,t){return"string"==typeof t?new RegExp(t.replace(/x/gi,"\\d")).test(e.toString()):e===t}const OE=(e,t)=>t.indexOf(e)>-1||t.filter(RE).map((e=>new RegExp(e.replace(/x/gi,"\\d")))).some((t=>t.test(e.toString())));function RE(e){return"string"==typeof e}const LE=(e,t,i,{globalContext:a})=>s=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){let n=yield UE(e)(s);for(let o=0;;o++){const{response:r,error:c}=n,l=null==r?void 0:r.status,d=l||(null==c?void 0:c.reason)||Sr.A.FailedToFetch,u=null==r?void 0:r.headers,m=i.get(d)||0;if(i.set(d,m+1),!t.shouldRetry(o,d,i,u)){if(c)throw c;return n.response}{const i=t.nextDelay(o,u,d),m=l&&pr.qb[l]||void 0;s.operationLogger.nextStep(pr.nz.RetryDelay,c||m,void 0,r),yield Cr(i,a),s.operationLogger.nextStep(pr.nz.Retry,pr.qb[pr.qb.OK],s),n=yield UE(e)(s)}}})),UE=e=>t=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{return{response:yield e(t)}}catch(e){return{response:e.serverResponse,error:e}}}));const $E=(e,t)=>{if(e){const i=t.get(e);if(!i)throw(0,wr.T)(Sr.A.InvalidCancellationToken);return i}},WE=(e,t,i,a)=>{const{cancellationMap:s}=a;let o=e;return o=function(e,t,i){return a=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var n;const{cancellationToken:s}=a,o=null!==(n=$E(s,t))&&void 0!==n?n:new AbortController;a.signal=o.signal;try{return yield e(a)}catch(e){throw(null==e?void 0:e.reason)!==Sr.A.TimedOut||void 0!==i&&!i||o.abort(),e}}))}(o,a.cancellationMap,t.abortOnTimeout),i.authResource&&(o=((e,t)=>i=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=yield DE(i,t),a=n.request,s=yield e(a),o=yield AE(s,a,n.resolver);return o?(o.operationLogger.nextStep(pr.nz.Auth,pr.qb[s.status],o,s),e(o)):s})))(o,i.authResource)),o=((e,t,i)=>a=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{baseUrl:n,baseUrlPromise:s}=t,o=a.operationLogger.logStep(pr.nz.BaseUrlResolve),r=n||s&&(yield jr(s().catch((e=>{throw o(e.reason),(0,wr.T)(Sr.A.BaseUrlFailedToResolve,void 0,e)})),i.globalContext,i.configuration.baseUrlResolutionTimeoutInMs,Sr.A.BaseUrlTimeout));try{if(r){const e=!r.endsWith("/")&&a.url.length>0?`${r}/`:r,t=a.url.startsWith("/")?a.url.substring(1):a.url;a.url=new URL(t,e).href}}catch(e){throw o(Sr.A.InvalidUrl),(0,wr.T)(Sr.A.InvalidUrl)}return o(pr.qb[pr.qb.OK]),e(a)})))(o,i,a),o=((e,t,i)=>{if(!t.redirectPolicy)return e;const{maxRedirects:a,useAbsoluteRedirect:s,headers:o,redirectOn:r,onRedirect:c}=t.redirectPolicy;return t=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=Object.assign(Object.assign({},t),{headers:Object.assign(Object.assign({},t.headers),o)});let l=yield e(n);for(let o=0;;o++){const{status:d,headers:{location:u}}=l;if(!(o<a&&ME(d,r)))return l;try{let e;if(c?e=c(u,d):u&&(e=new URL(u)),!e)return l;s?(i.baseUrl=e.origin,n.url=e.pathname):(n.url=t.url,i.baseUrl=e.href)}catch(e){throw(0,wr.T)(Sr.A.InvalidUrl,void 0,e)}n.operationLogger.nextStep(pr.nz.Redirect,pr.qb[l.status],n,l),l=yield e(n)}}))})(o,t,i),t.rejectHttpError&&(o=function(e){return t=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield e(t);if(i.status>=pr.qb.BAD_REQUEST)throw(0,wr.T)(Sr.A.RequireStatusFailed,i,[pr.qb[i.status]]);return i}))}(o)),t.allowedResponses&&(o=function(e,...t){return i=>e(i).then((e=>{if(OE(e.status,t))return e;const i=[pr.qb[e.status]];throw(0,wr.T)(Sr.A.RequireStatusFailed,e,i)}))}(o,...t.allowedResponses)),t.retryPolicy&&(o=function(e,t,i){const n=new Map;return a=>LE(e,t,n,i)(a)}(o,t.retryPolicy,a)),o=((e,t)=>i=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{cancellationToken:n}=i;n&&t.set(n,new AbortController);try{return yield e(i)}finally{n&&t.delete(n)}})))(o,s),o};function BE(e,t,i){if(!t)return;const n=i?new URL(i.url).hostname:"";return{name:t.apiName||"",dateTime:e,method:t.method,hostname:n,requestHeaders:t.headers||{},responseHeaders:(null==i?void 0:i.headers)||{},status:null==i?void 0:i.status,performance:zE(null==i?void 0:i.url),authPerformanceLogs:t.authPerformanceLogs||{}}}function zE(e){return e?new Promise((t=>{const i=new PerformanceObserver((n=>{const a=n.getEntries().find((t=>e===t.name));a&&(i.disconnect(),t(a))}));i.observe({entryTypes:["resource"]})})):Promise.reject()}class HE{constructor(e){this.subscriptions=new Set,this.observedValue=e,this.observable$=new hd((e=>(this.subscriptions.add(e),()=>{this.subscriptions.has(e)&&this.subscriptions.delete(e)})))}get observable(){return this.observable$}subscribe(e){return this.observable$.subscribe(e)}onNext(e){this.observedValue=e,this.subscriptions.forEach((t=>{t.next(e)}))}onComplete(){this.subscriptions.forEach((e=>{e.closed||e.complete()}))}onError(e){this.subscriptions.forEach((t=>{t.error(e)}))}get value(){return this.observedValue}}const qE=!0,VE=new HE(qE);const GE=()=>{const e=new Map,t=(t,i)=>e.get(QE(t,i))||((t,i)=>{const n={responseHistory:[],healthSubject:new HE({serviceName:t,endpointName:i,isHealthy:void 0})};return e.set(QE(t,i),n),n})(t,i),i=(e,i,n,a)=>{const s=t(i,e);((e,t,i)=>{e.responseHistory.push(t),e.responseHistory.length>i&&e.responseHistory.shift()})(s,n,a.historyLength);const o=a.isHealthy([...s.responseHistory]);if(s.healthSubject.value.isHealthy!==o){const t={serviceName:i,endpointName:e,isHealthy:o};s.healthSubject.onNext(t)}};return{trackHealth:(e,t,n)=>YE(e,i,t,JE(n)),observeEndpointHealth:(e,i)=>{if(!e||!i)return;return t(e,i).healthSubject.observable},getEndpointHealth:(t,i)=>KE(t,i,e),dumpState:()=>ZE(e)}},JE=e=>Object.assign(Object.assign({},XE),e),KE=(e,t,i)=>{var n;const a=null===(n=i.get(QE(e,t)))||void 0===n?void 0:n.healthSubject.value;return a&&Object.assign({},a)},QE=(e,t)=>`${e}_${t}`,YE=(e,t,i,a)=>s=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return e(s).then((e=>(t(s.apiName||"",i,e.status,a),e))).catch((e=>{throw t(s.apiName||"",i,e.reason,a),e}))})),XE={isHealthy:e=>{if(e&&e.length>0){const t=e[e.length-1];if("number"!=typeof t&&t!==Sr.A.RequestCancelled)return!1}return!0},historyLength:5};const ZE=e=>{let t="";return e.forEach((e=>{t=`${t}${JSON.stringify(e.healthSubject.value)}`})),t?null==(i=t)||0===i.length?i:` ${i}`.substr(1):"";var i},eF=e=>t=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var i,n;try{if(e.transformResponse)return yield e.transformResponse(t);if(t.status===pr.qb.NO_CONTENT)return;const a=e.responseType||function(e){if(e.headers){const t=e.headers["content-type"];if(t){if(-1!==t.indexOf("application/json"))return"json";if(-1!==t.indexOf("text/"))return"text"}if("0"===e.headers["content-length"])return"text"}return}(t)||"json";return yield t.body&&(null===(n=(i=t.body)[a])||void 0===n?void 0:n.call(i))}catch(e){throw"AbortError"===e.name?(0,wr.T)(Sr.A.RequestCancelled):(0,wr.T)(Sr.A.TransformFailed,t,e)}}));const tF=(e,t,i)=>{let a,s;return t.then((e=>{if(e.throttlePolicy){s=e.throttlePolicy;const t=null==s?void 0:s.throttleKey;t?(a=i.get(t)||[],i.has(t)||i.set(t,a)):a=[]}})),t=>s?i=>function i(o){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=function(e,t){const{maxPerThrottleInterval:i,throttleInterval:n}=t,a=Date.now()-n;let s=e.length-1;for(;s>=0&&a<e[s];)s--;e.splice(0,s);const o=e.length-i;return o>=0?e[o]-a:0}(a,s);if(!n)return function(e){return a.push(Date.now()),t(e)}(o);const r=o.operationLogger.logStep(pr.nz.Throttle);return yield Cr(n,e),r&&r(pr.qb[pr.qb.OK]),i(o)}))}(i):t};function iF(e,t){const{globalContext:i}=t,a=new Map,s=new Map,{networkMonitor:o,networkState:r}=(()=>{const e=e=>VE.onNext(e);return{networkMonitor:{processResponse:t=>{void 0!==t.status&&t.status!==pr.qb.NOT_MODIFIED&&t.status!==pr.qb.GATEWAY_TIMEOUT&&e(qE)},processResponseError:t=>{t&&(t.reason===Sr.A.RejectHttpError?e(!1):t.serverResponse&&e(qE))}},networkState:{observeIsOnline:()=>VE.observable,isOnline:()=>VE.value}}})(),c=((e,t)=>i=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=t(i).then((t=>(e.processResponse(t),t))).catch((t=>{throw e.processResponseError(t),t}));return n})))(o,function(e){return t=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var i;try{return yield e(t)}catch(e){if(e instanceof TypeError&&(null===(i=e.message)||void 0===i?void 0:i.toLowerCase())===xE){const i=t.headers&&t.headers.cache;if(i&&-1!==i.indexOf("only-if-cached"))return{status:pr.qb.GATEWAY_TIMEOUT};e=(0,wr.T)(Sr.A.RejectHttpError,void 0,e)}throw"AbortError"===e.name&&(e=(0,wr.T)(Sr.A.RequestCancelled)),e}}))}(((e,t)=>i=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return FE(i,e,t)})))(i,t.configuration))),l=GE(),{trackHealth:d}=l;return{createApi:i=>nF(i,e,Object.assign(Object.assign({},t),{cancellationMap:a,trackHealth:d,throttleMap:s}),c),createCancelToken:()=>{const e=(0,qe.v4)();return{token:e,cancel:()=>{const t=a.get(e);return t&&t.abort(),!t}}},networkState:r,health:(0,n.__rest)(l,["trackHealth"])}}const nF=(e,t,i,n)=>{const a={},s=e(t),{baseUrlPromise:o,models:r}=s;o&&o();for(const e in r){const t=r[e];a[e]=aF(e,t,s,i,n)}return a},aF=(e,t,i,a,s)=>{const{trackHealth:o,throttleMap:r,globalContext:c}=a,l=tF(c,t,r),{telemetryProvider:d}=a,{serviceName:u}=i;return(...r)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n;let m,g,h,p;const v=(new Date).toISOString(),f=performance.now();try{const e=yield jr(t.catch((e=>{throw(0,wr.T)(Sr.A.ModelFailedToInitialize,void 0,e)})),c,a.configuration.modelInitializationTimeoutInMs,Sr.A.ModelTimeOut);let d=WE(s,e,i,a);m=e.constructRequest(...r),m.operationLogger=(e=>{const t=[];let i;const n=(e,i,n)=>{const a=new Date;return(s,o,r)=>{t.push({type:e,duration:s-i,result:o,request:BE(a,n,r)})}},a=(e,t)=>{const a=performance.now();return(s,o)=>{i(a,s,o),i=n(e,a,t)}};return i=n(pr.nz.Initial,performance.now(),e),{nextStep:(e,t,i,n)=>{a(e,i)(t,n)},beginStep:a,logStep:(e,t,i)=>{const a=n(e,performance.now(),t);return e=>a(performance.now(),e,i)},complete:(e,n)=>(i(performance.now(),e,n),t)}})(m),d=o(d,i.serviceName,e.healthPolicy),d=l(d);try{p=null===(n=e.customTelemetry)||void 0===n?void 0:n.call(e,...r)}catch(e){throw(0,wr.T)(Sr.A.CustomTelemetryFailed,void 0,e)}return g=yield d(m),eF(e)(g)}catch(e){throw e.serverResponse&&(g=e.serverResponse),h=e,e}finally{const t=performance.now()-f,i=null==m?void 0:m.correlationId,n=null==g?void 0:g.status,a=n&&pr.qb[n]||void 0,s=(null==m?void 0:m.operationLogger.complete(h||a,g))||[],o=(null==h?void 0:h.reason)||a||"";d({apiName:e,serviceName:u,createdTime:v,parameters:p,duration:t,result:o,innerError:null==h?void 0:h.innerException,operationLogs:s,correlationId:i})}}))};class sF extends Ue{constructor(){super(h.Yg.CreateEndpointsManager,["coreSettings"])}execute(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:i,windowProvider:n,coreSettings:a}=e,{disableEndpointsHealthService:s,enableCombinedEndpointsHealthService:o}=a.get(S.J.Core);var r;e.endpointsManager=iF(e,{globalContext:n,telemetryProvider:(0,NE.YK)(n,a,i.newLogger("EPM","core-services-tasks"),null===(t=e.authenticationUser)||void 0===t?void 0:t.id),configuration:(r=a.get(S.J.Core),{modelInitializationTimeoutInMs:r.endpointsManagerModelInitializationTimeoutInMs||3e4,baseUrlResolutionTimeoutInMs:r.endpointsManagerBaseUrlResolutionTimeoutInMs||12e4,defaultRequestTimeoutInMs:r.endpointsManagerDefaultRequestTimeoutInMs||3e4})}),s?i.newLogger("EndpointsHealthService","core-services-tasks").log("Disabled by disableEndpointsHealthService feature flag"):(e.endpointsHealthService=o?new TE(e.endpointsManager,i.newLogger("CombinedEndpointsHealthService","core-services-tasks")):new IE(e.endpointsManager,i.newLogger("EndpointsHealthService","core-services-tasks")),(0,Hi.G)().setEndpointHealth(e.endpointsHealthService.getEndpointHealth))}))}}const oF={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CoreServicesTasksRemoveUserActiveWindowsMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeUserActiveWindows"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userContextId"},value:{kind:"Variable",name:{kind:"Name",value:"userContextId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};class rF extends Ue{constructor(){super(h.Yg.CreateEntityCommanding,[])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{activeWindowsService:t,client:i,commandHandler:a,commandDelegator:s,eventHandler:o,windowProvider:r,hostCommunicationService:c,scenarioFactory:l,loggerFactory:d,deeplinkService:u,coreSettings:m}=mg("CreateEntityCommandingTask",e,"activeWindowsService","client","commandHandler","commandDelegator","eventHandler","windowProvider","hostCommunicationService","scenarioFactory","loggerFactory","deeplinkService","coreSettings"),g=e.authenticationUser?(0,He.b4)(e.authenticationUser):void 0,{entityCommanding:h,eventing:p}=ma(a,s,o,i,m,r,l,d,u,c,g,void 0,t.getWindowLayoutService());return e.entityCommanding=h,e.eventing=p,e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){if("signout"===e)yield i.mutate({mutation:oF,variables:{userContextId:g}})}))}))}}class cF extends Ue{constructor(){super(h.Yg.CreateEventHandler,["appsRegistryService","client","clientPreferences","commandChangeReportingService","coreSettings","hostCommunicationService","loggerFactory","notificationsHandler","scenarioFactory","shortcutExecutionService","userBiService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:i,clientPreferences:n,commandChangeReportingService:a,coreSettings:s,hostCommunicationService:o,loggerFactory:r,notificationsHandler:c,scenarioFactory:l,shortcutExecutionService:d,userBiService:u}=e;e.eventHandler=(e,m,g)=>Vt({appsRegistryService:t,client:i,clientPreferences:n,commandChangeReportingService:a,commandDelegator:g,commandHandler:m,coreSettings:s,eventInput:e,loggerFactory:r,notificationsHandler:c,scenarioFactory:l,shortcutExecutionService:d,userBiService:u,hostCommunicationService:o})}))}}const lF={RejectIncomingCall:HN.Yu.toastCallingRejectIncomingCall,IgnoreIncomingCall:HN.Yu.toastCallingIgnoreIncomingCall,AcceptIncomingCallContentOnly:HN.Yu.toastCallingAcceptIncomingCallContentOnly,AcceptIncomingCallThroughPrejoin:HN.Yu.toastCallingAcceptIncomingCallThroughPrejoin,AcceptIncomingCallWithAudio:HN.Yu.toastCallingAcceptIncomingCallWithAudio,AcceptIncomingCallWithVideo:HN.Yu.toastCallingAcceptIncomingCallWithVideo,AcceptIncomingScreenshareOnlyCall:HN.Yu.toastCallingAcceptIncomingScreenshareOnlyCall,Error:HN.Yu.toastCallingError,NavigateToCallTab:HN.Yu.toastCallingNavigateToCallTab,ReplyIncomingCall:HN.Yu.toastCallingReplyIncomingCall,ResumeCallTransfer:HN.Yu.toastCallingResumeCallTransfer,TimeOut:HN.Yu.toastCallingTimeOut,Unknown:HN.Yu.toastCallingUnknown,onAcceptTelemetryCleanup:HN.Yu.toastAcceptTelemetryCleanup,onDismissTelemetryCleanup:HN.Yu.toastDismissTelemetryCleanup,canNotifyForCallingNotification:HN.Yu.toastCallingNotDroppedByDND,JoinMeetingFromToast:HN.Yu.joinMeeting,OpenChatList:HN.Yu.openChatConversationFromToast},dF={RejectIncomingCall:HN.rA.toastRejectIncomingCall,AcceptIncomingCallContentOnly:HN.rA.toastAcceptIncomingCall,AcceptIncomingCallThroughPrejoin:HN.rA.toastAcceptIncomingCall,AcceptIncomingCallWithAudio:HN.rA.toastAcceptIncomingCall,AcceptIncomingCallWithVideo:HN.rA.toastAcceptIncomingCall,AcceptIncomingScreenshareOnlyCall:HN.rA.toastAcceptIncomingCall,ReplyIncomingCall:HN.rA.toastReplyIncomingCall,ResumeCallTransfer:HN.rA.toastResumeCallTransfer},uF=(e,t,i,n)=>{if(!e)return void t.error("coreServicesEntityCommanding: UserBiService is not available.");const a={[pe.py.chats]:mF,[pe.py.channels]:gF,[pe.py.calls]:vF,[pe.py.communities]:hF,[pe.py.communitiesevents]:pF,[pe.py.communitiesjoinrequest]:hF}[i.entity.type];a&&a(e,i,n)},mF=(e,t,i)=>{const{dataOptions:n,entity:a,entityOptions:s}=t;let o;if((null==n?void 0:n.actionType)===Wi.quickReply){if(e.createDatabag&&(null==n?void 0:n.toastType)){const{toastType:t}=n;o=e.createDatabag(),o.chatToastType=t,o.isCustomNotification=Boolean(i)}e.recordPanelAction({actionGesture:HN.uS.click,actionScenario:HN.Tk.toastActivation,actionScenarioType:HN.Yu.quickReplyFromToast,moduleName:HN.rA.chatToastQuickreply,dataBag:o})}if(a.action===pe.uk.view&&e.createDatabag&&(null==n?void 0:n.toastType)){const{toastType:t}=n;o=e.createDatabag(),o.chatToastType=t,o.isCustomNotification=Boolean(i)}if(a.action===pe.uk.view&&(!(null==n?void 0:n.actionType)||o)&&(e.recordPanelAction({actionGesture:HN.uS.click,panelRegion:HN.Ai.toast,panelType:HN.wh.chatToast,actionScenario:HN.Tk.toastActivation,actionScenarioType:HN.Yu.openChatConversationFromToast,dataBag:o}),s)){const{campaignType:t}=s;if(t){e.createDatabag&&(o=e.createDatabag(),o.identifier=t);const i={panelType:HN.wh.SyntheticNotification,panelRegion:HN.Ai.toast,dataBag:o};e.recordPanelView(i)}}},gF=(e,t,i)=>{const{entity:n}=t;if(n.action!==pe.uk.view)return;let a;i&&(null==e?void 0:e.createDatabag)&&(a=e.createDatabag(),a.isCustomNotification=Boolean(i)),e.recordPanelAction({actionGesture:HN.uS.click,panelRegion:HN.Ai.toast,panelType:HN.wh.channelsToast,actionScenario:HN.Tk.toastActivation,actionScenarioType:HN.Yu.openChannelsConversationFromToast,dataBag:a})},hF=(e,t)=>{const{dataOptions:i,entity:n}=t;let a;if(i&&e.createDatabag){const{toastType:t}=i;a=e.createDatabag(),a.communitiesToastType=t}n.action===pe.uk.view&&e.recordPanelAction({actionGesture:HN.uS.click,panelRegion:HN.Ai.toast,panelType:HN.wh.communitiesToast,actionScenario:HN.Tk.toastActivation,actionScenarioType:HN.Yu.openCommunitiesConversationFromToast,teamId:null==i?void 0:i.teamId,dataBag:a})},pF=(e,t)=>{const{dataOptions:i,entity:n}=t;let a;if(i&&e.createDatabag){const{toastType:t}=i;a=e.createDatabag(),a.communitiesToastType=t}n.action===pe.uk.view&&e.recordPanelAction({actionGesture:HN.uS.click,panelRegion:HN.Ai.toast,panelType:HN.wh.communitiesEventsToast,actionScenario:HN.Tk.toastActivation,actionScenarioType:HN.Yu.openCommunitiesEventsFromToast,dataBag:a})},vF=(e,t,i)=>{var n;const{dataOptions:a}=t;if(!a)return;const{actionType:s,toastType:o}=a,r=lF[s],c=dF[s];let l;e.createDatabag&&(l=e.createDatabag(),l.correlationId=null===(n=t.command)||void 0===n?void 0:n.correlation.id,l.callingToastType=o,l.isCustomNotification=Boolean(i)),r&&e.recordPanelAction({actionGesture:HN.uS.click,panelRegion:HN.Ai.toast,panelType:HN.wh.callingToast,actionScenario:HN.Tk.toastActivation,actionScenarioType:r,moduleName:c,dataBag:l}),null==l||l.dispose()};function fF({activeWindowsService:e,coreSettings:t,renderingContext:i,isHostCommandNotification:a,handlerCommand:s,logger:o,notificationUserContextId:r,appsRegistryService:c,logPrefix:l}){var d,u;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=l||"";if(a&&s.command){const{enableDecoupleCommandingFromApollo:a,enableMinimodeWindow:l,enableMTMANotificationsMainWindow:m,enableWindowModeLayout:g}=t.get(S.J.Core),h=a?e.getActiveWindows():yield(0,Lo.Ko)(i.client),p=h.find((e=>e.layoutConfig.layoutMode===ve.lO.minimode)),v=h.find((e=>e.layoutConfig.layoutMode===ve.lO.standard));if(o.log(`${n}State transition before override: ${s.command.stateTransition}`),!l||!yF(s.entity.type)||!p&&v||r&&p&&p.userContextId!==r){const e=bF({appsRegistryService:c,coreSettings:t,entity:s.entity});if(o.log(`${n}allowUserWindowingPreference: ${e}`),v&&v.userContextId!==r)m&&(o.log(`${n}User context of notification does not match main window user`),e||s.command.stateTransition===ve.su.new?s.command.stateTransition=ve.su.new:(o.log(`${n}Entity must be opened in main window`),s.command.stateTransition=ve.su.forceFlush,s.command.targetWindow=ve.PH.main));else if(o.log(`${n}User context of notification matches main window user`),g&&e){const e=null===(d=i.clientPreferences.getPreferences("windowing"))||void 0===d?void 0:d.shouldOpenContentInNewWindow;s.command.stateTransition=e?ve.su.new:ve.su.flush,o.log(`${n}Respecting user preference for toast shouldOpenContentInNewWindow ${e}`)}}else s.command.layoutMode=ve.lO.minimode,s.command.stateTransition=ve.su.flush,o.log(`${n}Redirecting chat toasts to minimode window if no popout chat is open`);o.log(`${n}Final stateTransition after override ${null===(u=s.command)||void 0===u?void 0:u.stateTransition}`)}return s}))}const bF=({appsRegistryService:e,coreSettings:t,entity:i})=>{var n,a,s;return i.type===pe.py.chats||i.type===pe.py.channels||(null===(s=null===(n=e.getApp({entityType:i.type}))||void 0===n?void 0:(a=n.manifest).getAllowUserWindowingPreference)||void 0===s?void 0:s.call(a,{coreSettings:t,entity:i}))||!1},yF=e=>e===pe.py.chats;function kF(e,t,i,a,s,o,r){const c=e.newLogger("External Command Listener","core-services-entity-commanding"),l=SF(c,s,a,o,r);if(t.opener.addEventListener("executeEntityCommand",l),a.get(S.J.Core).enableHostCommandListener){const e=e=>{const{entity:t}=e,{type:i}=t;switch(i){case p.dt.calls:case p.dt.chats:case p.dt.toasts:case p.dt.extensions:case p.dt.channels:case p.dt.reminders:case p.dt.activity:case p.dt.campaignnotifications:case p.dt.communities:case p.dt.communitiesevents:case p.dt.callingdeeplink:case p.dt.communitiesjoinrequest:return l($m(e,c),!0);case p.dt.signout:return function(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{yield e(Object.assign(Object.assign({},Rm),{payload:{entity:{type:pe.py.default,action:pe.uk.default},command:{visibilityState:ve.fe.show,stateTransition:ve.su.flush}}})),t.log(`${sr}Executed default command`),yield e(Object.assign(Object.assign({},Rm),{payload:{entity:{type:pe.py.signoutdialog,action:pe.uk.view},command:{visibilityState:ve.fe.show,stateTransition:ve.su.extend}}})),t.log(`${sr}Executed signout modal command`)}catch(e){throw t.errorToTelemetry&&t.errorToTelemetry(`${sr}SignoutCommandFailed - ${(0,U.u4)(e)}`,"webclient_framework_host_comms",void 0,!0),e}}))}(l,c);default:return l(Rm)}};i.loadModule("core").then((t=>{var i;t&&(null===(i=t.registerForOnExecuteCommand)||void 0===i||i.call(t,e))})).catch((e=>{var t;null===(t=c.errorToTelemetry)||void 0===t||t.call(c,`Loading core host comms module failed with: ${(0,U.u4)(e)}`,"webclient_framework_host_comms",void 0,!0)}))}return Promise.resolve()}const SF=(e,t,i,a,s)=>({payload:o},r=!1)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=t=>{var i;return null===(i=e.errorToTelemetry)||void 0===i?void 0:i.call(e,t,"webclient_framework_foundation_external_command_listener",void 0,!0)};try{if(o&&o.entity&&o.command&&o.entity.type in pe.py&&o.entity.action in pe.uk&&o.command.visibilityState in ve.fe&&o.command.stateTransition in ve.su){const{entity:c,entityOptions:l,dataOptions:d,command:u,windowOptions:m}=o,{linkedEntity:g}=c;if(g){if(!g.id||!(g.type in pe.py)){const e=`Missing id ${!g.id} or linked entity type ${g.type}`;return n(e),Promise.reject(new Error(e))}}else c.linkedEntity=null;u.correlation=u.correlation||{},u.correlation.source=u.correlation.source||k.D.ExternalCommand;const h=null==d?void 0:d.userContextId;e.log(`Got userContextId: ${h} from dataOptions`);const p=t(!1,h),v=1e4;(0,H.E)(p,v).catch((()=>{n(`waitForRenderingContextReady timed out after ${v}ms`)}));const f=yield p;e.log(`got renderingContext for userContextId: ${h}`);const b={dataOptions:d,entity:c,entityOptions:l,command:st(u),windowOptions:m};return e.log(`External command isHostComm ${r}, type ${c.type}, action ${c.action}`),yield fF({activeWindowsService:a,coreSettings:i,renderingContext:f,isHostCommandNotification:r,handlerCommand:b,logger:e,notificationUserContextId:h,appsRegistryService:s}),uF(f.userBiService,e,b),f.commandHandler(b)}const c=function(e){let t=`payload(${!!e})`;if(e){const{entity:i,command:n}=e;if(t+=` entity(${!!i}) command(${!!n})`,i&&n){const{type:e,action:a}=i,{visibilityState:s,stateTransition:o}=n;t+=` type(${e}) action(${a})`,t+=` visibilityState(${s}) stateTransition(${o})`}}return t}(o),l=`Invalid payload for executeEntityCommand handler: ${c}`;return n(l),Promise.reject(new Error(l))}catch(e){n(`Error thrown from external command listener: ${(0,U.u4)(e)}`)}}));class wF extends Ue{constructor(){super(h.Yg.CreateExternalCommandListener,["activeWindowsService","appsRegistryService","windowProvider","loggerFactory","hostCommunicationService","coreSettings","waitForRenderingContextReady"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{activeWindowsService:t,appsRegistryService:i,windowProvider:n,loggerFactory:a,hostCommunicationService:s,coreSettings:o,waitForRenderingContextReady:r}=e;return kF(a,n,s,o,r,t,i)}))}}class jF{constructor(){this.countBasedLogs=this.initializeLogs(),this.countBasedTotalLogs=[],this.currentBuffer=0}addOperation(e,t,i){if(t&&e)if(this.countBasedLogs[t][e]){const n=this.countBasedLogs[t][e];"Request"===i?n.requestCount++:n.responseCount++}else this.countBasedLogs[t][e]={requestCount:"Request"===i?1:0,responseCount:"Response"===i?1:0,errorCount:"Error"===i?1:0}}getLatestDataAndClear(){const e=(0,B.clone)(this.countBasedLogs);return this.currentBuffer>=40&&(this.currentBuffer=0),this.countBasedTotalLogs[this.currentBuffer++]=e,this.countBasedLogs=this.initializeLogs(),e}getCompleteDataLogs(){return this.countBasedTotalLogs.length<40?this.countBasedTotalLogs:this.countBasedTotalLogs.slice(this.currentBuffer).concat(this.countBasedTotalLogs.slice(0,this.currentBuffer))}initializeLogs(){return{subscription:{},mutation:{},query:{}}}}class CF extends Ue{constructor(){super(h.Yg.CreateGraphQlOpsService,["coreSettings"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enableGraphQlOpsCount:t,enableGraphQlOpsCountInConsole:i}=e.coreSettings.get(S.J.Core);let n;if(t&&(n=new jF,e.graphqlOpsCountService=n),i){const e=window;e.hooks||(e.hooks={}),e.hooks.graphQlOpsCountServiceHook=n}}))}}var _F=i(670974);const TF=0;class IF{constructor(){this.stats={},this.counter=TF,this.tracked={}}getTelemetry(){const e=this.stats;return this.stats={},e}trackCall(e,t){this.getOrCreateStore(e).methodCalls[t]++}trackSubscribeEvent(e){this.getOrCreateStore(e).subscribeEvents++}markReadStart(e,t){return this.mark(NF("read",e,t))}markReadEnd(e){this.markEnd(e)}markReadError(e){this.markError(e)}markDiffStart(e,t){return this.mark(NF("diff",e,t))}markDiffEnd(e){this.markEnd(e)}markDiffError(e){this.markError(e)}markWriteStart(e,t){return this.mark(NF("write",e,t))}markWriteEnd(e){return this.markEnd(e)}markWriteError(e){this.markError(e)}markDuplicateWrite(e,t,i){const n=NF("writeDuplicate",e,t);this.update("success",n,i)}mark(e){const t=""+this.counter++;return this.tracked[t]=e,t}markEnd(e){const t=this.tracked[e];if(delete this.tracked[e],t){const e=performance.now()-t.start;return this.update("success",t,e),e}return 0}markError(e){const t=this.tracked[e];if(delete this.tracked[e],t){const e=performance.now()-t.start;this.update("error",t,e)}}update(e,t,i){const n=this.getOrCreateStore(t.storeType)[t.kind];n.count++,"error"===e&&n.errors++,n.min=Math.min(null!==n.min?n.min:Number.MAX_VALUE,i),(null==n.max||n.max<i)&&(n.max=i,n.slowestOperation=t.operationName),n.mean=null!==n.mean?(n.mean+i)/2:i}getOrCreateStore(e){let t=this.stats[e];return t||(t={type:e,read:EF(),write:EF(),diff:EF(),writeDuplicate:EF(),subscribeEvents:TF,methodCalls:{[Tp.query]:TF,[Tp.watchQuery]:TF,[Tp.mutate]:TF,[Tp.subscribe]:TF,[Tp.readQuery]:TF,[Tp.writeQuery]:TF,[Tp.readFragment]:TF,[Tp.writeFragment]:TF}},this.stats[e]=t),t}}function NF(e,t,i){return{storeType:t,kind:e,operationName:"string"==typeof i?i:(0,_F.Ok)(i)||"unknown",start:performance.now()}}function EF(){return{min:null,max:null,mean:null,count:TF,errors:TF,slowestOperation:null}}class FF extends Ue{constructor(){super(h.Yg.CreateGraphQLStoreStatsReporterService,["coreSettings","loggerFactory"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=e.loggerFactory.newLogger("CreateGraphQLStoreStatsReporterServiceTask","core-services-tasks"),{enableGraphQLStoreStatsReporterService:i}=e.coreSettings.get(S.J.Core);i&&(e.graphqlStoreStatsReporterService=new IF,t.log("GraphQLStoreStatsReporterService initialized"))}))}}var xF=i(756144);var DF=i(905493),AF=i(844729);class MF{constructor(e,t,i,n,a,s){this.aad=e,this.discover=t,this.coreSettings=i,this.loggerFactory=n,this.platformService=a,this.experienceConfig=s,this.skype=new Kl.q(this.discover)}bind(e,t){switch(t){case"chatService":return this.chatServiceBind(e);case"cmdArtifactsService":return this.cmdArtifactsServiceBind(e);case"userProfileService":return i=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return(0,xF.G)(yield Oc(this.addAdditionalHeadersToSend(e),this.aad,this.coreSettings),yield this.discover.regionGtm(t))(i)}));case"middleTier":const i=this.coreSettings.get(S.J.Auth).sendMigrationHeaderToMtInGtm,a=this.coreSettings.get(S.J.Auth).disableSkypeTokenToMtInGtm,s={[tn.kI]:"True"};return a?i=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return(0,xF.G)(yield Oc(this.addAdditionalHeadersToSend(e,s),this.aad,this.coreSettings),yield this.discover.regionGtm(t))(i)})):a=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return(0,xF.G)(yield function(e,t,i,n){return t.getUser().then((()=>{const a=Rc(n),{requireSkypetokenForMT:s}=n.get(S.J.Auth),o=t.authorize(e,a);return s?i.authorize(o,"x-skypetoken"):o}))}(this.addAdditionalHeadersToSend(e,i?s:void 0),this.aad,this.skype,this.coreSettings),yield this.discover.regionGtm(t))(a)}));case"unifiedPresence":return this.unifiedPresence||(this.unifiedPresence=this.unifiedPresenceBind(t)),this.unifiedPresence(e);case"urlp":case"urlpV2":case"ams":case"amsV2":return i=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return(0,xF.G)(this.skype.authorize(e,"Authorization"),yield this.discover.regionGtm(t))(i)}));case"mtImageService":return i=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const{mtImageServiceOverrideUrl:n}=this.coreSettings.get(S.J.Test),a=n||(yield this.discover.regionGtm(t));return(0,xF.G)(e,a)(i)}));default:return this.defaultBind(e,t)}}defaultBind(e,t){return i=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.discover.regionGtm(t);return(0,xF.G)(this.aad.authorize(e,n),n)(i)}))}unifiedPresenceBind(e){const{requireConsumerTypeHeader:t,requireSkypetoken:i}=this.coreSettings.get(S.J.Presence);return function(e,t){let i;return a=>s=>(0,n.__awaiter)(this,void 0,void 0,(function*(){for(let n=0;;++n){i||(i=yield t());const o=yield(0,xF.G)(e(a,i),i)(Object.assign(Object.assign({},s),{headers:Object.assign(Object.assign({},s.headers),{BehaviorOverride:"redirectAs404"})})),{status:r,headers:{location:c}}=o;if(r!==pr.qb.NOT_FOUND||!c||n>2)return o;i=new URL("/",c).href}}))}(((e,a)=>{const s=i?this.skype.authorize(e,"x-skypetoken"):this.aad.authorize(e,a);return t?e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return e=Object.assign(Object.assign({},e),{headers:Object.assign(Object.assign({},e.headers),{"x-ms-client-consumer-type":"teams4life"})}),s(e)})):s}),(()=>this.discover.regionGtm(e)))}chatServiceBind(e){return this.chatService||(this.chatService=(0,DF.Db)((e=>this.skype.authorize(e)),(e=>this.discover.regionGtm(e)),this.coreSettings,this.loggerFactory)),this.chatService(e)}cmdArtifactsServiceBind(e){const{cmdMeetingArtifactsServiceEndpoint:t}=this.coreSettings.get(S.J.CMDMeetingArtifactsService);return i=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return(0,xF.G)(yield function(e,t,i){return t.getUser().then((()=>{const{cmdMeetingArtifactsServiceResource:n}=i.get(S.J.CMDMeetingArtifactsService);return t.authorize(e,null!=n?n:"")}))}(e,this.aad,this.coreSettings),null!=t?t:"")(i)}))}addAdditionalHeadersToSend(e,t){if(this.coreSettings.get(S.J.Core).enableCommonMtHeadersWithSend){const i=(0,AF.h)(this.platformService,this.experienceConfig);return n=>e(Object.assign(Object.assign({},n),{headers:Object.assign(Object.assign(Object.assign(Object.assign({},i),t),{[br.f.xMsRequestId]:n.correlationId||""}),n.headers)}))}return e}}class PF extends Ue{constructor(){super(h.Yg.CreateGtmRegistry,["authenticationService","discover","coreSettings","loggerFactory","platformService","config"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){e.gtmRegistry=new MF(e.authenticationService,e.discover,e.coreSettings,e.loggerFactory,e.platformService,e.config)}))}}class OF{constructor(e,t,i,n,a){this.commandChangeReportingService=e,this.coreSettings=t,this.hostCommunicationService=i,this.scenarioFactory=n,this.logger=a.newLogger("HostCommandingListener","core-services-entity-commanding")}init(){this.initCommandChangeReportingSubscription()}destroy(){var e;null===(e=this.commandChangeReportingSubscription)||void 0===e||e.unsubscribe(),this.commandChangeReportingSubscription=void 0}initCommandChangeReportingSubscription(){this.commandChangeReportingSubscription&&this.destroy(),this.commandChangeReportingSubscription=this.commandChangeReportingService.observeChanges().subscribe((e=>{e.type===Ge.B.NotHandled&&e.context.entityCommand&&this.sendHostEvent(e.context.entityCommand)}))}sendHostEvent(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){!!this.coreSettings.get(S.J.Core).enableCommandToHostCommService&&(yield ng(e,this.hostCommunicationService,this.logger,this.scenarioFactory))}))}}class RF{constructor(){this.id=h.Yg.CreateHostCommandingListener}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,coreSettings:i,loggerFactory:n,scenarioFactory:a,hostCommunicationService:s}=mg("CreateHostCommandingListenerTask",e,"commandChangeReportingService","coreSettings","loggerFactory","scenarioFactory","hostCommunicationService");new OF(t,i,s,a,n).init()}))}}var LF;!function(e){e.airgap08="airgap08",e.prod="prod",e.life="life",e.dod="dod",e.gcch="gcch",e.gallatin="gallatin",e.airgap09="airgap09"}(LF||(LF={}));var UF=i(271449);const $F={web:{loadModule:(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return"auth"===e?(e=>({signInOnElectron:function(t){const i={options:t};return Promise.resolve(e.opener.postMessage("login",i))},acquireTokenFromHost:function(t,i,n){const a={resource:t,claim:i,userIdentifier:n};return e.opener.requestMessage("aadGetToken",a)},getUserFromHost:function(){return e.opener.requestMessage("aadCurrentUser",{})}}))(t):"calling"===e?(e=>({signalCallConnectionComplete:function(){return Promise.resolve(e.opener.postMessage("signalCallConnectionComplete",{}))}}))(t):"callingperf"===e?(e=>({callingPerfStatsAvailable:function(t){const i={callingPerfStats:t};return Promise.resolve(e.opener.postMessage("callingPerfStats",i))}}))(t):"core"===e?(e=>({registerForOnSubNavHoverChanged:function(t){const i=(e={})=>{t(e.payload)};return e.opener.addEventListener("showOrHideSubNav",i),()=>{e.opener.removeEventListener("showOrHideSubNav",i)}},setCoreInitialized:function(){return Promise.resolve(e.opener.postMessage("coreInitialized",{}))},signalPreAuthComplete:function(){return Promise.resolve(e.opener.postMessage("teamsPreAuthComplete",{}))},registerForOnContinueWithTeamsCoreTasks:function(t){const i=(e={})=>{t(e.payload)};return e.opener.addEventListener("continueWithTeamsCoreTasks",i),()=>{e.opener.removeEventListener("continueWithTeamsCoreTasks",i)}}}))(t):"embedcalendar"===e?(e=>({sendHeightOnResize:function(t){const i={embedCalendarHeight:t};return Promise.resolve(e.opener.postMessage("sendHeightOnResize",i))},sendCalendarScenarioStatus:function(t,i){const n={ScenarioStatus:t,AgendaViewEndState:i};return Promise.resolve(e.opener.postMessage("sendCalendarScenarioStatus",n))}}))(t):"embedclient"===e?(e=>({HideCoreIFrame:function(){return Promise.resolve(e.opener.postMessage("HideCoreIFrame",{}))},ShowCoreIFrame:function(){return Promise.resolve(e.opener.postMessage("ShowCoreIFrame",{}))}}))(t):"search"===e?(e=>({registerForLogActivity:function(t){const i=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",i),()=>{e.opener.removeEventListener("logActivity",i)}}}))(t):"surveyform"===e?(e=>({registerForLogActivity:function(t){const i=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",i),()=>{e.opener.removeEventListener("logActivity",i)}}}))(t):void 0})),definedModules:["auth","calling","callingperf","core","embedcalendar","embedclient","search","surveyform"]},edge:{loadModule:e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return"appdevicepermission"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Appdevicepermission})):"appswitcher"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Appswitcher})):"auth"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Auth})):"bluetoothproximity"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Bluetoothproximity})):"brb"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Brb})):"calling"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Calling})):"callingcrosscloud"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Callingcrosscloud})):"callingcrosscloudpersistent"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Callingcrosscloudpersistent})):"callingcrosscloudtransient"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Callingcrosscloudtransient})):"core"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Core})):"customvideobackground"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Customvideobackground})):"ecs"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Ecs})):"embedcalendar"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Embedcalendar})):"etw"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Etw})):"fileopenpreference"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Fileopenpreference})):"files"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Files})):"gatt"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Gatt})):"globalshortcuts"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Globalshortcuts})):"heartbeat"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Heartbeat})):"hfp"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Hfp})):"hid"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Hid})):"hostcapabilities"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Hostcapabilities})):"humanpresence"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Humanpresence})):"logscollection"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Logscollection})):"m365link"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.M365link})):"moduleloader"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Moduleloader})):"noisesuppression"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Noisesuppression})):"officeintegration"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Officeintegration})):"osutils"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Osutils})):"profiler"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Profiler})):"publicpreview"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Publicpreview})):"roomservice"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Roomservice})):"scenario"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Scenario})):"sharetarget"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Sharetarget})):"taskbar"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Taskbar})):"telemetry"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Telemetry})):"thirdpartydevices"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Thirdpartydevices})):"tmapolicy"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Tmapolicy})):"toasts"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Toasts})):"updates"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Updates})):"userdataxcloud"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Userdataxcloud})):"userpreferences"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Userpreferences})):"vdi"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Vdi})):"webclientstates"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Webclientstates})):"windowcontrols"===e?(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Windowcontrols})):void 0})),definedModules:["appdevicepermission","appswitcher","auth","bluetoothproximity","brb","calling","callingcrosscloud","callingcrosscloudpersistent","callingcrosscloudtransient","core","customvideobackground","ecs","embedcalendar","etw","fileopenpreference","files","gatt","globalshortcuts","heartbeat","hfp","hid","hostcapabilities","humanpresence","logscollection","m365link","moduleloader","noisesuppression","officeintegration","osutils","profiler","publicpreview","roomservice","scenario","sharetarget","taskbar","telemetry","thirdpartydevices","tmapolicy","toasts","updates","userdataxcloud","userpreferences","vdi","webclientstates","windowcontrols"]},electron:{loadModule:(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return"appdevicepermission"===e?(e=>({registerForHasDevicePermissions:function(t){const i=(e={})=>{t(e.eventId,e.webContentsId,e.permissionType,e.guid)};return e.opener.addEventListener("hasDevicePermissions",i),()=>{e.opener.removeEventListener("hasDevicePermissions",i)}},resolveDevicePermission:function(t,i,n){const a={message:t,permission:i,guid:n};return Promise.resolve(e.opener.postMessage("hasDevicePermissionsCallback",a))}}))(t):"auth"===e?(e=>({signInOnElectron:function(t){const i={options:t};return Promise.resolve(e.opener.postMessage("login",i))}}))(t):"callingperf"===e?(e=>({callingPerfStatsAvailable:function(t){const i={callingPerfStats:t};return Promise.resolve(e.opener.postMessage("callingPerfStats",i))}}))(t):"core"===e?(e=>({registerForOnSubNavHoverChanged:function(t){const i=(e={})=>{t(e.payload)};return e.opener.addEventListener("showOrHideSubNav",i),()=>{e.opener.removeEventListener("showOrHideSubNav",i)}},setCoreInitialized:function(){return Promise.resolve(e.opener.postMessage("coreInitialized",{}))},relaunch:function(t){const i={relaunchArgs:t};return Promise.resolve(e.opener.postMessage("windowRelaunch",i))},notifyCoreStateChanged:function(t){const i={childSettings:t};return Promise.resolve(e.opener.postMessage("updateWindowState",i))}}))(t):"embedcalendar"===e?(e=>({sendHeightOnResize:function(t){const i={embedCalendarHeight:t};return Promise.resolve(e.opener.postMessage("sendHeightOnResize",i))},sendCalendarScenarioStatus:function(t,i){const n={ScenarioStatus:t,AgendaViewEndState:i};return Promise.resolve(e.opener.postMessage("sendCalendarScenarioStatus",n))}}))(t):"hostedwebcontentlog"===e?(e=>({registerForReportAProblemLogUploadEvent:function(t){const i=(e={})=>{t(e.eventId)};return e.opener.addEventListener("reportAProblemLogUpload",i),()=>{e.opener.removeEventListener("reportAProblemLogUpload",i)}}}))(t):"m365link"===e?(e=>({getM365Link:function(t,i){const n={url:t,context:i};return e.opener.requestMessage("getM365Link",n)}}))(t):"search"===e?(e=>({registerForLogActivity:function(t){const i=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",i),()=>{e.opener.removeEventListener("logActivity",i)}}}))(t):"surveyform"===e?(e=>({registerForLogActivity:function(t){const i=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",i),()=>{e.opener.removeEventListener("logActivity",i)}},uploadDesktopLogsToOds:function(t,i){const n={logFilePath:t,sasToken:i};return Promise.resolve(e.opener.postMessage("uploadDesktopLogsToOds",n))},collectDesktopLogs:function(){return e.opener.requestMessage("collectDesktopLogs",{})}}))(t):"windowcontrols"===e?(e=>({swapMeetingRoomFrontOfRoomWindows:function(){return Promise.resolve(e.opener.postMessage("swapMeetingRoomFrontOfRoomWindows",{}))},getScreenshots:function(t,i){const n={width:t,height:i};return e.opener.requestMessage("getScreenshots",n)}}))(t):void 0})),definedModules:["appdevicepermission","auth","callingperf","core","embedcalendar","hostedwebcontentlog","m365link","search","surveyform","windowcontrols"]}};var WF;!function(e){e.Sync="Sync",e.Async="Async",e.Event="Event"}(WF||(WF={}));var BF=i(824573);class zF{constructor(){this._syncRoundTripTimeThresholdMs=16,this._asyncRoundTripTimeThresholdMs=500,(0,BF.pG)(),this._stats={syncMethodsTotal:0,asyncMethodsTotal:0,eventsTotal:0,syncOutliersByRoundTripTime:[],asyncOutliersByRoundTripTime:[]},this._pendingMatches=new Map,this._outlierCallbacks=[],this._loggerEnabled=!1,this.registerCallback()}getStats(){return this._stats}addOutlierCallback(e){this._outlierCallbacks.push(e)}setLogger(e){this._logger=e}getLogger(){return this._logger}enableLogger(){this._loggerEnabled=!0}disableLogger(){this._loggerEnabled=!1}registerCallback(){UF.HostBridge.registerForHostMessageNotification((e=>this.onMessage(e)))}onMessage(e){var t;const i=Date.now(),n=this.buildPIEMessage(e,i);n&&(this.updateTotals(n),this.calculateRoundTripTime(n),this._loggerEnabled&&(null===(t=this._logger)||void 0===t||t.log(n)))}buildPIEMessage(e,t){if(!e.messageName)return null;const[i,n]=e.messageName.split(".");let a;if(e.isEvent)a=WF.Event;else if(e.isAsync)a=WF.Async;else{if(!e.syncId)return null;a=WF.Sync}return{messageName:n,messageId:e.messageId,namespace:i,timestamp:t,type:a}}updateTotals(e){e.type===WF.Sync?this._stats.syncMethodsTotal++:e.type===WF.Async?this._stats.asyncMethodsTotal++:this._stats.eventsTotal++}calculateRoundTripTime(e){if(e.type===WF.Event||!e.messageId)return;const t=this._pendingMatches.get(e.messageId);t?(this.onMatch(e.timestamp,t),this._pendingMatches.delete(e.messageId)):this._pendingMatches.set(e.messageId,e)}onMatch(e,t){const i=e-t.timestamp;let n,a;if(t.type===WF.Async?(n=this._asyncRoundTripTimeThresholdMs,a=this._stats.asyncOutliersByRoundTripTime):(n=this._syncRoundTripTimeThresholdMs,a=this._stats.syncOutliersByRoundTripTime),i>=n){t.roundTripTime=i,a.push(t);for(const e of this._outlierCallbacks)e(t)}}}class HF{constructor(e){this._pieStatsProvider=e,this._enabled=!1}enable(){this._enabled=!0}disable(){this._enabled=!1}isEnabled(){return this._enabled}setScenarioFactory(e){this._scenarioFactory=e}}class qF{constructor(){this._count=0}log(e){const t=`json-logger-entry-${this._count.toString()}`;sessionStorage.setItem(t,JSON.stringify(e)),this._count++}getCount(){return this._count}reset(){this._count=0}setLogLocation(e){this._logLocation=e}getLogLocation(){return this._logLocation}}class VF extends HF{constructor(e){super(e),this._jsonLogger=new qF,this._pieStatsProvider.setLogger(this._jsonLogger)}enable(){super.enable(),this._pieStatsProvider.enableLogger()}disable(){super.disable(),this._pieStatsProvider.disableLogger(),this._jsonLogger.getCount()>0&&this.writeSessionStorageToJsonFile(),this._jsonLogger.reset()}writeSessionStorageToJsonFile(){const e=[];let t=[];for(const[i,n]of Object.entries(sessionStorage))i.includes("json-logger-entry-")&&(t.push(JSON.parse(n)),e.push(i));t=t.sort(((e,t)=>e.timestamp-t.timestamp));const i=document.createElement("a"),n=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(t))}`;i.setAttribute("href",n);const a=`${(new Date).toISOString()}-DataCaptureMonitorRawData.json`;i.setAttribute("download",a),this._jsonLogger.setLogLocation(a),document.body.appendChild(i),i.click(),i.remove();for(const t of e)sessionStorage.removeItem(t)}}class GF extends HF{constructor(e){super(e),this._pieStatsProvider.addOutlierCallback((e=>this.onOutlier(e)))}onOutlier(e){if(!this._enabled||!this._scenarioFactory)return;const t=this._scenarioFactory.newScenario(z.RG.TrafficCopPIEMonitor),i={messageName:e.messageName,roundTripTimeMs:e.roundTripTime,messageId:e.messageId,namespace:e.namespace,messageType:e.type.toString()};t.stop(i)}}const JF=(e,t,i=!1)=>new KF($F.edge,e,void 0,t,i,!0);class KF{constructor(e,t,i,n,a=!1,s=!1){this._internalLoadDefinition=e,this._logger=t,this._host=i,this._coreSettings=n,this._enableScenarioCache=a,this._enablePIEMonitors=s,this._hostCommsScenarioFactory=QF(this._enableScenarioCache),this._enablePIEMonitors&&(this._pieStatsProvider=new zF,this._trafficCopPIEMonitor=new GF(this._pieStatsProvider),this._dataCapturePIEMonitor=new VF(this._pieStatsProvider),this.subscribeForMonitorObservable())}loadModule(e){var t,i,a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=this._hostCommsScenarioFactory.newScenario("host_comms_load_module");let o;try{this._logger.log(`Loading module: ${e}`),o=yield this._internalLoadDefinition.loadModule(e,null!==(t=this._host)&&void 0!==t?t:void 0)}catch(t){throw null===(a=(i=this._logger).errorToTelemetry)||void 0===a||a.call(i,"Error while loading module","webclient_framework_host_comms",void 0,!0),null==n||n.fail({reason:"Error while loading module",message:e}),t}return!o&&(null===(s=this._internalLoadDefinition.definedModules)||void 0===s?void 0:s.includes(e))?(this._logger.error(`Failed to load module. Module, undefined ${e}`),null==n||n.fail({reason:"Failed to load module",message:e})):(this._logger.log(`Module "${e}" loaded`),null==n||n.stop({message:e,reason:e})),o}))}setScenarioFactory(e){var t;this._hostCommsScenarioFactory.setScenarioFactory(e),null===(t=this._trafficCopPIEMonitor)||void 0===t||t.setScenarioFactory(e)}getPIEMonitorStates(){var e,t;return{dataCaptureEnabled:this._enablePIEMonitors&&!!(null===(e=this._dataCapturePIEMonitor)||void 0===e?void 0:e.isEnabled()),trafficCopEnabled:this._enablePIEMonitors&&!!(null===(t=this._trafficCopPIEMonitor)||void 0===t?void 0:t.isEnabled())}}subscribeForMonitorObservable(){var e,t;const i=null===(t=null===(e=this._coreSettings)||void 0===e?void 0:e.getObservable)||void 0===t?void 0:t.call(e,S.J.Core,["pieMonitorSettings"]);null==i||i.subscribe((e=>{var t,i,n,a;if(!e.pieMonitorSettings)return;const{enabled:s,mode:o}=e.pieMonitorSettings;if(!s)return null===(t=this._trafficCopPIEMonitor)||void 0===t||t.disable(),void(null===(i=this._dataCapturePIEMonitor)||void 0===i||i.disable());o===N.$e.DataCapture?null===(n=this._dataCapturePIEMonitor)||void 0===n||n.enable():o===N.$e.TrafficCop&&(null===(a=this._trafficCopPIEMonitor)||void 0===a||a.enable())}))}}const QF=e=>{let t;const i=[];return{newScenario:n=>{if(t)return t.newScenario(n);if(e){const e=XF(n);return i.push(e),e}},setScenarioFactory:e=>{t=e,YF(i,t)}}},YF=(e,t)=>{let i=e.pop();for(;i;){const n=t.newScenario(i.name,{startTime:i.time});"failed"===i.status&&n.fail(Object.assign({cached:!0},i.result)),"stopped"===i.status&&n.stop(Object.assign({cached:!0},i.result)),i=e.pop()}},XF=e=>{let t,i;return{name:e,time:Date.now(),fail:e=>{i="failed",t=e},stop:e=>{i="stopped",t=e},get result(){return t},get status(){return i}}};class ZF extends Ue{constructor(){super(h.Yg.CreateHostCommunication,["coreSettings","loggerFactory","platformService","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:i,platformService:n,windowProvider:a}=e;e.hostCommunicationService=((e,t,i,n)=>{const{clientType:a}=e.config,s=n.newLogger("HostComms","core-services-host-communication");return s.log(`Create HostComms for ${a}`),a===Ps.Bh.Maglev&&t.get(S.J.Core).enablePieCommunication?JF(s,t,!0):a===Ps.Bh.Desktop?new KF($F.electron,s,i,t,!0):new KF($F.web,s,i,t,!0)})(n,t,a,i)}))}}var ex=i(831649);class tx extends Ue{constructor(){super(h.Yg.CreateI18n,["i18NextWrapper"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=new ex.o(e.i18NextWrapper);e.i18n=t;const i=e.localMigratedSettings;if(i){const n=ix(e.i18NextWrapper.logger,e.i18NextWrapper.migratedLocaleCode,t.locale);i.registerConsumer("i18n",n)}}))}}const ix=(e,t,i)=>({language:a})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(a!==t)throw e.error(`Migrated locale (${a}) was not available for the i18NextWrapper (${t})`),new Error("Language mismatch during locale migration");a!==i&&e.log(`Migrated locale (${a}) was not applied to the i18n instance. Detected language: (${i})`)}));var nx=i(501756),ax=i(425435);class sx{constructor(e,t){this.options={},this.setOptions(t),this.logger=e("i18n:selective-icu","services-io-browser-i18n"),this.name="selective-icu",this.type="postProcessor",this.icu=new ax.Z}setOptions(e){this.options=Object.assign(Object.assign({},this.options),e)}process(e,t,i,n){const a=Array.isArray(t)?t[t.length-1]:t;if(!this.options.filterRegex||!this.options.filterRegex.test(a))return e;try{return this.icu.parse(e,i,n.language,i.ns,a,!1)}catch(a){return this.logger.error(`ICU parse failed for namespace: "${i.ns||""}" key: "${t.toString()}" locale: "${n.language||""}"`),e}}}class ox{constructor(){this.name="simple-pseudo",this.type="postProcessor"}process(e){return`([{${e}}])`}}var rx=i(503847);class cx{constructor(e,t,i){this.i18nextWrapper=e,this.coreSettings=i,this.entries={},this.logger=t("NamespaceLoader","services-io-browser-i18n");const n=i.getObservable(S.J.Localization);null==n||n.subscribe((e=>{e.enableExpStrings&&this.getOverriddenNamespaces().forEach((e=>this.patchBundleOverrides(e)))}))}getState(e){const t=this.entries[e];return t?t.state:rx.i.Missing}waitForNamespace(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=this.getState(e);if(t===rx.i.Loaded)return;if(t===rx.i.Failed)throw new Error(`Loading of namespace ${e} has previously failed`);const i=t===rx.i.Missing?this.load(e):this.entries[e];return i&&i.promise?i.promise:void 0}))}loadStatic(e){this.addResourceBundle(e.namespace,e.translations),this.entries[e.namespace]={state:rx.i.Loaded,error:void 0,promise:void 0}}load(e,t){const i="en-us",n=t?i:this.i18nextWrapper.locale,a=`${n}/${(0,B.kebabCase)(e)}`,s=`./generated/resources/${a}`,o={state:rx.i.Loading,error:void 0,promise:void 0};this.entries[e]=o,this.i18nextWrapper.logger.log("importing",s);const r=this.getNamespaceEntry(n,e).then((t=>{this.addResourceBundle(e,t.default.translations),this.i18nextWrapper.logger.log("imported",s),o.state=rx.i.Loaded,o.promise=void 0})).catch((r=>t||n===i?(this.failI18nLoad({error:r.message,origin:a}),this.i18nextWrapper.logger.error("failed to import",s,r),o.state=rx.i.Failed,o.error=r.message,o.promise=void 0,Promise.reject(r)):(this.i18nextWrapper.logger.log("trying fallback to the default locale as failed to import",s,r),this.failI18nLoad({fallbackLocale:i,error:r.message,origin:a}),this.load(e,!0).promise)));return o.promise=r,o}addResourceBundle(e,t){return this.i18nextWrapper.i18next.addResourceBundle(this.i18nextWrapper.locale,e,Object.assign(Object.assign({},t),this.getOverrides(e)))}patchBundleOverrides(e){if(this.entries[e]){const t=this.getOverrides(e);(this.entries[e].promise||Promise.resolve()).then((()=>{this.i18nextWrapper.i18next.addResourceBundle(this.i18nextWrapper.locale,e,t,!0,!0)}))}}getOverriddenNamespaces(){const e=this.coreSettings.get(S.J.Localization);let t=[];return Object.keys(e).forEach((i=>{var n,a;(null===(n=e[i])||void 0===n?void 0:n.expStrOverrides)&&(t=[...t,...Object.keys((null===(a=e[i])||void 0===a?void 0:a.expStrOverrides)||{})])})),[...new Set(t)]}getOverrides(e){const{enableExpStrings:t}=this.coreSettings.get(S.J.Localization);if(!t)return{};const i=this.i18nextWrapper.locale.toLowerCase(),n=this.coreSettings.get(S.J.Localization),a=Object.keys(n).map((t=>{var i,a;return null===(a=null===(i=n[t])||void 0===i?void 0:i.expStrOverrides)||void 0===a?void 0:a[e]})).filter((e=>!!e)).map((e=>e.reduce(((e,t)=>{const n=Object.keys(t.locales).find((e=>e.toLowerCase()===i)),a=t.key,s=n&&t.locales[n];return a&&s&&(e[a]=s),e}),{}))).reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{});return a}getNamespaceEntry(e,t){return(0,Rl.mT)((()=>i(122057)(`./${e}/${(0,B.kebabCase)(t)}.js`)),`${(0,B.kebabCase)(t)}-locale-${e}`)}failI18nLoad(e){var t,i;null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,"Failed to import locale","namespace_loader",e)}}var lx=i(985937),dx=i(617371),ux=i(899517);function mx(e){return e.navigator.language||h.ZW}function gx(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield e.loadModule("osutils"),n=yield null===(t=null==i?void 0:i.getAppLocale)||void 0===t?void 0:t.call(i);return null==n?void 0:n.localeName}))}function hx(e,t,i){const n=px(e,t,i);return(0,ux.vw)(n).locale}function px(e,t,i,n,a){var s;const o=function({localeCode:e,language:t,setting:i}){if(e)return e;if(t)return t.toLowerCase();if(!i)return;let n;if(Array.isArray(i)){for(const e of i)if(e.startsWith("localeCode:")){n=e;break}}else i.startsWith("localeCode:")&&(n=i);if(n)return n.split(":")[1];return}(t.state.getSearchState()||{});if(o)return o;if(n&&(null===(s=null==e?void 0:e.navigator)||void 0===s?void 0:s.language))return e.navigator.language;const r=e.getHostedWindowContext(),c="localeCode";if(r&&r.localeCode)return e.localStorage.setItem(c,r.localeCode),r.localeCode;{const t=e.localStorage.getItem(c);return!t&&a&&e.localStorage.setItem(c,a),t||a||i||h.ZW}}const vx=()=>{};class fx{get locale(){return this._locale}get osLocaleInfo(){return this._osLocaleInfo}constructor(e,t,i,n,a,s,o,r,c,l,d,u,m){this.preloadNamespaces=e,this.coreSettings=n,this.originLocale=s,this.staticNamespaces=o,this.userLanguage=c,this.osLocale=l,this.migratedLocaleCode=d,this.notLoadedNamespacesWithErrors=[];const g=t("i18n","services-io-browser-i18n"),h="pseudo"===s||"pseudo_rtl"===s;let p=(0,dx.Ax)(s,a,r);const v=S.J.Core&&this.coreSettings.get(S.J.Core);v&&v.useEnglishOnlyUI&&(p="en-us");const f=this.initPlugins(t,h,p,g);this.namespaceLoader=((e,t,i)=>new cx(e,t,i))(this,t,n),this.i18next=f,this.latestTranslation={},this.originLocale=s,this.logger=g,this.scenarioFactory=a,this.osPlatform=i.config.osPlatform,this.initOsDateTimeLocalization(n,a,g,m,u),this.initI18next(p,a,g),this._locale=p,this.loadLocales()}setOSLocaleInfo(e){this._osLocaleInfo=e}setLocale(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=S.J.Core&&this.coreSettings.get(S.J.Core);t&&t.useEnglishOnlyUI&&(e="en-us");const i=(0,dx.um)(this.scenarioFactory,e);this.i18next.changeLanguage(i),this._locale=i,yield this.loadLocales()}))}setPreloadedNamespaces(e){this.preloadNamespaces&&this.preloadNamespaces.length>0||(this.preloadNamespaces=e,this.logger.log("Setting preloaded namespaces ",this.preloadNamespaces),this.loadLocales())}initPlugins(e,t,i,n){const a=[new sx(e,{filterRegex:/.*\_mf$/})];if(t){const e=new ox;a.push(e),i="en-us"}dx.cL.locale=i;let s=nx.Z.createInstance();for(const e of a)s=s.use(e);const o=this.getInitOptions(i,a);return s.init(o).catch((e=>n.error("The i18next initialization failed",e))),s}removeDefaultI18nNamespaces(e){var t;("string"==typeof this.i18next.options.ns?[this.i18next.options.ns]:null!==(t=this.i18next.options.ns)&&void 0!==t?t:[]).forEach((t=>this.i18next.removeResourceBundle(e,t))),this.i18next.setDefaultNamespace("")}setMissingHandlers(e,t){this.i18next.options.saveMissing=!0,this.i18next.options.missingKeyHandler=(i,n,a)=>{this.missingKeyHandler(e,t,this.i18next,i,n,a)},this.i18next.options.missingInterpolationHandler=i=>this.missingInterpolationHandler(e,t,this.latestTranslation)}initI18next(e,t,i){this.removeDefaultI18nNamespaces(e),this.setMissingHandlers(t,i)}initOsDateTimeLocalization(e,t,i,a,s){if(s)return void this.setOSLocaleInfo(s);const o=S.J.Host&&e.get(S.J.Host);o&&o.enableOsDateTimeFormatting&&function(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield null==e?void 0:e.loadModule("osutils");return yield null===(t=null==i?void 0:i.getLocaleInfo)||void 0===t?void 0:t.call(i)}))}(a).then((e=>{if(null==e?void 0:e.regionalFormat){const t="_",i="-";e.regionalFormat=e.regionalFormat.split(t).join(i).toLowerCase()}this.setOSLocaleInfo(e)})).catch((e=>{var n;null===(n=i.errorToTelemetry)||void 0===n||n.call(i,`getLocaleInfoAsync failed for ${JSON.stringify(e)}`,"telemetry_i18next_wrapper");t.newScenario(z.RG.I18nGetLocaleInfo).fail({errors:JSON.stringify(["getLocaleInfoAsync failed"])})}))}loadLocales(){const e=[];this.staticNamespaces&&this.namespaceLoader.loadStatic(this.staticNamespaces);for(const t of this.preloadNamespaces){const i=this.namespaceLoader.load(t);i.promise&&e.push(i.promise.catch(vx))}return Promise.all(e)}missingKeyHandler(e,t,i,n,a,s){const o="string"==typeof i.options.ns?[i.options.ns]:i.options.ns||[""],r=o.indexOf(a)<0;let c="",l="";if(r&&(e=>this.notLoadedNamespacesWithErrors.indexOf(e)>=0)(a))return;r?(c=`The namespace "${a}" has not been loaded. The only loaded namespaces: "${o.join(", ")}"`,l=s,this.notLoadedNamespacesWithErrors.push(a)):c=`The key "${s}" doesn't exist in namespace "${a}" for locale "${n[0]}"`;e.newScenario(z.RG.I18nMissingKeyHandler).stop({message:c,origin:l}),t.error(c)}missingInterpolationHandler(e,t,i){var n;const a=`Undefined interpolation for namespace "${i.namespace}" and key "${i.key}"`;e.newScenario(z.RG.I18nMissingInterpolationHandler).stop({message:a}),null===(n=t.errorToTelemetry)||void 0===n||n.call(t,a,"telemetry_i18next_wrapper")}getInitOptions(e,t){return{initImmediate:!1,interpolation:{escapeValue:!1},react:{bindI18n:"languageChanged",bindI18nStore:"",nsMode:"default",transKeepBasicHtmlNodesFor:["br","strong","i","b","u","p"]},lng:e,fallbackLng:e,load:"currentOnly",lowerCaseLng:!0,postProcess:t.filter((e=>"postProcessor"===e.type)).map((e=>e.name))}}}class bx extends Ue{constructor(){super(h.Yg.CreateI18NextWrapper,["config","coreSettings","coreSettingsContext","hostCommunicationService","loggerFactory","platformService","routingServices","scenarioFactory","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=function(e,t,i,n,a,s,o,r){const{windowProvider:c,routingServices:l,hostCommunicationService:d}=s,u=(0,lx.pf)(c),{language:m}=n.get(S.J.LocalMigrated)||{},g=m||void 0,h=S.J.Core&&n.get(S.J.Core),p=h&&h.includeBrowserInLocaleDetermination,v=px(c,l,u.localeCode,!!p,g),f=mx(c),b=d?gx(d):Promise.resolve(void 0);return new fx(e,t,i,n,a,v,o,r,f,b,g,void 0,d)}(e.config.preloadedI18nNamespaces||[],e.loggerFactory.newLogger,e.platformService,e.coreSettings,e.scenarioFactory,{windowProvider:e.windowProvider,routingServices:e.routingServices,hostCommunicationService:e.hostCommunicationService},e.config.staticNamespaces,e.config.locale);e.coreSettingsContext.setLocale(t.locale),e.coreSettingsContext.updatePlatformProviderSettings({localeCode:t.locale}),e.i18NextWrapper=t}))}}class yx{constructor(e){this.cache=new Map,this.lastId=0,this.maxCacheSize=e.maxCacheSize,this.cachePruningPercent=e.cachePruningPercent}add(e,t){if(this.maxCacheSize<=0)return;let i=this.cache.get(e);if(i)return void(i.time=this.lastId++);const n=new Image;n.src=t,i={image:n,time:this.lastId++},this.cache.set(e,i),this.cache.size>this.maxCacheSize&&this.prune()}setCapacity(e){this.maxCacheSize=e.maxCacheSize,this.cachePruningPercent=e.cachePruningPercent,this.cache.size>this.maxCacheSize&&this.prune()}clear(){this.cache.clear(),this.lastId=0}has(e){return this.cache.has(e)}getUrl(e){if(this.has(e)){const t=this.cache.get(e);return null==t?void 0:t.image.src}}get size(){return this.cache.size}prune(){const e=[];this.cache.forEach(((t,i)=>{e.push({time:t.time,url:i})})),e.sort(((e,t)=>e.time-t.time));let t=Math.ceil(this.maxCacheSize*this.cachePruningPercent);t=Math.max(this.cache.size-this.maxCacheSize,t);for(let i=0;i<t;i++){const t=e[i];this.cache.delete(t.url)}}}class kx extends Ue{constructor(){super(h.Yg.CreateImageCaches,["coreSettings"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t}=e,i=new yx({maxCacheSize:0,cachePruningPercent:.15});e.avatarImageCache=i;const n=null==t?void 0:t.getObservable(S.J.ImageCache),a=null==n?void 0:n.subscribe((e=>{let t=0;"number"==typeof(null==e?void 0:e.avatarImageCacheMaxCapacity)&&(t=e.avatarImageCacheMaxCapacity),i.setCapacity({maxCacheSize:t,cachePruningPercent:.15})}));return()=>a.unsubscribe()}))}}class Sx extends Ue{constructor(){super(h.Yg.CreateInactiveGC,["clientState","coreSettings","profilerService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{clientState:t,coreSettings:i,profilerService:a}=e;t.observe().subscribe((e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){if(e===$e.pk.Inactive||e===$e.pk.LongInactive){const{clearConsoleInInactive:e,enableGCInInactive:t}=i.get(S.J.Core);e&&(console.clear(),console.log('Console cleared on going to Inactive/LongInactive. When debugging, you can override this with disabling "clearConsoleInInactive" FF')),t&&a.requestTriggerGC()}}))))}))}}class wx extends Ue{constructor(){super(h.Yg.LeakDetector,["loggerFactory","coreSettings","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t,windowProvider:i,coreSettings:n}=e,a=t.newLogger("CreateLeakDetectorTask","core-services-tasks"),{enableObjectLeakDetection:s}=n.get(S.J.Core);if(a.log(`enableObjectLeakDetection ${s}`),!s)return;if(!i.WeakRef)return void a.log("windowProvider?.WeakRef is undefined");const o=new vs.E(n,i);e.leakDetectorService=o,a.log("leakDetectorService instantiated"),i.opener.addEventListener(L.rY.GetLeaks,(()=>this.sendLeaksStats(i,o,a)));const{testAutomation:r}=n.get(S.J.Test);this.initTestingMode(i,o,n.get(S.J.Host),!!r)}))}sendLeaksStats(e,t,i){let n=0;const a=e.parent;a.getAndClearAriTelemetry=void 0,a.getLeakDetectorService=void 0,a.gc?(i.log("executing gc() on experience renderer"),a.gc(),n=1e4):i.warn("gc() not defined on experience renderer");let s=0;s=e.setTimeout((()=>{e.clearTimeout(s);const i={leaks:t.getReachableObjectCountsByKey(),leaksTrackingInfo:t.getReachableObjectsTrackingInfo()};e.opener.postMessage(L.rY.GetLeaks,i)}),n)}initTestingMode(e,t,i,n){const{userType:a}=i;(a&&a.indexOf("test")>-1&&!("getLeakDetectorService"in e.parent)||n)&&(e.parent.getLeakDetectorService=()=>t)}}var jx,Cx,_x,Tx,Ix,Nx,Ex;function Fx(e){if(e.has(Mt.c4.ExperienceWarm))return;const t=Dx(e,Mt.yU.NavigationIntentExecuted);let i=!1;t&&(i=!t.shouldRenderContent||function(e){var t;const i=Dx(e,Mt.FV.LayoutRenderComplete),n=[xe.pyR.pearnotdefaultapp,xe.pyR.error];return null!==(t=(null==i?void 0:i.mainEntityType)&&!n.includes(i.mainEntityType))&&void 0!==t&&t}(e));const n=Array.from(e.values()).pop();return i&&(null==n?void 0:n.context)}function xx(e,t){if(e.has(Mt.c4.UserWarm))return;let i=!1;if(Ax(e))if(t)if(function(e){const t=Dx(e,Mt.FV.LayoutRenderCancelled);return!!t}(e)||Mx(e))i=!0;else{const t=Dx(e,Mt.yU.NavigationIntentExecuted);t&&!t.shouldRenderContent&&(i=!0)}else i=!0;const n=Array.from(e.values()).pop();return i&&(null==n?void 0:n.context)}function Dx(e,t){const i=e.get(t);return i&&i.context}function Ax(e){return e.has(Mt.yU.UserAuthenticated)&&e.has(Mt.yU.UserConsentedToConsumeResources)}function Mx(e){const t=Dx(e,Mt.FV.LayoutRenderComplete);if(t){const{mainEntityType:e}=t,i=[xe.pyR.identity,xe.pyR.tflfre,xe.pyR.pearnotdefaultapp,xe.pyR.error];if(!e||-1===i.indexOf(e))return!0}return!1}function Px(e,t){let i=[];const n=e[t.state];return n&&(i=i.concat(n({context:t.context}))),i}function Ox(e,t,i){let n;if(e){const{app:a,state:s,callback:o}=e;let r=o();if(r){const e=r.length;if(e>0){t.log(`App:${a.manifest.id} supports the state: ${s}, job count returned from the app: ${e}.`),r=r.filter((e=>function(e,t,i){if(i===Tx.start)return!1;const n=t&&t[i];if(Array.isArray(n))return n.indexOf(e)>-1;if([Tx.onPreWarm,Tx.onExperienceWarm,Tx.onUserWindowPreWarm].includes(i))return!1;return!0}(e.id,i,s)));const n=r.length;n!==e&&t.log(`Jobs filtering by permissions took place. Job count is now: ${n}`)}n={state:s,jobs:r}}}return n}function Rx({app:e,currentChanges:t,change:i,getCachedSupportSet:a,sessionContext:s}){const o=function(e,t){if(t.has(Mt.c4.Initialized)||e.type===Mt.yU.ExperienceIdleStateChanged)return;const i=Dx(t,Mt.yU.ActiveEntitiesResolved);return Ax(t)&&i?i:void 0}(i,t);if(o)return{app:e,state:Tx.onPreInit,callback:()=>function(e,t,i){let a;const s=i(),{entities:o,target:r}=t,c=(0,n.__rest)(t,["entities","target"]);for(const t of o)if(t&&s&&s.has(t.type)){a=a||[];const i=Px(e,{context:Object.assign(Object.assign({},c),{entity:t}),state:Tx.onPreInit});a=a.concat(i)}return a}(e,Object.assign(Object.assign({},s),o),a)}}function Lx({app:e,currentChanges:t,sessionContext:i}){const n=Fx(t);if(n){const t=Tx.onExperienceWarm;return{app:e,state:t,callback:()=>Px(e,{context:Object.assign(Object.assign({},i),n),state:t})}}}function Ux({app:e,currentChanges:t,sessionContext:i,change:n}){if(n.context.isIdle&&Ax(t)){const t=Tx.onExperienceIdle;return{app:e,state:t,callback:()=>Px(e,{context:Object.assign({},i),state:t})}}}function $x({app:e,currentChanges:t,sessionContext:i}){const n=function(e){if(e.has(Mt.c4.WindowWarm))return;let t=!1;Mx(e)&&(t=!0);const i=Array.from(e.values()).pop();return t&&(null==i?void 0:i.context)}(t);if(n){const t=Tx.onUserWindowPreWarm;return{app:e,state:t,callback:()=>Px(e,{context:Object.assign(Object.assign({},i),n),state:t})}}}function Wx(e){switch(e){case Ix.Experience:return[Lx];case Nx.Window:return[$x];default:return[Rx,(t=e===Ex.FirstUserAtBoot,({app:e,currentChanges:i,sessionContext:n})=>{const a=xx(i,t);if(a){const t=Tx.onPreWarm;return{app:e,state:t,callback:()=>Px(e,{context:Object.assign(Object.assign({},n),a),state:t})}}}),Ux]}var t}function Bx(e){const t=e.manifest.supportedEntities,i=new Set;return t&&t.reduce(((e,t)=>e.add(t)),i),i}function zx({appId:e,jobState:t,change:i,currentChanges:n,logger:a}){let s;if(t){const{jobs:o,state:r}=t,c=function(e,t){let i;switch(e){case Tx.start:i=Mt.c4.Started;break;case Tx.onPreInit:i=Mt.c4.Initialized;break;case Tx.onExperienceWarm:i=Mt.c4.ExperienceWarm;break;case Tx.onPreWarm:i=Mt.c4.UserWarm;break;case Tx.onExperienceIdle:i=Mt.c4.ExperienceIdle;break;case Tx.onUserWindowPreWarm:i=Mt.c4.WindowWarm}return function(e,{correlationId:t,windowId:i,context:{target:n}}){return{type:e,context:{target:n},correlationId:t,windowId:i}}(i,t)}(r,i);n.set(c.type,c),a.debug(`Life Cycle - Change type: ${i.type}, initiated by: ${i.context.target}. Resulted in app:${e} transition to state: ${r} and job count: ${o.length}`),s={change:c,jobs:o}}return s}function Hx({application:e,appLifeCyclePermissions:t,change:i,currentChanges:n,getNextState:a,getCachedSupportSet:s,logger:o,sessionContext:r}){const c=Ox(a({currentChanges:n,app:e,change:i,getCachedSupportSet:s,sessionContext:r}),o,t);return zx({appId:e.manifest.id,jobState:c,change:i,currentChanges:n,logger:o})}!function(e){e.incomplete="incomplete",e.success="success",e.failure="failure"}(jx||(jx={})),function(e){e.LifeCycleReport="life_cycle_report"}(Cx||(Cx={})),function(e){e.ExperienceLifeCycleManager="experience_life_cycle_manager",e.UserLifeCycleManager="user_life_cycle_manager"}(_x||(_x={})),function(e){e.start="start",e.onPreInit="onPreInit",e.onExperienceWarm="onExperienceWarm",e.onPreWarm="onPreWarm",e.onExperienceIdle="onExperienceIdle",e.onUserWindowPreWarm="onUserWindowPreWarm"}(Tx||(Tx={})),function(e){e.Experience="Experience"}(Ix||(Ix={})),function(e){e.Window="Window"}(Nx||(Nx={})),function(e){e.FirstUserAtBoot="FirstUserAtBoot",e.Other="Other"}(Ex||(Ex={}));class qx{constructor(e,t,i){this._scope=e,this._appLifeCyclePermissions=t,this._sessionContext=i,this._currentChanges=new Map,this._logger=i.loggerFactory.newLogger("ApplicationLifeCycleManager","core-services-life-cycle")}get managedId(){var e;return null===(e=this._application)||void 0===e?void 0:e.manifest.id}manageApplication(e){this._application=e}onChange(e){const t=[];if(!this._application)return t;this._currentChanges.set(e.type,e);const i=Wx(this._scope);for(const n of i){const i=Hx({application:this._application,appLifeCyclePermissions:this._appLifeCyclePermissions,change:e,currentChanges:this._currentChanges,getNextState:n,getCachedSupportSet:()=>this.supportedSets,logger:this._logger,sessionContext:this._sessionContext});i&&t.push(i)}return t}get supportedSets(){return this._supportedEntitySet=this._supportedEntitySet||this._application&&Bx(this._application),this._supportedEntitySet}}class Vx{constructor(e,t){this._application=e,this._appLifeCyclePermissions=t,this._changeSets={experience:new Map,users:{},windows:{}}}get managedId(){return this._application.manifest.id}onChange(e,t,i){const n=[],a=i.loggerFactory.newLogger("ApplicationLifeCycleManagerV2","core-services-life-cycle"),s=`[${t}:${e.type}]`;a.debug(`${s} received change`);const o=Wx(t);let r;switch(t){case Ix.Experience:r=this._changeSets.experience;break;case Nx.Window:r=this.getChangeSetFromGroup(this._changeSets.windows,e.windowId);break;default:r=this.getChangeSetFromGroup(this._changeSets.users,e.userContextId)}if(!r)return a.warn(`${s} missing ${t===Nx.Window?"window":"user context"} id.`),n;r.set(e.type,e);for(const t of o){const s=Hx({application:this._application,appLifeCyclePermissions:this._appLifeCyclePermissions,change:e,currentChanges:r,getNextState:t,getCachedSupportSet:()=>this.supportedSets,logger:a,sessionContext:i});s&&n.push(s)}return n}removeUser(e,t){this._changeSets.users[e]&&(t.debug(`Removing user: ${e} from change set`),delete this._changeSets.users[e])}removeWindow(e,t){this._changeSets.windows[e]&&(t.debug(`Removing window: ${e} from change set`),delete this._changeSets.windows[e])}getChangeSetFromGroup(e,t){if(t)return e[t]||(e[t]=new Map),e[t]}get supportedSets(){return this._supportedEntitySet=this._supportedEntitySet||this._application&&Bx(this._application),this._supportedEntitySet}}class Gx{constructor(e,t){this._scheduler=e,this._logger=t.newLogger("SchedulerWithValidator","core-services-scheduling"),this._uniqueJobIds=new Set}validateAndSchedule(e,t,i){const{id:n,runOncePerId:a}=t;if(this._uniqueJobIds.has(n)){if(a)return this._logger.debug(`Job by ID ${n} has already run once.`),Z.o_}else this._uniqueJobIds.add(n);return this._scheduler.schedule(e,t,i)}}class Jx{constructor({context:e,scheduler:t,experienceChangeReportingService:i,loggerFactory:n,lifeCycleChangeReportingService:a,lifeCycleJobPermissions:s}){this.managers=new Map,this.applications=[],this.contexts={experience:{cleanupJobs:[],session:e,scope:Ix.Experience},users:new Map,windows:new Map},this.experienceChangeReportingService=i,this.lifeCycleChangeReportingService=a,this.lifeCycleJobPermissions=s||{},this.logger=n.newLogger("ExperienceLifeCycleManagerV2","core-services-life-cycle-manager"),this.scheduler=t,this.schedulerWithValidator=new Gx(t,n)}init(){const e=this.experienceChangeReportingService.observeChanges();this.subscription=e.pipe((0,g.b)((e=>this.publish(e)))).subscribe(),this.logger.log("initialized")}destroy(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=this.contexts.users.size+this.contexts.windows.size;i>0&&this.logger.warn(`destroying ExperienceLifeCycleManager with ${i} other contexts`),yield this.processCleanupJobs(this.contexts.experience,e),null===(t=this.subscription)||void 0===t||t.unsubscribe(),this.scheduler.destroy(),this.logger.log("destroyed")}))}registerApplication(e){var t;if(!this.isInitialized)throw new Error("Unable to register application before ExperienceLifeCycleManager initialization");const i=e.manifest.id;if(this.managers.has(i))return void this.logger.warn(`did not subscribe application, already subscribed ${e.manifest.id}`);const n=new Vx(e,null===(t=this.lifeCycleJobPermissions)||void 0===t?void 0:t.Application);this.managers.set(i,n),this.applications.push(e),this.logger.log(`registered application ${e.manifest.id}`)}registerUser(e,t){var i,n;if(this.contexts.users.has(e))return void(null===(n=(i=this.logger).errorToTelemetry)||void 0===n||n.call(i,`user already exists for contextId ${e}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0));const a={cleanupJobs:[],userContextId:e,session:t,scope:this.contexts.users.size>0?Ex.Other:Ex.FirstUserAtBoot};this.contexts.users.set(e,a),this.logger.log(`registered user ${e}`)}removeUser(e,t){var i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=this.contexts.users.get(e);if(n){const i=[];this.contexts.windows.forEach((n=>{n.userContextId===e&&i.push(this.removeWindow(n.windowId,e,t))})),yield Promise.all(i),yield this.processCleanupJobs(n,t),this.managers.forEach((t=>t.removeUser(e,this.logger))),this.contexts.users.delete(e),this.logger.log(`removed user ${e}, reason ${t}`)}else null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,`user not found ${e}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0)}))}registerWindow(e,t,i){var n,a,s,o;let r=this.contexts.windows.get(e);r&&r.userContextId===t?null===(a=(n=this.logger).errorToTelemetry)||void 0===a||a.call(n,`window: ${e} already exists for user: ${t}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0):(this.removeWindow(e,void 0,"switch_user"),this.contexts.users.has(t)?(r={cleanupJobs:[],windowId:e,userContextId:t,session:Object.assign(Object.assign({},this.contexts.experience.session),i),scope:Nx.Window},this.contexts.windows.set(e,r),this.logger.log(`registered window ${e}`)):null===(o=(s=this.logger).errorToTelemetry)||void 0===o||o.call(s,`failed to register window, could not find user: ${t}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0))}removeWindow(e,t,i){var a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.logger.log(`removing window ${e}${t?` for ${t}`:""}, reason ${i}`);const n=this.contexts.windows.get(e);n?(yield this.processCleanupJobs(n,i),this.managers.forEach((t=>t.removeWindow(e,this.logger))),this.contexts.windows.delete(e),this.logger.log(`removed window ${e}`)):null===(s=(a=this.logger).errorToTelemetry)||void 0===s||s.call(a,`window not found for ${e}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0)}))}publish(e){var t,i;if(this.logger.log(`publish ${e.type}`),e.userContextId)this.logger.log(`change is user specific to ${e.userContextId}`),this.publishChangeWithUserContext(e,e.userContextId);else{const t=Array.from(this.contexts.users.values());for(const{userContextId:i}of t)this.publishChangeWithUserContext(e,i)}if(e.windowId){this.logger.log(`change is window specific to ${e.windowId}`);const n=this.contexts.windows.get(e.windowId);if(!n)return void(null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,`window not found for windowId ${e.windowId}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0));this.processChange({change:e,context:n})}this.processChange({change:e,context:this.contexts.experience})}publishChangeWithUserContext(e,t){var i,n;const a=this.contexts.users.get(t);if(!a)return void(null===(n=(i=this.logger).errorToTelemetry)||void 0===n||n.call(i,`user not found for userContextId ${t}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0));const s=!e.userContextId&&t?Object.assign(Object.assign({},e),{userContextId:t}):e;this.processChange({change:s,context:a})}processChange({change:e,context:t}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=`change:${e.type}:scope:${t.scope}`;this.logger.log(`${i} processing change`);const n=[];this.logger.log(`${i} scheduling jobs`),this.managers.forEach((i=>{const a=i.managedId,s=i.onChange(e,t.scope,t.session);a&&s.length>0&&s.forEach((e=>n.push(this.scheduleJobs(e,a))))})),this.logger.log(`${i} executed against ${this.managers.size} ApplicationLifeCycleManagers`),this.logger.log(`${i} scheduled ${n.length} jobs`);const a=yield Promise.all(n);t.scope!==Nx.Window&&this.markPostALTScenarioIfNeeded(a,t),this.logger.log(`${i} saving ${a.length} cleanup jobs`);for(const{cleanupJobs:e}of a)t.cleanupJobs.push(...e);const s=this.generateChangeReport({change:e,results:a,scope:t.scope});return this.lifeCycleChangeReportingService.report(s),this.logger.log(`${i} finished processing change`),{change:e}}))}scheduleJobs(e,t){var i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{change:n,jobs:s}=e,o=[];s.forEach((e=>{o.push(this.scheduleJob(e,n.correlationId))}));const r=[];let c=jx.success;for(const e of o)try{const t=yield e;t&&r.push(t)}catch(e){const n=`Not all jobs scheduled by ${t} completely successfully. Continuing execution of remaining jobs. Error: ${e.message?e.message:e}`;null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,n,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0),c=jx.failure}return Promise.resolve({id:t,type:n.type,stateJobStatus:c,jobCount:s.length,cleanupJobs:r})}))}scheduleJob(e,t){var{job:i}=e,a=(0,n.__rest)(e,["job"]);return(0,n.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((e,s)=>{this.schedulerWithValidator.validateAndSchedule((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield i();return e(t),t}catch(e){throw s(e),e}}))),Object.assign(Object.assign({priority:Z.vW.Macro},a),{scheduledById:"services-life-cycle-manager"}),t)===Z.o_&&e(void 0)}))}))}markPostALTScenarioIfNeeded(e,t){var i,n;const a=t.scope===Ix.Experience?Mt.c4.ExperienceWarm:Mt.c4.UserWarm,s=t.scope===Ix.Experience?z.ck.ExperienceWarmJobCompleted:z.ck.PreWarmJobCompleted;if((null==e?void 0:e.length)>0&&(null===(i=e[0])||void 0===i?void 0:i.type)===a){const e=null===(n=t.session.scenarioFactory)||void 0===n?void 0:n.findScenario(z.RG.PostALT);e&&(e.mark(s),this.logger.log("marked postALT scenario as completed"))}}generateChangeReport({change:e,results:t,scope:i}){const{type:n}=e;0===t.length&&this.logger.warn(`experience change type: ${n} produced no application life cycle changes`);const a=i===Ix.Experience?_x.ExperienceLifeCycleManager:_x.UserLifeCycleManager;return Object.assign(Object.assign({},e),{type:Cx.LifeCycleReport,context:{apps:t,target:a,reportedChange:e}})}processCleanupJobs(e,t){var i,a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n="experience";"windowId"in e?n=e.windowId:"userContextId"in e&&(n=e.userContextId);const o=`context:${e.scope}:${n}`,r=e.cleanupJobs;let c;this.logger.log(`${o} running ${r.length} cleanup jobs`);for(const e of r)try{yield e(t)}catch(t){c=c?c.concat(`${e.toString()}::${(0,U.u4)(t)}`):`${e.toString()}::${(0,U.u4)(t)}::`}if(c){const e=new ze.G(ze.$.CLEANUP,new Error(c));null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,`${o} ${e.code}${null===(s=e.prevError)||void 0===s?void 0:s.message}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0)}this.logger.log(`${o} finished running cleanup jobs`)}))}get isInitialized(){return Boolean(this.subscription)}}class Kx{constructor(e,t,i,n,a,s){this._elcm=new Jx({scheduler:e,experienceChangeReportingService:t,context:i,lifeCycleChangeReportingService:n,loggerFactory:a,lifeCycleJobPermissions:s})}init(){this._elcm.init()}destroy(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this._elcm.destroy(e)}))}manageApplication(e){this._elcm.registerApplication(e)}manageUser(e,t){this._elcm.registerUser(e,t)}removeUser(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this._elcm.removeUser(t,e)}))}manageWindow(e,t,i){this._elcm.registerWindow(e,t,i)}removeWindow(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this._elcm.removeWindow(t,e,i)}))}}function Qx({applicationManagers:e,change:t,logger:i,schedulerWithValidator:a}){const s=[];return i.debug(`Change received: ${t.type}`),e.forEach((e=>{const o=e.managedId,r=e.onChange(t);o&&r.length>0&&r.forEach((e=>s.push(function(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{jobs:s,change:o}=e,r=[];s.forEach((e=>{r.push(function(e,t,i){var{job:a}=e,s=(0,n.__rest)(e,["job"]);return new Promise(((e,o)=>{t.validateAndSchedule((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield a();return e(t),t}catch(e){throw o(e),e}}))),Object.assign(Object.assign({priority:Z.vW.Macro},s),{scheduledById:"services-life-cycle-manager"}),i)===Z.o_&&e(void 0)}))}(e,a,o.correlationId))}));const c=[];let l=jx.success;for(const e of r)try{const t=yield e;t&&c.push(t)}catch(e){const n=`Not all jobs scheduled by ${i} completely successfully. Continuing execution of remaining jobs. Error: ${e.message?e.message:e}`;t.errorToTelemetry&&t.errorToTelemetry(n,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0),l=jx.failure}return Promise.resolve({id:i,type:o.type,stateJobStatus:l,jobCount:s.length,cleanupJobs:c})}))}(e,i,o,a))))})),{change:t,lcChanges:s}}function Yx({change:e,lcChanges:t}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield Promise.all(t);return{change:e,lcChanges:i}}))}function Xx({change:e,lcChanges:t},i,n){const{type:a}=e;0===t.length&&i.debug(`Experience change type: ${a} produced no application life cycle changes`);const s=n===Ix.Experience?_x.ExperienceLifeCycleManager:_x.UserLifeCycleManager;return Object.assign(Object.assign({},e),{type:Cx.LifeCycleReport,context:{apps:t,target:s,reportedChange:e}})}class Zx{constructor(e,t,i,n,a,s,o){this._scope=t,this._sessionContext=n,this._lifeCycleChangeReportingService=a,this._loggerFactory=s,this._lifeCycleJobPermissions=o,this._cleanupJobs=[],this._applicationManagers=[],this._activelyManagedApplications=new Set,this._lifeCycleJobPermissions=this._lifeCycleJobPermissions||{},this._logger=this._loggerFactory.newLogger(`WindowLifeCycleManager[${e}]`,"core-services-life-cycle-manager"),this._schedulerWithValidator=new Gx(i,s)}notify(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=Qx({applicationManagers:this._applicationManagers,change:e,logger:this._logger,schedulerWithValidator:this._schedulerWithValidator}),i=yield Yx(t);for(const{cleanupJobs:e}of i.lcChanges)this._cleanupJobs.push(...e);const n=Xx(i,this._logger,this._scope);this._lifeCycleChangeReportingService.report(n)}))}manageApplication(e){var t;if(this._activelyManagedApplications.has(e))return;this._activelyManagedApplications.add(e);const i=new qx(this._scope,null===(t=this._lifeCycleJobPermissions)||void 0===t?void 0:t.Application,this._sessionContext);i.manageApplication(e),this._applicationManagers.push(i)}destroy(e){var t,i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n,s,o;for(;n=this._cleanupJobs.pop();)try{yield n(e)}catch(e){o=o?o.concat(`${n.toString()}::${(0,U.u4)(e)}`):`${n.toString()}::${(0,U.u4)(e)}::`}o&&(s=new ze.G(ze.$.CLEANUP,new Error(o)),null===(i=(t=this._logger).errorToTelemetry)||void 0===i||i.call(t,`${s.code}${null===(a=s.prevError)||void 0===a?void 0:a.message}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0))}))}}class eD{constructor(e,t,i,n,a,s,o){this._scope=t,this._scheduler=i,this._sessionContext=n,this._lifeCycleChangeReportingService=a,this._loggerFactory=s,this._lifeCycleJobPermissions=o,this._cleanupJobs=[],this._windowLifecycleManagers=new Map,this._applicationManagers=[],this._activelyManagedApplications=new Set,this._lifeCycleJobPermissions=this._lifeCycleJobPermissions||{},this._logger=this._loggerFactory.newLogger(`UserLifeCycleManager[${e}]`,"core-services-life-cycle-manager"),this._schedulerWithValidator=new Gx(i,s)}manageApplication(e){var t;if(this._activelyManagedApplications.has(e))return;this._activelyManagedApplications.add(e);const i=new qx(this._scope,null===(t=this._lifeCycleJobPermissions)||void 0===t?void 0:t.Application,this._sessionContext);i.manageApplication(e),this._applicationManagers.push(i)}notify(e){var t,i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.handleWindowChange(e);const n=Qx({applicationManagers:this._applicationManagers,change:e,logger:this._logger,schedulerWithValidator:this._schedulerWithValidator}),s=yield Yx(n);if((null===(t=s.lcChanges)||void 0===t?void 0:t.length)>0&&(null===(i=s.lcChanges[0])||void 0===i?void 0:i.type)===Mt.c4.UserWarm){const e=null===(a=this._sessionContext.scenarioFactory)||void 0===a?void 0:a.findScenario(z.RG.PostALT);null==e||e.mark(z.ck.PreWarmJobCompleted)}for(const{cleanupJobs:e}of s.lcChanges)this._cleanupJobs.push(...e);const o=Xx(s,this._logger,this._scope);this._lifeCycleChangeReportingService.report(o)}))}manageWindow(e,t){var i,n;if(this._windowLifecycleManagers.has(e))return void(null===(n=(i=this._logger).errorToTelemetry)||void 0===n||n.call(i,`WINDOW_LIFECYCLE_MANAGER_ALREADY_EXISTS[${e}]`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0));const a=new Zx(e,Nx.Window,this._scheduler,t,this._lifeCycleChangeReportingService,this._loggerFactory,this._lifeCycleJobPermissions);this._activelyManagedApplications.forEach((e=>a.manageApplication(e))),this._windowLifecycleManagers.set(e,a)}removeWindow(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=this._windowLifecycleManagers.get(e);i&&(yield i.destroy(t),this._windowLifecycleManagers.delete(e))}))}destroy(e){var t,i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n,s,o;for(this._windowLifecycleManagers.forEach((t=>{t.destroy(e)}));n=this._cleanupJobs.pop();)try{yield n(e)}catch(e){o=o?o.concat(`${n.toString()}::${(0,U.u4)(e)}`):`${n.toString()}::${(0,U.u4)(e)}::`}o&&(s=new ze.G(ze.$.CLEANUP,new Error(o)),null===(i=(t=this._logger).errorToTelemetry)||void 0===i||i.call(t,`${s.code}${null===(a=s.prevError)||void 0===a?void 0:a.message}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0))}))}handleWindowChange(e){var t;e.windowId&&(null===(t=this._windowLifecycleManagers.get(e.windowId))||void 0===t||t.notify(e))}}class tD{constructor(e,t,i,n,a,s){this._scheduler=e,this._experienceChangeReportingService=t,this._sessionContext=i,this._lifeCycleChangeReportingService=n,this._loggerFactory=a,this._lifeCycleJobPermissions=s,this._cleanupJobs=[],this._userLifecycleManagers=new Map,this.handleUserScopeChange=e=>{if(e.userContextId){const t=this._userLifecycleManagers.get(e.userContextId);t?t.notify(e):this._logger.error(`EXPECTED_USER_LIFECYCLE_MANAGER_NOT_FOUND[${e.userContextId}]`)}else this._userLifecycleManagers.forEach((t=>t.notify(e)))},this._applicationManagers=[],this._activelyManagedApplications=new Set,this._lifeCycleJobPermissions=this._lifeCycleJobPermissions||{},this._logger=this._loggerFactory.newLogger("ExperienceLifeCycleManager","core-services-life-cycle-manager"),this._schedulerWithValidator=new Gx(this._scheduler,a)}init(){const e=this._experienceChangeReportingService.observeChanges();this._subscription=e.pipe((0,g.b)(this.handleUserScopeChange),(0,l.U)((e=>Qx({applicationManagers:this._applicationManagers,change:e,logger:this._logger,schedulerWithValidator:this._schedulerWithValidator}))),(0,le.b)(Yx),(0,g.b)((e=>{var t,i,n;if((null===(t=e.lcChanges)||void 0===t?void 0:t.length)>0&&(null===(i=e.lcChanges[0])||void 0===i?void 0:i.type)===Mt.c4.ExperienceWarm){const e=null===(n=this._sessionContext.scenarioFactory)||void 0===n?void 0:n.findScenario(z.RG.PostALT);null==e||e.mark(z.ck.ExperienceWarmJobCompleted)}for(const{cleanupJobs:t}of e.lcChanges)this._cleanupJobs.push(...t)})),(0,l.U)((e=>Xx(e,this._logger,Ix.Experience))),(0,l.U)((e=>this._lifeCycleChangeReportingService.report(e)))).subscribe()}destroy(e){var t,i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n,s,o;for(;n=this._cleanupJobs.pop();)try{yield n(e)}catch(e){o=o?o.concat(`${n.toString()}::${(0,U.u4)(e)}`):`${n.toString()}::${(0,U.u4)(e)}::`}this._subscription&&this._subscription.unsubscribe(),this._scheduler.destroy(),o&&(s=new ze.G(ze.$.CLEANUP,new Error(o)),null===(i=(t=this._logger).errorToTelemetry)||void 0===i||i.call(t,`${s.code}${null===(a=s.prevError)||void 0===a?void 0:a.message}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0))}))}manageApplication(e){var t;if(!this._subscription)throw new Error("Unable to manage provided application prior to LifeCycleManager init.");if(this._activelyManagedApplications.has(e))return;this._activelyManagedApplications.add(e);const i=new qx(Ix.Experience,null===(t=this._lifeCycleJobPermissions)||void 0===t?void 0:t.Application,this._sessionContext);i.manageApplication(e),this._applicationManagers.push(i)}manageUser(e,t){if(this._userLifecycleManagers.has(e))return void this._logger.error(`USER_LIFECYCLE_MANAGER_ALREADY_EXISTS[${e}]`);const i=new eD(e,this._userLifecycleManagers.size>0?Ex.Other:Ex.FirstUserAtBoot,this._scheduler,t,this._lifeCycleChangeReportingService,this._loggerFactory,this._lifeCycleJobPermissions);this._activelyManagedApplications.forEach((e=>i.manageApplication(e))),this._userLifecycleManagers.set(e,i)}manageWindow(e,t,i){var n,a;this.removeWindow(void 0,e,"switch_user");const s=this._userLifecycleManagers.get(t);s?s.manageWindow(e,Object.assign(Object.assign({},this._sessionContext),i)):null===(a=(n=this._logger).errorToTelemetry)||void 0===a||a.call(n,`EXPECTED_USER_LIFECYCLE_MANAGER_NOT_FOUND[${t}]`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0)}removeUser(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=this._userLifecycleManagers.get(t);i?(yield i.destroy(e),this._userLifecycleManagers.delete(t)):this._logger.warn(`USER_LIFECYCLE_MANAGER_NOT_FOUND_TO_DESTROY[${t}]`)}))}removeWindow(e,t,i){var a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){e?null===(a=this._userLifecycleManagers.get(e))||void 0===a||a.removeWindow(t,i):this._userLifecycleManagers.forEach((e=>e.removeWindow(t,i)))}))}}const iD=(e,t,i,n)=>{const a=function(e,t,i){if(!i){const{context:{execution:i}}=e;t.error(`Received a scheduler change in state: ${Z.Tf[i]} with no active scenario: ${JSON.stringify(e)}`)}return i}(e,t,n);if(a){const{context:{execution:t,handle:n,error:s}}=e;a.appendEventData({errorCode:null==s?void 0:s.code,message:null==s?void 0:s.message,context:null==s?void 0:s.context}),a.mark(`${z.ck.ScheduledJobStateChange}_${Z.Tf[t].toLocaleLowerCase()}_${n}`),i(a)}};class nD{constructor(e,t,i){this._schedulerChangeReporting=e,this._scenarioFactory=t,this._activeExpScenariosMap=new Map,this._activeAppScenariosMap=new Map,this._activeSchedulerScenariosMap=new Map,this._logger=i.newLogger("LifeCycleTelemetry","core-services-life-cycle-telemetry")}init(){const e=e=>({change:e,scenarioFactory:this._scenarioFactory,activeAppScenariosMap:this._activeAppScenariosMap,activeExpScenariosMap:this._activeExpScenariosMap,activeSchedulerScenariosMap:this._activeSchedulerScenariosMap,logger:this._logger});this._schedulingChangeSubscription=this._schedulerChangeReporting.observeChanges().pipe((0,l.U)((t=>function({change:e,activeSchedulerScenariosMap:t,scenarioFactory:i,logger:n}){const{context:{execution:a}}=e,s=(({windowId:e,context:{handle:t}})=>`${t}:${e}`)(e);let o=t.get(s);switch(a){case Z.Tf.Started:if(o)n.error(`Received a scheduler change in state: ${Z.Tf[a]} with an active scenario already running. Change: ${JSON.stringify(e)}`);else{o=i.newScenario(z.RG.ScheduledJobComplete),t.set(s,o);const{correlationId:n,context:{meta:{id:a,priority:r,scheduledById:c,runOncePerId:l},target:d},type:u}=e;o.appendEventData({"Job.Id":a,"Job.Priority":Z.vW[r],"Job.ScheduledBy":c,"Job.RunOncePerId":l,target:d,correlationId:n,type:u})}break;case Z.Tf.Canceled:iD(e,n,(e=>null==e?void 0:e.cancel()),o);break;case Z.Tf.Complete:iD(e,n,(e=>null==e?void 0:e.stop()),o),t.delete(s);break;case Z.Tf.Received:n.log(`Received a scheduler change in state: ${Z.Tf[a]}: Change:${JSON.stringify(e)}`)}}(e(t))))).subscribe()}destroy(){this._schedulingChangeSubscription&&this._schedulingChangeSubscription.unsubscribe(),this._schedulingChangeSubscription=void 0}}var aD=i(586990);const sD=1024;function oD(e,t,i,a){var s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const o=null===(s=aD.K.getInstance())||void 0===s?void 0:s.getMemoryData();if(!o)return{baseRendererWS:0,baseJSUsedHeapSize:0};const r=yield function(e,t,i){var a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n=0;n=i.enableDecoupleCommandingFromApollo?i.getActiveWindows().length:(null===(a=yield(0,Lo.XD)(e))||void 0===a?void 0:a.length)||0;const s=t.get(S.J.Diagnostics).memorySharedSettings.popoutSizeInMB;return n<=1||!s?{jsUsedHeapSize:0,rendererWorkingSet:0}:{jsUsedHeapSize:(n-1)*(s.jsUsedHeapSize||0)*sD,rendererWorkingSet:(n-1)*(s.rendererWorkingSet||0)*sD}}))}(e,t,i),c=function(e,t){const i=(null==t?void 0:t.getAuthenticatedUsers().size)||0,n=e.get(S.J.Diagnostics).memorySharedSettings.accountSizeInMB;if(i<=1||!n)return{jsUsedHeapSize:0,rendererWorkingSet:0};return{jsUsedHeapSize:(i-1)*(n.jsUsedHeapSize||0)*sD,rendererWorkingSet:(i-1)*(n.rendererWorkingSet||0)*sD}}(t,a);let l=0;const d=o.Perf_Renderer_WorkingSet;d&&(l=d-r.rendererWorkingSet-c.rendererWorkingSet);let u=0;const m=o.Perf_JSHeap_UsedSize;return m&&(u=m-r.jsUsedHeapSize-c.jsUsedHeapSize),{baseRendererWS:l,baseJSUsedHeapSize:u}}))}class rD{constructor(e,t,i,n,a,s,o,r,c,l){this.client=t,this.clientStateProvider=i,this.coreSettings=n,this.rebootService=a,this.hostCommunicationService=s,this.scenarioFactory=o,this.activeWindowsService=r,this.loggerFactory=c,this.userTrackingService=l,this.clientStateSubscription=null,this.isMachineLocked=!1,this.configSubscription=null,this.highMemoryRestartSettings=this.coreSettings.get(S.J.Diagnostics).highMemoryRestartSettings,this.currentClientState=this.clientStateProvider.getState(),this.startTimeMS=e.startTimeMS||0,this.startDate=new Date(this.startTimeMS).toUTCString(),this.logger=this.loggerFactory.newLogger("highMemoryRestartService","high-memory-restart"),this.start()}start(){this.newScenario(z.RG.HighMemoryRestartServiceStart),this.subscribeToClientStateChange(),this.subscribeToMachineStateChange(),this.subscribeToConfigSettingsChange()}stop(){var e,t,i;null===(e=this.clientStateSubscription)||void 0===e||e.unsubscribe(),null===(t=this.unsubscribeToMachineStateChange)||void 0===t||t.call(this),null===(i=this.configSubscription)||void 0===i||i.unsubscribe()}subscribeToClientStateChange(){this.clientStateSubscription=this.clientStateProvider.observe().subscribe((e=>this.handleClientStateChange(e)))}subscribeToMachineStateChange(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("osutils");this.unsubscribeToMachineStateChange=null===(e=null==t?void 0:t.registerForSessionStateChanged)||void 0===e?void 0:e.call(t,(e=>{this.infoToTelemetry(`Current machine state is ${e.status}`),e.status!==cr.$y.Locked&&e.status!==cr.$y.Unlocked||this.handleMachineStateChange(e.status===cr.$y.Locked)}))}))}subscribeToConfigSettingsChange(){this.configSubscription=this.coreSettings.getObservable(S.J.Diagnostics).subscribe((e=>{e.enableHighMemoryRestartService||this.stop()}))}handleClientStateChange(e){this.currentClientState=e,this.handleStateChange()}handleMachineStateChange(e){this.isMachineLocked=e,this.handleStateChange()}handleStateChange(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){(yield this.shouldRebootApp())&&(this.newScenario(z.RG.HighMemoryRestartApp),this.rebootService.rebootApp(bo.Z.HighMemory,bo.d.ReloadAppTask))}))}shouldRebootApp(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.currentClientState===$e.pk.LongInactive&&(this.isMachineLocked?this.isLongRunningSession()?this.hasHighMemory():(this.infoToTelemetry(`App wasn't rebooted because passed not enought time. ${this.startDate}`),!1):(this.infoToTelemetry("App wasn't rebooted because machine wasn't locked"),!1))}))}isLongRunningSession(){return(new Date).getTime()-this.startTimeMS>36e5*this.highMemoryRestartSettings.longRunningThresholdInHours}hasHighMemory(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield oD(this.client,this.coreSettings,this.activeWindowsService,this.userTrackingService)).baseRendererWS>1024*this.highMemoryRestartSettings.thresholdsInMB.rendererWorkingSet||(this.infoToTelemetry("App wasn't rebooted because memory wasn't high"),!1)}))}newScenario(e){this.scenarioFactory.newScenario(e).stop()}infoToTelemetry(e){var t,i;this.coreSettings.get(S.J.Diagnostics).enableHighMemoryRestartLogger&&(null===(i=(t=this.logger).infoToTelemetry)||void 0===i||i.call(t,e,"high_memory_restart_request"))}}var cD=i(157930);const lD=1024,dD=1e3,uD=6e4,mD=36e5,gD=864e5,hD="memoryFeedbackService.lastDialogDate",pD="memoryFeedbackService.countOfDialogWithinDay",vD="memoryFeedbackService.countOfDialogWithinWeek";class fD{constructor(e,t,i,n,a,s,o,r,c){this.localStorage=e,this.entityCommanding=t,this.clientState=i,this.client=n,this.coreSettings=a,this.scenarioFactory=s,this.activeWindowsService=o,this.profilerService=r,this.userTrackingService=c,this.timeWhenLastCallEnded=-1,this.countOfDialogWithinDay=0,this.countOfDialogWithinWeek=0,this.memoryFeedbackSettings=this.coreSettings.get(S.J.Diagnostics).memoryFeedbackSettings}start(){this.startClientStateSubscription(),this.intervalId||(this.intervalId=(0,R.J)().setInterval((()=>this.beat()),this.memoryFeedbackSettings.verySlowSampleTime))}stop(){this.intervalId&&(0,R.J)().clearInterval(this.intervalId),this.timeoutId&&(0,R.J)().clearTimeout(this.timeoutId),this.clientStateSubscription&&this.clientStateSubscription.unsubscribe()}startClientStateSubscription(){let e=this.clientState.getState();this.clientStateSubscription=this.clientState.observe().subscribe({next:t=>{e===$e.pk.VeryActive&&t!==$e.pk.VeryActive&&(this.timeWhenLastCallEnded=Date.now()),e=t}})}shouldKeepRunningForMTMA(){var e,t;return!!(null===(e=this.coreSettings.get(S.J.Diagnostics).memorySharedSettings)||void 0===e?void 0:e.accountSizeInMB)||(null===(t=this.userTrackingService)||void 0===t?void 0:t.getAccountMode())!==fN.MultipleAccounts}beat(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.shouldKeepRunningForMTMA())return void this.stop();const t=yield null===(e=aD.K.getInstance())||void 0===e?void 0:e.getMemoryData();if(!t)return;if(void 0!==t.Perf_Renderer_Count_Processes&&t.Perf_Renderer_Count_Processes>1)return this.stop(),void this.newScenario(z.RG.MemoryFeedbackStopBecauseOfDevtools);const i=new Date,n=yield this.shouldShowBrbDialog(i,t);n.isMemoryHeavy&&(this.openBrbDialog(n.memoryDetailMessage),this.newScenario(z.RG.MemoryFeedbackDialogOpen),this.stop(),this.dateOfBeginingHighMemory=void 0,this.localStorage.set(pD,(this.countOfDialogWithinDay+1).toString()),this.localStorage.set(vD,(this.countOfDialogWithinWeek+1).toString()),this.localStorage.set(hD,i.toString()))}))}openBrbDialog(e){this.entityCommanding.brbFeedback.autoBrbConfirmationDialog({visibilityState:ve.fe.show,stateTransition:ve.su.new,correlation:{source:k.D.AutoBrb}},{feedbackText:`Detected high memory usage. ${e}`,feedbackSelectedCategory:"79",includeHeapSnapshot:!0,brbContext:cD.t.HighMemoryUsage})}shouldShowBrbDialog(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let i;if(i=this.activeWindowsService.enableDecoupleCommandingFromApollo?this.activeWindowsService.getStandardMainWindow():yield(0,Lo.jW)(this.client),!(null==i?void 0:i.isMainWindow))return{isMemoryHeavy:!1};this.dateOfBeginingHighMemory&&(yield this.triggerGCAndWait());const{isMemoryHeavy:n,memoryDetailMessage:a}=yield this.getMemoryUsageData(t);if(!n||this.wasInCallRecently(e))return this.dateOfBeginingHighMemory=void 0,{isMemoryHeavy:!1};if(this.dateOfBeginingHighMemory=this.dateOfBeginingHighMemory||e,e.getTime()-this.dateOfBeginingHighMemory.getTime()<this.memoryFeedbackSettings.durationInMinuteOfConsecutiveHighMemoryState*uD)return{isMemoryHeavy:!1};if(this.hasReachedDialogLimit(e))return{isMemoryHeavy:!1};return this.clientState.getState()!==$e.pk.Active?{isMemoryHeavy:!1}:{isMemoryHeavy:n,memoryDetailMessage:a}}))}getMemoryUsageData(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=this.getThresholds(),i=[];let n=!1;const a=yield oD(this.client,this.coreSettings,this.activeWindowsService,this.userTrackingService),s=e.Perf_Renderer_WorkingSet||0,o=a.baseRendererWS>t.rendererWorkingSet*lD;n=n||o,i.push(`${this.markReachedThreshold(o)}RWS: ${this.convertKBtoMB(s)} MB`);const r=e.Perf_JSHeap_UsedSize||0,c=a.baseJSUsedHeapSize>t.jsUsedHeapSize*lD;n=n||c,i.push(`${this.markReachedThreshold(c)}JSH: ${this.convertKBtoMB(r)} MB`),i.push(`base RWS: ${this.convertKBtoMB(a.baseRendererWS)} MB`);return{isMemoryHeavy:n,memoryDetailMessage:i.join(", ")}}))}hasReachedDialogLimit(e){const t=new Date(this.localStorage.get(hD)||0);return e.getTime()-t.getTime()<this.memoryFeedbackSettings.gapInHourBetweenFeedbackDialogs*mD||(e.getTime()-t.getTime()>gD&&this.resetDialogDayCount(),this.countOfDialogWithinDay=parseInt(this.localStorage.get(pD)||"0",10),this.countOfDialogWithinDay>=this.memoryFeedbackSettings.limitOfFeedbackDialogsWithinDay||(e.getTime()-t.getTime()>7*gD&&this.resetDialogWeekCount(),this.countOfDialogWithinWeek=parseInt(this.localStorage.get(vD)||"0",10),this.countOfDialogWithinWeek>=this.memoryFeedbackSettings.limitOfFeedbackDialogsWithinWeek))}wasInCallRecently(e){const t=this.memoryFeedbackSettings.minimumSecondsPassedSinceLastCall*dD,i=this.timeWhenLastCallEnded>0&&e.getTime()-this.timeWhenLastCallEnded;return i&&t&&i<t}triggerGCAndWait(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield null===(e=this.profilerService)||void 0===e?void 0:e.requestTriggerGC(),yield(0,rl._)(this.memoryFeedbackSettings.delayInMsAfterGC)}))}newScenario(e){this.scenarioFactory.newScenario(e).stop()}getThresholds(){return this.memoryFeedbackSettings.thresholdsInMB}resetDialogDayCount(){this.localStorage.set(pD,"0")}resetDialogWeekCount(){this.localStorage.set(vD,"0")}markReachedThreshold(e){return e?"#":""}convertKBtoMB(e){return(e/lD).toFixed(2)}}var bD,yD=i(817861);!function(e){e.Supported="Supported",e.Unsupported="Unsupported",e.Unknown="Unknown"}(bD||(bD={}));function kD(e){return e.split(".").slice(-2).join(".")}class SD{constructor(e,t,i,n){this.windowProvider=n,this.scenario=i.newScenario(z.RG.DetectThirdPartyCookieSupport),this.enabled=Boolean(t.get(S.J.Core,["enableThirdPartyCookiesDetection"]).enableThirdPartyCookiesDetection);const{staticsPath:a,buildType:s,buildVersion:o}=t.get(S.J.Platform,["staticsPath","buildType","buildVersion"]);this.cdnConfig={experienceName:e,staticsOrigin:a||void 0,buildType:s||void 0,version:o||void 0}}detect(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.enabled)return new Promise((e=>{e(this.handleError("enableThirdPartyCookiesDetection is disabled"))}));try{const e=function(e,t){const{experienceName:i,staticsOrigin:n,buildType:a,version:s}=t;let o;switch(a){case"production":if(!n||!s)break;o=`${n}/teams-modular-packages/${i}/${s}/`;break;case"container":o=e.__webpack_public_path__;break;case"local":o="https://local.third-party-cookie-service.office.net/v2/";break;default:throw new Error("Unsupported build type")}if(!o)throw new Error("CDN path not found");if(kD(new URL(o).host)===kD(e.location.host))throw new Error("CDN domain and client domain are the same");return`${o}report-third-party-cookies.html`}(this.windowProvider,this.cdnConfig),t=document.createElement("iframe");t.setAttribute("style","display: none;"),t.setAttribute("src",e),this.iframe=t,this.scenario.mark("iframe_created");const i=new Promise((t=>{this.detectionTimeoutRef=this.windowProvider.setTimeout((()=>{t(this.handleError("timeout of 10000 exceeded",e))}),1e4)})),n=new Promise((e=>{this.messageHandler=t=>{const i=this.handlePostMessage(t);i&&e(this.handleSuccess(i))},this.windowProvider.addEventListener("message",this.messageHandler)})),a=new Promise((i=>{t.addEventListener("error",(t=>{i(this.handleError(t.message,e))}))}));return this.windowProvider.document.body.appendChild(this.iframe),Promise.race([i,n,a])}catch(e){return new Promise((t=>{t(this.handleError(e.message))}))}}))}handlePostMessage({data:e}){const{third_party_cookies_allowed:t}=e;if(void 0===t)return;this.scenario.mark("iframe_message_received");return Boolean(t)?bD.Supported:bD.Unsupported}handleSuccess(e){return this.cleanup(),this.scenario.stop({third_party_cookie_support:e}),e}handleError(e,t){return this.cleanup(),this.scenario.fail({error:e,url:t,third_party_cookies_support:bD.Unknown}),bD.Unknown}cleanup(){this.iframe&&this.windowProvider.document.body.removeChild(this.iframe),this.messageHandler&&this.windowProvider.removeEventListener("message",this.messageHandler),this.detectionTimeoutRef&&this.windowProvider.clearTimeout(this.detectionTimeoutRef)}}var wD,jD=i(917556);!function(e){e.LifeCycleScopeChange="LifeCycleScopeChange"}(wD||(wD={}));class CD extends Ue{constructor(){super(h.Yg.CreateLifeCycleTask,["activeWindowsService","appsRegistryService","authenticationService","client","clientState","config","coreSecurityService","coreSettings","coreSettingsContext","coreUtilities","entityCommanding","experienceChangeReportingService","hostCommunicationService","i18n","i18NextWrapper","lifeCycleScopeChangeReportingService","localStorage","loggerFactory","networkState","platformService","rebootService","scenarioFactory","schedulerChangeReporting","userBiService","windowProvider","scheduler","notificationsHandler","logsCollectorService"]),this.createCoreApplication=(e,t,i,a)=>({manifest:{name:"CoreTasks",id:"com.microsoft.teams.corescheduling"},onExperienceWarm:t=>[{id:"memory-feedback-service-start",job:()=>{const{context:{client:e,clientState:i,coreSettings:n,entityCommanding:s,localStorage:o,profilerService:r,scenarioFactory:c,userTrackingService:l}}=t;if(!(n.get(S.J.Diagnostics).enableMemoryFeedbackService&&o&&i&&n.get(S.J.Diagnostics).memoryFeedbackSettings))return;new fD(o,s,i,e,n,c,a,r,l).start()}},{id:"init-diagnostics-idb-job",job:()=>{const{context:{loggerFactory:e}}=t;"notifyDiagnosticsALTDone"in e&&e.notifyDiagnosticsALTDone()}},{id:"clear-t2-web-boot-attempts-counter",job:()=>{var e,i,n;const{context:{coreSettings:a,loggerFactory:s,localStorage:o}}=t;if(!a.get(S.J.Core).enableClearT2WebBootAttempts)return;const r="clear_t2_web_boot_attempts_failure",c=s.newLogger("ClearWebBootAttemptsLogger","clear-t2-web-boot-attempts-counter");if(!o)return void(null===(e=c.errorToTelemetry)||void 0===e||e.call(c,"Local storage unavailable",r,void 0,!0));const l="numT2WebBootAttempts",d="t2WebOptInSessionId";o.remove(l,"Global"),o.remove(d,"Global"),o.remove("lastT2WebBootAttemptRecordTime","Global"),o.get(l,"Global")||o.get(d,"Global")?null===(i=c.errorToTelemetry)||void 0===i||i.call(c,"Failed to remove web boot/opt-in keys from local storage",r,void 0,!0):null===(n=c.warnToTelemetry)||void 0===n||n.call(c,"Successfully removed web boot/opt-in keys from local storage","clear_t2_web_boot_attempts_success",void 0,!0)}},{id:"detect-third-party-cookie-support-job",runOncePerId:!0,job:()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const{scenarioFactory:i,windowProvider:n,coreSettings:a,config:s,platformService:o}=t.context,r=yield function(e,t,i,n,a){return t!==Ps.us.Web?Promise.resolve(bD.Unknown):new SD(e,i,n,a).detect()}(s.experienceName,o.config.platformId,a,i,n);e.updatePlatformProviderSettings({thirdPartyCookieSupport:r})}))},{id:"notify-desktop-experience-warm-job",job:()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield i.loadModule("core");(null==e?void 0:e.reportExperienceWarm)&&e.reportExperienceWarm()}))},_D(t)],onPreWarm:n=>[{id:"settings-ecs-fetch",job:()=>e.fetchEcsSettingsIfApplicable()},{id:"maglev-provider-host-settings",job:()=>{const{context:{coreSettings:t}}=n;t.get(S.J.Core).enableMaglevHostPostAltSettings&&e.initializeMaglevHostProviderPostAltSettings(i)}},{id:"user-bi-initialize-smb-user-intent",job:()=>t.initializeAndSubscribeToSmbUserIntent&&t.initializeAndSubscribeToSmbUserIntent()},{id:"active-windows-history-job",job:()=>{const{context:{activeWindowsHistoryService:e}}=n;if(e)return e.initialize(),t=>{e.cleanup(t)}}},{id:"initialize-office-integration-service",job:()=>{const{coreSettings:e,client:t,hostCommunicationService:i,loggerFactory:a,entityCommanding:s,authenticationUser:o,localStorage:r,windowProvider:c}=n.context;e.get(S.J.People).enableOfficeIntegration&&(null==o?void 0:o.role)!==zo.w4.Anonymous&&yD.x.Instance(i,e,t,a,s,c,r,o).initialize()}},{id:"start-local-migrated-settings-timer-job",job:()=>{const{context:{localMigratedSettings:e}}=n;e&&e.startTimer()}}],onExperienceIdle:e=>[TD(e,a)]})}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=e.config,i=e.coreSettings,a=e.coreSettingsContext,s=e.clientAccessAdminPolicyCheckService,o=e.entityCommanding,r=e.experienceChangeReportingService,c=e.hostCommunicationService,l=e.i18n,d=e.lifeCycleScopeChangeReportingService,u=e.loggerFactory,m=e.networkState,g=e.platformService,h=e.scenarioFactory,p=e.schedulerChangeReporting,v=e.userBiService,f=e.clientState,b=e.localStorage,y=e.i18NextWrapper,k=e.windowProvider,w=e.rebootService,j=e.coreSecurityService,C=e.scheduler,_=e.notificationsHandler,T=e.authenticationService,I=e.activeWindowsService,N=e.logsCollectorService;new nD(p,h,u).init();const{isEntityInView:E}=e.coreUtilities,{enableExperienceLifeCycleManagerV2:F}=i.get(S.J.Core),x=new(F?Kx:tD)(C,r,{client:e.client,coreSettings:i,clientAccessAdminPolicyCheckService:s,entityCommanding:o,i18n:l,isEntityInView:E,loggerFactory:u,networkState:m,platformService:g,scenarioFactory:h,hostCommunicationService:c,clientState:f,localStorage:b,config:t,i18NextWrapper:y,windowProvider:k,rebootService:w,coreSecurityService:j,notificationsHandler:_,logsCollectorService:N,authenticationService:T},d,u,t.lifeCycleJobPermissions);return x.init(),e.appsRegistryService.registeredApps.forEach((e=>x.manageApplication(e))),x.manageApplication(this.createCoreApplication(a,v,c,I)),e.scheduler=C,e.experienceLifecycleManager=x,e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){switch(e){case"quit":case"signout":yield x.destroy(e);break;default:return}}))}))}}const _D=e=>({id:"cleanup-t1-desktop-job",runOncePerId:!0,job:()=>{if(!e.context.clientAccessAdminPolicyCheckService)return;const{context:{coreSettings:t,clientAccessAdminPolicyCheckService:i,hostCommunicationService:a,loggerFactory:s}}=e,o=s.newLogger("CleanupT1DesktopJob","cleanup-t1-desktop-job"),{deviceInfo:r}=t.get(S.J.Platform);if(!r)return;if(!(0,jD.E)(r))return void o.log("OS version < Win11, skipping");const c=null==i?void 0:i.shouldUserAttemptT1Cleanup().subscribe((e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(e){const e=yield a.loadModule("appswitcher");(null==e?void 0:e.uninstallT1App)&&(o.log("PIE: uninstallT1App"),e.uninstallT1App())}}))));if(c)return()=>{c.unsubscribe()};o.log("clientAccessAdminPolicyCheckService not initialized")}}),TD=(e,t)=>({id:"high-memory-restart-service",runOncePerId:!0,job:()=>{const{context:{config:i,client:n,clientState:a,coreSettings:s,rebootService:o,hostCommunicationService:r,scenarioFactory:c,userTrackingService:l,loggerFactory:d}}=e;s.get(S.J.Diagnostics).enableHighMemoryRestartService&&s.get(S.J.Diagnostics).highMemoryRestartSettings&&new rD(i,n,a,s,o,r,c,t,d,l)}});class ID{constructor(e){this.localStorage=e,this.logsProviderName="LocalStorageLogsProvider"}getLogsFiles(){const e=this.localStorage.calculateUsageStats(),t=JSON.stringify({userData:Object.assign(Object.assign(Object.assign({},e.User),e.UserAndExperience),{otherTMP:Object.values(Object.assign(Object.assign({},e.Global),e.Experience)).reduce(((e,t)=>e+t),0),nonTMP:Object.values(e.Unmanaged).reduce(((e,t)=>e+t),0)})});return Promise.resolve([{fileName:"local-storage-usage.json",content:t,isPiiFree:!1}])}}var ND=i(375754);const ED=["TflFreProfileCardDisplayed"],FD=["policy-cache"];class xD extends Ue{constructor(){super(h.Yg.CreateLocalStorage,["authenticationUser","config","coreSettings","loggerFactory","logsCollectorService","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,config:i,windowProvider:a,loggerFactory:s}=e,o=new bE(t.profile.tenantId,t.profile.objectId,i.experienceName,a,s);let r;!!e.coreSettings.get(S.J.Core).disableLocalStorageLogsProvider||(r=new ID(o),e.logsCollectorService.registerUserLogsProvider(t.profile.objectId,r));const c=s.newLogger("CreateLocalStorage","core-services-tasks"),l=(0,He.b4)(t);e.localStorage=o;const d=!e.coreSettings.get(S.J.Auth).isLegacyCleanupCodeFlag;return i=>(0,n.__awaiter)(this,void 0,void 0,(function*(){if("signout"===i&&d){const t=yield function(e,t,i,n){const a={},{enableServiceSwitcher:s}=n.get(S.J.Core,["enableServiceSwitcher"]);s&&ED.push(ND.H);const o=(0,Ty.nC)(i);try{ED.forEach((t=>{const i=e.get(t,"UserAndExperience");i&&(a[t]=i)})),e.clear(["UserAndExperience","User"]),o.map((t=>e.remove(t,"Experience"))),FD.map((t=>e.remove(t,"Global")))}catch(e){t.warn(`Failed to clear local storage! ${e}`)}return a}(o,c,l,e.coreSettings);t&&function(e,t,i){const n=Object.keys(t);try{n.forEach((i=>{e.set(i,t[i],"UserAndExperience")}))}catch(e){i.warn(`Failed to restore local storage values for ${n}: ${e}!`)}}(o,t,c)}switch(i){case"quit":case"signout":r&&e.logsCollectorService.unregisterUserLogsProvider(t.profile.objectId,r.logsProviderName);new yN.I(o).clear();break;default:return}}))}))}}const DD={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ServicesIoDataCustomNotificationsRemoveWindowMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeNotificationsWindow"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},AD={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ServicesIoDataCustomNotificationsCreateWindowMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createNotificationsWindow"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};function MD(e,t){return new Notification(e,t)}const PD=(e,t)=>`${e}/hashed/audio/${OD(t)}`,OD=e=>e?"Teams_Notification_v2-15d259a.mp3":"",RD="CN:",LD="BrowserNotifications:",UD=[z.ck.CallingNotificationRenderComplete,z.ck.MsnMeetingNotificationRenderComplete,z.ck.MeetingNudgeNotificationRenderComplete,z.ck.NormalNotificationRenderComplete,z.ck.ToastRenderCancelled,z.ck.NotificationRenderUpdate];class $D{constructor(e,t,i,a,s,o,r,c,l,d,u){this.activeWindowsService=e,this.waitForRenderingContextReady=t,this.hostCommunicationService=i,this.coreSettings=a,this.commandChangeReportingService=s,this.mainWindow=o,this.scenarioFactory=r,this.appsRegistryService=c,this.userBiService=l,this.activateBrowserToast=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t,i,n;this.mainWindow.focus();const a=e,s={entity:{type:pe.py.toasts,action:pe.uk.confirm},command:{visibilityState:ve.fe.show,stateTransition:ve.su.new,correlation:{source:k.D.NotificationsActivation,startTimestamp:Date.now(),id:(0,qe.v4)()}},entityOptions:a},o=null===(t=e.targetEntity.dataOptions)||void 0===t?void 0:t.userContextId;if(!o)return void(null===(n=(i=this.logger).errorToTelemetry)||void 0===n||n.call(i,`${LD} Error activating browser toast. UserContextId is missing from notifications entity command dataOptions.\n      Therefore, the user rendering context to use to activate this notification cannot be determined.`,"webclient_framework_foundation_core_services_notifications",void 0,!0));const r=yield this.waitForRenderingContextReady(!1,o);yield r.commandHandler(s)})),this.logger=d.newLogger("NotificationsHandler","core-services-notifications"),this.i18n=u,this.notificationsWindowId=void 0,this.notificationsWindow=void 0,this.isWindowInInitState=!1,this.isResettingWindow=!1}activateNotification(e){var t,i,a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{this.sendUserBiActivation(e);const{command:n,dataOptions:a}=e;if(this.startToastActivationScenario(e),!a||!a.userContextId)return void(null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,`${RD}Error activating notification. UserContextId is missing from notifications entity command dataOptions.\n      Therefore, the user rendering context to use to activate this notification cannot be determined.`,"webclient_framework_foundation_core_services_notifications",void 0,!0));const{userContextId:s,actionType:o,callId:r,callingScenarioName:c}=a;this.sendTelemetry({callId:r,callingScenarioName:c,toastScenarioClientId:n.correlation.id,stepName:WD(o)});const l=this.waitForRenderingContextReady(!1,s),d=yield l;return yield fF({activeWindowsService:this.activeWindowsService,coreSettings:this.coreSettings,renderingContext:d,isHostCommandNotification:!0,handlerCommand:e,logger:this.logger,notificationUserContextId:s,appsRegistryService:this.appsRegistryService,logPrefix:RD}),this.addStepToToastActivationScenario(e),d.commandHandler(e)}catch(e){return void(null===(s=(a=this.logger).errorToTelemetry)||void 0===s||s.call(a,`${RD}Errored while activating notification:${e.message}`,"webclient_framework_foundation_core_services_notifications",void 0,!0))}}))}resizeNotificationsWindow({windowFeatures:e}){var t,i,a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this.notificationsWindowId&&this.notificationsWindow&&e){const{width:n,height:a}=e;this.logger.log(`${RD}Attempting to resize the notifications window to width= ${n} height= ${a}. windowId= ${this.notificationsWindowId}`);const{enableCustomNotificationsWindowReset:s}=this.coreSettings.get(S.J.Core);0!==n&&0!==a?this.isWindowInInitState=!1:0!==n||0!==a||this.isWindowInInitState||this.isResettingWindow||!s||(this.isResettingWindow=!0,yield this.removeNotificationsWindow(),yield this.createNotificationsWindow(),this.isResettingWindow=!1);const o=yield null===(t=this.hostCommunicationService)||void 0===t?void 0:t.loadModule("toasts");null===(i=null==o?void 0:o.resizeNotificationsPanel)||void 0===i||i.call(o,n,a)}else null===(s=(a=this.logger).errorToTelemetry)||void 0===s||s.call(a,`${RD}Error resizing the notifications window. notificationsWindowId = ${this.notificationsWindowId} windowFeatures width=${null==e?void 0:e.width}; height=${null==e?void 0:e.height}. window=${void 0!==this.notificationsWindow?"defined":"undefined"}`,"webclient_framework_foundation_core_services_notifications",void 0,!0)}))}focusNotificationsWindow(){var e,t,i,a,s,o;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield null===(e=this.hostCommunicationService)||void 0===e?void 0:e.loadModule("windowcontrols");this.notificationsWindowId?null===(t=null==n?void 0:n.focus)||void 0===t||t.call(n,this.notificationsWindowId):null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,`${RD}Error focusing the notifications window. notificationsWindowId is undefined.`,"webclient_framework_foundation_core_services_notifications",void 0,!0)}catch(e){null===(o=(s=this.logger).errorToTelemetry)||void 0===o||o.call(s,`${RD}Error focusing the notifications window. Loading windowcontrols module failed with: ${e.message}`,"webclient_framework_foundation_core_services_notifications",void 0,!0)}}))}isInAppNotificationsEnabled(e){const{enableInAppNotifications:t,enableInAppNotificationsForCalls:i,enableInAppNotificationsForChatsAndChannels:n}=this.coreSettings.get(S.J.Notifications);return!!t&&this.isToastEntitySupported(!!i,!!n,e)}isCustomNotificationsEnabled(e){const{enableCustomNotificationsOnDesktop:t,enableCustomNotificationsForCalls:i,enableCustomNotificationsForChats:n}=this.coreSettings.get(S.J.Core);return!!t&&this.isToastEntitySupported(!!i,!!n,e)}initializeWithWindow(e,t,i){this.logger.log(`${RD}Initializing notifications handler with notifications windowId=${e}`),this.notificationsWindowId=e,this.notificationsWindow=t,this.client=i,this.isWindowInInitState=!0}sendCommandToHost(e,t,i,n,a){var s,o,r;let c="";c=(0,U.u4)(null===(s=null==n?void 0:n.targetEntity)||void 0===s?void 0:s.dataOptions),this.logger.log(`${RD}Sending toast command to host for display. TargetEntity type: [${null===(o=null==n?void 0:n.targetEntity)||void 0===o?void 0:o.type}] action [${null===(r=null==n?void 0:n.targetEntity)||void 0===r?void 0:r.action}] dataOptions [${c}]`),((e,t,i,n,a,s,o)=>{var r;if(o&&o.remoteAudioNotifications()){const{staticsPath:c}=e.get(S.J.Platform),l=t.id||i;if(n.visibilityState===ve.fe.show){const e=PD(c||void 0,null==s?void 0:s.ringtone),t=null!==(r=null==s?void 0:s.isIncomingCall)&&void 0!==r&&r;t&&o.setLoop(l,t),o.playNotifyAudio(l,e,t),a.log(`VDI: [handleVDIRemotedAudio] Playing remoted audio notification with id: ${l}, loop: ${t}`),s&&!0!==s.isSilent&&(s.isSilent=!0)}else n.visibilityState===ve.fe.hide&&o.pauseNotifyAudio(l)}})(this.coreSettings,i,t,e,this.logger,n,a),this.commandChangeReportingService.report({correlationId:t,type:Ge.B.NotHandled,context:{target:"notificationsHandler",entityCommand:{entity:i,command:Object.assign(Object.assign({},e),{correlation:e.correlation,layoutMode:e.layoutMode||void 0}),entityOptions:n}}})}showPermissionConfirmationBrowserNotification(){MD(this.i18n.stringTranslate("toastNotifications","browser_toast_permission_confirmation_title"),{body:this.i18n.stringTranslate("toastNotifications","browser_toast_permission_confirmation_body")})}tryShowBrowserNotification(e){var t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if("granted"!==Notification.permission)return"skippedNoPermissions";const{suppressBrowserToastWhenAppIsFocused:a}=this.coreSettings.get(S.J.Notifications,["suppressBrowserToastWhenAppIsFocused"]);if(a&&BD(this.mainWindow))return"skippedAppInFocus";const s=e.getWebToastOptions(),{notificationTitle:o,notificationOptions:r}=e.getNotificationOptionsPayload();try{const t=MD(o,r),i=()=>t;return e.registerGetNotificationCallback(i),null==t||t.addEventListener("click",(()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){this.addBrowserNotificationScenarioStep(s,z.ck.BrowserToastActivated),yield this.activateBrowserToast(s)})))),this.addBrowserNotificationScenarioStep(s,z.ck.BrowserToastRequested),Promise.resolve("queued")}catch(e){return null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,`${LD} Show browser notification toast failed.`,"webclient_framework_foundation_core_services_notifications",void 0,!0),Promise.resolve("skippedReasonUnknown")}}))}sendTelemetry(e){const{callId:t,callingScenarioName:i,reason:n,stepName:a,toastScenarioClientId:s}=e,o=t||"",r=this.scenarioFactory.findScenarioByNameAndId(i,o),c=this.scenarioFactory.findScenarioByNameAndId(z.RG.WebToastShow,s),l=this.scenarioFactory.findScenarioByNameAndId(z.RG.CrossClientToastView,s);null==r||r.mark(a),null==c||c.mark(a),null==l||l.mark(a),UD.includes(a)&&(null==c||c.stop({reason:n}),null==l||l.stop({reason:n}),r&&r.name===z.RG.MeetingStartedNotification&&r.stop())}sendDismissToastTelemetry({correlationId:e,toastType:t,reason:i}){const n=this.scenarioFactory.newScenario(z.RG.ToastActivation,{clientId:e});n.appendEventData({isCustomNotification:!0,mainEntityType:t}),n.stop({reason:i})}offsetNotificationsWindow(e){var t;null===(t=this.hostCommunicationService)||void 0===t||t.loadModule("toasts").then((t=>{var i,n,a,s;if(t){if(t.offsetNotificationsPanel)return t.offsetNotificationsPanel(e);null===(s=(a=this.logger).errorToTelemetry)||void 0===s||s.call(a,`${RD}toasts.offsetNotificationsPanel method not available`,"webclient_framework_foundation_core_services_notifications",void 0,!0)}else null===(n=(i=this.logger).errorToTelemetry)||void 0===n||n.call(i,`${RD}Cannot load toasts module to offset the notifications window. updating windows cache with newly created notifications window`,"webclient_framework_foundation_resolvers_notifications",void 0,!0)}))}sendUserBiActivation(e){uF(this.userBiService,this.logger,e,!0)}addStepToToastActivationScenario(e){const t=this.scenarioFactory.findScenarioByNameAndId(z.RG.ToastActivation,e.command.correlation.id);if(t){const i=e.command.stateTransition===ve.su.new?z.ck.StateTransitionNotOverriden:z.ck.StateTransitionOverriden;t.mark(i)}}startToastActivationScenario(e){const{command:t}=e,i=t.correlation.startTimestamp?+t.correlation.startTimestamp:void 0;this.scenarioFactory.newScenario(z.RG.ToastActivation,{startTime:i,clientId:t.correlation.id}).appendEventData({isCustomNotification:!0,mainEntityType:e.entity.type})}addBrowserNotificationScenarioStep(e,t){const{crossClientScenarioName:i}=e,n=e.callId||"",a=this.scenarioFactory.findScenarioByNameAndId(i,n);null==a||a.mark(t)}removeNotificationsWindow(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.notificationsWindow&&this.client&&(null===(e=this.notificationsWindow)||void 0===e||e.close(),yield this.client.mutate({mutation:DD,fetchPolicy:"no-cache"}),this.notificationsWindowId=void 0,this.notificationsWindow=void 0,this.isWindowInInitState=!1)}))}createNotificationsWindow(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){!this.notificationsWindow&&this.client&&(yield this.client.mutate({mutation:AD,fetchPolicy:"no-cache"}))}))}isToastEntitySupported(e,t,i){var n;return(null===(n=null==i?void 0:i.targetEntity)||void 0===n?void 0:n.type)===p.dt.calls?e:t}}const WD=e=>{switch(e){case"AcceptIncomingCallContentOnly":return z.ck.AcceptIncomingCallContentOnly;case"AcceptIncomingCallWithAudio":return z.ck.AcceptIncomingCallWithAudio;case"AcceptIncomingCallWithVideo":return z.ck.AcceptIncomingCallWithVideo;case"AcceptIncomingCallThroughPrejoin":return z.ck.AcceptIncomingCallThroughPrejoin;case"AcceptIncomingScreenshareOnlyCall":return z.ck.AcceptIncomingScreenshareOnlyCall;case"IgnoreIncomingCall":return z.ck.IgnoreIncomingCall;case"RejectIncomingCall":return z.ck.RejectIncomingCall;case"ReplyIncomingCall":return z.ck.ReplyIncomingCall;case"NavigateToCallTab":return z.ck.NavigateToCallTab;case"ResumeCallTransfer":return z.ck.ResumeCallTransfer;default:return`${e}Clicked`}},BD=e=>e.document.hasFocus();class zD extends Ue{constructor(){super(h.Yg.CreateNotificationsHandlerTask,["activeWindowsService","appsRegistryService","commandChangeReportingService","coreSettings","hostCommunicationService","loggerFactory","scenarioFactory","waitForRenderingContextReady","windowProvider","userBiService","i18n"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{activeWindowsService:t,appsRegistryService:i,commandChangeReportingService:n,coreSettings:a,hostCommunicationService:s,loggerFactory:o,scenarioFactory:r,waitForRenderingContextReady:c,windowProvider:l,userBiService:d,i18n:u}=e;e.notificationsHandler=new $D(t,c,s,a,n,l,r,i,d,o,u)}))}}class HD{constructor(e){this.userAgent=e,this.UAParser=Xr.getParser(e)}getBrowser(){switch(this.UAParser.getBrowserName()){case"Microsoft Edge":return Ps.AR.Edge;case"Safari":return Ps.AR.Safari;case"Chrome":return Ps.AR.Chrome;case"Firefox":return Ps.AR.Firefox;case"Electron":return Ps.AR.Electron;default:return Ps.AR.Unknown}}getVendor(){var e,t;return(null===(t=null===(e=this.UAParser.getPlatform())||void 0===e?void 0:e.vendor)||void 0===t?void 0:t.toString())||""}getOSDetails(){const e=this.UAParser.getOS();return{name:null==e?void 0:e.name,version:null==e?void 0:e.version,versionName:null==e?void 0:e.versionName}}getBrowserVersion(){return this.UAParser.getBrowserVersion()}getRingConfig(e=At.s.prod,t){switch(t){case"ring0_gcc":t="ring0",e=At.s.gcc;break;case"general_gcc":t="general",e=At.s.gcc}return{ring:t,environment:e}}getOsPlatform(){const e=this.getOsOverride();if(null!=e)return e;switch(this.UAParser.getOSName()){case"Windows":return Ps.NR.Windows;case"macOS":return Ps.NR.Mac;case"Linux":return Ps.NR.Linux;case"Chrome OS":return Ps.NR.ChromeOS;case"Android":return Ps.NR.Android;case"iOS":return Ps.NR.IOS;case"Windows Phone":return Ps.NR.WindowsPhone;default:return Ps.NR.Unknown}}getOSPlatformVersion(){var e,t;return(null===(t=null===(e=this.host)||void 0===e?void 0:e.deviceInfo)||void 0===t?void 0:t.osVersion)||this.UAParser.getOSVersion()}getOsOverride(){return null}getPlatformId(e,t){let i=this.getClientType(e,t);const n=this.getMetaOsPlatformId(e);return n||(i===Ps.Bh.Desktop&&this.getOsPlatform()===Ps.NR.Mac&&(i="Mac"),i=`${i[0].toUpperCase()}${i.substr(1)}`,Ps.us[i])}getMetaOsPlatformId(e){var t;switch(null===(t=null==e?void 0:e.metaoshost)||void 0===t?void 0:t.toLowerCase()){case"office":return Ps.us.MetaOsOffice;case"outlook":return Ps.us.MetaOsOutlook}return null}getClientType(e,t){let i=e&&e.host;if(!i&&t){const e="host";i=t.localStorage.getItem(e)||""}return"outlookDesktop"===i?Ps.Bh.Desktop:"outlookWeb"===i?Ps.Bh.Web:this.getBrowser()===Ps.AR.Electron?Ps.Bh.Desktop:Ps.Bh.Web}getCpuArchitecture(){let e;const t=/x\d{2}_\d{2}|(i[3-6]86|x\d{2}|amd\d{2}|wow\d{2}|arm\d{2}|arm|ARM|aarch\d{2}|ppc\d{2}|ppc\d{2}le)|Intel|Android\s+\d+\.\d+\.\d+;\s*(\S+)/;try{e=this.userAgent.match(t)}catch(e){return""}return(null==e?void 0:e[0])||""}}class qD extends HD{constructor(e,t,i,n,a){super(i.navigator.userAgent),this.loggerFactory=e,this.routingServices=t,this.windowHost=i,this.hostSettings=n,this.getPlatformConfigurationOverrides=a,this.logger=this.loggerFactory.newLogger("PlatformService","core-services-platform"),this.queryStringParameters=this.routingServices.state.getSearchState()||{},this.headConfig=(0,lx.pf)(this.windowHost,this.logger),this.cachedConfig=this.computeConfig(),this.cachedEcsOverrides=this.computeEcsOverrides()}get config(){return this.cachedConfig}get ecsOverrides(){return this.cachedEcsOverrides}get host(){var e,t;const i=null===(t=null===(e=this.windowHost.loader)||void 0===e?void 0:e.getProperties)||void 0===t?void 0:t.call(e);return Object.assign({bootType:(null==i?void 0:i.bootType)||v.Unknown,deviceId:(null==i?void 0:i.deviceId)||St.get("deviceId"),deviceInfo:null==i?void 0:i.deviceInfo,hostAppVersion:(0,lx.nU)(this.windowHost),sessionId:(null==i?void 0:i.sessionId)||St.get("sessionId"),preAuthUserId:null==i?void 0:i.preAuthUserId},this.windowHost.getHostedWindowContext())}getOsOverride(){return this.windowHost.localStorage.getItem("platformOverride")}computeConfig(){var e,t,i,n,a;let s={};this.getPlatformConfigurationOverrides&&(s=this.getPlatformConfigurationOverrides(this.windowHost,this.queryStringParameters)),this.logger.log(`IPlatformConfiguration overrides: ${JSON.stringify(s)}`);const o=this.getBrowser(),r=null!==(e=s.clientType)&&void 0!==e?e:this.getClientType(this.queryStringParameters,this.windowHost),c=this.determinePlatformId(s);this.logger.log(`Determined PlatformID to be '${c}'`);const l=this.getHostingParent(),d=this.windowHost.__VERSION__,u=`${c}/${d}`,m=this.windowHost.__webpack_public_path__,g=this.getVendor(),h=this.getOSDetails(),p=this.getCpuArchitecture();let v="https://statics.teams.cdn.office.net";try{m&&(v=new URL(m).origin)}catch(e){this.logger.warn(`Failed to parse dynamic staticsPath origin from '${m}'`)}const f=this.windowHost.navigator.language||"en-us",b=null===(t=this.windowHost.loaderConfig)||void 0===t?void 0:t.pullRequestId,y=null===(i=this.windowHost.loaderConfig)||void 0===i?void 0:i.buildId;return this.logger.log(`PlatformService: configuring with clientVersion: ${u}`),{browser:o,browserVersion:this.getBrowserVersion(),buildType:(0,lx.Cu)(u),buildVersion:d,clientContext:this.getClientContext(l),clientType:r,clientVersion:u,cpuArchitecture:p,currentUrl:null===(a=null===(n=this.windowHost)||void 0===n?void 0:n.location)||void 0===a?void 0:a.href,hostingParent:l,isInCypressFrame:this.getIsInCypressFrame(),isInIframe:this.getIsInIframe(),isInternalUser:this.headConfig.isInternalUser,osDetails:h,osPlatform:this.getOsPlatform(),osVersion:this.getOSPlatformVersion(),platformId:c,publicPath:m,staticsPath:v,userAgent:this.userAgent,userLanguage:f,vdi:s.vdi,vendor:g,getLocaleInfoAsync:this.windowHost.getLocaleInfoAsync,pullRequestId:b,buildId:y}}determinePlatformId(e){var t,i,n,a,s,o,r,c,l,d,u;const m=e.platformId,g=null===(i=null===(t=this.hostSettings)||void 0===t?void 0:t.hostSettings)||void 0===i?void 0:i.platformId;if(null===(a=(n=this.logger).logNoPii)||void 0===a||a.call(n,`Potential PlatformID sources: experienceOverrides='${m}', hostSettings='${g}', qsp='${JSON.stringify(this.queryStringParameters)}', windowHostHost='${null===(s=this.windowHost)||void 0===s?void 0:s.localStorage.getItem("host")}'`),m)return null===(r=(o=this.logger).logNoPii)||void 0===r||r.call(o,"Using PlatformID value from experience overrides"),m;if(g){const e=parseInt(g,10);if(e)return null===(l=(c=this.logger).logNoPii)||void 0===l||l.call(c,"Using PlatformID value from host settings"),e}return null===(u=(d=this.logger).logNoPii)||void 0===u||u.call(d,"Using PlatformID value from QSP/WindowHost/Browser"),this.getPlatformId(this.queryStringParameters,this.windowHost)}getHostUrl(){const e=this.windowHost.localStorage.getItem("ecsHostUrl")||this.headConfig.ecsHostUrl;if(e)return new URL(e,this.windowHost.location.origin).href}computeEcsOverrides(){const e=this.getHostUrl(),t=this.getEnvironmentOverride()||(0,lx.zj)(this.windowHost,this.headConfig),i=(0,B.get)(At.s,t),n=this.getRingOverride(),{originalRing:a,unauthenticated:s}=this.headConfig,o=void 0===a||a===n;return Object.assign(Object.assign({hostUrl:e},this.getRingConfig(i,n)),{originalRing:a,unauthenticated:s,isAssignedRing:o})}getEnvironmentOverride(){if(this.queryStringParameters.webinarRing)return this.queryStringParameters.webinarRing}getRingOverride(){if(this.headConfig.isInternalUser&&this.queryStringParameters.ring)return this.queryStringParameters.ring;const e=this.windowHost.getHostedWindowContext();if(null==e?void 0:e.ring)return e.ring;const{ring:t}=this.headConfig;return t?"string"==typeof t?t:t.id:void 0}getHostingParent(){const e=(0,lx.f2)(this.windowHost);return e&&e.dataset&&"outlook"===e.dataset.host?Ps.GJ.Outlook:Ps.GJ.Unknown}getClientContext(e){return e===Ps.GJ.Outlook?Ps.RY.Embed:void 0}getIsInIframe(){return!!this.windowHost.getHostedWindowContext().isInIframe}getIsInCypressFrame(){return!!this.windowHost.getHostedWindowContext().isInCypressFrame}}class VD extends Ue{constructor(){super(h.Yg.CreatePlatform,["windowProvider","loggerFactory","routingServices"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:i,routingServices:n,hostSettings:a,getPlatformConfigurationOverrides:s}=e;e.platformService=new qD(i,n,t,a,s)}))}}var GD=i(422325),JD=i(375823);const KD="Profiler:: ";var QD,YD;!function(e){e.LoadModuleProfilerFailed="LoadModuleProflierFailed",e.ExecuteCommandFailed="ExecuteCommandFailed"}(QD||(QD={})),function(e){e.LoadModuleProfilerSuccess="LoadModuleProfilerSuccess",e.ExecuteCommandSuccess="ExecuteCommandSuccess"}(YD||(YD={}));class XD{constructor(e,t,i){this.hostCommunicationService=t,this.coreSettings=i,this.logger=e.newLogger("ProfilerService","services-io-profiler"),this.exposeToCoreWindow()}getMemoryData(){var e,t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=(null===(t=null===(e=this.coreSettings.get(S.J.Telemetry).heartbeatConfiguration)||void 0===e?void 0:e.workerMetricsCollection)||void 0===t?void 0:t.enabled)||!1,n=yield(0,GD.K)(this.hostCommunicationService,i);return(0,JD.Mv)(n.processes)}))}getHeapSnapshot(e=!0){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.getProfilerModuleAsync();if(!i)return;e&&(yield this.requestTriggerGC());const n=yield null===(t=i.getHeapSnapshot)||void 0===t?void 0:t.call(i);return(null==n?void 0:n.snapshot)?n.snapshot:void 0}))}getMemoryTracing(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getProfilerModuleAsync();if(!t)return;const i=yield null===(e=t.getMemoryTracing)||void 0===e?void 0:e.call(t,{duration:5e3});return(null==i?void 0:i.data)?i.data:void 0}))}requestTriggerGC(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getProfilerModuleAsync();if(!t)return!1;const i=yield null===(e=t.triggerGC)||void 0===e?void 0:e.call(t);return!!(null==i?void 0:i.status)}))}startMemoryTracing(e=!0){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.getProfilerModuleAsync();if(!i)return!1;e&&(yield this.requestTriggerGC());const n=yield null===(t=i.startMemoryTracing)||void 0===t?void 0:t.call(i);return!!(null==n?void 0:n.status)}))}stopMemoryTracing(e=!0){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.getProfilerModuleAsync();if(!i)return;e&&(yield this.requestTriggerGC());const n=yield null===(t=i.stopMemoryTracing)||void 0===t?void 0:t.call(i);return(null==n?void 0:n.data)?n.data:void 0}))}getProfilerModuleAsync(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let e;try{e=yield this.hostCommunicationService.loadModule("profiler"),this.logger.log(`${KD}${YD.LoadModuleProfilerSuccess}`)}catch(e){this.logger.error(`${KD}${QD.LoadModuleProfilerFailed} ${(0,U.u4)(e)}`)}return e}))}exposeToCoreWindow(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.hostCommunicationService.loadModule("profiler"),t=yield this.hostCommunicationService.loadModule("heartbeat");e&&t?globalThis.window.profiler=Object.assign(Object.assign({},e),{getMemoryData:()=>this.getMemoryData(),getHeapSnapshot:(e=!1)=>this.getHeapSnapshot(e),getTotalWorkingSetSizeBytes:()=>this.getWorkingSetSizeFromProcesses(null==t?void 0:t.getPerfMetrics),getTotalCommitSizeBytes:()=>this.getCommitSizeFromProcesses(null==t?void 0:t.getPerfMetrics)}):this.logger.log("HostComms is unable to load profiler and/or heartbeat module. We are running on Web or Teams 1.0. Bailing out.")}))}getWorkingSetSizeFromProcesses(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(e){const t=yield e();return null==t?void 0:t.reduce(((e,t)=>(e.workingSetSizeBytes+=t.workingSetSizeBytes,e)),{workingSetSizeBytes:0}).workingSetSizeBytes}return this.logger.warn("Unable to get perf metrics."),-1}))}getCommitSizeFromProcesses(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(e){const t=yield e();return null==t?void 0:t.reduce(((e,t)=>(e.pageFileUsageBytes+=t.pageFileUsageBytes,e)),{pageFileUsageBytes:0}).pageFileUsageBytes}return this.logger.warn("Unable to get perf metrics."),-1}))}}class ZD extends Ue{constructor(){super(h.Yg.CreateProfiler,["loggerFactory","hostCommunicationService","coreSettings"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){e.profilerService=new XD(e.loggerFactory,e.hostCommunicationService,e.coreSettings)}))}}class eA{constructor(e,t,i,n,a,s,o,r,c,d){this.loggerFactory=e,this.host=t,this.clientStateProvider=i,this.networkStateProvider=n,this.platformService=a,this.hostCommunicationService=r,this.localStorage=c,this.scenarioFactory=d,this.cleanupOnRebootArray=[],this.expChangeSubscription=null,this.lcChangeSubscription=null,this.clientStateSubscription=null,this.isRunningJobsInLongInactive=!1,this.rebootPending=void 0,this.registerCleanupCallback=e=>{this.cleanupOnRebootArray.push(e)},this.didUrlChange=e=>(0,Os.IC)(e)!==(0,Os.IC)(this.host.location.href),this.areMaxRetriesExhausted=(e,t)=>{if(null==t?void 0:t.maxRetries){const i=this.getRetryStorageKey(e),n=this.localStorage.get(i,"Experience"),a=n&&parseInt(n,10)||0;this.logger.debug(`Reboot retry count for '${e}': ${a}`);const s=a>=t.maxRetries;return this.localStorage.set(i,`${a+1}`,"Experience"),s&&this.logger.warn(`Max retries exhausted for '${e}', retryCount: ${a}, maxRetries: ${t.maxRetries}`),s}return!1},this.getRetryStorageKey=e=>`rebootRetries.${e}`,this.logger=this.loggerFactory.newLogger("rebootService","core-services-reboot"),this.expChangeSubscription=s.observeChanges().pipe((0,l.U)((e=>{this.isExperienceIdleStateChangedEvent(e)&&(this.isRunningJobsInLongInactive=!0)}))).subscribe(),this.lcChangeSubscription=o.observeChanges().pipe((0,l.U)((({context:e})=>{const{target:t,reportedChange:i}=e;if(this.isRunningJobsInLongInactive&&t===_x.UserLifeCycleManager&&this.isExperienceIdleStateChangedEvent(i)&&(this.isRunningJobsInLongInactive=!1,this.rebootPending)){this.host.clearTimeout(this.timeoutId),this.logger.log("Core finished running App jobs in LongInactive client state. Issuing pending reboot now...");const{reason:e,commandSource:t,options:i}=this.rebootPending;this.rebootApp(e,t,i)}}))).subscribe()}rebootApp(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(yield this.cleanupBeforeReboot(),this.logger.log(`Reboot app triggered for ${e} from ${t} with options: ${(0,U.u4)(i)}`),this.areMaxRetriesExhausted(t,i))return!1;try{this.dispose();const n=this.scenarioFactory.findScenario(z.RG.ClientStart);null==n||n.incomplete({commandSource:t,reason:e});const a=this.getReloadUrl(i,t,e);this.platformService.config.clientType===Ps.Bh.Maglev?yield this.rebootThroughDesktopApi(a,t,e,"reboot_maglev_request"):this.platformService.config.clientType===Ps.Bh.Desktop&&e===bo.Z.AuthTokenForceRefresh?yield this.rebootThroughDesktopApi(a,t,e,"reboot_t1_request"):this.didUrlChange(a)?this.host.location.replace(a):this.host.location.reload()}catch(e){return this.logger.error("Reboot app failed"),!1}return!0}))}rebootWhenLongInactive(e,t,i){return this.clientStateSubscription?(this.logger.log(`Reboot subscription already exist, skip the subscription from ${t} with reason ${e}`),!1):(this.logger.log(`Reboot when longInactive is subscribed from ${t} with reason ${e}`),this.clientStateSubscription=this.clientStateProvider.observe().subscribe((n=>this.handleClientStateChange(n,e,t,i))),!0)}clearRetryCount(e){this.localStorage.remove(this.getRetryStorageKey(e),"Experience")}dispose(){var e,t,i;this.isRunningJobsInLongInactive=!1,this.rebootPending=void 0,this.timeoutId&&(this.host.clearTimeout(this.timeoutId),this.timeoutId=void 0),null===(e=this.clientStateSubscription)||void 0===e||e.unsubscribe(),this.clientStateSubscription=null,null===(t=this.expChangeSubscription)||void 0===t||t.unsubscribe(),this.expChangeSubscription=null,null===(i=this.lcChangeSubscription)||void 0===i||i.unsubscribe(),this.lcChangeSubscription=null}cleanupBeforeReboot(){var e,t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n,a,s;for(;n=this.cleanupOnRebootArray.pop();)try{yield n("restart")}catch(e){a=a?a.concat(`${n.toString()}::${(0,U.u4)(e)}`):`${n.toString()}::${(0,U.u4)(e)}::`}a&&(s=new ze.G(ze.$.CLEANUP,new Error(a)),null===(t=(e=this.logger).errorToTelemetry)||void 0===t||t.call(e,`${s.code}${null===(i=s.prevError)||void 0===i?void 0:i.message}`,"webclient_framework_foundation_core_services",void 0,!0))}))}rebootThroughDesktopApi(e,t,i,a){var s,o,r,c,l,d,u;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("core");if(!n)return void(null===(o=(s=this.logger).errorToTelemetry)||void 0===o||o.call(s,"HostComms is unable to load core module.",a,void 0,!0));const m=`${i}; source: ${bo.d[t]}`;null===(c=(r=this.logger).infoToTelemetry)||void 0===c||c.call(r,m,a,void 0,!0);try{yield null===(l=n.relaunch)||void 0===l?void 0:l.call(n,{url:e,reason:m})}catch(e){null===(u=(d=this.logger).errorToTelemetry)||void 0===u||u.call(d,`${m} PIE API call failed`,a,void 0,!0)}}))}handleClientStateChange(e,t,i,n){this.networkStateProvider.getState()===dr.G.Online?(this.logger.log(`Handling clientState change to ${e}.`),e===$e.pk.LongInactive&&(this.rebootPending={reason:t,commandSource:i,options:n},this.isRunningJobsInLongInactive?this.waitForRunningJobsAndReboot():this.rebootApp(t,i,n))):this.logger.log(`Reboot skipped, network state is offline when client state change to ${e}.`)}getReloadUrl(e,t,i){var n;const a=new URL((null==e?void 0:e.customUrl)||this.host.location.href),s=a.searchParams;(null===(n=null==e?void 0:e.qsps)||void 0===n?void 0:n.hasOwnProperty("clearcontainer"))&&s.delete("container"),s.delete("tenantId"),a.hash=this.getReloadHash(t,i,a.hash);const o=(null==e?void 0:e.qsps)||{};return Object.keys(o).forEach((e=>{s.set(e,o[e])})),a.toString()}getReloadHash(e,t,i){if(this.platformService.config.clientType===Ps.Bh.Maglev){const n=Oo(i);let a;if(n.deepLink===fo.n0.core)a=fo.n0.core;else switch(e){case bo.d.WebClientUpdateService:a=fo.n0.core;break;case bo.d.ReloadAppTask:a=!n.deepLink||n.deepLink===fo.n0.flyout||t!==bo.Z.RingSwitch&&t!==bo.Z.HighMemory?fo.n0.default:encodeURIComponent(n.deepLink);break;default:a=fo.n0.default}return`deepLink=${a}&source=${bo.d[e]}`}return""}waitForRunningJobsAndReboot(){this.logger.log("Pending a reboot while waiting for Core to finish running App jobs in LongInactive client state. timeout=2000 ms"),this.timeoutId=this.host.setTimeout((()=>{if(this.host.clearTimeout(this.timeoutId),this.rebootPending){this.logger.log("Timeout waiting for Core to finish running App jobs in LongInactive client state. Rebooting now...");const{reason:e,commandSource:t,options:i}=this.rebootPending;this.rebootApp(e,t,i)}}),2e3)}isExperienceIdleStateChangedEvent(e){return e.type===Mt.yU.ExperienceIdleStateChanged&&e.context.isIdle}}class tA extends Ue{constructor(){super(h.Yg.CreateReboot,["clientState","experienceChangeReportingService","hostCommunicationService","lifeCycleScopeChangeReportingService","localStorage","loggerFactory","networkState","platformService","scenarioFactory","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{clientState:t,experienceChangeReportingService:i,hostCommunicationService:n,lifeCycleScopeChangeReportingService:a,localStorage:s,loggerFactory:o,networkState:r,platformService:c,scenarioFactory:l,windowProvider:d}=e;e.rebootService=new eA(o,d,t,r,c,i,a,n,s,l)}))}}class iA extends Ue{constructor(){super(h.Yg.CreateRelayDataClient,["cdlWorkerService","coreSettings","loggerFactory","userBiService"])}execute(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!e.coreSettings.get(S.J.SimpleCollab).enableSimpleCollabApp&&!e.coreSettings.get(S.J.TeamsAndChannels).enableUserOnboardingToTeam)return;const n=e.loggerFactory.newLogger("relay","data-client-core"),a=yield null===(t=e.cdlWorkerService)||void 0===t?void 0:t.getDataLayerClient();if(!a)return void n.error("[init] Data layer client not available");const{Environment:s,Observable:o,LiveResolverStore:r,RecordSource:c,RelayFeatureFlags:l}=yield(0,Rl.mT)((()=>i.e(83801).then(i.t.bind(i,586455,23))),"relay-data-client");l.ENABLE_RELAY_RESOLVERS=!0,l.ENABLE_CLIENT_EDGES=!0,e.relayEnvironment=new s({store:new r(new c),network:{execute:(t,i,s,r)=>{var c,l;return function(e,t,i,n,a,s){const o=t.text;if(!o){const e=`[${t.name}] Request text not available for operation`;return a.error(e),s.create((t=>t.error(new Error(e))))}return s.create((s=>e.executeWithQueryText(t.operationKind,o,i,t.name,void 0,n,void 0).subscribe({next:e=>{e.errors&&a.error(`[${t.name}] Request execution errors: `,e.errors),s.next(e)},error:e=>{a.error(`[${t.name}] Request operation error: `,e),s.error(e)},complete:s.complete})))}(a,t,i,null===(l=null===(c=e.userBiService)||void 0===c?void 0:c.getWindowId)||void 0===l?void 0:l.call(c),n,o)}}})}))}}var nA=i(557868),aA=i(778452);class sA extends Ue{constructor(){super(h.Yg.CreateRouting,[])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=e.config.forceUseBrowserHistory||!e.windowProvider||""===e.windowProvider.location.hash?(0,nA.lX)({basename:e.config.basePath}):(0,nA.q_)({basename:e.config.basePath});e.history=t,e.routingServices=(0,aA.I)(e.loggerFactory,e.history,e.windowProvider&&e.windowProvider.location)}))}}class oA{constructor(e,t){this.statsPerIdMap=new Map,this.startTimeMap=new Map,this.telemetryReportInterval=0,this.globalStats={maxInQueueTaskCount:0,totalLatencyTime:0,executedTaskCount:0,maxLatency:0,reportSequence:0,queueSize:0},this.logger=e.newLogger("PostTaskSchedulerDiagnosticsService","core-services-scheduling"),this.host=t}subscribeToCoreSettings(e){e.getObservable(S.J.Core,["schedulerTelemetryIntervalMS"]).subscribe((e=>{if(e.schedulerTelemetryIntervalMS){const t=e.schedulerTelemetryIntervalMS;this.telemetryReportInterval!==t&&(this.telemetryReportInterval=t,this.initializeTelemetryReporter(t))}}))}markTaskEnqueued(e,t){this.startTimeMap.set(e,performance.now());let i=this.statsPerIdMap.get(t);i||(i={executedTaskCount:0,maxLatency:-1,totalLatencyTime:0,totalLatencyTimeThisReport:0}),this.statsPerIdMap.set(t,i),this.globalStats.queueSize++,this.globalStats.queueSize>this.globalStats.maxInQueueTaskCount&&(this.globalStats.maxInQueueTaskCount=this.globalStats.queueSize)}markTaskDequeued(e,t){const i=this.statsPerIdMap.get(t),n=this.startTimeMap.get(e);if(!n)return;this.startTimeMap.delete(e),this.globalStats.executedTaskCount++,this.globalStats.queueSize--;const a=Math.round(performance.now()-n);this.globalStats.totalLatencyTime+=a,a>this.globalStats.maxLatency&&(this.globalStats.maxLatency=a),i&&(i.totalLatencyTime+=a,i.totalLatencyTimeThisReport+=a,i.executedTaskCount++,a>i.maxLatency&&(i.maxLatency=a))}initializeTelemetryReporter(e){this.clearTelemetryInterval(),e>=6e4&&(this.telemetryIntervalId=this.host.setInterval((()=>this.reportTelemetry()),e))}clearTelemetryInterval(){this.telemetryIntervalId&&(this.host.clearInterval(this.telemetryIntervalId),this.telemetryIntervalId=0)}reportTelemetry(){var e,t;0!==this.globalStats.maxInQueueTaskCount&&(null===(t=(e=this.logger).infoToTelemetry)||void 0===t||t.call(e,"send-log-to-console-and-diagnostics","webclient_framework_foundation_post_task_scheduler_diagnostics",{maxSchedulerWaitLatency:this.globalStats.maxLatency,maxSchedulerQueueSize:this.globalStats.maxInQueueTaskCount,totalTaskWaitLatency:this.globalStats.totalLatencyTime,totalExecutedTaskCount:this.globalStats.executedTaskCount,sequence:this.globalStats.reportSequence}),this.statsPerIdMap.forEach(((e,t)=>{var i,n;null===(n=(i=this.logger).infoToTelemetry)||void 0===n||n.call(i,`send-log-to-console-and-diagnostics-${t}`,"webclient_framework_foundation_post_task_scheduler_diagnostics",{maxSchedulerWaitLatency:e.maxLatency,totalTaskWaitLatency:e.totalLatencyTime,totalExecutedTaskCount:e.executedTaskCount,sequence:this.globalStats.reportSequence}),e.totalLatencyTimeThisReport=0})),this.globalStats.reportSequence++)}}class rA extends Ue{constructor(){super(h.Yg.CreateSchedulerTask,["schedulerChangeReporting","loggerFactory","diagnosticsService","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{diagnosticsService:t,loggerFactory:i,schedulerChangeReporting:n,windowProvider:a}=e,s=new oA(i,a),o=new Pa(n,window,i,h.QU,s);e.postTaskSchedulerDiagnosticsService=s,e.scheduler=o,t.setScheduler(o)}))}}class cA{constructor(e,t,i,a,s,o,r,c){this.experienceChangeReportingService=e,this.commandChangeReportingService=t,this.appsRegistryService=i,this.scheduler=a,this.hostComms=s,this.userKey=o,this.context=r,this.activeWindowsService=c,this.mainWindowDisplayedChange={windowId:null,eventFired:!1},this.processExperienceChangeChange=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){e.type===Mt.yU.UserConsentedToConsumeResources&&(this.layoutRenderedChange&&(this.layoutRenderedChange=void 0),this.userConsentedChange=e),e.type===Mt.FV.LayoutRenderComplete&&!0===e.isMainWindow&&(this.layoutRenderedChange=e),this.tryToSendSignal()})),this.onWindowVisibilityChanged=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t;const i=yield this.isMainWindowForActiveUserContext(e.windowId);if(!e.visible||this.mainWindowDisplayedChange&&(null===(t=this.mainWindowDisplayedChange)||void 0===t?void 0:t.eventFired))e.visible||(i&&(this.mainWindowDisplayedChange.windowState=yield this.getWindowState(e.windowId)),this.mainWindowDisplayedChange.eventFired=!1,this.mainWindowDisplayedChange.windowId=null);else{if(!i)return;this.mainWindowDisplayedChange.windowId=e.windowId,this.tryToSendSignal()}}))}init(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.experienceChangeReportingServiceSubscription=this.experienceChangeReportingService.observeChanges().pipe((0,u.h)((e=>e.userContextId===this.userKey))).subscribe(this.processExperienceChangeChange),this.commandChangeReportingServiceSubscription=this.commandChangeReportingService.observeChanges().pipe((0,u.h)((e=>e.userContextId===this.userKey&&!!e.isMainWindow&&e.type===Ge.B.WindowCreated&&e.context.layoutMode===ve.lO.standard))).subscribe((e=>{this.mainWindowRenderedChange=e,this.tryToSendSignal()}));const t=yield this.hostComms.loadModule("windowcontrols");this.windowVisibilityChangeSubscription=null===(e=null==t?void 0:t.registerForWindowVisibilityChanged)||void 0===e?void 0:e.call(t,this.onWindowVisibilityChanged)}))}dispose(){this.experienceChangeReportingServiceSubscription&&this.experienceChangeReportingServiceSubscription.unsubscribe(),this.commandChangeReportingServiceSubscription&&this.commandChangeReportingServiceSubscription.unsubscribe(),this.windowVisibilityChangeSubscription&&this.windowVisibilityChangeSubscription()}tryToSendSignal(){if(!this.shouldSendSignal())return;const e=this.appsRegistryService.registeredApps;this.scheduler.schedule((()=>{e.forEach((e=>{e.UNSAFE_onSignal&&e.UNSAFE_onSignal({type:"main_window_rendered",userContextId:this.userKey},this.context)}))}),{id:"on-signal-job",priority:Z.vW.Macro,scheduledById:"signal-processor"},(0,qe.v4)()),this.reset()}isMainWindowForActiveUserContext(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=this.activeWindowsService.enableDecoupleCommandingFromApollo?this.activeWindowsService.getStandardMainWindow():yield(0,Lo.jW)(this.context.client);return e===(null==t?void 0:t.id)&&t.userContextId===this.userKey}))}getWindowState(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostComms.loadModule("windowcontrols");return null===(t=null==i?void 0:i.getWindowState)||void 0===t?void 0:t.call(i,e)}))}shouldSendSignal(){return this.windowHasBeenCreatedAndSignalsHaveFired()||this.windowHasToggledVisibilityAndWasNotMinimizedOrRestored()}windowHasBeenCreatedAndSignalsHaveFired(){return!!this.userConsentedChange&&!!this.mainWindowRenderedChange&&!!this.layoutRenderedChange}windowHasToggledVisibilityAndWasNotMinimizedOrRestored(){return!(!this.userConsentedChange||!this.mainWindowDisplayedChange.windowId||this.mainWindowDisplayedChange.eventFired||this.windowWasMinimized())}windowWasMinimized(){var e;return!0===(null===(e=this.mainWindowDisplayedChange.windowState)||void 0===e?void 0:e.minimized)}reset(){this.mainWindowRenderedChange=void 0,this.layoutRenderedChange=void 0,this.mainWindowDisplayedChange.eventFired=!0}}class lA extends Ue{constructor(){super(h.Yg.CreateSignalProcessor,["activeWindowsService","appsRegistryService","experienceChangeReportingService","client","coreSettings","entityCommanding","loggerFactory","platformService","scenarioFactory","scheduler","hostCommunicationService","commandChangeReportingService","authenticationUser","userBiService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{activeWindowsService:t,appsRegistryService:i,experienceChangeReportingService:n,client:a,coreSettings:s,entityCommanding:o,loggerFactory:r,platformService:c,scenarioFactory:l,scheduler:d,hostCommunicationService:u,commandChangeReportingService:m,authenticationUser:g,userBiService:h}=e,p=new cA(n,m,i,d,u,(0,He.b4)(g),{client:a,coreSettings:s,entityCommanding:o,loggerFactory:r,platformService:c,scenarioFactory:l,userBiService:h},t);return p.init(),()=>{p.dispose()}}))}}var dA=i(990489);class uA extends Ue{constructor(){super(h.Yg.CreateShortcutExecutionServiceTask,[])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){e.shortcutExecutionService=new dA.T}))}}class mA{constructor(e){this._loggerFactory=e,this._logger=this._loggerFactory.newLogger("app-wide-shortcut-registry","core-shortcut-service"),this._registeredShortcuts=[]}addAppWideShortcut(e,t,i,n){this._logger.log(`Adding application wide shortcut for command ${t} and shortuct ${e}. ${this._registeredShortcuts.length} shortcuts active`),this._registeredShortcuts=this._registeredShortcuts.filter((t=>t.hotkey!==e)),this._registeredShortcuts.push({commandId:t,commandHandler:i,hotkey:e,windowId:n}),this._logger.log(`Added app wide shortcutfor command ${t} and hotkey ${e}. ${this._registeredShortcuts.length} shortcuts active`)}removeAppWideShortcut(e){this._logger.log(`Removing app wide shortcutfor commandId ${e}. ${this._registeredShortcuts.length} shortcuts active`),this._registeredShortcuts=this._registeredShortcuts.filter((t=>t.commandId!==e)),this._logger.log(`Removed app wide shortcut for command ${e}. ${this._registeredShortcuts.length} shortcuts active`)}getAppWideShortcutHandler(e){var t;return null===(t=this._registeredShortcuts.find((t=>t.hotkey===e)))||void 0===t?void 0:t.commandHandler}destroy(e){this._registeredShortcuts=this._registeredShortcuts.filter((t=>t.windowId!==e))}}class gA{constructor(e,t){this._loggerFactory=e,this._hostCommunicationService=t,this._logger=this._loggerFactory.newLogger("global-shortcut-registry","core-shortcut-service"),this._registeredGlobalShortcuts=[]}addGlobalShortcut(e,t,i){var a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=(e=>e.windows)(e),o=0===this._registeredGlobalShortcuts.length;this._logger.log(`Adding global shortcut for command ${t} and shortuct ${n}. ${this._registeredGlobalShortcuts.length} shortcuts active`);const r=yield this._hostCommunicationService.loadModule("globalshortcuts");if(!r)return;const c=this._registeredGlobalShortcuts.filter((e=>e.keys===n));if(c.length>0){this._logger.log("Global shortcut already registered, removing");for(const e of c)yield null===(a=null==r?void 0:r.removeGlobalShortcut)||void 0===a?void 0:a.call(r,e.shortcutId),this._logger.log(`Removed global shortcut for command ${t} and shortuct ${n}`),this._registeredGlobalShortcuts=this._registeredGlobalShortcuts.filter((t=>t.shortcutId!==e.shortcutId))}const l=yield null===(s=null==r?void 0:r.addGlobalShortcut)||void 0===s?void 0:s.call(r,e);return l&&(this._registeredGlobalShortcuts.push({commandId:t,shortcutId:l,commandHandler:i,keys:n}),this._logger.log(`Added global shortcut for command ${t} and shortuctId ${l}. ${this._registeredGlobalShortcuts.length} shortcuts active`),o&&(this._logger.log("First global shortcut added, registering callback"),yield this.registerForGlobalShortcutActivated())),l}))}removeGlobalShortcut(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){this._logger.log(`Removing global shortcut for commandId ${e}. ${this._registeredGlobalShortcuts.length} shortcuts active`);const i=this._registeredGlobalShortcuts.filter((t=>t.commandId===e));i.length>0&&(this._removeGlobalShortcuts(i),this._logger.log(`Removed ${i.length} global shortcut for command ${e}. ${this._registeredGlobalShortcuts.length} shortcuts active`)),0===this._registeredGlobalShortcuts.length&&(this._logger.log("Last global shortcut removed, disposing registration"),null===(t=this._disposeGlobalShortcutActivatedEventRegistration)||void 0===t||t.call(this),this._disposeGlobalShortcutActivatedEventRegistration=void 0)}))}registerForGlobalShortcutActivated(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this._disposeGlobalShortcutActivatedEventRegistration)return;const t=yield this._hostCommunicationService.loadModule("globalshortcuts");t&&(this._disposeGlobalShortcutActivatedEventRegistration=null===(e=null==t?void 0:t.registerForGlobalShortcutActivated)||void 0===e?void 0:e.call(t,(e=>this._handleGlobalShortcut(e))))}))}cleanup(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this._disposeGlobalShortcutActivatedEventRegistration&&(this._disposeGlobalShortcutActivatedEventRegistration(),this._disposeGlobalShortcutActivatedEventRegistration=void 0),yield this._removeGlobalShortcuts(this._registeredGlobalShortcuts),this._registeredGlobalShortcuts=[]}))}_removeGlobalShortcuts(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield this._hostCommunicationService.loadModule("globalshortcuts");if(i)for(const n of e)this._logger.log(`Removing global shortcut for commandId ${n.commandId} with keys ${n.keys}`),yield null===(t=null==i?void 0:i.removeGlobalShortcut)||void 0===t?void 0:t.call(i,n.shortcutId),this._logger.log(`Removed global shortcut for command ${n.commandId}`),this._registeredGlobalShortcuts=this._registeredGlobalShortcuts.filter((e=>e.shortcutId!==n.shortcutId))}))}_handleGlobalShortcut(e){const t=this._registeredGlobalShortcuts.find((t=>t.shortcutId===e));t?(this._logger.debug(`Executing command handler for global shortcut: ${t.commandId} / ${t.shortcutId}`),t.commandHandler()):this._logger.warn(`Can't execute global shortcut with id ${e}. No record found.`)}}class hA{constructor(e,t,i,n){this._hostCommunicationService=e,this._loggerFactory=t,i&&(this._appWideShortcutRegistry=new mA(t)),n&&(this._globalShortcutRegistry=new gA(this._loggerFactory,this._hostCommunicationService))}addAppWideShortcut(e,t,i,n){var a;null===(a=this._appWideShortcutRegistry)||void 0===a||a.addAppWideShortcut(e,t,i,n)}removeAppWideShortcut(e){var t;null===(t=this._appWideShortcutRegistry)||void 0===t||t.removeAppWideShortcut(e)}getAppWideShortcutHandler(e){var t;return null===(t=this._appWideShortcutRegistry)||void 0===t?void 0:t.getAppWideShortcutHandler(e)}addGlobalShortcut(e,t,i){var a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){return null===(a=this._globalShortcutRegistry)||void 0===a?void 0:a.addGlobalShortcut(e,t,i)}))}removeGlobalShortcut(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){return null===(t=this._globalShortcutRegistry)||void 0===t?void 0:t.removeGlobalShortcut(e)}))}registerForGlobalShortcutActivated(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){return null===(e=this._globalShortcutRegistry)||void 0===e?void 0:e.registerForGlobalShortcutActivated()}))}destroy(e){var t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){null===(t=this._appWideShortcutRegistry)||void 0===t||t.destroy(e),"global"===e&&(yield null===(i=this._globalShortcutRegistry)||void 0===i?void 0:i.cleanup())}))}}class pA extends Ue{constructor(){super(h.Yg.CreateShortcutRegistryServiceTask,["coreSettings","hostCommunicationService","loggerFactory"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,hostCommunicationService:i,loggerFactory:n}=e,a=null==t?void 0:t.get(S.J.Shortcuts),{enableAppWideShortcuts:s,enableGlobalShortcuts:o}=a||{enableAppWideShortcuts:!1,enableGlobalShortcuts:!1},r=new hA(i,n,!!s,!!o);return e.shortcutRegistryService=r,e=>{switch(e){case"quit":case"signout":return r.destroy("global");default:return}}}))}}class vA{constructor(e,t=""){e.debug("Initialized telemetry context service for "+(t?"user":"default context")),this.userId=t,this._telemetryProvider=(0,Hi.G)()}initialize(e){e.debug("Initialized telemetry context service"),this._telemetryProvider=(0,Hi.G)()}setContext(e,t,i,n=""){this._telemetryProvider.setContext(e,t,i,n||this.userId)}setCoreContext(e,t,i){this._telemetryProvider.setContext(e,t,i)}setDeviceAuthToken(e){this._telemetryProvider.setDeviceAuthToken(e)}setUserId(e){this.userId=e}setPrimaryUser(e,t){this._telemetryProvider.setPrimaryUser(e,t)}}class fA extends Ue{constructor(){super(h.Yg.TelemetryContext,["loggerFactory"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=e.loggerFactory.newLogger("CreateTelemetryContextTask","core-services-tasks");e.telemetryContextService=new vA(t)}))}}var bA=i(186921);class yA{constructor(e){this.authenticationService=e,this._userContextIds=new Set,this._accountModeObservable=new s.X(fN.SingleAccount)}init(){this._syncWithAuthServicePromise||(this._syncWithAuthServicePromise=this.syncWithAuthenticationService())}getAuthenticatedUsers(){return this._userContextIds}has(e){return this._userContextIds.has(e)}getAccountMode(){return this._accountModeObservable.value}getAccountModeObservable(){return this._accountModeObservable.pipe((0,er.x)())}syncWithAuthenticationService(){var e,t,i,a,s,o;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(((yield null===(o=(s=this.authenticationService).getCachedUsers)||void 0===o?void 0:o.call(s,{id:Ve()(),scenarioName:z.RG.AuthWebCachedUser,source:"UserTrackingService::syncWithAuthenticationService"},{isAllCachedUsers:!0}))||[]).forEach((e=>{this._userContextIds.add((0,He.b4)((0,He.KQ)(e)))})),this.updateExperienceAccountMode(),this.authenticationService.getUsersIterator)try{for(var r,c=!0,l=(0,n.__asyncValues)(this.authenticationService.getUsersIterator({isAllCachedUsers:!0}));r=yield l.next(),!(e=r.done);){a=r.value,c=!1;try{const e=a;this._userContextIds.clear(),e.forEach((e=>{this._userContextIds.add((0,He.b4)((0,He.KQ)(e)))})),this.updateExperienceAccountMode()}finally{c=!0}}}catch(e){t={error:e}}finally{try{c||e||!(i=l.return)||(yield i.call(l))}finally{if(t)throw t.error}}}))}updateExperienceAccountMode(){const e=this._userContextIds.size>1?fN.MultipleAccounts:fN.SingleAccount;bA.q.log(`[updateExperienceAccountMode] to: ${fN[e]}`),this._accountModeObservable.next(e)}}class kA extends Ue{constructor(){super(h.Yg.CreateTrackUserServiceTask,["authenticationService","coreSettings"])}execute(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{authenticationService:i,coreSettings:n}=e,a=new yA(i);(null===(t=n.get(S.J.Core))||void 0===t?void 0:t.initializeMTMAModeOnStartup)&&a.init(),e.userTrackingService=a}))}}class SA extends Ue{constructor(){super(h.Yg.CreateUserDataClient,["scenarioFactory","loggerFactory","windowProvider","coreSettings","client"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!e.client)throw new Error("CreateUserDataClientTask: core data client doesn't exist, cannot initialize user client");const t=yield function(e,t,i){var a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{networkState:n,coreSettings:s,leakDetectorService:o,platformService:r,config:c,graphqlStoreStatsReporterService:l}=e,d=new Ip.pS,u=(0,_l.UZ)(Dr.l,n.observeIsOnline()),m=Object.assign(Object.assign({},e),{pubsub:d,send:u}),g=RS.clientResolvers;if(!g)throw new Error("Client resolvers should be created at this point");const{maxApolloResultCacheSize:p,enableViewSchema:v,enableApolloDoubleWriteFix:f}=s.get(S.J.Core),{enableApolloDevtools:b}=s.get(S.J.Diagnostics),y=null!=p?p:void 0,k=null==o?void 0:o.create(),w=(null==e?void 0:e.authenticationUser)&&(0,He.b4)(e.authenticationUser),j=lN({leakDetector:k,userContextId:w,windowId:h.ew,entityType:i,viewportContext:"cmd"},void 0,g,y,e.loggerFactory,e.scenarioFactory,void 0,b,_p.cmd,l,f);qp(j,`mtma-cmd-${(null===(a=null==e?void 0:e.authenticationUser)||void 0===a?void 0:a.loginUserName)||"nouser"}`,Boolean(b),r,c.experienceName);const C=oN.createUserDataRequestContext(m,j),_=yield qv.createLink(Object.assign({contextValue:C},m));j.setLink(_);const T=cN(e,d,k,_,e.loggerFactory,e.scenarioFactory,g,w);let I;v&&(I=dN(e,0,k,qv.createViewSchemaLink(e),e.loggerFactory,e.scenarioFactory));const{dataOpsTracker:N,dataEvictionService:E}=t.getServices();return new $S({pubsub:d,leakDetector:k,scenarioFactory:C.scenarioFactory,coreSettings:C.coreSettings,dataOpsTracker:N,dataEvictionService:E,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},t,T,C,I)}))}(e,e.client,xe.pyR.default);return e.client=t,e=>{switch(e){case"signout":case"quit":t.destroy()}}}))}}const wA=12e4,jA={"cdl-request":!0};var CA=i(125374);class _A{constructor(){this._isPaused=!1,this._startTime=0,this._reason=h.jK.Unknown,this._totalPauseTime=0,this._lastPauseLength=0}get paused(){return this._isPaused}get totalPauseDuration(){return this._totalPauseTime}pause(e,t={},i=void 0){this._isPaused||(this._reason=e,this._startTime=this.getTime(t),this._data=i,this._isPaused=!0)}resume(e={}){if(this._isPaused){const t=this.getTime(e)-this._startTime;this._lastPauseLength=t,this._totalPauseTime+=this._lastPauseLength}return this._isPaused=!1,{startTime:this._startTime,totalTime:this._lastPauseLength,eventData:this._data,reason:this._reason,monitoringData:void 0}}getTime(e={}){const{overrideTimestamp:t,offsetCurrentTimeInMs:i}=e;return(null!=t?t:Date.now())+(null!=i?i:0)}}class TA{constructor(e,t,i={}){this.name=e,this.id=t,this.excludedTimings=i,this.previousMark=""}markPerformanceApi(e,t=""){if(performance&&performance.mark&&performance.measure&&this.shouldMark(this.name)){const i=`${e} ${this.name}-${this.id}`;if(performance.mark(i),e===z.ck.Stop){let e=`start ${this.name}-${this.id}`;0===(performance.getEntriesByName(e,"mark")||[]).length&&(e="navigationStart");const n=[this.name,t&&`(${t})`].join(" ");performance.measure(n,e,i)}this.previousMark&&performance.measure(`${this.name} [${this.previousMark} <=> ${e}]`,`${this.previousMark} ${this.name}-${this.id}`,i),this.previousMark=e}}shouldMark(e){return!(e in this.excludedTimings)||this.excludedTimings[e]}}class IA{constructor(e,t,i,n,a,s,o=(0,qe.v4)(),r=z.t7.Expanded,c="",l={}){this.name=e,this.clientId=t,this._eventData=i,this._timingData=n,this.startTime=a,this.timeoutMs=s,this.id=o,this.scenarioMode=r,this.userContextId=c,this.crossAccountScenarioOptions=l,this.previousStep=z.ck.Unknown,this.sequence=1,this.active=!0,this.onStopCallbacks=[],this.__stepsPerfInfo__=[],this._testingMode=!1,this._steps=[],this._stepsEx=[],this.userIds=new Set,this.pauseTracker=new _A,this.currentStep=z.ck.Unknown,this.timestamps=[],this.intervalTimestamp=a,this.performanceMarker=new TA(this.name,this.id,jA)}addPackedData(e,t){this._steps=this._steps.concat(e.map((e=>JSON.parse(e)))),this._stepsEx=this._stepsEx.concat(t.map((e=>JSON.parse(e))))}updateTimestamp(e,t){this.timingData[e]=t}addOnStopCallback(e){this.onStopCallbacks.push(e)}get timingData(){return this._timingData}get testingMode(){return this._testingMode}set testingMode(e){this._testingMode=e}get isPaused(){return this.pauseTracker.paused}get eventData(){return this._eventData}get steps(){return this._steps}get stepsEx(){return this._stepsEx}get elapsed(){return this.calculateElapsed(Date.now())}get stepDelta(){return this.calculateStepDelta(Date.now())}get delta(){return this.calculateDelta(Date.now())}get isHoisted(){return!1}syncToState(e){this.previousStep=e.previousStep,this.intervalTimestamp=e.lastTimestamp,this.sequence=e.lastSequence}setCrossClientObservables(e){const t=e.mark.subscribe((e=>{this.mark(e.step,e.eventData,e.status)})),i=e.stop.subscribe((e=>{this.stop(e.eventData,e.status)})),n=e.appendEventData.subscribe((e=>{this.appendEventData(e.eventData)}));this.subscriptions={mark:t,stop:i,appendEventData:n}}appendEventData(e){this._eventData=Object.assign(Object.assign({},this._eventData),e)}pause(e){var t;null===(t=this.timer)||void 0===t||t.pause();const{reason:i,overrideTimestamp:a,offsetCurrentTimeInMs:s}=e,o=(0,n.__rest)(e,["reason","overrideTimestamp","offsetCurrentTimeInMs"]);this.pauseTracker.pause(i,{overrideTimestamp:a,offsetCurrentTimeInMs:s},o),this.currentStep!==z.ck.Unknown&&this.mark(this.currentStep)}resume(e={}){var t;null===(t=this.timer)||void 0===t||t.resume();const i=this.pauseTracker.resume({overrideTimestamp:e.overrideTimestamp,offsetCurrentTimeInMs:e.offsetCurrentTimeInMs});this.mark(z.ck.Pause,Object.assign(Object.assign({pauseReason:i.reason},i.eventData),e))}cancel(e={}){this.stop(e,"abandoned")}mark(e,t={},i="success"){if(!this.canMark())return;this.currentStep=z.ck.Unknown;const{overrideTimestamp:a,offsetCurrentTimeInMs:s}=t,o=(0,n.__rest)(t,["overrideTimestamp","offsetCurrentTimeInMs"]),r=this.getBaseTimestamp(a,s),{delta:c,stepDelta:l,elapsed:d}=this.getBaseScenarioTimingData(r,t),u=e,m={"Scenario.Mode":this.scenarioMode,"Scenario.Name":this.name,"Scenario.Status":i,"Scenario.Step":u,InstanceId:this.id,sequence:this.sequence,delta:c,elapsed:d,stepDelta:l};let g;if(t=Object.assign(Object.assign({},this.eventData),o),this.scenarioMode===z.t7.Packed&&(this.prepareAndStorePackedSteps(m),this.createStepsExEntry(o),u===z.ck.Stop&&(m["Scenario.Steps"]=JSON.stringify(this._steps),g={columnName:"Scenario.StepsEx",packedData:this._stepsEx})),this.scenarioMode===z.t7.Expanded||u===z.ck.Stop)if(this.isCrossAccountScenario)for(const e of this.userIds)(0,Q.Yx)(this.name,t,this.finalizeScenarioData(r,m),void 0,g,e);else(0,Q.Yx)(this.name,t,this.finalizeScenarioData(r,m),void 0,g,this.userContextId);this.performanceMarker.markPerformanceApi(u,this.clientName),this._testingMode&&this.__stepsPerfInfo__.push({name:u,delta:c,stepDelta:l,status:i}),this.updateScenarioStatePostMark(u,r)}stop(e={},t="success"){var i;null===(i=this.timer)||void 0===i||i.stop(),this.currentStep!==z.ck.Unknown&&this.mark(this.currentStep,void 0,t),this.mark("stop",Object.assign({previousStep:this.previousStep},e),t),this.active=!1,this.subscriptions&&(this.subscriptions.appendEventData.unsubscribe(),this.subscriptions.mark.unsubscribe(),this.subscriptions.stop.unsubscribe()),this.onStopCallbacks.forEach((e=>e()))}fail(e={}){this.stop(e,"failure")}incomplete(e={}){this.stop(e,"incomplete")}startStep(e){const t=e;this.currentStep!==z.ck.Unknown&&t!==this.currentStep&&this.mark(this.currentStep),this.currentStep=t}markAggregateStart(e){}markAggregateStop(e){}getTotalPauseDuration(){return 0}getPackedSteps(){return this._steps}addUser(e){this.userIds.add(e)}removeUser(e){this.userIds.delete(e)}canMark(){return this.active&&!this.pauseTracker.paused}get isCrossAccountScenario(){return!!this.crossAccountScenarioOptions.enabled&&!!this.userIds.size}finalizeScenarioData(e,t){const i=t;return i.elapsedSinceCoreInit=this.calculateElapsedSinceCoreInit(e),i}getBaseScenarioTimingData(e,t){return{delta:"number"==typeof t.delta?t.delta:this.calculateDelta(e),elapsed:"number"==typeof t.elapsed?t.elapsed:this.calculateElapsed(e),stepDelta:"number"==typeof t.stepDelta?t.stepDelta:this.calculateStepDelta(e)}}getBaseTimestamp(e,t){return(null!=e?e:Date.now())+(null!=t?t:0)}calculateElapsedSinceCoreInit(e){return this.timingData.coreInitTime?e-this.timingData.coreInitTime:void 0}calculateDelta(e){return e-this.startTime-this.pauseTracker.totalPauseDuration}calculateElapsed(e){return e-this.timingData.scenarioFactoryStartTime}calculateStepDelta(e){return e-this.intervalTimestamp}prepareAndStorePackedSteps(e){const t={"Scenario.Status":e["Scenario.Status"],"Scenario.Step":e["Scenario.Step"],delta:e.delta,elapsed:e.elapsed,sequence:e.sequence,stepDelta:e.stepDelta,previousStep:e.previousStep};this._steps.push(t)}updateScenarioStatePostMark(e,t){this.intervalTimestamp=t,this.previousStep=e,this.sequence++}createStepsExEntry(e){this.stepsEx.push((0,B.cloneDeep)(Object.assign(Object.assign({},this.eventData),e))||{})}}const NA=e=>e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.name]:t.value})),{});class EA{constructor(e,t,i,n,a={},s="",o=[]){this.timingData=e,this.logger=t,this.factoryFunctions=i,this.finalizeLegacyCrossClient=n,this.telemetryModeLookUp=a,this.userContextId=s,this.noPureScenarioCreationList=o,this.scenarioCreated$=new _i.xQ,this.scenarioStopped$=new Ti.y,this.scenarioMarked$=new Ti.y,this.appendEventData$=new Ti.y}loadCallbacks(e){if(e.marks){const{registerForScenarioStop:t,registerForScenarioMark:i,registerForScenarioStart:n}=e.marks;this.scenarioMarked$=new Ti.y((e=>{i(((t,i,n)=>{const a={step:i,status:n,scenarioName:t.scenarioName,eventData:NA(t.eventData),clientId:t.clientId};e.next(a)}))})),this.scenarioStopped$=new Ti.y((e=>{t(((t,i)=>{const n={step:"stop",status:i,scenarioName:t.scenarioName,eventData:NA(t.eventData),clientId:t.clientId};e.next(n)}))})),n(((e,t)=>this.onReceivedScenarioStart(e,t)))}if(e.appendEventData){const{appendEventData:t}=e;this.appendEventData$=new Ti.y((e=>{t((t=>e.next({scenarioName:t.scenarioName,clientId:t.clientId,eventData:NA(t.eventData)})))}))}}loadExistingScenarios(e){e.forEach((e=>this.OnExistingScenario(e)))}onReceivedScenarioStart(e,t){var i,n;const a=this.factoryFunctions.findScenarioByNameAndId(e.scenarioName,e.clientId);if(a)this.logger.debug(`Creating mark observable for existing scenario: name=${e.scenarioName}, clientid=${e.clientId}`),a.appendEventData({"Scenario.CrossClientMode":"existing"}),null===(i=a.setCrossClientObservables)||void 0===i||i.call(a,this.createObservablesForScenario(e.scenarioName,e.clientId));else{const i=this.factoryFunctions.findScenario(e.scenarioName);i?(this.logger.debug(`Creating mark observable for existing scenario (by name): name=${e.scenarioName}, clientid=${e.clientId}`),i.appendEventData({"Scenario.CrossClientMode":"existing"}),null===(n=i.setCrossClientObservables)||void 0===n||n.call(i,this.createObservablesForScenario(e.scenarioName,e.clientId))):this.onStartScenario(e,t)}}onStartScenario(e,t){var i,n,a;const s=e.scenarioName,o=t.time.getTime(),r=NA(e.eventData);if(this.noPureScenarioCreationList.includes(s))return void(null===(n=(i=this.logger).warnToTelemetry)||void 0===n||n.call(i,`Existing scenario not found for scenario which is found in the noPureScenarioCreationList: name=${s}`,"telemetry_instrumentation_pure_cross_client_scenario_blocked",{reason:s}));const c=this.createNewCrossClient(s,e.clientId,r,o,e.timeout,(0,qe.v4)(),null!==(a=this.telemetryModeLookUp[s])&&void 0!==a?a:z.t7.Expanded);c.appendEventData({"Scenario.CrossClientMode":"pure"}),c.addOnStopCallback((()=>{this.factoryFunctions.clearScenario(c)})),c.setCrossClientObservables(this.createObservablesForScenario(c.name,c.clientId)),this.scenarioCreated$.next(c)}OnExistingScenario(e){var t,i,n,a,s,o;const r=null!==(t=e.clientId)&&void 0!==t?t:"",c=NA(null!==(i=e.eventData)&&void 0!==i?i:[]),l=this.createNewCrossClient(e.name,r,c,e.creationTime.time.getTime(),null!==(n=e.timeout)&&void 0!==n?n:wA,e.id,null!==(a=e.scenarioMode)&&void 0!==a?a:z.t7.Expanded);l.addPackedData(null!==(s=e.steps)&&void 0!==s?s:[],null!==(o=e.stepsEx)&&void 0!==o?o:[]),l.appendEventData({"Scenario.CrossClientMode":"transferred"}),l.addOnStopCallback((()=>{this.factoryFunctions.clearScenario(l)}));const d=this.finalizeLegacyCrossClient;if(d&&l.addOnStopCallback((()=>{d({scenarioName:l.name})})),l.setCrossClientObservables(this.createObservablesForScenario(l.name,l.clientId)),e.lastMarkStep){const t={previousStep:e.lastMarkStep,lastTimestamp:e.lastMarkTime.time.getTime(),lastSequence:e.sequence};l.syncToState(t)}this.scenarioCreated$.next(l),this.logger.debug(`Created scenario from previous client: name=${e.name}, clientid=${r}`)}createObservablesForScenario(e,t){const i=this.scenarioStopped$.pipe((0,u.h)((i=>i.scenarioName===e&&i.clientId===t)),(0,CA.q)(1));return{mark:this.scenarioMarked$.pipe((0,u.h)((i=>i.scenarioName===e&&i.clientId===t)),(0,u.h)((e=>-1===["stop","start"].indexOf(e.step))),(0,Si.R)(i)),stop:i,appendEventData:this.appendEventData$.pipe((0,u.h)((i=>i.scenarioName===e&&i.clientId===t)),(0,Si.R)(i))}}createNewCrossClient(e,t,i,n,a,s,o){return new IA(e,t,i,this.timingData,n,a,s,o,this.userContextId)}}class FA{constructor(e){this._name=e}get id(){return"noop"}get name(){return this._name}get delta(){return 0}get timeoutMs(){return 0}get eventData(){return{}}set eventData(e){}get timestamps(){return[]}get isPaused(){return!1}set isHoisted(e){}get isHoisted(){return!1}appendEventData(e){}pause(e){}resume(e){}cancel(e){}mark(e,t,i){}startStep(e){}stop(e,t){}fail(e){}incomplete(e){}markAggregateStart(e){}markAggregateStop(e){}getTotalPauseDuration(){return 0}setCrossClientMarkObservables(e){}setCoreInitTime(e){}addUser(e){}removeUser(e){}}const xA="Scenario.Step";class DA{constructor(e,t,i,n,a,s,o,r,c,l=!1,d=!1,u=z.t7.Expanded,m=0,g,h,p,v,f="",b={},y=-1){var k,S,w;this._id=e,this._name=t,this.scenarioFactory=a,this.logger=s,this.timeout=o,this.callback=r,this.memoryAnalyzer=c,this.markStepsInTrace=l,this.showAllConsoleLogs=d,this.scenarioMode=u,this._sequence=m,this.reportActivity=g,this.hostCommunicationService=h,this.crossClientOptions=p,this.clientId=v,this.userContextId=f,this.crossAccountScenarioOptions=b,this.scenarioPackedDataLimit=y,this.steps=[],this.stepsEx=[],this.__stepsPerfInfo__=[],this.performanceMarksToCleanup=[],this.userIds=new Set,this.getTotalPauseDuration=()=>this.pauseInfo.totalTime,this._currentStep=z.ck.Unknown,this._previousStep=z.ck.Unknown,this._timestamps=[],this._isHoisted=!1,this.active=!0,this.pauseInfo={reason:"",startTime:0,totalTime:0,eventData:void 0,monitoringData:void 0};let j=0;const{overrideTimestamp:C,offsetCurrentTimeInMs:_}=n;C?j=C-Date.now():_&&(j=-_),this._eventData=i,this._absoluteStartTime=Date.now()+j,this.intervalTimestamp=this.relativeTimestamp=this.scenarioFactory.timestamp({isCrossClient:null===(k=this.crossClientOptions)||void 0===k?void 0:k.enabled})+j,this.memoryDataInitial=null===(S=this.memoryAnalyzer)||void 0===S?void 0:S.snapshotMemoryUsage(),(null===(w=this.crossClientOptions)||void 0===w?void 0:w.enabled)&&this.syncStateToCrossClientStart(this.crossClientOptions)}get id(){return this._id}get name(){return this._name}get absoluteStartTime(){return this._absoluteStartTime}get delta(){return this.scenarioFactory.timestamp()-this.relativeTimestamp}get timeoutMs(){return this.timeout}set timeoutMs(e){this.timeout=e}get eventData(){return this._eventData}set eventData(e){this._eventData=e}get timestamps(){return this._timestamps}get currentStep(){return this._currentStep}get isPaused(){return!!this.pauseInfo.startTime}set isHoisted(e){this._isHoisted=e}get isHoisted(){return this._isHoisted}appendEventData(e){this.eventData=Object.assign(Object.assign({},this.eventData),e)}markAggregateStart(e){this.active?this.isPaused?this.logger.debug(`[Scenario]${this.name} - ignoring aggregated start step [${e}] due to paused state`):(this.aggregateStepStartTime||(this.aggregateStepStartTime={}),this.aggregateStepStartTime[e]||(this.aggregateStepStartTime[e]=performance.now())):this.logger.debug(`[Scenario]${this.name} - ignoring aggregated start step [${e}] due to inactive`)}markAggregateStop(e){this.active&&this.aggregateStepStartTime[e]&&(this.aggregateStepTotalTime||(this.aggregateStepTotalTime={}),this.aggregateStepTotalTime[e]||(this.aggregateStepTotalTime[e]=0),this.aggregateStepTotalTime[e]+=performance.now()-this.aggregateStepStartTime[e],this.aggregateStepStartTime[e]=void 0)}pause(e,t){var i;if(!this.active||this.isPaused)return;null===(i=this.timer)||void 0===i||i.pause(),this._currentStep!==z.ck.Unknown&&this.mark(this._currentStep);const{reason:a,overrideTimestamp:s}=e,o=(0,n.__rest)(e,["reason","overrideTimestamp"]),r=null!=s?s:Date.now();this.startStep(z.ck.Pause),this.pauseInfo=Object.assign(Object.assign({},this.pauseInfo),{reason:a,startTime:r,eventData:o,monitoringData:t})}resume(e,t){var i;if(!this.active||!this.isPaused)return;null===(i=this.timer)||void 0===i||i.resume();const{overrideTimestamp:n}=null!=e?e:{},a=(0,B.isNumber)(n)?n:Date.now(),s=this.pauseInfo.startTime?a-this.pauseInfo.startTime:0;this.pauseInfo.totalTime=(this.pauseInfo.totalTime||0)+s,this.mark(z.ck.Pause,Object.assign(Object.assign({pauseReason:this.pauseInfo.reason},this.pauseInfo.eventData),e),void 0,t||this.pauseInfo.monitoringData),this._currentStep=z.ck.Unknown,this.pauseInfo.reason="",this.pauseInfo.startTime=0}stop(e,t="success",i){var n;this._currentStep!==z.ck.Unknown&&this.mark(this._currentStep,void 0,t,i),this.aggregateStepTotalTime&&((0,B.each)(Object.keys(this.aggregateStepTotalTime),(e=>{const t=parseInt(this.aggregateStepTotalTime[e].toString(),10);this.mark(e,{stepDelta:t},void 0,i)})),this.aggregateStepTotalTime=null,this.aggregateStepStartTime=null),null===(n=this.timer)||void 0===n||n.stop(),this.createMark(z.ck.Stop,t,!0,e,i).then((()=>{var e;if(this.active&&(this.active=!1),this.markSubscription&&!this.markSubscription.closed&&this.markSubscription.unsubscribe(),this.stopSubscription&&!this.stopSubscription.closed&&this.stopSubscription.unsubscribe(),this.callback&&(this.callback(t),this.callback=void 0),this.hostCommunicationService&&(null===(e=this.crossClientOptions)||void 0===e?void 0:e.enabled)){const e={scenarioName:this.name};this.hostCommunicationService.loadModule("scenario").then((t=>{t&&t.setScenarioCompletion&&t.setScenarioCompletion(e)}))}this.scenarioFactory.clearScenario(this)}))}updateTimestamp(e,t){"coreInitTime"===e&&(this.coreInitTimestamp=t)}fail(e,t){this.stop(e,"failure",t)}cancel(e,t){this.stop(e,"abandoned",t)}incomplete(e,t){this.stop(e,"incomplete",t)}mark(e,t,i="success",n){var a;this.isPaused&&e!==z.ck.Pause?this.logger.debug(`[Scenario]${this.name} - ignoring mark step [${e}] due to paused state`):(this.createMark(e,i,!1,t,n),this._currentStep=z.ck.Unknown,(null===(a=this.crossClientOptions)||void 0===a?void 0:a.enabled)&&this.crossClientOptions.previousStep&&e===z.ck.Start&&(this._previousStep=this.crossClientOptions.previousStep))}startStep(e){this.isPaused?this.logger.debug(`[Scenario]${this.name} - ignoring start step [${e}] due to paused state`):(this._currentStep!==z.ck.Unknown&&e!==this._currentStep&&this.mark(this._currentStep),this._currentStep=e)}setCrossClientObservables(e){this.markSubscription=e.mark.subscribe((e=>this.mark(e.step,e.eventData,e.status))),this.stopSubscription=e.stop.subscribe((e=>{this.stop(e.eventData,e.status)}))}addUser(e){this.userIds.add(e)}removeUser(e){this.userIds.delete(e)}prepareAndSendTelemetry(e,t,i,n){const{overrideTimestamp:a}=e;let s;s=this.eventData&&this.eventData!==e?Object.assign(Object.assign({},this.eventData),e):Object.assign({},e),s.InstanceId=this.id,s.overrideTimestamp=a;const o=this.createScenarioData(s,t,i),r=!!this.scenarioFactory.findScenario(z.RG.WindowLaunchTime);s.isInEst=r;const c=o[xA];if(c!==z.ck.Start){let t;this.scenarioMode!==z.t7.Expanded&&(this.prepareAndStorePackedSteps(o,e),c===z.ck.Stop&&(o["Scenario.Steps"]=JSON.stringify(this.steps),t={columnName:"Scenario.StepsEx",packedData:this.stepsEx})),this.sendScenario(s,o,c,t,n)}return this.logScenarioPerf(o),o}syncStateToCrossClientStart(e){if(e.existingEventData){const t=e.existingEventData.reduce(((e,t)=>Object.assign({[t.name]:t.value},e)),{});this.appendEventData(t)}e.previousStep&&(this._previousStep=e.previousStep),this.intervalTimestamp=this.relativeTimestamp+e.previousStepTimestamp-this._absoluteStartTime,this.active=!0}sendScenario(e,t,i,n,a){if(this.scenarioMode!==z.t7.Packed||i===z.ck.Stop){const s=()=>{if(!this.isCrossAccountScenario)return(0,Q.Yx)(this.name,e,t,a,n,this.userContextId);for(const i of this.userIds)(0,Q.Yx)(this.name,e,t,a,n,i)};i!==z.ck.Stop?s():Promise.all([this.updateEventDataMemory(e)]).then((()=>{s()})).catch((()=>{s()}))}}get isCrossAccountScenario(){return!!this.crossAccountScenarioOptions.enabled&&!!this.userIds.size}prepareAndStorePackedSteps(e,t){if(this.scenarioPackedDataLimit<0||this._sequence<=this.scenarioPackedDataLimit||e["Scenario.Step"]===z.ck.Stop){const i={"Scenario.Status":e["Scenario.Status"],"Scenario.Step":e["Scenario.Step"],delta:e.delta,elapsed:e.elapsed,sequence:e.sequence,stepDelta:e.stepDelta,previousStep:e.previousStep};this.scenarioPackedDataLimit>-1&&this._sequence>this.scenarioPackedDataLimit&&e["Scenario.Step"]===z.ck.Stop&&(i.exceededStepsLimit=!0),this.steps.push(i),this.stepsEx.push((0,B.cloneDeep)(Object.assign(Object.assign({},this.eventData),t))||{})}}logScenarioPerf(e){if(this.showAllConsoleLogs){const t=e[xA],i=e["Scenario.Status"],n=t===z.ck.Start?`[step](${this._sequence})${t}`:t===z.ck.Stop?`[step](${this._sequence})${t} (${e.stepDelta}ms/${e.delta}ms) [status]${i}`:`[step](${this._sequence})${t} (${e.stepDelta}ms)`;this.logger&&this.logger.log(`[Scenario]${this.name} ${n}`),this.__stepsPerfInfo__.push({name:t,stepDelta:e.stepDelta,delta:e.delta,status:i})}}updateEventDataMemory(e){return this.memoryAnalyzer?this.memoryAnalyzer.snapshotMemoryUsageAsync().then((t=>{var i,n,a;t&&(t.jsHeapStatistics&&(e.jsUsedHeapSize=t.jsHeapStatistics.used_heap_size,e.jsUsedHeapSizeDelta=(null===(i=this.memoryDataInitial)||void 0===i?void 0:i.jsHeapStatistics)?this.memoryDataInitial.jsHeapStatistics.used_heap_size-t.jsHeapStatistics.used_heap_size:void 0),t.processMemoryInfo&&(e.workingSet=t.processMemoryInfo.workingSetSize,e.workingSetDelta=(null===(n=this.memoryDataInitial)||void 0===n?void 0:n.processMemoryInfo)?t.processMemoryInfo.workingSetSize-this.memoryDataInitial.processMemoryInfo.workingSetSize:void 0,e.privateBytes=t.processMemoryInfo.privateBytes,e.privateBytesDelta=(null===(a=this.memoryDataInitial)||void 0===a?void 0:a.processMemoryInfo)?t.processMemoryInfo.privateBytes-this.memoryDataInitial.processMemoryInfo.privateBytes:void 0))})):Promise.resolve()}createScenarioData(e,t,i){var n,a;const{overrideTimestamp:s,offsetCurrentTimeInMs:o}=e,r=this.intervalTimestamp;let c;(0,B.isNumber)(s)?(c=this.relativeTimestamp+s-this._absoluteStartTime,e.overrideTimestamp=void 0):o?(c=this.scenarioFactory.timestamp({isCrossClient:null===(n=this.crossClientOptions)||void 0===n?void 0:n.enabled})-o,e.offsetCurrentTimeInMs=void 0):c=i===z.ck.Start?this.relativeTimestamp:this.scenarioFactory.timestamp({isCrossClient:null===(a=this.crossClientOptions)||void 0===a?void 0:a.enabled}),this._timestamps.push(c),this.intervalTimestamp=c;const l=(0,B.isNumber)(e.stepDelta)?e.stepDelta:c-r,d=(0,B.isNumber)(e.delta)?e.delta:c-this.relativeTimestamp-this.getTotalPauseDuration(),u=(0,B.isNumber)(e.elapsed)?e.elapsed:c,m=this._sequence,g="number"==typeof this.coreInitTimestamp?Date.now()-this.coreInitTimestamp:void 0,h=i===z.ck.Stop?this._previousStep:void 0;return{"Scenario.Status":t,"Scenario.Mode":this.scenarioMode,"Scenario.Name":this.name,[xA]:i,InstanceId:this.id,elapsedSinceCoreInit:g,delta:d,elapsed:u,sequence:m,stepDelta:l,previousStep:h}}getMonitoringDataOverride(e){let t=e;return this.name!==z.RG.WindowLaunchTime&&this.name!==z.RG.ExperienceReady||(t=e?(0,B.cloneDeep)(e):{scenarioPriority:"P0",data:[]},t.data.push({key:"App",value:this.eventData.contentSlotApp})),t}createMark(e,t,i,a={},s){var o;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!e||!this.active)return;let n;"reason"in a&&(n=a.reason);const r=this.getMonitoringDataOverride(s);this.markPerformanceApi(this.name,e,n);const c=this.prepareAndSendTelemetry(null!==(o=a)&&void 0!==o?o:{},t,e,r);this.active=this.active&&!i,this.reportActivity&&this.reportActivity(c),this._previousStep=e,this._sequence+=1}))}markPerformanceApi(e,t,i){if(performance&&performance.mark&&performance.measure&&!jA.hasOwnProperty(this.name)){const n=`${t} ${e}-${this.id}`;if(performance.mark(n),this.performanceMarksToCleanup.push(n),this.markStepsInTrace){if(this.previousMark){const i=`${e} [${this.previousMark} <=> ${t}]`,n=`${this.previousMark} ${e}-${this.id}`,a=`${t} ${e}-${this.id}`;performance.measure(i,n,a),performance.clearMeasures(i)}this.previousMark=t}if(t===z.ck.Stop){let t=`start ${e}-${this.id}`;0===(performance.getEntriesByName(t,"mark")||[]).length&&(t="navigationStart");const a=this.clientName?` (${this.clientName})`:"",s=null!=i?i:this.eventData.reason,o=`${e}${a}${s?`-(${s})`:""}`;performance.measure(o,t,n),performance.clearMeasures(o);for(const e of this.performanceMarksToCleanup)performance.clearMarks(e);this.performanceMarksToCleanup=[]}}}}class AA{constructor(e,t){this.scenario=e,this.windowProvider=t,this.timeRemaining=this.scenario.timeoutMs,this.lastUnpausedTimestamp=0}start(){this.timerIsRunning()||(this.timeRemaining=this.scenario.timeoutMs),this.resume()}pause(){this.timerIsRunning()&&(this.windowProvider.clearTimeout(this.timeoutId),this.timeoutId=void 0,this.timeRemaining-=Date.now()-this.lastUnpausedTimestamp)}resume(){this.timerIsRunning()||(this.lastUnpausedTimestamp=Date.now(),this.timeoutId=this.windowProvider.setTimeout(this.timeoutFunction.bind(this),this.timeRemaining))}stop(){this.windowProvider.clearTimeout(this.timeoutId),this.timeoutId=void 0}reset(){this.stop(),this.start()}timerIsRunning(){return!!this.timeoutId}timeoutFunction(){this.scenario.stop(void 0,"timeout")}}class MA{constructor(e){this.windowProvider=e}addTimerToScenario(e){if(!e.timer){const t=new AA(e,this.windowProvider);e.timer=t,t.start()}}}const PA="scenarioBuffer";class OA{constructor(e,t,i,n,a,s,o=!1,r,c,l,d={},u=""){var m,g,h,p,v,f,b,y,k,w;this.context=e,this.memoryAnalyzer=i,this.windowId=n,this.clientId=a,this.payload=r,this.finalizeLegacyCrossClient=l,this.eventContextData=d,this.userContextId=u,this.crossClientScenarioList=new Set,this.allowedScenarios=new Set,this.scenarioTimeoutMs=wA,this.telemetryModeLookUp={},this.__isTestingMode__=!1,this.__testingBuffer__=[],this.newScenario=(e,t)=>{if(this.isCrossClientScenarioEnabled(e)){let i;if(i=(null==t?void 0:t.clientId)?this.findScenarioByNameAndId(e,t.clientId):this.findScenario(e),i)return i.appendEventData({"Scenario.CrossClientMode":"transferred"}),i}const i=this.createScenarioWithoutStarting(e,t);return i.mark(z.ck.Start,t&&{overrideTimestamp:t.overrideTimestamp},void 0,t&&t.monitoringData),i},this.createScenarioWithoutStarting=(e,t={})=>{var i;if(0===this.factoryTimestamps.scenarioFactoryStartTime||!this.isAllowedScenario(e))return new FA(e);const n=void 0===t.captureMemoryUsage||t.captureMemoryUsage,{userObjectId:a,correlationId:s,commandSource:o,tenantId:r}=this.getContextData(),c=(0,B.cloneDeep)(this.eventContextData);c["Panel.WindowID"]=this.windowId,c["UserInfo.Id"]=a,c["UserInfo.TenantId"]=r,c["EventInfo.CorrelationId"]=s,c.commandSource=o;const l=t.scenarioId||(0,qe.v4)(),{showAllConsoleLogs:d}=this.context.coreSettings.get(S.J.Telemetry),u=this.context.coreSettings.get(S.J.Host).showScenarioStepsInPerfTrace||this.context.coreSettings.get(S.J.Core).showScenarioStepsInPerfTrace,m=this.telemetryModeLookUp?this.telemetryModeLookUp[e]||(this.telemetryModeLookUp["*"]?this.telemetryModeLookUp["*"]:z.t7.Expanded):z.t7.Expanded,g=new DA(l,e,c,{overrideTimestamp:t.startTime},this,this.logger,t.timeoutMs||this.scenarioTimeoutMs,t.callback,n?this.memoryAnalyzer:void 0,!!u,!!d,m,t.sequence||0,this.reportActivity,this.context.hostCommunicationService,t.crossClientOptions,void 0,this.userContextId,this.crossAccountScenarioOptions,this.scenarioPackedDataLimit);e===z.RG.NavigationCommand?g.clientId=null!==(i=t.clientId)&&void 0!==i?i:this.clientId:g.clientId=t.clientId,this.factoryTimestamps.coreInitTime&&g.updateTimestamp("coreInitTime",this.factoryTimestamps.coreInitTime);const h=this.setupScenarioTimeout(g);return this.getActiveScenarios(g.name).push({scenario:g,timeoutId:h}),g},this.cancelExistingAndCreateScenario=(e,t,i,n,a,s)=>{let o=this.findScenario(e);if(o){const e=[{reason:t}];o.cancel({errors:JSON.stringify(e)})}return o=this.newScenario(e,Object.assign(Object.assign({},s),{timeoutMs:i,callback:n,monitoringData:a})),o},this.stopScenarioIfActive=(e,t,i,n)=>{const a=this.findScenario(e);a&&a.stop(t,i,n)},this.markStep=(e,t,i)=>{const n=this.findScenario(e);n&&n.mark(t,i&&i.eventData,i&&i.status,i&&i.monitoringData)},this.startStep=(e,t)=>{const i=this.findScenario(e);i&&i.startStep(t)},this.findScenario=e=>{var t;if(!e)return null;const i=this.activeScenariosMap.get(e);let n=null;i&&(n=(null===(t=(0,B.find)(i,(t=>t&&t.scenario.name===e||t.scenario.clientId===e)))||void 0===t?void 0:t.scenario)||null);const{parentScenarioFactory:a}=this.context;return null==n&&a&&a!==this&&(n=a.findScenario(e)),n},this.findScenarioByNameAndId=(e,t)=>{const i=this.activeScenariosMap.get(e);let n=null,a=null;i&&(n=(0,B.find)(i,(i=>i.scenario.name===e&&i.scenario.clientId===t))||null);const{parentScenarioFactory:s}=this.context;return null==n&&s&&s!==this&&(a=s.findScenarioByNameAndId(e,t)),n&&n.scenario||a},this.clearScenario=e=>{const t=this.activeScenariosMap.get(e.name);if(t){const i=(0,B.findIndex)(t,(t=>t.scenario===e));if(i>-1){this.__saveForTestingMode__(e,this.context.coreSettings.get(S.J.Test));const n=t.splice(i,1)[0];0===t.length&&this.activeScenariosMap.delete(n.scenario.name),this.enableNewScenarioTimeout||this.context.windowProvider.clearTimeout(n.timeoutId)}}const{parentScenarioFactory:i}=this.context;e.isHoisted&&i&&this!==i&&(i.clearScenario(e),e.isHoisted=!1)},this.setContext=e=>{this.eventContextData=Object.assign(Object.assign({},this.eventContextData),e),this.activeScenariosMap.forEach((t=>{t.forEach((t=>t.scenario.appendEventData(e)))}))},this.hoistScenarioToCore=e=>{const{parentScenarioFactory:t}=this.context;if(t&&t!==this)t.hoistScenarioToCore&&t.hoistScenarioToCore(e);else if(!e.isHoisted){this.getActiveScenarios(e.name).push({scenario:e,timeoutId:0}),e.isHoisted=!0}},this.findAllScenariosByName=e=>this.getActiveScenarios(e).map((e=>e.scenario)),this.changeTimeout=(e,t)=>{var i,n;const a=null===(i=this.activeScenariosMap.get(e.name))||void 0===i?void 0:i.find((t=>t.scenario.name===e.name&&t.scenario.id===e.id));a&&(a.scenario.timeoutMs=t,this.enableNewScenarioTimeout?null===(n=a.scenario.timer)||void 0===n||n.reset():(this.context.windowProvider.clearTimeout(a.timeoutId),a.timeoutId=this.setupScenarioTimeout(a.scenario)))},this.processOnRunningScenarios=e=>{this.activeScenariosMap.forEach((t=>t.forEach((t=>e(t.scenario,t.timeoutId)))))},this.setupScenarioTimeout=(e,t)=>{if(this.enableNewScenarioTimeout)return this.timerFactory.addTimerToScenario(e),0;{const i=e.timeoutMs,n=this.context.windowProvider.setTimeout((()=>{const i=this.context.coreSettings.get(S.J.Telemetry)||{},{scenariosNotToTimeoutIfPaused:n}=i;e.isPaused&&(null==n?void 0:n.includes(e.name))||e.stop(void 0,"timeout",t)}),i);return n}},this.getContextData=()=>{var e,t,i,n;return{userObjectId:this.environment===At.s.life?null===(e=this.context.authenticationUser)||void 0===e?void 0:e.profile.paddedMsaId:null===(t=this.context.authenticationUser)||void 0===t?void 0:t.profile.objectId,tenantId:null===(n=null===(i=this.context.authenticationUser)||void 0===i?void 0:i.profile)||void 0===n?void 0:n.tenantId,correlationId:this.context.correlation.id,commandSource:this.context.correlation.source}},this.getActiveScenarios=e=>{let t=this.activeScenariosMap.get(e);return t||(t=[],this.activeScenariosMap.set(e,t)),t},this.reportActivity=e=>{var t;const i=e["Scenario.Name"];i&&this.isWhitelistedActivity(i)&&(null===(t=this.context.windowProvider.opener)||void 0===t||t.postMessage(L.rY.ActivityEvent,{action:"er:rendererActivityEvents",data:{activityEvents:[{sourceId:this.windowId,events:[`${i}:${e["Scenario.Step"]}`]}]}}))},this.isWhitelistedActivity=e=>{switch(e){case z.RG.WindowLaunchTime:case z.RG.ChatSendMessage:case z.RG.CentralDataLayerRequest:case z.RG.UnhandledRejection:case z.RG.FatalError:case z.RG.GlobalWindowError:return!0;default:return!1}},this.isAllowedScenario=e=>!this.coreAllowListEnabled||this.allowedScenarios.has(e),this.isCrossClientScenarioEnabled=e=>this.clientType===Ps.Bh.Maglev&&this.crossClientScenarioList.has(e)&&void 0!==this.context.hostCommunicationService,this.initializeCrossClientScenarios=(e,t=[],i)=>{var n,a;const s=null!==(n=e.scenarios)&&void 0!==n?n:[],o=null!==(a=e.crossClientScenarioList)&&void 0!==a?a:[],r=this.context.loggerFactory.newLogger("CrossClientCoordinator","core-services-telemetry");o.forEach((e=>{this.crossClientScenarioList.add(e)}));const c={scenarioFactoryStartTime:e.scenarioFactoryStartTime.time.getTime(),coreInitTime:this.factoryTimestamps.coreInitTime};this.crossClientCoordinator=new EA(c,r,this,this.finalizeLegacyCrossClient,this.telemetryModeLookUp,this.userContextId,t),this.crossClientCoordinator.scenarioCreated$.subscribe((e=>{this.onScenarioFromCoordinator(e)})),i&&(this.crossClientCoordinator.loadCallbacks(i),this.logger.debug("Cross client initializing with callbacks")),this.crossClientCoordinator.loadExistingScenarios(s),this.logger.debug("Cross client coordinator initialized")},this.getTimestamp=e=>{const t=Date.now();return(null==e?void 0:e.isCrossClient)&&this.factoryTimestamps.desktopFactoryStartTime?t-this.factoryTimestamps.desktopFactoryStartTime:(null==e?void 0:e.isFromCoreInit)&&this.factoryTimestamps.coreInitTime?t-this.factoryTimestamps.coreInitTime:t-this.factoryTimestamps.scenarioFactoryStartTime},this.factoryTimestamps={scenarioFactoryStartTime:t,desktopFactoryStartTime:null===(m=this.payload)||void 0===m?void 0:m.scenarioFactoryStartTime.time.getTime(),coreInitTime:s},this.activeScenariosMap=new Map,this.environment=this.context.coreSettings.get(S.J.Metadata).environment,this.coreAllowListEnabled=null!==(g=this.context.coreSettings.get(S.J.Telemetry).coreAllowListEnabled)&&void 0!==g&&g,this.allowedScenarios=new Set(null!==(h=this.context.coreSettings.get(S.J.Telemetry).coreAllowList)&&void 0!==h?h:[]),this.scenarioIncompleteOnShutdown=null!==(p=this.context.coreSettings.get(S.J.Telemetry).scenarioIncompleteOnShutdown)&&void 0!==p&&p,this.scenarioIncompleteOnShutdownBlockList=null!==(v=this.context.coreSettings.get(S.J.Telemetry).scenarioIncompleteOnShutdownBlockList)&&void 0!==v?v:[],this.enableNewScenarioTimeout=null!==(f=this.context.coreSettings.get(S.J.Telemetry).enableNewScenarioTimeout)&&void 0!==f&&f,this.scenarioPackedDataLimit=this.readPackedDataLimitSetting(this.context.coreSettings.get(S.J.Telemetry).scenarioPackedDataLimit);const j=null!==(b=this.context.coreSettings.get(S.J.Telemetry).noPureScenarioCreationList)&&void 0!==b?b:[];this.clientType=null===(k=null===(y=e.platformService)||void 0===y?void 0:y.config)||void 0===k?void 0:k.clientType,this.telemetryModeSubscription=this.context.coreSettings.getObservable(S.J.Telemetry).subscribe((e=>this.onReceiveTelemetrySettings(e)));const C=this.context.coreSettings.get(S.J.Telemetry);this.crossAccountScenarioOptions={enabled:null!==(w=C.enableCrossAccountScenario)&&void 0!==w&&w},this.__initTestingMode__(this.context.coreSettings.get(S.J.Host)),this.timestamp=this.getTimestamp;const _=n?`ScenarioFactory-${n}`:"ScenarioFactory";this.logger=this.context.loggerFactory.newLogger(_,"core-services-telemetry"),this.timerFactory=new MA(this.context.windowProvider),this.payload&&this.initializeCrossClientScenarios(this.payload,j,c),this.startWindowLaunchTimeScenario(o,t),this.logger.debug("Initialized ScenarioFactory")}destroy(){this.telemetryModeSubscription.unsubscribe(),this.incompleteRunningScenarios()}setCoreInitTime(e){this.factoryTimestamps.coreInitTime=e,this.activeScenariosMap.forEach((t=>{t.forEach((t=>{var i,n;return null===(n=(i=t.scenario).updateTimestamp)||void 0===n?void 0:n.call(i,"coreInitTime",e)}))}))}doesScenariosExist(e){const t=[];for(const i of e){const e=this.activeScenariosMap.get(i);(null==e?void 0:e.length)&&t.push(i)}return t}incompleteRunningScenarios(){this.scenarioIncompleteOnShutdown&&this.processOnRunningScenarios(((e,t)=>{this.scenarioIncompleteOnShutdownBlockList.includes(e.name)||(e.incomplete({reason:"shutdown"}),this.enableNewScenarioTimeout||clearTimeout(t))}))}startWindowLaunchTimeScenario(e,t){var i;if(e){const e=this.newScenario(z.RG.WindowLaunchTime,{startTime:t,timeoutMs:6e4});e.appendEventData({workerEnabled:(0,xu.Q6)(this.context.coreSettings)}),null===(i=this.hoistScenarioToCore)||void 0===i||i.call(this,e)}}__initTestingMode__(e){if(e){const t=e.userType;t&&t.indexOf("test")>-1&&(this.__isTestingMode__=!0,PA in window?this.__testingBuffer__=window[PA]:this.__testingBuffer__=window[PA]=[])}}__saveForTestingMode__(e,t){this.__isTestingMode__&&this.__testingBuffer__&&(t&&t.scenarioBufferList&&t.scenarioBufferList.length>0?t.scenarioBufferList.indexOf(e.name)>-1&&this.__pushScenarioBuffer__(e):this.__pushScenarioBuffer__(e))}__pushScenarioBuffer__(e){e.isHoisted&&this.__testingBuffer__.length>0&&this.__testingBuffer__[this.__testingBuffer__.length-1].id===e.id||(this.__testingBuffer__.push(e),this.__testingBuffer__.length>100&&this.__testingBuffer__.shift())}onReceiveTelemetrySettings(e){var t;this.telemetryModeLookUp=e.scenarioModes,this.coreAllowListEnabled=Boolean(e.coreAllowListEnabled),this.allowedScenarios=new Set(null!==(t=e.coreAllowList)&&void 0!==t?t:[]),this.scenarioPackedDataLimit=this.readPackedDataLimitSetting(e.scenarioPackedDataLimit)}onScenarioFromCoordinator(e){this.crossClientScenarioList.add(e.name);const{showAllConsoleLogs:t}=this.context.coreSettings.get(S.J.Telemetry);e.testingMode=Boolean(t);const{userObjectId:i,correlationId:n,commandSource:a,tenantId:s}=this.getContextData(),o=(0,B.cloneDeep)(this.eventContextData);o["Panel.WindowID"]=this.windowId,o["UserInfo.Id"]=i,o["UserInfo.TenantId"]=s,o["EventInfo.CorrelationId"]=n,o.commandSource=a,e.appendEventData(o),this.factoryTimestamps.coreInitTime&&e.updateTimestamp("coreInitTime",this.factoryTimestamps.coreInitTime);const r=this.setupScenarioTimeout(e);this.getActiveScenarios(e.name).push({scenario:e,timeoutId:r})}readPackedDataLimitSetting(e){return null!=e?e:-1}}var RA=i(982190),LA=i(248965),UA=i(124498);const $A="reactWebClient",WA="maglev",BA="prod",zA="general";function HA(e,t,i){var n;let a,s,o,r;if(i){const e=i.expConfigMetadata.find((e=>e.client===$A)),t=i.expConfigMetadata.find((e=>e.client===WA));a=null==e?void 0:e.config.eTag,s=null==t?void 0:t.config.eTag,o=i.expConfigMetadata.map((e=>e.config.expIds)).filter((e=>e.length>0)).join(","),r=qA(i.expConfigMetadata).join(",")}else a=e.eTag||void 0,s=e.hostETag||void 0,e.configIds&&e.configIds.experiments&&(o=e.configIds.experiments.join(",")),(null===(n=e.expRolloutIdAllowList)||void 0===n?void 0:n.length)&&(r=VA(e).join(","));const c=function(e,t){var i;const n=e.ring&&e.ring.id||zA;if(t)return n;const a=null===(i=e.region)||void 0===i?void 0:i.toLowerCase(),s="gcc"===a?a:e.environment||BA;switch(s){case BA:return n;case"gcc":return`${n}_gcc`;default:return`${s}-${n}`}}(e,t);return{ring:c,eTag:a,hostETag:s,expIds:o,rolloutIds:r,environment:e.environment||void 0}}const qA=e=>{const t=new RegExp(/P-R-[a-zA-Z0-9]+/),i=[];return e.forEach((e=>{var n,a;null===(a=null===(n=e.config.expRolloutIdAllowList)||void 0===n?void 0:n.split(","))||void 0===a||a.forEach((n=>{var a,s;if(t.test(n)){const t=null===(s=null===(a=e.config.rolloutIds)||void 0===a?void 0:a.split(","))||void 0===s?void 0:s.filter((e=>e.startsWith(n)));i.push(...null!=t?t:[])}}))})),i},VA=e=>{var t;const i=new RegExp(/P-R-[a-zA-Z0-9]+/),n=[];return null===(t=e.expRolloutIdAllowList)||void 0===t||t.forEach((t=>{var a,s,o;if(i.test(t)){const i=null!==(o=null===(s=null===(a=e.configIds)||void 0===a?void 0:a.rollouts)||void 0===s?void 0:s.filter((e=>e.startsWith(t))))&&void 0!==o?o:[];n.push(...i)}})),n};class GA{constructor(e){this._top=-1,this._isFilled=!1,this._buffer=new Array(e),this.capacity=e}add(e){this._top=(this._top+1)%this.capacity,this._buffer[this._top]=e,this._top===this.capacity-1&&(this._isFilled=!0)}getItemFromLast(e){if(-1===this._top||e>=this.capacity||!this._isFilled&&this._top-e<0)return;const t=this._top-e>=0?this._top-e:this.capacity- -1*(this._top-e);return this._buffer[t]}}class JA{constructor(e){this.eventMarks=new GA(e&&e>0?e:100)}markEvent(e){this.markEventOverrideTimestamp(e,Date.now())}markEventOverrideTimestamp(e,t){var i;null===(i=this.eventMarks)||void 0===i||i.add({ts:t,name:e})}getEventsBetweenStartAndLast(e){if(!this.eventMarks)return[];const t=[];let i;for(let n=1;i=this.eventMarks.getItemFromLast(n),i&&!(i.ts<e);n++)t.push(i.name);return t}getEventsBetween(e,t){if(!this.eventMarks)return[];const i=[];let n;for(let a=0;n=this.eventMarks.getItemFromLast(a),n&&!(n.ts<e);a++)n.ts<t&&i.push(n.name);return i}}function KA(e){return new JA(e)}var QA;!function(e){e.Action="panelaction",e.View="panelview"}(QA||(QA={}));class YA{constructor(e,t=""){this.contextData=e,this.userContextId=t,this.clickStreamBatchInSeconds=75,this.clickStreamMaxBatchSize=15,this.getBatchNumber=()=>this.userBiCache.batchNumber,this.emptyCacheWithoutRestarting=()=>{this.recordClickStreamEvent({isTimeOut:!1,isBatchSize:!1,disableSetTimeout:!0})},this.addEventToUserBiCache=(e,t)=>{"panelaction"===t?(this.userBiCache.actionCount=this.userBiCache.actionCount+1,e["EventInfo.BaseType"]=QA.Action):(this.userBiCache.viewCount=this.userBiCache.viewCount+1,e["EventInfo.BaseType"]=QA.View),this.userBiCache.events.push(e),this.userBiCache.events.length>=this.clickStreamMaxBatchSize&&this.recordClickStreamEvent({isTimeOut:!1,isBatchSize:!0})},this.cacheClickStreamToLocalStorage=()=>{var e;this.userBiCache.events.length>0&&this.telemetrySettings.enableClickStreamUnloadCache&&(null===(e=this.contextData.localStorage)||void 0===e||e.set("clickstream_cache",JSON.stringify(this.userBiCache)))},this.setUpHostListeners=()=>{this.host.addEventListener("beforeunload",(()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){this.cacheClickStreamToLocalStorage(),this.emptyCacheWithoutRestarting(),yield this.telemetryProvider.flush()}))))},this.localStorageFlush=()=>{var e,t;if(this.telemetrySettings.enableClickStreamUnloadCache){const i=null===(e=this.contextData.localStorage)||void 0===e?void 0:e.get("clickstream_cache"),n=JSON.parse(i);i&&(0,Q.P3)(RA.x.ClickStream,"clickstream_cached",n,void 0,{columnName:"events",packedData:n.events},void 0,this.userContextId),null===(t=this.contextData.localStorage)||void 0===t||t.remove("clickstream_cache")}},this.setBatchTimeandSize=e=>{e===(Ps.Bh.Desktop||Ps.Bh.Maglev)?(this.clickStreamBatchInSeconds=this.telemetrySettings.clickStreamBatchInSeconds||75,this.clickStreamMaxBatchSize=this.telemetrySettings.clickStreamMaxBatchSize||15):(this.clickStreamBatchInSeconds=this.telemetrySettings.clickStreamBatchInSecondsWeb||30,this.clickStreamMaxBatchSize=this.telemetrySettings.clickStreamMaxBatchSizeWeb||5)},this.setupClickStreamTimeout=()=>this.contextData.windowProvider.setTimeout((()=>{this.recordClickStreamEvent({isTimeOut:!0,isBatchSize:!1})}),1e3*this.clickStreamBatchInSeconds),this.recordClickStreamEvent=e=>{if(this.userBiCache.actionCount>0||this.userBiCache.viewCount>0){this.userBiCache.batchFlushed=e.isBatchSize,this.userBiCache.timeoutFlushed=e.isTimeOut;const t=this.userBiCache;this.telemetrySettings.disable1DSBatching&&(t.latency=4),(0,Q.P3)(RA.x.ClickStream,"clickstream",t,void 0,{columnName:"events",packedData:t.events},void 0,this.userContextId),this.userBiCache={events:[],batchStartTime:(new Date).toISOString(),viewCount:0,actionCount:0,batchNumber:t.batchNumber+1,batchFlushed:!1,timeoutFlushed:!1}}this.contextData.windowProvider.clearTimeout(this.currentTimeoutId),e.disableSetTimeout||(this.currentTimeoutId=this.setupClickStreamTimeout())},this.userBiCache={events:[],batchStartTime:(new Date).toISOString(),viewCount:0,actionCount:0,batchNumber:1,batchFlushed:!1,timeoutFlushed:!1},this.telemetrySettings=this.contextData.coreSettings.get(S.J.Telemetry);const i=this.contextData.platformService.config.clientType;this.setBatchTimeandSize(i),this.currentTimeoutId=this.setupClickStreamTimeout(),this.host=this.contextData.windowProvider,this.localStorageFlush(),this.host&&this.setUpHostListeners(),this.telemetryProvider=(0,Hi.G)()}}var XA=i(410218);class ZA{constructor(e,t){var i,a;if(this.context=e,this.windowId=t,this.biEventObserver=new _i.xQ,this.experimentationEventData={},this.telemetrySettings={},this.panelContextData={},this.dataBagContextData={},this.windowSlotContext={},this.userContextId="",this._dataBags=[],this.recordPanelView=(e,t,i)=>{const n=this.getCombinedContextData(i),a=this.getCombinedDataBagData(i);this.recordBiEvent({eventName:"panelview",data:Object.assign(Object.assign(Object.assign({},this.windowSlotContext),a),iM(Object.assign(Object.assign({},n),e)))},t)},this.recordPanelAction=(e,t,i)=>{var n;const a=this.getCombinedContextData(i),s=this.getCombinedDataBagData(i);this.recordBiEvent({eventName:"panelaction",data:Object.assign(Object.assign(Object.assign({},this.windowSlotContext),s),eM(Object.assign(Object.assign({},a),e)))},t),null===(n=this.eventTimeTracker)||void 0===n||n.markEvent(`${e.actionOutcome}-${e.actionScenario}-${e.panelType}-${e.threadType}`)},this.setBISlotContext=e=>{this.windowSlotContext=Object.assign(Object.assign({},this.windowSlotContext),e)},this.createDatabag=()=>{const e=new XA.S;return this._dataBags.push(e),e.setDispose((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){yield(0,rl._)(0);const t=this._dataBags.findIndex((t=>t.id===e.id));this._dataBags.splice(t,1)})))),e},this.appendBiData=(e,t)=>{const{dataBag:i}=t,a=(0,n.__rest)(t,["dataBag"]),s=nM(HN.sz,e);this.dataBagContextData[s]=Object.assign(Object.assign({},this.dataBagContextData[s]),null==i?void 0:i.data),this.panelContextData[s]=Object.assign(Object.assign({},this.panelContextData[s]),a)},this.removeBiData=(e,t)=>{var i,n;const a=nM(HN.sz,e);if(t)for(const e of t)this.dataBagContextData&&(null===(i=this.dataBagContextData[a])||void 0===i||delete i[e]),this.panelContextData&&(null===(n=this.panelContextData[a])||void 0===n||delete n[e]);else delete this.dataBagContextData[a],delete this.panelContextData[a]},this.recordTestOnlyTelemetry=()=>{var e;const t=null===(e=this.context)||void 0===e?void 0:e.coreSettings.get(S.J.Telemetry).testOnlyUserbiTelemetry;t&&this.recordPanelAction(JSON.parse(t))},(null===(i=this.context)||void 0===i?void 0:i.authenticationUser)&&(this.userContextId=this.context.authenticationUser.id),null===(a=this.context)||void 0===a?void 0:a.coreSettings){const{disableRingNamePrefixing:e}=this.context.coreSettings.get(S.J.Telemetry),{enableSmbUserIntentUserBiTelemetry:t}=this.context.coreSettings.get(S.J.Growth),{enableCallingPerfCollectorService:i,enableCallingLongTasksTracking:n,enableCallingLongTasksTriggerFinder:a}=this.context.coreSettings.get(S.J.Calling);this.includeSmbUserIntentData=Boolean(t);const s=this.context.coreSettings.getObservable(S.J.Metadata);this.metadataSubscription=s.subscribe((t=>{var i;this.experimentationEventData=function(e,t,i){const n={},a=HA(e,t,i);return n["UserInfo.Ring"]=a.ring,n["UserInfo.ETag"]=a.eTag,n["UserInfo.HostETag"]=a.hostETag,n["AppInfo.ExpIds"]=a.expIds,n["AppInfo.ExpRolloutIds"]=a.rolloutIds,n["AppInfo.Environment"]=a.environment,n}(t,!!e,null===(i=this.context)||void 0===i?void 0:i.experimentationService)})),this.environment=this.context.coreSettings.get(S.J.Metadata).environment,this.telemetrySettingsSubscription=this.context.coreSettings.getObservable(S.J.Telemetry).subscribe((e=>this.onReceiveTelemetrySettings(e))),this.clientType=this.context.platformService.config.clientType,this.clientType===Ps.Bh.Maglev&&this.windowId!==h.ew&&this.subscribeToMaglevWindowState(),i&&n&&a&&(this.eventTimeTracker=KA()),this.context.coreSettings.get(S.J.Telemetry).enableTestOnlyTelemetry&&this.recordTestOnlyTelemetry()}}getEventsWithinTimeframe(e,t){var i;return(null===(i=this.eventTimeTracker)||void 0===i?void 0:i.getEventsBetween(e,t))||[]}getWindowId(){return this.windowId}destroy(){var e;this.metadataSubscription&&this.metadataSubscription.unsubscribe(),this.telemetrySettingsSubscription&&this.telemetrySettingsSubscription.unsubscribe(),this.clickStreamService&&this.clickStreamService.emptyCacheWithoutRestarting(),this.windowStateSubcription$&&this.windowStateSubcription$.unsubscribe(),this.unregisterForWindowStateChanged&&this.unregisterForWindowStateChanged(),(null===(e=this.smbUserIntentSubcription)||void 0===e?void 0:e.unsubscribe)&&this.smbUserIntentSubcription.unsubscribe(),this._dataBags.length&&(this._dataBags=[])}initializeAndSubscribeToSmbUserIntent(){var e,t;if(this.environment===At.s.life&&this.includeSmbUserIntentData&&(null===(e=this.context)||void 0===e?void 0:e.client)){const{smbUserIntentUserBiTelemetryPollInterval:e}=null===(t=this.context)||void 0===t?void 0:t.coreSettings.get(S.J.Growth),a=null!=e?e:36e5,s=()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var e,t;const n=yield(0,Rl.mT)((()=>i.e(309342).then(i.bind(i,218600))),"services-io-data-smb-user-intent").then((e=>e.smbUserIntentDocument));this.smbUserIntentSubcription=null===(t=null===(e=this.context)||void 0===e?void 0:e.client)||void 0===t?void 0:t.watchQuery({query:n,pollInterval:Number(a),fetchPolicy:"no-cache"}).subscribe((e=>{var t;(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.smbUserIntent)&&(this.smbUserIntent=e.data.smbUserIntent)}))}));return s(),()=>{var e;"function"==typeof(null===(e=this.smbUserIntentSubcription)||void 0===e?void 0:e.unsubscribe)&&this.smbUserIntentSubcription.unsubscribe()}}}getDataFromBaseInstance(){var e,t,i;return{"UserInfo.SmbUserIntent.Intent":null===(e=this.smbUserIntent)||void 0===e?void 0:e.smbUserIntent,"UserInfo.SmbUserIntent.IntentScore":null===(t=this.smbUserIntent)||void 0===t?void 0:t.smbUserIntentScore,"UserInfo.SmbUserIntent.ConfidenceScore":null===(i=this.smbUserIntent)||void 0===i?void 0:i.smbConfidenceScore}}bubbleUpObservable(e){var t,i,n;this.biEventObserver.next(e),null===(n=null===(i=null===(t=this.context)||void 0===t?void 0:t.parentUserBiService)||void 0===i?void 0:i.bubbleUpObservable)||void 0===n||n.call(i,e)}observe(){return this.biEventObserver.asObservable()}onReceiveTelemetrySettings(e){this.telemetrySettings=e,this.context&&this.telemetrySettings.enableClickStreamEvents&&!this.clickStreamService&&(this.clickStreamService=new YA({coreSettings:this.context.coreSettings,windowProvider:this.context.windowProvider,platformService:this.context.platformService,localStorage:this.context.localStorage},this.userContextId))}recordBiEvent(e,t){this._applyContextData(e),this.includeSmbUserIntentData&&this.applySmbUserIntentData(e);const i=function(e){const t={};return Object.keys(e).forEach((i=>{(0,B.isNil)(e[i])||(t[i]=e[i])})),t}(e.data),n="EventInfo.Identifier"in e.data?e.data["EventInfo.Identifier"]:void 0;if(this.telemetrySettings.enableClickStreamEvents&&this.clickStreamService){const t=(e.eventName,i);this.telemetrySettings.enableDualClickStreamEvents&&(i.batchNumber=this.clickStreamService.getBatchNumber(),(0,Q.P3)(RA.x.UserBI,e.eventName,i,void 0,void 0,this.telemetrySettings.enableUserBiEventIdentifiers?n:void 0,this.userContextId)),this.clickStreamService.addEventToUserBiCache(t,e.eventName)}else(0,Q.P3)(RA.x.UserBI,e.eventName,i,void 0,void 0,this.telemetrySettings.enableUserBiEventIdentifiers?n:void 0,this.userContextId);t&&(t.debug(`Analytics: EventType: ${e.eventName}`),t.debug(`Analytics: Type: ${i["Panel.Type"]}`),t.debug("Analytics: Payload:",i)),this.bubbleUpObservable({eventName:e.eventName,data:i})}_applyContextData(e){var t,i,n,a,s,o,r,c,l,d,u;e.data["Panel.WindowID"]=this.windowId,e.data["EventInfo.CorrelationId"]=null===(i=null===(t=this.context)||void 0===t?void 0:t.correlation)||void 0===i?void 0:i.id;const m=null!==(n=this.windowIsVisible)&&void 0!==n?n:null===(a=this.context)||void 0===a?void 0:a.windowProvider.isFocused();e.data["Window.Focus"]=m?Kr.cb.foreground:Kr.cb.background;const g=m?Kr.Lv.maximized:Kr.Lv.minimized;if(e.data["Window.Status"]=g,e.data["Window.Height"]=null===(s=this.context)||void 0===s?void 0:s.windowProvider.innerHeight,e.data["Window.Width"]=null===(o=this.context)||void 0===o?void 0:o.windowProvider.innerWidth,e.data["Window.ViewportContext"]=null===(r=this.context)||void 0===r?void 0:r.windowProvider.viewportContext,null===(c=this.context)||void 0===c?void 0:c.authenticationUser){const t=this.environment===At.s.life?null===(l=this.context)||void 0===l?void 0:l.authenticationUser.profile.paddedMsaId:null===(d=this.context)||void 0===d?void 0:d.authenticationUser.profile.objectId;e.data["UserInfo.Id"]=t,e.data["UserInfo.TenantId"]=null===(u=this.context)||void 0===u?void 0:u.authenticationUser.profile.tenantId}e.data=Object.assign(Object.assign({},e.data),this.experimentationEventData)}getCombinedContextData(e){let t={};if(e)for(const i of e){const e=nM(HN.sz,i);t=Object.assign(Object.assign({},t),this.panelContextData[e])}return t}getCombinedDataBagData(e){let t={};if(e)for(const i of e){const e=nM(HN.sz,i);t=Object.assign(Object.assign({},t),this.dataBagContextData[e])}return t}subscribeToMaglevWindowState(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.windowControlsModule&&this.context){this.windowControlsModule=yield this.context.hostCommunicationService.loadModule("windowcontrols"),this.windowState$=new Ti.y((e=>{var t;this.windowControlsModule&&this.windowControlsModule.registerForWindowStateChanged&&(this.unregisterForWindowStateChanged=null===(t=this.windowControlsModule)||void 0===t?void 0:t.registerForWindowStateChanged((t=>{if(!t.windowId||this.windowId&&t.windowId===this.windowId){const i=!t.placement.minimized;e.next(i)}})))}));const e=e=>{this.windowIsVisible=e};this.windowStateSubcription$=this.windowState$.subscribe(e)}}))}applySmbUserIntentData(e){var t,i,n,a;const s="function"==typeof(null===(i=null===(t=this.context)||void 0===t?void 0:t.parentUserBiService)||void 0===i?void 0:i.getDataFromBaseInstance)?null===(a=null===(n=this.context)||void 0===n?void 0:n.parentUserBiService)||void 0===a?void 0:a.getDataFromBaseInstance():void 0;s&&(e.data["UserInfo.SmbUserIntent.Intent"]=s["UserInfo.SmbUserIntent.Intent"],e.data["UserInfo.SmbUserIntent.IntentScore"]=s["UserInfo.SmbUserIntent.IntentScore"],e.data["UserInfo.SmbUserIntent.ConfidenceScore"]=s["UserInfo.SmbUserIntent.ConfidenceScore"])}}function eM(e){const{appName:t,actionGesture:i,actionOutcome:n,actionOutcomeNew:a,actionScenario:s,actionScenarioType:o,actionWorkload:r,actionSubworkload:c,actionInputDelay:l,moduleName:d,moduleNameNew:u,moduleType:m,moduleTypeNew:g,extensibilityData:h,tabId:p,tabIdNew:v,tabOrdinal:f,tabType:b,tabTypeNew:y,eventIdentifier:k,appId:S,appIsTenantApp:w,appCapabilityId:j,appScenarioCapability:C,appScope:_}=e,T=nM(HN.rA,d),I=nM(HN.PO,m),N=nM(HN.uS,i),E=nM(HN.Tk,s),F=(0,B.isNil)(k)?[T,I,N,E].filter(Boolean).join("_"):nM(HN.b6,k),x=Object.assign(Object.assign({"Action.Gesture":i,"Action.Outcome":n,"Action.OutcomeNew":a,"Action.Scenario":s,"Action.ScenarioType":o,"Action.WorkLoad":r,"Action.SubWorkLoad":c,"Module.Name":d,"Module.Type":m,"Module.NameNew":u,"Module.TypeNew":g,"Tab.Id":p,"Tab.Type":b,"Tab.IdNew":v,"Tab.TypeNew":y,"Tab.Ordinal":f,"App.Name":t,"App.Id":S,"App.IsTenantApp":w,"App.CapabilityId":j,"App.ScenarioCapability":C,"App.Scope":_},iM(e)),tM(h));return(0,B.isNil)(F)||(x["EventInfo.Identifier"]=F),(0,B.isNil)(l)||(x["Action.InputDelay"]=l),x}function tM(e){if(e&&!(0,B.isEmpty)(e))return{"App.Id":e.id,"App.Name":e.name,"App.Scope":nM(LA.Mv,e.scope),"App.ScenarioCapability":nM(LA.Ky,e.scenarioCapability),"App.EntryPoint":nM(LA.sG,e.entryPoint),"App.ExternalId":e.externalId,"App.IsTenantApp":e.isTenantApp,"App.CapabilityId":e.capabilityId,"App.SceneId":e.sceneId,"Bot.Id":e.botId,"App.MsftPartnerAppID":e.mpnId,"App.Source":nM(UA.RE,e.appDetailsEntryPoint),"App.FromSectionName":e.fromSectionName,"App.Capabilities":e.capabilities,"App.BotScopes":e.botScopes,"App.GalleryTabScopes":e.galleryTabScopes,"App.StaticTabScopes":e.staticTabScopes,"App.StaticTabName":e.staticTabName,"App.ConnectorScopes":e.connectorScopes,"App.ConnectorId":e.connectorId,"App.Version":e.version,"App.ManifestVersion":e.manifestVersion,"App.Categories":e.categories,"App.IsHostedApp":e.isHostedApp,"App.AppSource":e.appSource,"App.EventType":e.eventType,"App.DraftId":e.draftId,"App.LinkUnfurlingType":e.linkUnfurlingType}}function iM(e){const{panelRegion:t,panelRegionNew:i,panelType:n,panelTypeNew:a,threadId:s,teamId:o,threadMembers:r,threadType:c,panelLaunchMethod:l,panelUri:d,dataBag:u,extensibilityData:m,eventIdentifier:g,entityType:h,mainSlotApp:p,mainEntityType:v,mainEntityAction:f,officeGroupId:b,moduleName:y,moduleType:k,callId:S,participantId:w}=e,j=nM(HN.Ai,t),C=nM(HN.wh,n),_=(0,B.isNil)(g)?[j,C].filter(Boolean).join("_"):nM(HN.b6,g);return Object.assign(Object.assign(Object.assign({"Panel.LaunchMethod":l,"Panel.Region":t,"Panel.Type":n,"Panel.RegionNew":i,"Panel.TypeNew":a,"Panel.Uri":d,"Module.Name":y,"Module.Type":k,"Thread.Id":s,"Team.Id":o,"Team.OfficeGroupId":b,"Call.Id":S,"Participant.Id":w,"Thread.Type":c,"Thread.Members":r,"TargetThread.Id":s,"TargetThread.Type":c,"EventInfo.Identifier":_,"Entity.Type":h},u&&u.data),tM(m)),{"UserInfo.ChannelResourceTenant.Id":e["UserInfo.ChannelResourceTenant.Id"],"SlotConfig.MainSlotApp":p,"SlotConfig.MainEntityType":v,"SlotConfig.MainEntityAction":f})}function nM(e,t){return(0,B.isNil)(t)?void 0:e[t]}class aM{create(e,t,i,n,a,s,o){var r;const c=new ae(n),l=new OA(Object.assign(Object.assign({},e),{loggerFactory:c}),i,a,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,s),d=new ZA(t),u=new vA(c.newLogger("SetUserOnTelemetryContextTask","core-services-telemetry"),s),m={coreScenarioFactory:l,userBiService:d,loggerFactory:c,telemetryContext:u,telemetryService:new sM(l,u,a,{isolateUserContext:null!==(r=o.get(S.J.Telemetry).isolateUserContext)&&void 0!==r&&r})};return aM._cache.set(s,m),m}destroy(e){var t,i,n,a;if(e){const s=aM._cache.get(e);s&&(null===(i=(t=s.coreScenarioFactory).destroy)||void 0===i||i.call(t),null===(a=(n=s.userBiService).destroy)||void 0===a||a.call(n),aM._cache.delete(e))}}get(e){let t;return e&&(t=aM._cache.get(e)),t}clear(){aM._cache.clear()}forEach(e){aM._cache.forEach(e)}}aM._cache=new Map;class sM{constructor(e,t,i,n){this.coreScenarioFactory=e,this.coreTelemetryContext=t,this.memoryAnalyzer=i,this.isolateUserContext=!1,this.scenarioCancelOnNetworkStateChangeBlockList=new Set,this.scenarioCancelOnSuspendStateChangeBlockList=new Set,this.newCoreScenario=(e,t)=>this.coreScenarioFactory.newScenario(e,t),this.stopCoreScenarioIfActive=(e,t,i)=>this.coreScenarioFactory.stopScenarioIfActive(e,t,i),this.createScenarioFactory=(e,t,i,n,a,s="")=>{const{coreSettings:o}=e,{enableCreateWindowLaunchScenarioOnMainWindow:r}=o.get(S.J.Core);return new OA({parentScenarioFactory:e.scenarioFactory,coreSettings:e.coreSettings,platformService:e.platformService,loggerFactory:e.loggerFactory,hostCommunicationService:e.hostCommunicationService,windowProvider:e.windowProvider,authenticationUser:e.authenticationUser,correlation:i},parseInt(i.startTimestamp,10)||Date.now(),this.memoryAnalyzer,t,n,this.coreInitTimestamp,!!r||t!==h.ew,void 0,void 0,void 0,{"Window.ViewportContext":a},s||this.coreTelemetryContext.userId)},this.createUserBiService=(e,t,i)=>new ZA({authenticationUser:e.authenticationUser,coreSettings:e.coreSettings,windowProvider:e.windowProvider,platformService:e.platformService,experimentationService:e.experimentationService,hostCommunicationService:e.hostCommunicationService,client:e.client,localStorage:e.localStorage,parentUserBiService:e.userBiService,correlation:i},t),this.setCoreContext=(e,t,i)=>{this.coreTelemetryContext.setContext(e,t,i)},this.setContext=(e,t,i,n="")=>{this.coreTelemetryContext.setContext(e,t,i,n)},this.setDeviceAuthToken=e=>{this.coreTelemetryContext.setDeviceAuthToken(e)},this.setUserId=e=>{this.coreTelemetryContext.setUserId(e)},this.getTelemetryContextService=()=>this.coreTelemetryContext,this.setTelemetryContextService=e=>{this.coreTelemetryContext=e},this.logOutUser=e=>{(0,Hi.G)().logOutUser(e)},this.onHostStateChange=e=>{if(e.suspendedState===$e.V9.Suspending&&e.suspendedState!==this.previousHostSuspendState){const e=e=>{this.scenarioCancelOnSuspendStateChangeBlockList.has(e.name)||e.cancel({reason:"suspending"})};this.getTelemetryServicesCache().forEach((t=>{t.coreScenarioFactory.processOnRunningScenarios(e)})),this.coreScenarioFactory.processOnRunningScenarios(e)}this.previousHostSuspendState=e.suspendedState},this.onNetworkStateChange=e=>{if(e===dr.G.Offline){const e=e=>{this.scenarioCancelOnNetworkStateChangeBlockList.has(e.name)||e.cancel({reason:"network offline"})};this.getTelemetryServicesCache().forEach((t=>{t.coreScenarioFactory.processOnRunningScenarios(e)})),this.coreScenarioFactory.processOnRunningScenarios(e)}},sM._telemetryServicesCache||(sM._telemetryServicesCache=new aM);const{isolateUserContext:a}=n;this.isolateUserContext=a}destroy(){var e,t;null===(e=this.telemetrySuspendStateSubscription)||void 0===e||e.unsubscribe(),null===(t=this.telemetryNetworkStateSubscription)||void 0===t||t.unsubscribe()}getMemoryAnaylzer(){return this.memoryAnalyzer}setCoreInitTime(e){var t,i;this.coreInitTimestamp=e,null===(i=(t=this.coreScenarioFactory).setCoreInitTime)||void 0===i||i.call(t,e)}setAuthContext(e){const{id:t,oid:i,tid:n,type:a,role:s,subType:o,isCrossCloudUser:r,isExternalMember:c,homeAccountId:l,homeTenantId:d,userCloud:u}=e,m=(e,i)=>{this.isolateUserContext?this.setContext(e,i,void 0,t):this.setCoreContext(e,i)};void 0!==t&&m("userId",t===i?"":t),void 0!==i&&m("UserInfo.Id",i),void 0!==n&&m("UserInfo.TenantId",n),void 0!==a&&m("UserInfo.Type",a),void 0!==s&&m("UserInfo.Role",s),void 0!==l&&this.setContext("UserInfo.HomeAccountId",l,void 0,t),void 0!==d&&this.setContext("UserInfo.HomeTenantId",d,void 0,t),void 0!==o&&m("UserInfo.SubType",o),void 0!==u&&this.setContext("UserInfo.HomeCloud",u,void 0,t),void 0!==r&&this.setContext("UserInfo.IsCrossCloudUser",r,void 0,t),void 0!==c&&m("UserInfo.IsExternalMember",c)}getTelemetryServicesCache(){return sM._telemetryServicesCache}initTelemetrySuspendStateSubscription(e,t){this.telemetrySuspendStateSubscription||(this.scenarioCancelOnSuspendStateChangeBlockList=new Set(t),this.telemetrySuspendStateSubscription=e.observe().subscribe(this.onHostStateChange))}initTelemetryNetworkStateSubscription(e,t){this.telemetryNetworkStateSubscription||(this.scenarioCancelOnNetworkStateChangeBlockList=new Set(t),this.telemetryNetworkStateSubscription=e.observe().subscribe(this.onNetworkStateChange))}}class oM extends Ue{constructor(){super(h.Yg.SetUserOnTelemetryContext,["authenticationService","authenticationUser","config","coreSettings","correlation","diagnosticsService","discover","hostCommunicationService","loggerFactory","platformService","scenarioFactory","telemetryContextService","telemetryService","windowProvider"])}execute(e){var t,i,a,s,o,r;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:c,coreSettings:l,loggerFactory:d,authenticationService:u,correlation:m,telemetryContextService:g,telemetryService:h,discover:p}=e,v=d.newLogger("SetUserOnTelemetryContextTask","core-services-tasks");let f;if(l.get(S.J.Telemetry).useTelemetryServicesCache&&(f=h.getTelemetryServicesCache().get(c.id)),f)e.loggerFactory=f.loggerFactory,e.scenarioFactory=f.coreScenarioFactory,e.telemetryService=f.telemetryService,e.userBiService=f.userBiService,e.telemetryContextService=f.telemetryContext;else{const n=c.type===zo.Ch.MsaLife||l.get(S.J.Metadata).environment===At.s.life,s=new vA(v,c.id);e.loggerFactory=new ae(e.diagnosticsService,e.correlation.id,c.id);const o=new OA({parentScenarioFactory:e.scenarioFactory,coreSettings:e.coreSettings,platformService:e.platformService,loggerFactory:e.loggerFactory,hostCommunicationService:e.hostCommunicationService,windowProvider:e.windowProvider,authenticationUser:e.authenticationUser,correlation:e.correlation},e.config.startTimeMS,null===(t=e.telemetryService)||void 0===t?void 0:t.getMemoryAnaylzer(),void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.id);e.scenarioFactory=o,e.telemetryService=new sM(o,s,null===(i=e.telemetryService)||void 0===i?void 0:i.getMemoryAnaylzer(),{isolateUserContext:null!==(a=l.get(S.J.Telemetry).isolateUserContext)&&void 0!==a&&a}),n&&(c.profile.paddedMsaId=this.getPaddedMsaId(c.profile.objectId,v)),this.setAuthUserOnTelemetryContext(e.telemetryService,c,n)}const{registerForUserContext:b,notifyPrivacyDataControlsEnabled:y}=yield this.initializeUserHostComms(e.authenticationUser.id,e.hostCommunicationService,v);y&&p.getUser().then((e=>{var t;y(null!==(t=e.isPrivacyDataControlEnabled)&&void 0!==t&&t)}));const k=null==b?void 0:b(((t,i,n)=>{e.telemetryService.setContext(t,n,void 0,i)})),w=this.subscribeAndSetUserInfoTelemetryContext(e.telemetryService,c,l),j=null!==(s=l.get(S.J.Telemetry).disableMTMAPrimaryId)&&void 0!==s&&s;La(j,g,u,m,v),null===(r=(o=e.authenticationService).registerEndTelemetryTask)||void 0===r||r.call(o,(e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t;k&&k(),h.setContext("UserInfo.IsMRU",void 0,void 0,e),w.unsubscribe();try{yield La(j,g,u,m,v)}catch(e){null===(t=v.errorToTelemetry)||void 0===t||t.call(v,"Failed to update MRU or sync mtma context","telemetry_instrumentation_update_user_context")}yield(0,Hi.G)().flush(),(0,Hi.G)().logOutUser(e),l.get(S.J.Telemetry).useTelemetryServicesCache&&h.getTelemetryServicesCache().destroy(e)}))))}))}initializeUserHostComms(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n={};try{const i=yield t.loadModule("telemetry"),{registerForOnNewContext:a,setPdcEeaStatus:s}=null!=i?i:{};a&&(n.registerForUserContext=t=>a((i=>{i.filter((t=>t.userContextId===e)).forEach((i=>t(i.column,e,i.value)))}))),s&&(n.notifyPrivacyDataControlsEnabled=s)}catch(e){i.errorToTelemetry&&i.errorToTelemetry(or.LoadModuleTelemetryFailed,"webclient_framework_host_comms",void 0,!0)}return n}))}subscribeAndSetUserInfoTelemetryContext(e,t,i){return i.getObservable(S.J.UserResources).subscribe((i=>{const n=i.licenseType||void 0;switch(n&&e.setContext("UserInfo.LicenseType",n),t.role){case zo.w4.Member:i.isTenantAdmin||void 0?e.setContext("UserInfo.TenantRole",Kr.z7.Admin):e.setContext("UserInfo.TenantRole",Kr.z7.Regular);break;case zo.w4.Guest:e.setContext("UserInfo.TenantRole",Kr.z7.Guest);break;case zo.w4.Anonymous:e.setContext("UserInfo.TenantRole",Kr.z7.Anonymous)}}))}setAuthUserOnTelemetryContext(e,t,i){i&&t.profile.paddedMsaId&&this.setUserContext(e,t.profile.paddedMsaId);const n=i&&t.profile.paddedMsaId?t.profile.paddedMsaId:t.profile.objectId;e.setContext("UserInfo.Id",n),e.setContext("UserInfo.TenantId",t.profile.tenantId),e.setContext("UserInfo.Type",t.type),e.setContext("UserInfo.Role",t.role)}setUserContext(e,t){const i=t.slice(19).replace("-","");e.setUserId(t),e.setContext("UserInfo.Id",t),e.setContext("userId",i)}getPaddedMsaId(e,t){try{if(/(\w{8})-(\w{4})-(\w{4})-(\w{4})-(\w{12})/.exec(e)&&e.startsWith("00000000-0000-0000-"))return e;{const t=(0,B.padStart)(e,32,"0"),i=/(\w{8})(\w{4})(\w{4})(\w{4})(\w{12})/;return t.replace(i,"$1-$2-$3-$4-$5")}}catch(e){return void t.error("failed_user_padding")}}}class rM extends Ue{constructor(){super(h.Yg.CreateUserTelemetryServicesTask,["telemetryService","authenticationUser","diagnosticsService","coreSettings","loggerFactory","windowProvider","correlation","platformService","experimentationService","hostCommunicationService","client","scenarioFactory"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,diagnosticsService:i,telemetryService:n,coreSettings:a,loggerFactory:s,windowProvider:o,correlation:r,platformService:c,experimentationService:l,hostCommunicationService:d,client:u,scenarioFactory:m}=e;a.get(S.J.Telemetry).useTelemetryServicesCache&&!n.getTelemetryServicesCache().get(t.id)&&n.getTelemetryServicesCache().create({coreSettings:a,loggerFactory:s,windowProvider:o,correlation:r,parentScenarioFactory:m},{authenticationUser:t,coreSettings:a,windowProvider:o,platformService:c,experimentationService:l,hostCommunicationService:d,client:u},Date.now(),i,n.getMemoryAnaylzer(),t.id,a)}))}}const cM="serviceWorkerDeferInstallDurationInMs",lM="enableServiceWorkerIntegrityCheck",dM="enableServiceWorkerDynamicManifest",uM="localeSettingValue",mM="environment",gM="clientType",hM="swHandleCdlHashRoute",pM="platformId",vM="teams-service-worker-telemetry-v2",fM="1",bM="LogEvents",yM="timestamp",kM="teams-service-worker-v2",SM="2",wM="SwState",jM="key";var CM,_M,TM,IM;!function(e){e.Install="install",e.Activate="activate",e.Fetch="fetch"}(CM||(CM={})),function(e){e.Intermediate="intermediate",e.Old="old"}(_M||(_M={})),function(e){e.Info="sw_info",e.InstallSuccess="sw_install_success",e.InstallFailure="sw_install_failure",e.ActivateSuccess="sw_activate_success",e.ActivateFailure="sw_activate_failure",e.FetchCacheMiss="sw_fetch_cache_miss",e.CleanupCacheSuccess="sw_cleanup_cache_success",e.CleanupCacheFailure="sw_cleanup_cache_failure",e.CleanupCacheRetry="sw_cleanup_cache_retry",e.CleanupNotRun="sw_cleanup_cache_not_run",e.CleanupNotRequired="sw_cleanup_cache_not_required",e.CorruptCache="sw_corrupt_cache",e.CorruptCacheDeleteSuccess="sw_corrupt_cache_delete_success",e.CorruptCacheDeleteFailure="sw_corrupt_cache_delete_failure",e.DeferInstallStarted="sw_install_defer_started",e.DeferInstallCancelled="sw_install_defer_cancelled",e.DeferInstallCancelledOnMaxIncomplete="sw_install_defer_cancelled_max_incomplete",e.DeferInstallOldCacheCleanupInProgress="sw_install_defer_old_cache_cleanup_inprogress",e.DeferInstallTimerCompleted="sw_install_defer_timer_completed",e.DeferInstallRetryAttempted="sw_install_defer_retry",e.ResetInstallIncompleteCounterFailure="sw_install_reset_counter_failure",e.ResetCacheCleanupStateFailure="sw_reset_cache_cleanup_state_failure",e.InstallIntegrityCheckPerformed="sw_install_integrity_check_performed",e.ReadIndexedDbFailure="sw_read_indexeddb_failure",e.AssetSetGenerationFailure="sw_asset_set_generation_failure",e.WriteIndexedDbFailure="sw_write_indexeddb_failure",e.FetchSWAssetsUsingSendMessage="sw_fetch_assets_using_send_message"}(TM||(TM={})),function(e){e.Start="start",e.Success="success",e.Failure="failure",e.CacheMiss="cache_miss",e.HighLatency="high_latency",e.CDNAssetNotInManifest="cdn_asset_not_in_manifest",e.OfflineAssetStart="offline_asset_start",e.OfflineAssetSuccess="offline_asset_success",e.OfflineAssetFailure="offline_asset_failure",e.OfflineAssetCacheMiss="offline_asset_cache_miss"}(IM||(IM={}));const NM=3e5,EM=18e4,FM=72e5,xM=18e5,DM="serviceWorkerCheckingForUpdates",AM="serviceWorkerMaxUpdateFailureCountReached",MM="serviceWorkerRegistrationNotFound",PM=5,OM="fundamentals_performance_sw_fetch",RM="fundamentals_performance_sw_offline_fetch";var LM=i(321748);class UM{constructor(e){var t,i,n,a,s;this.context=e,this.fetchTelemetryStore=new Map,this.swEnableIntegrityCheck=!1,this.isSwInstalling=!1,this.isSwWaiting=!1,this.serviceWorkerUpdateFailureCount=0,this.basePath=this.context.config.basePath,this.loggerFactory=this.context.loggerFactory,this.logger=this.loggerFactory.newLogger("WebClientUpdateService","services-io-browser-web-client-update"),this.rebootService=this.context.rebootService,this.host=this.context.windowProvider,this.scenarioFactory=this.context.scenarioFactory,this.coreSecurityService=this.context.coreSecurityService;try{this.swRegisterUrlPolicy=this.coreSecurityService.getTrustedTypePolicy("@msteams/services-io-browser-web-client-update#register-service-worker"),this.trustedScriptUrl=null===(t=this.swRegisterUrlPolicy)||void 0===t?void 0:t.createScriptURL(`/${this.basePath}/serviceworker.js`,this.host.location.origin)}catch(e){e instanceof pg.Y&&Re.G.isFunction(e.toTelemetryEntry)?null===(n=(i=this.logger).errorToTelemetry)||void 0===n||n.call(i,e.toTelemetryEntry(),"fundamental_performance_trusted_sw_scripturl"):null===(s=(a=this.logger).errorToTelemetry)||void 0===s||s.call(a,"create register service worker url trustedtype policy failed",e)}this.enableSWSubscription=this.context.coreSettings.getObservable(S.J.Core).subscribe((e=>{this.registerOrUnregisterServiceWorker(!!e.enableServiceWorker)}))}cleanup(){this.enableSWSubscription.unsubscribe(),this.clearTimer()}checkForUpdateAndRestartWebClient(){this.configureServiceWorkerEvents(),this.addUpdateServiceWorkerSettings(!0),this.registerAndCheckForServiceWorkerUpdates()}sendMessageToServiceWorker(e,t){return new Promise(((i,n)=>{const a=new MessageChannel;a.port1.onmessage=e=>{e.data.error?n(e.data.error):i(e.data)},e.postMessage(t,[a.port2])}))}handleOnStateChange(e,t,i,n){switch(this.sendServiceWorkerLifeCycleEventTelemetry(),t){case"installed":this.logger.log("Service worker got installed"),this.handleInstalledSWState(n);break;case"activated":this.logger.log("Service worker got activated"),this.isSwWaiting=!1;const t=this.scenarioFactory.findScenario(z.RG.SwStateChange);t&&(this.scenarioFactory.markStep(z.RG.SwStateChange,z.ck.SwActivated),t.stop()),this.setServiceWorkerContextForScenarios(!0);case"redundant":this.handleRedundantSWState(e,i)}e={state:t}}SendIncompleteEvent(e,t){this.fetchTelemetryStore.set(e.url,e),this.sendServiceWorkerFetchEventTelemetryInCompleteEvent(t)}setServiceWorkerContextForScenarios(e=!1){e?this.setScenarioContext(e):this.getServiceWorkerRegistration().then((e=>{this.setScenarioContext(!!e)}))}unregisterServiceWorker(e){"serviceWorker"in this.host.navigator&&(this.getServiceWorkerRegistration().then((t=>{t&&t.unregister().then((t=>{var i,n;null===(n=(i=this.logger).infoToTelemetry)||void 0===n||n.call(i,e,"fundamentals_performance_sw_unregister")}))})).catch((e=>{var t,i;null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,e.toString(),"fundamentals_performance_sw_unregister")})),this.deleteCacheStorage(e),this.clearTimer())}handleRedundantSWState(e,t){"installing"===e.state?(this.isSwInstalling=!1,this.scenarioFactory.markStep(z.RG.SwStateChange,z.ck.SwInstallFailure),t.fail(),this.serviceWorkerUpdateFailureCount++,this.triggerForceUpdate()):"installed"===e.state&&(this.isSwWaiting=!1),this.setServiceWorkerContextForScenarios(!0)}triggerForceUpdate(){this.serviceWorkerUpdateFailureCount>=PM&&(this.logger.error("Will force an update when the app is idle as SW update failed repeatedly with",AM),this.handleUpdateReady())}handleInstalledSWState(e){this.isSwInstalling=!1,this.isSwWaiting=!0,this.setServiceWorkerContextForScenarios(!0),this.scenarioFactory.markStep(z.RG.SwStateChange,z.ck.SwInstalled),"storage"in this.host.navigator&&"estimate"in this.host.navigator.storage&&this.host.navigator.storage.estimate().then((e=>{var t,i;const n=e.usageDetails,a={storageUsage:e.usage,storageQuota:e.quota,cacheStorageSize:null==n?void 0:n.caches,indexedDBSize:null==n?void 0:n.indexedDB,swRegSize:null==n?void 0:n.serviceWorkerRegistrations};null===(i=(t=this.logger).infoToTelemetry)||void 0===i||i.call(t,"Teams disk footprint","fundamentals_performance_user_storage_info",a)})),(0,lx.K4)(this.host)&&this.scenarioFactory.stopScenarioIfActive(z.RG.SwStateChange),e||this.handleUpdateReady(),this.serviceWorkerUpdateFailureCount=0}logServiceWorkerTelemetry(){this.sendServiceWorkerFetchEventTelemetry(),this.recurringSendSWFetchEventTelemetryInterval=this.host.setInterval(this.sendServiceWorkerFetchEventTelemetry.bind(this),NM),this.sendServiceWorkerLifeCycleEventTelemetry()}sendServiceWorkerLifeCycleEventTelemetry(){const e=parseInt(fM,10);(0,LM.q8)(vM,e,bM,yM,this.scenarioFactory,!0).then((e=>{var t;if(void 0!==e){let i=0;const n=null!==(t=this.recentProcessedLifeCycleEventTimestamp)&&void 0!==t?t:-1;e.map((e=>{var t;const a=null!==(t=e.timestamp)&&void 0!==t?t:0;a>n&&(this.sendServiceWorkerLifeInfoAndInstallTelemetry(e),i=Math.max(i,a))})),this.recentProcessedLifeCycleEventTimestamp=i}})).catch((e=>{this.logger.error("Error fetching service worker state telemetry. Error:",e)})).then((()=>(0,LM.dR)(vM,e,bM,yM,this.scenarioFactory).catch((e=>{this.logger.error("Error deleting service worker state telemetry. Error:",e)}))))}sendServiceWorkerLifeInfoAndInstallTelemetry(e){var t,i,n,a,s,o,r,c,l,d,u,m;const g={version:e.version,type:e.type,context:e.buildVersion},h=e.message||"";switch(e.type){case TM.InstallSuccess:null===(i=(t=this.logger).infoToTelemetry)||void 0===i||i.call(t,h,"fundamentals_performance_sw_install",g);break;case TM.InstallFailure:null===(a=(n=this.logger).errorToTelemetry)||void 0===a||a.call(n,h,"fundamentals_performance_sw_install",g);break;case TM.ActivateSuccess:null===(o=(s=this.logger).infoToTelemetry)||void 0===o||o.call(s,h,"fundamentals_performance_sw_activate",g);break;case TM.ActivateFailure:null===(c=(r=this.logger).errorToTelemetry)||void 0===c||c.call(r,h,"fundamentals_performance_sw_activate",g);break;case TM.ReadIndexedDbFailure:null===(d=(l=this.logger).errorToTelemetry)||void 0===d||d.call(l,h,"fundamentals_performance_sw_read_indexed_db",g);break;default:null===(m=(u=this.logger).infoToTelemetry)||void 0===m||m.call(u,h,"fundamentals_performance_sw_state_info",g)}}registerServiceWorker(){const{enableTrustedSWScriptUrl:e}=this.context.coreSettings.get(S.J.Core),t=e&&this.trustedScriptUrl?this.trustedScriptUrl:`/${this.basePath}/serviceworker.js`,i=this.scenarioFactory.newScenario(z.RG.SwRegistration);this.host.navigator.serviceWorker.register(t,{updateViaCache:"all"}).then((e=>{i.stop(),this.attachEventsToInstallingServiceWorker(e,!0)})).catch((e=>{var t;(null===(t=this.context.networkState)||void 0===t?void 0:t.isOnline())?i.fail({message:`Error: ${e}`}):i.cancel({message:`user is not online and SW reg is failing due to error: ${e}`})}))}handleUpdateReady(){const{disableSkipWaiting:e}=this.context.coreSettings.get(S.J.Core);e||this.skipWaitingServiceWorkerIfNeeded(),this.rebootService.rebootWhenLongInactive(bo.Z.AppUpdatedUsingServiceWorker,bo.d.WebClientUpdateService)}deleteCacheStorage(e){if(void 0!==this.host.caches){const t=this.scenarioFactory.newScenario(z.RG.SwCleanupSwCache);this.host.caches.delete(h.eL).then((i=>{i?t.stop({reason:e}):t.fail({reason:"cache not found"})}))}}registerAndCheckForServiceWorkerUpdates(){this.getServiceWorkerRegistration().then((e=>{var t,i;e?(null===(i=(t=this.logger).infoToTelemetry)||void 0===i||i.call(t,DM,"fundamentals_performance_sw_update_check"),e.update()):(this.logger.log(MM),this.registerServiceWorker())})).catch((e=>{this.logger.error(`Error getting Service Worker registration object: ${e}`)}))}configureServiceWorkerEvents(){"serviceWorker"in this.host.navigator&&this.getServiceWorkerRegistration().then((e=>{e?(this.attachEventsToInstallingServiceWorker(e),e.onupdatefound=()=>{this.attachEventsToInstallingServiceWorker(e)}):this.logger.log(MM)}))}registerServiceWorkerAndLogTelemetry(){const{enableUpdateServiceWorkerRegistrationPerSession:e}=this.context.coreSettings.get(S.J.Core);this.addUpdateServiceWorkerSettings(),e?this.registerAndCheckForServiceWorkerUpdates():this.registerServiceWorker(),this.logServiceWorkerTelemetry()}addUpdateServiceWorkerSettings(e=!1){var t,i;const n=[],{serviceWorkerDeferInstallDurationInMs:a,enableServiceWorkerDynamicManifest:s,handleCdlHashRouteInServiceWorkerInstall:o,enableServiceWorkerIntegrityCheck:r}=this.context.coreSettings.get(S.J.Core);a&&Number.isInteger(a)&&this.swDeferInstallDurationInMs!==a&&(this.swDeferInstallDurationInMs=a,n.push({key:cM,value:this.swDeferInstallDurationInMs})),this.swEnableDynamicManifest!==s&&(this.swEnableDynamicManifest=null!=s&&s,n.push({key:dM,value:this.swEnableDynamicManifest})),this.swEnableIntegrityCheck!==r&&(this.swEnableIntegrityCheck=null!=r&&r,n.push({key:lM,value:this.swEnableIntegrityCheck})),this.swhandleCdlHashRoute!==o&&(this.swhandleCdlHashRoute=null!=o&&o,n.push({key:hM,value:this.swhandleCdlHashRoute}));const c=null!==(i=null===(t=this.context.i18NextWrapper)||void 0===t?void 0:t.locale)&&void 0!==i?i:"en-us";if(this.localeSetting!==c&&(this.localeSetting=c,n.push({key:uM,value:this.localeSetting})),!e){n.push({key:mM,value:this.context.platformService.ecsOverrides.environment.toString()});const e=this.context.platformService.config.clientType===Ps.Bh.Maglev?"desktop":this.context.platformService.config.clientType.toString();n.push({key:gM,value:e})}n.push({key:pM,value:this.context.platformService.config.platformId.toString()}),n.length&&this.writeSettingsInServiceWorkerDb(n)}writeSettingsInServiceWorkerDb(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=parseInt(SM,10);yield(0,LM.Zl)(kM,t,wM,jM,e,this.scenarioFactory).then((()=>{this.logger.log("Successfully updated service worker settings in Indexed DB")})).catch((e=>{this.logger.error("Error updating service worker settings in Indexed DB. Error:",e)}))}))}sendServiceWorkerFetchEventTelemetry(){this.host.navigator.serviceWorker.controller&&this.sendMessageToServiceWorker(this.host.navigator.serviceWorker.controller,"getFetchTelemetryEvents").then((e=>{e.forEach((e=>{this.sendServiceWorkerFetchEventTelemetryCompletedEvent(e)}))})).catch((e=>{this.logger.error("Error getting service worker fetch telemetry. Error:",e)})),this.sendServiceWorkerFetchEventTelemetryInCompleteEvent(NM)}sendServiceWorkerFetchEventTelemetryInCompleteEvent(e){const t=Date.now();this.fetchTelemetryStore.forEach(((i,n)=>{if(void 0===e||t-i.timestamp>e){const e={endpointUrl:i.url,fetchTelemetryEventDelta:t-i.timestamp,operationType:i.type,version:i.version,message:i.message},a=i.type===IM.OfflineAssetStart?z.RG.SwOfflineAssetFetchEvent:z.RG.SwFetchEvent;this.scenarioFactory.newScenario(a).cancel(e),this.fetchTelemetryStore.delete(n)}}))}sendServiceWorkerFetchEventTelemetryCompletedEvent(e){const t={endpointUrl:e.url,operationType:e.type,message:e.message,version:e.version,context:e.buildVersion};if(this.captureFetchEvent(e,t)){const i=this.isOfflineFetchOperation(e.type)?RM:OM;this.sendFetchEvent(i,e.type,t)}}isOfflineFetchOperation(e){let t;switch(e){case IM.OfflineAssetSuccess:case IM.OfflineAssetFailure:case IM.OfflineAssetCacheMiss:t=!0;break;default:t=!1}return t}sendFetchEvent(e,t,i){var n,a,s,o,r,c,l,d;const u=i.message||"";switch(t){case IM.Success:case IM.OfflineAssetSuccess:null===(a=(n=this.logger).infoToTelemetry)||void 0===a||a.call(n,u,e,i);break;case IM.CacheMiss:case IM.OfflineAssetCacheMiss:null===(o=(s=this.logger).warnToTelemetry)||void 0===o||o.call(s,u,e,i);break;case IM.Failure:case IM.OfflineAssetFailure:null===(c=(r=this.logger).errorToTelemetry)||void 0===c||c.call(r,u,e,i);break;default:null===(d=(l=this.logger).debugToTelemetry)||void 0===d||d.call(l,u,e,i)}}captureFetchEvent(e,t){switch(e.type){case IM.Start:case IM.OfflineAssetStart:return this.fetchTelemetryStore.set(e.url,e),!1;case IM.Failure:case IM.Success:case IM.OfflineAssetFailure:case IM.OfflineAssetSuccess:case IM.CDNAssetNotInManifest:case IM.CacheMiss:case IM.OfflineAssetCacheMiss:const i=this.fetchTelemetryStore.get(e.url);return i?(t.fetchTelemetryEventDelta=e.timestamp-i.timestamp,this.fetchTelemetryStore.delete(e.url)):t.reason="orphan",!0;case void 0:return this.logger.error("unexpected fetch event type:",e.type),!1}return!1}clearTimer(){this.host.clearInterval(this.recurringCheckForUpdateInterval),this.host.clearTimeout(this.registerSWAndLogTelemetryTimer),this.host.clearInterval(this.recurringSendSWFetchEventTelemetryInterval)}registerOrUnregisterServiceWorker(e){if(e){if(!this.recurringCheckForUpdateInterval){this.recurringCheckForUpdateInterval=this.host.setInterval((()=>this.checkForUpdateAndRestartWebClient()),FM+Math.ceil(Math.random()*xM));const{serviceWorkerRegistrationDelayInMs:e}=this.context.coreSettings.get(S.J.Core),t=e&&Number.isInteger(e)?e:EM;this.registerSWAndLogTelemetryTimer=this.host.setTimeout((()=>this.registerServiceWorkerAndLogTelemetry()),t)}}else this.unregisterServiceWorker("Service Worker is not enabled");this.setServiceWorkerContextForScenarios()}setScenarioContext(e){var t,i;null===(i=(t=this.scenarioFactory).setContext)||void 0===i||i.call(t,{isServiceWorkerRegistered:e,isServiceWorkerActive:(0,lx.K4)(this.host),isServiceWorkerInstalling:this.isSwInstalling,isServiceWorkerWaiting:this.isSwWaiting})}attachEventsToInstallingServiceWorker(e,t=!1){if(!e||!e.installing)return;const i=this.scenarioFactory.newScenario(z.RG.SwStateChange);this.scenarioFactory.markStep(z.RG.SwStateChange,z.ck.SwInstalling);const n=e.installing,a={state:n.state};this.isSwInstalling=!0,this.setServiceWorkerContextForScenarios(!0),n.onstatechange=()=>this.handleOnStateChange(a,n.state,i,t)}skipWaitingServiceWorkerIfNeeded(){"serviceWorker"in this.host.navigator&&this.getServiceWorkerRegistration().then((e=>{e&&e.waiting&&e.waiting.postMessage("skipWaiting")}))}getServiceWorkerRegistration(){return this.host.navigator.serviceWorker.getRegistration(`/${this.basePath}/serviceworker.js`)}}class $M extends Ue{constructor(){super(h.Yg.CreateWebClientUpdate,["coreSettings"])}execute(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){t.webClientUpdateService=new UM(e);const{isUnRegisterSWOnLogoutEnabled:i}=e.coreSettings.get(S.J.Core);if(i)return e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){"signout"===e&&(yield t.webClientUpdateService.unregisterServiceWorker(e))}))}))}}var WM=i(247554);class BM extends Ue{constructor(){super(h.Yg.CreateWindow,["config","diagnosticsService","logsCollectorService"]),this.registerShellHandlers=(e,t,i)=>{e.opener.addEventListener(L.rY.GetLogs,(()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield t.getDiagnosticsEvents(),a=yield i.getSystemInfo();let s="System Info: ";a&&a.size>0?a.forEach(((e,t)=>{s+=`${t}: ${e}\n`})):s+="No system info collected",n.unshift({message:`${s}`,level:E.i.Debug,levelName:E.i[E.i.Debug],timeStamp:new Date,isPiiFree:!0}),e.opener.postMessage(L.rY.GetLogs,{logs:n})}))))}}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=WM.n.getInstance(),i=t.config.hostedWindowContext,n=t.window;t.opt={postMessageConfig:e.config.postMessageConfig},n.onAppStart();const{diagnosticsService:a,logsCollectorService:s}=e;this.registerShellHandlers(n,a,s),e.hostedWindowContext=i,e.windowProvider=n}))}}class zM extends Ue{constructor(){super(h.Yg.DiscoverUser,["discover"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){e.user=yield e.discover.getUser()}))}}class HM extends Ue{constructor(){super(h.Yg.FetchCriticalDynamicImportsTask,["criticalDynamicImports","loggerFactory","scenarioFactory","coreSettings"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{criticalDynamicImports:t,loggerFactory:i,scenarioFactory:n,coreSettings:a}=e;if(!t||0===t.length)return;(null==a?void 0:a.get(S.J.Core).enableSerializeChunkImport)?yield Promise.all(t.map((e=>(0,Rl.mT)(e.importFunc,e.chunkName,n)))).catch((e=>{var t,n;null===(n=(t=i.newLogger("FetchCriticalDynamicImportsTask","core-services-tasks")).errorToTelemetry)||void 0===n||n.call(t,`Failed to preload chunk this will regress performance of first load: ${e}`,"webclient_framework_foundation_core_services_tasks",void 0,!0)})):t.forEach((({importFunc:e,chunkName:t})=>{(0,Rl.mT)(e,t,n).catch((e=>{var n,a;return null===(a=(n=i.newLogger("FetchCriticalDynamicImportsTask","core-services-tasks")).errorToTelemetry)||void 0===a?void 0:a.call(n,`Failed to preload chunk ${t} this will regress performance of first load: ${e}`,"webclient_framework_foundation_core_services_tasks",void 0,!0)}))}))}))}}class qM extends Ue{constructor(){super(h.Yg.InitApiServiceProvider,["coreSettingsContext"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield e.coreSettingsContext.initializeApiServiceProvider()}))}}class VM extends Ue{constructor(){super(h.Yg.InitAsyncMediaAuthService,["mediaAuthService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{mediaAuthService:t}=e;return null==t||t.initAsyncMediaAuthService(),e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){"signout"===e&&(yield null==t?void 0:t.logout())}))}))}}var GM=i(723506);class JM extends Ue{constructor(){super(h.Yg.InitATPPolicyTask,["coreSettings","endpointsManager","gtmRegistry","localStorage","loggerFactory","scenarioFactory"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,endpointsManager:i,gtmRegistry:n,localStorage:a,loggerFactory:s,scenarioFactory:o}=e,{enableFastSharepointSafelinks:r}=t.get(S.J.Messaging),c=s.newLogger("InitATPPolicyTask","core-services-tasks");if(!(null==r?void 0:r.enabled))return void c.log("InitATPPolicyTask - Do nothing, FF is disabled");const l=new GM.c(n.bind(Dr.l,N.Pn.middleTier),o,s,a,t,i);c.log("Getting ATP Safelinks policy"),l.initPolicy()}))}}const KM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeAuthenticatedUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reason"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeAuthenticatedUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"reason"},value:{kind:"Variable",name:{kind:"Name",value:"reason"}}}]}]}}]};let QM;class YM{constructor(e,t,i,n,a,s,o,r){var c,l,d;this._auth=e,this._client=t,this._discover=i,this._networkStateProvider=n,this._windowProvider=s,this._keepTokenActive=!1,this._keepCheckingSignInRestrictions=!1,this._isLoginRequired=void 0,this._tokenIntervalId=void 0,this._logger=o.newLogger("AuthTokenStoreService","core-services-auth-token-store"),this._mtResourceKey=(null===(c=null==r?void 0:r.get(S.J.Auth))||void 0===c?void 0:c.mtResource)||tn.ej.MT_AAD_KEY,this._tokenWarmingIntervalInMs=(null===(l=null==r?void 0:r.get(S.J.Auth))||void 0===l?void 0:l.tokenWarmingIntervalInMs)||Zr.lP.MT_TOKEN_INTERVAL,this._disableTokenWarmingForSigninRestriction=(null===(d=null==r?void 0:r.get(S.J.Auth))||void 0===d?void 0:d.disableTokenWarmingForSigninRestriction)||!1,this._subscriptions=new Map,this.observeIsLoginRequired(),this.observeAppOnlineState()}observe(e){let t=this._subscriptions.get(e);return t||(t=this.createSubscription(e),this._subscriptions.set(e,t)),t}createSubscription(e){let t;switch(e){case tn.ej.MT_KEY:this._keepTokenActive=!0,t=this._auth.observeMiddleTierToken(),this.keepTokenActive();break;case tn.ej.SIGNIN_RESTRICTIONS_KEY:this._keepCheckingSignInRestrictions=!0,this.keepTokenActive();break;default:this._logger.error("Unable to create subscription, token key %s is not supported",e)}return t}keepTokenActive(){this._tokenIntervalId||(this._keepTokenActive||this._keepCheckingSignInRestrictions)&&(this._tokenIntervalId=this._windowProvider.setInterval((()=>{if(this._keepCheckingSignInRestrictions&&this._disableTokenWarmingForSigninRestriction){let e=(0,$r.pW)();e=`sign${e.substr(tn.uI.FOUR)}`,this._auth.acquireToken(tn.ej.SIGNIN_RESTRICTIONS_KEY,{correlationId:e}).catch((e=>{this.handleSignInRestrictionsError(e)}))}this._keepTokenActive&&this._auth.acquireToken(this._mtResourceKey).then((()=>this._discover.validateSkypeToken())).catch((e=>{this._logger.error("Error occurred in keeping MT token active.",e)}))}),this._tokenWarmingIntervalInMs))}handleSignInRestrictionsError(e){if(this._logger.error(`Error occurred in keeping SignInRestrictions token active. ErrorCode: ${null==e?void 0:e.errorCode}`,e),(null==e?void 0:e.errorCode)===tn.SM.SignInRestrictions){this._logger.error("Sign in restrictions was enabled and caught by the periodic check. Forcibly signing out the user");const e={id:(0,$r.pW)(),source:"auth-token-store",scenarioName:z.RG.AuthWebLogout},[t,i]=(0,Ur.OU)({options:{correlation:e},scenarioName:e.scenarioName,source:e.source,subContext:"auth-token-store::handleSignInRestrictionsError"});t.appendScenarioEventData({operationType:tn.SM.SignInRestrictions}),this._client.mutate({mutation:KM,variables:{reason:tn.SM.SignInRestrictions},context:{correlation:e}}),i()}else this._logger.error("Sign in restrictions token acquisition threw an unexpected error",e)}observeIsLoginRequired(){this._auth.isLoginRequired.subscribe((e=>{if(this._isLoginRequired===e)return;const t=void 0===this._isLoginRequired;this._isLoginRequired=e,t||(this._isLoginRequired?this._tokenIntervalId&&(this._windowProvider.clearInterval(this._tokenIntervalId),this._tokenIntervalId=void 0):this.replayKeepTokenActiveState())}))}observeAppOnlineState(){this._networkStateProvider.observeIsOnline().subscribe((e=>{e?this.replayKeepTokenActiveState():this._tokenIntervalId&&(this._windowProvider.clearInterval(this._tokenIntervalId),this._tokenIntervalId=void 0)}))}replayKeepTokenActiveState(){if(0===this._subscriptions.size)return;const e=this._subscriptions.keys();let t=e.next();for(;!t.done;)this.keepTokenActive(),t=e.next()}}class XM extends Ue{constructor(){super(h.Yg.InitAuthenticationService,[])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{client:t,discover:i,authenticationUser:n,authenticationService:a,networkState:s,loggerFactory:o,coreSettings:r,scenarioFactory:c}=e,{enableSignInRestrictions:l,prefetchTokens:d,disableTokenWarming:u,enableTokenWarming:m,tokenWarmingResources:g}=r.get(S.J.Auth);if(!n)return;const h=((e,t,i,n,a,s,o)=>(QM||(QM=new YM(i,e,t,n,a,(0,R.J)(),s,o)),QM))(t,i,a,s,c,o,r);l&&h.observe(tn.ej.SIGNIN_RESTRICTIONS_KEY),!u&&h.observe(tn.ej.MT_KEY);const p=[];null==d||d.forEach((e=>e&&p.push(e))),m&&g&&g.forEach((e=>{e&&p.indexOf(e)<0&&p.push(e)})),p.forEach((e=>a.acquireToken(e).catch((()=>{}))))}))}}class ZM{constructor(e,t,i){this.coreSettings=e,this.host=i,this.defaultScreenshotsTimeoutMs=5e3,this.brbServiceMap=new Map,this.brbExtendedServiceMap=new Map,this.logger=t.newLogger("BrbServiceManager","core-services-brb")}registerUserBrbExtendedFeedbackProvider(e,t){var i,n;null===(n=(i=this.logger).logNoPii)||void 0===n||n.call(i,"Registering a new BRB extended feedback provider for account");const a=this.getOrCreateUserBrbExtendedFeedbackProviderSet(e);a.add(t),this.brbExtendedServiceMap.set(e,a)}unregisterUserBrbExtendedFeedbackProvider(e){var t,i;return null===(i=(t=this.logger).logNoPii)||void 0===i||i.call(t,"Unregistering an existing BRB service for account"),this.brbExtendedServiceMap.delete(e)}registerUserBrbService(e,t){var i,n;null===(n=(i=this.logger).logNoPii)||void 0===n||n.call(i,"Registering a new BRB service for account"),this.brbServiceMap.set(e,t)}unregisterUserBrbService(e){var t,i;return null===(i=(t=this.logger).logNoPii)||void 0===i||i.call(t,"Unregistering an existing BRB service for account"),this.brbServiceMap.delete(e)}getBrbFormData(){var e,t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{categories:i,disclaimer:n}=this.coreSettings.get(S.J.Brb),a=[];return null==i||i.forEach((e=>{e&&a.push({id:e.id,name:e.name})})),null===(t=(e=this.logger).logNoPii)||void 0===t||t.call(e,"Returning data for BRB form",a),{disclaimer:n||h.bA,categories:a}}))}getBrbScreenshots(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=this.getOrCreateUserBrbService(e);if(i){const{screenshotsTimeoutMs:e}=this.coreSettings.get(S.J.Brb,["screenshotsTimeoutMs"]);let n=0;const a=new Promise((t=>{n=this.host.setTimeout((()=>{var e,i;null===(i=(e=this.logger).logNoPii)||void 0===i||i.call(e,"Screenshots timeout. Returning undefined for BRB screenshots."),n=0,t(void 0)}),null!=e?e:this.defaultScreenshotsTimeoutMs)})),s=i.getBrbScreenshots(t).then((e=>{var t,i;return null===(i=(t=this.logger).logNoPii)||void 0===i||i.call(t,`Screenshots received: ${null==e?void 0:e.length}`),e}));return Promise.race([s,a]).then((e=>(n&&this.host.clearTimeout(n),e)))}return Promise.resolve(void 0)}))}createBrbItem(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=this.getOrCreateUserBrbService(e),a=yield(null==n?void 0:n.createBrbItem(t,i))||void 0;if(!a)return a;const{enableMTMA:s}=this.coreSettings.get(S.J.Core);if(s){Array.from(this.brbServiceMap.keys()).filter((t=>t!==e)).forEach((e=>{const n=this.getOrCreateUserBrbService(e);null==n||n.extendBrbReports(t,a,i)}))}const o=this.getOrCreateUserBrbExtendedFeedbackProviderSet(e);if(n&&o){const e=yield n.getSystemInfo();o.forEach((i=>i.extendedBrbFeedback(t,a,e)))}return a}))}createAutoBrbItem(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return yield this.createBrbItem(e,t,!0)}))}getOrCreateUserBrbExtendedFeedbackProviderSet(e){const t=this.brbExtendedServiceMap.get(e);return null!=t?t:new Set}getOrCreateUserBrbService(e){var t,i,n,a,s,o;const r=this.brbServiceMap.get(e);if(!(r&&r instanceof Function))return null===(o=(s=this.logger).logNoPii)||void 0===o||o.call(s,"Found existing BRB service for account"),r;null===(i=(t=this.logger).logNoPii)||void 0===i||i.call(t,"Creating BRB service for account");try{const t=r();return this.brbServiceMap.set(e,t),t}catch(t){return void(null===(a=(n=this.logger).logNoPii)||void 0===a||a.call(n,`Failed to create BRB service for account ${e}`))}}}class eP extends Ue{constructor(){super(h.Yg.InitBrbServiceManagerTask,["coreSettings","loggerFactory","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:i,windowProvider:n}=e;e.brbServiceManager=new ZM(t,i,n)}))}}var tP,iP,nP,aP,sP;!function(e){e.PASSED="PASSED",e.EDU="EDU",e.PSTN_CALLING="PSTN_CALLING",e.USER_CHOICE="USER_CHOICE",e.ADMIN_DISABLED="ADMIN_DISABLED",e.GUEST_USER="GUEST_USER",e.USER_FTS="USER_FTS",e.T1_DEFAULT="T1DEFAULT",e.T21_DEFAULT="T21DEFAULT",e.T21_ONLY="T21ONLY"}(tP||(tP={})),function(e){e.M365BusinessLicenseCohort="M365BusinessLicenseCohort",e.EarlyEnterpriseCohort="EarlyEnterpriseCohort",e.MidEnterpriseCohort="MidEnterpriseCohort",e.AdminsOfLateEnterpriseCohort="AdminsOfLateEnterpriseCohort",e.LateEnterpriseCohort="LateEnterpriseCohort",e.GovCloudCohort="GovCloudCohort",e.MacR36Cohort="MacR36Cohort",e.MacR4Cohort="MacR4Cohort",e.EduCohort="EduCohort",e.InternalRingCohort="InternalRingCohort",e.ExternalTapCohort="ExternalTapCohort",e.NoPPChannelCohort="NoPPChannelCohort"}(iP||(iP={})),function(e){e.M365BusinessLicenseCohort="M365BusinessLicenseCohortUplevel",e.EarlyEnterpriseCohort="EarlyEnterpriseCohortUplevel",e.MidEnterpriseCohort="MidEnterpriseCohortUplevel",e.AdminsOfLateEnterpriseCohort="AdminsOfLateEnterpriseCohortUplevel",e.LateEnterpriseCohort="LateEnterpriseCohortUplevel",e.GovCloudCohort="GovCloudCohortUplevel",e.MacR36Cohort="MacR36CohortUplevel",e.MacR4Cohort="MacR4CohortUplevel",e.EduCohort="EduCohortUplevel",e.InternalRingCohort="InternalRingCohortUplevel",e.ExternalTapCohort="ExternalTapCohortUplevel",e.NoPPChannelCohort="NoPPChannelCohortUplevel"}(nP||(nP={})),function(e){e.M365BusinessLicenseCohort="M365BusinessLicenseCohortDownlevel",e.EarlyEnterpriseCohort="EarlyEnterpriseCohortDownlevel",e.MidEnterpriseCohort="MidEnterpriseCohortDownlevel",e.AdminsOfLateEnterpriseCohort="AdminsOfLateEnterpriseCohortDownlevel",e.LateEnterpriseCohort="LateEnterpriseCohortDownlevel",e.GovCloudCohort="GovCloudCohortDownlevel",e.MacR36Cohort="MacR36CohortDownlevel",e.MacR4Cohort="MacR4CohortDownlevel",e.EduCohort="EduCohortDownlevel",e.InternalRingCohort="InternalRingCohortDownlevel",e.ExternalTapCohort="ExternalTapCohortDownlevel",e.NoPPChannelCohort="NoPPChannelCohortDownlevel"}(aP||(aP={})),function(e){e.M365_BusinessBasic="M365_BusinessBasic",e.M365_BusinessStandard="M365_BusinessStandard",e.M365_BusinessPremium="M365_BusinessPremium",e.M365_BusinessApps="M365_BusinessApps",e.M365_BusinessEssentials="M365_BusinessEssentials"}(sP||(sP={}));var oP=i(564110);class rP{constructor(e,t,i,n,a,s){this.coreSettings=e,this.useAccessCheckV2=i,this.hostComm=n,this.scenarioFactory=a,this.appSwitcherPolicyCheckService=s,this.logger=t.newLogger("ClientAccessAdminPolicyCheckService","services-utilities-core"),this.useAccessCheckV2=i}isUserAllowed(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("isUserAllowed::start");let e=!1;const{useNewTeamsClient:t}=this.coreSettings.get(S.J.Core,["useNewTeamsClient"]);switch(this.logger.log(`isUserAllowed: useNewTeamsClient: ${t}`),t){case N.KN.AdminDisabled:e=!1;break;case N.KN.MicrosoftChoice:this.useAccessCheckV2&&(e=yield this.isUserAllowedV2()),e||(e=this.isUserAllowedViaAppSwitcher());break;case N.KN.UserChoice:default:e=!0}return this.logger.log(`isUserAllowed: returned ${e}`),e}))}shouldUserAttemptT1Cleanup(){var e;const{enableT1AppSwitcherEffectivePolicyFetch:t}=this.coreSettings.get(S.J.Core);return t?(0,oP.aj)([null===(e=this.appSwitcherPolicyCheckService)||void 0===e?void 0:e.getAppSwitcherEffectivePolicy(),this.coreSettings.getObservable(S.J.Core,["forceEnableT1Cleanup"])]).pipe((0,l.U)((([e,t])=>{const{forceEnableT1Cleanup:i}=t;return!(!e&&void 0===i)&&this.shouldUserAttemptT1CleanupUtility(e,!!i)}))):this.coreSettings.getObservable(S.J.Core,["useNewTeamsClient","forceEnableT1Cleanup"]).pipe((0,l.U)((({useNewTeamsClient:e,forceEnableT1Cleanup:t})=>(void 0!==e||void 0!==t)&&this.shouldUserAttemptT1CleanupInternal(e,!!t))))}shouldUserAttemptT1CleanupInternal(e,t){this.logger.log("shouldUserAttemptT1Cleanup::start");const i=this.scenarioFactory.newScenario(z.RG.AppSwitcherCheckT1CleanupPolicy);if(t)return i.stop({reason:"force_enable"}),!0;let n=!1;if(e===N.KN.NewTeamsOnly)n=!0;else n=!1;return this.logger.log(`shouldUserAttemptT1Cleanup: got useNewTeamsClient=${e}, returning ${n}`),n?i.stop():i.cancel(),n}shouldUserAttemptT1CleanupUtility(e,t){this.logger.log("shouldUserAttemptT1Cleanup::start");const i=this.scenarioFactory.newScenario(z.RG.AppSwitcherCheckT1CleanupPolicy);if(t)return i.stop({reason:"force_enable"}),!0;let n=!1;return(null==e?void 0:e.toUpperCase())===tP.T21_ONLY&&(n=!0),this.logger.log(`shouldUserAttemptT1Cleanup: got appSwitcherEffectivePolicy=${e}, returning ${n}`),n?i.stop():i.cancel(),n}isUserAllowedViaAppSwitcher(){const{installedThroughAppSwitcher:e}=this.coreSettings.get(S.J.Host,["installedThroughAppSwitcher"]);return this.logger.log(`isUserAllowedViaAppSwitcher: installedThroughAppSwitcher: ${e}`),!!e}isUserAllowedV2(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{allowUserOnMicrosoftChoice:e}=this.coreSettings.get(S.J.Core,["allowUserOnMicrosoftChoice"]);if(!e)return this.logger.log("isUserAllowedV2: returned false due to allowUserOnMicrosoftChoice=false"),!1;const{disableEduCheckOnMicrosoftChoice:t}=this.coreSettings.get(S.J.Core,["disableEduCheckOnMicrosoftChoice"]);if(!t&&this.isEdu())return this.logger.log(`isUserAllowedV2: returned false due to EDU, disableEduCheckOnMicrosoftChoice=${t}`),!1;const{disableVdiCheckOnMicrosoftChoice:i}=this.coreSettings.get(S.J.Core,["disableVdiCheckOnMicrosoftChoice"]);return!i&&(yield this.isVdi())?(this.logger.log(`isUserAllowedV2: returned false due to VDI, disableVdiCheckOnMicrosoftChoice=${i}`),!1):(this.logger.log("isUserAllowedV2: returned true due to allowUserOnMicrosoftChoice=true"),!0)}))}isVdi(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.hostComm)return this.logger.warn("isVdi: returned false - invalid hostComm"),!1;const e=yield this.hostComm.loadModule("vdi");if(!e||!e.isVDI)return this.logger.warn(`isVdi: returned false - invalid VDI function, vdiModule=${!!e}`),!1;const t=yield e.isVDI();return this.logger.log(`isVdi: returned ${t}`),t}))}isEdu(){const{licenseType:e}=this.coreSettings.get(S.J.UserResources);return this.logger.log(`isEdu: licenseType=${e}`),!(!e||e!==N.oj.Student&&e!==N.oj.Teacher)}}class cP extends Ue{constructor(){super(h.Yg.InitClientAccessAdminPolicyCheck,["coreSettings","hostCommunicationService","loggerFactory","scenarioFactory","appSwitcherPolicyCheckService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,hostCommunicationService:i,loggerFactory:n,scenarioFactory:a,appSwitcherPolicyCheckService:s}=e,o=n.newLogger("InitClientAccessAdminPolicyCheckTask","core-services-tasks"),{enableAppSwitcherTACSettingsSync:r}=t.get(S.J.Core,["enableAppSwitcherTACSettingsSync"]),{enableAppSwitcherTACSettingsSyncV2:c}=t.get(S.J.Core,["enableAppSwitcherTACSettingsSyncV2"]);if(!r&&!c)return void o.log("Both enableAppSwitcherTACSettingsSync and enableAppSwitcherTACSettingsSyncV2 are false, skipping ClientAccessAdminPolicyCheckService initialization.");const l=new rP(t,n,!!c,i,a,s);if(e.clientAccessAdminPolicyCheckService=l,!(yield l.isUserAllowed()))throw new ze.G(ze.$.DISABLED_BY_ADMIN)}))}}class lP{constructor(e,t,i){this.coreSettings=e,this.scenarioFactory=i,this.logger=t.newLogger("AppSwitcherPolicyCheckService","services-utilities-core")}getAppSwitcherEffectivePolicy(){return(0,oP.aj)([this.coreSettings.getObservable(S.J.Core,["useNewTeamsClient","enableT1AppSwitcherEffectivePolicyFetch"]),this.coreSettings.getObservable(S.J.HostCapabilities,["t1AppSwitcherEffectivePolicy"])]).pipe((0,l.U)((([e,t])=>{const{useNewTeamsClient:i,enableT1AppSwitcherEffectivePolicyFetch:n}=e,{t1AppSwitcherEffectivePolicy:a}=t;if(this.logger.log(`getAppSwitcherEffectivePolicy: useNewTeamsClient=${i}, enableT1AppSwitcherEffectivePolicyFetch= ${n}, t1AppSwitcherEffectivePolicy=${a}`),i&&n)return this.checkTeamsAdminCenterPolicy(i,a)})))}getAppSwitcherCohort(){return(0,oP.aj)([this.coreSettings.getObservable(S.J.HostCapabilities,["t1AppSwitcherCohort","officeUpdateRegkey"]),this.coreSettings.getObservable(S.J.Core,["enableT1AppSwitcherEffectivePolicyFetch","enableAppSwitcherCohortCalcFromSettings"]),this.coreSettings.getObservable(S.J.Metadata,["ring"]),this.coreSettings.getObservable(S.J.UserResources,["licenseType"]),this.coreSettings.getObservable(S.J.Platform,["deviceInfo"]),this.coreSettings.getObservable(S.J.Host,["authBootstrapData"])]).pipe((0,l.U)((([e,t,i,n,a,s])=>{var o;const{t1AppSwitcherCohort:r}=e,{enableT1AppSwitcherEffectivePolicyFetch:c,enableAppSwitcherCohortCalcFromSettings:l}=t,d=this.scenarioFactory.newScenario(z.RG.AppSwitcherIdentifyCohort);if(this.logger.log(`getAppSwitcherCohort: t1AppSwitcherCohort=${r}, enableT1AppSwitcherEffectivePolicyFetch= ${c}`),r&&c)return d.stop({reason:"T1Hint"}),r;if(l){const t=this.getAppSwitcherCohortFromSettings(d,n.licenseType,null===(o=s.authBootstrapData)||void 0===o?void 0:o.licenseDetails,e,a,i.ring);return d.stop({reason:"FromSettings",cohort:t}),t}d.cancel({reason:!r&&c?"MissingT1Hint":"FlagsOff",t1AppSwitcherCohort:r})})))}getAppSwitcherCohortFromSettings(e,t,i,n,a,s){var o,r;const c=(null===(o=null==s?void 0:s.id)||void 0===o?void 0:o.toLocaleLowerCase())||"",l=(null==n?void 0:n.officeUpdateRegkey)||"";if(t===N.oj.Student||t===N.oj.Teacher)return e.appendEventData({licenseType:t}),iP.EduCohort;if(["gcc","gcch","dod","ag08","ag09","gallatin"].includes(c))return iP.GovCloudCohort;if("macOS"===(null===(r=null==a?void 0:a.deviceInfo)||void 0===r?void 0:r.osName)){if("ring3_6"===c)return iP.MacR36Cohort;if("general"===c)return iP.MacR4Cohort}return lP.internalRings.includes(c)?iP.InternalRingCohort:"ring3_6"===c?iP.ExternalTapCohort:(e.appendEventData({officeUpdateRegkey:l}),"production::mec"===l?iP.MidEnterpriseCohort:"insiders::frdc"===l?iP.AdminsOfLateEnterpriseCohort:"production::cc"!==l||(null==i?void 0:i.appSwitcherBusinessLicenseCategory)?Object.values(sP).includes(null==i?void 0:i.appSwitcherBusinessLicenseCategory)?(e.appendEventData({businessLicenseCategory:(null==i?void 0:i.appSwitcherBusinessLicenseCategory)||""}),iP.M365BusinessLicenseCohort):l?iP.LateEnterpriseCohort:iP.NoPPChannelCohort:iP.EarlyEnterpriseCohort)}checkTeamsAdminCenterPolicy(e,t){switch(this.logger.log(`checkTeamsAdminCenterPolicy::start useNewTeamsClient=${e}, appSwitcherEffectivePolicy=${t}`),e){case N.KN.UserChoice:return tP.USER_CHOICE;case N.KN.AdminDisabled:return tP.ADMIN_DISABLED;case N.KN.NewTeamsAsDefault:return tP.T21_DEFAULT;case N.KN.NewTeamsOnly:return tP.T21_ONLY;case N.KN.MicrosoftChoice:return t||tP.T1_DEFAULT;default:return tP.T1_DEFAULT}}}lP.internalRings=["ring0","ring1","ring1_5","ring1_6","ring2","ring3","ring3_9"];class dP extends Ue{constructor(){super(h.Yg.InitAppSwitcherPolicyCheck,["coreSettings","loggerFactory","telemetryService","scenarioFactory"]),this._updateTelemetryOnPolicyStateChange=(e,t)=>{e.getAppSwitcherEffectivePolicy().subscribe((e=>{t.setCoreContext("appswitcherEffectivePolicy",e)}))}}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:i,telemetryService:n,scenarioFactory:a}=e,s=i.newLogger("InitAppSwitcherPolicyCheckTask","core-services-tasks"),o=new lP(t,i,a);s.log("AppSwitcherPolicyCheckService initialization done."),e.appSwitcherPolicyCheckService=o,this._updateTelemetryOnPolicyStateChange(o,n)}))}}class uP extends Ue{constructor(){super(h.Yg.InitDesktopEcsContext,["coreSettings","discover","hostCommunicationService","i18NextWrapper","loggerFactory","platformService","primaryUser"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,discover:i,hostCommunicationService:n,i18NextWrapper:a,loggerFactory:s,platformService:o,primaryUser:r}=e,c=yield n.loadModule("ecs");if(null==c?void 0:c.setEcsContext){const e=yield this.getDesktopEcsFilters(t,i,a,s,o,r);c.setEcsContext(e)}}))}getDesktopEcsFilters(e,t,i,a,s,o){var r,c,l,d;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{ring:n,environment:u}=e.get(S.J.Metadata),{enableLocaleFilterForFeatureFlags:m,disableRegionParamForMaglev:g}=e.get(S.J.Core,["enableLocaleFilterForFeatureFlags","disableRegionParamForMaglev"]);let h;if(!g)try{h=yield t.getRegion({id:o.id,tenantId:o.profile.tenantId,oid:o.profile.objectId,accountType:o.type,userName:o.loginUserName||""})}catch(e){null===(c=(r=a.newLogger("InitDesktopEcsContextTask","core-services-tasks")).errorToTelemetry)||void 0===c||c.call(r,"Failed to fetch region info from discover service.","webclient_framework_foundation_core_services_tasks",void 0,!0)}const{isInternalUser:p}=s.config,{originalRing:v}=s.ecsOverrides,f=m?i.locale:void 0;return u||null===(d=(l=a.newLogger("InitDesktopEcsContextTask","core-services-tasks")).errorToTelemetry)||void 0===d||d.call(l,"Environment is undefined","webclient_framework_foundation_core_services_tasks",void 0,!0),{cloud:u||"",isInternalUser:p,locale:f,originalRing:v,region:h,ring:(null==n?void 0:n.id)||"general",tenantId:o.profile.tenantId,userId:o.profile.objectId}}))}}var mP=i(231194);function gP(e,t){return(i,n,a)=>{if(n>=pr.qb.OK&&n<=pr.qb.NOT_MODIFIED)return!1;const s=i<e&&n!==pr.qb.BAD_REQUEST&&n!==pr.qb.NOT_AUTHORIZED;return t.warn(`imageCookieRetryPolicy retry count ${i} responseCode ${n} canRetry ${s}`),s}}var hP=i(921961);function pP(e,t){return()=>({url:"v1/imageauth/cookie",method:"POST",headers:{"x-ms-client-caller":"imageAuthCookieSetupEM","x-ms-client-type":(0,hP.I)(e,t)},credentials:"include",apiName:"consumerGroupsImageAuthCookie"})}function vP(e,t){const i=(0,qe.v4)();return()=>({url:"v1/imageauth/deletecookie",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",RequestId:i,CorrelationId:i,TransactionId:i,"x-ms-client-type":(0,hP.I)(e,t)},credentials:"include",apiName:"consumerGroupsImageAuthCookie"})}const fP="tfl_media_auth_cookie_service";class bP{constructor(e,t,i,n,a,s,o,r,c){var l,d;this._endpointsManager=t,this._platformService=i,this._authenticationService=n,this._networkState=a,this._coreSettings=s,this._authStateProvider=o,this._config=r,this._localStorage=c,this._imageAuthCookieExpiryTsKey="ConsumerGroupsImageAuthCookieExpiryTs",this._imageCookieRetryInterval=2e4,this._imageCookieRetryMaxCount=5,this._authStateSubscription=void 0,this._networkStateSubscription=void 0,this._isInitialized=!1,this.setupConsumerGroupsImageAuthCookieEndpoints=({discover:e,authenticationResources:t,authenticationService:i})=>({baseUrlPromise:()=>e.regionGtm(N.Pn.groupsServiceV2),serviceName:br.E.GroupsServiceV2,authResource:(0,mP.Nc)(i,t,mP.jP),models:{setupConsumerGroupsImageAuthCookie:this.setupConsumerGroupsImageAuthCookie(),deleteConsumerGroupsImageAuthCookie:this.deleteConsumerGroupsImageAuthCookie()}}),this._logger=e.newLogger("Consumer Groups media auth service","services-io-browser-consumer-groups-media-auth-service"),this._imageCookieRetryInterval=(null===(l=this._coreSettings.get(S.J.ConsumerGroups))||void 0===l?void 0:l.imageCookieRetryInterval)||2e4,this._imageCookieRetryMaxCount=(null===(d=this._coreSettings.get(S.J.ConsumerGroups))||void 0===d?void 0:d.imageCookieRetryMaxCount)||5,this._window=(0,R.J)(),this._consumerGroupsImageAuthCookieApi=this._endpointsManager.createApi(this.setupConsumerGroupsImageAuthCookieEndpoints)}initConsumerGroupsMediaAuthService(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this._isInitialized)this.logToTelemetry("ConsumerGroupsMediaAuthService already initiated, skipping initialization");else{this.logToTelemetry("initiating ConsumerGroupsMediaAuthService");try{yield this.fetchCookie("serviceInit"),this.subscribeToAuthStateChange(),this.subscribeToNetworkStateChange(),this.logToTelemetry("ConsumerGroupsMediaAuthService initiated"),this._isInitialized=!0}catch(e){this.logToTelemetry("failed to initiate ConsumerGroupsMediaAuthService",!0)}}}))}logout(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.cleanupCookieExpireInfo();try{yield this._consumerGroupsImageAuthCookieApi.deleteConsumerGroupsImageAuthCookie(),this._authStateSubscription&&this._authStateSubscription.unsubscribe(),this._networkStateSubscription&&this._networkStateSubscription.unsubscribe(),this._cookieRefetchInterval&&this._window.clearTimeout(this._cookieRefetchInterval),this.logToTelemetry("deleted cookie on logout")}catch(e){this.logToTelemetry("failed to delete cookie on logout",!0)}}))}checkIsCookieExpired(){var e;const t=null===(e=this._localStorage)||void 0===e?void 0:e.get(this._imageAuthCookieExpiryTsKey,"Global");if(!t)return this.logToTelemetry("cookie not found"),!0;if(t){const e=1e3*Number(t);if(Date.now()>e)return this.logToTelemetry("cookie expired"),!0}return!1}fetchCookie(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.checkIsCookieExpired())return void this.logToTelemetry(`cookie not expired, skipping fetchCookie for ${e}`);const t=yield this.getAuthToken();try{t&&(null==t?void 0:t.expires)&&(yield this._consumerGroupsImageAuthCookieApi.setupConsumerGroupsImageAuthCookie(),yield this.storeCookieExpireInfo(t.expires),this.handleCookieRefetchInterval(t.expires),this.logToTelemetry(`setupConsumerGroupsImageAuthCookie successful for ${e}`))}catch(t){this.logToTelemetry(`setupConsumerGroupsImageAuthCookie error for ${e}`,!0)}}))}getImageCookieRetryPolicy(){return{shouldRetry:gP(this._imageCookieRetryMaxCount,this._logger),nextDelay:(e=this._imageCookieRetryInterval,t=>e*Math.pow(2,t))};var e}storeCookieExpireInfo(e){var t;null===(t=this._localStorage)||void 0===t||t.set(this._imageAuthCookieExpiryTsKey,`${e}`,"Global"),this.logToTelemetry("consumer groups cookie expire info stored in local storage succesfully")}handleCookieRefetchInterval(e){this._cookieRefetchInterval&&(this.logToTelemetry(`clearing previous cookie refetch interval: ${this._cookieRefetchInterval}`),this._window.clearTimeout(this._cookieRefetchInterval)),this.logToTelemetry(`setting cookie refetch interval at: ${e}`),this._cookieRefetchInterval=this._window.setTimeout((()=>this.fetchCookie("cookieRefetchInterval")),function(e){const t=1e3*e-Date.now();return Math.max(t,6e4)}(e))}getAuthToken(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{if("function"==typeof(null===(e=this._authenticationService)||void 0===e?void 0:e.acquireTokenV2)){const e=yield this._authenticationService.acquireTokenV2(mP.jP);return this.logToTelemetry("getAuthToken successful"),e}return void this.logToTelemetry("getAuthToken failed due to missing acquireTokenV2 method")}catch(e){return void this.logToTelemetry("failed to get auth Token",!0)}}))}cleanupCookieExpireInfo(){var e;null===(e=this._localStorage)||void 0===e||e.remove(this._imageAuthCookieExpiryTsKey,"Global")}logToTelemetry(e,t){var i,n,a,s;t?null===(s=(a=this._logger).errorToTelemetry)||void 0===s||s.call(a,e,fP,void 0,!0):null===(n=(i=this._logger).infoToTelemetry)||void 0===n||n.call(i,e,fP,void 0,!0)}subscribeToNetworkStateChange(){this._networkStateSubscription=this._networkState.observeIsOnline().pipe((0,er.x)(),(0,u.h)((e=>!!e))).subscribe((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){this.logToTelemetry("network state changed to online, checking cookie"),yield this.fetchCookie("networkStateChange")}))))}subscribeToAuthStateChange(){var e;this._authStateProvider?this._authStateSubscription=null===(e=this._authStateProvider)||void 0===e?void 0:e.observe().pipe((0,er.x)(),(0,u.h)((e=>e.state===Lr.j.Up))).subscribe((()=>{this.logToTelemetry("Auth state back Up, checking cookie"),this.fetchCookie("authStateChange")})):this.logToTelemetry("authStateProvider is not available",!0)}deleteConsumerGroupsImageAuthCookie(){return Promise.resolve({constructRequest:vP(this._platformService,this._config),allowedResponses:[pr.qj.HTTP_2XX]})}setupConsumerGroupsImageAuthCookie(){return Promise.resolve({constructRequest:pP(this._platformService,this._config),allowedResponses:[pr.qj.HTTP_2XX],retryPolicy:this.getImageCookieRetryPolicy()})}}class yP extends Ue{constructor(){super(h.Yg.InitConsumerGroupsMediaAuthTask,["authStateProvider","authenticationService","config","coreSettings","endpointsManager","localStorage","loggerFactory","networkState","platformService"])}execute(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=null===(t=e.coreSettings)||void 0===t?void 0:t.get(S.J.ConsumerGroups);if(!(null==i?void 0:i.useGroupsProfilePicCookieService))return;const a=function(e,t,i,n,a,s,o,r,c){return new bP(e,t,i,n,a,s,o,r,c)}(e.loggerFactory,e.endpointsManager,e.platformService,e.authenticationService,e.networkState,e.coreSettings,e.authStateProvider,e.config,e.localStorage);return e.consumerGroupsMediaAuthService=a,a.initConsumerGroupsMediaAuthService(),e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){"signout"===e&&(yield a.logout())}))}))}}var kP;!function(e){e.debugPii="debugPii",e.debug="debug",e.info="info",e.warning="warning",e.error="error"}(kP||(kP={}));class SP{constructor(e){this.context=e,this.enabled=!1,this.globalWindow=window}writeToEtw(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this.enabled){const i=yield null===(t=this.context.hostCommunicationService)||void 0===t?void 0:t.loadModule("etw"),n={message:e,channel:"JS_ETW",severity:kP.debug};(null==i?void 0:i.writeEtwEvent)&&(null==i||i.writeEtwEvent(n))}}))}start(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield this.registerEtwUpdates()}))}isPromiseRejectionEvent(e){return"reason"in e}isErrorEvent(e){return"message"in e}handleError(e){if(this.isPromiseRejectionEvent(e))this.writeToEtw(`${e.reason.message}\n${e.reason.stack}`);else if(this.isErrorEvent(e)){const t=[e.message,e.filename,e.lineno,e.colno,e.context,e.code,e.subContext].filter(Boolean).join(",");this.writeToEtw(t)}}registerErrorHandlers(){this.globalWindow.addEventListener("unhandledrejection",this.handleError.bind(this)),this.globalWindow.addEventListener("error",this.handleError.bind(this))}unregisterErrorHandlers(){this.globalWindow.removeEventListener("unhandledrejection",this.handleError),this.globalWindow.removeEventListener("error",this.handleError.bind(this))}registerEtwUpdates(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield null===(e=this.context.hostCommunicationService)||void 0===e?void 0:e.loadModule("etw");if(null==t?void 0:t.registerForTracingChanged)try{t.registerForTracingChanged((e=>{this.enabled=e.enabled,e.enabled?this.registerErrorHandlers():this.unregisterErrorHandlers()}))}catch(e){}}))}}class wP extends Ue{constructor(){super(h.Yg.InitEtwTask,[])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=new SP(e);yield t.start()}))}}class jP{constructor(e,t){var i,n,a,o,r,c,l,d,u,m,g,h;this.coreSettings=e,this.hostCommunicationService=t;const p=this.coreSettings.get(S.J.Metadata);this.expConfigMetadata=[{client:$A,config:{expIds:null!==(a=null===(n=null===(i=p.configIds)||void 0===i?void 0:i.experiments)||void 0===n?void 0:n.join(","))&&void 0!==a?a:"",rolloutIds:null!==(c=null===(r=null===(o=p.configIds)||void 0===o?void 0:o.rollouts)||void 0===r?void 0:r.join(","))&&void 0!==c?c:"",eTag:null!==(l=p.eTag)&&void 0!==l?l:"",expRolloutIdAllowList:null!==(u=null===(d=p.expRolloutIdAllowList)||void 0===d?void 0:d.join(""))&&void 0!==u?u:""}},{client:WA,config:{expIds:"",rolloutIds:"",eTag:null!==(m=p.hostETag)&&void 0!==m?m:"",expRolloutIdAllowList:null!==(h=null===(g=p.expRolloutIdAllowList)||void 0===g?void 0:g.join(""))&&void 0!==h?h:""}}],this.subject=new s.X(this.expConfigMetadata),this.ecmObservable=this.subject.asObservable(),this.registerSyncHostEcm()}updateHostExperimentConfigMetadata(e){const t=e.find((e=>e.client===WA)),i=this.expConfigMetadata.findIndex((e=>e.client===WA));t&&i>-1&&(this.expConfigMetadata[i]=t,this.subject.next(this.expConfigMetadata))}updateWebExperimentConfigMetadata(e){var t,i,n,a;const s=null===(t=this.expConfigMetadata.find((e=>e.client===$A)))||void 0===t?void 0:t.config;s&&e.eTag&&e.configIds&&e.configIds.experiments&&(s.eTag=e.eTag,s.expIds=e.configIds.experiments.join(","),s.expRolloutIdAllowList=null!==(n=null===(i=e.expRolloutIdAllowList)||void 0===i?void 0:i.join(","))&&void 0!==n?n:"",(null===(a=e.expRolloutIdAllowList)||void 0===a?void 0:a.length)&&(s.rolloutIds=VA(e).join(",")))}communicateWithHost(){var e,t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=null===(e=this.expConfigMetadata.find((e=>e.client===$A)))||void 0===e?void 0:e.config;if(!i)return;const n=yield this.hostCommunicationService.loadModule("ecs");if(!n)return;const a=yield null===(t=n.syncEcm)||void 0===t?void 0:t.call(n,[{client:$A,config:i}]);if(a&&a.client===WA){const e=[{client:WA,config:{eTag:a.config.eTag,expIds:a.config.expIds,rolloutIds:a.config.rolloutIds,expRolloutIdAllowList:a.config.expRolloutIdAllowList}}];this.updateHostExperimentConfigMetadata(e)}}))}registerSyncHostEcm(){this.hostCommunicationService.loadModule("ecs").then((e=>{var t;null===(t=null==e?void 0:e.registerForOnSyncEcm)||void 0===t||t.call(e,(e=>{this.updateHostExperimentConfigMetadata(e)}))}))}}class CP extends Ue{constructor(){super(h.Yg.InitExperimentation,["coreSettings","hostCommunicationService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,hostCommunicationService:i}=e;e.experimentationService=new jP(t,i)}))}}class _P extends Ue{constructor(){super(h.Yg.InitPreAuthSettingsEcsProvider,[])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=mg("InitPreAuthSettingsEcsProvider",e,"coreSettings","coreSettingsContext","loggerFactory","scenarioFactory","networkState","clientState","windowProvider","endpointsManager"),{coreSettings:i,coreSettingsContext:a,loggerFactory:s}=t,o=(0,n.__rest)(t,["coreSettings","coreSettingsContext","loggerFactory"]),{enablePreAuthEcsFetch:r}=i.get(S.J.Core);if(!r)return;const c=a;yield c.initializeEcsProvider(Object.assign({},o))}))}}class TP extends Ue{constructor(){super(h.Yg.InitSettingsEcsProvider,["coreSettings","coreSettingsContext","authenticationService","loggerFactory","scenarioFactory","networkState","clientState","windowProvider","endpointsManager"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,coreSettingsContext:i,authenticationService:a,loggerFactory:s,scenarioFactory:o,networkState:r,clientState:c,windowProvider:l,endpointsManager:d}=e,u=i,m=()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){h||(yield u.fetchEcsSettingsIfApplicable())})),{enablePreAuthEcsFetch:g}=t.get(S.J.Core),h=yield this.getPrimaryUser(a,s);yield u.setPrimaryUser(h),g||(yield u.initializeEcsProvider({scenarioFactory:o,networkState:r,clientState:c,windowProvider:l,endpointsManager:d,authenticationUser:h})),yield m()}))}getPrimaryUser(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n;try{const t=yield null===(i=e.getCachedUsers)||void 0===i?void 0:i.call(e,{id:(0,$r.pW)(),scenarioName:z.RG.AuthWebCachedUser,source:"init-settings-ecs-provider-task"},{isPrimaryUser:!0});t&&t.length>0&&(n=(0,He.KQ)(t[0]))}catch(e){t.newLogger("InitSettingsEcsProviderTask","core-services-tasks").warn("No primary user returned from authentication: ",e)}return n}))}}class IP extends Ue{constructor(){super(h.Yg.InitSettingsMaglevHostProvider,["coreSettingsContext","hostCommunicationService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettingsContext:t,hostCommunicationService:i}=e,{enableMaglevHostProvider:n}=t.getCoreSettings().get(S.J.Core);n&&(yield t.initializeMaglevHostProvider(i))}))}}class NP{constructor(e,t,i,n,a,s,o){this.scenarioFactory=a,this.host=s,this.clientStateProvider=o,this.namespacesToFetch=[],this.settings={},this.refreshIntervalInMs=36e5,this.fetch=()=>{if(0===this.namespacesToFetch.length)return this.logger.debug("Skipping fetch() as no namespacesToFetch registered."),Promise.resolve();const e=this.scenarioFactory.newScenario(this.getScenarioName());return this.validateEnvironment().then((()=>this.fetchPolicies(e))).catch((t=>{e.stop({errors:t},"abandoned"),this.logger.warn(`Error fetching policies: ${t}`)}))},this.validateEnvironment=()=>new Promise(((e,t)=>{this.clientStateProvider.getState()===$e.pk.VeryActive&&(this.logger.log("Cancel policy fetching, due to app being in a very active state."),t("very active")),e()})),this.cleanupClientStateSubscription=()=>{var e;null===(e=this.clientStateSubscription)||void 0===e||e.unsubscribe(),this.clientStateSubscription=void 0},this.logger=e.newLogger(`CoreSettings/${t}`,"services-io-data-policies"),this.namespacesToFetch=(0,Uu.z$)(i,n,this.logger),this.namespacesToFetch.forEach((e=>{this.settings[e]={}})),this.updateConfigs(n)}initialize(e=!0){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.isInitialized=!0,yield this.fetchAndSetRefreshCadence()}))}subscribeForSettingsUpdates(e){this.settingsChangedCallbackFunction=e}cleanup(){var e;this.cleanupClientStateSubscription(),this.settingsChangedCallbackFunction=void 0,null===(e=this.coreSubscription)||void 0===e||e.unsubscribe(),this.coreSubscription=void 0}notifySettingsChanged(){const e=()=>{var e;this.cleanupClientStateSubscription(),null===(e=this.settingsChangedCallbackFunction)||void 0===e||e.call(this,this.settings),this.logger.debug("Notified about policy change")};return this.clientStateProvider.getState()!==$e.pk.VeryActive?(e(),!0):(this.clientStateSubscription||(this.clientStateSubscription=this.clientStateProvider.observe().subscribe((t=>{t!==$e.pk.VeryActive&&e()}))),!1)}handleError(e){this.logger.error(`Failed to fetch tenant settings with error: ${e}`)}updateConfigs(e){const t=e.getObservable(S.J.Core);this.coreSubscription=t.subscribe((e=>{e.policyRefreshIntervalInMs&&this.updateRefreshCadence(e.policyRefreshIntervalInMs)}))}updateRefreshCadence(e){this.refreshIntervalInMs=e,this.isInitialized&&this.queueNextPolicyFetch()}fetchAndSetRefreshCadence(){return this.fetch().then((()=>{this.queueNextPolicyFetch()})).catch((e=>{this.logger.error(`Error fetching policies: ${e}`)}))}queueNextPolicyFetch(){if(!this.isInitialized)throw new Error("Service not initialized to queue the fetch.");this.setIntervalHandle&&(this.host.clearInterval(this.setIntervalHandle),this.setIntervalHandle=void 0,this.logger.debug("clearInterval() called.")),this.refreshIntervalInMs>0?(this.setIntervalHandle=this.host.setInterval(this.fetch,this.refreshIntervalInMs),this.logger.debug("setInterval() called.")):this.logger.error(`Refresh interval not valid: ${this.refreshIntervalInMs}`)}}class EP extends NP{constructor(e,t,i,n,a,s){super(e,"PoliciesIpcDataProvider",t,i,n,a,s),this.handleSetAggregatedSettings=e=>{const{payload:t}=e;Object.keys(t).length>0?(this.logger.log(`handleSetAggregatedSettings() called: ${Object.keys(t).join(", ")}.`),this.parsePolicies(t),this.notifySettingsChanged()):this.logger.log("handleSetAggregatedSettings() called with empty payload.")},this.windowOpener=a.opener}initialize(e=!0){const t=Object.create(null,{initialize:{get:()=>super.initialize}});return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.windowOpener.addEventListener(L.rY.SetAggregatedSettings,this.handleSetAggregatedSettings),t.initialize.call(this)}))}cleanup(){super.cleanup(),this.windowOpener.removeEventListener(L.rY.SetAggregatedSettings,this.handleSetAggregatedSettings)}getScenarioName(){return z.RG.IPCPolicyFetch}fetchPolicies(e){return this.windowOpener.requestMessage(L.rY.GetAggregatedSettings).then((t=>{let i=!1,n="success";const a=null==t?void 0:t.data;a&&0!==Object.keys(a).length?(this.logger.log(`fetchPolicies: Got policies for namespaces: ${Object.keys(a).join(", ")}.`),this.parsePolicies(a),i=this.notifySettingsChanged()):(this.logger.log("Failed to fetch policies via IPC, got empty payload data response."),n="incomplete"),e.stop({message:(0,U.u4)({notified:i})},n)})).catch((t=>{var i;this.handleError(t),e.fail({errors:null!==(i=t.message)&&void 0!==i?i:"Failed to fetch policies via IPC."})}))}parsePolicies(e){this.namespacesToFetch.forEach((t=>{e[t]&&e[t].hasOwnProperty("value")&&(this.settings[t]=e[t].value)}))}}const FP={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"policies"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"correlationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"namespaces"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policies"},arguments:[{kind:"Argument",name:{kind:"Name",value:"correlationId"},value:{kind:"Variable",name:{kind:"Name",value:"correlationId"}}},{kind:"Argument",name:{kind:"Name",value:"namespaces"},value:{kind:"Variable",name:{kind:"Name",value:"namespaces"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"jsonData"}}]}}]}}]},xP={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"policiesUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policiesUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"jsonData"}}]}}]}}]};class DP extends NP{constructor(e,t,i,n,a,s,o){super(e,"PoliciesResolversDataProvider",t,i,n,a,o),this.apolloClient=s,this.handlePoliciesUpdatedEvent=e=>{this.logger.log("handlePoliciesUpdatedEvent() called.");try{void 0!==e&&this.parsePolicies(e)?this.notifySettingsChanged():this.logger.log(`handlePoliciesUpdatedEvent(): policiesString is ${void 0===e?"undefined":"empty"}.`)}catch(e){this.logger.error(`handlePoliciesUpdatedEvent(): ${e.message}`)}}}initialize(e=!0){const t=Object.create(null,{initialize:{get:()=>super.initialize}});return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=this;return this.policiesApolloSubscription=this.apolloClient.subscribe({query:xP}).subscribe({next(t){var i,n,a;e.handlePoliciesUpdatedEvent(null!==(a=null===(n=null===(i=null==t?void 0:t.data)||void 0===i?void 0:i.policiesUpdatedEvent)||void 0===n?void 0:n.jsonData)&&void 0!==a?a:void 0)}}),t.initialize.call(this)}))}cleanup(){var e;super.cleanup(),null===(e=this.policiesApolloSubscription)||void 0===e||e.unsubscribe(),this.policiesApolloSubscription=void 0}getScenarioName(){return z.RG.PoliciesFetchDataResolvers}fetchPolicies(e){return this.apolloClient.query({query:FP,variables:{correlationId:e.id,namespaces:this.namespacesToFetch},fetchPolicy:"no-cache"}).then((t=>{var i,n,a,s,o;(null==t?void 0:t.error)&&(null===(n=(i=this.logger).errorToTelemetry)||void 0===n||n.call(i,`fetchPolicies:then: Message: ${t.error.message}.`,"webclient_framework_policies_resolvers_fetch_failed_event",void 0,!0)),(null==t?void 0:t.errors)&&t.errors.forEach((e=>{var t,i;null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,`fetchPolicies:then: Errors:Message: ${e.message}.`,"webclient_framework_policies_resolvers_fetch_failed_event",void 0,!0)}));const r=null!==(o=null===(s=null===(a=null==t?void 0:t.data)||void 0===a?void 0:a.policies)||void 0===s?void 0:s.jsonData)&&void 0!==o?o:void 0;let c=!1,l="success";void 0!==r&&this.parsePolicies(r)?c=this.notifySettingsChanged():(this.logger.log(`fetchPolicies(): Failed to fetch policies, got ${void 0===r?"undefined":"empty"} response.`),l="incomplete"),e.stop({message:(0,U.u4)({notified:c})},l)})).catch((t=>{var i;this.handleError(t),e.fail({errors:null!==(i=t.message)&&void 0!==i?i:"Failed to fetch policies via resolvers."})}))}parsePolicies(e){let t={};try{t=JSON.parse(e)}catch(e){throw new Error("parsePolicies(): Unable to parse policies string.")}return 0!==Object.keys(t).length&&(this.namespacesToFetch.forEach((e=>{t[e]&&(this.settings[e]=t[e])})),!0)}}class AP extends Ue{constructor(){super(h.Yg.InitSettingsPolicyProvider,["authenticationUser","coreSettings","coreSettingsContext","loggerFactory"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:i,coreSettingsContext:n,loggerFactory:a}=e,{disableNonBlockingPolicyProviderInit:s,disablePolicyProvider:o}=i.get(S.J.Core);if(o)return;if(!t||t.role===zo.w4.Anonymous)return;const r=this.createPoliciesDataProvider(e),{enableMainWindowPolicyFetch:c}=i.get(S.J.Host);if(c||s)yield n.initializePolicyProvider(r);else{const e=a.newLogger("InitPolicyProviderTask","core-services-tasks");n.initializePolicyProvider(r).then((()=>{e.log("Initialized policy provider successfully.")})).catch((t=>{e.errorToTelemetry&&e.errorToTelemetry(`Initialization of policy provider failed. ${t}`,"webclient_framework_foundation_core_services",void 0,!0)}))}return e=>{if("signout"===e)r.cleanup()}}))}createPoliciesDataProvider(e){const{client:t,clientState:i,configLoader:n,coreSettings:a,loggerFactory:s,scenarioFactory:o,windowProvider:r}=e;let c;const{enableMainWindowPolicyFetch:l}=a.get(S.J.Host);return c=l?new EP(s,n,a,o,r,i):new DP(s,n,a,o,r,t,i),c}}const MP="preReleaseFeaturesAllowed";class PP extends Ue{constructor(){super(h.Yg.InitSettingsWithDiscoveredUser,["authenticationService","authenticationUser","config","coreSettings","coreSettingsContext","endpointsManager","localStorage","loggerFactory","platformService","user"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{authenticationService:t,authenticationUser:i,config:n,coreSettings:a,coreSettingsContext:s,endpointsManager:o,localStorage:r,loggerFactory:c,platformService:l,user:d}=e;let u={};const{enablePreReleaseClientFilter:m}=a.get(S.J.Core);if(m){const e=yield this.getPreReleaseUserInfo({authenticationService:t,authenticationUser:i,config:n,coreSettings:a,endpointsManager:o,localStorage:r,loggerFactory:c,platformService:l});u=Object.assign(Object.assign({},u),{preReleaseFeaturesAllowed:e})}const g=s,{enableMTMA:h}=a.get(S.J.Core),p=!h||(yield dm(t,i));yield g.initializeProvidersWithDiscoveredUser(d,p,u)}))}getPreReleaseUserInfo({authenticationService:e,authenticationUser:t,config:{experienceName:i},coreSettings:a,endpointsManager:s,localStorage:o,loggerFactory:r,platformService:c}){var l;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=r.newLogger("InitSettingsWithDiscoveredUserTask","core-services-tasks"),{preReleaseFeaturesAllowed:d}=a.get(S.J.Metadata);if(!d)return n.log("No pre release features are allowed."),!1;if(yield dm(e,t))return n.log(`Returning preReleaseAllowed filter for primary user: ${d}`),!!d;try{const e=o.get(MP);if(null!=e)return n.log(`Cached preReleaseAllowed filter loaded: ${e}`),JSON.parse(e);const l={userId:null==t?void 0:t.profile.objectId,tenantId:null==t?void 0:t.profile.tenantId},d=(0,mh.xb)({coreSettings:a,experienceName:i,platformService:c,user:l,logger:n}),u=(0,dh.bn)({serviceName:"ClientFilters",ecsParameters:d,loggerFactory:r,endpointsManager:s}),m=yield u.fetch(),g=this.getValueFromPayload(m,d);return void 0!==g?(n.log(`Storing preReleaseAllowed filter in cache: ${g}`),o.set(MP,g.toString())):n.log("Could not get preReleaseAllowed filter from ECS."),!!g}catch(e){null===(l=n.errorToTelemetry)||void 0===l||l.call(n,(0,$r.u4)(e),"web_infra_determine_pre_release_filter_failed")}return!1}))}getValueFromPayload(e,t){var i;if(e.requestStatus===uh.m.Success)return null===(i=t.agents)||void 0===i?void 0:i.some((t=>{var i,n;const a=null===(i=e.ecsConfiguration)||void 0===i?void 0:i[t];return!!(null===(n=null==a?void 0:a.metadata)||void 0===n?void 0:n.preReleaseFeaturesAllowed)}))}}class OP extends Ue{constructor(){super(h.Yg.InitSettingsWithPrimaryUser,["coreSettingsContext","authenticationUser"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettingsContext:t,authenticationUser:i}=e;return yield t.setPrimaryUser(i),e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){if("signout"===e)yield t.setPrimaryUser(void 0)}))}))}}var RP;!function(e){e[e.ComposeMessageTyping=0]="ComposeMessageTyping",e[e.MessageListScroll=1]="MessageListScroll",e[e.PowerbarTyping=2]="PowerbarTyping",e[e.VirtualTreeListScroll=3]="VirtualTreeListScroll",e[e.FeedsFilterTyping=4]="FeedsFilterTyping",e[e.PeoplePickerTyping=5]="PeoplePickerTyping",e[e.SearchBoxTyping=6]="SearchBoxTyping",e[e.FloodgatePopup=7]="FloodgatePopup",e[e.ChatListSearchFilterTyping=8]="ChatListSearchFilterTyping",e[e.ChannelListSearchFilterTyping=9]="ChannelListSearchFilterTyping",e[e.CallingPerfSample=10]="CallingPerfSample",e[e.AllChannelSystemMessagesScroll=11]="AllChannelSystemMessagesScroll",e[e.AllPinnedPostsScroll=12]="AllPinnedPostsScroll",e[e.DiscoverSurfaceFeedListScroll=13]="DiscoverSurfaceFeedListScroll",e[e.TeamsAndChannelsTableScroll=14]="TeamsAndChannelsTableScroll",e[e.PostComposeTyping=15]="PostComposeTyping",e[e.UnifiedFunPickerTyping=16]="UnifiedFunPickerTyping",e[e.CreateTeamGalleryScroll=17]="CreateTeamGalleryScroll",e[e.AddMemberScroll=18]="AddMemberScroll",e[e.MeetForWorkListScroll=19]="MeetForWorkListScroll",e[e.MeetForWorkSearchFilterTyping=20]="MeetForWorkSearchFilterTyping",e[e.PeopleAppContactListScroll=21]="PeopleAppContactListScroll"}(RP||(RP={}));var LP=i(303244);class UP{constructor(e){this.histogram=new Map,this.bucketSize=e.bucketSize,this.maxBucketValue=e.maxBucketValue,this.fixedDecimals=function(e){let t=0;const i=10;for(;Math.floor(e)!==e;)e*=i,t++;return t}(this.bucketSize)}record(e,t){t=(t=t||1)<1?1:t;const i=Math.min(Math.floor(e/this.bucketSize)*this.bucketSize,this.maxBucketValue).toFixed(this.fixedDecimals),n=this.histogram.get(i)||0;this.histogram.set(i,n+t)}toObject(){const e={};return Array.from(this.histogram.keys()).forEach((t=>e[t]=this.histogram.get(t))),e}clear(){this.histogram.clear()}}const $P="getAndClearAriTelemetry";class WP{constructor(e,t){this.host=e,this.context=t,this.startSlot=0,this.blinkInterval=100,this.trailingTimespan=h.B.second,this.rafRecords=new Map,this.activeUserActionType=void 0,this.wheelEventTriggeredUserActionType=void 0,this.userActions=new Map,this.validActions=new Map,this.lastEventTimeSlot=this.startSlot,this.isDebugging=!1,this.minAriDuration=200,this.minEtwTriggeringDelay=1e3,this.minEtwTriggeringFrameDelay=1e3,this.lastRafTime=0,this.strategies=[{name:"TwoRafAndLimitedStopTimeStrategy",lowestAllowedRafs:2,allowStopTimeOverwrite:!0}],this.logger=t.loggerFactory.newLogger("ARI","core-services-telemetry"),this.hostCommunicationService=t.hostCommunicationService,this.initializeOnAppLaunchAndReinit(),this.__initTestingMode__(this.context.coreSettings.get(S.J.Host)),this.defaultHost=e}trackEvent(e,t,i,n,a,s){const o=this.getUserActionType(e,t),{isDebugging:r,logger:c}=this;if(void 0===o||!(o in RP))return void(r&&c.debug(`[${this.formatActionKey(e,t)}] TrackEvent | No action found`));if(s)return void(this.wheelEventTriggeredUserActionType=o);const l=this.getMeasurementName(o),d=n.performance.now();if(r&&c.debug(`[${l} TrackEvent | [${Math.round(i)}...${Math.round(d)}] ${Math.round(d-i)}ms`),void 0===this.activeUserActionType)r&&c.debug(`[${l}] track-start`),this.startMeasurement(o,i,n,a);else if(this.activeUserActionType!==o||this.host!==n||this.actionLocation!==a)r&&c.debug(`[${l}] track-stop`),this.stopMeasurement(n),r&&c.debug(`[${l}] track-start`),this.startMeasurement(o,i,n,a);else{if(r){const e=`[${l}] track-continue`;c.debug(e),function(e,t,i){e.mark(t,i),e.clearMarks(t)}(this.host.performance,e,{startTime:i})}this.continueMeasurement(i)}}handleUnmount(e){this.stopMeasurement(e)}getTelemetry(e=LP.xL.HeartbeatMonitor){return this.getTelemetryFilteredByType(e)}getTelemetryTypeForAction(e){return e===RP.CallingPerfSample?LP.xL.CallingPerfMonitor:LP.xL.HeartbeatMonitor}isActionOfTelemetryType(e,t){return this.getTelemetryTypeForAction(e)===t}getTelemetryFilteredByType(e){void 0!==this.activeUserActionType&&this.isActionOfTelemetryType(this.activeUserActionType,e)&&this.stopMeasurement();const t={};let i=!1;const n={totalIntervalCount:0,passIntervalCount:0,measurements:0,wheelMeasurements:0,max:{totalIntervalCount:0,passIntervalCount:0}};this.userActions.forEach(((a,s)=>{if(void 0!==RP[a.type]&&this.isActionOfTelemetryType(a.type,e)){const e={};a.scores.forEach(((t,i)=>{(e=>{e&&(n.passIntervalCount+=e.passIntervalCount,n.totalIntervalCount+=e.totalIntervalCount,n.measurements+=e.measurements,n.wheelMeasurements+=e.wheelMeasurements,n.max.passIntervalCount=Math.max(n.max.passIntervalCount,e.passIntervalCount),n.max.totalIntervalCount=Math.max(n.max.totalIntervalCount,e.totalIntervalCount))})(t),e[i]=this.getAri(t),e[`${i}-score`]=t})),a.scoreHistograms.forEach(((t,i)=>{e[`${i}-scoreHistogram`]=t.toObject()})),e.frameDelayHistogram=a.frameDelayHistogram.toObject(),t[s]=e,i=!0,this.userActions.delete(s),this.isDebugging&&this.logger.debug(`[AppResponsivenessService]: clear action for type ${RP[a.type]}`)}})),t.Total=this.getAri(n),t.score=n;let a="";if(i)try{a=JSON.stringify(t)}catch(e){this.logger.error("[AppResponsivenessService]: unexpected error parsing log object. Likely because of circular reference.")}return a}clearTelemetry(){this.userActions.clear(),this.clearTelemetryTimeoutId&&this.context.windowProvider.clearTimeout(this.clearTelemetryTimeoutId),this.clearTelemetryTimeoutId=this.context.windowProvider.setTimeout((()=>{this.clearTelemetry()}),h.B.tenMinutes,!1)}initializeOnAppLaunchAndReinit(){this.initSettings(),this.registerValidActions(),this.clearTelemetry()}__initTestingMode__(e){if(e){const t=e.userType;t&&t.indexOf("test")>-1&&(this.isDebugging=!0,$P in window||(window[$P]=()=>{const e=this.getTelemetry();return this.clearTelemetry(),e}))}}registerValidActions(){this.validActions.set(this.formatActionKey(LP.PG.Floodgate,h.f_.System),RP.FloodgatePopup),this.validActions.set(this.formatActionKey(LP.PG.ComposeMessage,h.f_.Keyup),RP.ComposeMessageTyping),this.validActions.set(this.formatActionKey(LP.PG.MessageList,h.f_.Scroll),RP.MessageListScroll),this.validActions.set(this.formatActionKey(LP.PG.Powerbar,h.f_.Keyup),RP.PowerbarTyping),this.validActions.set(this.formatActionKey(LP.PG.VirtualTreeList,h.f_.Scroll),RP.VirtualTreeListScroll),this.validActions.set(this.formatActionKey(LP.PG.FeedsFilter,h.f_.Keyup),RP.FeedsFilterTyping),this.validActions.set(this.formatActionKey(LP.PG.PeoplePicker,h.f_.Keyup),RP.PeoplePickerTyping),this.validActions.set(this.formatActionKey(LP.PG.PostCompose,h.f_.Keyup),RP.PostComposeTyping),this.validActions.set(this.formatActionKey(LP.PG.SearchBox,h.f_.Keyup),RP.SearchBoxTyping),this.validActions.set(this.formatActionKey(LP.PG.ChatListSearchFilter,h.f_.Keyup),RP.ChatListSearchFilterTyping),this.validActions.set(this.formatActionKey(LP.PG.ChannelListSearchFilter,h.f_.Keyup),RP.ChannelListSearchFilterTyping),this.validActions.set(this.formatActionKey(LP.PG.CallingPerf,h.f_.Sample),RP.CallingPerfSample),this.validActions.set(this.formatActionKey(LP.PG.DiscoverSurfaceFeedList,h.f_.Scroll),RP.DiscoverSurfaceFeedListScroll),this.validActions.set(this.formatActionKey(LP.PG.AllPinnedPosts,h.f_.Scroll),RP.AllPinnedPostsScroll),this.validActions.set(this.formatActionKey(LP.PG.AllChannelSystemMessages,h.f_.Scroll),RP.AllChannelSystemMessagesScroll),this.validActions.set(this.formatActionKey(LP.PG.TeamsAndChannelsTable,h.f_.Scroll),RP.TeamsAndChannelsTableScroll),this.validActions.set(this.formatActionKey(LP.PG.UnifiedFunPicker,h.f_.Keyup),RP.UnifiedFunPickerTyping),this.validActions.set(this.formatActionKey(LP.PG.CreateTeamGallery,h.f_.Scroll),RP.CreateTeamGalleryScroll),this.validActions.set(this.formatActionKey(LP.PG.AddMember,h.f_.Scroll),RP.AddMemberScroll),this.validActions.set(this.formatActionKey(LP.PG.MeetForWorkList,h.f_.Scroll),RP.MeetForWorkListScroll),this.validActions.set(this.formatActionKey(LP.PG.MeetForWorkSearchFilter,h.f_.Keyup),RP.MeetForWorkSearchFilterTyping),this.validActions.set(this.formatActionKey(LP.PG.PeopleAppContactList,h.f_.Scroll),RP.PeopleAppContactListScroll)}getUserActionType(e,t){const i=this.formatActionKey(t,e);return this.validActions.get(i)}formatActionKey(e,t){return`${e}_${t}`}registerRafCallback(){this.rafCallbackId||(this.lastRafTime=this.host.performance.now(),this.rafCallbackId=this.host.requestAnimationFrame((()=>this.measureRaf())))}unregisterRafCallback(){this.rafCallbackId&&(this.host.cancelAnimationFrame(this.rafCallbackId),this.clearRaf())}clearRaf(){this.rafCallbackId=void 0,this.rafRecords.clear()}getAri(e){return e&&0!==e.totalIntervalCount?Math.round(e.passIntervalCount/e.totalIntervalCount*h.B.second)/h.B.second:0}initSettings(){const{enableAriDebugging:e,appResponsivenessConstants:t}=this.context.coreSettings.get(S.J.Telemetry),i=this.context.coreSettings.get(S.J.Host).showScenarioStepsInPerfTrace||this.context.coreSettings.get(S.J.Core).showScenarioStepsInPerfTrace;this.isDebugging=e||i||!1,this.blinkInterval=t&&t.blinkInterval||100,this.trailingTimespan=t&&t.trailingTimespan||h.B.second,this.minEtwTriggeringDelay=(null==t?void 0:t.minEtwTriggeringDelay)||1e3,this.minEtwTriggeringFrameDelay=(null==t?void 0:t.minEtwTriggeringFrameDelay)||1e3}startMeasurement(e,t,i,n){this.assignHost(i),this.actionLocation=n,this.activeUserActionType=e,this.eventStartTime=t||this.host.performance.now(),this.lastEventTimeSlot=this.getTimeSlot(this.eventStartTime);const a=this.getMeasurementName(e);if(this.isDebugging){const e=`[${a}] START`,t=`${e} | ${this.host.performance.now()} | Event: ${this.eventStartTime}`;this.host.performance.mark(e,{startTime:this.eventStartTime}),this.logger.debug(t)}this.registerRafCallback();let s=this.userActions.get(a);void 0===s&&(s={scores:new Map,scoreHistograms:new Map,startTime:this.startSlot,type:e,frameDelayHistogram:new UP({bucketSize:500,maxBucketValue:15e3})},this.userActions.set(a,s)),s.startTime=this.eventStartTime}stopMeasurement(e=this.host){if(void 0===this.activeUserActionType)return;const t=this.getMeasurementName(this.activeUserActionType),i=this.userActions.get(t);if(void 0!==i){if(this.isDebugging){const e=`[${t}] END`;this.host.performance.mark(e),this.logger.debug(`${e} | ${this.host.performance.now()}`)}this.finalizeMeasurement(i)}this.unregisterRafCallback(),this.wheelEventTriggeredUserActionType===this.activeUserActionType&&(this.wheelEventTriggeredUserActionType=void 0),this.activeUserActionType=void 0,this.actionLocation=void 0,e===this.host&&this.assignHost(this.defaultHost)}continueMeasurement(e){this.lastEventTimeSlot=this.getTimeSlot(e)}finalizeMeasurement(e,t){this.strategies.forEach((i=>{const n=t&&i.allowStopTimeOverwrite?t:this.getCurrentTimeSlot(),a=Math.round(this.host.performance.now()-e.startTime);if(a<this.minAriDuration)return;const s=this.getResponsivenessScore(this.startSlot,n,i);this.recordPerInteractionAri(e,a,s,i);const o=e.scores.get(i.name);o?(o.passIntervalCount+=s.passIntervalCount,o.totalIntervalCount+=s.totalIntervalCount,o.measurements+=s.measurements,o.wheelMeasurements+=s.wheelMeasurements,o.max.passIntervalCount=Math.max(o.max.passIntervalCount,s.passIntervalCount),o.max.totalIntervalCount=Math.max(o.max.totalIntervalCount,s.totalIntervalCount)):e.scores.set(i.name,{totalIntervalCount:s.totalIntervalCount,passIntervalCount:s.passIntervalCount,measurements:s.measurements,wheelMeasurements:s.wheelMeasurements,max:s.max});const r=(s.passIntervalCount/s.totalIntervalCount).toFixed(2);if(this.logger.log(`[${this.getMeasurementName(e.type)}] duration: ${a}ms measurement: ${s.passIntervalCount}/${s.totalIntervalCount} (${r})`),this.isDebugging){const t=this.getMeasurementName(e.type),i={name:t,pass:s.passIntervalCount,total:s.totalIntervalCount,result:r},n=`ari-measurement => ${JSON.stringify(i)}`,a=`[${t}] START`,o=`[${t}] END`;zu(this.host.performance,n,a,o)}}))}recordFrameDelay(){var e;if(void 0===this.activeUserActionType)return;const t=this.getMeasurementName(this.activeUserActionType),i=this.userActions.get(t);if(void 0===i)return;const n=this.host.performance.now(),a=n-this.lastRafTime;this.lastRafTime=n,i.frameDelayHistogram.record(a),a>=this.minEtwTriggeringFrameDelay&&(null===(e=this.hostCommunicationService)||void 0===e||e.loadModule("etw").then((e=>{var t;null===(t=null==e?void 0:e.writeAppResponsivenessFrameDelayEvent)||void 0===t||t.call(e,{type:RP[i.type],delayMs:a})})))}recordPerInteractionAri(e,t,i,n){var a;const s=i.passIntervalCount/i.totalIntervalCount;e.scoreHistograms.has(n.name)||e.scoreHistograms.set(n.name,new UP({bucketSize:.1,maxBucketValue:1}));e.scoreHistograms.get(n.name).record(s);const o=(1-s)*t;o>=this.minEtwTriggeringDelay&&(null===(a=this.hostCommunicationService)||void 0===a||a.loadModule("etw").then((i=>{var n;null===(n=null==i?void 0:i.writeAppResponsivenessDelayEvent)||void 0===n||n.call(i,{type:RP[e.type],delayMs:o,durationMs:t})})))}measureRaf(){const e=this.getCurrentTimeSlot();this.recordFrameDelay();let t=this.rafRecords.get(e);void 0===t?t=1:t++,e-this.lastEventTimeSlot>=this.trailingTimespan?this.stopMeasurement():(this.rafRecords.size>1e3&&(this.stopMeasurement(),this.rafRecords.clear()),this.rafRecords.set(e,t),this.rafCallbackId=this.host.requestAnimationFrame((()=>this.measureRaf())))}getCurrentTimeSlot(){const e=this.host.performance.now();return this.getTimeSlot(e)}getTimeSlot(e){const t=void 0!==this.eventStartTime?e-this.eventStartTime:-1;return t<0?-1:Math.floor(t/this.blinkInterval)*this.blinkInterval}getResponsivenessScore(e,t,i){let n=0,a=0;for(;e<t;){const t=this.rafRecords.get(e);this.isDebugging&&this.logger.debug(`${e}: ${void 0===t?0:t}`),a+=void 0!==t&&t>=i.lowestAllowedRafs?1:0,n++,e+=this.blinkInterval}return{passIntervalCount:a,totalIntervalCount:n,measurements:1,wheelMeasurements:void 0!==this.wheelEventTriggeredUserActionType&&this.wheelEventTriggeredUserActionType===this.activeUserActionType?1:0,max:{passIntervalCount:a,totalIntervalCount:n}}}assignHost(e){this.host=e}getMeasurementName(e){let t=RP[e];return this.actionLocation&&(t+=`-${this.actionLocation}`),t}}class BP{constructor(e){var t,i;if(this.context=e,null===(t=this.context.host)||void 0===t?void 0:t.performance){this.deprecatedNavigationTiming=this.context.host.performance.timing,this.navigationStart=null===(i=this.deprecatedNavigationTiming)||void 0===i?void 0:i.navigationStart;const e=this.context.host.performance.getEntriesByType("navigation");e&&e[0]&&(this.navigationTiming=e[0]),this.init()}}get altScenario(){return this._altScenario}get clientStartScenario(){return this._clientStartScenario}markCoreInitSteps(){const e=this.context.host.performance.getEntriesByType("mark");e&&this.navigationStart&&(this._altScenario&&this.processCoreInitPerfMarks(this._altScenario,this.navigationStart,e),this._clientStartScenario&&(this._clientStartScenario.appendEventData({scenarioPhase:Pm.Core}),this.processCoreInitPerfMarks(this._clientStartScenario,this.navigationStart,e)))}processCoreInitPerfMarks(e,t,i){const n=i;for(const i of n)i.name!==`${j}${h.sM.Initialization}`?i.name.startsWith(C)&&e.mark(i.name.replace("_end_","_"),{overrideTimestamp:Math.round(i.startTime)+t}):e.mark(z.ck.PreCoreInitializationTasks,{overrideTimestamp:Math.round(i.startTime)+t})}markAltExpLoaderSteps(e,t){this.markNavigationSteps(e,t);const i=this.context.host.performance.getEntriesByName("start-execute-main-bundle","mark");i&&i[0]&&e.mark(z.ck.MainBundleDownloadParse,{overrideTimestamp:Math.round(i[0].startTime)+t})}markClientStartExpLoaderSteps(e,t){e.appendEventData({scenarioPhase:Pm.ExpLoader}),this.markNavigationSteps(e,t);const i=[b.IndexPageStart,b.CoreModuleLoaded,b.NotifyDesktop,b.ConfigLoaded,b.MainChunksLoadingStart,b.MainChunksLoadingStop,b.IndexPageStop,z.ck.MainBundleDownloadParse,"start-execute-main-bundle"],n=this.context.host.performance.getEntriesByType("mark");n&&n.filter((e=>i.includes(e.name)||e.name.startsWith("exp_loader_err_"))).forEach((i=>{e.mark(i.name,{overrideTimestamp:Math.round(i.startTime)+t})}))}markNavigationSteps(e,t){var i,n,a,s;(null===(i=this.navigationTiming)||void 0===i?void 0:i.workerStart)&&e.mark(z.ck.IndexServiceWorkerStartup,{overrideTimestamp:t+Math.round(this.navigationTiming.workerStart)}),(null===(n=this.deprecatedNavigationTiming)||void 0===n?void 0:n.fetchStart)&&e.mark(z.ck.IndexFetchIPC,{overrideTimestamp:this.deprecatedNavigationTiming.fetchStart}),(null===(a=this.deprecatedNavigationTiming)||void 0===a?void 0:a.requestStart)&&e.mark(z.ck.IndexFetchIPCWait,{overrideTimestamp:this.deprecatedNavigationTiming.requestStart}),(null===(s=this.deprecatedNavigationTiming)||void 0===s?void 0:s.responseStart)&&e.mark(z.ck.IndexFetchProcessing,{overrideTimestamp:this.deprecatedNavigationTiming.responseStart})}init(){var e,t;this.navigationStart&&(this._altScenario=null===(e=this.context.scenarioFactory)||void 0===e?void 0:e.newScenario(z.RG.ApplicationLaunchTime,{startTime:this.navigationStart}),this._clientStartScenario=null===(t=this.context.scenarioFactory)||void 0===t?void 0:t.newScenario(z.RG.ClientStart,{startTime:this.navigationStart}),this._altScenario&&this.markAltExpLoaderSteps(this._altScenario,this.navigationStart),this._clientStartScenario&&this.markClientStartExpLoaderSteps(this._clientStartScenario,this.navigationStart),this.markCoreInitSteps())}}class zP{constructor(e,t){this.isScenarioMemorySnapshotEnabled=e,this.globalWindow=t,this.cachedMemoryData={},this.cacheToExpireTime=0}snapshotMemoryUsage(){return this.isScenarioMemorySnapshotEnabled?(this.cacheToExpireTime<Date.now()&&this.snapshot(),this.cachedMemoryData):{}}snapshotMemoryUsageAsync(){if(!this.isScenarioMemorySnapshotEnabled)return Promise.resolve({});if(this.ongoingPromise)return this.ongoingPromise;const e=this.cacheToExpireTime-Date.now();return e>0?(this.ongoingPromise=new Promise((t=>{this.globalWindow.setTimeout((()=>{this.snapshot(),t(this.cachedMemoryData),this.ongoingPromise=void 0}),e)})),this.ongoingPromise):(this.snapshot(),Promise.resolve(this.cachedMemoryData))}snapshot(){this.cachedMemoryData={jsHeapStatistics:this.globalWindow.envPerformance.getJSHeapStatistics()||this.cachedMemoryData.jsHeapStatistics,processMemoryInfo:this.globalWindow.envPerformance.getProcessMemoryInfo()||this.cachedMemoryData.processMemoryInfo},this.cacheToExpireTime=Date.now()+3e4}}var HP=i(209406),qP=i(973877);class VP{constructor(e){this.eventTimeTracker=KA(e&&e>0?e:100)}markResponse(e){return this.eventTimeTracker.markEvent(e)}getResponsesBetweenStartAndLast(e){return this.eventTimeTracker.getEventsBetweenStartAndLast(e)}getResponsesBetween(e,t){return this.eventTimeTracker.getEventsBetween(e,t)}}const GP=e=>{var t;const{apolloLeakInfoViewportContext:i,apolloLeakInfoEntityType:n=""}=null!==(t=e.apolloLeakInfo)&&void 0!==t?t:{};return i===Et.R.primary?`main:${n}`:n},JP=e=>e.reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{});class KP{constructor(e,t,i,n){this.coreSettings=e,this.leakDetectorService=t,this.userTrackingService=i,this.shouldCollectStats=n,this.measurementTimeOverflow=!1,this.resultMeasurementTimeOverflow=!1,this.isLeakingUser=e=>e&&this.userTrackingService&&!this.userTrackingService.has(e);const{apolloCacheStatsThrottleTime:a,logCdlOperationsDuringWaitSettings:s}=e.get(S.J.Core);var o;this.getTelemetry=a?(0,B.throttle)((()=>this.getTelemetryInternal()),a,{leading:!0,trailing:!1}):this.getTelemetryInternal,s&&(s.enableTrackingCdlOperationsDuringWait||s.enableLoggingCdlOperationsDuringWait)&&(this.cdlResponseTracker=(o=s.trackingCdlOperationsDuringWaitBufferSize,new VP(o)))}getTelemetryInternal(){var e,t,i,n,a,s;const{enableApolloCacheStats:o,enableApolloCacheSizeStats:r,enableApolloResultCacheSizeStats:c,enableApolloDataEviction:l}=this.coreSettings.get(S.J.Core);if(!o)return;const d=null!==(t=null===(e=this.leakDetectorService)||void 0===e?void 0:e.getReachableObjects(vs.I.DataClient).size)&&void 0!==t?t:0,u=Array.from(null!==(n=null===(i=this.leakDetectorService)||void 0===i?void 0:i.getReachableObjects(vs.I.ApolloCache))&&void 0!==n?n:[]),m=[...Array.from(null!==(s=null===(a=this.leakDetectorService)||void 0===a?void 0:a.getReachableObjects(vs.I.UnwrappedWindow))&&void 0!==s?s:[]).map((e=>{var t;return null===(t=e.windowLeakInfo)||void 0===t?void 0:t.windowLeakInfoWindowId})).filter((e=>!!e)),h.ew],g=e=>!e||!m.includes(e),p=u.filter((e=>{const{apolloLeakInfo:{apolloLeakInfoWindowId:t}={}}=e;return g(t)})),v=this.getLeakedUserCaches(u),f=u.map(GP),b=p.map(GP),y=r&&!this.measurementTimeOverflow&&this.shouldCollectStats(),k=c&&!this.resultMeasurementTimeOverflow&&this.shouldCollectStats(),w={clientsCount:d,cacheCount:u.length,allEntityTypes:Array.from(new Set(f)),entityTypeStats:JP(f),leakedCacheCount:b.length,leakedEntityTypes:Array.from(new Set(b)),leakedEntityTypeStats:JP(b),leakedUserCachesCount:v.length,caches:u.map((e=>{const{apolloLeakInfo:{apolloLeakInfoWindowId:t,apolloLeakInfoEntityType:i,apolloLeakInfoViewportContext:n,apolloLeakInfoStartTime:a,apolloLeakInfoEndTime:s}={}}=e,o={windowId:t,isLeaking:g(t),apolloLeakInfoStartTime:a,apolloLeakInfoEndTime:s,entityType:i,viewportContext:n};if(y){const{cacheSize:t,measuringTime:i}=(0,HP.T)(e);o.cacheSize=t,o.measuringTime=i}if(k){const{cacheSize:t,measuringTime:i}=(0,qP.TP)(e);o.resultCacheSize=t,o.resultMeasuringTime=i}return o})),enableApolloDataEviction:null!=l?l:void 0},j=w.caches.reduce(((e,t)=>({cacheSize:void 0===t.cacheSize||void 0===e.cacheSize?void 0:e.cacheSize+t.cacheSize,measuringTime:void 0===t.measuringTime||void 0===e.measuringTime?void 0:e.measuringTime+t.measuringTime,resultCacheSize:void 0===t.resultCacheSize||void 0===e.resultCacheSize?void 0:e.resultCacheSize+t.resultCacheSize,resultMeasuringTime:void 0===t.resultMeasuringTime||void 0===e.resultMeasuringTime?void 0:e.resultMeasuringTime+t.resultMeasuringTime})),{cacheSize:0,measuringTime:0,resultCacheSize:0,resultMeasuringTime:0});return j.measuringTime&&j.measuringTime>500&&(this.measurementTimeOverflow=!0),j.resultMeasuringTime&&j.resultMeasuringTime>500&&(this.resultMeasurementTimeOverflow=!0),Object.assign(Object.assign({},w),j)}unthrottle(){"function"==typeof this.getTelemetry.cancel&&this.getTelemetry.cancel()}markResponse(e){var t;null===(t=this.cdlResponseTracker)||void 0===t||t.markResponse(e)}getResponsesBetweenStartAndLast(e){var t;return(null===(t=this.cdlResponseTracker)||void 0===t?void 0:t.getResponsesBetweenStartAndLast(e))||[]}getResponsesBetween(e,t){var i;return(null===(i=this.cdlResponseTracker)||void 0===i?void 0:i.getResponsesBetween(e,t))||[]}getLeakedUserCaches(e){return e.filter((e=>{const{apolloLeakInfo:{apolloLeakInfoUserContextId:t}={}}=e;return this.isLeakingUser(t)}))}}const QP={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}},{kind:"Field",name:{kind:"Name",value:"isNotificationsWindow"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"layoutConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"layoutMode"}}]}}]}}]}}]},YP=(e,t,i)=>{const n=void 0!==e[t]||Object.keys(e).length<i?t:"other";return e[n]=(e[n]||0)+1,n},XP=new Set([pe.py.breakoutroomspanel,pe.py.calendar,pe.py.callablechannels,pe.py.callsmain,pe.py.chats,pe.py.channels,pe.py.schedulingform,pe.py.search,pe.py.store,pe.py.transcriptcontent]);var ZP;!function(e){e.mainActive="mainActive",e.mainContentRecord="mainContentRecord"}(ZP||(ZP={}));class eO{constructor(e){this.entityTypeLimit=e,this.active={},this.record={},this.allEntityTypes=new Set,this.usedEntityTypes=new Set,this.allLayoutModes=new Set,this.activeWindowIds=new Set}update(e,t){Object.keys(this.active).forEach((e=>{this.active[e]=0})),this.activeWindowIds.clear(),e.forEach((e=>{const i=e.activeEntities.mainEntity.type;this.allEntityTypes.add(i),this.allLayoutModes.add(e.layoutConfig.layoutMode),this.activeWindowIds.add(e.id),YP(this.active,i,this.entityTypeLimit),XP.has(i)&&this.usedEntityTypes.add(i),!this.isFirstUse(i)&&this.wasInPreviousUpdate(e,t)||YP(this.record,i,this.entityTypeLimit)}))}getStats(){return{mainActive:this.active,mainContentRecord:this.record,allEntityTypes:Array.from(this.allEntityTypes),usedEntityTypes:Array.from(this.usedEntityTypes),allLayoutModes:Array.from(this.allLayoutModes),activeWindowIds:Array.from(this.activeWindowIds)}}isFirstUse(e){return!this.record[e]}wasInPreviousUpdate(e,t){const i=t.find((t=>t.id===e.id));return!!i&&i.activeEntities.mainEntity.type===e.activeEntities.mainEntity.type&&i.activeEntities.mainEntity.id===e.activeEntities.mainEntity.id&&i.correlation.id===e.correlation.id}}const tO=new Set([pe.py.calls,pe.py.chats,pe.py.channels,pe.py.extensions,pe.py.schedulingform]);var iO;!function(e){e.popOutActive="popOutActive",e.popOutRecord="popOutRecord"}(iO||(iO={}));class nO{constructor(e){this.entityTypeLimit=e,this.active={},this.record={},this.allEntityTypes=new Set,this.usedEntityTypes=new Set,this.activeWindowIds=new Set}update(e,t){Object.keys(this.active).forEach((e=>{this.active[e]=0})),this.activeWindowIds.clear(),e.forEach((e=>{const i=e.activeEntities.mainEntity.type;this.allEntityTypes.add(i),this.activeWindowIds.add(e.id),YP(this.active,i,this.entityTypeLimit),tO.has(i)&&this.usedEntityTypes.add(i),!this.isFirstUse(i)&&this.wasInPreviousUpdate(e,t)||YP(this.record,i,this.entityTypeLimit)}))}getStats(){return{popOutActive:this.active,popOutRecord:this.record,allEntityTypes:Array.from(this.allEntityTypes),usedEntityTypes:Array.from(this.usedEntityTypes),activeWindowIds:Array.from(this.activeWindowIds)}}isFirstUse(e){return!this.record[e]}wasInPreviousUpdate(e,t){const i=t.find((t=>t.id===e.id));return!!i&&i.activeEntities.mainEntity.type===e.activeEntities.mainEntity.type}}const aO=e=>e.isMainWindow||e.isNotificationsWindow,sO=e=>!aO(e),oO=e=>Object.keys(e).reduce(((t,i)=>t+e[i]),0),rO=e=>{const t=Object.keys(e).reduce(((t,i)=>{const n=e[i];return n&&n>0&&(t[i]=n),t}),{}),i=Object.keys(t);return 1===i.length?i[0]:void 0},cO=(e,t)=>{const i=Array.from(e).filter((e=>{var i;return!(null===(i=e.windowLeakInfo)||void 0===i?void 0:i.windowLeakInfoWindowId)||!t.includes(e.windowLeakInfo.windowLeakInfoWindowId)})).map((e=>{var t;const{windowLeakInfoEntityType:i=""}=null!==(t=e.windowLeakInfo)&&void 0!==t?t:{};return e.viewportContext===Et.R.primary?`main:${i}`:i}));return{allEntityTypes:Array.from(new Set(i)),memActive:i.reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{})}};class lO{constructor({client:e,leakDetectorService:t,entityTypeStatsLimit:i,activeWindowsService:n}){let a;this.isBackInMain=!1,this.main=new eO(null!=i?i:20),this.popOut=new nO(null!=i?i:20),a=(null==n?void 0:n.enableDecoupleCommandingFromApollo)?n.getActiveWindowsObservable():(0,he.G)(e.watchQuery({query:QP})).pipe((0,u.h)((({errors:e,loading:t})=>void 0===e&&!t)),(0,l.U)((({data:{activeWindows:e}})=>(this.isBackInMain=e.some((e=>e.id===h.ew)),e)))),this._activeWindowsSubscription=a.pipe((0,ji.G)()).subscribe((([e,t])=>{this.update(e,t)})),this.leakDetectorService=t}destroy(){this._activeWindowsSubscription.unsubscribe()}getStats(){var e,t,i,a;const s=null===(e=this.leakDetectorService)||void 0===e?void 0:e.getReachableObjects(vs.I.UnwrappedWindow),o=null===(t=this.leakDetectorService)||void 0===t?void 0:t.getReachableObjects(vs.I.WindowWrapper),r=this.main.getStats(),{activeWindowIds:c}=r,l=(0,n.__rest)(r,["activeWindowIds"]),d=this.popOut.getStats(),{activeWindowIds:u}=d,m=(0,n.__rest)(d,["activeWindowIds"]),g=oO(m.popOutActive),h={backInMain:this.isBackInMain?{allEntityTypes:l.allEntityTypes,usedEntityTypes:l.usedEntityTypes,backInMainActive:l.mainActive,backInMainActiveCount:oO(l.mainActive),backInMainContentRecord:l.mainContentRecord}:void 0,t2main:this.isBackInMain?void 0:{allEntityTypes:l.allEntityTypes,allLayoutModes:l.allLayoutModes,usedEntityTypes:l.usedEntityTypes,t2MainActive:l.mainActive,t2MainActiveCount:oO(l.mainActive),t2MainContentRecord:l.mainContentRecord},popOut:Object.assign(Object.assign({},m),{popOutActiveCount:g,hasActivePopout:g>0}),mainActiveEntity:rO(l.mainActive),windowCount:null==s?void 0:s.size,windowWrapperCount:null==o?void 0:o.size,inMem:s?cO(s,[...c,...u]):void 0,windows:s?Array.from(s).map((e=>{var t;const{windowLeakInfoEntityType:i,windowLeakInfoWindowId:n,windowLeakInfoStartTime:a,windowLeakInfoEndTime:s}=null!==(t=e.windowLeakInfo)&&void 0!==t?t:{};return{windowLeakInfoWindowId:n,windowLeakInfoEntityType:i,viewportContext:e.viewportContext,windowLeakInfoStartTime:a,windowLeakInfoEndTime:s}})):void 0},p=(null!==(a=null===(i=h.t2main)||void 0===i?void 0:i.t2MainActiveCount)&&void 0!==a?a:0)+h.popOut.popOutActiveCount;return Object.assign(Object.assign({},h),{windowLeaks:void 0===h.windowCount?void 0:h.windowCount-p,windowWrapperLeaks:void 0===h.windowWrapperCount?void 0:h.windowWrapperCount-p})}update(e,t){this.main.update(t.filter(aO),e.filter(aO)),this.popOut.update(t.filter(sO),e.filter(sO))}}class dO{constructor(e){this.context=e,this.inited=!1,this.logger=e.loggerFactory.newLogger("WindowTrackerService","core-services-telemetry")}init(){var e;if(!this.inited){const{client:t,leakDetectorService:i,coreSettings:n,activeWindowsService:a}=this.context,s=(null!==(e=this.logger.errorToTelemetry)&&void 0!==e?e:this.logger.error).bind(this.logger);if(t){this.inited=!0;try{this.windowEntityTypeStats=new lO({client:t,leakDetectorService:i,entityTypeStatsLimit:null==n?void 0:n.get(S.J.Core).entityTypeStatsLimit,coreSettings:n,activeWindowsService:a})}catch(e){s("Failed to initialize WindowEntityTypeStats","webclient_framework_window_tracker_service")}}else s("Failed to initialize WindowEntityTypeStats - missing client","webclient_framework_window_tracker_service")}}getTelemetry(){var e;return this.inited||this.init(),null===(e=this.windowEntityTypeStats)||void 0===e?void 0:e.getStats()}}function uO(e,t){const i=e.location.hostname;return t&&t!==i}var mO=i(596025);function gO(e,t,i,n,a,s){const o=s&&s.delta||0,r=function(e,t,i){let n;if("share-to-teams"===e)n=function(e,t){let i;if(t.performance&&t.performance.navigation&&0===t.performance.navigation.type){const{s:n}=e.getSearchState();if(n)i=parseInt(n,10);else{const e="outlook"===t.document.head.dataset.host,n=t.localStorage.getItem(mO.qB.STT_START_TIME);e&&n&&(i=parseInt(n,10),t.localStorage.removeItem(mO.qB.STT_START_TIME))}}return i}(t,i);return n}(e,n,a),c=r?{name:z.ck.ClickTimeAction,timestamp:i-o}:void 0,l=c?[c]:[];s&&l.push({name:s.name,timestamp:i});const d=r||i-o,u=t.newScenario(z.RG.ExperienceReady,{startTime:d});l.forEach((e=>{u.mark(e.name,{overrideTimestamp:e.timestamp})}))}function hO(e,t,i,n,a,s,o={cached:!1}){const r={name:e,delta:0},c=Bu(e,t,i,n.performance,s);return void 0!==c&&(r.delta=c,a.createScenarioWithoutStarting(e).stop({delta:c,cached:o.cached})),r}var pO=i(300426);class vO{constructor(e){this.telemetrySettings=null,this.disableColumnBlocker=!1,this.fixedColumnRules={},this.blockedColumnRules={},this.columnBlockingRules={},this.wildCardMergedTables={},this.wildCardTableEmpty=!0,this.updateColumnBlockingSettings=e=>{if(e){if(this.telemetrySettings=e,this.disableColumnBlocker=e.disableColumnBlocker||!1,this.disableColumnBlocker)return this.columnBlockingRules={},this.wildCardMergedTables={},void(this.wildCardTableEmpty=!0);let t={};e.blockedColumnRules&&(t=e.blockedColumnRules),this.blockedColumnRules=t;let i={};e.fixedColumnRules&&(i=e.fixedColumnRules),this.fixedColumnRules=i,this.generateRuleSet()}};e.getObservable(S.J.Telemetry).subscribe(this.updateColumnBlockingSettings),this.telemetrySettings=e.get(S.J.Telemetry),this.updateColumnBlockingSettings(this.telemetrySettings)}isContextColumnOk(e){return(0,B.isEmpty)(this.columnBlockingRules)||(0,B.isEmpty)(this.columnBlockingRules["*"])||(0,B.isEmpty)(this.columnBlockingRules["*"]["*"])||!this.columnBlockingRules["*"]["*"][e]}applyColumnBlockingRules(e,t,i,n){try{if(this.wildCardTableEmpty||this.wildCardMergedTables[e]||(this.columnBlockingRules[e]=(0,B.merge)(this.columnBlockingRules[e],this.columnBlockingRules["*"]),this.wildCardMergedTables[e]=!0),(0,B.isEmpty)(this.columnBlockingRules[e]))return;(0,B.isEmpty)(this.columnBlockingRules[e][t])?(0,B.isEmpty)(this.columnBlockingRules[e]["*"])||this.blockEventPropertyColumn(this.columnBlockingRules[e]["*"],i,n):this.blockEventPropertyColumn(this.columnBlockingRules[e][t],i,n)}catch(e){return void i.setProperty("diagBlockedColumns",(0,U.XC)({parseFailed:!0}))}}blockEventPropertyColumn(e,t,i){const n=t.properties,a={},s=null==i?void 0:i.packedData;(0,B.forEach)(e,((e,t)=>{(0,B.isEmpty)(n[t])||(n[t].value="",a[t]=e),s&&s.forEach((i=>{i[t]&&(i[t]=void 0,a[t]=e)}))})),(0,B.isEmpty)(a)||t.setProperty("diagBlockedColumns",(0,U.XC)(a))}generateRuleSet(){try{this.columnBlockingRules={},this.wildCardMergedTables={};const e=this.blockedColumnRules["*"],t=this.fixedColumnRules["*"];(0,B.forEach)(this.blockedColumnRules,((i,n)=>{if((0,B.isEmpty)(i))return;(0,B.isEmpty)(e)||"*"===n||(i=(0,B.merge)(i,e));!(0,B.isEmpty)(this.fixedColumnRules)&&!(0,B.isEmpty)(this.fixedColumnRules[n])&&!(0,B.isEmpty)(t)&&"*"!==n&&(this.fixedColumnRules[n]=(0,B.merge)(this.fixedColumnRules[n],t)),this.columnBlockingRules[n]={};const a={};(0,B.isEmpty)(i["*"])||this.mergeBlockedColumnsRulesForAllEventType(i,n,a),(0,B.isEmpty)(a)||(this.columnBlockingRules[n]["*"]=a),this.mergeBlockedColumnsRulesForEveryEventType(i,n,a),(0,B.isEmpty)(this.columnBlockingRules[n])?delete this.columnBlockingRules[n]:this.wildCardMergedTables[n]=!0})),this.wildCardTableEmpty=(0,B.isEmpty)(this.columnBlockingRules["*"])}catch(e){return}}mergeBlockedColumnsRulesForAllEventType(e,t,i){(0,B.forEach)(e["*"],((e,n)=>{e>(this.fixedColumnRules[t]&&this.fixedColumnRules[t]["*"]&&this.fixedColumnRules[t]["*"][n]||0)&&(i[n]=e)}))}mergeBlockedColumnsRulesForEveryEventType(e,t,i){(0,B.forEach)(e,((e,n)=>{"*"!==n&&((0,B.isEmpty)(this.fixedColumnRules[t])||(0,B.isEmpty)(this.fixedColumnRules[t][n])?this.columnBlockingRules[t][n]=(0,B.merge)(e,i):(this.columnBlockingRules[t][n]={},(0,B.forEach)(e,((e,i)=>{e>(this.fixedColumnRules[t][n][i]||0)&&(this.columnBlockingRules[t][n][i]=e)})),this.columnBlockingRules[t][n]=(0,B.merge)(this.columnBlockingRules[t][n],i),(0,B.isEmpty)(this.columnBlockingRules[t][n])&&delete this.columnBlockingRules[t][n]))}))}}var fO=i(589008),bO=i(969939),yO=i(157867),kO=i(406900),SO=i(561890);class wO extends SO.t{constructor(e){super(),this.messager=e,e.onmessage=e=>{var t,i;e.data&&(null===(i=(t=this.messageHandlers)[e.data.name])||void 0===i||i.call(t,e.data.params))}}postMessage(e,t,i){this.messager.postMessage({name:e,params:t},{transfer:i})}}class jO extends SO.t{constructor(e,t){super(),this.sharedWorkerUrl=t,this.worker=this.createSharedWorker(e,this.sharedWorkerUrl)}initialize(){}postMessage(e,t){try{this.worker.port.postMessage({name:e,params:t})}catch(e){console.warn(e)}}createSharedWorker(e,t){const i=t?new SharedWorker(t):e;return i.port.onmessage=e=>{if(!e||!e.data||!e.data.name)return;const t=this.messageHandlers[e.data.name];t&&t(e.data.params)},i}}function CO(){return new Worker("/convene/worker/precompiled-telemetry-web-worker-265361ec0cfe03d0.js")}function _O(){return new SharedWorker("/convene/worker/precompiled-telemetry-shared-worker-ff9e6de4aac909f2.js")}const TO=(e,t)=>class{constructor(i){return new e(t(i))}};var IO=i(642601);const NO="Teams",EO=/(windows|win32)/i,FO=/ arm;/i,xO=/windows\sphone\s\d+\.\d+/i,DO=/(macintosh|mac os x|mac)/i,AO=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,MO=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,PO=/android/i,OO=()=>new kO.v,RO=(e,t)=>{var i,n;if(t){const a=null!==(i=e.get(S.J.Telemetry).workerEnabled)&&void 0!==i&&i,s=null!==(n=e.get(S.J.Telemetry).enableSharedWorker)&&void 0!==n&&n;if(a){const{coreSecurityService:i,windowBaseUrl:n}=t,a=i.getTrustedTypePolicy("@msteams/core-services-telemetry-worker#TelemetryWorker"),o=e=>a.createScriptURL(e,n);return()=>{const t=((e,t,i)=>{if(e){const e=SharedWorker;SharedWorker=TO(e,t);const n=i?new jO(void 0,i):new jO(new _O);return SharedWorker=e,n}{const e=Worker;Worker=TO(e,t);const i=new wO(new CO);return Worker=e,i}})(s,o);return new IO.A(t,e).init(),t}}return OO}return OO},LO=(e,t,i=bO.h.default)=>{pO.H.getInstance().initialize(t);const n=new vO(t);return Q.ip.getInstance().initialize(e,i),{eventSuppression:pO.H.getInstance(),columnSuppression:n,telemetrySender:Q.ip.getInstance()}},UO=(e,t,i,n,a=bO.h.default)=>{var s;const{clientType:o,userAgent:r}=i.config,{deviceId:c,sessionId:l,sessionStartTime:d}=i.host,u=n.get(S.J.Telemetry),{defaultToken:m,enableSharedWorker:g,isSilent:p,telemetryServer:v,enableCustomCacheSize:f,eventsLimitInMem:b,normalPrioritySendTimeInSecs:y,highPrioritySendTimeInSecs:k,autoFlushPercent:w,enableOneDsSdkNs:j,oneDsCollectorUrl:C,enableCompression:_,enablePrivacyGuard:T,enableLoggingGlobalDeviceId:I,privacyGuardIngestionToken:N,disableMTMAPrimaryId:E,debugMenuCaptureContext:F,debugMenuCaptureEvents:x}=u,{sharedWorkerUrl:D}=n.get(S.J.Host),A=null===(s=null==n?void 0:n.get(S.J.Core))||void 0===s?void 0:s.enableMTMA;if(!v||!m)throw t.error("Telemetry server url or app token not supplied. This is required by Aria"),(0,oe.Tr)("telemetry-initialization",h.jK.Undefined,"init");const M=(e=>{let t=e;return t||(t=(0,qe.v4)()),t})(c),P=e.windowType!==yO.N.Anglr?"NS":"",O={userAgent:r,firstLaunchTime:e.appStartTime,tablePostfix:P,deviceId:M},R={debugMenuCaptureContext:!!F,debugMenuCaptureEvents:!!x},L=new fO.Mk;return L.collectorUrl=v,f&&b&&(L.eventsLimitInMem=b),{config:L,appTokens:{default:m},documentInfo:O,debugMenuSettings:R,isSilent:!!p,sessionId:l||void 0,sessionStartTime:d,clientType:o,sharedWorkerUrl:D||void 0,enableSharedWorker:!!g,eventsLimitInMem:b||3e3,normalPrioritySendTimeInSecs:y||15,highPrioritySendTimeInSecs:k||15,autoFlushPercent:w||.33,enableOneDsSdkNs:!!j,oneDsCollectorUrl:C||void 0,enableCompression:!!_,enablePrivacyGuard:!!T,enableLoggingGlobalDeviceId:!!I,privacyGuardIngestionToken:N||void 0,enableMTMA:A||void 0,disableMTMAPrimaryId:!!E,defaultLoggerName:a}},$O=(e,t,i,n,a,s,o,r,c)=>{var l;const{browser:d,browserVersion:u,clientContext:m,clientType:g,clientVersion:p,cpuArchitecture:v,osPlatform:f,osVersion:b,platformId:y,pullRequestId:k,buildId:w}=i.config,{bootType:j,panelContext:C,sessionId:_,startReason:T}=i.host,I=n.get(S.J.Telemetry),{defaultToken:N,telemetryServer:E,disableRingNamePrefixing:F,disablePlatformServiceOsVersion:x}=I,D=n.get(S.J.Metadata),{hostAppWebVersion:A}=n.get(S.J.Host);if(!E||!N)throw t.error("Telemetry server url or app token not supplied. This is required by Aria"),(0,oe.Tr)("telemetry-initialization",h.jK.Undefined,"init");const M=D.environment===At.s.life?Kr.OV.Life:Kr.OV.Work,P=HA(D,WO(!!F,e,s),c).ring,O=GO(a.userAgent),R=KO(a.userAgent),L=YO(f),U=XO(f);let $=v;"Mac OS X"===U&&($="x64");const W=eR();o.setContext("AppInfo.ClientType",null!==(l=e.clientTypeTelemetry)&&void 0!==l?l:g),o.setContext("AppInfo.ClientContext",m),o.setContext("AppInfo.HostAppVersion",O),o.setContext("AppInfo.ProcessArchitecture",R),o.setContext("AppInfo.WebVersion",A),A&&o.setContext("AppInfo.HostAppWebVersion",VO(A)),o.setContext("AppInfo.Language",r.localeCode),o.setContext("AppInfo.Locale",r.localeCode),o.setContext("AppInfo.PlatformId",y);const B=JO(p,A);I.enableEnhancedTelemetry?o.setContext("AppInfo.Version",B):o.setContext("AppInfo.Version",p),o.setContext("AppInfo.VersionNew",B),o.setContext("AppInfo.PullRequestId",k),o.setContext("AppInfo.BuildId",w),o.setContext("AppInfo.ReactAppVersion",p),o.setContext("AppInfo.ExperienceName",e.experienceName),o.setContext("DeviceInfo.OsName",U),x||o.setContext("DeviceInfo.OsVersion",b),o.setContext("DeviceInfo.OsFamily",L),o.setContext("DeviceInfo.CpuArchitecture",$),o.setContext("EventInfo.isNS",!0),o.setContext("Panel.Context",C),o.setContext("Session.Id",_),o.setContext("startReason",T),o.setContext("UserInfo.Language",r.userLanguage),o.setContext("UserInfo.Ring",P),o.setContext("UserInfo.TimeZone",W),o.setContext("userAgent",a.userAgent),o.setContext("Window.Type",e.windowType),o.setContext("DeviceInfo.BrowserName",d),o.setContext("DeviceInfo.BrowserVersion",u),o.setContext("DeviceInfo.Id",a.deviceId),o.setContext("Tenant.Model",M),o.setContext("Session.TelemetryContext","web"),o.setContext("AppInfo.BootType",j),o.setContext("UserInfo.UserLocale",r.originLocaleCode),o.setContext("UserInfo.OSorBrowserLocale",Ps.Bh.Desktop===g||Ps.Bh.Maglev===g?r.osLocale:r.userLanguage),o.setContext("telemetryRegionFetchComplete",I.telemetryRegionFetchComplete),o.setContext("UserInfo.TelemetryRegion",I.telemetryRegion),BO(n,o,e,s,c),zO(n,o),HO(B,n,o)},WO=(e,t,i)=>!(!i||"react-web-client"!==t.experienceName)||e,BO=(e,t,i,n,a)=>{const s=e.getObservable(S.J.Metadata),{disableRingNamePrefixing:o}=e.get(S.J.Telemetry);if(s.subscribe((e=>{null==a||a.updateWebExperimentConfigMetadata(e),null==a||a.communicateWithHost();const s=HA(e,WO(!!o,i,n),a);t.setContext("UserInfo.Ring",s.ring),t.setContext("UserInfo.ETag",s.eTag),t.setContext("UserInfo.HostETag",s.hostETag),t.setContext("AppInfo.ExpIds",s.expIds),t.setContext("AppInfo.ExpRolloutIds",s.rolloutIds),t.setContext("AppInfo.Environment",s.environment)})),a){a.ecmObservable.subscribe((e=>{const i=e.find((e=>e.client===WA)),n=e.map((e=>e.config.expIds)).filter((e=>e.length>0)).join(","),a=qA(e).join(",");t.setContext("UserInfo.HostETag",null==i?void 0:i.config.eTag),t.setContext("AppInfo.ExpIds",n),t.setContext("AppInfo.ExpRolloutIds",a)}))}},zO=(e,t)=>{e.getObservable(S.J.UserResources).subscribe((e=>{const i=e.licenseType||void 0;t.setContext("UserInfo.LicenseType",i)}))},HO=(e,t,i)=>{t.getObservable(S.J.Host).subscribe((n=>{n&&qO(e,t,i,n)}))},qO=(e,t,i,n)=>{const{enableEnhancedTelemetry:a,enableGetUserTypeFromHost:s}=t.get(S.J.Telemetry),o=n.desktopVersion||void 0,r=o?e.concat(",",o):e;o&&i.setContext("AppInfo.DesktopVersion",o),i.setContext("AppInfo.VersionNew",r),n.systemManufacturer&&i.setContext("DeviceInfo.Make",n.systemManufacturer),n.systemProductName&&i.setContext("DeviceInfo.Model",n.systemProductName),i.setContext("rendererCount",n.rendererCount),a&&i.setContext("AppInfo.Version",r),i.setContext("AppInfo.WebVersion",n.hostAppWebVersion),n.hostAppWebVersion&&i.setContext("AppInfo.HostAppWebVersion",VO(n.hostAppWebVersion)),s&&n.userType&&i.setContext("userType",n.userType)},VO=e=>{let t="";const i=e.indexOf("/");return i>-1&&(t=e.substring(i+1,e.length)),t},GO=e=>{let t;const i=e.indexOf(NO);if(i>-1){t=e.substring(i+5+1);const n=t.indexOf(" ");t=t.substring(0,n)}return t},JO=(e,t)=>t?e.concat(",",t):e,KO=e=>{let t=Kr.Wz.unknown;return ZO(e,Kr.Wz.x64)?t=Kr.Wz.x64:ZO(e,Kr.Wz.x86)?t=Kr.Wz.x86:ZO(e,Kr.Wz.ia32)&&(t=Kr.Wz.ia32),t},QO=e=>{const t=e.get(S.J.Telemetry),i=t.workerEnabled,n=t.enableSharedWorker;return i?n?"shared":"dedicated":"embed"},YO=e=>{let t=Kr.Zc.UNKNOWN;const i=(null==e?void 0:e.match(EO))||(null==e?void 0:e.match(FO))||(null==e?void 0:e.match(xO)),n=(null==e?void 0:e.match(MO))||(null==e?void 0:e.match(PO)),a=(null==e?void 0:e.match(DO))||(null==e?void 0:e.match(AO));return i?t=Kr.Zc.WINDOWS:n?t=Kr.Zc.UNIX:a&&(t=Kr.Zc.MACOSX),t},XO=e=>{switch(e){case Ps.NR.Windows:return"Windows";case Ps.NR.Mac:return"Mac OS X";case Ps.NR.Linux:return"Linux";case Ps.NR.ChromeOS:return"Chrome OS";case Ps.NR.Android:return"Android";case Ps.NR.IOS:return"iOS";case Ps.NR.WindowsPhone:return"Windows Phone";case Ps.NR.Unknown:return"Unknown";default:return e}},ZO=(e,t)=>!!(e.indexOf(t)>-1),eR=()=>{const e=(new Date).getTimezoneOffset();let t=e%60,i=(e-t)/60;const n=i>0?"-":"+";t=Math.abs(t),i=Math.abs(i);const a=t<10?`0${t}`:t.toString();return`${n}${i<10?`0${i}`:i.toString()}:${a}`};class tR extends Ue{constructor(){super(h.Yg.InitTelemetry,["coreSettings","coreSettingsContext","diagnosticsService","hostCommunicationService","loggerFactory","telemetryContextService","windowProvider"])}execute(e){var t,i,a,s,o;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.loggerFactory.newLogger("init-telemetry-task","core-services-tasks"),r=e.coreSettings.get(S.J.Telemetry),c=this.createMemoryAnalyzer(e.windowProvider,r);r.disableAriService||(e.appResponsivenessService=new WP(e.windowProvider,{loggerFactory:e.loggerFactory,windowProvider:e.windowProvider,coreSettings:e.coreSettings,hostCommunicationService:e.hostCommunicationService})),e.dataClientTrackingService=this.createDataClientTrackerService(e),this.createWindowTrackerService(e),yield this.createHeartbeatMonitor(e);const{crossClientRegistrationMethods:l,desktopActiveScenarios:d,desktopContext:u,deviceInfo:m,finalizeLegacyCrossClient:g,notifyDesktopScenarioFactoryReady:h,registerForCoreContext:p,systemCpuInfo:v,systemMemoryInfo:f}=yield this.initializeCrossClientTelemetry(n,e.hostCommunicationService),b={deviceInfo:m,systemCpuInfo:v,systemMemoryInfo:f},y=this.createCoreScenarioFactory(e,c,g,d,l),k=new sM(y,e.telemetryContextService,c,{isolateUserContext:null!==(t=e.coreSettings.get(S.J.Telemetry).isolateUserContext)&&void 0!==t&&t});return null==p||p(((e,t)=>{k.setCoreContext(e,t)})),null==h||h(),null===(i=e.hostCommunicationService)||void 0===i||i.setScenarioFactory(y),e.diagnosticsService.setScenarioFactory(y),e.coreSettingsContext.setScenarioFactory(y),yield this.createCoreTelemetryService(e,c,y,b,e.telemetryContextService,u),null===(o=null===(s=null===(a=e.windowProvider)||void 0===a?void 0:a.loader)||void 0===s?void 0:s.stopPieTimer)||void 0===o||o.call(s),this.createCoreUserBiService(e),this.startAppStartScenarios(e,y),e.altScenarioService=new BP({host:e.windowProvider,loggerFactory:e.loggerFactory,coreSettings:e.coreSettings,scenarioFactory:y}),e.hostCommunicationService&&(yield this.handOffContextCommsCallback(e.hostCommunicationService,e.coreSettings,k)),iR(k)}))}initializeCrossClientTelemetry(e,t){var i,a,s,o;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n={};if(t){try{const e=yield t.loadModule("scenario");e&&(e.getActiveScenarios&&(n.desktopActiveScenarios=yield e.getActiveScenarios({})),e.setScenarioCompletion&&(n.finalizeLegacyCrossClient=e.setScenarioCompletion),n.crossClientRegistrationMethods={},e.registerForScenarioMark&&e.registerForScenarioStart&&e.registerForScenarioStop&&(n.crossClientRegistrationMethods.marks={registerForScenarioStart:e.registerForScenarioStart,registerForScenarioMark:e.registerForScenarioMark,registerForScenarioStop:e.registerForScenarioStop}),e.registerForScenarioAppendEventData&&(n.crossClientRegistrationMethods.appendEventData=e.registerForScenarioAppendEventData),n.notifyDesktopScenarioFactoryReady=()=>{var t;null===(t=e.setWebAvailability)||void 0===t||t.call(e,!0)})}catch(t){e.errorToTelemetry&&e.errorToTelemetry(or.LoadModuleScenarioFailed,"webclient_framework_host_comms",void 0,!0)}try{const e=yield t.loadModule("osutils");e&&(n.deviceInfo=yield null===(i=e.getDeviceInfo)||void 0===i?void 0:i.call(e),n.systemCpuInfo=yield null===(a=e.getSystemCpuInfo)||void 0===a?void 0:a.call(e),n.systemMemoryInfo=yield null===(s=e.getSystemMemoryInfo)||void 0===s?void 0:s.call(e))}catch(t){e.errorToTelemetry&&e.errorToTelemetry(or.LoadModuleOsUtilsFailed,"webclient_framework_host_comms",void 0,!0)}try{const e=yield t.loadModule("telemetry"),i=null==e?void 0:e.registerForOnNewContext;i&&(n.registerForCoreContext=e=>{i((t=>{t.filter((e=>void 0===e.userContextId)).forEach((t=>e(t.column,t.value)))}))}),n.desktopContext=yield null===(o=null==e?void 0:e.getContext)||void 0===o?void 0:o.call(e,{columns:["launchIntent","desktopVersion","deviceAuthToken","windowsChannel","windowsSku","storageInfo","outOfProcState"]})}catch(t){e.errorToTelemetry&&e.errorToTelemetry(or.LoadModuleTelemetryFailed,"webclient_framework_host_comms",void 0,!0)}}return n}))}handOffContextCommsCallback(e,t,i){var a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.loadModule("telemetry"),o=yield null===(a=null==n?void 0:n.getPreAuthUserSamplingId)||void 0===a?void 0:a.call(n);if(o&&(null===(s=this.setPreAuthUserId)||void 0===s||s.call(this,t,i,o)),n&&n.setContext){const e=n.setContext;(0,Hi.G)().setMultiContextCallback(((t,i,n)=>e([{column:t,value:i,userContextId:n}])))}if(n&&n.setCollectorContext){const e=n.setCollectorContext;(0,Hi.G)().setCollectorContextCallback(((t,i,n)=>e({enableTelemetryRegionReinit:t,telemetryRegion:i,telemetryRegionFetchComplete:n})))}}))}createMemoryAnalyzer(e,t){const{enableDesktopMemoryAnalyzer:i,isScenarioMemorySnapshotEnabled:n}=t;return i?new zP(!!n,e):void 0}createCoreScenarioFactory(e,t,i,n,a){const s=new OA({parentScenarioFactory:e.scenarioFactory,coreSettings:e.coreSettings,platformService:e.platformService,loggerFactory:e.loggerFactory,hostCommunicationService:e.hostCommunicationService,windowProvider:e.windowProvider,authenticationUser:e.authenticationUser,correlation:e.correlation},e.config.startTimeMS,t,void 0,void 0,void 0,void 0,n,a,i);return e.scenarioFactory=s,s}createHeartbeatMonitor(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=new aD.K(e);yield t.start(),e.heartbeatMonitor=t}))}createDataClientTrackerService(e){const t=[$e.pk.Inactive,$e.pk.LongInactive],i=[h.eT.Inactive,h.eT.LongInactive],n=e.platformService.config.clientType===Ps.Bh.Maglev?()=>!!e.clientState&&t.includes(e.clientState.getState()):()=>!!e.appStateService&&i.includes(e.appStateService.getState());return new KP(e.coreSettings,e.leakDetectorService,e.userTrackingService,n)}createWindowTrackerService(e){e.windowTrackerService=new dO(e)}createCoreTelemetryService(e,t,i,a,s,o){var r;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{config:n,coreSettings:c,coreSecurityService:l,experimentationService:d,hostCommunicationService:u,loggerFactory:m,platformService:g,routingServices:h,windowProvider:p}=e,v=yield gx(u),f=(0,lx.pf)(p),b={osLocale:v,userLanguage:mx(p),localeCode:hx(p,h,f.localeCode),originLocaleCode:px(p,h,f.localeCode)},{telemetryContext:y}=((e,t,i,n,a,s)=>{const{loggerFactory:o,coreSettings:r,platformService:c,scenarioFactory:l}=i,d=o.newLogger("Telemetry","core-services-telemetry"),u=UO(e,d,c,r),m=a||new vA(d),{columnSuppression:g}=LO(o.newLogger("TelemetrySender","core-services-telemetry"),r),h=RO(r,n),p=QO(r);return(0,Hi.G)().initialize(Object.assign(Object.assign({},u),{workerOptions:{workerSetup:h,workerType:p},services:{coreSettings:r,scenarioFactory:l,columnSuppressionService:g}}),d),$O(e,d,c,r,u.documentInfo,!1,m,t,s),{telemetryContext:m}})({appStartTime:n.startTimeMS,experienceName:n.experienceName,windowType:n.windowType,clientTypeTelemetry:n.clientTypeTelemetry},b,{loggerFactory:m,platformService:g,coreSettings:c,scenarioFactory:i},{coreSecurityService:l,windowBaseUrl:p.document.location.origin},s,d),k=new sM(i,y,t,{isolateUserContext:null!==(r=c.get(S.J.Telemetry).isolateUserContext)&&void 0!==r&&r});if(p.localStorage){const e=p.localStorage.getItem("ts.latestOid");null==k||k.setContext("UserInfo.Id",e)}n.externalCorrelationId&&k.setCoreContext("EventInfo.ExternalCorrelationId",n.externalCorrelationId),n.embedContext&&(k.setCoreContext("Window.EmbedContext",n.embedContext),k.setCoreContext("AppInfo.EmbedReferrer",function(e,t){try{const{referrer:i}=t.getSearchState(),n=e.document.referrer,a=e.parent.opener;let s=i;return uO(e,s)||(s=n&&(0,Os.Lp)(n),uO(e,s)||(s=a&&a.location&&a.location.hostname||void 0,!uO(e,s)&&e.location.ancestorOrigins&&e.location.ancestorOrigins.length>0&&(s=e.location.ancestorOrigins[0]))),s||""}catch(e){return""}}(p,h.state))),this.setTelemetryContext(k,a,o),k.setCoreContext("AppInfo.ArchVersion","V2"),e.telemetryService=k}))}setPreAuthUserId(e,t,i){const n=e.get(S.J.Telemetry);i&&n.enablePreAuthIdSampling&&(t.setCoreContext("AppInfo.PreAuthUserSamplingId",i),pO.H.getInstance().setSamplingByPreAuthId(i))}createCoreUserBiService(e){var t;const{config:i}=e,n=null===(t=e.telemetryService)||void 0===t?void 0:t.createUserBiService(e,h.ew,{id:(0,qe.v4)(),source:k.D.StandAlone,startTimestamp:i.startTimeMS});e.userBiService=n}setTelemetryContext(e,t,i){const{deviceInfo:n,systemCpuInfo:a,systemMemoryInfo:s}=t;if(n&&(e.setCoreContext("DeviceInfo.Make",n.make),e.setCoreContext("DeviceInfo.Model",n.model),e.setCoreContext("DeviceInfo.CpuArchitecture",n.cpuArchitecture),e.setCoreContext("DeviceInfo.OsVersion",n.osVersion)),a&&(e.setCoreContext("CpuInfo.Cores",a.cpuCores.length.toString()),e.setCoreContext("CpuInfo.Model",a.cpuCores[0].model),e.setCoreContext("CpuInfo.Speed",a.cpuCores[0].speed)),s&&e.setCoreContext("DeviceInfo.TotalMemory",s.totalPhysicalMemoryBytes),i&&0!==i.length){const t=i.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.column]:t.value})),{}),n=t.launchIntent,a=t.desktopVersion,s=t.deviceAuthToken,o=t.windowsChannel,r=t.windowsSku,c=t.storageInfo,l=t.outOfProcState;n&&e.setCoreContext("AppInfo.LaunchIntent",n),a&&e.setCoreContext("AppInfo.DesktopVersion",a),l&&e.setCoreContext("AppInfo.OutOfProcState",l),s&&e.setDeviceAuthToken(s),o&&e.setCoreContext("DeviceInfo.WindowsChannel",o),r&&e.setCoreContext("DeviceInfo.WindowsSku",r),c&&e.setCoreContext("DeviceInfo.StorageInfo",c)}}startAppStartScenarios(e,t){const{config:i,loggerFactory:n,routingServices:a,telemetryService:s,windowProvider:o}=e,r=this.getDownloadAndParseStepData(n,t,o);null==s||s.newCoreScenario(z.RG.AppStart,{startTime:i.startTimeMS}),gO(i.experienceName,t,i.startTimeMS,a.state,o,r)}getDownloadAndParseStepData(e,t,i){let n;if(i.performance){const a=e.newLogger("InitTelemetryTask","core-services-tasks");i.performance.timing&&t.createScenarioWithoutStarting(z.RG.DomLoadingStart,{startTime:i.performance.timing.domLoading}).stop();const s=i.performance.getEntriesByType("resource").find((e=>"script"===e.initiatorType&&e.name.indexOf("main")>=0)),o=void 0!==s&&0===s.transferSize;n=hO(z.RG.DownloadAndParse,"execute-index-html-script","start-execute-main-bundle",i,t,a,{cached:o}),hO(z.RG.ResolveMainImports,"start-execute-main-bundle","resolve-main-imports-end",i,t,a)}return n}}const iR=e=>t=>{if("quit"===t)null==e||e.getTelemetryServicesCache().forEach((e=>{var t,i;return null===(i=(t=e.coreScenarioFactory).incompleteRunningScenarios)||void 0===i?void 0:i.call(t)}))};var nR=i(949300);class aR extends Ue{constructor(){super(h.Yg.InitUserBrbServiceTask,["activeWindowsService","scenarioFactory","loggerFactory","coreSettings","logsCollectorService","authenticationService","authenticationUser","platformService","discover","windowProvider","hostCommunicationService","endpointsManager","brbServiceManager","client","i18n"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{activeWindowsService:t,scenarioFactory:i,loggerFactory:n,coreSettings:a,logsCollectorService:s,authenticationService:o,authenticationUser:r,platformService:c,discover:l,windowProvider:d,hostCommunicationService:u,endpointsManager:m,brbServiceManager:g,client:h,i18n:p}=e;if(!r)throw new Error("authenticationUser is invalid, cannot register user brb service.");const v=(0,He.b4)(r);return g.registerUserBrbService(v,(()=>new nR.w(n,a,s,o,c,l,d,u,m,i,p,t,r,h))),e=>{"signout"===e&&g.unregisterUserBrbService(v)}}))}}class sR extends Ue{constructor(){super(h.Yg.InitializePulsarTask,["coreSettings","loggerFactory","platformService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:i,platformService:n}=e,a=new ts(Qa.TEAMS_CORE,{sessionId:n.host.sessionId,spanExporter:new is,loggerFactory:i,logToOTLCollector:!!t.get(S.J.Pulsar).logToOTLCollector});t.get(S.J.Pulsar).enablePulsarTelemetry&&(yield a.initialize()),e.pulsar=a}))}}class oR extends Ue{constructor(){super(h.Yg.RegisterCustomFrameThemes,["coreSettings","hostCommunicationService"])}execute(e){var t,i,a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:n,hostCommunicationService:o}=e,{primaryWindowTitleBarHeightPx:r,secondaryWindowTitleBarHeightPx:c}=n.get(S.J.Core),l=yield o.loadModule("windowcontrols");r&&c&&(null===(t=null==l?void 0:l.defineCustomFrameTheme)||void 0===t||t.call(l,"main",{buttonHeight:r,buttonWidth:44}),null===(i=null==l?void 0:l.defineCustomFrameTheme)||void 0===i||i.call(l,"default",{buttonHeight:c,buttonWidth:44}),null===(a=null==l?void 0:l.defineCustomFrameTheme)||void 0===a||a.call(l,"mainClassic",{buttonHeight:r,buttonWidth:44,light:{closeColors:{background:{normal:"#444791ff",inactive:"#44479199",mouseOver:"#c4314bff",mouseDown:"#a72037ff"},foreground:{normal:"#ffffffff",inactive:"#ffffff99",mouseOver:"#ffffffff",mouseDown:"#ffffffff"}},minMaxColors:{background:{normal:"#444791ff",inactive:"#44479199",mouseOver:"#4f52b2ff",mouseDown:"#3d3e78ff"},foreground:{normal:"#ffffffff",inactive:"#ffffff99",mouseOver:"#ffffffff",mouseDown:"#ffffffff"}}}}),null===(s=null==l?void 0:l.defineCustomFrameTheme)||void 0===s||s.call(l,"defaultClassic",{buttonHeight:c,buttonWidth:44,light:{closeColors:{background:{normal:"#444791ff",inactive:"#44479199",mouseOver:"#c4314bff",mouseDown:"#a72037ff"},foreground:{normal:"#ffffffff",inactive:"#ffffff99",mouseOver:"#ffffffff",mouseDown:"#ffffffff"}},minMaxColors:{background:{normal:"#444791ff",inactive:"#44479199",mouseOver:"#4f52b2ff",mouseDown:"#3d3e78ff"},foreground:{normal:"#ffffffff",inactive:"#ffffff99",mouseOver:"#ffffffff",mouseDown:"#ffffffff"}}}}))}))}}class rR extends Ue{constructor(){super(h.Yg.ReloadExperience,["coreSettings","platformService","rebootService","loggerFactory","scenarioFactory","windowProvider"]),this.isReloadRequired=(e,t)=>e&&t&&e!==t}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,platformService:i,rebootService:n,loggerFactory:a,scenarioFactory:s,windowProvider:o}=e,r=a.newLogger("ReloadExperienceTask","core-services-tasks"),{buildRing:c,assignedRing:l}=this.getRings(i,t);if(this.isReloadRequired(c,l)&&l){r.log(`Reload required: Assigned: ${l}, Build: ${c}`);return(yield n.rebootApp(bo.Z.RingSwitch,bo.d.ReloadAppTask,{qsps:{ring:l},maxRetries:1}))?this.deleteEcsCaches(o):this.reportReloadNotTriggered(c,l,r,s),e=>{"signout"===e&&n.clearRetryCount(bo.d.ReloadAppTask)}}r.debug(`No reload required: Assigned: ${l}, Build: ${c}`),n.clearRetryCount(bo.d.ReloadAppTask)}))}getRings(e,t){const{ring:i}=t.get(S.J.Metadata);return{assignedRing:(null==i?void 0:i.id)||void 0,buildRing:e.ecsOverrides.ring||void 0}}reportReloadNotTriggered(e,t,i,n){i.warn(`Ring Discrepancy: Assigned: ${t}, Build: ${e} `),n.createScenarioWithoutStarting(z.RG.BuildRingDiscrepancy).fail({message:e})}deleteEcsCaches(e){Object.keys(e.localStorage).filter((e=>e.endsWith(ah.EcsCache))).forEach((t=>e.localStorage.removeItem(t)))}}class cR extends Ue{constructor(){super(h.Yg.SetAppStateToTelemetryTask,["telemetryService","hostState","networkState","coreSettings"])}execute(e){var t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{telemetryService:n,hostState:a,networkState:s,coreSettings:o}=e;o.get(S.J.Telemetry).enableTelemetryCancelOnSuspendAndNetworkOffline&&(a&&n.initTelemetrySuspendStateSubscription(a,null!==(t=o.get(S.J.Telemetry).scenarioCancelOnSuspendStateChangeBlockList)&&void 0!==t?t:[]),s&&n.initTelemetryNetworkStateSubscription(s,null!==(i=o.get(S.J.Telemetry).scenarioCancelOnNetworkStateChangeBlockList)&&void 0!==i?i:[]))}))}}class lR extends Ue{constructor(){super(h.Yg.SetRingFinderCookieTask,["authenticationUser","coreSettings","loggerFactory","windowProvider","discover","i18NextWrapper"]),this.setAuthCookie=(e,t,i,n)=>{var a;if(void 0===(null===(a=e.document)||void 0===a?void 0:a.cookie))return void t.warn(`Cannot set cookie: '${i}'.`);t.log(`Setting '${i}' cookie.`);const s=new Date,o=s.setMonth(s.getMonth()+5);e.document.cookie=`${i}=${n};expires=${new Date(o).toUTCString()};path=/;secure;samesite=none`},this.cleanUpCookie=(e,t,i)=>{var n;void 0!==(null===(n=e.document)||void 0===n?void 0:n.cookie)&&(t.log(`Expiring '${i}' cookie.`),e.document.cookie=`${i}=;max-age=0;path=/;secure;samesite=none`)}}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:i,discover:n,loggerFactory:a,windowProvider:s,i18NextWrapper:o}=e,r=a.newLogger("SetRingFinderCookieTask","core-services-tasks");try{const{windowsInsiderChannel:e,windowsInsiderRing:a}=i.get(S.J.Host),{enableRegionParamForPDS:c,enableLocaleInRingFinder:l}=i.get(S.J.Core);let d;c&&(d=yield n.getRegion({id:t.id,tenantId:t.profile.tenantId,oid:t.profile.objectId,accountType:t.type,userName:t.loginUserName||""}));const u=l?o.locale:void 0,m={oid:t.profile.objectId,tid:t.profile.tenantId,wipChannel:e,wipRing:a,region:d,locale:u},g="ringFinder";return this.setAuthCookie(s,r,g,encodeURIComponent((0,U.u4)(m))),e=>{switch(e){case"signout":{const{cleanupRingFinderCookie:e}=i.get(S.J.Core);e&&this.cleanUpCookie(s,r,g);break}default:return}}}catch(e){r.error(`Failed to set ring finder cookie: ${(0,oe.VK)(e)}`)}}))}}class dR extends Ue{constructor(){super(h.Yg.SetPrimaryUserOnTelemetry,["primaryUser","loggerFactory","telemetryContextService","hostCommunicationService"])}execute(e){var t,i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{primaryUser:n,loggerFactory:s,telemetryContextService:o,hostCommunicationService:r}=e;try{const e=(0,He.b4)(n),i=n.profile.tenantId;o.setPrimaryUser(e,i);const a=yield r.loadModule("telemetry");null===(t=null==a?void 0:a.setPrimaryUser)||void 0===t||t.call(a,e,i)}catch(e){const t=new ze.G(ze.$.TELEMETRY_PRIMARY_USER_SET_FAILURE,e,(0,He.b4)(n));null===(a=(i=s.newLogger("SetUserOnTelemetryContext","core-services-tasks")).error)||void 0===a||a.call(i,t.toTelemetryEntry())}}))}}class uR{constructor(){this.id=h.Yg.SetUserOnDiagnosticsService}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:i,diagnosticsService:n,logsCollectorService:a}=mg("SetUserOnDiagnosticsServiceTask",e,"authenticationUser","coreSettings","diagnosticsService","logsCollectorService");a.setPrimaryUserID(t.id);const{enableMTMA:s}=i.get(S.J.Core);if(s){const i=n.createUserDiagnosticsService(t.profile.tenantId,t.profile.objectId,t.id);i&&(e.diagnosticsService=i,a.registerUserLogsProvider(t.id,i),e.loggerFactory=new ae(i,e.loggerFactory.cID))}else n.updateDiagnosticInfo(t.profile.tenantId,t.profile.objectId);return e=>{switch(e){case"quit":n.persistDiagnosticsAsPreviousSessionLogs();break;case"signout":t.id&&a.handleUserLogout(t.id),n.handleUserLogout(t.id)}}}))}}function mR(e){return!!(null==e?void 0:e.isAuthenticated)}function gR(e,t){const{enableTflFreProfileConsentDialog:i}=e.get(S.J.Fre);return!(!i||t&&"true"===t.get("TflFreProfileCardDisplayed"))}class hR extends Ue{constructor(){super(h.Yg.SignalCoreLifecycleChangesTask,["authenticationUser","client","clientState","config","coreSecurityService","coreSettings","coreUtilities","correlation","entityCommanding","experienceChangeReportingService","experienceLifecycleManager","hostCommunicationService","i18n","i18NextWrapper","localStorage","loggerFactory","networkState","platformService","rebootService","scenarioFactory","userBiService","windowProvider","notificationsHandler","logsCollectorService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{activeWindowsHistoryService:t,authenticationUser:i,client:a,clientState:s,clientAccessAdminPolicyCheckService:o,config:r,coreSecurityService:c,coreSettings:l,coreUtilities:{isEntityInView:d},correlation:u,entityCommanding:m,experienceChangeReportingService:g,experienceLifecycleManager:h,hostCommunicationService:p,i18n:v,i18NextWrapper:f,localStorage:b,loggerFactory:y,networkState:k,platformService:w,rebootService:j,scenarioFactory:C,userBiService:_,userTrackingService:T,windowProvider:I,notificationsHandler:N,logsCollectorService:E}=e,F=e.localMigratedSettings,x=y.newLogger("SignalCoreLifecycleChangesTask","core-services-tasks");if(!i||!mR(i))return void x.warn("Not creating user lifecycle manager as authenticated user is not available.");const{disableExperience:D}=l.get(S.J.Core),{crossCloudMeetingEnabled:A}=l.get(S.J.HostCapabilities),M=D&&i.role!==zo.w4.Anonymous,P=D&&!1===A&&i.role===zo.w4.Anonymous;if(M||P)return void x.warn(`Not creating user lifecycle manager as experience is disabled. UserRole ${i.role}, \n          disableExperience: ${D}, crossCloudMeetingEnabled: ${A}`);if(o){let e;try{e=yield o.isUserAllowed()}catch(t){x.warn(`isUserAllowed encountered exception: ${t}`),e=!0}if(!e)return void x.warn("Not creating user lifecycle manager as experience is disabled by admin policy.")}const O=u.id,R=(0,He.b4)(i);return h.manageUser(R,{activeWindowsHistoryService:t,authenticationUser:i,client:a,clientState:s,config:r,coreSecurityService:c,coreSettings:l,entityCommanding:m,i18n:v,i18NextWrapper:f,isEntityInView:d,localMigratedSettings:F,loggerFactory:y,networkState:k,platformService:w,rebootService:j,scenarioFactory:C,hostCommunicationService:p,userTrackingService:T,windowProvider:I,localStorage:b,userBiService:_,notificationsHandler:N,logsCollectorService:E}),g.report({correlationId:O,userContextId:R,type:Mt.yU.UserAuthenticated,context:{target:"core-tasks-signal-core-lifecycle-changes-task"}}),gR(l,b)||g.report({correlationId:O,type:Mt.yU.UserConsentedToConsumeResources,userContextId:R,context:{target:"core-tasks-signal-core-lifecycle-changes-task"}}),e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){switch(e){case"quit":case"signout":yield h.removeUser(e,R);break;default:return}}))}))}}class pR extends Ue{constructor(){super(h.Yg.StoreBuildInfoTask,["localStorage","platformService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{localStorage:t,platformService:i}=e,n=i.config.buildVersion;n&&!n.toLocaleLowerCase().startsWith("local")&&t.set("buildNumber",n,"Experience")}))}}class vR extends Ue{constructor(){super(h.Yg.TrackExperienceIdle,["clientState","correlation","coreSettings","experienceChangeReportingService"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{clientState:t,correlation:i,coreSettings:a,experienceChangeReportingService:s}=e,{enableExperienceIdleStateManagement:o}=a.get(S.J.Core);if(!o)return;const r=t.observe().subscribe((e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=e===$e.pk.LongInactive;s.report({correlationId:i.id,type:Mt.yU.ExperienceIdleStateChanged,context:{target:"core-tasks-signal-core-lifecycle-changes-task",isIdle:t}})}))));return e=>{switch(e){case"signout":case"quit":r.unsubscribe()}}}))}}class fR extends Ue{constructor(){super(h.Yg.UpdateDataClientContext,[])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){!function(e,t){var i,n,a;const s=Object.assign(Object.assign({},t),{pubsub:e.getServices().pubsub,send:(0,_l.UZ)(Dr.l,t.networkState.observeIsOnline())}),o=qv.singletonLink,r=RS.clientResolvers;if(!o||!r)throw new Error("Link and client resolvers should be created at this point");const{maxApolloResultCacheSize:c,enableApolloDoubleWriteFix:l}=t.coreSettings.get(S.J.Core),{enableApolloDevtools:d}=t.coreSettings.get(S.J.Diagnostics),u=null!=c?c:void 0,m=null===(i=t.leakDetectorService)||void 0===i?void 0:i.create(),g=lN({leakDetector:m,windowId:null===(n=e.cache.apolloLeakInfo)||void 0===n?void 0:n.apolloLeakInfoWindowId,entityType:null===(a=e.cache.apolloLeakInfo)||void 0===a?void 0:a.apolloLeakInfoEntityType,viewportContext:"cmd"},void 0,r,u,t.loggerFactory,t.scenarioFactory,void 0,d,_p.cmd,t.graphqlStoreStatsReporterService,l);qp(g,"cmdApolloClient",Boolean(d),t.platformService,t.config.experienceName);const h=oN.createUserDataRequestContext(s,g),p=gN(h,o);e.updateContext(h,p),g.setLink(p)}(e.client,e)}))}}class bR extends Ue{constructor(){super(h.Yg.UpdateNetworkStateDetection,[])}execute(e){var t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.authenticationUser&&(0,He.b4)(e.authenticationUser)||"",a=null===(i=(t=e.networkState).subscribeToEndpointsNetworkStateTracking)||void 0===i?void 0:i.call(t,n,e.endpointsManager.networkState);return e=>{"signout"===e&&a()}}))}}class yR extends Ue{constructor(){super(h.Yg.WaitForCDLWorkerTask,["loggerFactory","coreSettings","coreSettingsContext"])}execute(e){var t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:n,coreSettings:a,coreSettingsContext:s}=e,{cdlWorkerService:o}=e,r=n.newLogger("WaitForCDLWorkerTask","core-services-tasks");if(!(0,xu.Q6)(a))return;const{isCDLWorkerCriticalToStartup:c}=a.get(S.J.Core);if(o){r.log("Waiting for CDL worker to finish initialization");const e=yield o.getCDLWorkerManager();if(e)e.syncEngineInitializationPromise.then((e=>{s.updatePlatformProviderSettings({bootType:e.bootType})}));else if(null===(t=r.errorToTelemetry)||void 0===t||t.call(r,`CDL worker manager not initialized. isCDLWorkerCriticalToStartup: ${c}.`,"cdl_wait_for_cdl_worker_task",void 0,!0),c)throw new ze.G(ze.$.CDL_WORKER_FAILURE)}else if(null===(i=r.warnToTelemetry)||void 0===i||i.call(r,`CDL worker service not present in core context. isCDLWorkerCriticalToStartup: ${c}.`,"cdl_wait_for_cdl_worker_task",void 0,!0),c)throw new ze.G(ze.$.CDL_WORKER_FAILURE)}))}}class kR extends Ue{constructor(){super(h.Yg.WrapChangeReportingServicesTask,["commandChangeReportingService","experienceChangeReportingService","authenticationUser"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,experienceChangeReportingService:i,authenticationUser:n}=e,a=(0,He.b4)(n);return e.commandChangeReportingService=Object.assign(Object.assign({},e.commandChangeReportingService),{report:e=>{t.report(Object.assign({userContextId:a},e))},observeChanges:t.observeChanges.bind(t)}),e.experienceChangeReportingService=Object.assign(Object.assign({},e.experienceChangeReportingService),{report:e=>{i.report(Object.assign({userContextId:a},e))},observeChanges:i.observeChanges.bind(i)}),Promise.resolve()}))}}class SR{constructor(e,t,i){this.cache=new Map,this.lastId=0,this.blacklist=["imgpsh_fullsize"],this.currentSize=0,this.cacheHits=0,this.cacheMisses=0,this.maxCacheSize=e,this.cachePruneRatio=t,this.scenarioFactory=i}add(e,t,i){var n;if(this.maxCacheSize<=0)return!1;if(!t)return!1;if(!this.shouldCache(e))return!1;let a;if(this.has(e,t)){const s=this.get(e,t);a=Object.assign(Object.assign({},s),i),s&&(s.blob!==i.blob&&URL.revokeObjectURL(s.blob),this.currentSize+=a.size-(null!==(n=null==s?void 0:s.size)&&void 0!==n?n:0))}else a=Object.assign(Object.assign({},i),{time:this.lastId++}),this.cacheMisses++,this.currentSize+=a.size;const s=this.getCacheKey(e,t);return this.cache.set(s,a),this.pruneIfNeeded(),!0}setCapacity(e,t){this.maxCacheSize=e,this.cachePruneRatio=t,this.pruneIfNeeded()}has(e,t){return!!t&&this.cache.has(this.getCacheKey(e,t))}get(e,t){if(!t)return;const i=this.getCacheKey(e,t),n=this.cache.get(i);return n&&(n.time=this.lastId++,this.cacheHits++),n}get size(){return this.cache.size}getCacheKey(e,t){return`${e}/${t}`}getCacheHitRatio(){const e=this.cacheHits+this.cacheMisses;if(!e)return 0;return Math.round(this.cacheHits/e*100)/100}shouldCache(e){for(const t of this.blacklist)if(e.includes(t))return!1;return!0}pruneIfNeeded(){if(this.currentSize>this.maxCacheSize){const e={};e.cacheCountBeforePruning=this.size;const t=this.scenarioFactory.newScenario(z.RG.AMSMemoryCachePrune),i=Array.from(this.cache.entries());i.sort(((e,t)=>e[1].time-t[1].time));const n=Math.max(this.currentSize-this.maxCacheSize,Math.ceil(this.maxCacheSize*this.cachePruneRatio));let a=0;for(const[e,t]of i){const i=t.size;if(!(a+i<=n))break;this.currentSize-=i,this.cache.delete(e),a+=i,URL.revokeObjectURL(t.blob)}e.cacheHitRatio=this.getCacheHitRatio(),e.cacheCountAfterPruning=this.size,t.stop(e)}}}class wR extends Ue{constructor(){super(h.Yg.CreateAMSImageCaches,["coreSettings","scenarioFactory"]),this.BYTE_MULTIPLIER=1e6,this.PRUNE_RATIO=.2}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,scenarioFactory:i}=e,n=new SR(0,this.PRUNE_RATIO,i);e.amsImageCache=n;const a=t.getObservable(S.J.ImageCache).subscribe((e=>{let t=0;"number"==typeof e.amsImageCacheMaxCapacityInMB&&(t=e.amsImageCacheMaxCapacityInMB),n.setCapacity(t*this.BYTE_MULTIPLIER,this.PRUNE_RATIO)}));return()=>a.unsubscribe()}))}}class jR{constructor(e,t,i){this._windowId=e,this._logger=t,this._enableDecoupleCommandingFromApollo=i,this._entityExtensionSubject=new o.t,this._extendedEntityContainerStateSubject=new o.t,this._modalState=void 0}observeModalState(){return this.enableDecoupleCommandingFromApollo?this._entityExtensionSubject:null}get enableDecoupleCommandingFromApollo(){return this._enableDecoupleCommandingFromApollo}observeContainerState(){return this._extendedEntityContainerStateSubject.complete(),this._extendedEntityContainerStateSubject=new o.t,this._extendedEntityContainerStateSubject}isBlockingEntityExtension(){return!!this._blockingEntityExtension}isBlockedByEntity(e){var t;return this.enableDecoupleCommandingFromApollo?(null===(t=this._blockingEntityExtension)||void 0===t?void 0:t.type)===e:null}setBlockingEntityExtension(e){this._blockingEntityExtension=e}setEntityExtension(e,t,i){var n,a,s;(t!==(null===(n=this._modalState)||void 0===n?void 0:n.isExternal)||this.hasEntityChanged(i))&&(this._modalState=Object.assign(Object.assign({},this._modalState),{isExternal:t,entity:i}),this._entityExtensionSubject.next({isExternal:!!(null===(a=this._modalState)||void 0===a?void 0:a.isExternal),entityExtension:null===(s=this._modalState)||void 0===s?void 0:s.entity,correlationId:e}))}setContainerState(e){var t,i,n,a,s;e!==(null===(t=this._modalState)||void 0===t?void 0:t.containerState)&&(this._modalState=Object.assign(Object.assign({},this._modalState),{containerState:e}),(null===(i=this._modalState)||void 0===i?void 0:i.containerState)&&this._extendedEntityContainerStateSubject.next({containerState:null===(n=this._modalState)||void 0===n?void 0:n.containerState,hasEntityExtension:!!(null===(s=null===(a=this._modalState)||void 0===a?void 0:a.entity)||void 0===s?void 0:s.type)}))}updateModalState(e){var t,i,n,a,s;e.id===this._windowId?(this.setEntityExtension(e.correlation.id,(null===(n=e.extendedEntityContainerState)||void 0===n?void 0:n.isExternal)||!1,(null===(a=e.activeEntities)||void 0===a?void 0:a.entityExtension)||void 0),this.setContainerState(null===(s=e.extendedEntityContainerState)||void 0===s?void 0:s.containerState)):null===(i=(t=this._logger).errorToTelemetry)||void 0===i||i.call(t,"updateModalState got called on wrong window","webclient_framework_foundation_core_services_active_windows")}hasEntityChanged(e){var t;const i=null===(t=this._modalState)||void 0===t?void 0:t.entity;return(null==i?void 0:i.id)!==(null==e?void 0:e.id)||(null==i?void 0:i.type)!==(null==e?void 0:e.type)||(null==i?void 0:i.action)!==(null==e?void 0:e.action)||(null==i?void 0:i.options)!==(null==e?void 0:e.options)}}class CR{constructor(e,t,i){this._enableDecoupleCommandingFromApollo=i,this._modalManager=new jR(e,t,i)}get enableDecoupleCommandingFromApollo(){return this._enableDecoupleCommandingFromApollo}get modalManager(){return this._modalManager}}class _R{constructor(e,t,i){this._enableDecoupleCommandingFromApollo=t,this._enableDecoupleCommandingFromApolloRerenderForCorrelation=i,this._activeWindowsSubject=new o.t,this.cleanup=(e,t)=>{this._logger.log(`cleaning up activeWindowsService for user: ${t} due to ${e}`)},this._activeWindows=new Map,this._windowLayoutServices=new Map,this._logger=e.newLogger("ActiveWindowsService","core-services-active-windows"),this._defaultMainWindowLayoutService=new CR(h.ew,this._logger,t),this._windowLayoutServices.set(h.ew,this._defaultMainWindowLayoutService)}getActiveWindowsObservable(){return this._activeWindowsSubject.pipe((0,l.U)((e=>Array.from(e.values()))))}getActiveWindowObservable(e){return this._activeWindowsSubject.pipe((0,l.U)((t=>t.get(e))),(0,u.h)((e=>!!e)),(0,er.x)(((e,t)=>this.comparator(e,t))))}getActiveWindows(){return Array.from(this._activeWindows.values())}getActiveWindow(e){return this._activeWindows.get(e)}setActiveWindows(e,t){this._activeWindows.clear(),e.forEach((e=>{this._createWindowLayoutService(e.id),this._activeWindows.set(e.id,e)})),null==t||t(),this._activeWindowsSubject.next(this._activeWindows)}removeActiveWindowById(e){this._windowLayoutServices.delete(e);const t=this._activeWindows.get(e);return this._activeWindows.delete(e),this._activeWindowsSubject.next(this._activeWindows),t}getStandardMainWindow(){const e=this.getActiveWindows();return null==e?void 0:e.find((e=>e.isMainWindow&&e.layoutConfig.layoutMode===ve.lO.standard))}getWindowLayoutService(e=h.ew){if(!this._enableDecoupleCommandingFromApollo)return this._defaultMainWindowLayoutService;const t=this._windowLayoutServices.get(e);if(!t)throw new ze.G(ze.$.CORE_SERVICES_MISSING,new Error(`windowLayoutService was not created for windowId: ${e}`));return t}get enableDecoupleCommandingFromApollo(){return this._enableDecoupleCommandingFromApollo}_createWindowLayoutService(e){this._windowLayoutServices.get(e)||this._windowLayoutServices.set(e,new CR(e,this._logger,this._enableDecoupleCommandingFromApollo))}comparator(e,t){return(null==e?void 0:e.userContextId)===(null==t?void 0:t.userContextId)&&this.hasSameActiveEntities(null==e?void 0:e.activeEntities,null==t?void 0:t.activeEntities)&&this.hasSameLayoutConfig(null==e?void 0:e.layoutConfig,null==t?void 0:t.layoutConfig)&&!((null==t?void 0:t.correlation.id)!==(null==e?void 0:e.correlation.id)&&this._enableDecoupleCommandingFromApolloRerenderForCorrelation)}hasSameActiveEntities(e,t){const i=Object.keys(pe.$z).filter((i=>{var n,a,s,o,r,c;const l=null==e?void 0:e[i],d=null==t?void 0:t[i];return(null==l?void 0:l.action)!==(null==d?void 0:d.action)||(null==l?void 0:l.id)!==(null==d?void 0:d.id)||(null===(n=null==l?void 0:l.linkedEntity)||void 0===n?void 0:n.action)!==(null===(a=null==d?void 0:d.linkedEntity)||void 0===a?void 0:a.action)||(null===(s=null==l?void 0:l.linkedEntity)||void 0===s?void 0:s.id)!==(null===(o=null==d?void 0:d.linkedEntity)||void 0===o?void 0:o.id)||(null===(r=null==l?void 0:l.linkedEntity)||void 0===r?void 0:r.type)!==(null===(c=null==d?void 0:d.linkedEntity)||void 0===c?void 0:c.type)||(null==l?void 0:l.options)!==(null==d?void 0:d.options)||(null==l?void 0:l.type)!==(null==d?void 0:d.type)}));return 0===i.length}hasSameLayoutConfig(e,t){if((null==e?void 0:e.isFullscreen)!==(null==t?void 0:t.isFullscreen)||(null==e?void 0:e.layoutMode)!==(null==t?void 0:t.layoutMode))return!1;const i=Object.keys(ve.mR).filter((i=>{var n,a;const s=null===(n=null==e?void 0:e.slots)||void 0===n?void 0:n[i],o=null===(a=null==t?void 0:t.slots)||void 0===a?void 0:a[i];return(null==s?void 0:s.height)!==(null==o?void 0:o.height)||(null==s?void 0:s.isHidden)!==(null==o?void 0:o.isHidden)||(null==s?void 0:s.width)!==(null==o?void 0:o.width)}));return 0===i.length}}class TR extends Ue{constructor(){super(h.Yg.CreateActiveWindowsServiceTask,["loggerFactory","coreSettings"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:i}=e,{enableDecoupleCommandingFromApollo:n,enableDecoupleCommandingFromApolloRerenderForCorrelation:a}=t.get(S.J.Core),s=new _R(i,!!n,!!a);return e.activeWindowsService=s,e=>s.cleanup(e)}))}}var IR=i(839856);class NR{constructor(e,t,i){this.logger=i;const n=this;this.proxy=new Proxy(t,{get(t,a){const s=t[a];if(s)return"function"!=typeof s?s:(...o)=>{let r="";r=n.getParamsAsString(o,!0),i.log(`Calling ${e}.${String(a)}(${r})`);const c=s.apply(t,o);return c&&c.then&&c.then((t=>i.log(`${e}.${String(a)}(${r}) response: ${n.getParamsAsString(t)}`))).catch((t=>i.error(`${e}.${String(a)}(${r}) response: ${n.getParamsAsString(t)}`))),c};i.error(`${e}.${String(a)}: Not Available`)}})}getProxy(){return this.proxy}getParamsAsString(e,t=!1){let i="";try{i=t?e.map((e=>JSON.stringify(e))).join(","):JSON.stringify(e);const n=1e3;if(i.length>n){const e="...";i=`${i.substring(0,n-e.length)}${e}"`}}catch(e){this.logger.log(`Failed to serialize params: ${e.message}`)}return i}}const ER="tmp.vdiOptimizationMode";class FR{constructor(e,t,i){this.loggerFactory=e,this.hostCommunicationService=t,this.windowProvider=i,this.logger=this.loggerFactory.newLogger("VDIPlatformService","core-services-vdi")}init(){var e,t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{yield this.loadVDIModule();const i=yield null===(t=null===(e=this.vdiModule)||void 0===e?void 0:e.getAllVDISettings)||void 0===t?void 0:t.call(e);if(i){const{mode:e,provider:t,isAvRemoted:a,configFilter:s,optimizationMode:o,citrixVdaVersion:r,vmwareVdaVersion:c,sessionId:l}=i,d=this.getVDIPlatformProvider(t);if(d===wh.None)return;const u=this.getProxiedVdiModule(),m=e=>Promise.reject(`${e}: Not Available`),g={isVDI:!0,mode:e,provider:d,isAvRemoted:a,configFilter:"string"==typeof s&&s.length?s:null,sessionId:l,vdiOptimizationMode:o,utils:{getWVDConfig:()=>{var e,t;return null!==(t=null===(e=u.getWVDConfig)||void 0===e?void 0:e.call(u))&&void 0!==t?t:m("getWVDConfig")},getWindowHandleAsHex:()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.getMainWindowId();return this.getNativeWindowHandleAsHex(null!=e?e:"")})),getNativeWindowHandle:e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.getNativeWindowHandleAsHex(e)})),getVDILocalStackPolicy:()=>{var e,t;return null!==(t=null===(e=u.getVDILocalStackPolicy)||void 0===e?void 0:e.call(u))&&void 0!==t?t:m("getVDILocalStackPolicy")},getVMWareSecureWebPort:()=>{var e,t;return null!==(t=null===(e=u.getVMWareSecureWebPort)||void 0===e?void 0:e.call(u))&&void 0!==t?t:m("getVMWareSecureWebPort")},getCitrixMSTeamsRedir:()=>{var e,t;return null!==(t=null===(e=u.getCitrixMSTeamsRedir)||void 0===e?void 0:e.call(u))&&void 0!==t?t:m("getCitrixMSTeamsRedir")},getCitrixVdaVersion:()=>Promise.resolve(r),getVMwareVdaVersion:()=>Promise.resolve(c),getVMWareViewClientId:()=>{var e,t;return null!==(t=null===(e=u.getVMWareViewClientId)||void 0===e?void 0:e.call(u))&&void 0!==t?t:m("getVMWareViewClientId")},setVDIOptimizationMode:e=>this.setVDIOptimizationModeOverride(e),resetVDIOptimizationMode:()=>this.setVDIOptimizationModeOverride(void 0)}},h=this.getVDIOptimizationSettingsOverride(g);return g&&h&&(g.mode=h.mode,g.isAvRemoted=h.isAvRemoted,g.configFilter=h.configFilter,g.vdiOptimizationMode=h.vdiOptimizationMode,this.logger.log("VDIOptimizationSettingsOverride vdiPlatformConfig.vdiOptimizationMode:",g.vdiOptimizationMode)),g}}catch(e){let t="Unknown Error";this.vdiModule||(t="Failed to load vdiModule"),this.logger.error(`Failed to setup VDI environment: ${t}`)}}))}setVDIOptimizationModeOverride(e){switch(e){case IR.bT.webrtc:case IR.bT.slimcore:case IR.bT.none:this.windowProvider.localStorage.setItem(ER,e);break;default:this.windowProvider.localStorage.removeItem(ER)}}getVDIOptimizationModeOverride(){const e=this.windowProvider.localStorage.getItem(ER);switch(e){case IR.bT.webrtc:case IR.bT.slimcore:case IR.bT.none:return e;default:return}}getVDIOptimizationSettingsOverride(e){const t=this.getVDIOptimizationModeOverride();return t&&e?{mode:this.getVdiModeOverride(e.mode,t),isAvRemoted:IR.bT.webrtc===t,configFilter:this.getConfigFilterOverride(e.configFilter,t),vdiOptimizationMode:t}:null}getVdiModeOverride(e,t){let i="0";switch(t){case IR.bT.webrtc:i="1";break;case IR.bT.slimcore:i="2"}return 4===e.length?e[0]+i+e.substring(2):e}getConfigFilterOverride(e,t){if(!e)return null;let i=e;switch(t){case IR.bT.webrtc:i=e.replace("-slimcore-","-av-");break;case IR.bT.slimcore:i=e.replace("-av-","-slimcore-")}return i}getVDIPlatformProvider(e=IR.GV.None){let t="0";switch(e){case IR.GV.Citrix:t="1";break;case IR.GV.VMware:t="3";break;case IR.GV.AVD:case IR.GV.Windows365:t="5";break;case IR.GV.None:default:t="0"}return t}getMainWindowId(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.loadWindowControlsModule().then((e=>{var t;return null===(t=null==e?void 0:e.getWindowByTag)||void 0===t?void 0:t.call(e,zi.px.Main)})).then((e=>(this.logger.log(`[getMainWindowId] Got main window ID: ${e}`),e))).catch((e=>{throw this.logger.error("[getMainWindowId] Failed to retrieve main window ID"),e}))}))}getNativeWindowHandleAsHex(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.getNativeWindowHandle(e).then((t=>{var i;if(null!=(null==t?void 0:t.handle))return this.windowHandleToHex(null!==(i=null==t?void 0:t.handle)&&void 0!==i?i:0);{const t=`Failed to retrieve native window handle for windowId: ${e}`;throw this.logger.log(`[getNativeWindowHandleAsHex] ${t}`),new Error(t)}})).then((e=>(this.logger.log(`[getNativeWindowHandleAsHex] Got native window handle as hex: ${e}`),e)))}))}getNativeWindowHandle(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.loadOSUtilsModule().then((t=>{var i;return null===(i=null==t?void 0:t.getHostWindowHandle)||void 0===i?void 0:i.call(t,e).then((t=>(this.logger.log(`[getNativeWindowHandle] Got native window handle for ${e}: ${null==t?void 0:t.handle}`),t))).catch((t=>{throw this.logger.error(`[getNativeWindowHandle] Failed to retrieve native window handle for ${e}`),t}))}))}))}windowHandleToHex(e){let t=e.toString(16);for(;t.length<16;)t=`0${t}`;return t.length%2!=0&&(t=`0${t}`),this.logger.log(`[windowHandleToHex] Converted native window handle ${e} to hex: ${t}`),this.convertWindowHandleHexEndianness(t)}convertWindowHandleHexEndianness(e){var t,i;return null!==(i=null===(t=null==e?void 0:e.match(/[0-9a-f]{2}/gi))||void 0===t?void 0:t.reverse().join(""))&&void 0!==i?i:null}loadVDIModule(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return void 0===this.vdiModule&&(this.vdiModule=yield this.hostCommunicationService.loadModule("vdi")),this.vdiModule}))}getProxiedVdiModule(){return!this.proxiedVDIModule&&this.vdiModule&&(this.proxiedVDIModule=new NR("vdiModule",this.vdiModule,this.logger).getProxy()),this.proxiedVDIModule}loadOSUtilsModule(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return void 0===this.osUtilsModule&&(this.osUtilsModule=yield this.hostCommunicationService.loadModule("osutils")),this.osUtilsModule}))}loadWindowControlsModule(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return void 0===this.windowControlsModule&&(this.windowControlsModule=yield this.hostCommunicationService.loadModule("windowcontrols")),this.windowControlsModule}))}}class xR{constructor(e){this.utils=e}init(e){this.service=e}provide(){return this.service}initSlimCoreCallingSupportService(e){this.vdiSlimCoreCallingSupportService=e}provideCallingSupportService(){var e;return null!==(e=this.vdiSlimCoreCallingSupportService)&&void 0!==e?e:void 0}trackRenderTarget(e){var t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.ownerDocument.defaultView;if(null==n?void 0:n.name.length){const e="onpagehide"in n?"pagehide":"unload";n.addEventListener(e,(()=>{var e,t;null===(t=null===(e=this.service)||void 0===e?void 0:e.removeWindowHandleFromCache)||void 0===t||t.call(e,n.name)}),{once:!0});const a=yield this.utils.getNativeWindowHandle(n.name);null===(i=null===(t=this.service)||void 0===t?void 0:t.addWindowHandleToCache)||void 0===i||i.call(t,n.name,a)}}))}}class DR extends Ue{constructor(){super(h.Yg.InitVDIPlatformServiceTask,["loggerFactory","getPlatformConfigurationOverrides","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t,getPlatformConfigurationOverrides:i,windowProvider:n}=e,a=t.newLogger("InitVDIPlatformServiceTask","core-services-tasks");if((0,lx.IA)(n)&&!this.isTFL(n)){const s=JF(a),o=new FR(t,s,n),r=yield o.init();if(r){const t=(e,t)=>{const n=i(e,t);if(!n.vdi){const{provider:e,mode:t,isAvRemoted:i,configFilter:a,sessionId:s,isVDI:o,vdiOptimizationMode:c,utils:l}=r;n.vdi={isVDI:o,mode:t,provider:e,isAvRemoted:i,configFilter:a,sessionId:s,vdiOptimizationMode:c,utils:l}}return n};e.getPlatformConfigurationOverrides=t,e.vdiServiceProvider=new xR(r.utils)}}}))}isTFL(e){var t,i;return((null===(i=null===(t=e.loader)||void 0===t?void 0:t.getProperties())||void 0===i?void 0:i.environment)||At.s.prod)===At.s.life}}const AR={disableAnimations:!1};class MR extends Ue{constructor(){super(h.Yg.UpdateCoreSettingDependantClientPreferences,["coreSettings","clientPreferences"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,clientPreferences:i}=e,n=t.get(S.J.Core).disableAnimationsByDefault;void 0===i.getPreferences("animation").disableAnimations&&i.updatePreferences({animation:{disableAnimations:null!=n?n:AR.disableAnimations}})}))}}const PR="[LocalMigratedSettingsService]",OR="localMigratedSettingsService.completedConsumers",RR=["client-preferences","device-settings","i18n"];function LR(e,t){e.errorToTelemetry?e.errorToTelemetry(`${PR} ${t}`,"webclient_framework_infrastructure_local_migrated_settings",void 0,!0):e.error(`${PR} ${t}`)}class UR{constructor(e,t){this.localStorage=e,this.logger=t}isMarked(e){return this.markedConsumers.includes(e)}areAllMarked(){return 0===this.getUnmarked().length}getUnmarked(){const e=new Set(this.markedConsumers);return RR.filter((t=>!e.has(t)))}mark(e){this.isMarked(e)||(this.markedConsumers.push(e),this.localStorage.setSafe(OR,JSON.stringify(this.markedConsumers),"Experience")||LR(this.logger,"failed to save completed consumers to local storage"))}get markedConsumers(){return void 0===this.cachedMarkedConsumers&&(this.cachedMarkedConsumers=[],this.readInitialCompletedConsumers()),this.cachedMarkedConsumers}readInitialCompletedConsumers(){var e;let t=null;try{t=this.localStorage.get(OR,"Experience")}catch(e){return void LR(this.logger,"failed to read initial completed consumers from local storage")}if((0,B.isNil)(t))return this.logger.log(`${PR} no previously completed consumers`),void(this.cachedMarkedConsumers=[]);try{this.cachedMarkedConsumers=JSON.parse(t)}catch(e){LR(this.logger,"failed to parse initial completed consumers value")}this.logger.log(`${PR} previously completed consumers: ${null===(e=this.cachedMarkedConsumers)||void 0===e?void 0:e.join(", ")}`)}}const $R="tmp.localMigratedSettings",WR=1e3;class BR{constructor(e,t,i,n,a,s){var o,r;this.coreSettings=e,this.scenarioFactory=a,this.timerPreviouslySet=!1,this.host=i,this.hostCommunicationService=n,this.logger=s.newLogger("LocalMigratedSettingsService","core-services-local-migrated-settings"),this.localMigratedSettings=e.get(S.J.LocalMigrated),this.completedConsumers=new UR(t,this.logger),this.scenario=a.newScenario(z.RG.LocalSettingsMigration,{timeoutMs:9e5});const c=Object.keys(this.localMigratedSettings);null===(r=(o=this.logger).infoToTelemetry)||void 0===r||r.call(o,`${PR} initialized migrated settings with ${c.length} keys: ${c.join(", ")}`,"webclient_framework_infrastructure_local_migrated_settings",void 0,!0);const l=function(e){if(!e.reservedMetadata)return;const t=e.reservedMetadata,i={};t.correalationId&&(i.migratedSettingsCorrelationId=t.correalationId);t.version&&(i.migratedSettingsSchemaVersion=t.version);t.reason&&(i.migrationReason=t.reason);t.created&&(i.migratedSettingsAgeSeconds=function(e){const t=new Date(e);if(isNaN(t.getTime()))return-1;const i=new Date;return Math.ceil((i.getTime()-t.getTime())/WR)}(t.created));return Object.keys(i).length>0?i:void 0}(this.localMigratedSettings);l&&this.scenario.appendEventData(l)}startTimer(){var e,t,i,n,a,s,o,r;if(this.timerPreviouslySet)return void(null===(t=(e=this.logger).logNoPii)||void 0===t||t.call(e,`${PR} Will not start timer again as it was previously started.`));if(this.completedConsumers.areAllMarked())return void(null===(n=(i=this.logger).logNoPii)||void 0===n||n.call(i,`${PR} Will not start timer again as all consumers have completed.`));this.timerPreviouslySet=!0;const c=zR(this.coreSettings);null===(s=(a=this.logger).logNoPii)||void 0===s||s.call(a,`${PR} Starting migration timer with timeout ${c}ms`),this.timer=this.host.setTimeout((()=>this.reportMigrationCompletion(!0)),c),null===(r=(o=this.scenarioFactory).changeTimeout)||void 0===r||r.call(o,this.scenario,c+3e4)}registerConsumer(e,t){return this.notifyConsumer(e,t),{unregister:()=>{}}}nothingToMigrate(){return 0===Object.keys(this.localMigratedSettings).length}notifyConsumer(e,t){var i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.nothingToMigrate()){if(this.completedConsumers.isMarked(e))null===(a=(i=this.logger).infoToTelemetry)||void 0===a||a.call(i,`${PR} Skipping previously migrated consumer ${e}.`,"webclient_framework_infrastructure_local_migrated_settings",void 0,!0);else{this.scenario.mark(z.ck.LocalSettingsMigrationStepConsumerStarted,{consumer:e});try{yield t(this.localMigratedSettings)}catch(t){return LR(this.logger,`handler for ${e} failed.`),void this.scenario.mark(z.ck.LocalSettingsMigrationStepConsumerCompleted,{consumer:e,consumerStatus:"Failed"})}this.scenario.mark(z.ck.LocalSettingsMigrationStepConsumerCompleted,{consumer:e,consumerStatus:"Completed"}),this.completedConsumers.mark(e)}this.completedConsumers.areAllMarked()&&(yield this.reportMigrationCompletion())}}))}reportMigrationCompletion(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{reportLocalMigratedSettingsCompletionToDesktop:t}=this.coreSettings.get(S.J.Core,["reportLocalMigratedSettingsCompletionToDesktop"]);if(this.timer&&this.host.clearTimeout(this.timer),this.timer=void 0,e?this.logger.log(`${PR} Migration timed out. Incomplete consumers: ${this.completedConsumers.getUnmarked().join(", ")}.`):this.logger.log(`${PR} Migration completed successfully.`),this.host.localStorage.getItem($R))try{this.host.localStorage.removeItem($R)}catch(e){return void this.scenario.fail({reason:"FailedRemoveMigratedSettingsFromLocalStorage",incompleteConsumers:this.completedConsumers.getUnmarked()})}if(t){let e;try{e=yield this.hostCommunicationService.loadModule("appswitcher")}catch(e){return void this.scenario.fail({reason:"FailedNoAppSwitcherModule",incompleteConsumers:this.completedConsumers.getUnmarked()})}const t=null==e?void 0:e.completeT1LocalSettingsMigration;if(!t)return void this.scenario.fail({reason:"FailedNoCompletionApi",incompleteConsumers:this.completedConsumers.getUnmarked()});try{t()}catch(e){return void this.scenario.fail({reason:"FailedNotifyMigrationCompletion",incompleteConsumers:this.completedConsumers.getUnmarked()})}}e?this.scenario.fail({reason:"TimedOut",incompleteConsumers:this.completedConsumers.getUnmarked()}):this.scenario.stop()}))}}const zR=e=>{const{localMigratedSettingsConsumptionTimeoutInMs:t}=e.get(S.J.Core,["localMigratedSettingsConsumptionTimeoutInMs"]);return null!=t?t:6e4};class HR extends Ue{constructor(){super(h.Yg.CreateLocalMigratedSettingsServiceTask,["clientPreferences","coreSettings","hostCommunicationService","localStorage","loggerFactory","scenarioFactory","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{clientPreferences:t,coreSettings:i,hostCommunicationService:a,localStorage:s,loggerFactory:o,scenarioFactory:r,windowProvider:c}=e,l=o.newLogger("CreateLocalMigratedSettingsServiceTask","core-services-tasks"),{skip:d,reason:u}=function(e){if(function(e){const{disableLocalMigratedSettingsService:t}=e.get(S.J.Core,["disableLocalMigratedSettingsService"]);return!!t}(e))return{skip:!0,reason:"Service is disabled"};if(function(e){const t=e.get(S.J.LocalMigrated);if(!t)return!0;return 0===Object.keys(t).length}(e))return{skip:!0,reason:"Nothing to migrate"};return{skip:!1}}(i);if(d)return void l.log(`Skipping service creation. Reason: ${u}`);const m=function(e,t,i,n,a,s){return new BR(e,t,i,n,a,s)}(i,s,c,a,r,o);!function(e,t,i){e.registerConsumer("client-preferences",(e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const n={};if((0,B.isNil)(e.chatDensity)||(n.density={chatDensity:qR(e.chatDensity)}),(0,B.isNil)(e.messagePreviewShown)||(n.messagePreviews={messagePreviewsSetting:VR(e.messagePreviewShown)}),(0,B.isNil)(e.performanceMode)||(n.animation={disableAnimations:GR(e.performanceMode)}),!(0,B.isNil)(e.cachedImage)){const{imageId:t,path:i,imageSrc:a}=e.cachedImage,s={imageId:t,imagePath:i,imageSrc:a};n.backgroundEffect={lastUsedBackgroundEffect:s},n.videoEffect={lastUsedBackgroundImage:s}}0!==Object.keys(n).length?(i.log(`Updating client preferences to: ${JSON.stringify(n)}`),t.updatePreferences(n)):i.log("No client preferences to update.")}))))}(m,t,l),e.localMigratedSettings=m}))}}const qR=e=>{switch(e){case N.LN.Comfy:return"comfy";case N.LN.Compact:return"compact";default:return"comfy"}},VR=e=>{switch(e){case N.xu.Default:return"default";case N.xu.ShowPreviews:return"showPreviews";case N.xu.HidePreviews:return"hidePreviews";default:return"default"}},GR=e=>e===N.Cz.Low;class JR extends Ue{constructor(){super(h.Yg.CreateAuthStateConnector,["networkState","authStateProvider","coreSettings"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{networkState:t,authStateProvider:i,coreSettings:n}=e,{enableNetworkOnlineDetection:a,disableNetworkDetectionOnResume:s}=n.get(S.J.Core);!s&&a&&t.subscribeAuthStateEvent(i)}))}}class KR extends Ue{constructor(){super(h.Yg.CreateAnonJoinPreflightTask,["windowProvider","coreSettings","authenticationService","scenarioFactory","localStorage"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=e.windowProvider,i=e.coreSettings,n=e.authenticationService,a=e.scenarioFactory,s=e.localStorage,o=a.findScenario(z.RG.AnonJoinPreflightCoreTask)||a.newScenario(z.RG.AnonJoinPreflightCoreTask),{enableT2PreflightForAnonUser:r,enableAnonJoinPreflightCoreTask:c}=i.get(S.J.Calling);if(!c)return void o.stop({reason:"Core task feature flag enableAnonJoinPreflightCoreTask is not enabled"});const l=new URL(t.location.href),d=new URLSearchParams(l.hash).get("deeplinkId");if(!d)return void o.stop({reason:"No deeplinkId found"});const u=yield n.getUser();if(u&&u.role!==zo.w4.Anonymous){if("true"===s.get("isOptedIntoT2Web","Global"))return void o.stop({reason:"Auth user opted into T2"});this.attemptToRedirectToT1Web(t,l,d,o,!1)}r?o.stop({reason:"Anon user selected as part of T2 preflight"}):this.attemptToRedirectToT1Web(t,l,d,o)}))}attemptToRedirectToT1Web(e,t,i,n,a=!0){const s=["clearcontainer","container","version"];for(const e of s)if(t.searchParams.has(e))return void n.stop({reason:`URL contains noRedirectQSPs ${e}, and skipping redirect to T1 web`});t.pathname="/_",t.searchParams.delete("meetingjoin"),n.appendEventData({deeplinkId:i}),n.stop({reason:`Redirecting to T1 web with isAnon=${a}`}),e.location.replace(t.href)}}class QR extends Ue{constructor(){super(h.Yg.ClearHostSettingsTask,["loggerFactory"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t}=e,i=t.newLogger("ClearHostSettingsTask","core-services-tasks");e.hostSettings=void 0,i.log("ClearHostSettingsTask: Host settings cleared from task init context.")}))}}class YR extends Ue{constructor(){super(h.Yg.CreateHostedWindowContext,["hostedWindowContext","hostSettings"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{hostedWindowContext:t,hostSettings:i}=e,n=i.hostSettings;n&&(t.sessionStartTime=n.createdTime,t.localeCode=n.localeCode,t.ring=n.hostRingId),"general_gcc"===t.ring&&(null==n?void 0:n.enableDevTools)&&(t.ring="ring0_gcc")}))}}class XR extends Ue{constructor(){super(h.Yg.EmbedExitEarlyIfPreAuthOnlyTask,["config","hostCommunicationService","scenarioFactory","loggerFactory","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{config:t,hostCommunicationService:i,scenarioFactory:n,loggerFactory:a,windowProvider:s}=e;if(!t.preInitAuth)return Promise.resolve();const o=n.newScenario(z.RG.EmbedPreAuth,{startTime:t.preInitAuthStartTime}),r=(0,qe.v4)();s.localStorage.setItem("embed-pre-auth-correlation-id",r),s.localStorage.setItem("embed-pre-auth-timestamp",Date.now().toString()),o.appendEventData({secondaryCorrelationId:r});const c=yield i.loadModule("core"),l=yield(0,Hi.G)();return new Promise((e=>{if(!c||!c.registerForOnContinueWithTeamsCoreTasks||!c.signalPreAuthComplete){const e="Failed to load coreModule in EmbedExitEarlyIfPreAuthOnlyTask to signal preauth complete.";throw o.stop({message:e}),new Error(e)}c.registerForOnContinueWithTeamsCoreTasks((({reason:t})=>{a.newLogger("EmbedExitEarlyIfPreAuthOnlyTask","core-services-tasks").log(`Continue with core tasks because: ${t}`),e()})),o.stop();const t=s.setTimeout((()=>{l.flush(!0).finally((()=>{var e;null===(e=null==c?void 0:c.signalPreAuthComplete)||void 0===e||e.call(c)})),s.clearTimeout(t)}),1e3)}))}))}}class ZR extends Ue{constructor(){super(h.Yg.FetchHostSettingsTask,["config","hostedWindowContext","loggerFactory","windowProvider"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{config:t,hostedWindowContext:i,loggerFactory:n,windowProvider:a}=e,{isInCypressFrame:s,isInIframe:o}=i,r=n.newLogger("FetchHostSettingsTask","core-services-tasks");let c={};if(t.shouldFetchBootstrapData&&o&&!s)try{r.log("Hosted in web. Fetching host settings from host over IPC.");const e=yield a.opener.requestMessage(L.rY.GetStateData,{requestType:"hostSettings"});c=Object.assign({},e.hostSettings)}catch(e){r.errorToTelemetry&&r.errorToTelemetry(`Error fetching host settings over IPC ${e}`,"webclient_framework_foundation_core_services_tasks",void 0,!0)}else{r.log("Hosted in desktop. Getting host settings from window object.");const e=window;e.hostSettings&&(r.log("Found window.hostSettings."),c=Object.assign({},e.hostSettings),delete e.hostSettings)}if(!t.allowEmptyHostSettings&&!Object.keys(c).length)throw(0,oe.Tr)(h.w5.Core,h.jK.Undefined,"FetchHostSettingsTask",void 0,"hostSettings are missing in experience that requires them.");r.log("setting context.hostSettings"),e.hostSettings=c}))}}var eL;!function(e){e[e.Unknown=5e4]="Unknown",e[e.GetSingletonStoreFailed=4e4]="GetSingletonStoreFailed",e[e.CreateStoreFailed=40001]="CreateStoreFailed",e[e.ActionNotSupported=40002]="ActionNotSupported"}(eL||(eL={}));var tL=i(281304),iL=i(334134),nL=i(296160);const aL={code:eL.CreateStoreFailed,message:"Store is not available"};function sL(e){return new oL(e)}class oL extends Ti.y{constructor(e){const t=e?rL(e):(0,tL._)(aL);super((e=>t.subscribe(e))),this._dispatcher=e?Promise.resolve(e):Promise.reject(aL)}dispatch(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(yield this._dispatcher).dispatch(e)}))}}const rL=e=>(0,c.D)(Promise.resolve(e)).pipe((0,Dt.w)((e=>new Ti.y((t=>e.subscribe((e=>t.next(e))))))),(0,iL._)(1),(0,nL.x)());class cL extends Ti.y{constructor(e,t){const i=t.pipe((0,l.U)((t=>{var i;return null===(i=null==t?void 0:t.windows[e])||void 0===i?void 0:i.lifecycle})),(0,er.x)(B.isEqual),(0,u.h)((e=>void 0!==e)),(0,wi.o)((e=>void 0===e.closedTime),!0));super((e=>i.subscribe(e))),this._id=e,this._dispatcher=t}pushWltMarks(e){return this._dispatcher.dispatch({type:"RECORD_WINDOW_LIFECYCLE_MARKS",windowId:this._id,markers:e})}}var lL=i(522498),dL=i(762886);class uL{constructor(e,t,i){if(this.exitFullscreen=e=>this._observableStore.dispatch((e=>({type:"SET_FULLSCREEN",windowId:e,fullscreen:!1}))(e)),this.focus=e=>this._observableStore.dispatch((e=>({type:"FOCUS_WINDOW",windowId:e}))(e)),this.maximize=e=>this._observableStore.dispatch((e=>({type:"TOGGLE_MAXIMIZE_WINDOW",windowId:e}))(e)),this.minimize=e=>this._observableStore.dispatch((e=>({type:"MINIMIZE_WINDOW",windowId:e}))(e)),this.requestFullscreen=e=>this._observableStore.dispatch((e=>({type:"SET_FULLSCREEN",windowId:e,fullscreen:!0}))(e)),this.show=e=>this._observableStore.dispatch((e=>({type:"SHOW_WINDOW",windowId:e}))(e)),this.windowTitleDblClick=e=>this._observableStore.dispatch((e=>({type:"INVOKE_DOUBLE_CLICK",windowId:e}))(e)),e.createInterprocessStore){const n=e.createInterprocessStore({logDebug:(...e)=>t.debug(...e),logError:(...e)=>t.error(...e),logInfo:(...e)=>t.log(...e),logScenario:e=>{i.newScenario(e.name).stop(void 0,e.status)}});this._observableStore=sL(n)}else this._observableStore=sL(null)}onWindowFullscreen(e){return this._observableStore.pipe((0,lL.j)("windows",e),(0,dL.n)((e=>void 0===e)),(0,wi.o)((e=>{var t;return void 0===(null===(t=e.lifecycle)||void 0===t?void 0:t.closedTime)})),(0,lL.j)("layout","fullscreen"),(0,er.x)())}onLifecycleMarks(e){return new cL(e,this._observableStore)}}class mL extends Ue{constructor(){super(h.Yg.InitInterprocessStore,["windowProvider","loggerFactory","scenarioFactory","coreSettings"])}execute(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:i,scenarioFactory:n,coreSettings:a}=e;a.get(S.J.Core).disableInterprocessStore||(e.interprocessStoreService=new uL(t,i.newLogger("InterProcessStore","core-services-tasks"),n)),delete t.createInterprocessStore}))}}class gL extends Ue{constructor(){super(h.Yg.Polyfills,[])}execute(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.applyAsyncIteratorPolyfillIfNeeded()}))}applyAsyncIteratorPolyfillIfNeeded(){void 0===Symbol.asyncIterator&&(Symbol.asyncIterator=Symbol.asyncIterator||i(212673).$$asyncIterator)}}class hL{constructor(e){this.logsProviderTimeoutMs=2e4,this.coreProviders=[],this.userProviders={},this.primaryUserID="",this.allowZipLogFiles=!1,this.environmentName="",this.isDownloadLogStarted=new s.X(!1),this.observeDownloadLogStatus=()=>this.isDownloadLogStarted.asObservable(),this.setDownloadLogStatus=e=>{this.isDownloadLogStarted.next(e)},this.logger=e.newLogger("LogsCollectorService","core-services-logs-collector")}subscribeToCoreSettings(e){if(!e)return void this.logger.error("Failed to subscribe to core settings");e.getObservable(S.J.Diagnostics,["logsProviderTimeoutMs","shouldZipLogFiles"]).subscribe((({logsProviderTimeoutMs:e,shouldZipLogFiles:t})=>{e&&(this.logsProviderTimeoutMs=e),this.allowZipLogFiles=!!t}));e.getObservable(S.J.Metadata,["environment"]).subscribe((({environment:e})=>{e&&(this.environmentName=e)}))}registerCoreLogsProvider(e){var t,i;e.logsProviderName===T.DIAGNOSTICSSERVICE?this.diagnosticsLogProvider=e:this.coreProviders.some((t=>t.logsProviderName===e.logsProviderName))?null===(i=(t=this.logger).warnNoPii)||void 0===i||i.call(t,`Registering redundant core logger with name ${e.logsProviderName}`):this.coreProviders.push(e)}registerUserLogsProvider(e,t){var i,n;this.primaryUserID&&!e&&(e=this.primaryUserID),this.userProviders[e]?this.userProviders[e].some((e=>e.logsProviderName===t.logsProviderName))?null===(n=(i=this.logger).warnNoPii)||void 0===n||n.call(i,`Registering redundant user logger with name ${t.logsProviderName}`):this.userProviders[e].push(t):this.userProviders[e]=[t]}unregisterUserLogsProvider(e,t){var i,n;this.primaryUserID&&!e&&(e=this.primaryUserID),this.userProviders[e]?(this.userProviders[e]=this.userProviders[e].filter((e=>e.logsProviderName!==t)),0===this.userProviders[e].length&&delete this.userProviders[e]):null===(n=(i=this.logger).warnNoPii)||void 0===n||n.call(i,`Unregistering user logger with name ${t} failed, user ${e} not found`)}getCoreLogsProvider(e){return this.coreProviders.find((t=>t.logsProviderName===e))}getUserLogsProvider(e,t){var i;return null===(i=this.userProviders[e])||void 0===i?void 0:i.find((e=>e.logsProviderName===t))}handleUserLogout(e){delete this.userProviders[e]}callOnLogsFiles(e,t=!1,i=!1,a=0){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.callOnUserLogsFiles(Object.keys(this.userProviders),e,t,i,a)}))}callOnUserLogsFiles(e,t,a=!1,s=!1,o=0){var r,c,l;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n;if(a&&this.allowZipLogFiles)try{const e=null===(r=yield i.e(981578).then(i.t.bind(i,232020,23)))||void 0===r?void 0:r.default;e&&(n=new e)}catch(e){null===(l=(c=this.logger).errorToTelemetry)||void 0===l||l.call(c,`Load jszip failed - ${e}`,"logs_loading_jszip")}const d={fileName:"summary.txt",content:"",isPiiFree:!0},u=e=>(null==n?void 0:n.file)?(n.file(e.fileName,e.content),Promise.resolve(!0)):(e.fileName=`WebLogs/${e.fileName}`,t(e)),m=yield this.callOnOnlyCoreLogsFiles(u,d,s,o),g=yield this.callOnOnlyUserLogsFiles(e,u,d,s,o),h=yield this.createSummaryFile(u,d);if(n){const e=yield n.generateAsync({type:"blob",compression:"DEFLATE"}),i=this.environmentName?`${this.environmentName.toUpperCase()}-`:"";return t({fileName:`${i}WebLogs-${(new Date).toISOString()}.zip`,content:e,isPiiFree:!0})}return m&&g&&h}))}getSystemInfo(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let e=new Map;try{const t=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){try{return yield(0,H.E)(e.getSystemInfo(),this.logsProviderTimeoutMs)}catch(t){if((0,H.T)(t))return this.logger.error(`Timed out fetching system info from logs provider - ${e.logsProviderName}`),new Map;throw t}})),i=this.coreProviders.map(t);this.diagnosticsLogProvider&&i.push(t(this.diagnosticsLogProvider));const a=yield Promise.all(i);a&&a.length>0&&(e=a.reduce(((e,t)=>new Map([...Array.from(e.entries()),...Array.from(t.entries())]))))}catch(e){this.logger.error("Fetching system info from logs providers failed with error:",e)}return e}))}setPrimaryUserID(e){if(e&&!this.primaryUserID){this.primaryUserID=e;const t=this.userProviders[""];t&&(this.userProviders[this.primaryUserID]=t,delete this.userProviders[""])}}setGetSummaryFunction(e){this.generateSummary=e}getUserLogFileName(e,t){return`User (${e===this.primaryUserID?"Primary; ":""}${e})/${t}`}getCoreLogFileName(e){return`Core/${e}`}callOnOnlyCoreLogsFiles(e,t,i=!1,a=0){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const n=t=>(t.fileName=t.userId?this.getUserLogFileName(t.userId,t.fileName):this.getCoreLogFileName(t.fileName),e(t));this.logger.log(`Fetching files from providers: ${this.coreProviders.reduce(((e,t)=>e+`${null==t?void 0:t.logsProviderName}, `),"")}`);const s=yield this.callOnLogsFilesOfLogsProviders(this.coreProviders,n,t,i,a),o=!this.diagnosticsLogProvider||(yield this.callOnLogsFilesOfLogsProviders([this.diagnosticsLogProvider],n,t,i,a));return s&&o}catch(e){return this.logger.error("Error calling callback on logs files from all logs providers - error:",e),!1}}))}callOnOnlyUserLogsFiles(e,t,i,a=!1,s=0){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=[];return e.length>0&&e.forEach((e=>{if(this.userProviders[e]&&this.userProviders[e].length>0){const o=i=>(i.fileName=this.getUserLogFileName(e,i.fileName),t(i));n.push(this.callOnLogsFilesOfLogsProviders(this.userProviders[e],o,i,a,s))}})),(yield Promise.all(n)).every(Boolean)}))}timeoutSafeGetLogsFiles(e,t=!1,i=0){var a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{return yield(0,H.E)(e.getLogsFiles(t,i),this.logsProviderTimeoutMs)}catch(t){if((0,H.T)(t))return null===(s=(a=this.logger).errorToTelemetry)||void 0===s||s.call(a,`Timed out fetching logs files from logs provider - ${e.logsProviderName}`,"logs_fetching_error"),[];throw t}}))}callOnLogsFilesOfLogsProviders(e,t,i,a=!1,s=0){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.map((e=>this.timeoutSafeGetLogsFiles(e,a,s))),o=yield Promise.all(n),r=[];o.forEach((e=>{e&&e.length>0&&r.push(...e)}));const c=r.map((e=>{try{return"latestErrors"===e.fileName?(i.content=`${i.content}${e.content}\r\n`,Promise.resolve(!0)):t(e)}catch(t){return this.logger.error(`Error calling callback on logs file, ${null==e?void 0:e.fileName} - error:`,t),!1}}));return(yield Promise.all(c)).every((e=>e))}))}createSummaryFile(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield null===(i=this.generateSummary)||void 0===i?void 0:i.call(this);return n&&(t.content=`${n}\r\n${t.content}`),e(t)}))}}var pL=i(328283);class vL{constructor(e,t){this.coreTaskManager=e,this.userRenderingContextMap=new Map,this.logger=t.newLogger("RenderingContextManager","core-services-activator")}cleanupWithPriority(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.defaultRenderingContext)return Promise.reject(new ze.G(ze.$.RENDERING_CONTEXT_DOES_NOT_EXIST));const t=this.userRenderingContextMap.keys(),i=Array.from(t).map((t=>()=>this.cleanupActiveWindowsHistoryService(e,t)));yield kL(i,this.defaultRenderingContext)}))}createCoreServices(){var e,t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("createCoreServices: start");const i=yield this.coreTaskManager.notifyLifeCycleEvent(h.sM.Initialization),{coreTaskErrors:a}=i,s=(0,n.__rest)(i,["coreTaskErrors"]);this.defaultRenderingContext=s,this.logger.log("createCoreServices: done");const o=s&&Object.keys(s).sort(),r=`createCoreServices: ${(0,U.u4)(o)}`;return null===(t=(e=this.logger).infoToTelemetry)||void 0===t||t.call(e,r,"webclient_framework_foundation_core_init",void 0,!0),Object.assign(Object.assign({},s),{error:yL(a,s,this.logger)})}))}executePrimaryUserTasks(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.defaultRenderingContext)return Promise.reject(new ze.G(ze.$.RENDERING_CONTEXT_DOES_NOT_EXIST));const t=(0,He.b4)(e);this.logger.log(`executePrimaryUserTasks(${t}): start`);const i=yield this.coreTaskManager.notifyLifeCycleEvent(h.sM.OnPrimaryUser,Object.assign(Object.assign({},this.defaultRenderingContext),{primaryUser:e,authenticationUser:e})),{coreTaskErrors:a}=i,s=(0,n.__rest)(i,["coreTaskErrors"]),o=yL(a,this.defaultRenderingContext,this.logger);if(delete s.authenticationUser,this.primaryUserContext=s,o)throw o;return this.logger.log(`executePrimaryUserTasks(${t}): done`),this.primaryUserContext}))}removeAllRenderingContexts(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.defaultRenderingContext)return Promise.reject(new ze.G(ze.$.RENDERING_CONTEXT_DOES_NOT_EXIST));const t=this.userRenderingContextMap.keys(),i=Array.from(t).map((t=>()=>this.removeUserRenderingContext(e,t)));yield kL(i,this.defaultRenderingContext),this.primaryUserContext&&(yield this.coreTaskManager.destroyContext(this.primaryUserContext,e)),yield this.coreTaskManager.destroyContext(this.defaultRenderingContext,e)}))}getUserRenderingContext(e){return this.userRenderingContextMap.get(e)}getDefaultRenderingContext(){return this.defaultRenderingContext}getOrCreateUserRenderingContext(e){const t=(0,He.b4)(e);return this.defaultRenderingContext?(this.userRenderingContextMap.get(t)||this.userRenderingContextMap.set(t,this.createUserContextWithTelemetry(e,this.defaultRenderingContext)),this.userRenderingContextMap.get(t)):Promise.reject(new ze.G(ze.$.RENDERING_CONTEXT_DOES_NOT_EXIST,void 0,t))}removeUserRenderingContext(e,t){var i,a,s,o,r,c;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=this.userRenderingContextMap.get(t);if(n){let l;"unknown_destroy"===e&&(null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,"Removing user context due to unknown.","webclient_framework_foundation_core_services",void 0,!0)),this.userRenderingContextMap.delete(t);try{l=yield n}catch(e){let t;return t=e instanceof Re.G&&Re.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():e&&`${e.name}::${e.message}`,null===(o=(s=this.logger).errorToTelemetry)||void 0===o||o.call(s,`${ze.$.CLEANUP}::contextPromise::${t}`,"webclient_framework_foundation_core_services",void 0,!0),!1}return e="unknown_destroy"===e?"signout":e,yield this.cleanupUserRenderingContext(l,e),(null===(c=null===(r=this.primaryUserContext)||void 0===r?void 0:r.primaryUser)||void 0===c?void 0:c.id)===t&&(yield this.cleanupPrimaryUserContext(e)),!0}return this.logger.warn("RenderingContextManager::contextPromise is not defined"),!1}))}createUserContextWithTelemetry(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{scenarioFactory:n}=t,a=!!(null===(i=t.coreSettings.get(S.J.Core))||void 0===i?void 0:i.enableMTMA),s=n.findScenario(z.RG.GetAuthUser),[o,r]=ut(n);null==o||o.mark(z.ck.CoreUserContextStart);const c=Date.now(),l=(0,He.b4)(e);try{const t=yield this.createUserRenderingContext(e,a);return this.reportUserContextSuccess({getUserAuthScenario:s,expReadyScenario:r,clientStartScenario:o,scenarioStartTime:c,userContextId:l,isMTMAEnabled:a,scenarioFactory:t.scenarioFactory}),t}catch(e){const i=mt(e,l);throw this.reportUserContextFailure({getUserAuthScenario:s,expReadyScenario:r,scenarioStartTime:c,error:i,userContextId:l,isMTMAEnabled:a,scenarioFactory:t.scenarioFactory}),i}}))}reportUserContextSuccess({getUserAuthScenario:e,expReadyScenario:t,clientStartScenario:i,scenarioStartTime:n,userContextId:a,isMTMAEnabled:s,scenarioFactory:o}){var r;e&&e.stop(),null==t||t.mark(z.ck.GetAuthUser),null==i||i.mark(z.ck.CoreUserContextStop),fL(o,a,n,null===(r=this.defaultRenderingContext)||void 0===r?void 0:r.windowProvider.performance,s).stop(void 0,"success")}reportUserContextFailure({getUserAuthScenario:e,expReadyScenario:t,scenarioStartTime:i,error:n,userContextId:a,isMTMAEnabled:s,scenarioFactory:o}){var r,c;e&&e.fail(),null==t||t.mark(z.ck.GetAuthUser,void 0,"failure"),fL(o,a,i,null===(r=this.defaultRenderingContext)||void 0===r?void 0:r.windowProvider.performance,s).fail(Object.assign({message:`Failed to create user context for ${a}`},ht(n,null===(c=this.defaultRenderingContext)||void 0===c?void 0:c.coreSettings)))}cleanupActiveWindowsHistoryService(e,t){var i,a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n;try{n=yield this.getUserRenderingContext(t)}catch(e){return}try{null===(i=null==n?void 0:n.activeWindowsHistoryService)||void 0===i||i.cleanup(e)}catch(e){const t=new ze.G(ze.$.CLEANUP,e);null===(s=(a=this.logger).errorToTelemetry)||void 0===s||s.call(a,t.toTelemetryEntry(),"webclient_framework_foundation_core_services_active_windows_history",void 0,!0)}}))}cleanupUserRenderingContext(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return yield this.coreTaskManager.destroyContext(e,t),!0}))}cleanupPrimaryUserContext(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.logger.log("Cleaning up primary user context..."),yield this.coreTaskManager.destroyContext(this.primaryUserContext,e),!0}))}createUserRenderingContext(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=(0,He.b4)(e);this.logger.log(`createUserContext(${i}): start`);const a=t?h.sM.OnUserAuthenticated_MTMA:h.sM.OnUserAuthenticated,s=yield this.coreTaskManager.notifyLifeCycleEvent(a,Object.assign(Object.assign({},this.defaultRenderingContext),{authenticationUser:e}),((e,t)=>{var n,s;return(null===(n=this.defaultRenderingContext)||void 0===n?void 0:n.windowProvider.performance)&&function(e,t,i,n,a){const s=a?ht(a):void 0;i.mark(bL(n,t),{detail:{taskId:h.Yg[e],errorCode:null==s?void 0:s.errorCode}})}(e,i,null===(s=this.defaultRenderingContext)||void 0===s?void 0:s.windowProvider.performance,h.sM[a],t)})),{coreTaskErrors:o}=s,r=(0,n.__rest)(s,["coreTaskErrors"]),c=yL(o,this.defaultRenderingContext,this.logger);if(c)throw c;return this.logger.log(`createUserContext(${i}): done`),r}))}}function fL(e,t,i,n,a=!1){const s=e.createScenarioWithoutStarting(z.RG.CoreUserContextCreate,{startTime:i}),o=a?h.sM.OnUserAuthenticated_MTMA:h.sM.OnUserAuthenticated;return n&&function(e,t,i,n){const a=n.timeOrigin,s=n.getEntriesByName(t,"mark")||[];for(const t of s){const n=t.detail.taskId,s=t.detail.errorCode;e.mark(`${i}_${n}`,{overrideTimestamp:Math.round(t.startTime+a),errorCode:s})}n.clearMarks(t)}(s,bL(o,t),`core_task_${o}`,n),s}function bL(e,t){return`${e}_core_task_end_${t||""}`}function yL(e,t,i){let n;if(e&&(null==e?void 0:e.length)>0)if(null==t?void 0:t.coreSettings.get(S.J.Core).strictErrorMode)n=e[0];else{const t=e.filter((e=>e instanceof Le));t.length>0&&t.forEach((e=>{var t;null===(t=i.errorToTelemetry)||void 0===t||t.call(i,e.toTelemetryEntry(),"webclient_framework_foundation_core_services",void 0,!0)})),n=e.find((e=>e instanceof ze.G||e instanceof Sl.l||e instanceof Le&&(e.prevError instanceof ze.G||e.prevError instanceof Sl.l)))}return n}function kL(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(null===(i=null==t?void 0:t.coreSettings.get(S.J.Core))||void 0===i?void 0:i.readInSequence)for(const t of e)yield t();else yield Promise.all(e.map((e=>e())))}))}const SL="authenticated_user_subscription_failed",wL="create_user_context_failed",jL="init_core_service_failure",CL="show_taskbar_caution_indicator_failed",_L="user_data_undefined",TL="user_renderingContext_generation_error",IL=(e,t,i)=>{e.errorToTelemetry&&e.errorToTelemetry(t,i,void 0,!0)};class NL{constructor(e){var t,i,c,d,u,m;this._activeWindows=new s.X([]),this._contextSubject=new o.t(1),this._isCleanupRunning=!1,this.AppStateToCleanupReasonMap=new Map([[p.G5.quit,"quit"],[p.G5.restart,"restart"]]),this.cleanupOnAppStateChangedCallback=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const{appState:t}=e;if(!wt.has(t))return;if(this._isCleanupRunning){const e=new ze.G(ze.$.CLEANUP,new Error(`cleanupOnAppStateChangedCallback run more than once ${t}`));return void(this._logger.warnToTelemetry&&this._logger.warnToTelemetry(e.toTelemetryEntry(),"webclient_framework_foundation_core_services",void 0,!0))}this._isCleanupRunning=!0;const i=this.AppStateToCleanupReasonMap.get(t);if(!i){const e=new ze.G(ze.$.CLEANUP,new Error(`cleanupOnAppStateChangedCallback has undefined reason from ${t}`));throw IL(this._logger,e.toTelemetryEntry(),"webclient_framework_foundation_core_services"),e}yield jt({hostCommunicationService:this.coreServices.hostCommunicationService,logger:this._logger,reason:i,renderingContextManager:this._renderingContextManager})})),this.trackAuthUsers=e=>{const t=this.isMTMACoreEnabled(e.coreSettings);return(0,r.z)((0,l.U)((e=>t?e:e.slice(0,1))),(0,l.U)((e=>e.map((e=>Object.assign(Object.assign({},e),{id:(0,He.b4)(e)}))))),de((e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.onUserAuthenticated(e)}))),(e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.onUserDestroy(yield e)}))),((e,t)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return t}))),((e,i)=>{if(!t)throw i})))};const g=(0,R.J)(),h=(null==g?void 0:g.defaultConsoleLogLevel)||(null===(i=null===(t=null==g?void 0:g.loader)||void 0===t?void 0:t.getInitConsoleLogLevel)||void 0===i?void 0:i.call(t)),v=null===(d=null===(c=null==g?void 0:g.loader)||void 0===c?void 0:c.getProperties)||void 0===d?void 0:d.call(c),f=new K((null==v?void 0:v.sessionId)||"",e.config.experienceName,a.DiagnosticsLogsMain,null==h?void 0:h.preECSConsoleLogLevel,null==h?void 0:h.userConsoleLogLevel),b=new Y(g);f.setLogsCountReporter(b);const y=new ae(f,"00000000-0000-0000-0000-000000000000");this._config=e.config;const k=new Oe(y,this._config,e.apps);this._logger=y.newLogger("Core","core-services-activator");const S=new hL(y);let w;v&&v.isMaglev&&v.preCoreHostCommService&&(w=v.preCoreHostCommService),this._preCoreLogsFileService=new pL.N(y,S,void 0,w),g.addEventListener("downloadLogs",(()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){yield this._preCoreLogsFileService.downloadLogsFiles(g)})))),S.registerCoreLogsProvider(f);const j=null===(m=null===(u=null==g?void 0:g.loader)||void 0===u?void 0:u.getLogsProvider)||void 0===m?void 0:m.call(u);j&&S.registerCoreLogsProvider(j),v&&v.isMaglev&&v.preCoreHostCommService&&this.registerForLogsDownloadSignalFromDesktop(g,v.preCoreHostCommService);const C=e.config.useReactWebClientCoreTasks?{Initialization:()=>[new bm,new fA,new BM,new DR,new rA,new sA,new VD,new kE,new jm,new Hh,new MR,new qM,new sR,new Tg,new ZF,new IP,new SE,new wx,new CP,new tR,new RF,new bx,new uA,new pA,new sF,new Zl,new xr,new cR,new _P,new TR,new ip,new tA,new HR,new FF,new CF,new zl,new KR,new eP,new wE,new PF,new Xl,new TP,new vE,new fm,new gm,new Du,new HM,new gg,new tx,new zD,new vN,new iA,new kA,new _m,new Cm,new cF,new Gh,new hE,new rF,new hg,new wF,new Jh,new dP,new cP,new CD,new oR,new pR,new ed,new ZD,new Sx,new kx,new wR,new wP],OnPrimaryUser:()=>[new uR,new dR,new oM,new lR,new OP,new uP,new rR],OnUserAuthenticated:()=>[new uR,new oM,new Tl,new XM,new Jl,new xD,new vo,new nd,new kR,new fR,new Au,new AP,new $M,new JM,new Ho,new lA,new hR,new zM,new PP,new hg,new Qo,new aR,new Mr,new VM,new yP,new vR,new yR],OnUserAuthenticated_MTMA:()=>[new uR,new rM,new oM,new xD,new vo,new qh,new Tl,new JR,new PF,new Xl,new sF,new Jl,new bR,new kR,new zM,new PP,new nd,new mm,new Mr,new yP,new SA,new kA,new _m,new Gh,new rF,new hg,new XM,new Au,new AP,new $M,new JM,new Ho,new lA,new hR,new Qo,new aR,new VM,new vR,new yR]}:{Initialization:()=>[new gL,new bm,new fA,new BM,new rA,new sA,new ZR,new YR,new VD,new kE,new jm,new Hh,new TR,new sR,new Tg,new ZF,new SE,new wx,new tR,new bx,new uA,new sF,new Zl,new xr,new QR,new tA,new FF,new CF,new zl,new XR,new eP,new wE,new PF,new Xl,new TP,new vE,new fm,new gm,new Du,new gg,new tx,new zD,new vN,new kA,new _m,new Cm,new cF,new hE,new rF,new Jh,new CD,new wF,new mL,new ed,new ZD,new Sx,new wP],OnUserAuthenticated:()=>[new uR,new oM,new lR,new OP,new zM,new PP,new Tl,new XM,new xD,new nd,new fR,new Au,new AP,new JM,new hR,new aR,new yR]};this._taskManagerService=new vt(y,k,e.config,e.loadConfigs,this.getDefaultCorrelation(),C,f,S,this.waitForRenderingContextReady.bind(this),this.isEntityInView.bind(this),e.criticalDynamicImports,e.getPlatformConfigurationOverrides),this._templateGenerator=e.generateChildWindowTemplate,this._trackWindowsOperator=to,this._renderingContextManager=new vL(this._taskManagerService,y)}get activeWindows(){return this._activeWindows}init(){var e,t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield this.initializeCoreServices();!function(e){const{coreSettings:t,logsCollectorService:i}=e,{testAutomation:n}=t.get(S.J.Test);if(n){const e=window;e.WeakRef&&(e.hooks||(e.hooks={}),e.hooks.__TEST_ONLY_LOGS_COLLECTOR_SERVICE_REF=new e.WeakRef(i))}}(i),this._config.supportsAsyncUserContext||(yield this.awaitUserContextIfAvailable()),this.signalCoreInitSuccess(i);const n={logger:this._logger,renderingContextManager:this._renderingContextManager};null===(t=null===(e=i.authenticationService)||void 0===e?void 0:e.registerCleanUpOnLogoutCallback)||void 0===t||t.call(e,k.D.Core,(e=>Ct(Object.assign(Object.assign({},n),{coreSettings:i.coreSettings,reason:"signout",user:e&&(0,He.KQ)(e)})))),this.registerForAppStateChanged(i.hostCommunicationService)}catch(e){throw this.reportCoreInitError(e,this._coreServices),e}}))}get coreServices(){if(!this._coreServices)throw(0,oe.Tr)("Entry",h.jK.NotPresent,"CoreServices not available");return this._coreServices}getDefaultCorrelation(){const e=tt({source:k.D.ExternalCommand,externalId:this._config.externalCorrelationId});return e.id=`Core-${e.id}`,e}initializeCoreServices(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield this._renderingContextManager.createCoreServices(),{error:t}=e,i=(0,n.__rest)(e,["error"]);this._coreServices=i,this.initializeKPIs(i.scenarioFactory),t&&this.handleError(t);return this._coreServices.coreSettings.get(S.J.Core).chainObserveUsersAfter1stNavigationCompletes?this.setupNavigationHandling(i).then((()=>{var e;(null===(e=this._coreServices)||void 0===e?void 0:e.coreSettings.get(S.J.Core).enableSkipObserveAuthUsers)||this.observeAuthenticatedUsers(i)})):(this.setupNavigationHandling(i),this.observeAuthenticatedUsers(i)),i}))}signalCoreInitSuccess(e){var t,i,n,a,s,o,r;const[c,l]=ut(e.scenarioFactory);null==l||l.mark(z.ck.InitCoreServicesComplete),null==c||c.mark(z.ck.CoreInitStop),c&&(null===(n=null===(i=null===(t=(0,R.J)())||void 0===t?void 0:t.loader)||void 0===i?void 0:i.stopPieTimer)||void 0===n||n.call(i)),this._logger.log("hostComms::setCoreInitialized"),e.hostCommunicationService.loadModule("core").then((e=>{var t;null===(t=null==e?void 0:e.setCoreInitialized)||void 0===t||t.call(e)})),this.markCoreInitCompleteInAltScenario(e.altScenarioService);const d=Date.now();e.telemetryService.setCoreInitTime(d),e.logsCollectorService.setGetSummaryFunction(gt(null===(a=this._coreServices)||void 0===a?void 0:a.platformService,null===(s=this._coreServices)||void 0===s?void 0:s.i18n,null===(o=this._coreServices)||void 0===o?void 0:o.authenticationService,null===(r=this._coreServices)||void 0===r?void 0:r.coreSettings))}handleError(e){if(!this.canDisplayCriticalErrorPage(this._coreServices))throw this.reportCoreInitError(e,this._coreServices),e;this.reportCoreInitError(e,this._coreServices,z.ck.CoreInitFailure),this._contextSubject.error(mt(e))}setupNavigationHandling(e){if(!this.canHandleNavigationIntents(e)){const t=e&&Object.keys(e).sort(),i=`Unable to process navigation intents, ${`${(0,U.u4)(t)}`}:: dataClient::${Boolean(null==e?void 0:e.client)}, deeplink::${Boolean(e.deeplinkService)}, entityCommanding::${Boolean(e.entityCommanding)}`;throw(0,oe.Tr)(h.w5.Core,h.jK.CoreNavigationServicesMissing,i)}return e.coreSettings.get(S.J.Core).enableIframeTracking&&(this._trackWindowsOperator=ws),e.activeWindowsService.enableDecoupleCommandingFromApollo?this.observeWindowsWithoutApollo(e).subscribe(this._activeWindows):this.observeWindows(e).subscribe(this._activeWindows),((e,t)=>{const{windowProvider:i,loggerFactory:a,clientState:s,dataClientTrackingService:o,windowTrackerService:r,graphqlOpsCountService:c,leakDetectorService:l}=e,d=a.newLogger("Main-Window-Event-Listeners","core-services-activator");(0,Fs.R)(i.opener,L.rY.ShouldShowChatNotification).pipe((0,xs.M)(t,s.observe())).subscribe((([a])=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{if(!a||!a.payload||!a.payload.convId)throw new Error(`Invalid payload for shouldShowChatNotification with ${JSON.stringify(a)}`);let n=xe.pyR.chats;a.payload.entityType?n=a.payload.entityType:d.log(`null entityType received: ${a.payload.entityType}`),d.log(`Received shouldShowNotification request for conv ${a.payload.convId} with entityType ${n}`);const s=yield ct({action:pe.uk.view,id:a.payload.convId,linkedEntity:null,type:n},e.client,d),o=!lt(s,t,e.clientState,d);Ds(i,o,s),d.log(`Sending windowid: ${s} and shouldShowChatNotification: ${o} for conv ${a.payload.convId}`)}catch(e){d.error(`Failed to query window for entity with error ${e}`),Ds(i,!0,void 0)}})))),null==r||r.init(),(0,Fs.R)(i.opener,L.rY.GetWindowEntityTypeStats).subscribe((()=>{i.opener.postMessage(L.rY.GetWindowEntityTypeStats,{windowEntityTypeStats:null==r?void 0:r.getTelemetry()})})),(0,Fs.R)(i.opener,L.rY.GetApolloCacheStats).subscribe((()=>{i.opener.postMessage(L.rY.GetApolloCacheStats,{apolloCacheStats:null==o?void 0:o.getTelemetry()})})),c&&(0,Fs.R)(i.opener,L.rY.GetCdlStats).subscribe((()=>{i.opener.postMessage(L.rY.GetCdlStats,{cdlStats:null==c?void 0:c.getLatestDataAndClear()})}));(0,Fs.R)(i.opener,L.rY.GetHeartbeat).subscribe((()=>{let t="";e.appResponsivenessService&&(t=e.appResponsivenessService.getTelemetry()),i.opener.postMessage(L.rY.GetHeartbeat,{windowEntityTypeStats:null==r?void 0:r.getTelemetry(),apolloCacheStats:null==o?void 0:o.getTelemetry(),ariTelemetry:t,OLDStats:null==l?void 0:l.getTelemetry()})}))})(e,this.activeWindows),e.deeplinkService.init()}awaitUserContextIfAvailable(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield this._contextSubject.pipe((0,d.P)()).toPromise()}))}initializeKPIs(e){var t,i,n,a,s;if(e){const o=e.findScenario(z.RG.ClientStart),r=null===(n=null===(i=null===(t=(0,R.J)())||void 0===t?void 0:t.loader)||void 0===i?void 0:i.getProperties)||void 0===n?void 0:n.call(i);(null==r?void 0:r.deeplinkId)&&(null==o||o.appendEventData({deeplinkId:r.deeplinkId})),(null==r?void 0:r.RelaunchReason)&&(null==o||o.appendEventData({RelaunchReason:r.RelaunchReason}));const c=null===(a=(0,R.J)())||void 0===a?void 0:a.localStorage.getItem(f.T2WebOptInSessionId);c&&(null==o||o.appendEventData({t2WebOptInSessionId:c}));const l=null===(s=(0,R.J)())||void 0===s?void 0:s.localStorage.getItem(f.AttemptedWebBootCount);l&&(null==o||o.appendEventData({attemptedWebBootCount:l})),null==o||o.mark(z.ck.CoreInitStart)}const o=null==e?void 0:e.findScenario(z.RG.ExperienceReady);null==o||o.mark(z.ck.InitCoreServices),null==o||o.startStep(z.ck.GetAuthUser)}reportCoreInitError(e,t={},i){var a,s,o,r,c,l,d,u,m,g,p,v;const f=e instanceof Re.G?(e=>e.prevError||(0,oe.Tr)(h.w5.Core,h.jK.NotInitialized,e.code,void 0,e.message))(e):e,b=f.context===h.w5.Core?f:(0,oe.Tr)(h.w5.Core,f.code||h.jK.NotInitialized,f.context,{innerError:f}),y=b.subContext||"UnknownCoreInitFailure",k=(0,se.A)((0,oe.B9)(b));this._logger.warn(`Initializing Core failed. Message: ${k}, subContext: ${y}`);const[j,C]=ut(t.scenarioFactory),_={errorCode:e instanceof Re.G&&Re.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():null!==(a=b.code)&&void 0!==a?a:h.jK.CoreInitFailure,reason:h.jK.CoreInitFailure},T=null===(s=(0,R.J)())||void 0===s?void 0:s.loader;i?(null==j||j.mark(i,_),null===(r=null===(o=null==t?void 0:t.altScenarioService)||void 0===o?void 0:o.altScenario)||void 0===r||r.mark(i,_)):(null==j||j.fail(_),null===(l=null===(c=null==t?void 0:t.altScenarioService)||void 0===c?void 0:c.altScenario)||void 0===l||l.fail(_)),j&&(null===(d=null==T?void 0:T.stopPieTimer)||void 0===d||d.call(T)),null===(m=null===(u=this._coreServices)||void 0===u?void 0:u.diagnosticsService)||void 0===m||m.persistDiagnosticsAsPreviousSessionLogs(),null==T||T.persistLoaderLogsAsPreviousSession(),null==C||C.fail({contentType:(0,se.A)(`${b.context}-${b.subContext}`),errorCode:(0,oe.qZ)(b),errors:k,reason:jL}),null===(g=null==t?void 0:t.windowProvider)||void 0===g||g.opener.postMessage(w.W.CoreInitializationFailed,{errorDescription:y}),(null===(v=null===(p=null==t?void 0:t.coreSettings)||void 0===p?void 0:p.get(S.J.Core))||void 0===v?void 0:v.enableTaskbarIconOnCoreInitFailure)&&function(e,t){var i;(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield null==e?void 0:e.loadModule("taskbar");null===(i=null==t?void 0:t.showBadge)||void 0===i||i.call(t,{icon:{glyphBadge:{glyph:I.t.attention}}})}catch(e){IL(t,`${CL}: ${e}`,"webclient_framework_foundation_core_services")}}))}(null==t?void 0:t.hostCommunicationService,this._logger)}markCoreInitCompleteInAltScenario(e){var t,i;null===(t=null===performance||void 0===performance?void 0:performance.mark)||void 0===t||t.call(performance,_),null===(i=null==e?void 0:e.altScenario)||void 0===i||i.mark(z.ck.PostCoreInitializationTasks)}waitForRenderingContextReady(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this.isGettingContextByIdEnabled(null===(i=this._coreServices)||void 0===i?void 0:i.coreSettings)?this.getOrCreateRenderingContextForId(t):this._contextSubject.pipe((0,u.h)((t=>{var i;return!e||!!(null===(i=t.authenticationUser)||void 0===i?void 0:i.isAuthenticated)})),(0,d.P)()).toPromise()}))}getExistingContextForId(e){if(!e){const e=this._renderingContextManager.getDefaultRenderingContext();return e&&Promise.resolve(e)||Promise.reject(new ze.G(ze.$.RENDERING_CONTEXT_DOES_NOT_EXIST))}return this._renderingContextManager.getUserRenderingContext(e)}getContextObservable(e){var t,i;return!this.isGettingContextByIdEnabled(null===(t=this._coreServices)||void 0===t?void 0:t.coreSettings)||this._contextSubject.hasError?this._contextSubject:(0,c.D)(null!==(i=this.getExistingContextForId(e))&&void 0!==i?i:Promise.reject(new ze.G(ze.$.RENDERING_CONTEXT_DOES_NOT_EXIST)))}getOrCreateRenderingContextForId(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.getExistingContextForId(e);if(i)return i;const a=null===(t=this.coreServices)||void 0===t?void 0:t.authenticationService;if(!a)return Promise.reject(new ze.G(ze.$.CORE_SERVICES_MISSING,void 0,e));const s=yield function(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!t)throw new ze.G(ze.$.USERCONTEXTID_EMPTY,void 0,t);const n=yield i.getUser({correlation:e,accountId:t});if(!n)throw new ze.G(ze.$.USER_DOES_NOT_EXIST,void 0,t);if(!n.isAuthenticated)throw new ze.G(ze.$.USER_NOT_AUTHENTICATED,void 0,t);return(0,He.KQ)(n)}))}(Object.assign(Object.assign({},tt({source:k.D.Core})),{scenarioName:z.RG.AuthWebCachedUser}),e,a);return yield this.tryExecutePrimaryUserTasks(),this._renderingContextManager.getOrCreateUserRenderingContext(s)}))}isMTMACoreEnabled(e){var t;return!!(null===(t=null==e?void 0:e.get(S.J.Core))||void 0===t?void 0:t.enableMTMA)&&!!this.isGettingContextByIdEnabled(e)}isGettingContextByIdEnabled(e){var t;return!!(null===(t=null==e?void 0:e.get(S.J.Auth))||void 0===t?void 0:t.enableIntegratedAuthApp)&&!!this._config.supportsAsyncUserContext}tryExecutePrimaryUserTasks(){var e,t,i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this._taskManagerService.hasTasks(h.sM.OnPrimaryUser))return;if(null===(e=this._coreServices)||void 0===e?void 0:e.primaryUser)return;if(this._primaryUserTasksPromise)return this._primaryUserTasksPromise;const n=null===(t=this._coreServices)||void 0===t?void 0:t.authenticationService,s=yield null===(i=null==n?void 0:n.getCachedUsers)||void 0===i?void 0:i.call(n,Object.assign(Object.assign({},tt({source:k.D.Core})),{scenarioName:z.RG.AuthWebCachedUser}),{isPrimaryUser:!0,isAuthenticated:!0}),o=null===(a=null==s?void 0:s.filter((e=>!0===e.isAuthenticated)))||void 0===a?void 0:a[0];return o&&!this._primaryUserTasksPromise&&(this._primaryUserTasksPromise=this._renderingContextManager.executePrimaryUserTasks((0,He.KQ)(o)).then((e=>{this._coreServices=e}))),this._primaryUserTasksPromise}))}observeAuthenticatedUsers(e){this.observeUsers(e,this._logger).pipe(this.trackAuthUsers(e),(0,m.K)((t=>{var i,n,a;const s=t instanceof Re.G&&Re.G.isFunction(t.toTelemetryEntry)?t:new ze.G(null==t?void 0:t.code,t||new Error("Unknown error"));null===(n=(i=this._logger).errorToTelemetry)||void 0===n||n.call(i,`Core Initialization: ${TL}`,"webclient_framework_foundation_core_services",{errorCode:s.toTelemetryEntry()},!0);const o=(0,oe.Tr)("Core",h.jK.NotInitialized,null===(a=s.prevError)||void 0===a?void 0:a.context,{innerError:s.prevError});throw e.errorState.error=o,e.coreSettings.get(S.J.Core).enableCoreErrorsV2?s:o})),(0,g.b)((()=>{const[t,i]=ut(e.scenarioFactory);null==t||t.mark(z.ck.CoreRenderingContextReady)})),(0,l.U)((e=>e.length>0?e[0]:this._renderingContextManager.getDefaultRenderingContext()))).subscribe(this._contextSubject)}canDisplayCriticalErrorPage(e){return!!((null==e?void 0:e.rebootService)&&e.i18n&&e.scenarioFactory&&e.coreSettings&&e.hostCommunicationService&&e.coreSettings.get(S.J.Core).enableCoreErrorsV2)}canHandleNavigationIntents(e){return!!((null==e?void 0:e.client)&&e.deeplinkService&&e.entityCommanding)}registerForAppStateChanged(e){var t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let i;try{i=yield e.loadModule("core")}catch(e){const t=`${sr}${or.LoadModuleCoreFailed} registerForAppStateChanged`;return void IL(this._logger,t,"webclient_framework_host_comms")}try{null===(t=null==i?void 0:i.registerForAppStateChanged)||void 0===t||t.call(i,this.cleanupOnAppStateChangedCallback)}catch(e){const t=`${sr}${or.RegisterForAppStateChangedFailed}`;return void IL(this._logger,t,"webclient_framework_host_comms")}}))}observeWindowsWithoutApollo(e){return e.activeWindowsService.getActiveWindowsObservable().pipe((0,l.U)((e=>e.map((t=>Object.assign(Object.assign({},t),{screenState:{numOpenWindows:e.length}}))))),this._trackWindowsOperator(this.getContextObservable.bind(this),e,this._templateGenerator,this._config.getExperienceWindowFeatures))}observeWindows(e){return(0,he.G)(e.client.watchQuery({query:bt})).pipe((0,u.h)((({errors:e,loading:t})=>void 0===e&&!t)),(0,l.U)((({data:{activeWindows:e}})=>e.map((t=>Object.assign(Object.assign({},t),{screenState:{numOpenWindows:e.length}}))))),this._trackWindowsOperator(this.getContextObservable.bind(this),e,this._templateGenerator,this._config.getExperienceWindowFeatures))}observeUsers(e,t){const i=this.observeUsersEvents(e.client);return(0,he.G)(i).pipe((0,l.U)((e=>this.toUserContexts(e,t))),(0,m.K)((e=>{var t,i;const n=`Core Initialization: ${SL}`;throw null===(i=(t=this._logger).errorToTelemetry)||void 0===i||i.call(t,`${n} ${e.message}`,"webclient_framework_foundation_core_services",{errorCode:e.code,context:e.context,errors:`${null==e?void 0:e.reason}-${(0,U.u4)(null==e?void 0:e.serverResponse)}`},!0),mt(e)})))}observeUsersEvents(e){const t={filter:{isAuthenticated:!0}},i=e.watchQuery({query:kt,variables:t});return i.subscribeToMore({document:yt,variables:t,updateQuery:(e,t)=>t.subscriptionData.data.authenticationUsersEvent}),i}onUserAuthenticated(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return yield this.tryExecutePrimaryUserTasks(),this._renderingContextManager.getOrCreateUserRenderingContext(e)}))}onUserDestroy(e){const t={logger:this._logger,renderingContextManager:this._renderingContextManager},i=e.authenticationUser;i&&Ct(Object.assign(Object.assign({},t),{coreSettings:e.coreSettings,reason:"unknown_destroy",user:i}))}toUserContexts({data:e,loading:t,errors:i},n){var a;if(i)throw IL(n,wL,"webclient_framework_foundation_core_services"),(0,re.E6)({graphQLErrors:i.concat(),extraInfo:void 0,networkError:null,name:"AuthenticationUsers subscription error",message:"Error in authentication users subscription"});if(!t){if(!e)return IL(n,_L,"webclient_framework_foundation_core_services"),[];return(null!==(a=e.authenticationUsers)&&void 0!==a?a:[]).filter((e=>!0===e.isAuthenticated)).map(this.toUserContext)}return[]}toUserContext(e){const{id:t,isAuthenticated:i,cloud:n,profile:{tenantId:a,objectId:s,puid:o},role:r,type:c,subType:l,loginUserName:d,homeAccountId:u}=e;return{id:t,isAuthenticated:i,profile:{tenantId:a,objectId:s,puid:o},cloud:n,role:r,type:c,subType:l,loginUserName:d,homeAccountId:u||void 0}}isEntityInView(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this._coreServices)return Promise.resolve(!1);const{clientState:i,coreSettings:n}=this._coreServices;return rt(e,t,i,this._activeWindows,this._logger,n)}))}registerForLogsDownloadSignalFromDesktop(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield t.loadModule("logscollection");n&&(null===(i=null==n?void 0:n.registerForRequestWebLogsDownload)||void 0===i||i.call(n,(t=>{const i=!t.webLogsId;this._preCoreLogsFileService.downloadLogsFiles(e,i,t.webLogsId)})))}))}}const EL={auth:{enableRedirectToSignIn:[{viewportContext:["iFrame"],value:!1}],enableAuthenticateOrGetUser:[{viewportContext:["iFrame"],value:!1}]},calling:{isCallingScreenInteractive:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!1}],isCallingAlertDismissEnabled:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!1}],enableVideoRenderingInHostWindow:[{viewportContext:["iFrame"],value:!0},{viewportContext:["primary"],value:!0}],allowMultipleCallingAlertBanners:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!1}],allowPinningParticipantFromOutside:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}],allowGalleryToggleFromOutside:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}],forceDisableTitleBar:[{entityType:["callsmonitor"],value:!0}],isCallingAlertActionEnabled:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!1}],isContentSharingShownOnCallingScreen:[{entityType:["callsgallery"],value:!1}],isContentOnlyCallingScreen:[{entityType:["callscontent","stagecontent"],value:!0}],isLayoutSwitcherSupported:[{entityType:["callsgalleryandcontent"],value:!0}],showAllCallingAlertsAsBanner:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!0}],isContentCameraSharingSupported:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!0}],isIncomingCallScreenSupported:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}],enableCallCloseHook:[{entityType:["callsmonitor","stagecontent","byodattendeewindow"],value:!1}],enableMeetingReactions:[{entityType:["stagecontent"],value:!1}]},core:{isHeaderDisabled:[{viewportContext:["iFrame"],value:!0}],isMinimodeWindow:[{viewportContext:["minimode"],value:!0}],isPrimaryWindow:[{viewportContext:["primary"],value:!0}],isSecondaryWindow:[{viewportContext:["secondary"],value:!0}],enableFluentTabs:[{viewportContext:["secondary"],value:!1}],enableSearchBoxInMainWindow:[{viewportContext:["primary"],value:!0}],enableNavControlInMainWindow:[{viewportContext:["primary"],value:!0}],enableMainWindowTitleBarStyles:[{viewportContext:["primary"],value:!0}],enableMainWindowChatHeaderTitleStyles:[{viewportContext:["primary"],value:!0}],enableTitleTextInChildWindow:[{viewportContext:["secondary"],value:!0}],enableTransparentTitleBar:[{entityType:["calls","callingdeeplink"],value:!1}],enableAppSwitcher:[{viewportContext:["secondary"],value:!1}],adjustSpacingBetweenChatHeaderButtons:[{viewportContext:["secondary"],value:!1}],isBorderDisabled:[{viewportContext:["primary"],value:!0}],enableThickFlyoutBorder:[{viewportContext:["flyout"],value:!0}],enableNovaMeControlAvatarSrcContext:[{viewportContext:["primary"],value:!0}]},extensibility:{enableAtGetBots:[{entityType:["email"],value:!1}]},broadcast:{isRenderingInEmbedMode:[{viewportContext:["iFrame"],value:!0},{viewportContext:["primary"],value:!1}]}},FL={},xL={csaService:{apiConstants:[{region:["gcc"],value:{resource:"https://chatsvcagg.gcc.teams.microsoft.com",host:"https://chatsvcagg.gcc.teams.microsoft.com",version:"/api/v1/",endpoints:{startupclean:"teams/users/me",startupdelta:"teams/users/me/updates",startupgroupchats:"teams/users/me/groupchats",startupnonrecentchats:"teams/users/me/nonrecentchats",startupcleananonymous:"teams/users/anonymous",startupdeltaanonymous:"teams/users/anonymous/updates"}},resolutionStrategy:["override"]}]}},DL={mappings:{calling:{allowPrivateCallingPolicy:{name:"callingPolicy.allowPrivateCalling"},myPhoneNumber:{name:"voiceAdminSettings.phoneNumber"},adminSettings:{name:"adminSettings"},callingPolicy:{name:"callingPolicy"},policySettings:{name:"policySettings"},teamsMeetingBrandingPolicy:{name:"teamsMeetingBrandingPolicy"},syntheticAutomatedCallPolicy:{name:"syntheticAutomatedCallPolicy"},meetingPolicy:{name:"meetingPolicy"},tenantSettingsV2:{name:"tenantSettingsV2"},tenantVoiceSettings:{name:"tenantVoiceSettings"},userResourcesSettings:{name:"userResourcesSettings"},voiceAdminSettings:{name:"voiceAdminSettings"},teamsEmergencyCallingPolicy:{name:"teamsEmergencyCallingPolicy"},teamsEmergencyCallRoutingPolicy:{name:"teamsEmergencyCallRoutingPolicy"},delegationSettingsPolicy:{name:"voiceAdminSettings.delegationSettings"},dialPlanPolicy:{name:"policySettings.dialPlanPolicy"},safeTransferPolicy:{name:"callingPolicy.safeTransferEnabled"},allowCloudRecordingPolicy:{name:"meetingPolicy.allowCloudRecording"},allowRecordingStorageOutsideRegion:{name:"meetingPolicy.allowRecordingStorageOutsideRegion"},recordingStorageMode:{name:"meetingPolicy.recordingStorageMode"},allowCloudRecordingForCallsPolicy:{name:"callingPolicy.allowCloudRecordingForCalls"},closedCaptionsPolicy:{name:"meetingPolicy.liveCaptionsEnabledType"},closedCaptionsForCallingPolicy:{name:"callingPolicy.liveCaptionsEnabledTypeForCalling"},isPptSharingAllowedByPolicy:{name:"meetingPolicy.allowPowerPointSharing"},areMeetingNotesEnabledByPolicy:{name:"meetingPolicy.allowSharedNotes"},isMeetingReactionsAllowedByPolicy:{name:"meetingPolicy.allowMeetingReactions"},isAnnotationsEnabledByPolicy:{name:"meetingPolicy.allowAnnotations"},customVideoBackgroundsFilterByPolicy:{name:"meetingPolicy.videoFiltersMode"},screenSharingModePolicy:{name:"meetingPolicy.screenSharingMode"},meetingChatEnableTypePolicy:{name:"meetingPolicy.meetingChatEnableType"},allowPrivateMeetingSchedulingPolicy:{name:"meetingPolicy.allowPrivateMeetingScheduling"},allowMeetNowPolicy:{name:"meetingPolicy.allowMeetNow"},callParkPolicy:{name:"callParkPolicy"},teamsEnhancedEncryptionPolicy:{name:"teamsEnhancedEncryptionPolicy"},messagingPolicy:{name:"messagingPolicy"},isVideoAllowedByPolicy:{name:"meetingPolicy.allowIPVideo"},enableCallTranscriptByPolicy:{name:"meetingPolicy.allowTranscription"},enableCallTranscriptInCallsByPolicy:{name:"callingPolicy.allowTranscriptionForCalling"},onlineDialinConferencingPolicy:{name:"onlineDialinConferencingPolicy"}},extensibility:{isSideLoadingInteractionEnabled:{name:"tenantSettingsV2.apps.isSideLoadingInteractionEnabled"},storeAppTenantBackground:{name:"tenantSettingsV2.apps.lobBackground"},storeAppTenantLogo:{name:"tenantSettingsV2.apps.lobLogo"},storeAppTenantTextColor:{name:"tenantSettingsV2.apps.lobTextColor"},storeAppTenantIcon:{name:"tenantSettingsV2.apps.lobLogomark"}},broadcast:{sdnConfiguration:{name:"broadcastMeetingPolicy.broadcastMeetingSDNConfigurationJsonBlob"}}},namespaces:["callingPolicy","voiceAdminSettings","adminSettings","policySettings","teamsMeetingBrandingPolicy","syntheticAutomatedCallPolicy","meetingPolicy","tenantSettingsV2","tenantVoiceSettings","userResourcesSettings","teamsEmergencyCallingPolicy","teamsEmergencyCallRoutingPolicy","callParkPolicy","teamsEnhancedEncryptionPolicy","messagingPolicy","onlineDialinConferencingPolicy","broadcastMeetingPolicy"]};function AL(e){switch(e){case"ag08":return i.e(427573).then(i.bind(i,87221)).then((e=>e.default));case"ag09":return i.e(529709).then(i.bind(i,536134)).then((e=>e.default));case"dod":return i.e(248735).then(i.bind(i,956660)).then((e=>e.default));case"gallatin":return i.e(693334).then(i.bind(i,612661)).then((e=>e.default));case"gcc":return i.e(324925).then(i.bind(i,397824)).then((e=>e.default));case"gcchigh":return i.e(854668).then(i.bind(i,273688)).then((e=>e.default));case"life":return i.e(872564).then(i.bind(i,587441)).then((e=>e.default));case"prod":return i.e(362376).then(i.bind(i,768895)).then((e=>e.default));case"viewportOverrides":return EL;case"clientFiltersMerge":return FL;case"clientFiltersOverride":return xL;case"policies":return DL;default:throw new Error(`Requested config does not exist: ${e}`)}}var ML=i(842422);const PL={id:"com.microsoft.teams.convene",name:"ConveneApp",supportedEntities:[pe.py.broadcastfeedback,pe.py.eventsbroadcastqna,pe.py.broadcasts,pe.py.meetings],supportedRenderModes:[Wt.S.Main,Wt.S.Rail,Wt.S.HorizontalBar],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},OL=e=>{if(RL(e))return LL(e)?{subNavEntity:UL(e),headerEntity:$L(e),startEntity:WL(e),mainEntity:BL(e),endEntity:zL(e)}:null},RL=({layoutMode:e,entity:t})=>{const{action:i=null,type:n}=Object.assign({},t),a=[ve.lO.focus,ve.lO.standard].includes(e),s=[pe.py.meetings,pe.py.broadcastqna,pe.py.eventsbroadcastqna].includes(n),o=[pe.uk.create,pe.uk.default,pe.uk.list,pe.uk.view,pe.uk.join],r=i&&o.includes(i);return!!(a&&s&&r)},LL=()=>!0,UL=()=>null,$L=({entity:e})=>e,WL=()=>null,BL=({entity:e})=>e,zL=({contextEntity:e})=>HL(e)?e:null,HL=e=>e&&e.type===pe.py.broadcasts&&e.action===pe.uk.info;var qL,VL=i(523635);!function(e){e.InvalidDeeplinkUrl="invalid-deeplink-url-received",e.MeetingUrlParse="meeting-url-parse-error",e.OldConveneUrlFormat="old-convene-url-format"}(qL||(qL={}));const GL={filter:"/convene/meet",execute:({deeplinkUrl:{pathname:e,search:t,origin:i},context:{coreSettings:n,loggerFactory:a}})=>{var s;const o=a.newLogger("[Convene][onBeforeDeeplinkParsed]","apps-convene"),{defaultAnonTenantId:r}=n.get(S.J.Calling);if(o.log(`Parsing pathname: ${e}, search: ${t}`),!e||!e.startsWith("/convene/meetings"))return Promise.reject({message:qL.InvalidDeeplinkUrl});if(e.endsWith("/join")&&""===t)return Promise.reject({message:qL.OldConveneUrlFormat});const c=new URLSearchParams(t).get("url");if(!c)return Promise.reject({message:qL.MeetingUrlParse});const l=new URL(c,i),d=null!==(s=l.pathname.split("/").find((e=>e.startsWith("19:"))))&&void 0!==s?s:"",u=l.searchParams.get("context"),{Tid:m,Oid:g}=u?JSON.parse(u):"",h=(0,VL.l0)(m,g,d,"0");return""===h?Promise.reject({message:qL.MeetingUrlParse}):Promise.resolve({entityCommand:{entity:{type:pe.py.meetings,action:pe.uk.join,id:h},command:{visibilityState:ve.fe.show,stateTransition:ve.su.none,layoutMode:ve.lO.standard},entityOptions:{meetingUrl:c,threadId:d,messageId:"0",tenantId:m,organizerId:g}},metadata:{allowAnonymous:!0,tenantId:m||r||void 0}})}},JL=[GL];var KL=i(387586),QL=i(138730);const YL=()=>Promise.all([i.e(958828),i.e(743719),i.e(247364),i.e(531924),i.e(923731),i.e(244738),i.e(428421),i.e(814199),i.e(446977),i.e(705849),i.e(395303),i.e(873428),i.e(236315),i.e(189185),i.e(43220),i.e(523384),i.e(104526),i.e(290689),i.e(826310),i.e(680562),i.e(584571),i.e(150662),i.e(498871),i.e(38604),i.e(448073),i.e(277110),i.e(252283),i.e(225330),i.e(822166),i.e(803388),i.e(631900),i.e(656283),i.e(740324),i.e(795061),i.e(313308),i.e(471926),i.e(735861),i.e(807292),i.e(81817),i.e(454687)]).then(i.bind(i,775084));function XL(e){const t=()=>null;return{getAppViewEntities:OL,manifest:PL,render:({appRenderMode:i,scenarioFactory:a,coreSettings:s})=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=s.get(S.J.Broadcast).isRenderingInEmbedMode,{BroadcastViewsRenderer:o}=yield(0,Rl.mT)(YL,"convene-app",a);if(n&&i===Wt.S.HorizontalBar)return Se.createElement(t,null);const r=(0,qe.v4)();return Se.createElement(KL.vb,{joinId:r},Se.createElement(QL.f,{namespaces:["avatar","broadcast","framework","calling","peoplePicker"],loaderRenderer:null},Se.createElement(ML.yx,{conveneHostMessaging:e},Se.createElement(o,{appRenderMode:i}))))})),onBeforeDeeplinkParsed:JL}}const ZL={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"InitCallingService"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entryPoint"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingServiceEntrypointType"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"initCallingService"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entryPoint"},value:{kind:"Variable",name:{kind:"Name",value:"entryPoint"}}}]}]}}]},eU={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingDisposeCallingServiceMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposeReason"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposeReason"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposeSource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposeSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"disposeCallingService"},arguments:[{kind:"Argument",name:{kind:"Name",value:"disposeReason"},value:{kind:"Variable",name:{kind:"Name",value:"disposeReason"}}},{kind:"Argument",name:{kind:"Name",value:"disposeSource"},value:{kind:"Variable",name:{kind:"Name",value:"disposeSource"}}}]}]}}]};var tU;!function(e){e.DisposeMutationGenericJobError="DisposeMutationGenericJobError"}(tU||(tU={}));const iU=(e,t,i,a,s)=>({id:"standup-calling",runOncePerId:!0,job:()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const o=a.newScenario(z.RG.CallingAppInit,{clientId:(0,qe.v4)()});o.appendEventData({context:i});const r=a.newScenario(z.RG.StandupCallingAppExecute);r.appendEventData({context:i}),r.mark(z.ck.ExecuteJob);const c=t.newLogger("getStandupCallingJob","apps-calling");c.log("[getStandupCallingJob] Initializing calling service");const{enableCallingSignOut:l,callingServiceDisposeTimeoutInMs:d,enableStandupCallingAppExecuteErrorStack:u}=s.get(S.J.Calling);try{const t=(e=>{switch(e){case z.ck.OnAppPreWarm:return xe.cCY.onAppPreWarm;case z.ck.OnAppPreInit:return xe.cCY.onAppPreInit;default:throw new Error(`StandupCallingJob - ${z.ck} is not on_app_pre_warm or on_app_pre_init`)}})(i);o.mark(z.ck.InitCallingServiceMutation),r.pause({reason:h.jK.WaitingForResponse}),yield e.mutate({mutation:ZL,variables:{entryPoint:t},context:{scenarioClientId:o.clientId,scenarioName:o.name}}),r.resume()}catch(e){throw c.error(`[getStandupCallingJob] Error initializing calling service [error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`),u&&r.appendEventData({error:null==e?void 0:e.stack}),r.fail({errors:e.name,message:`${z.ck.ExecuteJob} failed with ${e.message}`}),o.fail({errors:e.name,message:`${z.ck.InitCallingServiceMutation} failed with ${e.message}`}),(0,oe.Tr)(i,h.jK.StandupCallingJobError,e.name,void 0,e.message)}if(r.mark(z.ck.JobCompleted),o.mark(z.ck.EndStandupCallingJob),c.log("[getStandupCallingJob] Calling service initialized"),r.stop(),o.stop(),l)return()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return nU(e,c,a,i,d||45e3)}))}))}),nU=(e,t,i,a,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n;const o="SignOut",r="StandupCallingAppJob",c=i.newScenario(z.RG.CallingServiceDispose);c.appendEventData({context:o,dataSource:r,origin:a}),null===(n=i.hoistScenarioToCore)||void 0===n||n.call(i,c),t.log(`[getStandupCallingJob] Calling service disposal initiated. [step: ${a}, reason:${o}, source:${r}, timeout:${s}]`);try{const t=e.mutate({mutation:eU,variables:{disposeReason:o,disposeSource:r}});yield(0,H.E)(t,s,`Dispose mutation timed out. [timeoutAmount:${s}]`)}catch(e){throw t.error(`[getStandupCallingJob] Error disposing calling service [error.name=${null==e?void 0:e.name}, error.code=${null==e?void 0:e.code}, error.message=${null==e?void 0:e.message}, timeout:${s}]`),c.fail({reason:(null==e?void 0:e.code)||tU.DisposeMutationGenericJobError,message:(null==e?void 0:e.message)||e}),(0,oe.Tr)(z.RG.CallingServiceDispose,h.jK.StandupCallingJobError,o,void 0,null==e?void 0:e.message)}c.stop(),t.log("[getStandupCallingJob] Calling service disposed")})),aU={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingContentEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingContentEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"action"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visibility"}}]}},{kind:"Field",name:{kind:"Name",value:"content"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_callingBannerContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_callingLocalRecordingNotificationContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_mainAppContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingWindowingContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingDialogContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingNotificationContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToChatContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToChatListContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToSettingsPaneContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToCallListContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"crossCloudMeetingJoinContent"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_callingBannerContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingBannerContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"intentLevel"}},{kind:"Field",name:{kind:"Name",value:"dismissable"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"bannerScenario"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"dismissOnAction"}},{kind:"Field",name:{kind:"Name",value:"joinButtonText"}},{kind:"Field",name:{kind:"Name",value:"bannerActions"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_callingLocalRecordingNotificationContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingLocalRecordingNotificationContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"localRecordingNotificationType"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_mainAppContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MainAppContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingWindowingContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingWindowingContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"coordsType"}},{kind:"Field",name:{kind:"Name",value:"windowingMode"}},{kind:"Field",name:{kind:"Name",value:"linkedContent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingDialogContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingDialogContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"dialogActions"}},{kind:"Field",name:{kind:"Name",value:"dialogStrings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"text"}}]}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingNotificationContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingNotificationContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"crossClientScenarioName"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"subtitle"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"toastType"}},{kind:"Field",name:{kind:"Name",value:"bypassOsLevelDoNotDisturb"}},{kind:"Field",name:{kind:"Name",value:"image"}},{kind:"Field",name:{kind:"Name",value:"ringtoneAssetUrl"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"userid"}},{kind:"Field",name:{kind:"Name",value:"primaryAction"}},{kind:"Field",name:{kind:"Name",value:"audioDeviceLabel"}},{kind:"Field",name:{kind:"Name",value:"audioDeviceLabelSecondary"}},{kind:"Field",name:{kind:"Name",value:"audioDeviceId"}},{kind:"Field",name:{kind:"Name",value:"audioDeviceIdSecondary"}},{kind:"Field",name:{kind:"Name",value:"actions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}},{kind:"Field",name:{kind:"Name",value:"icon"}},{kind:"Field",name:{kind:"Name",value:"actionType"}}]}},{kind:"Field",name:{kind:"Name",value:"header"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"defaultImageDataUrl"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"subtitle"}},{kind:"Field",name:{kind:"Name",value:"mri"}}]}},{kind:"Field",name:{kind:"Name",value:"isSilent"}},{kind:"Field",name:{kind:"Name",value:"displayDuration"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToChatContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToChatContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"messageId"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToChatListContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToChatListContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToSettingsPaneContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToSettingsPaneContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"tabItemId"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToCallListContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToCallListContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"crossCloudMeetingJoinContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CrossCloudMeetingJoinContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"meetingUrl"}}]}}]}.definitions]},sU={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppSetupEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppSetupEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"result"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppEventsSetupSuccess"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppEventsSetupSuccess"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventsSetupSuccess"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"_"}}]}}]}.definitions]},oU={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsCallingCallingAppEventsSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingAppEvents"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppEvent"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"event"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingContentEvent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppSetupEvent"}}]}},{kind:"Field",name:{kind:"Name",value:"context"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"source"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}}]}}]}},...aU.definitions,...sU.definitions]}.definitions]};function rU(e,t,i){const{id:n,title:a,callId:s,crossClientScenarioName:o,subtitle:r,image:c,time:l,actions:d,type:u,primaryAction:m,header:g,toastType:h,ringtoneAssetUrl:v,audioDeviceLabel:f,audioDeviceLabelSecondary:b,audioDeviceId:y,audioDeviceIdSecondary:w,isSilent:j,displayDuration:C}=e,_=parseInt(l,10),T=g?{alt:g.subtitle,src:g.defaultImageDataUrl}:void 0;return{command:{correlation:{source:k.D.Notifications,id:i},stateTransition:ve.su.new,visibilityState:ve.fe.show},entityOptions:{buttons:null==d?void 0:d.map((e=>function(e,t,i,n,a){const{actionType:s,label:o,icon:r}=t;return Object.assign(Object.assign({},r&&{image:{alt:o,src:r}}),{targetEntity:{action:p.A$.mutate,dataOptions:{actionType:s,toastId:e,toastType:a},id:e,type:p.dt.calls},text:o,preferImageOnly:i.get(S.J.Calling).forceTextOnT2Notifications?void 0:!!r,style:dU(s,n)})}(n,e,t,u,h))),callId:s,crossClientScenarioName:o,bypassOsLevelDoNotDisturb:cU(u,t),isIncomingCall:lU(u),mainImage:{alt:a,src:c},ringtone:v,targetEntity:{action:p.A$.mutate,dataOptions:{actionType:m,toastId:n,toastType:h},id:n,type:p.dt.calls},text:r,time:new Date(_),title:a,headerImage:T,headerTitle:null==g?void 0:g.title,headerSubtitle:null==g?void 0:g.subtitle,deviceLabel:f,deviceLabelSecondary:b,deviceId:y,deviceIdSecondary:w,isSilent:j,displayDuration:C}}}const cU=(e,t)=>{let i;if(e===xe.k$E.MeetingWentLive)i=!!t.get(S.J.Calling).enableUrgentMeetingStartedNotificationV2;else i=!1;return i},lU=e=>e!==xe.k$E.MeetingWentLive;function dU(e,t){if(t!==xe.k$E.Meeting)switch(e){case"ReplyIncomingCall":return;case"RejectIncomingCall":return p.p6.critical;default:return p.p6.success}}function uU(e,t,i,n){const{id:a,coordsType:s,windowingMode:o,linkedContent:r}=i,{action:{visibility:c}}=t,{source:l,timeStamp:d}=n,u=function(e){return"Show"===e?ve.fe.show:ve.fe.hide}(c),m=function(e){return"SingleWindow"===e?ve.su.flush:ve.su.new}(o),g=r&&function(e){if(!e||!e.id)return;return{id:e.id,type:pe.py.chats}}(r),h=function(e){switch(e){case"RigelGallery":return pe.py.callsgallery;case"RigelContent":return pe.py.callscontent;case"RigelGalleryAndContent":return pe.py.callsgalleryandcontent;case"RigelMain":return pe.py.meetingroomallinonecall;default:return pe.py.calls}}(s);return{entity:{id:a,type:h,action:pe.uk.view,linkedEntity:g},command:{visibilityState:u,stateTransition:m,correlation:{id:e,startTimestamp:d||void 0,source:`${k.D.CallingAppEvent}::${l.name}::${l.description}`}}}}function mU(e,t){switch(e){case"Show":return ve.fe.show;case"Hide":return ve.fe.hide;default:return t.warn(`${e} cannot be converted to visibility state, defaulting to hide`),ve.fe.hide}}var gU,hU=i(104694);!function(e){e.Calling="Calling",e.Notifications="Notifications",e.Devices="Devices",e.PremiumBenefits="PremiumBenefits",e.Privacy="Privacy"}(gU||(gU={}));const pU={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaUserProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}}]}]}}]},vU={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCallingPriorityContactsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shouldFetchFromNetwork"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"priorityContacts"},arguments:[{kind:"Argument",name:{kind:"Name",value:"shouldFetchFromNetwork"},value:{kind:"Variable",name:{kind:"Name",value:"shouldFetchFromNetwork"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"jobTitle"}}]}}]}}]},fU={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"toastImageAsDataUri"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}]}]}}]};const bU=new class{constructor(){this.deeplinkEntitySet=!1,this.callingAppEventsSubscribed=!1,this.unlockDeeplinkEntity=()=>{const e=this.deeplinkEntityId;return this.deeplinkEntityId=void 0,this.resolvePromise&&this.resolvePromise(),e},this.lockDeeplinkEntity=e=>{this.deeplinkEntitySet||(this.initializingPromise=new Promise((e=>{this.resolvePromise=()=>{e()}})),this.deeplinkEntityId=e,this.deeplinkEntitySet=!0)},this.getDeeplinkEntityLocked=()=>this.deeplinkEntitySet,this.getDeeplinkReady=()=>this.initializingPromise,this.getCallingAppEventsSubscribed=()=>this.callingAppEventsSubscribed,this.setCallingAppEventsSubscribed=e=>{this.callingAppEventsSubscribed=e}}},yU={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"resolveCallingAppEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingAppEventResolution"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventResolution"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolveCallingAppEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingAppEventResolution"},value:{kind:"Variable",name:{kind:"Name",value:"callingAppEventResolution"}}}]}]}}]};function kU(e,t,i){const{eventId:n,resolution:a,context:s}=e,{source:o}=s;return i.log(`[resolveCallingAppEvent] Resolving calling app event [eventId=${n}, source.name=${o.name}, source.description=${o.description}]`),t.mutate({mutation:yU,variables:{callingAppEventResolution:{eventId:n,resolution:a,context:s}},fetchPolicy:"no-cache"})}function SU(e,t,i){if(e&&t)return t.getAccountMode()===fN.MultipleAccounts?(i.log(Ki.f.ReturningUserKeyForToastCollection),(0,He.b4)(e)):void i.error(Ki.f.CollectionIdUndefined);i.error(Ki.f.NoAutheticatedUserOrTrackingService)}function wU(e,t,i){const{id:n,name:a,dialogActions:s,dialogStrings:o}=t,{action:{visibility:r}}=e,{timeStamp:c}=i;let l;if("Show"===r)l=ve.fe.show;else{if("Hide"!==r)return;l=ve.fe.hide}const d={visibilityState:l,stateTransition:ve.su.extend,correlation:{id:n,startTimestamp:c||void 0,source:a}},u=function(e){switch(e){case"WindowingError":return pe.py.windowingerrordialog;case"CallingRestartRecomendedError":return pe.py.restartrecomendeddialog;case"Alert":return pe.py.callingalertdialog;case"CallingUnparkCall":return pe.py.unparkcalldialog;case"CallingConfirm":return pe.py.callingconfirmdialog;case"OptionsSettings":return pe.py.optionssettingsdialog;case"PrejoinOverlay":return pe.py.prejoinoverlaydialog;case"UserMedia":return pe.py.usermediadialog;default:return}}(a);if(!u)return;const m={dialogActions:s?[...s]:[],dialogStrings:o?[...o]:[]};return{entity:{id:n,type:u,action:pe.uk.create},entityOptions:m,command:d}}const jU={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingTriggerDialogActionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"dialogId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DialogAction"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerDialogAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"dialogId"},value:{kind:"Variable",name:{kind:"Name",value:"dialogId"}}},{kind:"Argument",name:{kind:"Name",value:"actionName"},value:{kind:"Variable",name:{kind:"Name",value:"actionName"}}}]}]}}]};function CU(e,t,i){const{id:n,bannerScenario:a,bannerActions:s}=t,{action:{visibility:o}}=e,{timeStamp:r}=i,c=function(e){let t;if("Show"===e)t=ve.fe.show;else{if("Hide"!==e)return;t=ve.fe.hide}return t}(o);if(void 0===c)return;const l={visibilityState:c,stateTransition:ve.su.extend,correlation:{id:n,startTimestamp:r||void 0,source:a}},d=function(e){if("EndpointTransfer"===e)return pe.py.callingbannernotification;return}(a),u=function(e){let t;e===ve.fe.show&&(t=pe.uk.join);e===ve.fe.hide&&(t=pe.uk.delete);return t}(c);return d&&u?{bannerPrimaryActionEntity:{id:n,type:d,action:u},entityOptions:{bannerActions:s},command:l,bannerDismissCommandEntity:{id:n,type:pe.py.callingbannernotification,action:pe.uk.delete}}:void 0}function _U(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const{eventId:n,resolution:a,context:s}=e;yield kU({eventId:n,resolution:a,context:s},t,i)}catch(e){i.error(a,`error: [errorName=${e.name}, errorMessage=${e.message}]]`)}}))}function TU(e,t,i,n,a){let s={success:{_:!0}};return n&&a&&(s={error:{name:n,message:a}}),{eventId:e,resolution:s,context:{source:{name:t,description:i}}}}const IU="CN:",NU=(e,t,i,a,s,o,r,c)=>()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const l=i.newLogger("getSetupAppEventsJob","apps-calling"),{enableCallingAppEventSubscriptionTelemetry:d}=a.get(S.J.Calling);let u=!1;const m=(0,wd.P)();let g;return d&&(g=s.newScenario(z.RG.CallingAppEventsSubscribe)),bU.setCallingAppEventsSubscribed(!0),e.subscribe({query:oU,fetchPolicy:"no-cache"}).map((({data:e})=>null==e?void 0:e.callingAppEvents)).subscribe({next:o=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){let n;if(d&&(n=s.newScenario(z.RG.CallingAppEventSubscriptionNext,{clientId:null==o?void 0:o.id})),!o)return l.error("[getSetupAppEventsInnerJob] Received undefined calling app event"),void(null==n||n.fail({reason:"undefined-calling-app-event"}));if("CallingAppSetupEvent"===o.event.__typename&&o.event.result&&"CallingAppEventsSetupSuccess"===o.event.result.__typename)return l.log("[getSetupAppEventsInnerJob] Successfully subscribed."),u=!0,m.resolve(),void(null==g||g.stop());const{context:p}=o,{source:v}=p;l.log(`[getSetupAppEventsInnerJob] Received calling app event [event.id=${o.id}][context.externalId=${p.externalId}][source.name=${v.name}][source.description=${v.description}]`);try{yield EU(r,o,a,e,t,i,s,c),null==n||n.stop()}catch(t){l.error(`Calling app event handler threw error. [error.name=${null==t?void 0:t.name}][error.message=${null==t?void 0:t.message}]`),null==n||n.fail({errorCode:t.name,message:t.message,reason:"job-subscription-next-error"}),kU({eventId:o.id,resolution:{error:{name:(null==t?void 0:t.errorCode)||h.jK.HandleCallingAppEventError,message:(null==t?void 0:t.errorMessage)||`Unhandled exception while handling calling app events in job [eventId=${o.id}]`}},context:{source:{name:xe.BHj.CallingAppEventJobHandlerError,description:`Error handling event in app job setup calling app events [eventId=${o.id} error.errorCode=${null==t?void 0:t.errorCode}, error.message=${null==t?void 0:t.errorMessage}]`}}},e,l)}})),error:e=>{if(l.error(`[getSetupAppEventsInnerJob] Error in calling app events subscription [error.name=${null==e?void 0:e.name}][error.message=${null==e?void 0:e.message}]`),!u){const t=(0,oe.Tr)(o,h.jK.SetupCallingAppEventsJobError,"",{},`[getSetupAppEventsInnerJob] error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}`);m.reject(t)}if(d){let t=s.findScenario(z.RG.CallingAppEventsSubscribe);t||(t=s.newScenario(z.RG.CallingAppEventsSubscribe)),t.fail({errorCode:null==e?void 0:e.name,message:null==e?void 0:e.message,reason:"app-job-subscription-error"})}},complete:()=>{if(d){s.newScenario(z.RG.CallingAppEventsUnsubscribe).stop()}}}),m.promise})),EU=(e,t,i,a,s,o,r,c)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{id:l,event:d,context:u}=t;if(!("action"in d)||!("content"in d)){throw o.newLogger("appEventsHandler","apps-calling").error("[getSetupAppEventsInnerJob] Expected event of type CallingAppEvent, not CallingAppSetupEvent."),new Error("IncorrectCallingAppEventTypeError")}switch(d.content.__typename){case"MainAppContent":!function(e,t,i,a,s){(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.newLogger("handleMainAppContentEvent","apps-calling"),o={id:s.context.externalId||"undefined",startTimestamp:s.context.timeStamp||"undefined",scenarioName:z.RG.CallingAppEventMainApp,source:k.D.CallingAppEvent};try{yield t.deepLink.launchMainApp(o)}catch(e){const t=(null==e?void 0:e.name)||"unknown-launch-main-app-commanding-error-name",s=(null==e?void 0:e.message)||"unknown-launch-main-app-commanding-error-message";n.error(`[handleMainAppContentEvent] Commanding error errorName=${t}, eventSource=${o.source}, errorMessage=${s}]`);try{yield kU({eventId:a,resolution:{error:{name:t,message:s}},context:{source:{name:xe.BHj.MainAppCommandingError,description:`Error triggering launch main app command [eventId=${a}, eventSource=${o.source}]`}}},i,n)}catch(e){n.error(`[handleMainAppContentEvent] Error when reporting event "error" [eventId=${a}, eventSource=${o.source}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}return}n.log(`[handleMainAppContentEvent] Commanding success [eventId=${a}, eventSource=${o.source}]`);try{yield kU({eventId:a,resolution:{success:{_:!0}},context:{source:{name:xe.BHj.MainAppCommandingSuccess,description:`Command resolved successfully [eventId=${a}, eventSource=${o.source}]`}}},i,n)}catch(e){n.error(`[handleMainAppContentEvent] Error when reporting event "success" [error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}}))}(o,s,a,l,t);break;case"CallingWindowingContent":!function(e,t,i,a,s,o,r,c){var l;(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.newLogger("handleCallingWindowingContentEvent","apps-calling"),{entity:d,command:u}=uU(a,s,o,r),m=bU.unlockDeeplinkEntity();try{yield t.call.callById(d.id,{visibilityState:u.visibilityState,stateTransition:u.stateTransition,correlation:u.correlation},null===(l=null==d?void 0:d.linkedEntity)||void 0===l?void 0:l.id,d.type,m)}catch(e){const t=(null==e?void 0:e.name)||"unknown-windowing-commanding-error-name",s=(null==e?void 0:e.message)||"unknown-windowing-commanding-error-message";n.error(`[handleCallingWindowingContentEvent] Windowing commanding error [entity.id=${d.id}, errorName=${t}, errorMessage=${s}]`);try{yield kU({eventId:a,resolution:{error:{name:t,message:s}},context:{source:{name:xe.BHj.WindowingCommandingTriggerError,description:`Error triggering windowing command [eventId=${a}, entity.id=${d.id}]`}}},i,n)}catch(e){n.error(`[handleCallingWindowingContentEvent] Error when reporting event "error" [eventId=${a}, entity.id=${d.id}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}return}const{enableCallingAppCommandResolvedHook:g}=c.get(S.J.Calling);if(!g){n.log(`[handleCallingWindowingContentEvent] Windowing commanding success [eventId=${a}, entity.id=${d.id}]`);try{yield kU({eventId:a,resolution:{success:{_:!0}},context:{source:{name:xe.BHj.WindowingCommandingSuccess,description:`Windowing command resolved successfully [eventId=${a}, entity.id=${d.id}]`}}},i,n)}catch(e){n.error(`[handleCallingWindowingContentEvent] Error when reporting event "success" [entity.id=${d.id}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}}}))}(o,s,a,l,d,d.content,u,i);break;case"CallingToChatContent":!function(e,t,i,a,s){var o;(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.newLogger("handleCallingToChatContentEvent","apps-calling"),{entity:r,command:c}=function(e,t,i,n){const a=t.id,{action:{visibility:s}}=e,{externalId:o,timeStamp:r}=n,c=mU(s,i),l=t.messageId?{id:t.messageId,type:pe.py.messages}:void 0;return{entity:{id:a,type:pe.py.chats,action:pe.uk.view,linkedEntity:l},command:{visibilityState:c,stateTransition:ve.su.new,correlation:{id:o||void 0,startTimestamp:r||void 0,source:k.D.CallingAppEvent}}}}(i,a,n,s);try{yield t.chat.chatById(r.id,{entityCommand:{visibilityState:c.visibilityState,stateTransition:c.stateTransition,correlation:c.correlation},entityOptions:{messageId:null===(o=r.linkedEntity)||void 0===o?void 0:o.id}})}catch(e){n.error(`[getSetupAppEventsInnerJob] Navigation to chat commanding error [entity.id: ${r.id}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}n.log(`[getSetupAppEventsInnerJob] Navigation to chat commanding success [entity.id: ${r.id}]`)}))}(o,s,d,d.content,u);break;case"CrossCloudMeetingJoinContent":!function(e,t,i,a,{meetingUrl:s}){(0,n.__awaiter)(this,void 0,void 0,(function*(){let n;const o=e.newLogger("handleCrossCloudMeetingJoinContentEvent","apps-calling");o.log("handleCrossCloudMeetingJoinContentEvent called");try{yield t.deepLink.executeFromUrlV2(s,void 0,void 0,!1),n={success:{_:!0}}}catch(e){const t=(null==e?void 0:e.name)||"unknown-cross-cloud-meeting-join-content-event";n={error:{name:t,message:(null==e?void 0:e.message)||"unknown-windowing-commanding-error-message"}},o.error(`[handleCrossCloudMeetingJoinContentEvent] Cross Cloud commanding error [meetingUrl=${s}, errorName=${t}]`)}try{yield kU({eventId:a,resolution:n,context:{source:{name:xe.BHj.WindowingCommandingTriggerError,description:`Error triggering windowing command [eventId=${a}]`}}},i,o)}catch(e){o.error(`[handleCrossCloudMeetingJoinContentEvent] Error when reporting event resolution [eventId=${a}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}}))}(o,s,a,l,d.content);break;case"CallingToChatListContent":!function(e,t,i,a){(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.newLogger("handleCallingToChatListContentEvent","apps-calling"),{command:s}=function(e,t,i){const{action:{visibility:n}}=e,{externalId:a,timeStamp:s}=i,o=mU(n,t);return{entity:{type:pe.py.chats,action:pe.uk.view},command:{visibilityState:o,stateTransition:ve.su.none,correlation:{id:a||void 0,startTimestamp:s||void 0,source:k.D.CallingAppEvent}}}}(i,n,a);try{yield t.chat.chatList({visibilityState:s.visibilityState,stateTransition:s.stateTransition,correlation:s.correlation})}catch(e){n.error(`[getSetupAppEventsInnerJob] Navigation to chat list commanding error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}n.log("[getSetupAppEventsInnerJob] Navigation to chat list commanding success")}))}(o,s,d,u);break;case"CallingToCallListContent":!function(e,t,i,a){(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.newLogger("handleCallingToCallListContentEvent","apps-calling"),{command:s}=function(e,t,i){const{action:{visibility:n}}=e,{externalId:a,timeStamp:s}=i,o=mU(n,t);return{entity:{type:pe.py.callsmain,action:pe.uk.view},command:{visibilityState:o,stateTransition:ve.su.none,correlation:{id:a||void 0,startTimestamp:s||void 0,source:k.D.CallingAppEvent}}}}(i,n,a);try{yield t.call.callList({visibilityState:s.visibilityState,stateTransition:s.stateTransition,correlation:s.correlation})}catch(e){n.error(`[getSetupAppEventsInnerJob] Navigation to call list commanding error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}n.log("[getSetupAppEventsInnerJob] Navigation to call list commanding success")}))}(o,s,d,u);break;case"CallingToSettingsPaneContent":!function(e,t,i){(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.newLogger("handleCallingToSettingsPaneContentEvent","apps-calling"),a=function(e){const t=new Map([[gU.Calling,hU.Y.Calls],[gU.Notifications,hU.Y.Notifications],[gU.Devices,hU.Y.Devices],[gU.PremiumBenefits,hU.Y.Benefits],[gU.Privacy,hU.Y.Privacy]]);return{id:e.tabItemId?t.get(e.tabItemId):void 0,command:{stateTransition:ve.su.flush,visibilityState:ve.fe.show,correlation:{source:k.D.CallingAppEvent}}}}(i),{id:s,command:o}=a;try{yield t.settings.launchSection(s,o)}catch(e){n.error(`[getSetupAppEventsInnerJob] setting commanding error [entity.id: ${s}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}))}(o,s,d.content);break;case"CallingBannerContent":!function(e,t,i,a,s,o,r,c){(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.newLogger("handleCallingBannerContentEvent","apps-calling"),{enableCallingBannerContent:l}=c.get(S.J.Calling);if(!l)return;const d=CU(s,o,r);if(!d){n.error("[handleCallingBannerContentEvent] Banner commanding error - no command to fire, visibility state is undefined");const e="Unknown-banner-commanding-error-name",t=`Unhandled exception while handling calling app events in job, error in converting banner content to command, visibility state is undefined [eventId=${a}]`,s=xe.BHj.BannerContentToCommandingConversionError,o=`[handleCallingBannerContentEvent] Error in handling calling banner content event due to undefined commanding with [eventId=${a},`,r=TU(a,s,`Error converting banner content to commanding [eventId=${a}]`,e,t);return void(yield _U(r,i,n,o))}const{bannerPrimaryActionEntity:u,entityOptions:m,command:g,bannerDismissCommandEntity:h}=d,{action:{visibility:p}}=s;if("Show"===p)try{yield t.shell.showBanner({id:o.id,text:o.text,intentLevel:o.intentLevel,action:{text:o.joinButtonText,command:{entity:u,entityOptions:m,command:g},dismissOnAction:o.dismissOnAction},dismissable:o.dismissable||void 0,dismissActionCommand:{entity:h,entityOptions:m,command:g},duration:o.duration,bannerScenario:o.bannerScenario,source:o.source});const e=xe.BHj.ShowBannerSuccess,s=`Show banner command resolved successfully [eventId=${a}, entity.id=${u.id}]`,r=`[handleCallingBannerContentEvent] Error when reporting show banner event "success" with [eventId=${a}, entity.id=${u.id},`,c=TU(a,e,s);yield _U(c,i,n,r)}catch(e){n.error(`Error is displaying banner through shell.showBanner with [entity.id: ${u.id}, error.name: ${e.name}, error.message: ${e.message}]`);const t="Unknown-show-banner-error-name",s=`Unhandled exception while handling calling app events in job, failed to trigger shell.showBanner function, error in showing banner [eventId=${a}]`,o=xe.BHj.ShowBannerError,r=`[handleCallingBannerContentEvent] Error in handling calling banner content event due to failure of shell.showBanner with [eventId=${a},`,c=TU(a,o,`Error in showing banner through shell.showBanner [eventId=${a}]`,t,s);yield _U(c,i,n,r)}if("Hide"===p)try{yield t.shell.dismissBanner(o.id,o.source),n.log(`[dismissBanner] Successfully hiding the banner with [bannerId: ${o.id}] when call is no longer active.`);const e=xe.BHj.DismissBannerSuccess,s=`Dismiss banner command resolved successfully [eventId=${a}, entity.id=${h.id}]`,r=`[handleCallingBannerContentEvent] Error when reporting dismiss banner event "success" with [eventId=${a}, entity.id=${h.id},`,c=TU(a,e,s);yield _U(c,i,n,r)}catch(e){n.error(`Error in dismissing the banner when call is no longer active. entity.id: ${h.id}, entity.action: ${h.action}, error.name=${e.name}, error.message=${e.message}]`);const t="Unknown-dismiss-banner-error-name",s=`Unhandled exception while handling calling app events in job, failed to trigger shell.dimissBanner function, error in dismissing banner [eventId=${a}]`,o=xe.BHj.DismissBannerError,r=`[handleCallingBannerContentEvent] Error in handling calling banner content event due to failure of shell.dismissBanner with [eventId=${a},`,c=TU(a,o,`Error in dismissing banner through shell.dismissBanner [eventId=${a}]`,t,s);yield _U(c,i,n,r)}}))}(o,s,a,l,d,d.content,u,i);break;case"CallingLocalRecordingNotificationContent":!function(e,t,i){e.newLogger("handleCallingLocalRecordingNotificationEvent","apps-calling").log("Local recording notification event received",i.localRecordingNotificationType),t.toasts.showLocalRecordingAssemblyNotification(`${Date.now()}`,{title:i.title,text:i.text,time:new Date,type:"LocalRecordingAssembly",quickReply:!1,conversationId:""})}(o,s,d.content);break;case"CallingDialogContent":!function(e,t,i,a,s,o,r,c){(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.newLogger("handleCallingDialogContentEvent","apps-calling"),{id:l}=s,d=r.findScenarioByNameAndId(z.RG.CallingDialogOpen,l);d||n.error(`[getSetupAppEventsInnerJob] Cannot find calling_dialog_open scenario [dialogId: ${l}]`),null==d||d.mark(z.ck.CallingDialogCallingAppEventReceived);const u=wU(a,s,o);if(!u){const e="[getSetupAppEventsInnerJob] Dialog commanding error - no command to fire, command is undefined";return n.error(e),void(null==d||d.fail({errors:e,errorCode:"command-is-undefined"}))}const{entity:m,entityOptions:g,command:h}=u;if(!m.type){const e=`[getSetupAppEventsInnerJob] Dialog commanding error - no command to fire, entity type is undefined [entity.id: ${m.id}]`;return n.error(e),void(null==d||d.fail({errors:e,errorCode:"entity-type-is-undefined"}))}const{enableDialogWindow:p}=c.get(S.J.Calling);if(p){null==d||d.mark(z.ck.BeforeCallingDialogContainerCommandTriggered);try{i.call.dialogContainer({command:Object.assign(Object.assign({},h),{visibilityState:ve.fe.show}),viewOptions:{command:h,entity:m,options:g}})}catch(e){const t=`[getSetupAppEventsInnerJob] Dialog CONTAINER commanding error [entity.id: ${m.id}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`;n.error(t),null==d||d.fail({errors:t,errorCode:"dialog-container-commanding-error"})}null==d||d.mark(z.ck.AfterCallingDialogContainerCommandTriggered)}else{let e;null==d||d.mark(z.ck.BeforeCallingDialogEntityCommandTriggered);try{e=yield i.call.openDialog(m,h,g)}catch(e){const t=`[getSetupAppEventsInnerJob] Dialog ENTITY commanding error [entity.id: ${m.id}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`;return n.error(t),void(null==d||d.fail({errors:t,errorCode:"open-dialog-commanding-error"}))}null==d||d.mark(z.ck.AfterCallingDialogEntityCommandTriggered);const a=e.subscribe({next:({containerState:e})=>{switch(e){case ve.oq.Closed:t.mutate({mutation:jU,variables:{dialogId:s.id,actionName:"PostClose"}}),a.unsubscribe();break;case ve.oq.Open:null==d||d.stop({reason:`Dialog container opened [dialogId: ${l}]`})}}});null==d||d.mark(z.ck.SubscribedToDialogObservable)}n.log(`[getSetupAppEventsInnerJob] Dialog commanding success [entity.id: ${m.id}]`)}))}(o,a,s,d,d.content,u,r,i);break;case"CallingNotificationContent":!function(e,t,i,a,s,o,r,c,l,d,u){var m,g,h,p,v,f,b,y;(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.newLogger("handleCallingNotificationContentEvent","apps-calling");let k;const w=(0,qe.v4)(),{enableIncomingCallCrossClientTelemetry:j}=r.get(S.J.Calling);j&&i.callId&&i.crossClientScenarioName&&(k=c.findScenarioByNameAndId(i.crossClientScenarioName,i.callId)),k&&(null==k?void 0:k.isHoisted)||(k=c.newScenario(z.RG.CrossClientToastView),k.clientId=w,k.appendEventData({mainEntityType:pe.py.calls}),null===(m=c.hoistScenarioToCore)||void 0===m||m.call(c,k));const C=rU(i,r,w);if(C.entityOptions&&r.get(S.J.Notifications).enableToastCollections&&(C.entityOptions.collectionId=SU(d,u,n)),yield Promise.all([DU(i,o,C,n,k),FU(i,o,C,n,k)]),"CreateNotificationWithActions"===(null===(g=s.source)||void 0===g?void 0:g.name))if("Show"===a){k.mark(z.ck.CrossClientTriggerShowToast);try{!function(e,t,i,n){kU({eventId:t,resolution:e?{success:{_:!0}}:{error:{name:"Notification dropped",message:`Call Notification was not executed, notification might be dropped for expected reasons [eventId=${t}]`}},context:{source:{name:xe.BHj.CallingAppEventJobHandlerError,description:`Commading call notification [eventId=${t}] [notificationResult=${e}]`}}},i,n)}(yield t.call.callNotification(C,i.id,w,"Show"),l,o,n)}catch(e){k.fail({errorCode:Ki.f.SubscriptionFailed,reason:"Subscription failed on show"}),n.error(`${IU}${i.id}:[handleCallingNotificationContentEvent] Notification commanding error on [${null===(h=s.source)||void 0===h?void 0:h.name}] [[content.id: ${i.id}], entity.id: toasts, visibility: ${a.toString()}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}else{k.mark(z.ck.CrossClientTriggerHideToast);try{yield t.call.callNotification(C,i.id,w,"Hide")}catch(e){k.fail({errorCode:Ki.f.SubscriptionFailed,reason:"Subscription failed on hide"}),n.error(`${IU}${i.id}:[handleCallingNotificationContentEvent] Notification commanding error on [${null===(p=s.source)||void 0===p?void 0:p.name}] [[content.id: ${i.id}], entity.id: toasts, visibility: ${a.toString()}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}else{if("UpdateNotification"!==(null===(v=s.source)||void 0===v?void 0:v.name))return k.fail({errorCode:Ki.f.SubscriptionFailed,reason:`Invalid context.source.name [${null===(b=s.source)||void 0===b?void 0:b.name}]`}),void n.error(`${IU}${i.id}:[handleCallingNotificationContentEvent] Notification commanding error invalid context.source.name [${null===(y=s.source)||void 0===y?void 0:y.name}] [[content.id: ${i.id}], entity.id: toasts, visibility: ${a.toString()}`);k.mark(z.ck.CrossClientTriggerUpdateToast);try{yield t.call.callNotification(C,i.id,w,"Show")}catch(e){k.fail({errorCode:Ki.f.SubscriptionFailed,reason:"Subscription failed on update"}),n.error(`${IU}${i.id}:[handleCallingNotificationContentEvent] Notification commanding error on [${null===(f=s.source)||void 0===f?void 0:f.name}] [[content.id: ${i.id}], entity.id: toasts, visibility: ${a.toString()}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}k.mark(z.ck.CrossClientEntityCommandTriggered),n.log(`${IU}${i.id}:[handleCallingNotificationContentEvent] Notification commanding success [content.id: ${i.id}][entity.id: toasts][visibility: ${a.toString()}]`)}))}(o,s,d.content,d.action.visibility,u,a,i,r,l,e,c)}}));function FU(e,t,i,a,s){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const o=yield function(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield e.query({query:vU,fetchPolicy:"network-only"});return i?i.data.priorityContacts.map((e=>e.id)):(t.error(`${IU}[handleCallingNotificationContentEvent] Failed to fetch priority contacts`),[])}catch(e){return t.error(`${IU}[handleCallingNotificationContentEvent] Failed to fetch priority contacts`),[]}}))}(t,a);i.entityOptions.isUrgent=o.includes(e.userid),s.mark(z.ck.PriorityContactsFetched)}catch(t){a.error(`${IU}${e.id}:[handleCallingNotificationContentEvent] Error when fetching priority contacts. Error: ${t}`)}}))}function xU(e,t,i,a,s){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield e.query({query:pU,variables:{userId:t,displayName:i,profilePictureSize:"HR96x96"}});if(!n)return void s.error(`${IU}${a}:[handleCallingNotificationContentEvent] Failed to generate avatar image url`);const o=yield e.query({query:fU,variables:{url:n.data.msaUserProfilePicture}});return(null==o?void 0:o.data.toastImageAsDataUri)||void 0}catch(e){return void s.error(`${IU}${a}:[handleCallingNotificationContentEvent] failed to fetch avatar image. Error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}`)}}))}function DU(e,t,i,a,s){var o,r,c,l,d,u;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{let n,m;e.userid&&(null===(o=i.entityOptions)||void 0===o?void 0:o.mainImage)?n=xU(t,e.userid,e.title,e.id,a):a.log("[handleCallingNotificationContentEvent] Primary avatar not fetched, user id or main image property is not present on the content."),(null===(r=e.header)||void 0===r?void 0:r.mri)&&(null===(c=i.entityOptions)||void 0===c?void 0:c.headerImage)&&(m=xU(t,e.header.mri,e.header.subtitle,e.id,a));const[g,h]=yield Promise.all([n,m]);g&&(i.entityOptions.mainImage={src:g,alt:null!==(l=e.title)&&void 0!==l?l:""},s.mark(z.ck.CrossClientAvatarFetched)),h&&(i.entityOptions.headerImage={src:h,alt:null!==(u=null===(d=e.header)||void 0===d?void 0:d.subtitle)&&void 0!==u?u:""})}catch(e){a.error(`[handleCallingNotificationContentEvent] failed handle avatar fetches. Error: ${e}`)}}))}var AU=i(483416);const MU={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingSetCallStatePresenceMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingClientState"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingClientStatePresence"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setCallStatePresence"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingClientState"},value:{kind:"Variable",name:{kind:"Name",value:"callingClientState"}}}]}]}}]},PU={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"callingClientStateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingClientStateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingClientStateEvent"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingClientStateEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingClientStateEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"inCall"}},{kind:"Field",name:{kind:"Name",value:"isScreenSharing"}}]}}]}.definitions]},OU={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateClientStateVeryActive"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isVeryActive"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UpdateClientStateSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateClientStateVeryActive"},arguments:[{kind:"Argument",name:{kind:"Name",value:"isVeryActive"},value:{kind:"Variable",name:{kind:"Name",value:"isVeryActive"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}]}]}}]},RU=(e,t)=>()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const i=t.newLogger("getCallingClientEventsJob","apps-calling");e.subscribe({query:PU,fetchPolicy:"no-cache"}).subscribe((({data:a,errors:s})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(s){const e=s.map((e=>e.message));i.error(`handleCallingClientStateEvent: Error receiving callingClientStateEvent [Errors: ${e.join()}]`)}else a&&(i.log(`handleCallingClientStateEvent: Processing callingClientStateEvent [Received: ${(0,U.u4)(a)}]`),function(e,t,i){(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.newLogger("handleCallingClientStateEvent","apps-calling");n.log(`Event received: ${(0,U.u4)(t)}`);try{yield i.mutate({mutation:OU,variables:{isVeryActive:t.inCall||t.isScreenSharing,source:xe.HRk.Calling}})}catch(e){n.error(`mutation updateClientStateVeryActiveDocument error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}))}(t,a.callingClientStateEvent,e),a.callingClientStateEvent.inCall&&a.callingClientStateEvent.isScreenSharing?(LU(t,xe.TWj.Presenting,e),UU(xe.rsL.ScreenSharing,e)):a.callingClientStateEvent.inCall?(LU(t,xe.TWj.InACall,e),UU(xe.rsL.InCall,e)):(LU(t,xe.TWj.NotInACall,e),UU(xe.rsL.None,e)))}))))}));function LU(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=e.newLogger("setCallingClientStatePresence","apps-calling");n.log(`Call state presence received: ${t}`);try{yield i.mutate({mutation:MU,variables:{callingClientState:t}})}catch(e){n.error(`mutation AppsCallingSetCallStatePresenceMutationDocument error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}))}function UU(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){yield t.mutate({mutation:AU.b,variables:{newState:e},fetchPolicy:"no-cache"})}))}var $U=i(647995),WU=i(832441);function BU(e,t,i,a,s){const o=i.newLogger("emergency-location-notification-job-logger","apps-shell");return{id:"emergency-location-notification",job:()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=a.stringTranslate(S.J.Calling,"emergency_manage_location_button_text"),n=e.subscribe({query:$U.x}).subscribe((({data:e})=>{if((0,WU.uF)(null==e?void 0:e.emergencyAddressUpdatedEvent)){const n=((e,t)=>{const i=e.stringTranslate(S.J.Calling,"emergency_location_needs_confirmation_banner_text"),n=e.stringTranslate(S.J.Calling,"emergency_location_not_detected_banner_text");return(null==t?void 0:t.type)===xe.LQ7.CLS?i:!t||t.editable&&t.type===xe.LQ7.None?n:""})(a,null==e?void 0:e.emergencyAddressUpdatedEvent);!function(e,t,i){i.shell.showBanner({id:"E911LocationBanner",source:k.D.ShellE911LocationChange,bannerScenario:"emergency_location_banner",intentLevel:xe.XuV.Severe,cause:xe.lFB.EmergencyLocationBanner,text:e,action:{text:t,command:{entity:{type:pe.py.locationnotificationbanner,action:pe.uk.view},command:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:k.D.ShellE911LocationChange}}},dismissOnAction:!0},dismissable:!0,duration:0})}(n,i,t)}else t.shell.dismissBanner("E911LocationBanner",k.D.ShellE911LocationChange);s&&s()}));return()=>{n.unsubscribe(),o.log("[location] unsubscribing ...")}}))}}const zU=(e,t,i,n,a,s,o,r,c)=>{const{enableCallingStackInitialization:l,enableCallingClientEvents:d,enableCallingAppEvents:u,enableEmergencyLocationGlobalBanner:m}=a.get(S.J.Calling),g=[];if(l){const t=HU(n,z.RG.StandupCallingAppJob,s);g.push(iU(e,i,s,n,a)),t.mark(z.ck.JobAdded),t.stop()}return u&&g.push(((e,t,i,n,a,s,o,r)=>({id:"setup-calling-app-events",runOncePerId:!0,job:NU(e,t,i,n,a,s,o,r)}))(e,t,i,a,n,s,c,r)),d&&g.push(((e,t)=>({id:"calling-client-events",runOncePerId:!0,job:RU(e,t)}))(e,i)),m&&o&&g.push(BU(e,t,i,o)),g},HU=(e,t,i)=>{let n=e.findScenario(t);return n||(n=e.newScenario(t)),n.mark(i),n},qU=({context:{authenticationUser:e,client:t,coreSettings:i,entityCommanding:n,i18n:a,loggerFactory:s,scenarioFactory:o,userTrackingService:r}})=>zU(t,n,s,o,i,z.ck.OnAppPreWarm,a,r,e),VU=({context:{client:e,coreSettings:t,entityCommanding:i,loggerFactory:n,scenarioFactory:a}})=>zU(e,i,n,a,t,z.ck.OnAppPreInit);var GU=i(405501);const JU=e=>"tel:"===e||"callto:"===e,KU={filter:({protocol:e})=>JU(e),execute:({deeplinkUrl:{pathname:e,protocol:t},context:{coreSettings:i,loggerFactory:a}})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n,s;const o=a.newLogger("[Calling][OnBeforeDeeplinkParsed][CallingProtocol]","apps-calling"),{enableCallWithUsersDeeplink:r}=i.get(S.J.Calling);if(!r||!JU(t)){const e=`enableCallWithUsersDeeplink=${r} or protocol=${t} is not supported`;throw null===(n=o.warnToTelemetry)||void 0===n||n.call(o,e,"calling_protocol_deeplink_condition",void 0,!0),new Error(e)}null===(s=o.infoToTelemetry)||void 0===s||s.call(o,`Returning calling protocol dialog intent for protocol=${t}`,"calling_protocol_deeplink_condition",void 0,!0),e=decodeURIComponent(e);const c=(0,GU.TE)(e);return{entityCommand:{entity:{type:pe.py.callingprotocoldeeplinkdialog,action:pe.uk.create},command:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,layoutMode:ve.lO.standard},entityOptions:{protocol:t,target:e,isPSTNNumber:c}},metadata:{allowAnonymous:!1}}}))};var QU,YU=i(428957);!function(e){e.EmptyDeeplinkUrl="empty-deeplink-url-received",e.MeetingCodeParse="meeting-code-parse-error",e.LegacyCoordinatesParse="legacy-coordinates-parse-error",e.EmptyContext="empty-context-received",e.EmptyParsedUrlParams="empty-parsed-url-params",e.None="no-entity-command-expected",e.PresentDeepLinkT2Disabled="present-deeplink-t2-disabled",e.EmptySearch="empty-search-url",e.MeetingShareDeepLinkT2Disabled="meeting-share-deeplink-t2-disabled"}(QU||(QU={}));const XU=e=>({visibilityState:ve.fe.show,stateTransition:e?ve.su.flush:ve.su.new,layoutMode:e?ve.lO.standard:ve.lO.focus}),ZU=(e,t)=>{if("null"!==e)return e;const i=t.get("fqdn");return i?`https://${i}`:void 0},e$=(e,t)=>t.get("fqdn")||(0,YU.uO)(e),t$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingHandlePresentDeeplinkMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ver"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"deeplinkId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pptContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"handlePresentDeepLink"},arguments:[{kind:"Argument",name:{kind:"Name",value:"ver"},value:{kind:"Variable",name:{kind:"Name",value:"ver"}}},{kind:"Argument",name:{kind:"Name",value:"deeplinkId"},value:{kind:"Variable",name:{kind:"Name",value:"deeplinkId"}}},{kind:"Argument",name:{kind:"Name",value:"pptContext"},value:{kind:"Variable",name:{kind:"Name",value:"pptContext"}}}]}]}}]},i$={filter:"/l/present",execute:({deeplinkUrl:{search:e},context:{coreSettings:t,loggerFactory:i,__doNotUse_globalDataClient:a}})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n;const{enablePresentDeepLinkForMTMA:s}=t.get(S.J.Calling),o=i.newLogger("[Calling][onBeforeDeeplinkParsed][/present]","apps-calling");if(o.log(`EnablePresentToTeamsT2: ${s}. Parsing search length: ${e.length}`),!s)return Promise.reject({message:QU.PresentDeepLinkT2Disabled});if(""===e)return Promise.reject({message:QU.EmptySearch});const r=new URLSearchParams(e),c=r.get("ver"),l=r.get("deeplinkId"),d=r.get("pptContext");if(o.log(`Parsed params ver: ${c}, deeplinkId: ${l}`),!c||!l||!d)return Promise.reject({message:QU.EmptyParsedUrlParams});let u;try{u=yield a.mutate({mutation:t$,variables:{ver:c,deeplinkId:l,pptContext:d}})}catch(e){throw null===(n=o.errorToTelemetry)||void 0===n||n.call(o,e.message,"cmd_meetings_pptsharing_handle_present_deeplink_mutation_error"),new Error(e.message)}return u&&u.data&&!u.data.handlePresentDeepLink?Promise.resolve({entityCommand:{entity:{type:pe.py.presentdeeplinknomeetingcontextdialog,action:pe.uk.create},command:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,layoutMode:ve.lO.standard}},metadata:{allowAnonymous:!1}}):void 0}))},n$={filter:"/convene/events",execute:({deeplinkUrl:{pathname:e,search:t,origin:i},context:{coreSettings:n,loggerFactory:a}})=>{var s;const o=a.newLogger("[Calling][onBeforeDeeplinkParsed][events]","apps-calling"),{allowAnonymousMeetingJoin:r,defaultAnonTenantId:c}=n.get(S.J.Calling);if(o.log(`Parsing pathname: ${e}, search: ${t}, allowAnonymousMeetingJoin: ${r}`),!e)return Promise.reject({message:QU.EmptyDeeplinkUrl});if(!e.startsWith("/convene/events"))return Promise.reject({message:QU.MeetingCodeParse});const l=new URLSearchParams(t);l.set("anon","true");const d=`${i}/_#${e}?${l.toString()}`,u=l.get("url");if(!u)return Promise.reject({message:QU.MeetingCodeParse});const m=new URL(u),g=null!==(s=m.pathname.split("/").find((e=>e.startsWith("19:"))))&&void 0!==s?s:"",h=m.searchParams.get("context");if(!h)return Promise.reject({message:QU.MeetingCodeParse});const{Tid:p,Oid:v,prid:f}=JSON.parse(h),b=m.searchParams.get("displayName");return Promise.resolve({entityCommand:{entity:{type:pe.py.events,action:pe.uk.join,id:"embed"},command:{visibilityState:ve.fe.show,stateTransition:ve.su.none,layoutMode:ve.lO.standard,correlation:{id:Ve()(),startTimestamp:Date.now(),source:k.D.CallingOnBeforeDeeplinkParsed}},entityOptions:{embedUrl:d,meetingUrl:u,threadId:g,messageId:"0",tenantId:p,organizerId:v,registrationId:f,displayName:b}},metadata:{allowAnonymous:r||!1,tenantId:c||void 0}})}},a$=e=>{const[,,t,i]=e.pathname.split("/"),{users:n,withVideo:a}=(({searchParams:e})=>{const t=(e.get("users")||"").trim(),i="true"===(e.get("withVideo")||"").toLocaleLowerCase();if(0===t.length)return{users:[],withVideo:i};const n=t.split(",").filter(Boolean).map((e=>e.toLocaleLowerCase()));return{users:[...new Set(n)],withVideo:i}})(e);return{type:t,containerId:i,users:n,withVideo:a}},s$=e=>{const{type:t,containerId:i,users:n}=a$(e);return"call"===t&&"0"===i&&n.length>0},o$={filter:e=>s$(e),execute:({deeplinkUrl:e,context:{coreSettings:t,loggerFactory:i}})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n,a;const s=i.newLogger("[Calling][OnBeforeDeeplinkParsed][CallingDeeplink]","apps-calling"),{enableCallingDeeplink:o}=t.get(S.J.Calling),{type:r,containerId:c,users:l,withVideo:d}=a$(e),u=JSON.stringify({type:r,containerId:c,usersCount:l.length});if(!o||!s$(e)){const e=`Skip rendering deeplink dialog: enableCallingDeeplink=${o}, infoFromUrl=${u}`;throw null===(n=s.warnToTelemetry)||void 0===n||n.call(s,e,"calling_deeplink_navigation",void 0,!0),new Error(e)}return null===(a=s.infoToTelemetry)||void 0===a||a.call(s,`Render deeplink dialog: infoFromUrl=${u}`,"calling_deeplink_navigation",void 0,!0),{entityCommand:{entity:{type:pe.py.callingdeeplinkDialog,action:pe.uk.create},command:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,layoutMode:ve.lO.standard},entityOptions:{users:l,withVideo:d}},metadata:{allowAnonymous:!1}}}))},r$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingHandleMeetingShareDeeplinkMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"deeplinkId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"handleShareDeeplinkToStage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"deeplinkId"},value:{kind:"Variable",name:{kind:"Name",value:"deeplinkId"}}},{kind:"Argument",name:{kind:"Name",value:"appContext"},value:{kind:"Variable",name:{kind:"Name",value:"appContext"}}}]}]}}]},c$={filter:"/l/meeting-share",execute:({deeplinkUrl:{search:e},context:{coreSettings:t,loggerFactory:i,getUserContexts:a}})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n,s;const{enableDeepLinkShareExtensibleApp:o}=t.get(S.J.Calling),r=i.newLogger("[Calling][onBeforeDeeplinkParsed][/meeting-share]","apps-calling");r.log(`enableDeepLinkShareExtensibleAppT2: ${o}. Parsing search length: ${e.length}`);const c=yield a(),l=c[c.length-1].context.client;if(!o)return Promise.reject({message:QU.MeetingShareDeepLinkT2Disabled});if(""===e)return Promise.reject({message:QU.EmptyParsedUrlParams});const d=new URLSearchParams(e),u=d.get("deeplinkId"),m=d.get("appContext");if(r.log(`Parsed params - deeplinkId: ${u}`),!u||!m)return null===(n=r.errorToTelemetry)||void 0===n||n.call(r,`Empty Params for either deeplinkId or AppContext -deeplinkId: ${u}`,"cmd_meetings_appsharing_handle_meetingshare_deeplink"),Promise.reject({message:QU.EmptyParsedUrlParams});let g;try{g=yield l.mutate({mutation:r$,variables:{deeplinkId:u,appContext:m}})}catch(e){throw null===(s=r.errorToTelemetry)||void 0===s||s.call(r,e.message,"cmd_meetings_appsharing_handle_meetingshare_deeplink"),new Error(e.message)}return g&&g.data&&!g.data.handleShareDeeplinkToStage?Promise.resolve({entityCommand:{entity:{type:pe.py.presentdeeplinknomeetingcontextdialog,action:pe.uk.create},command:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,layoutMode:ve.lO.standard}},metadata:{allowAnonymous:!1}}):void 0}))},l$=[KU,{filter:e=>{if(!e.pathname.includes("/l/meetup-join"))return!1;const t=new URLSearchParams(e.search).get("context");if(!t)return!1;try{const{IsBroadcastMeeting:e}=JSON.parse(t);return!e}catch(e){return!1}},execute:({deeplinkUrl:e,context:{coreSettings:t,loggerFactory:i},homeCloud:n})=>{const a=decodeURIComponent(e.href),s=new URL(a),{pathname:o,search:r,origin:c}=s,l=i.newLogger("[Calling][onBeforeDeeplinkParsed][/l/meetup-join]","apps-calling"),{allowAnonymousMeetingJoin:d,enableDeeplinkFlushCommand:u}=t.get(S.J.Calling);if(l.log(`Parsing pathname: ${o}, search: ${r}, allowAnonymousMeetingJoin: ${d}`),!o)return Promise.reject({message:QU.EmptyDeeplinkUrl});const m=o.split(/[/?&]/),g=m.indexOf("meetup-join")+1,h=m[g],p=m[g+1],v=new URLSearchParams(r);v.set("anon","true");const f=v.get("context");if(!f)return Promise.reject({message:QU.EmptyContext});const b=v.get("pp"),{Tid:y,Oid:k,MessageId:w,prid:j,isPublic:C}=JSON.parse(f);if(!(h&&p&&y&&k)){const e=`${h?"":"empty-conversationId"} ${p?"":"empty-rootMessageId"} ${y?"":"empty-tenantId"} ${k?"":"empty-organizerId"}`;return Promise.reject({message:QU.LegacyCoordinatesParse,reason:e})}let _;const T=ZU(c,v);T&&(_=`${T}/_#${o}?${v.toString()}`);const I={joinType:xe.cku.Legacy,conversationId:h,messageId:w||p,rootMessageId:p,isChannel:"0"!==p,isAdhoc:!1,tenantId:y,organizerId:k,meetingCloud:e$(c,v),participantPin:b,registration:j?{participantRegistrationId:j,isPublicEvent:C||!1}:null};return l.log(`Resolving ${JSON.stringify(I)}`),Promise.resolve({entityCommand:{entity:{type:pe.py.callingdeeplink,action:pe.uk.join,id:`${h}/${p}`},command:XU(!!u),entityOptions:{deeplinkUrl:o,coordinates:I,directMeetingLink:_,homeCloud:n,deeplinkId:v.get("deeplinkId")}},metadata:{allowAnonymous:d||!1,tenantId:y}})}},{filter:({pathname:e})=>e.includes("/meet/"),execute:({deeplinkUrl:{pathname:e,search:t,origin:i},context:{coreSettings:n,loggerFactory:a},homeCloud:s})=>{const o=a.newLogger("[Calling][onBeforeDeeplinkParsed][/meet]","apps-calling"),{allowAnonymousMeetingJoin:r,defaultAnonTenantId:c,doNotPassTenantIdForAnonMeetingJoins:l,enableDeeplinkFlushCommand:d}=n.get(S.J.Calling),{enableXboxWatchparties:u}=n.get(S.J.WindowsSignatureExperiences);if(o.log(`Parsing pathname: ${e}, search: ${t}, allowAnonymousMeetingJoin: ${r}`),!e)return Promise.reject({message:QU.EmptyDeeplinkUrl});const m=e.split(/[/?&]/),g=m.indexOf("meet"),h=m[g+1];if(!h||-1===g)return Promise.reject({message:QU.MeetingCodeParse});const p=new URLSearchParams(t);let v,f;p.set("anon","true");const b=ZU(i,p);return b&&(v=`${b}/_#${e}?${p.toString()}`,f=`${b}${e}${t}`),o.log(`Resolving ${h}`),Promise.resolve({entityCommand:{entity:{type:pe.py.callingdeeplink,action:pe.uk.join,id:h},command:XU(!!d),entityOptions:{deeplinkUrl:e,coordinates:{joinType:xe.cku.MeetingData,meetingData:{meetingCode:h,passcode:p.get("p"),meetingUrl:f},participantPin:p.get("pp"),isAdhoc:!1,meetingCloud:e$(i,p)},directMeetingLink:v,homeCloud:s,deeplinkId:p.get("deeplinkId"),isWatchParty:"true"===p.get("isWatchParty")&&u}},metadata:{allowAnonymous:r||!1,tenantId:l?void 0:c||void 0}})}},i$,n$,o$,c$],d$={shouldAddEntitiesToWindowHistory:e=>{var t,i;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==pe.py.callingdeeplink&&(null===(i=e.mainEntity)||void 0===i?void 0:i.type)!==pe.py.calls},shouldRestoreClientToEntities:e=>{var t,i;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==pe.py.callingdeeplink&&(null===(i=e.mainEntity)||void 0===i?void 0:i.type)!==pe.py.calls}};var u$=i(727523);const m$="entitymoreinfo",g$="requestPersonMoreInfo",h$="requestTopicMoreInfo",p$=e=>({actor:m$,action:g$,data:e}),v$=e=>({actor:m$,action:h$,data:e}),f$={onEventReceived:({eventInput:e})=>{var t,i,n,a;switch(e.event.type){case u$.uS.requestPersonMoreInfo:const s=null===(i=(t=e.event).data)||void 0===i?void 0:i.call(t);return Promise.resolve({command:p$(s)});case Ce.uS.showMonitor:return Promise.resolve({command:Te.CN.showMonitor(null===(a=(n=e.event).data)||void 0===a?void 0:a.call(n))});case Ce.uS.closeMonitor:return Promise.resolve({command:Te.CN.closeMonitor()});case Ce.uS.hideMonitor:return Promise.resolve({command:Te.CN.hideMonitor()});case Ce.uS.unhideMonitor:return Promise.resolve({command:Te.CN.unhideMonitor()})}return Promise.resolve(void 0)}};var b$=i(916553),y$=i(282088);const k$=({appRenderMode:e,coreSettings:t})=>{const i=new b$.H,{criticalPhaseTimeout:n}=t.get(S.J.Calling);return e!==Wt.S.Main||i.registerAppPhase({phase:De.nh.CRITICAL,signals:[y$.G.CALLING_SCREEN_RENDERED],timeout:n||9e4}),i.appPhases};var S$=i(56981);const w$=e=>{if(j$(e))return _$(e)?{subNavEntity:T$(e),headerEntity:I$(e),startEntity:N$(e),mainEntity:E$(e),endEntity:F$(e)}:null},j$=({layoutMode:e,entity:t,contextEntity:i})=>{const{action:n=null,type:a}=Object.assign({},t),s=[ve.lO.focus,ve.lO.standard].includes(e),o=[pe.py.callingdeeplink,pe.py.calls,pe.py.callsmonitor,pe.py.meetings,pe.py.events,pe.py.meetingroomallinonecall,pe.py.yammerqna].includes(a),r=[pe.uk.create,pe.uk.default,pe.uk.list,pe.uk.view,pe.uk.join],c=n&&r.includes(n)||a===pe.py.callingdeeplink&&!n&&!!i;return!!(s&&o&&c)},C$=[pe.py.identity,pe.py.tflfre],_$=({contextEntity:e})=>!e||!C$.includes(e.type),T$=()=>null,I$=({entity:e,contextEntity:t})=>e.type===pe.py.callingdeeplink?t||null:e,N$=()=>null,E$=({entity:e,contextEntity:t})=>e.type===pe.py.callingdeeplink&&(null==t?void 0:t.type)===pe.py.calls?t:e,F$=({contextEntity:e})=>e&&e.action&&(e.type===pe.py.byodchat||e.type===pe.py.chats||e.type===pe.py.devicesettings||e.type===pe.py.meetings||e.type===pe.py.extensions||e.type===pe.py.transcript||e.type===pe.py.meetingdetails||e.type===pe.py.roster||e.type===pe.py.byodroster||e.type===pe.py.breakoutroomspanel||e.type===pe.py.yammerqna||e.type===pe.py.accessibilitypanel||e.type===pe.py.meetingcollaboration||e.type===pe.py.closedcaptionssettings||e.type===pe.py.videobackgrounds||e.type===pe.py.extensibilityapppickercallingpanel||e.type===pe.py.roomremote)||(null==e?void 0:e.action)===pe.uk.info&&(null==e?void 0:e.type)===pe.py.calls||(null==e?void 0:e.action)===pe.uk.health&&(null==e?void 0:e.type)===pe.py.calls?e:null,x$=({entity:e,coreSettings:t,themeOptions:i})=>{var n;const{enableLightThemeSupport:a=!1,forceDisableTitleBar:s=!1,renderHeaderAtBottomForCalls:o=!1,enableSmartDeviceLayout:r=!1,monitorSlotPosition:c=S$.Y.BottomRight}=null!==(n=null==t?void 0:t.get(S.J.Calling))&&void 0!==n?n:{},l=new Set([pe.py.calls,pe.py.meetingroomallinonecall]),d=null==i?void 0:i.isCallingWindowDarkTheme;return(null==e?void 0:e.type)===pe.py.callsmonitor||(null==e?void 0:e.type)===pe.py.callingdialog?{[xe.tF7.mainEntity]:{[Wt.S.Main]:{disableNotificationsBanners:!0,forceDisableTitleBar:!!s,doesHeaderOverlapMain:!1,isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!a||d,UNSAFE_enablePptProvider:!0}},[xe.tF7.headerEntity]:{[Wt.S.HorizontalBar]:{slotHeightOverrides:"5.4rem",doesHeaderOverlapMain:!1,isBackgroundTransparent:!0}}}:{[xe.tF7.mainEntity]:{[Wt.S.Main]:{forceDisableTitleBar:!!s,doesHeaderOverlapMain:!1,isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!a||d,canOverrideMeetingTheme:!1,UNSAFE_enablePptProvider:!0}},[xe.tF7.headerEntity]:{[Wt.S.HorizontalBar]:{slotHeightOverrides:"auto",doesHeaderOverlapMain:!1,isBackgroundTransparent:!1,renderHeaderAtBottom:!(!o&&!r||void 0===(null==e?void 0:e.type)||!l.has(e.type))}},[xe.tF7.endEntity]:{[Wt.S.Rail]:{doesHeaderOverlapMain:(null==e?void 0:e.type)===pe.py.videobackgrounds,isBackgroundTransparent:!!e&&D$.includes(e.type)}},[xe.tF7.monitorEntity]:{[Wt.S.Monitor]:{areaRectangle:{height:"auto",position:c,width:"32rem"},draggableAreaHeight:"3.2rem"}}}},D$=[pe.py.videobackgrounds,pe.py.videoeffectsandavatar,pe.py.videoeffectscustomization,pe.py.videoeffectsmoreview,pe.py.stylemyroom],A$={id:"com.microsoft.teams.calling",name:"Calls",supportedEntities:[pe.py.callingdeeplink,pe.py.callingdeeplinkDialog,pe.py.callingprotocoldeeplinkdialog,pe.py.calls,pe.py.callscontent,pe.py.callsgallery,pe.py.callsgalleryandcontent,pe.py.meetingroomallinonecall,pe.py.callsmonitor,pe.py.cameraeffects,pe.py.contentcamerasetup,pe.py.callingalertdialog,pe.py.callingdialog,pe.py.callingbannernotification,pe.py.callingconfirmdialog,pe.py.unparkcalldialog,pe.py.usermediadialog,pe.py.devicesettings,pe.py.notes,pe.py.mediastreams,pe.py.meetingdetails,pe.py.meetings,pe.py.meetingstream,pe.py.roster,pe.py.pstncallmedialog,pe.py.videobackgrounds,pe.py.stylemyroom,pe.py.broadcastqna,pe.py.transcript,pe.py.shareMeetingInfo,pe.py.stagecontent,pe.py.breakoutroomspanel,pe.py.invisionwhiteboard,pe.py.videoeffectscustomization,pe.py.videoeffectsmoreview,pe.py.videoeffectsandavatar,pe.py.windowingerrordialog,pe.py.restartrecomendeddialog,pe.py.stagingroomstartmeetingconfirmationdialog,pe.py.meshavatar,pe.py.events,pe.py.yammerqna,pe.py.roomremote,pe.py.accessibilitypanel,pe.py.closedcaptionssettings,pe.py.meetingcollaboration,pe.py.presentdeeplinknomeetingcontextdialog,pe.py.floatingmonitor,pe.py.byodattendeewindow,pe.py.byodroster,pe.py.extensibilityapppickercallingpanel],supportedRenderModes:[Wt.S.HorizontalBar,Wt.S.Main,Wt.S.Modal,Wt.S.Rail,Wt.S.Monitor],windowFeatures:{otherEntityTypes:{minWidth:800,width:800,minHeight:670,height:600},[pe.py.callingdialog]:{width:700,height:400,top:300,left:400,additionalFeatures:{alwaysOnTop:"true",resizable:"false",transparent:"true"}},[pe.py.callsmonitor]:{height:247,width:304,additionalFeatures:{alwaysOnTop:"true",resizable:"false",fullscreenable:"false",maximizable:"false",closable:"false",hideWindowControl:"true",frame:"false",contentprotection:"true",excludeWindowFromScreenSharing:"true",closeoverride:"true"}},[pe.py.byodattendeewindow]:{minWidth:800,width:800,minHeight:600,height:600}},shouldErrorOnEntityCommandTimeout:!0},M$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"triggerCallingToastAction"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"notificationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerCallingToastAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"notificationId"},value:{kind:"Variable",name:{kind:"Name",value:"notificationId"}}},{kind:"Argument",name:{kind:"Name",value:"actionType"},value:{kind:"Variable",name:{kind:"Name",value:"actionType"}}}]}]}}]},P$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"fireCallingIntent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fireCallingIntent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntent"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},O$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingMoveUpcomingMeetingToPastMeetingsMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"moveUpcomingMeetingToPastMeetings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}]}]}}]};var R$=i(412183),L$=i(923975);const U$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingTriggerBannerActionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bannerId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BannerAction"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerBannerAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"bannerId"},value:{kind:"Variable",name:{kind:"Name",value:"bannerId"}}},{kind:"Argument",name:{kind:"Name",value:"actionName"},value:{kind:"Variable",name:{kind:"Name",value:"actionName"}}}]}]}}]},$$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCallingBroadcastRoleQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"roleHint"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"joinId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"broadcast"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"roleHint"},value:{kind:"Variable",name:{kind:"Name",value:"roleHint"}}},{kind:"Argument",name:{kind:"Name",value:"joinId"},value:{kind:"Variable",name:{kind:"Name",value:"joinId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"userRole"}},{kind:"Field",name:{kind:"Name",value:"byoe"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"streamResource"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"encoderSource"}}]}}]}}]}}]};var W$=i(755083);const B$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCallingCallByCallIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamsCallIdByCallId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callId"},value:{kind:"Variable",name:{kind:"Name",value:"callId"}}}]}]}}]},z$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCallingCallMeetingInfoQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callMeetingInfo"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"messageId"}}]}}]}}]},H$=(e,t,i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var s;if(!t.entityOptions){const e="[handleDeeplink] No entity options";return a.error(e),Promise.reject(e)}const{coordinates:o,roleHint:r}=t.entityOptions,{tenantId:c,organizerId:l,conversationId:d,messageId:u,broadcast:m}=o,g=`${c}__${l}__${d}__${u}`,h=yield((e,t,i,a,s,o)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=e.newScenario(z.RG.BroadcastResolveRole);n.appendEventData({correlationId:s});try{const{data:e}=yield t.query({query:$$,variables:{id:i,roleHint:a,joinId:s}});return o.log(`[getBroadcastRole] userRole: ${e.broadcast.userRole}`),n.stop({"Call.BroadcastRole":e.broadcast.userRole}),o.log(`[getBroadcastDetails] userRole: ${e.broadcast.userRole}`),n.stop({"Call.BroadcastRole":e.broadcast.userRole}),e.broadcast}catch(e){return o.log("[getBroadcastRole] error: broadcastRoleQuery failed"),n.fail({"Call.BroadcastRole":null,broadcastError:"broadcastRoleQuery failed"}),{userRole:xe.tf6.None,streamResource:null,byoe:null}}})))(e.scenarioFactory,i,g,r,t.command.correlation.id,a),p=(null==m?void 0:m.role)||h.userRole;return q$(h,p,e)?(null===(s=a.infoToTelemetry)||void 0===s||s.call(a,`[handleBroadcastMeetingRedirect] launch launchUnsupportedDeeplink with userRole - ${p} and correlationId ${t.command.correlation.id} succeeded`,"cmd_meetings_virtual_events_broadcast_trigger_unsupported_deeplink_dialog_success"),Object.assign(Object.assign({},t),{entity:Object.assign(Object.assign({},t.entity),{type:pe.py.unsupporteddeeplinkdialog,action:pe.uk.view}),command:Object.assign(Object.assign({},t.command),{layoutMode:ve.lO.standard,stateTransition:ve.su.extend,visibilityState:ve.fe.show})})):p===xe.tf6.Contributor?(t.entityOptions=Object.assign(Object.assign({},t.entityOptions),{coordinates:Object.assign(Object.assign({},o),{broadcast:{role:p}})}),V$(e,t,a)):Object.assign(Object.assign({},t),{entity:Object.assign(Object.assign({},t.entity),{id:g,type:pe.py.broadcasts,action:pe.uk.view}),command:Object.assign(Object.assign({},t.command),{visibilityState:ve.fe.show,stateTransition:ve.su.new,layoutMode:ve.lO.focus}),entityOptions:Object.assign(Object.assign({},t.entityOptions),{threadId:d,messageId:u,tenantId:c,organizerId:l})})})),q$=(e,t,i)=>{var n,a,s,o,r;return t===xe.tf6.Producer||t===xe.tf6.Contributor&&(null===(n=i.platformService)||void 0===n?void 0:n.config.clientType)===Ps.Bh.Web||!!(null===(a=e.byoe)||void 0===a?void 0:a.isEnabled)&&null===(null===(s=e.streamResource)||void 0===s?void 0:s.encoderSource)||t!==xe.tf6.Contributor&&!!(null===(o=e.byoe)||void 0===o?void 0:o.isEnabled)&&"teams"===(null===(r=e.streamResource)||void 0===r?void 0:r.encoderSource)},V$=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{coordinates:n}=t.entityOptions,a=bU.getDeeplinkEntityLocked();if(a||!a&&bU.getCallingAppEventsSubscribed())return bU.getDeeplinkReady()&&(i.log("[handleDeeplink] awaiting getDeeplinkReady"),yield bU.getDeeplinkReady()),G$(e,t,i);const{conversationId:s,rootMessageId:o}=n,r=`${s}/${o}`;if(!r){const e="[handleDeeplink] Deeplink entity cannot be locked because lockId is undefined";return i.error(e),Promise.reject(e)}return i.log("[handleDeeplink] lockDeeplinkEntity"),bU.lockDeeplinkEntity(r),t})),G$=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=t.entityOptions,{coordinates:a,deeplinkId:s}=n,o=(0,L$.sM)(a,s);return i.log("[handleDeeplink] triggering fireCallingIntent mutation"),e.client.mutate({mutation:P$,variables:{callingIntent:o}}).then((()=>{i.log("[handleDeeplink] fireCallingIntent succeeded")})).catch((e=>(i.error(`failed to fireCallingintent with ${(0,se.A)(e)}`),Promise.reject(e))))})),J$=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:t,entityCommand:{entity:{type:i,action:a},dataOptions:s},requestContext:o,requestContext:{client:r}}=e,{allowBroadcastPresenterJoinsInT2:c}=o.coreSettings.get(S.J.Broadcast),{enableMeetNowLinksReminder:l}=o.coreSettings.get(S.J.Host),d=o.loggerFactory.newLogger("CallingOnBeforeCommandHandled","apps-calling");if(Z$(i,a))return eW(o,t,d);if(((e,t)=>e===pe.py.callingbannernotification&&t===pe.uk.join)(i,a))return((e,t)=>{const i=e.loggerFactory.newLogger("CallingBannerCommandHandler[handleBannerPrimaryAction]","apps-calling");if(!t.entityOptions){const e=`Error when handling banner's primary action, join click since entity options is undefined for entityId=${t.entity.id}, entityType=${t.entity.type} and entityAction=${t.entity.action}`;return i.error(e),Promise.reject(new Error(e))}return e.client.mutate({mutation:U$,variables:{bannerId:t.entity.id,actionName:"PrimaryAction"}})})(o,t);if(((e,t)=>e===pe.py.callingbannernotification&&t===pe.uk.delete)(i,a))return((e,t)=>{const i=e.loggerFactory.newLogger("CallingBannerCommandHandler[handleBannerDismiss]","apps-calling");if(!t.entityOptions){const e=`Error when handling banner dismiss since entity options is undefined for entityId=${t.entity.id}, entityType=${t.entity.type} and entityAction=${t.entity.action}`;return i.error(e),Promise.reject(new Error(e))}return e.client.mutate({mutation:U$,variables:{bannerId:t.entity.id,actionName:"DismissAction"}})})(o,t);if(Q$(i,a,t.entityOptions))return H$(o,t,r,d);if(X$(i,a)){const{coordinates:e}=t.entityOptions,i=bU.getDeeplinkEntityLocked();if(i||!i&&bU.getCallingAppEventsSubscribed())return bU.getDeeplinkReady()&&(yield(e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){e.log("[handleDeeplink] awaiting getDeeplinkReady"),yield bU.getDeeplinkReady()})))(d)),l&&(yield((e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n;return e.mutate({mutation:O$,variables:{id:null===(n=i.entityOptions)||void 0===n?void 0:n.deeplinkId}}).catch((()=>{var e;return null===(e=t.errorToTelemetry)||void 0===e||e.call(t,"[CallingToastActionMutationFailed] failed","calling_deeplink_navigation"),Promise.reject(Ki.f.CallingToastActionMutationFailed)}))})))(r,d,t)),tW(o,t,d);const a=(0,R$.N6)(e)?`${e.conversationId}/${e.rootMessageId}`:e.meetingData.meetingCode||(e.meetingData.meetingUrl?(e=>{const t=e.split(/[/?&]/);return t[t.indexOf("meet")+1]})(e.meetingData.meetingUrl):void 0);if(!a)return(e=>{var t;const i="[handleDeeplink] Deeplink entity cannot be locked because lockId is undefined";return null===(t=e.errorToTelemetry)||void 0===t||t.call(e,i,"calling_deeplink_navigation"),Promise.reject(i)})(d);d.log("[handleDeeplink] lockDeeplinkEntity"),bU.lockDeeplinkEntity(a)}if(!s)return Promise.resolve(t);if(K$(i,a,s)){const e=s,i=e.toastId,a=e.actionType;return a?"AcceptIncomingCallThroughPrejoin"===a&&c&&(yield((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var i,n,a,s,o;if(!e||!t)return!1;const{data:r}=yield t.query({query:B$,variables:{callId:e}});if(!r||!r.teamsCallIdByCallId)return!1;const{data:c}=yield t.query({query:z$,variables:{id:r.teamsCallIdByCallId}});if(!c||!c.callMeetingInfo)return!1;const l=(0,W$.l0)(null===(i=c.callMeetingInfo)||void 0===i?void 0:i.tenantId,null===(n=c.callMeetingInfo)||void 0===n?void 0:n.organizerId,null===(a=c.callMeetingInfo)||void 0===a?void 0:a.threadId,null===(s=c.callMeetingInfo)||void 0===s?void 0:s.messageId),{data:d}=yield t.query({query:$$,variables:{id:l}});return(null===(o=null==d?void 0:d.broadcast)||void 0===o?void 0:o.userRole)===xe.tf6.Producer})))(e.callId,r))?Promise.resolve(Object.assign(Object.assign({},t),{entity:Object.assign(Object.assign({},t.entity),{type:pe.py.unsupporteddeeplinkdialog,action:pe.uk.view}),command:Object.assign(Object.assign({},t.command),{layoutMode:ve.lO.standard,stateTransition:ve.su.extend,visibilityState:ve.fe.show})})):r.mutate({mutation:M$,variables:{notificationId:i,actionType:a}}).then((()=>{})).catch((()=>Promise.reject(Ki.f.CallingToastActionMutationFailed))):Promise.reject(Ki.f.CallsActionTypeToNotificationActionFailed)}return Promise.resolve(t)})),K$=(e,t,i)=>!!Y$(i)&&(!!i.toastId&&e===pe.py.calls&&t===pe.uk.mutate&&"Unknown"!==i.actionType),Q$=(e,t,i)=>e===pe.py.callingdeeplink&&t===pe.uk.join&&!!i.isBroadcastMeeting,Y$=e=>void 0!==e.toastId,X$=(e,t)=>e===pe.py.callingdeeplink&&t===pe.uk.join,Z$=(e,t)=>e===pe.py.meetings&&t===pe.uk.join,eW=(e,t,i)=>{if(!t.entityOptions||!t.entityOptions.callingIntent){const e=`entityOptions must be of type IMeetingJoinOptions. entity.id=${t.entity.id} - correlationId=${t.command.correlation.id} - source=${t.command.correlation.source}`;return i.error(e),Promise.reject(e)}const{callingIntent:n}=t.entityOptions,{correlation:a}=t.command;return i.log("[handleMeetingJoin] triggering fireCallingIntent mutation"),iW(e,i,n,a.id)},tW=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(!t.entityOptions){const e="[handleDeeplink] No entity options";return i.error(e),Promise.reject(e)}const{correlation:n}=t.command,a=t.entityOptions,{coordinates:s,deeplinkId:o,isWatchParty:r,homeCloud:c}=a;let l;return l=r?(0,L$.W5)(o):(0,L$.sM)(s,o,c),i.log("[handleDeeplink] triggering fireCallingIntent mutation"),iW(e,i,l,n.id)})),iW=(e,t,i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return e.client.mutate({mutation:P$,variables:{callingIntent:i},context:{correlationId:a}}).then((()=>{t.log("fireCallingIntent succeeded")})).catch((e=>(t.error(`failed to fireCallingintent with ${(0,se.A)(e)}`),Promise.reject(e))))}));var nW;!function(e){e.Success="Success",e.Failure="Failure"}(nW||(nW={}));const aW=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:{entity:{type:t,action:i},command:{visibilityState:n}},requestContext:{coreSettings:a,loggerFactory:s}}=e,o=s.newLogger("CallingApp[onCommandResult]","apps-calling"),{enableCallingAppCommandResolvedHook:r}=a.get(S.J.Calling);if(r)return t===pe.py.calls&&i===pe.uk.view&&(o.log(`[onCommandResult] Windowing command with visibilityState: ${n}`),n===ve.fe.show)?sW(e):void 0})),sW=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:{entity:{id:t},command:{correlation:{id:i}}},result:n,requestContext:{client:a,loggerFactory:s,scenarioFactory:o,error:r}}=e,c=s.newLogger("CallingApp[onCommandResult]","apps-calling");let l,d;if(n===Tm.Failure){l=nW.Failure;const e=t?o.findScenarioByNameAndId(z.RG.CallingWindowPopoutIntent,t):void 0;null==e||e.mark("OnAfterCommandResolved"),null==e||e.appendEventData({errorCode:(null==r?void 0:r.errorCode)||h.jK.CallingCallsViewCommandError,message:(null==r?void 0:r.errorMessage)||"[onCommandResult] Window Rendering command for a call resulted in Failure or Incomplete.",context:"CallingApp"}),d=oW(l,i,t,r)}else l=nW.Success,d=oW(l,i,t);try{yield kU(d,a,c)}catch(r){throw c.error(`[handleCallingWindowingContentEvent] Error when reporting event "${l}" [entity.id=${t}, error.name=${r.name}, error.message=${r.message}]`),new Error(`onCommandResult[error.name=${r.name},error.message=${r.message}]::resolveCallingAppEvent::${l}`)}})),oW=(e,t,i,n)=>e===nW.Success?{eventId:t,resolution:{success:{_:!0}},context:{source:{name:xe.BHj.WindowingCommandingSuccess,description:`Windowing command resolved successfully [eventId=${t}, entity.id=${i}]`}}}:{eventId:t,resolution:{error:{name:(null==n?void 0:n.errorCode)||h.jK.CallingCallsViewCommandError,message:(null==n?void 0:n.errorMessage)||`[onCommandResult] calls-view command resolved with an error [eventId=${t}][entity.id=${i}]`}},context:{source:{name:xe.BHj.WindowingCommandingTriggerError,description:`Error processing windowing command [eventId=${t}, entity.id=${i}, error.errorCode=${null==n?void 0:n.errorCode}, error.message=${null==n?void 0:n.errorMessage}]`}}};var rW=i(250475),cW=i(331389);const lW=e=>{const{entity:{type:t,action:i}}=e;if(t===pe.py.calls&&i===pe.uk.view)return z.RG.CallingEntityCommandCallsView};var dW=i(642799),uW=i(426762),mW=i(251609),gW=i(761517),hW=i(554694),pW=i(857521),vW=i(52579),fW=i(665538),bW=i(457695),yW=i(606395);const kW=(0,yW.s)({isWebCallMonitorWrapper:{Bbmb7ep:["fclariu","fyjfh2l"],Beyfa6y:["fyjfh2l","fclariu"],B7oj6ja:["f11xeu6h","f1knf8zw"],Btl43ni:["f1knf8zw","f11xeu6h"],B4j52fo:"ftac7j7",Bekrc4i:["f1w0yd9v","f1h0xgbp"],Bn0qgzm:"fdwcyh7",ibv6hh:["f1h0xgbp","f1w0yd9v"],icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],g2u3we:"fgybt4j",h3c5rm:["fm8sagc","f10vrri"],B9xav0g:"f1pr7p4w",zhjwy3:["f10vrri","fm8sagc"],Bqenvij:"fk3a66p",a9b677:"fly5x3f"},isWebCallMonitorWrapperWithinMCM:{Bqenvij:"fk3a66p",a9b677:"fly5x3f"},isWebCallMonitorUbar:{a9b677:"fly5x3f",Bqenvij:"fyhdfh7"},isWebCallMonitorCallingScreen:{a9b677:"fly5x3f",Bqenvij:"f1l02sjl"}},{d:[".fclariu{border-bottom-right-radius:3px;}",".fyjfh2l{border-bottom-left-radius:3px;}",".f11xeu6h{border-top-right-radius:3px;}",".f1knf8zw{border-top-left-radius:3px;}",".ftac7j7{border-top-width:2px;}",".f1w0yd9v{border-right-width:2px;}",".f1h0xgbp{border-left-width:2px;}",".fdwcyh7{border-bottom-width:2px;}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".fgybt4j{border-top-color:var(--colorStrokeFocus2);}",".fm8sagc{border-right-color:var(--colorStrokeFocus2);}",".f10vrri{border-left-color:var(--colorStrokeFocus2);}",".f1pr7p4w{border-bottom-color:var(--colorStrokeFocus2);}",".fk3a66p{height:25.7rem;}",".fly5x3f{width:100%;}",".fyhdfh7{height:7.2rem;}",".f1l02sjl{height:100%;}"]});var SW=i(814423);const wW=({ubar:e,callingScreen:t})=>{const i=(0,SW.NC)(S.J.Calling),n=kW(),{intentIdOverride:a}=(0,uW.Te)();return a?Se.createElement(mW.k,{"data-tid":"floating-call-monitor",column:!0,className:i.enableMultiCallMonitorForWeb?n.isWebCallMonitorWrapperWithinMCM:n.isWebCallMonitorWrapper},Se.createElement(bW.W,{className:n.isWebCallMonitorUbar},e),Se.createElement(bW.W,{className:n.isWebCallMonitorCallingScreen},t)):null},jW=({ubar:e,callingScreen:t})=>{const i=(0,SW.NC)(S.J.Calling),{id:n}=(0,dW.sV)().getEntityOptions(pe.py.floatingmonitor,pe.uk.view);return i.enableMultiCallMonitorForWeb?Se.createElement(mW.k,{"data-tid":"floating-monitor",column:!0},Se.createElement(wW,{ubar:e,callingScreen:t})):Se.createElement(uW.UN,{intentIdOverride:n},Se.createElement(mW.k,{"data-tid":"floating-monitor",column:!0},Se.createElement(wW,{ubar:e,callingScreen:t})))},CW=(0,yW.s)({isWebMultiCallMonitorWrapper:{a9b677:"fly5x3f",Bqenvij:"f1l02sjl",De3pzq:"f1dmdbja",Bbmb7ep:["fclariu","fyjfh2l"],Beyfa6y:["fyjfh2l","fclariu"],B7oj6ja:["f11xeu6h","f1knf8zw"],Btl43ni:["f1knf8zw","f11xeu6h"],B4j52fo:"ftac7j7",Bekrc4i:["f1w0yd9v","f1h0xgbp"],Bn0qgzm:"fdwcyh7",ibv6hh:["f1h0xgbp","f1w0yd9v"],icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],g2u3we:"fgybt4j",h3c5rm:["fm8sagc","f10vrri"],B9xav0g:"f1pr7p4w",zhjwy3:["f10vrri","fm8sagc"]},isIconWrapper:{a9b677:"fly5x3f",Bqenvij:"f3ra7uv",De3pzq:"f1dmdbja",Brf1p80:"f4d9j23",Bt984gj:"f122n59"}},{d:[".fly5x3f{width:100%;}",".f1l02sjl{height:100%;}",".f1dmdbja{background-color:var(--colorNeutralBackground2);}",".fclariu{border-bottom-right-radius:3px;}",".fyjfh2l{border-bottom-left-radius:3px;}",".f11xeu6h{border-top-right-radius:3px;}",".f1knf8zw{border-top-left-radius:3px;}",".ftac7j7{border-top-width:2px;}",".f1w0yd9v{border-right-width:2px;}",".f1h0xgbp{border-left-width:2px;}",".fdwcyh7{border-bottom-width:2px;}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".fgybt4j{border-top-color:var(--colorStrokeFocus2);}",".fm8sagc{border-right-color:var(--colorStrokeFocus2);}",".f10vrri{border-left-color:var(--colorStrokeFocus2);}",".f1pr7p4w{border-bottom-color:var(--colorStrokeFocus2);}",".f3ra7uv{height:1.5rem;}",".f4d9j23{justify-content:center;}",".f122n59{align-items:center;}"]});var _W=i(804837),TW=i(118418),IW=i(466149),NW=i(938291),EW=i(321561),FW=i(392355),xW=i(136209),DW=i(427662),AW=i(898071),MW=i(339857),PW=i(606896);const OW=(0,yW.s)({isMultiCallListItemWrapper:{Bt984gj:"f122n59",a9b677:"fly5x3f",Bqenvij:"fyw3hzw",jrapky:"f1itd6yx",B6of3ja:"f10kaskc",De3pzq:"f1dmdbja",z8tnut:"fttrv26",z189sj:["fymo3i9","ff1nj48"],Byoj8tv:"f6p0d5s",uwmqm3:["ff1nj48","fymo3i9"]},isMultiCallListItemButtonContainer:{Brf1p80:"f9c4gz4",a9b677:"f43i5ed"},isResumeCallButton:{Jwef8y:"ftrin2t",ecr2s2:"fazgzzr",iro3zm:"ff7k10l",f5ssp4:"f1kntyx9"},isLeaveCallButton:{Jwef8y:"fpsin02",ecr2s2:"f1au4jtj",iro3zm:"fmvue4i",f5ssp4:"f1mcyvn2",t0hwav:"f14p701a",g1a405:"fabs2s9",B1wtsvt:["f13fn5ob","f757zx4"],dm7nc1:"f17rcxh0",n6tcun:["f757zx4","f13fn5ob"]},isStatusText:{sj55zd:"f11d4kpn"},isCallInfo:{Haddrg:"f14ujvnu",a9b677:"fr584hq",Frg6f3:["f9swhlu","f1wift5j"],t21cq0:["f1wift5j","f9swhlu"]},isCallTitle:{B68tc82:"f1p9o1ba",Bmxbyg5:"f1sil6mw",j4b8c3:"fvzbfse"}},{d:[".f122n59{align-items:center;}",".fly5x3f{width:100%;}",".fyw3hzw{height:6rem;}",".f1itd6yx{margin-bottom:0.1rem;}",".f10kaskc{margin-top:0.1rem;}",".f1dmdbja{background-color:var(--colorNeutralBackground2);}",".fttrv26{padding-top:1.5rem;}",".fymo3i9{padding-right:1.5rem;}",".ff1nj48{padding-left:1.5rem;}",".f6p0d5s{padding-bottom:1.5rem;}",".f9c4gz4{justify-content:flex-end;}",".f43i5ed{width:30%;}",".f11d4kpn{color:var(--colorNeutralForeground3);}",".f14ujvnu{over-flow:hidden;}",".fr584hq{width:50%;}",".f9swhlu{margin-left:1.5rem;}",".f1wift5j{margin-right:1.5rem;}",".f1p9o1ba{overflow-x:hidden;}",".f1sil6mw{overflow-y:hidden;}",".fvzbfse{text-wrap:nowrap!important;}"],h:[".ftrin2t:hover{background-color:var(--colorCompoundBrandForeground1);}",".ff7k10l:hover:active{background-color:var(--colorCompoundBrandForeground1);}",".fpsin02:hover{background-color:var(--colorPaletteRedBackground3);}",".fmvue4i:hover:active{background-color:var(--colorPaletteRedBackground3);}"],a:[".fazgzzr:active{background-color:var(--colorCompoundBrandForeground1);}",".f1au4jtj:active{background-color:var(--colorPaletteRedBackground3);}"],f:[".f1kntyx9:focus{background-color:var(--colorCompoundBrandForeground1);}",".f1mcyvn2:focus{background-color:var(--colorPaletteRedBackground3);}",".f14p701a:focus{color:var(--colorNeutralForeground1Selected);}",".fabs2s9:focus{border-top-color:var(--colorNeutralStroke1Selected);}",".f13fn5ob:focus{border-right-color:var(--colorNeutralStroke1Selected);}",".f757zx4:focus{border-left-color:var(--colorNeutralStroke1Selected);}",".f17rcxh0:focus{border-bottom-color:var(--colorNeutralStroke1Selected);}"]});var RW=i(165690);const LW={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorGetCallTitleQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getCallTitle"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamsCallId"},value:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}}}]}]}}]},UW={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorToggleHoldCallMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context"}},type:{kind:"NamedType",name:{kind:"Name",value:"ToggleHoldCallContext"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toggleHoldCall"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamsCallId"},value:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}}},{kind:"Argument",name:{kind:"Name",value:"context"},value:{kind:"Variable",name:{kind:"Name",value:"context"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},$W={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorStopCallMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"stopOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"StopOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"stopCall"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callId"},value:{kind:"Variable",name:{kind:"Name",value:"callId"}}},{kind:"Argument",name:{kind:"Name",value:"context"},value:{kind:"Variable",name:{kind:"Name",value:"context"}}},{kind:"Argument",name:{kind:"Name",value:"stopOptions"},value:{kind:"Variable",name:{kind:"Name",value:"stopOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},{useState:WW,useEffect:BW,useCallback:zW}=we,HW=({callId:e,callHeldAt:t,title:i,callState:n,extendedCallState:a,callStateTitle:s,isServerHold:o,failureType:r,showDuration:c})=>{const l=OW(),d=(0,AW.Cq)(),u=zW((t=>Se.createElement(NW.x,{"data-testid":`multi-call-list-item-${e}-duration`,className:l.isStatusText,size:200},t)),[e,l.isStatusText]);return Se.createElement(mW.k,{className:l.isCallInfo,"data-testid":`multi-call-list-item-${e}-title`,column:!0},Se.createElement(NW.x,{className:l.isCallTitle,size:300},i),Se.createElement(mW.k,{"data-testid":`multi-call-list-item-${e}-status`,gap:"gap.small"},Se.createElement((()=>{if((0,RW.Hj)(a)||(0,RW._u)(a))return Se.createElement(NW.x,{className:l.isStatusText,size:200},s);switch(n){case TW.OX.LocalHold:case TW.OX.RemoteHold:return Se.createElement(NW.x,{className:l.isStatusText,size:200},d.stringTranslate("calling","calling_hold_button_icon_label"));case TW.OX.Disconnecting:case TW.OX.Disconnected:return r===IW.Qq.CallDropped?Se.createElement(NW.x,{className:l.isStatusText,size:200},d.stringTranslate("calling","calling_call_dropped")):Se.createElement(NW.x,{className:l.isStatusText,size:200},d.stringTranslate("calling","calling_call_ended"));case TW.OX.Observing:if(o)return Se.createElement(NW.x,{className:l.isStatusText,size:200},d.stringTranslate("calling","calling_hold_button_icon_label"))}return Se.createElement(rW.e,null)}),null),c&&Se.createElement(MW.W5,{startedAt:t,render:u})))},qW=({callId:e,teamsCallId:t,callState:i,extendedCallState:a,callOrigin:s,participants:o,callStateTitle:r,failureType:c,isServerHold:l,callHeldAt:d,intentId:u,isCallingWindowVisible:m,disableMonitorSwitch:g,disableCallSwitchToggle:h})=>{const p=(0,AW.Cq)(),v=(0,hW.w)("MultiCallListItem"),f=OW(),{loggerFactory:{newLogger:b}}=(0,DW.SE)(),{setIntentIdOverride:y,showCallWindow:k}=(0,uW.Te)(),[S,w]=WW(""),[j]=(0,_W.D)(UW,{fetchPolicy:"no-cache"}),[C]=(0,_W.D)($W,{ignoreResults:!0,fetchPolicy:"no-cache"}),{data:_,loading:T,error:I}=(0,pW.a)(LW,{variables:{teamsCallId:t},fetchPolicy:"no-cache"}),N=zW((()=>{u?(h(!0),v.log(`ResumeCall triggered for call ${e}, teamsCallId ${t}`),j({variables:{teamsCallId:t}}).catch((t=>{v.error(`Error in toggleHoldCall [callId:${e}][error:${t}]`)})).finally((()=>{h(!1)})),y(u),m&&k(t)):v.error(`Intent id is undefined for call ${e}`)}),[e,h,u,m,v,y,k,t,j]);BW((()=>{T||(I?v.error(`Could not fetch call title for callId: ${e} - ${I.message}`):(null==_?void 0:_.getCallTitle)?w(_.getCallTitle):v.log(`No call title found for callId: ${e} - ${null==_?void 0:_.getCallTitle}`))}),[_,T,I,e,v]);return Se.createElement(mW.k,{className:f.isMultiCallListItemWrapper,"data-testid":`multi-call-list-item-${e}`},Se.createElement(FW.mw,{"aria-hidden":!0,"data-testid":`multi-call-list-item-${e}-avatar`,users:o,profilePictureSize:xW.$D.Large,showPresence:!1,isFocusable:!1,callerInfo:"multi-call-list-item"}),Se.createElement(HW,{callId:e,callHeldAt:d,title:S,callState:i,extendedCallState:a,callStateTitle:r,isServerHold:l,failureType:c,showDuration:(0,RW.Rb)(i)&&!(0,RW.Bw)(i)&&!(0,RW._u)(a)&&!(0,RW.Hj)(a)}),Se.createElement(mW.k,{className:f.isMultiCallListItemButtonContainer,gap:"gap.small"},Se.createElement(PW.q,{panelRegion:HN.Ai.multiCallMonitor,panelType:HN.wh.ResumeButton,newLogger:b,disableWrapper:!0},((0,RW.Rb)(i)&&a!==IW.Tk.Transferring&&a!==IW.Tk.TransferSucceeded&&a!==IW.Tk.Parking&&a!==IW.Tk.ParkSucceeded&&!(0,RW.fg)(s)||(0,RW.tO)(i,l))&&Se.createElement(EW.z,{className:f.isResumeCallButton,"data-testid":`multi-call-list-item-${e}-resume-button`,icon:Se.createElement(gW.shV,{filled:!0}),shape:"circular",appearance:"outline",disabled:g,title:p.stringTranslate("calling","resume_call_multi_call_title",{callTitle:S}),onClick:N})),Se.createElement(PW.q,{panelRegion:HN.Ai.multiCallMonitor,panelType:HN.wh.LeaveButton,newLogger:b,disableWrapper:!0},Se.createElement(EW.z,{className:f.isLeaveCallButton,"data-testid":`multi-call-list-item-${e}-leave-button`,icon:Se.createElement(gW.dB2,{filled:!0}),shape:"circular",appearance:"outline",title:p.stringTranslate("calling","end_call_multi_call_title",{callTitle:S}),onClick:()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){v.log(`LeaveCall triggered for call ${e}`);try{yield C({variables:{callId:e,context:"multi-call-list-hangup_click",stopOptions:{forEveryone:!1,forAllUserEndpoints:!1}}})}catch(t){v.error(`Leave call failed for call ${e} - ${t.message}`)}}))}))))};var VW=i(973345);const GW={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorGetAllCallsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getAllCalls"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingFields"}}]}}]}},...VW.fJ.definitions]},JW={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorCallCreatedRemovedUpdatedSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callCreatedRemovedUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallAdded"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"call"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingFields"}}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallRemoved"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"call"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingFields"}}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallUpdated"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"call"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingFields"}}]}}]}}]}}]}},...VW.fJ.definitions]},KW={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorGetRenderedCallQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getRenderedCallInCallingWindow"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingFields"}}]}}]}},...VW.fJ.definitions]},QW={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorCallingWindowingContainerVisibilityEventForMultiCallMonitorSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingWindowingContainerVisibilityEventForMultiCallMonitor"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingWindowingContainerVisibilityEventForMultiCallMonitor"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isCallingWindowVisible"}}]}}]}}]}}]},YW={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorIsCallingWindowVisibleQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isCallingWindowVisible"}}]}}]},{useState:XW,useEffect:ZW,useCallback:eB}=we,tB=({ubar:e,callingScreen:t})=>{const i=(0,hW.w)("MultiCallList"),n=CW(),{close:a,mounted:s}=(0,uW.Te)(),[o,r]=XW([]),[c,l]=XW(""),[d,u]=XW(!1),[m,g]=XW(!1),{data:h,loading:p,error:v}=(0,pW.a)(GW,{fetchPolicy:"no-cache"}),[f,{data:b,loading:y,error:k}]=(0,vW.t)(KW,{fetchPolicy:"no-cache"}),{data:S,loading:w,error:j}=(0,pW.a)(YW,{fetchPolicy:"no-cache"}),{data:C,error:_}=(0,fW.m)(JW),{data:T,error:I}=(0,fW.m)(QW),N=eB((e=>{g(e)}),[]);ZW((()=>{s("call-list"),f()}),[s,f]),ZW((()=>{p||(v?i.error(`Could not fetch call details - ${v.message}`):(null==h?void 0:h.getAllCalls)?(i.log(`Received ${h.getAllCalls.length} calls`),r([...h.getAllCalls])):i.log(`No calls found - ${null==h?void 0:h.getAllCalls}`))}),[h,p,v,r,i]),ZW((()=>{if(!y){if(k)return i.error(`Could not fetch rendered call details - ${k.message}`),void l("");if(!(null==b?void 0:b.getRenderedCallInCallingWindow))return i.log(`No rendered calls found - ${null==b?void 0:b.getRenderedCallInCallingWindow}`),void l("");i.log(`Rendered call id is ${b.getRenderedCallInCallingWindow.callId}`),l(b.getRenderedCallInCallingWindow.callId)}}),[b,y,k,l,i]),ZW((()=>{w||(j?i.error(`Could not fetch calling window visibility - ${j.message}`):S&&0!==Object.keys(S).length?(i.log(`Calling window visibility is ${S.isCallingWindowVisible}`),S.isCallingWindowVisible&&f(),u(S.isCallingWindowVisible)):i.log("Calling window visibility not found"))}),[w,j,S,u,f,i]),ZW((()=>{var e,t;if(_)return void i.error(`Call subscription error - ${_.message}`);if(!(null===(e=null==C?void 0:C.callCreatedRemovedUpdatedEvent)||void 0===e?void 0:e.call))return void i.log(`No calls found in the subscription - ${null===(t=null==C?void 0:C.callCreatedRemovedUpdatedEvent)||void 0===t?void 0:t.call}`);const n=C.callCreatedRemovedUpdatedEvent.call,s=C.callCreatedRemovedUpdatedEvent.__typename;i.log(`Call subscription received for call ${n.callId} and operation ${s}`);let c=[];switch(s){case"CallAdded":f(),c=[...o,n],r(c);break;case"CallRemoved":f();for(const e of o)e.callId!==n.callId&&c.push(e);0===c.length&&(i.log("Closing the call list"),a("call-list")),r(c);break;case"CallUpdated":for(const e of o)e.callId===n.callId?(e.state!==n.state&&f(),c.push(n)):c.push(e);r(c)}}),[C,_,r,i]),ZW((()=>{I?i.error(`Calling window subscription error - ${I.message}`):(null==T?void 0:T.callingWindowingContainerVisibilityEventForMultiCallMonitor)&&void 0!==T.callingWindowingContainerVisibilityEventForMultiCallMonitor.isCallingWindowVisible&&null!==T.callingWindowingContainerVisibilityEventForMultiCallMonitor.isCallingWindowVisible?(T.callingWindowingContainerVisibilityEventForMultiCallMonitor.isCallingWindowVisible&&f(),u(T.callingWindowingContainerVisibilityEventForMultiCallMonitor.isCallingWindowVisible)):i.log("Calling window visibility not found")}),[T,I,u,f,i]);const[E,F]=(({allCalls:e,isCallingWindowVisible:t,renderedCallId:i,ubar:n,callingScreen:a,disableMonitorSwitch:s,disableCallSwitchToggle:o,logger:r})=>{let c=0;if(t&&1===e.length||0===e.length)return r.log(`CallList is empty - isCallingWindowVisible: ${t}, totalCallsCount - ${e.length}`),[null,0];const l=Se.createElement(Se.Fragment,null,e.map((e=>{var l,d,u,m;const g=null===(l=e.participants)||void 0===l?void 0:l.map((e=>({id:e.id,displayName:null})));return t&&e.callId===i?(r.log(`MultiCallList skipped displaying for a call with call id ${e.callId} and intent id ${null===(d=e.intent)||void 0===d?void 0:d.id} because calling window visibility is ${t} and rendered call id is ${i}`),Se.createElement(rW.e,{key:e.id})):(0,RW.Xf)(e)?(r.log(`MultiCallListItem displayed for ${e.callId} with call state as ${e.state} and extended state as ${e.extendedCallState} with calling window visibility as ${t}`),c++,Se.createElement(qW,{key:e.id,callId:e.callId,teamsCallId:e.id,callState:e.state,participants:g,extendedCallState:e.extendedCallState,callOrigin:e.callOrigin,callStateTitle:null===(u=e.callStateProps)||void 0===u?void 0:u.title,failureType:e.failureType,isServerHold:e.isServerHold,callHeldAt:e.callHeldAt||void 0,intentId:null===(m=e.intent)||void 0===m?void 0:m.id,isCallingWindowVisible:t,disableMonitorSwitch:s,disableCallSwitchToggle:o})):(0,RW.A4)(e)?(r.log(`Call Monitor Window displayed for ${e.callId} with call state as ${e.state} and extended state as ${e.extendedCallState} with calling window visibility as ${t}`),c++,Se.createElement(jW,{key:e.id,ubar:n,callingScreen:a})):(r.log(`MultiCallList skipped displaying for call ${e.callId} with call state as ${e.state} and extended state as ${e.extendedCallState} with calling window visibility as ${t}`),Se.createElement(rW.e,{key:e.id}))})));return[l,c]})({allCalls:o,isCallingWindowVisible:d,renderedCallId:c,ubar:e,callingScreen:t,disableMonitorSwitch:m,disableCallSwitchToggle:N,logger:i});return 0===F?(i.log("MultiCallList is hidden - callCountInSlotView - 0"),Se.createElement(rW.e,null)):Se.createElement(mW.k,{className:n.isWebMultiCallMonitorWrapper,"data-tid":"multi-call-list",column:!0},Se.createElement(mW.k,{className:n.isIconWrapper},Se.createElement(gW.cSU,{filled:!0})),E)},iB=e=>{const t=(0,dW.sV)(),{id:i}=t.getEntityOptions(pe.py.floatingmonitor,pe.uk.view);return Se.createElement(uW.UN,{intentIdOverride:i},Se.createElement(tB,Object.assign({},e)))},nB=()=>Promise.all([i.e(974361),i.e(774689),i.e(958828),i.e(743719),i.e(247364),i.e(531924),i.e(923731),i.e(433329),i.e(244738),i.e(428421),i.e(814199),i.e(711340),i.e(404256),i.e(446977),i.e(705849),i.e(890032),i.e(983436),i.e(395303),i.e(873428),i.e(360806),i.e(832717),i.e(236315),i.e(400010),i.e(189185),i.e(193183),i.e(503951),i.e(44716),i.e(776103),i.e(115670),i.e(43220),i.e(165995),i.e(104526),i.e(290689),i.e(826310),i.e(680562),i.e(475063),i.e(888923),i.e(584571),i.e(193567),i.e(110895),i.e(150662),i.e(450987),i.e(574803),i.e(498871),i.e(160235),i.e(264347),i.e(909693),i.e(296422),i.e(127919),i.e(614904),i.e(674821),i.e(225330),i.e(822166),i.e(311461),i.e(728961),i.e(829970),i.e(645979),i.e(803388),i.e(626976),i.e(147647),i.e(631900),i.e(459687),i.e(53502),i.e(485984),i.e(846369),i.e(615242),i.e(530825),i.e(251451),i.e(672443),i.e(375119),i.e(32739),i.e(656283),i.e(69306),i.e(218831),i.e(740324),i.e(629959),i.e(256483),i.e(854054),i.e(795061),i.e(941569),i.e(108182),i.e(471926),i.e(865419),i.e(735861),i.e(475906),i.e(180189),i.e(847947),i.e(81817),i.e(674872),i.e(243220),i.e(770326)]).then(i.bind(i,925819)),aB=()=>Promise.all([i.e(974361),i.e(774689),i.e(958828),i.e(743719),i.e(247364),i.e(531924),i.e(923731),i.e(433329),i.e(244738),i.e(428421),i.e(814199),i.e(711340),i.e(404256),i.e(446977),i.e(705849),i.e(890032),i.e(983436),i.e(395303),i.e(873428),i.e(360806),i.e(832717),i.e(236315),i.e(400010),i.e(189185),i.e(193183),i.e(503951),i.e(44716),i.e(776103),i.e(115670),i.e(43220),i.e(165995),i.e(104526),i.e(290689),i.e(826310),i.e(680562),i.e(475063),i.e(888923),i.e(584571),i.e(193567),i.e(110895),i.e(150662),i.e(450987),i.e(574803),i.e(498871),i.e(160235),i.e(264347),i.e(909693),i.e(296422),i.e(127919),i.e(614904),i.e(674821),i.e(225330),i.e(822166),i.e(311461),i.e(728961),i.e(829970),i.e(645979),i.e(803388),i.e(626976),i.e(147647),i.e(631900),i.e(459687),i.e(53502),i.e(485984),i.e(846369),i.e(615242),i.e(530825),i.e(251451),i.e(672443),i.e(375119),i.e(32739),i.e(656283),i.e(69306),i.e(218831),i.e(740324),i.e(629959),i.e(256483),i.e(854054),i.e(795061),i.e(941569),i.e(108182),i.e(471926),i.e(865419),i.e(735861),i.e(475906),i.e(180189),i.e(847947),i.e(81817),i.e(674872),i.e(243220),i.e(770326)]).then(i.bind(i,950827)),sB=()=>Promise.all([i.e(974361),i.e(774689),i.e(958828),i.e(743719),i.e(247364),i.e(531924),i.e(923731),i.e(433329),i.e(244738),i.e(428421),i.e(814199),i.e(711340),i.e(404256),i.e(446977),i.e(705849),i.e(890032),i.e(983436),i.e(395303),i.e(873428),i.e(360806),i.e(832717),i.e(236315),i.e(400010),i.e(189185),i.e(193183),i.e(503951),i.e(44716),i.e(776103),i.e(115670),i.e(43220),i.e(165995),i.e(104526),i.e(290689),i.e(826310),i.e(680562),i.e(475063),i.e(888923),i.e(584571),i.e(193567),i.e(110895),i.e(150662),i.e(450987),i.e(574803),i.e(498871),i.e(160235),i.e(264347),i.e(909693),i.e(296422),i.e(127919),i.e(614904),i.e(674821),i.e(225330),i.e(822166),i.e(311461),i.e(728961),i.e(829970),i.e(645979),i.e(803388),i.e(626976),i.e(147647),i.e(631900),i.e(459687),i.e(53502),i.e(485984),i.e(846369),i.e(615242),i.e(530825),i.e(251451),i.e(672443),i.e(375119),i.e(32739),i.e(656283),i.e(69306),i.e(218831),i.e(740324),i.e(629959),i.e(256483),i.e(854054),i.e(795061),i.e(941569),i.e(108182),i.e(471926),i.e(865419),i.e(735861),i.e(475906),i.e(180189),i.e(847947),i.e(81817),i.e(674872),i.e(243220),i.e(770326)]).then(i.bind(i,399138)),oB="calling-app-LPC",rB="calling-app",cB=({appRenderMode:e,coreSettings:t,host:i,isHeader:a,isMainPanel:s,logger:o,onRenderEvent:r,scenarioFactory:c})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){o.log(`renderWithLPC: import LPC: isMainPanel=${s} isHeader=${a}`);const n=(0,Rl.mT)(sB,oB,c);if(e===Wt.S.Main){r("ChunkLoadStarted",{chunkName:oB});const{chunkLoadTimerPromise:e,chunkLoadTimer:c}=(({coreSettings:e,host:t})=>{let i=0;return{chunkLoadTimerPromise:new Promise(((n,a)=>{let{chunkLoadTimeout:s}=e.get(S.J.Calling);s||(s=Number.MAX_SAFE_INTEGER),i=t.setTimeout(a,s,(0,oe.Tr)("CallingApp",h.jK.ChunkLoadTimedOut,"renderMain"))})),chunkLoadTimer:i}})({coreSettings:t,host:i});yield Promise.race([n,e]).then((()=>clearTimeout(c))).catch((e=>{throw o.error(`renderWithLPC: ChunkLoadTimedOut: isMainPanel=${s} isHeader=${a}`),e})),r("ChunkLoadSucceeded",{chunkName:oB})}const{LPC:l}=yield n;return o.log(`renderWithLPC: construct the slot element: isMainPanel=${s} isHeader=${a}`),l})),lB=({coreServices:e,host:t,isResize:i,entityType:n,windowOptions:a,entityOptions:s})=>{var o,r,c,l;const{minHeight:d,minWidth:u}=(null===(o=A$.windowFeatures)||void 0===o?void 0:o.otherEntityTypes)||{},m=null==t?void 0:t.screen;if(n===pe.py.callsmonitor)return(({host:e,windowOptions:t,coreServices:i})=>{var n,a;const s=null!==(a=Object.assign({},null===(n=A$.windowFeatures)||void 0===n?void 0:n[pe.py.callsmonitor]))&&void 0!==a?a:{},o={width:s.width||0,height:s.height||0};return t&&(o.width=t.width||o.width,o.height=t.height||o.height),!!(null==i?void 0:i.coreSettings.get(S.J.Calling,["disableContentprotection"]).disableContentprotection)&&s.additionalFeatures&&(s.additionalFeatures=Object.assign(Object.assign({},s.additionalFeatures),{contentprotection:"false"})),e&&e.screen&&o.width&&o.height&&(s.top=0===(null==t?void 0:t.top)||(null==t?void 0:t.top)?t.top:e.screen.availHeight-(o.height+100),s.left=0===(null==t?void 0:t.left)||(null==t?void 0:t.left)?t.left:e.screen.availWidth-(o.width+100)),Object.assign(Object.assign({},s),o)})({host:t,windowOptions:a,coreServices:e});if(n===pe.py.byodattendeewindow)return(({entityOptions:e})=>{var t;const{minHeight:i,minWidth:n}=(null===(t=A$.windowFeatures)||void 0===t?void 0:t.byodattendeewindow)||{};if(!e)return null;const a=JSON.parse(e).displayProperties;return{additionalFeatures:{minHeight:`${i}`,minWidth:`${n}`},height:null==a?void 0:a.height,width:null==a?void 0:a.width,fullScreen:!0,left:null==a?void 0:a.x,top:null==a?void 0:a.y,minHeight:i,minWidth:n}})({entityOptions:s});if(n===pe.py.callingdialog)return null!==(c=null===(r=A$.windowFeatures)||void 0===r?void 0:r[pe.py.callingdialog])&&void 0!==c?c:{};if(i&&!m)return(null===(l=A$.windowFeatures)||void 0===l?void 0:l.otherEntityTypes)||null;if(!m)return null;let{height:g=1,width:h=1}=((e,t)=>{var i,n;const{minHeight:a=0,minWidth:s=0}=(null===(i=A$.windowFeatures)||void 0===i?void 0:i.otherEntityTypes)||{};let{width:o,height:r}=(null===(n=A$.windowFeatures)||void 0===n?void 0:n.otherEntityTypes)||{};if(!t)return{height:r,width:o,minHeight:a,minWidth:s};const{orientation:{type:c}}=e,{landscapeScreenRatio:l,portraitScreenRatio:d,widthHeightRatio:u}=t.coreSettings.get(S.J.Calling);if(l&&d&&u)switch(c){case"landscape-primary":case"landscape-secondary":const t=l*e.availHeight;r=t>a?t:a,o=u*r;break;case"portrait-primary":case"portrait-secondary":const i=d*e.availWidth;o=i>s?i:s,r=1/u*o}return{height:r,width:o}})(m,e);const p=m.availHeight-20,v=h>=m.availWidth||g>=p;v&&(g=m.availHeight,h=m.availWidth);const{left:f,top:b}=((e,t,i,n,a)=>{if(n)return{left:0,top:0};const s="availLeft"in e?e.availLeft:0,o="availTop"in e?e.availTop:0,r=s+e.availWidth/2-t/2;let c;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":c=o+a;break;default:c=o+e.availHeight/2-i/2}return{left:r,top:c}})(m,h,g,v,20);return{additionalFeatures:{minHeight:`${d}`,minWidth:`${u}`},height:g,width:h,fullScreen:v,left:f,top:b,minHeight:d,minWidth:u}},dB=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{logger:t,scenarioFactory:i,isMainPanel:n,isHeader:a,isModal:s,onRenderEvent:o}=e;o("ChunkLoadStarted",{chunkName:rB}),t.log(`render: import the necessary subcomponents: isMainPanel=${n} isHeader=${a} isModal=${s}`);const[{CallingViewsRenderer:r},{CallingContextProvider:c}]=yield Promise.all([(0,Rl.mT)(nB,rB,i),(0,Rl.mT)(aB,rB,i)]);return o("ChunkLoadSucceeded",{chunkName:rB}),{CallingViewsRenderer:r,CallingContextProvider:c}})),uB=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{isMainPanel:t,isHeader:i,isModal:n,logger:a,conveneHostMessaging:s}=e,{CallingViewsRenderer:o,CallingContextProvider:r}=yield dB(e);return a.log(`render: construct the slot element: isMainPanel=${t} isHeader=${i} isModal=${n}`),(null==s?void 0:s.isInEmbedContext())?Se.createElement(hB,null,Se.createElement(r,null,Se.createElement(ML.yx,{conveneHostMessaging:s},Se.createElement(o,{isMainPanel:t,isHeader:i,isModal:n})))):Se.createElement(hB,null,Se.createElement(r,null,Se.createElement(o,{isMainPanel:t,isHeader:i,isModal:n})))})),mB=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var{appRenderMode:t,loggerFactory:i,host:a,scenarioFactory:s}=e,o=(0,n.__rest)(e,["appRenderMode","loggerFactory","host","scenarioFactory"]);if(t===Wt.S.HorizontalBar||t===Wt.S.Main){const e=i.newLogger("CallingApp","apps-calling"),n=t===Wt.S.HorizontalBar;return uB(Object.assign({isMainPanel:!0,isHeader:n,isModal:!1,logger:e,scenarioFactory:s,appRenderMode:t,host:a},o))}return Se.createElement(rW.e,null)}));function gB(e){return{eventHandlers:f$,getAppPhases:k$,getAppViewEntities:w$,getAppViewEntitiesProps:x$,getAppWindowFeatures:lB,getCommandScenarioName:lW,manifest:A$,render:t=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var{appRenderMode:i,entity:a,loggerFactory:s}=t,o=(0,n.__rest)(t,["appRenderMode","entity","loggerFactory"]);const r=s.newLogger("CallingApp","apps-calling");if(a.type===pe.py.floatingmonitor)return c=Object.assign({appRenderMode:i,entity:a,loggerFactory:s},o),(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var{loggerFactory:e,entity:t,appRenderMode:i}=c,a=(0,n.__rest)(c,["loggerFactory","entity","appRenderMode"]);const s=a.coreSettings.get(S.J.Calling),[o,r]=yield Promise.all([mB(Object.assign({appRenderMode:Wt.S.HorizontalBar,entity:t,loggerFactory:e},a)),mB(Object.assign({appRenderMode:Wt.S.Main,entity:t,loggerFactory:e},a))]);return s.enableMultiCallMonitorForWeb?Se.createElement(iB,{ubar:o,callingScreen:r}):Se.createElement(jW,{ubar:o,callingScreen:r})}));var c,l;if(a.type===pe.py.callsmonitor)return mB(Object.assign({appRenderMode:i,entity:a,loggerFactory:s},o));if(i===Wt.S.HorizontalBar||i===Wt.S.Modal){const t=i===Wt.S.HorizontalBar,n=i===Wt.S.HorizontalBar,a=i===Wt.S.Modal;return uB(Object.assign({conveneHostMessaging:e,isMainPanel:t,isHeader:n,isModal:a,logger:r,appRenderMode:i},o))}if(i===Wt.S.Main||i===Wt.S.Rail){const t=i===Wt.S.Main,a=!1,s=!1;return l=Object.assign({conveneHostMessaging:e,isMainPanel:t,isHeader:a,isModal:s,appRenderMode:i,logger:r},o),(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{isMainPanel:e,isHeader:t,isModal:i,logger:n,coreSettings:a,conveneHostMessaging:s}=l,{CallingViewsRenderer:o,CallingContextProvider:r}=yield dB(l);n.log(`render: construct the slot element: isMainPanel=${e} isHeader=${t} isModal=${i}`);const{enableEntityMoreInfo:c=!1}=a.get(S.J.Core),d=({children:e})=>Se.createElement(Se.Fragment,null,e),u=c?d:yield cB(l),m=c?d:cW.p3;return(null==s?void 0:s.isInEmbedContext())?Se.createElement(hB,null,Se.createElement(u,null,Se.createElement(m,null,Se.createElement(ML.yx,{conveneHostMessaging:s||ML.Id},Se.createElement(r,null,Se.createElement(o,{isMainPanel:e,isHeader:t,isModal:i})))))):Se.createElement(hB,null,Se.createElement(u,null,Se.createElement(m,null,Se.createElement(r,null,Se.createElement(o,{isMainPanel:e,isHeader:t,isModal:i})))))}))}return Se.createElement(rW.e,null)})),onPreWarm:qU,onPreInit:VU,onBeforeAddToNavigation:d$,onBeforeCommandHandled:J$,onBeforeDeeplinkParsed:l$,onCommandResult:aW}}const hB=({children:e})=>Se.createElement(QL.f,{namespaces:["calling","broadcast","extensibility","hololens","messaging","meetingOptions","datepicker"],loaderRenderer:null},e);var pB=i(571096),vB=i(876661),fB=i(289931);const bB={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"sendMessage"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"message"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"action"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageAction"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"correlationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendMessage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"message"},value:{kind:"Variable",name:{kind:"Name",value:"message"}}},{kind:"Argument",name:{kind:"Name",value:"action"},value:{kind:"Variable",name:{kind:"Name",value:"action"}}},{kind:"Argument",name:{kind:"Name",value:"correlationId"},value:{kind:"Variable",name:{kind:"Name",value:"correlationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},yB={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsChatChatHighlightsCommandOptionsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chatHighlightsDetailsCommandOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"convId"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"lastMessageOriginalArrivalTime"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}}]},kB={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsChatNotifyActiveContextChangedMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activeContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activeContextType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActiveContextType"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notifyActiveContextChangedToCDLWorker"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activeContextId"},value:{kind:"Variable",name:{kind:"Name",value:"activeContextId"}}},{kind:"Argument",name:{kind:"Name",value:"activeContextType"},value:{kind:"Variable",name:{kind:"Name",value:"activeContextType"}}}]}]}}]};var SB=i(32552),wB=i(760005);const jB=e=>{const{entityCommand:t,entityCommand:{entity:{type:i,action:n,id:a},dataOptions:s,entityOptions:o},requestContext:r}=e,{enableChatEnablePolicyCheckForCommand:c}=r.coreSettings.get(S.J.Chat);if(c&&i===pe.py.chats&&o&&o.shouldCheckChatPolicy&&(0,fB.t3)(r.coreSettings.get(S.J.Messaging))===fB.i1.Disabled)return Promise.resolve(void 0);const l=r.client;return NB(l,r.coreSettings,i,n,a),i===pe.py.chatHighlightsDetails&&"chatHighlightsDetailsCoachmark"===a?CB(l,t):_B(l,s,t,i,n)},CB=(e,t)=>{try{const i=e.readQuery({query:yB});if(!(null==i?void 0:i.chatHighlightsDetailsCommandOptions))throw new Error;{const{convId:e,lastMessageOriginalArrivalTime:n}=i.chatHighlightsDetailsCommandOptions;t.entity.id=e,t.entityOptions?t.entityOptions=Object.assign(Object.assign({},t.entityOptions),{lastMessageOriginalArrivalTime:n}):t.entityOptions={lastMessageOriginalArrivalTime:n}}}catch(e){return Promise.reject("handleChatHighlightsDetailsCoachmark: falied to get chat id")}return Promise.resolve(t)},_B=(e,t,i,n,a)=>t&&TB(n,a)?IB(t)&&t.convId&&t.message?e.mutate({mutation:bB,variables:{convId:t.convId,message:{clientMessageId:(0,SB.K)(),messageType:wB.Cs.HTML,content:t.message},action:xe.xyM.Create}}).then((()=>{})).catch((()=>Promise.reject(Ki.f.ChatToastActionMutationFailed))):Promise.reject(Ki.f.ChatActionTypeToNotificationActionFailed):Promise.resolve(i),TB=(e,t)=>e===pe.py.chats&&t===pe.uk.mutate,IB=e=>e.actionType===Wi.quickReply,NB=(e,t,i,n,a)=>{t.get(S.J.CdlWorker).enableNotifyActiveContextChangedToCDLWorker&&a&&i===pe.py.chats&&n===pe.uk.view&&e.mutate({mutation:kB,fetchPolicy:"no-cache",variables:{activeContextId:a,activeContextType:xe.xz$.chat}})},EB=()=>Promise.all([i.e(974361),i.e(774689),i.e(958828),i.e(743719),i.e(247364),i.e(531924),i.e(923731),i.e(433329),i.e(244738),i.e(428421),i.e(814199),i.e(711340),i.e(404256),i.e(446977),i.e(705849),i.e(890032),i.e(983436),i.e(551886),i.e(395303),i.e(873428),i.e(360806),i.e(291431),i.e(404541),i.e(832717),i.e(503951),i.e(44716),i.e(9606),i.e(283305),i.e(236861),i.e(868696),i.e(776103),i.e(115670),i.e(463944),i.e(662286),i.e(92374),i.e(104526),i.e(290689),i.e(826310),i.e(680562),i.e(475063),i.e(742262),i.e(888923),i.e(584571),i.e(193567),i.e(110895),i.e(150662),i.e(450987),i.e(574803),i.e(100004),i.e(579735),i.e(820464),i.e(160235),i.e(260225),i.e(264347),i.e(129880),i.e(983679),i.e(668059),i.e(448073),i.e(277110),i.e(252283),i.e(127919),i.e(614904),i.e(674821),i.e(225330),i.e(822166),i.e(311461),i.e(172670),i.e(728961),i.e(829970),i.e(645979),i.e(663905),i.e(562148),i.e(881128),i.e(803388),i.e(626976),i.e(147647),i.e(343831),i.e(631900),i.e(459687),i.e(519998),i.e(53502),i.e(812126),i.e(485984),i.e(357821),i.e(846369),i.e(615242),i.e(745474),i.e(530825),i.e(251451),i.e(672443),i.e(375119),i.e(32739),i.e(656283),i.e(496769),i.e(69306),i.e(767266),i.e(492721),i.e(244259),i.e(184954),i.e(218831),i.e(740436),i.e(24851),i.e(473165),i.e(629959),i.e(267807),i.e(256483),i.e(366438),i.e(107285),i.e(965573),i.e(685464),i.e(256060),i.e(92854),i.e(146515),i.e(180189),i.e(262933),i.e(930054),i.e(812321),i.e(481647)]).then(i.bind(i,145206)),FB=()=>Promise.all([i.e(974361),i.e(774689),i.e(958828),i.e(743719),i.e(247364),i.e(531924),i.e(923731),i.e(433329),i.e(244738),i.e(428421),i.e(814199),i.e(711340),i.e(404256),i.e(446977),i.e(705849),i.e(890032),i.e(983436),i.e(551886),i.e(395303),i.e(873428),i.e(360806),i.e(291431),i.e(404541),i.e(832717),i.e(503951),i.e(44716),i.e(9606),i.e(283305),i.e(236861),i.e(868696),i.e(776103),i.e(115670),i.e(463944),i.e(662286),i.e(92374),i.e(104526),i.e(290689),i.e(826310),i.e(680562),i.e(475063),i.e(742262),i.e(888923),i.e(584571),i.e(193567),i.e(110895),i.e(150662),i.e(450987),i.e(574803),i.e(100004),i.e(579735),i.e(820464),i.e(160235),i.e(260225),i.e(264347),i.e(129880),i.e(983679),i.e(668059),i.e(448073),i.e(277110),i.e(252283),i.e(127919),i.e(614904),i.e(674821),i.e(225330),i.e(822166),i.e(311461),i.e(172670),i.e(728961),i.e(829970),i.e(645979),i.e(663905),i.e(562148),i.e(881128),i.e(803388),i.e(626976),i.e(147647),i.e(343831),i.e(631900),i.e(459687),i.e(519998),i.e(53502),i.e(812126),i.e(485984),i.e(357821),i.e(846369),i.e(615242),i.e(745474),i.e(530825),i.e(251451),i.e(672443),i.e(375119),i.e(32739),i.e(656283),i.e(496769),i.e(69306),i.e(767266),i.e(492721),i.e(244259),i.e(184954),i.e(218831),i.e(740436),i.e(24851),i.e(473165),i.e(629959),i.e(267807),i.e(256483),i.e(366438),i.e(107285),i.e(965573),i.e(685464),i.e(256060),i.e(92854),i.e(146515),i.e(180189),i.e(262933),i.e(930054),i.e(812321),i.e(481647)]).then(i.bind(i,399138)),xB=({action:e,appRenderMode:t,coreSettings:i,type:n})=>{const a=new b$.H,{isHeaderDisabled:s=!1}=i.get(S.J.Core),{chatAppPhaseTimeouts:o,enableComposeCriticalPhaseLoad:r=!1,enableComposeCriticalPhaseLoadSecondaryViewport:c=!1,enableComposeCriticalPhaseLoadSecondaryViewportGate:l=!1}=i.get(S.J.Messaging),d=[],u=[];switch(t){case Wt.S.HorizontalBar:DB({criticalSignals:d,featureFlags:{isHeaderDisabled:s},postCriticalSignals:u,type:n});break;case Wt.S.Main:AB({action:e,criticalSignals:d,featureFlags:{enableComposeCriticalPhaseLoad:r},postCriticalSignals:u,type:n});break;case Wt.S.Rail:MB({action:e,criticalSignals:d,featureFlags:{enableComposeCriticalPhaseLoad:r,enableComposeCriticalPhaseLoadSecondaryViewport:c,enableComposeCriticalPhaseLoadSecondaryViewportGate:l},postCriticalSignals:u,type:n})}return a.registerAppPhase({phase:De.nh.CRITICAL,signals:d,timeout:(null==o?void 0:o.critical)||6e4}),a.registerAppPhase({phase:De.nh.POST_CRITICAL,signals:u,timeout:(null==o?void 0:o.postCritical)||1e4}),a.appPhases},DB=({featureFlags:{isHeaderDisabled:e},criticalSignals:t,postCriticalSignals:i,type:n})=>{n!==pe.py.chatschannelconv?(!e&&t.push(y$.G.CHAT_HEADER_TITLE_RENDERED),!e&&i.push(y$.G.CHAT_HEADER_BUTTONS_RENDERED)):t.push(y$.G.CHANNEL_HEADER_RENDERED)},AB=({action:e,criticalSignals:t,featureFlags:{enableComposeCriticalPhaseLoad:i},postCriticalSignals:n,type:a})=>{if(e===pe.uk.join)return;if(a===pe.py.chatschannelconv){t.push(y$.G.MESSAGES_RENDERED);return i?t.push(y$.G.COMPOSE_LOADED):n.push(y$.G.COMPOSE_LOADED),void n.push(y$.G.MESSAGE_REACTIONS_RENDERED,y$.G.PRESENCES_RENDERED,y$.G.VIRTUAL_LIST_RENDER_BUFFER_FILLED)}t.push(y$.G.MESSAGES_RENDERED);const s=i;s&&t.push(y$.G.COMPOSE_LOADED),n.push(y$.G.MESSAGE_REACTIONS_RENDERED,y$.G.PRESENCES_RENDERED,y$.G.VIRTUAL_LIST_RENDER_BUFFER_FILLED),!s&&n.push(y$.G.COMPOSE_LOADED)},MB=({action:e,criticalSignals:t,featureFlags:{enableComposeCriticalPhaseLoad:i,enableComposeCriticalPhaseLoadSecondaryViewport:n,enableComposeCriticalPhaseLoadSecondaryViewportGate:a},postCriticalSignals:s,type:o})=>{if(e===pe.uk.list)t.push(y$.G.CHAT_LIST_ITEMS_RENDERED),s.push(y$.G.PRESENCES_RENDERED);else if(e===pe.uk.view){t.push(y$.G.MESSAGES_RENDERED);const e=a&&n,r=o!==pe.py.byodchat&&(i||e);r&&t.push(y$.G.COMPOSE_LOADED),s.push(y$.G.MESSAGE_REACTIONS_RENDERED,y$.G.PRESENCES_RENDERED,y$.G.VIRTUAL_LIST_RENDER_BUFFER_FILLED),r||o===pe.py.byodchat||s.push(y$.G.COMPOSE_LOADED)}},PB={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attributionText"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"discardDuringMeetingsAndCalls"}},{kind:"Field",name:{kind:"Name",value:"interopConversationStatus"}},{kind:"Field",name:{kind:"Name",value:"members"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"displayName"}}]}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"messagePreviewTemplateOption"}},{kind:"Field",name:{kind:"Name",value:"parentEntityTitle"}},{kind:"Field",name:{kind:"Name",value:"reaction"}},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"}},{kind:"Field",name:{kind:"Name",value:"senderDecoratedDisplayName"}},{kind:"Field",name:{kind:"Name",value:"senderGivenName"}},{kind:"Field",name:{kind:"Name",value:"senderId"}},{kind:"Field",name:{kind:"Name",value:"subtype"}},{kind:"Field",name:{kind:"Name",value:"tabId"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}},{kind:"Field",name:{kind:"Name",value:"topic"}},{kind:"Field",name:{kind:"Name",value:"translatedPreview"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"fromExternalUser"}},{kind:"Field",name:{kind:"Name",value:"activityId"}},{kind:"Field",name:{kind:"Name",value:"isFromPriorityContact"}},{kind:"Field",name:{kind:"Name",value:"isUrgent"}},{kind:"Field",name:{kind:"Name",value:"isTextMessageVisible"}}]}}]}}]};var OB,RB;!function(e){e.GroupMessage="GroupMessage",e.Message="Message",e.Mention="Mention",e.Reaction="Reaction",e.InviteJoined="InviteJoined",e.TeamsTasks="TeamsTasks",e.Reminder="Reminder",e.Priority="Priority",e.DLP="DLP"}(OB||(OB={})),function(e){e.Small="HR64x64"}(RB||(RB={}));var LB=i(815573);const UB={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaUserProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}}]}]}}]},$B={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaGroupProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MsaGroupProfilePictureInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaGroupProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"msaGroupInfo"},value:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}]}]}}]},WB={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"toastImageAsDataUri"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}]}]}}]},BB={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsChatEmoticonQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchEmoticons"},arguments:[{kind:"Argument",name:{kind:"Name",value:"searchFilter"},value:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}}},{kind:"Argument",name:{kind:"Name",value:"exactMatch"},value:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}}},{kind:"Argument",name:{kind:"Name",value:"includeShortCuts"},value:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}}},{kind:"Argument",name:{kind:"Name",value:"includeKeywords"},value:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}}},{kind:"Argument",name:{kind:"Name",value:"maxResultCount"},value:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}}},{kind:"Argument",name:{kind:"Name",value:"categoryId"},value:{kind:"Variable",name:{kind:"Name",value:"categoryId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsChatEmoticonFragment"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsChatEmoticonFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Emoticon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"unicode"}},{kind:"Field",name:{kind:"Name",value:"animation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsChatEmoticonFragment_animation"}}]}},{kind:"Field",name:{kind:"Name",value:"etag"}},{kind:"Field",name:{kind:"Name",value:"diverse"}},{kind:"Field",name:{kind:"Name",value:"shortcuts"}},{kind:"Field",name:{kind:"Name",value:"searchMatch"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsChatEmoticonFragment_animation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmoticonAnimation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fps"}},{kind:"Field",name:{kind:"Name",value:"framesCount"}},{kind:"Field",name:{kind:"Name",value:"firstFrame"}}]}}]}.definitions]}.definitions]};var zB=i(451567),HB=i(46845),qB=i(662707),VB=i(668096);function GB(e,t){const i=e.senderGivenName||e.senderDisplayName||XB(t);if(e.subtype)return t.stringTranslate("toastNotifications","new_task_list_added_toast_title",{sender:i})}function JB(e,t){const i=function(e,t){var i,n;const a=t.topic;if(a)return a;if(!(null===(i=t.members)||void 0===i?void 0:i.length))return;return null===(n=kz(e,t.members))||void 0===n?void 0:n.displayName}(e,t);return t.subtype===VB.YQ.tFLPlanCreated&&i&&t.text?e.stringTranslate("toastNotifications","task_list_in_group_chat_added_text",{groupChatTitle:i,taskListTitle:t.text}):t.text||void 0}function KB(e,t,i){const{enableInviteeJoinedActivity:n}=i.get(S.J.Activity),a=YB(e,n?t.senderDisplayName:t.senderGivenName);return e.stringTranslate("toastNotifications",n?"toast_invite_joined_with_activity_feed_title":"toast_invite_joined",{sender:a})}function QB(e,t,i,n){const{enableInviteeJoinedActivity:a}=n.get(S.J.Activity);if(a){const t=YB(e,i.senderDisplayName);return e.stringTranslate("toastNotifications","toast_invite_joined_with_activity_feed_text",{sender:t})}return i.members&&i.members.length?i.topic||t(e,i.members):void 0}function YB(e,t){return t||XB(e)}function XB(e){return e.stringTranslate("toastNotifications","toast_unknown_user")}var ZB=i(308292),ez=i(709009),tz=i(219418),iz=i(781015);function nz(e,t,i,a){var s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enableInAppNotificationsForChatsAndChannels:o}=a.get(S.J.Notifications,["enableInAppNotificationsForChatsAndChannels"]),{enableCustomNotificationsForChats:r}=a.get(S.J.Core,["enableCustomNotificationsForChats"]);try{const a=!o&&!r;if(i.type===OB.Priority&&a)return t.log(`${Ki.f.ReturningHardcodedImage}: Returning default priority message avatar for toast ${i.correlationId}`),ZB.ap;if(i.type===OB.DLP)return t.log(`${Ki.f.ReturningHardcodedImage}: Returning default dlp message avatar for toast ${i.correlationId}`),ZB.Uw;if(1===(null===(s=i.members)||void 0===s?void 0:s.length)&&i.type===OB.GroupMessage)return t.log(`${Ki.f.ReturningHardcodedImage} Returning default group message avatar for toast ${i.correlationId} as there is just one member`),ZB.dA;if((0,vB.j8)(i.conversationId)&&(0,sf.EG)(i.senderId))return t.log(`${Ki.f.ReturningHardcodedImage} Returning default PSTN avatar for toast ${i.correlationId} as sender is PSTN contact`),ZB.Az;const c=i.type===OB.GroupMessage?yield function(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!(null===(i=t.members)||void 0===i?void 0:i.length))return null;const{data:n}=yield e.query({query:$B,variables:{msaGroupInfo:{pictureReadyUsers:t.members.map((({id:e,displayName:t})=>({userId:e,displayName:t}))).slice(0,Zr.gT.FOUR),conversationId:t.conversationId}}});return n.msaGroupProfilePicture}))}(e,i):yield function(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{data:i}=yield e.query({query:UB,variables:{userId:t.senderId,displayName:t.senderDisplayName,profilePictureSize:RB.Small}});return i.msaUserProfilePicture}))}(e,i);if(!c)return void t.error(Ki.f.ImageUrlGenerationFailed);const l=yield e.query({query:WB,variables:{url:c}}),d=null==l?void 0:l.data.toastImageAsDataUri;return d?(t.log(Ki.f.ReturningFetchedImage),t.log(`Returning fetched image for toast ${i.correlationId}`),d):void t.error(Ki.f.ToastImageAsDataUriIsUndefined)}catch(e){return void t.error(Ki.f.ImageFetchFailed)}}))}function az(e,t,i){const{enableToastMediaTextPreview:n,enableUrgentToastsContentFixes:a,enableToastDefaultTextFallbackFix:s}=e.get(S.J.Notifications);return i.interopConversationStatus===wB.uI.AcceptPending||i.interopConversationStatus===wB.uI.ExtendedDirectoryAcceptPending?t.stringTranslate("people","invite_free_quarantined_notification_content"):i.isUrgent&&a?sz(t,i,!!s):n?oz(t,i,!!s):cz(t,i.text,!!s)}function sz(e,t,i){return t.messagePreviewTemplateOption===iz.yF.hasText?rz(e,t,i):cz(e,t.translatedPreview,i)}function oz(e,t,i){switch(t.contentType){case tz.zc.FILE:return e.stringTranslate("toastNotifications","toast_messaging_sent_a_file");case tz.zc.VOICE:return e.stringTranslate("toastNotifications","toast_messaging_sent_a_voice_message");case tz.zc.IMAGE:return e.stringTranslate("toastNotifications","toast_messaging_sent_an_image");case tz.zc.LOCATION:return e.stringTranslate("toastNotifications","toast_messaging_sent_a_location_message");case tz.zc.VIDEO:return e.stringTranslate("toastNotifications","toast_messaging_sent_an_video");case tz.zc.TEXT:return rz(e,t,i);default:return cz(e,t.text,i)}}function rz(e,t,i){return!t.isTextMessageVisible&&i?e.stringTranslate("toastNotifications","toast_messaging_preview_hidden"):cz(e,t.text,i)}function cz(e,t,i){const n=function(e){const t=(0,HB.S)(e,!0).replace(/\s\s+/g," ");return(i=t,i.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g,"Â ").replace(/&quot;/g,'"')).trim();var i}(t||"");return i?n||e.stringTranslate("toastNotifications","toast_messaging_default_fallback"):n}function lz(e,t,i,a,s){return(0,n.__awaiter)(this,void 0,void 0,(function*(){switch(s.log(`${Ki.f.MappingCommandOptions}: Generating command options for type ${i.type}`),i.type){case OB.Message:case OB.Priority:return function(e,t,i){return Object.assign(Object.assign(Object.assign({},vz(i)),pz(t,i.interopConversationStatus)),{text:az(e,t,i),title:dz(e,t,i),isUrgent:!!i.isUrgent,isFromPriorityContact:!!i.isFromPriorityContact})}(e,t,i);case OB.GroupMessage:return function(e,t,i){return Object.assign(Object.assign(Object.assign({},vz(i)),pz(t,i.interopConversationStatus)),{text:gz(e,t,i),title:i.topic||yz(t,i.members)})}(e,t,i);case OB.Mention:case OB.Reaction:return function(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const s=t.type===OB.Reaction?yield function(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const{id:t}=(0,ez.Mc)(null==i?void 0:i.toLocaleLowerCase().trim());if(!t)return;const{data:n}=yield e.query({query:BB,variables:{searchFilter:t,exactMatch:!0}});return((null==n?void 0:n.searchEmoticons)||[])[0]}catch(e){return void t.error(Ki.f.ChatToastEmoticonsQueryFailed)}}))}(i,a,t.reaction):void 0;return Object.assign(Object.assign({},vz(t)),{text:t.topic||bz(e,t.senderGivenName||t.senderDisplayName,t.members),isUrgent:!!t.isUrgent,isFromPriorityContact:!!t.isFromPriorityContact,title:uz(e,t,(null==s?void 0:s.unicode)||void 0)})}))}(t,i,a,s);case OB.InviteJoined:return function(e,t,i){return Object.assign(Object.assign({},vz(i)),{text:QB(t,yz,i,e),title:KB(t,i,e)})}(e,t,i);case OB.TeamsTasks:return function(e,t,i,a){var s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const o=yield function(e,t,i,a){var s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!a)return;const n=yield e.query({query:qB.br,variables:{id:i,queryType:xe.rtK.QueryByThread},fetchPolicy:"network-only"}).catch((()=>{t.error(Ki.f.ChatTabsFetchFailed)})),o=null===(s=null==n?void 0:n.data.platformTabs)||void 0===s?void 0:s.find((e=>(null==e?void 0:e.entityId)&&(null==e?void 0:e.entityId.toLowerCase().includes(a.toLowerCase()))));return o||t.log(Ki.f.ToastNavigationDataNotFound),o}))}(i,a,t.conversationId,t.tabId);return Object.assign(Object.assign({},vz(t)),{text:JB(e,t)||"",title:null!==(s=GB(t,e))&&void 0!==s?s:"",type:OB.TeamsTasks,tabId:JSON.stringify({tabId:null==o?void 0:o.baseInfo.id,threadId:t.conversationId,appId:null==o?void 0:o.baseInfo.appId,tabEntityId:null==o?void 0:o.entityId})})}))}(t,i,a,s);case OB.DLP:return function(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},vz(t)),{text:t.topic||fz(e,t.displayName||t.senderDisplayName,t.members),isUrgent:!!t.isUrgent,title:mz(e,t)})}))}(t,i);default:return}}))}function dz(e,t,i){var n;let a=hz(t,i);if(zB.eo.isTFLSmsMri(i.senderId))return t.stringTranslate("toastNotifications","toast_messaging_sms_user_given_name",{sender:a});return i.fromExternalUser&&i.senderDecoratedDisplayName&&(a=i.senderDecoratedDisplayName),i.isUrgent&&(null===(n=e.get(S.J.Notifications))||void 0===n?void 0:n.enableUrgentToastsContentFixes)?t.stringTranslate("toastNotifications","toast_messaging_urgent_message_title",{sender:a}):a}function uz(e,t,i){switch(t.type){case OB.Mention:const n="everyone"===t.subtype?"toast_messaging_mention_everyone":"toast_messaging_mention";return`@ ${e.stringTranslate("toastNotifications",n,{sender:t.senderDisplayName})}`;case OB.Reaction:return e.stringTranslate("toastNotifications","toast_messaging_reaction",{sender:t.senderDisplayName,emoji:i})}}function mz(e,t){if(t.type===OB.DLP)return e.stringTranslate("toastNotifications","dlp_notify_sender_header")}function gz(e,t,i){const{enableToastMediaTextPreview:n,enableUrgentToastsContentFixes:a,enableToastDefaultTextFallbackFix:s}=e.get(S.J.Notifications);let o=i.text;if(o=i.isUrgent&&a?sz(t,i,!!s):n?oz(t,i,!!s):cz(t,i.text,!!s),!o)return;let r=i.senderGivenName||hz(t,i);if(zB.eo.isTFLSmsMri(i.senderId))return t.stringTranslate("toastNotifications","toast_messaging_sms_group_text_with_sender",{sender:r,text:o});r=i.senderDecoratedDisplayName||r;const{enableGroupChatInviteFlow:c}=e.get(S.J.Messaging);return c&&i.interopConversationStatus===wB.uI.AcceptPending?t.stringTranslate("toastNotifications","toast_messaging_group_chat_invite_flow_text_with_sender",{displayName:r}):t.stringTranslate("toastNotifications","toast_messaging_group_text_with_sender",{sender:r,text:o})}function hz(e,t){return!t.senderDisplayName||zB.eo.isDisplayNameUnknownUser(t.senderDisplayName)?e.stringTranslate("toastNotifications","toast_unknown_user"):t.senderDisplayName}function pz(e,t){return t===wB.uI.AcceptPending||t===wB.uI.ExtendedDirectoryAcceptPending||t===wB.uI.Quarantined?{quickReply:!1}:{quickReply:!0,quickReplyPlaceholder:e.stringTranslate("toastNotifications","toast_messaging_quickreply_placeholder_text"),quickReplyButton:e.stringTranslate("toastNotifications","toast_messaging_quickreply_button_text")}}function vz(e){return{conversationId:e.conversationId,messageId:e.messageId,quickReply:!1,time:new Date(+e.timestamp),discardDuringMeetingsAndCalls:!!e.discardDuringMeetingsAndCalls}}function fz(e,t,i){if(t)return e.stringTranslate("toastNotifications","toast_messaging_activity_text",{participants:t});const n=kz(e,i);return n?e.stringTranslate("toastNotifications",n.count?"toast_messaging_activity_text_with_count":"toast_messaging_activity_text",{participants:n.displayName,count:n.count}):e.stringTranslate("toastNotifications","toast_messaging_default_group_topic")}function bz(e,t,i){const n=kz(e,i);return n?e.stringTranslate("toastNotifications",n.count?"toast_messaging_activity_text_with_count":"toast_messaging_activity_text",{participants:n.displayName,count:n.count}):t?e.stringTranslate("toastNotifications","toast_messaging_activity_text",{participants:t}):e.stringTranslate("toastNotifications","toast_messaging_default_group_topic")}function yz(e,t){const i=kz(e,t);return i?e.stringTranslate("toastNotifications",i.count?"toast_messaging_group_topic_with_count":"toast_messaging_group_topic",{participants:i.displayName,count:i.count}):e.stringTranslate("toastNotifications","toast_messaging_default_group_topic")}function kz(e,t){if(!t||!Array.isArray(t)||0===t.length)return;const i=e.stringTranslate("toastNotifications","toast_unknown_user"),n=t.map((e=>e.givenName||i));return(0,LB.N)(n,t.length)}function Sz(e,t,i,a,s,o,r,c,l){const{enableCommandToHostCommService:d}=t.get(S.J.Core,["enableCommandToHostCommService"]),{enableBrowserToasts:u,enableInAppNotifications:m,enableInAppNotificationsForChatsAndChannels:g}=t.get(S.J.Notifications,["enableBrowserToasts","enableInAppNotifications","enableInAppNotificationsForChatsAndChannels"]);return{id:"toast-event-subscription",runOncePerId:!0,job:()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const h=r.newLogger("ToastEventSubscription","apps-chat");d||u||m&&g?(h.log(Ki.f.Subscribing),i.subscribe({query:PB,fetchPolicy:"no-cache"}).forEach(function(e,t,i,a,s,o,r,c,l){const{enableToastCollections:d}=t.get(S.J.Notifications);return u=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var n,m;if(u.errors){const e=(0,U.u4)(u.errors.map((e=>e.message)).join());return r.error(`${Ki.f.SubscriptionFailed} ${e}`),void wz(c,{errorCode:Ki.f.SubscriptionFailed,errors:e})}if(!(null===(n=u.data)||void 0===n?void 0:n.toastEvent))return r.error(Ki.f.EmptyEvent),void wz(c,{errorCode:Ki.f.EmptyEvent});r.log(`${Ki.f.ToastEventReceivedInJob}: Received a valid event in the toast subscription job, correlationId:${u.data.toastEvent.correlationId}, activityId:${u.data.toastEvent.activityId}`);const{toastEvent:g}=u.data,h=c.newScenario(z.RG.CrossClientToastView,{startTime:+g.timestamp});h.clientId=g.correlationId,h.appendEventData({activityId:u.data.toastEvent.activityId,isUrgent:!!u.data.toastEvent.isUrgent,mainEntityType:pe.py.chats,mainEntitySubtype:u.data.toastEvent.type,messageId:u.data.toastEvent.messageId}),h.mark(z.ck.CrossClientToastEventReceived),r.log(`${Ki.f.LogToastInfo}: ${JSON.stringify(h.eventData)}`);const p=yield lz(t,s,g,i,r);if(!p)return r.log(`${Ki.f.UnhandledType} ${g.type}`),void h.incomplete({reason:Ki.f.UnhandledType});const v=yield o({id:p.conversationId,type:pe.py.chats,action:pe.uk.view,linkedEntity:null},i);if(h.mark(z.ck.CrossClientConversationFocusChecked),v)return r.log(Ki.f.ToastSuppressedForWindowInFocus),void h.incomplete({reason:Ki.f.ToastSuppressedForWindowInFocus});const f=yield nz(i,r,g,t);h.mark(z.ck.CrossClientAvatarFetched),f&&(p.mainImage={alt:"",src:f}),null===(m=c.hoistScenarioToCore)||void 0===m||m.call(c,h),d&&(p.collectionId=SU(e,l,r)),p.type===OB.TeamsTasks?a.toasts.showChatTabEntityNotification(g.correlationId,p):a.toasts.showMessage(g.correlationId,p),h.mark(z.ck.CrossClientEntityCommandTriggered),r.log(`${Ki.f.ToastCommandSent} type:${p.type} correlationId:${g.correlationId} activityId:${g.activityId}`)}))}(e,t,i,a,s,o,h,c,l))):h.log(Ki.f.NotEnabled)}))}}function wz(e,t){const i=e.newScenario(z.RG.CrossClientToastView);i.appendEventData({mainEntityType:pe.py.chats}),i.fail(t)}const jz=({context:{authenticationUser:e,client:t,coreSettings:i,entityCommanding:n,i18n:a,isEntityInView:s,loggerFactory:o,scenarioFactory:r,userTrackingService:c}})=>[Sz(e,i,t,n,a,s,o,r,c)],Cz=({context:{scenarioFactory:e,coreSettings:t}})=>{const i=[{id:"import-chat-bundle",runOncePerId:!0,job:()=>(({scenarioFactory:e,coreSettings:t})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const i="chat-app";if(null==t?void 0:t.get(S.J.Core).enableSerializeChunkImport){const t=e.findScenario("application_launch_time");null==t||t.mark("load_chat_app_start"),yield(0,Rl.mT)(EB,i,e),null==t||t.mark("load_chat_app_end")}else(0,Rl.mT)(EB,i,e)})))({scenarioFactory:e,coreSettings:t})}];return i};var _z=i(152386);var Tz=i(645534);const Iz=()=>({result:"success"}),Nz=(e,t)=>(t.error("Error executing command in filebrowser pre warm: ".concat(e.message)),{result:"error",error:{code:e.code||"unknown",message:e.message}}),Ez=e=>({result:"error",error:{code:"unsupportedCommand",message:e.command}}),Fz=e=>t=>{e(t.data)},xz=(e,t,i)=>{const{close:a,authenticate:s}=t,o=(({sendAck:e,sendCommandResult:t,close:i,authenticate:a,logger:s})=>o=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if("command"===o.type){e(o);const n=o.data;switch(n.command){case"close":i(n).then((()=>{t(o,Iz())}),(e=>{t(o,Nz(e,s))}));break;case"authenticate":a(n).then((e=>{t(o,e)}),(e=>{t(o,Nz(e,s))}));break;default:t(o,Ez(n))}}})))({sendAck:t=>{e&&e.postMessage({type:"acknowledge",id:t.id})},sendCommandResult:(t,i)=>{e&&e.postMessage({type:"result",id:t.id,data:i})},close:a,authenticate:s,logger:i});((e,t)=>{const i=Fz(t);e&&(e.addEventListener("message",i),e.start(),e.postMessage({type:"activate"}))})(e,o)},Dz={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsBizchatPreWarmAuthenticationTokenQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]},Az=(e,t,i,a,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var o,r,c,l,d,u,m,g,h;const p=t.newLogger("BizChatAppPreWarmStrategy","apps-chat"),v=e.newScenario(z.RG.BizChatPreWarm);v.appendEventData({correlationId:(0,qe.v4)()});const f=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e,t;null===(e=a.document.getElementById("bizChatAppIframe"))||void 0===e||e.remove(),null===(t=p.infoToTelemetry)||void 0===t||t.call(p,"Removed Hidden Iframe","bizchat_pre_warm_info"),null==v||v.stop({reason:"iframe-removed"}),Promise.resolve()})),b=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var t,n,a,s;const{resource:o}=e,r=new URL(o).origin;null===(t=p.infoToTelemetry)||void 0===t||t.call(p,`getAuthToken triggered for resource: ${o}`,"bizchat_pre_warm_info");try{const e=yield i.query({query:Dz,fetchPolicy:"cache-first",variables:{resource:r}});if(!(null===(a=null===(n=e.data)||void 0===n?void 0:n.authenticationToken)||void 0===a?void 0:a.token))throw new Error;return Promise.resolve(e.data.authenticationToken.token)}catch(e){const t=`Failed to get auth token with errorCode ${(null==e?void 0:e.errorCode)||(null==e?void 0:e.code)}`;return null===(s=p.errorToTelemetry)||void 0===s||s.call(p,t,"bizchat_pre_warm_error"),Promise.resolve("")}}));try{null===(o=p.infoToTelemetry)||void 0===o||o.call(p,"BizChat pre-warm job started","bizchat_pre_warm_info");const{data:e}=yield i.query({query:_z.VY,variables:{scope:xe.qi6.Personal,appId:"b5abf2ae-c16b-4310-8f8a-d3bcdb52f162"},context:{callerInfo:"BizChatAppPreWarmStrategy"}});if(!e||!e.appDefinition)return null===(r=p.infoToTelemetry)||void 0===r||r.call(p,"No app definition found. Cancelling bizchat pre-warm job","bizchat_pre_warm_info"),void(null==v||v.cancel({reason:"No App Definition"}));let t=(null===(c=e.appDefinition)||void 0===c?void 0:c.staticTabs)&&(null===(l=e.appDefinition.staticTabs[0])||void 0===l?void 0:l.contentUrl)||void 0;if(!t)return null===(d=p.errorToTelemetry)||void 0===d||d.call(p,"No contentUrl found in the app definition","bizchat_pre_warm_error"),void(null==v||v.fail());const h=null===(m=null===(u=a.loader)||void 0===u?void 0:u.getProperties)||void 0===m?void 0:m.call(u);t=`${t}&prewarm=true&sessionid=${(null==h?void 0:h.sessionId)||St.get("sessionId")}&prewarmid=${v.eventData.correlationId}`;const y=(e=>{const t=e.document.createElement("iframe");return t&&(t.setAttribute("id","bizChatAppIframe"),t.style.display="none",t.setAttribute("target","_self"),e.document.body.appendChild(t)),t&&t.contentWindow||null})(a);if(!y)return null===(g=p.errorToTelemetry)||void 0===g||g.call(p,"Failed to create hidden iframe","bizchat_pre_warm_error"),void(null==v||v.fail());yield((e,t,i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=new URL(t).origin,s=yield i({resource:n});if(s&&e){const i=e.document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","access_token"),i.setAttribute("value",s);const n=e.document.createElement("form");n.appendChild(i),n.setAttribute("action",t),n.setAttribute("method","POST"),e.document.body.appendChild(n),n.submit(),null==a||a.mark("Form Created and submitted")}else null==a||a.fail({errorMessage:"Token fetch failed"})})))(y,t,b),((e,t,i)=>{let n;n=void 0,n=t.setTimeout((()=>{null==i||i(!0),t.clearTimeout(n)}),e)})(18e3,a,f);const k=`${Math.random().toFixed(8)}`,S=yield((e,t,i)=>{let n;const a=new Promise(((a,s)=>{let o;const r=e=>{if(e.source&&t&&e.source===t&&"initialize"===e.data.type){o&&(clearInterval(o),o=void 0);const t=e.ports&&e.ports[0];if(t)return n=t,void a(n);s(n)}};t?(o=setInterval((()=>{var a;n?(clearInterval(o),o=void 0):t.postMessage({type:"identify-parent",channelId:e},null===(a=i.document.location)||void 0===a?void 0:a.origin)}),100),i.addEventListener("message",r)):a(n)}));return a})(k,y,a),w=((e,t,i,a)=>({close:()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){null==i||i.log("Close post meessage received"),null==a||a.mark(Tz.le.telemetry.markers.filebrowser_prewarm_close_post_message),yield t(!1)})),authenticate:t=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){null==i||i.log(`Authenticate post meessage received for ${t.resource}`),null==a||a.mark(Tz.le.telemetry.markers.filebrowser_prewarm_auth_post_message);const n=yield e({resource:t.resource});return n?{result:"token",scheme:"bearer",token:n}:(null==i||i.log("Not able to PreWarm the App"),null==a||a.mark(Tz.le.telemetry.markers.filebrowser_prewarm_auth_token_failed),{result:"error",error:{code:"NoTokenObtained",message:"Could not obtain a token for resource."}})}))}))(b,f,p);xz(S,w,p),null==s||s.set("BizChatAppPreWarmTimeStamp",Date.now().toString())}catch(e){const t=`Failed BizChatAppPreWarmStrategy with errorCode ${(null==e?void 0:e.errorCode)||(null==e?void 0:e.code)}`;null===(h=p.errorToTelemetry)||void 0===h||h.call(p,t,"bizchat_pre_warm_error"),null==v||v.fail()}}));const Mz=({context:{coreSettings:e,hostCommunicationService:t,loggerFactory:i,scenarioFactory:a,client:s,localStorage:o,windowProvider:r,entityCommanding:c,platformService:l,networkState:d,config:u,clientState:m,rebootService:g,userTrackingService:h}})=>{const p=[],{enableBizChatPreWarm:v,bizChatPreWarmRelaunchInterval:f}=e.get(S.J.Messaging);if(v){const v=null==a?void 0:a.newScenario(z.RG.BizChatPreWarmIdleStateTrigger),b=null==o?void 0:o.get("BizChatAppPreWarmTimeStamp");let y=!0;if(b){const e=null!=f?f:288e5,t=+b;y=Date.now()-t>e}y?(null==v||v.stop({reason:"Job-pushed"}),p.push(function({scenarioFactory:e,loggerFactory:t,client:i,windowProvider:a,localStorage:s}){return{id:"bizchat-app-pre-warm",runOncePerId:!0,job:()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){return Az(e,t,i,a,s)}))}}({coreSettings:e,hostCommunicationService:t,loggerFactory:i,scenarioFactory:a,client:s,localStorage:o,windowProvider:r,entityCommanding:c,platformService:l,networkState:d,config:u,clientState:m,rebootService:g,userTrackingService:h}))):null==v||v.stop({reason:"Job-Skipped"})}return p};var Pz=i(832666);const Oz=e=>{if(Rz(e))return Lz(e)?{subNavEntity:Uz(e),headerEntity:$z(e),startEntity:Wz(e),mainEntity:Bz(e),endEntity:zz(e)}:null},Rz=({contextEntity:e,entity:t,layoutMode:i})=>{const{action:n=null,type:a}=Object.assign({},t),{type:s,action:o}=e||{},r=[ve.lO.standard,ve.lO.focus].includes(i),c=[pe.uk.create,pe.uk.default,pe.uk.empty,pe.uk.info,pe.uk.infoDetails,pe.uk.join,pe.uk.list,pe.uk.view,pe.uk.manage],l=n&&c.includes(n),d=o&&s,u=[pe.py.byodchat,pe.py.chats,pe.py.chatschannelconv,pe.py.chatsInfo,pe.py.chatContextualSearch,pe.py.chatsInfoView,pe.py.chatManageApps,pe.py.chatHighlightsDetails,pe.py.chatfilesdetails,pe.py.chatpeopledetails,pe.py.chatworkflows].includes(a),m=i===ve.lO.focus&&n===pe.uk.list;return!(!r||!u||!l&&!d||m)},Lz=({entity:e,contextEntity:t})=>{const{type:i}=t||{},{action:n=null,type:a}=e||{},s=[pe.py.byodattendeewindow,pe.py.calls,pe.py.callsgalleryandcontent,pe.py.callsgallery,pe.py.callscontent,pe.py.platformStage,pe.py.meetingroomallinonecall];return!(a!==pe.py.chats&&a!==pe.py.byodchat&&a!==pe.py.chatsInfoView&&a!==pe.py.chatschannelconv&&!tH(a)||!(n||i&&!s.includes(i)))},Uz=({entity:e,layoutMode:t})=>{if(t===ve.lO.focus)return null;const{type:i,action:n}=e;let a;if("options"in e){const t=e.options&&(0,Om.D)(e.options);((null==t?void 0:t.messageId)||(null==t?void 0:t.searchSessionId))&&(a=Gi.Y.DoNotMove)}a||i!==pe.py.chats&&i!==pe.py.chatschannelconv||n!==pe.uk.default||(a=Gi.Y.LeftRailSelectedItem);return{action:pe.uk.list,entityState:{flushableByLinkedEntity:!0},id:null,linkedEntity:null,options:a?(0,U.u4)({focusOnLoad:a}):null,type:i,windowOptions:null}},$z=({entity:e})=>{let t=pe.uk.view;const{action:i=null}=Object.assign({},e),n=[pe.uk.create,pe.uk.default,pe.uk.empty,pe.uk.join];return i&&n.includes(i)&&(t=i),Object.assign(Object.assign({},e),{action:t})},Wz=()=>null,Bz=({entity:e,contextEntity:t})=>{let i=pe.uk.view;const{action:n=null}=Object.assign({},e),a=[pe.uk.create,pe.uk.default,pe.uk.empty,pe.uk.join,pe.uk.manage];return n&&a.includes(n)&&(i=n),t||Object.assign(Object.assign({},e),{action:i})},zz=({entity:e,contextEntity:t,coreSettings:i,layoutMode:n,userPreferences:a})=>{const{enableChatInfoPaneForMeeting:s,chatInfoPaneVisibilityState:o}=(null==i?void 0:i.get(S.J.Host))||{},{enableChatInfoPaneSearch:r}=(null==i?void 0:i.get(S.J.Messaging))||{},c=qz(i),l=Gz(o,a,c);let d,u,m,g;if(t){if(({id:d,type:u,options:m,action:g}=t),u===pe.py.meetingcollaboration)return t}else({id:d,type:u}=e),"options"in e&&(m=e.options);if(!((e,t,i,n,a)=>{var s;return!(a!==pe.py.chatContextualSearch&&a!==pe.py.chatHighlightsDetails&&a!==pe.py.chatsInfoView&&a!==pe.py.chatsInfo&&a!==pe.py.chatpeopledetails&&a!==pe.py.chatfilesdetails&&(t!==ve.lO.standard||e||!(null===(s=null==n?void 0:n.get(S.J.Core))||void 0===s?void 0:s.enableInfoPaneAsResponsiveMenu))||i&&t!==ve.lO.standard&&t!==ve.lO.focus)})(l,n,r,i,u))return null;const h=Vz(d),p=(0,pB.fM)(d),v=Kz(d,s),f=Hz(u);if(!h&&!p&&eH(u,g,r,!v)){return{action:pe.uk.info,id:d||"",type:u,options:m}}if(!h&&!p&&!v&&f){return{action:pe.uk.info,id:d||"",type:pe.py.chatsInfoView}}if(!h&&!p&&!v&&tH(u)){return{action:pe.uk.infoDetails,id:d||"",type:u,options:m}}return null},Hz=e=>e===pe.py.byodchat||e===pe.py.chats||e===pe.py.chatschannelconv||e===pe.py.chatsInfoView,qz=e=>{if(e){const{enableChatInfoPaneDefaultOpen:t}=e.get(S.J.Messaging),{enableChatInfoPaneDefaultOpen:i}=e.get(S.J.Host);return t||i}return!1},Vz=e=>(0,pB.wm)(e)||(0,pB.UL)(e),Gz=(e,t,i)=>{var n,a;return(null!==(a=null!=e?e:null===(n=null==t?void 0:t.infoPane)||void 0===n?void 0:n.chatsInfoView)&&void 0!==a?a:i?xe.MwA.hidden:xe.MwA.closed)===xe.MwA.closed},Jz=e=>new Map([[Pz.Rd.IS_GREATER_THAN_0,e],[Pz.Rd.IS_AT_LEAST_947,e],[Pz.Rd.IS_AT_LEAST_1350,e],[Pz.Rd.IS_AT_LEAST_1500,e]]),Kz=(e,t)=>!t&&(0,pB.Eu)(e),Qz=(e,t)=>{var i;return null===(i=null==e?void 0:e.find((e=>e.breakpoint===t)))||void 0===i?void 0:i.width},Yz="41rem",Xz="32rem",Zz=({areEmptySlotsTransparent:e,coreSettings:t,entity:i})=>{var n,a,s,o,r,c,l;const{isFlyoutChat:d}=null!==(n=null==t?void 0:t.get(S.J.Flyout))&&void 0!==n?n:{},{isNonInteractiveMeetingChat:u,chatPaneWidthOnLargeScreen:m}=null!==(a=null==t?void 0:t.get(S.J.Calling))&&void 0!==a?a:{};let g=[N.oj.Teacher,N.oj.Student].includes(null==t?void 0:t.get(S.J.UserResources).licenseType)?Jz("32rem"):void 0;if(!g&&u){const{enableResponsiveChatPanel:e}=null!==(s=null==t?void 0:t.get(S.J.Calling))&&void 0!==s?s:{};g=e?new Map([[Pz.Rd.IS_GREATER_THAN_0,Xz],[Pz.Rd.IS_AT_LEAST_1350,null!==(o=Qz(m,Pz.Rd.IS_AT_LEAST_1350))&&void 0!==o?o:Yz],[Pz.Rd.IS_AT_LEAST_2560,null!==(r=Qz(m,Pz.Rd.IS_AT_LEAST_2560))&&void 0!==r?r:"47rem"],[Pz.Rd.IS_AT_LEAST_3840,null!==(c=Qz(m,Pz.Rd.IS_AT_LEAST_3840))&&void 0!==c?c:"72rem"]]):Jz(Yz)}const{chatInfoPaneVisibilityState:h}=null!==(l=null==t?void 0:t.get(S.J.Host))&&void 0!==l?l:{};return g=h&&h===xe.MwA.hidden?new Map([[Pz.Rd.IS_GREATER_THAN_0,"0"],[Pz.Rd.IS_AT_LEAST_947,"0"],[Pz.Rd.IS_AT_LEAST_1350,Xz],[Pz.Rd.IS_AT_LEAST_1500,Xz]]):g,{[xe.tF7.endEntity]:{[Wt.S.Rail]:{slotWidthOverrides:g,isHideInfoPaneDisabled:(null==i?void 0:i.type)===pe.py.chatContextualSearch||(null==i?void 0:i.type)===pe.py.chatHighlightsDetails,infoPaneVisibilityStateInHybrid:h}},[xe.tF7.subNavEntity]:{[Wt.S.Rail]:{areSlotShadowsDisabled:e,isBackgroundTransparent:!!(null==t?void 0:t.get(S.J.Core).enableTransparentLeftRail)||e,isColorSchemeDefaultBackground3:!e}},[xe.tF7.mainEntity]:{[Wt.S.Main]:{isBackgroundTransparent:!!d,infoPaneVisibilityStateInHybrid:h}},[xe.tF7.headerEntity]:{[Wt.S.HorizontalBar]:{isBackgroundTransparent:e}}}},eH=(e,t,i,n)=>t!==pe.uk.infoDetails&&(e===pe.py.chatHighlightsDetails||e===pe.py.chatContextualSearch&&i&&n),tH=e=>e===pe.py.chatpeopledetails||e===pe.py.chatfilesdetails||e===pe.py.chatHighlightsDetails||e===pe.py.chatContextualSearch||e===pe.py.chatsInfo;var iH=i(598135),nH=i(143012),aH=i(491465);const sH={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsChatShowPrivateMeetingConversationMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showPrivateMeetingConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"context"},value:{kind:"Variable",name:{kind:"Name",value:"context"}}}]}]}}]},oH={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsChatSaveCopilotAppStatesMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"streamStopped"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appFocused"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"saveCopilotAppStates"},arguments:[{kind:"Argument",name:{kind:"Name",value:"streamStopped"},value:{kind:"Variable",name:{kind:"Name",value:"streamStopped"}}},{kind:"Argument",name:{kind:"Name",value:"appFocused"},value:{kind:"Variable",name:{kind:"Name",value:"appFocused"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"streamStopped"}},{kind:"Field",name:{kind:"Name",value:"appFocused"}}]}}]}}]},rH="/l/invite/",cH="/l/claim",lH={[cH]:Kn.DL.Claim,[rH]:Kn.DL.Invite},dH=new Set([cH,rH]),uH=(e,t,i,n,a)=>{var s;const o=new URLSearchParams(e.search),r=null===(s=o.get("users"))||void 0===s?void 0:s.split(",").map((e=>e.trim())),c=o.get("message"),l=o.get("topicName");return i.stop({reason:`deeplink to chat with users: userCount-${null==r?void 0:r.length} isMessagePresent:${!!c} isTopicNamePresent:${!!l}`}),t.log("deeplink_to_chat_qsp_received"),Promise.resolve({entityCommand:{entity:{type:pe.py.chats,action:pe.uk.view},command:{visibilityState:ve.fe.show,stateTransition:ve.su.new},correlation:{source:k.D.ChatDeeplinkUsers},entityOptions:{initialComposeMessage:c,groupName:l,users:r,isViewFromChatDeeplink:!0}},metadata:{allowAnonymous:!1,accountToUse:hH(a,n)}})},mH=(e,t,i,n,a)=>{var s;const o=e.pathname.split("/");return o.length>3&&(o[3].startsWith(wB.at.SkypeSpacesThread)||(0,vB.mB)(o[3])||(0,pB.wm)(o[3]))?(i.stop({reason:`deeplink to chat with id: ${o[3]}`}),Promise.resolve({entityCommand:{entity:{type:pe.py.chats,action:pe.uk.view,id:o[3]},command:{visibilityState:ve.fe.show,stateTransition:ve.su.new},correlation:{source:k.D.ChatDeeplinkId}},metadata:{allowAnonymous:!1,accountToUse:hH(a,n)}})):(i.fail({reason:`deeplink to chat fail with invalid path: ${(0,se.A)(e.pathname.replace(/@/g,"_at_"))}`}),null===(s=t.warnNoPii)||void 0===s||s.call(t,`invalid path name ${e.pathname}`),Promise.reject("Deeplink to chat path invalid"))},gH=(e,t)=>Promise.resolve({entityCommand:{entity:{type:pe.py.chats,action:pe.uk.join},command:{visibilityState:ve.fe.show,stateTransition:ve.su.flush},entityOptions:{inviteLinkType:t,inviteLinkUrl:e.toString()}},metadata:{allowAnonymous:!1}}),hH=(e,t)=>{if(e)return t&&(e=>{switch(e){case _N.MainWindow:return fo.TS.MainWindowAccount;case _N.SourceWindow:return fo.TS.SourceWindowAccount;default:return fo.TS.UserChoiceFallback}})(t.userContextAccountType)},pH=(e,t,i,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n;try{yield e.mutate({mutation:sH,variables:{conversationId:t,context:"apps-chat"}}),a.mark(z.ck.ExtDeeplinkToChatMessageUnhideThreadSuccess)}catch(e){const s=`Failed to unhide chat thread ${t} in deeplink to chat message`;null===(n=i.errorNoPii)||void 0===n||n.call(i,s),a.mark(z.ck.ExtDeeplinkToChatMessageUnhideThreadFail)}})),vH="chat",fH="viewChatApp",bH="chatWithUsers",yH={id:"com.microsoft.teams.chat",name:"Chat",getLocalizedName:e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("messaging"),e.stringTranslate("messaging","messaging_app_name")})),actors:[vH],supportedEntities:[pe.py.alttext,pe.py.byodchat,pe.py.chats,pe.py.chatschannelconv,pe.py.chatContextualSearch,pe.py.chatHighlightsDetails,pe.py.chatfilesdetails,pe.py.chatManageApps,pe.py.chatpeopledetails,pe.py.chatsInfo,pe.py.chatsInfoView,pe.py.codesnippet,pe.py.customizereactions,pe.py.customemojiupload,pe.py.deletechat,pe.py.dlp,pe.py.fluid,pe.py.giphyconsent,pe.py.hyperlink,pe.py.chatInviteConfirmation,pe.py.leavechat,pe.py.messagedraft,pe.py.pinnedchatsmaxreached,pe.py.pinnedconversationitems,pe.py.removechatuser,pe.py.reportConcern,pe.py.forwardMessage,pe.py.reportConcernForTFW,pe.py.sharechatlink,pe.py.streamcamera,pe.py.streamcamerainchannels,pe.py.streamcameraincommunities,pe.py.translationfeedback,pe.py.twowaysmsfriendlyname,pe.py.updategroupchatavatar,pe.py.tfwupdategroupchatavatar,pe.py.blockChat,pe.py.leaveGroupAndBlockUser,pe.py.m365ChatLike,pe.py.m365ChatDislike,pe.py.m365ChatReportHarm,pe.py.chatworkflows],supportedRenderModes:[Wt.S.HorizontalBar,Wt.S.Main,Wt.S.Modal,Wt.S.Rail],getDefaultCommand:e=>{const{enableFilterPinnedAppsBasedOnPolicy:t}=e.get(S.J.Extensibility);if(!t||(0,fB.t3)(e.get(S.J.Messaging))!==fB.i1.Disabled)return{action:pe.uk.default,type:pe.py.chats}},windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20,widthToScreenWidthRatio:.3,heightToWidthRatio:1.125},infoPaneStateMapping:{[pe.py.chatpeopledetails]:pe.py.chatsInfoView,[pe.py.chatfilesdetails]:pe.py.chatsInfoView},getAllowUserWindowingPreference:({coreSettings:e})=>!!e.get(S.J.Chat).chatDeeplinkRespectUserPreference},kH={shouldAddEntitiesToWindowHistory:e=>{var t,i;return!(0,pB.UL)(null===(t=null==e?void 0:e.mainEntity)||void 0===t?void 0:t.id)&&(null===(i=null==e?void 0:e.mainEntity)||void 0===i?void 0:i.action)!==pe.uk.create},shouldRestoreClientToEntities:()=>!0,shouldStoreLastVisitedInAppHistory:()=>!0},SH={onEventReceived:({eventInput:e})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var t,i,n,a,s,o,r,c;switch(e.event.type){case u$.uS.requestPersonMoreInfo:const l=null===(i=(t=e.event).data)||void 0===i?void 0:i.call(t);return Promise.resolve({command:p$(l)});case u$.uS.requestTopicMoreInfo:{const t=null===(a=(n=e.event).data)||void 0===a?void 0:a.call(n);return Promise.resolve({command:v$(t)})}case Ce.uS.expandTab:{const t=null===(o=(s=e.event).data)||void 0===o?void 0:o.call(s);return Promise.resolve({command:Te.CN.expandTab(t)})}case Ce.uS.resetLayoutOverrides:return Promise.resolve({command:Te.CN.resetLayoutOverrides()});case Ce.uS.maximizeTab:return Promise.resolve({command:Te.CN.maximizeTab()});case Ce.uS.showMonitor:return Promise.resolve({command:Te.CN.showMonitor(null===(c=(r=e.event).data)||void 0===c?void 0:c.call(r))});case Ce.uS.closeMonitor:return Promise.resolve({command:Te.CN.closeMonitor()});case Ce.uS.hideMonitor:return Promise.resolve({command:Te.CN.hideMonitor()});case Ce.uS.unhideMonitor:return Promise.resolve({command:Te.CN.unhideMonitor()})}return Promise.resolve(void 0)}))},wH="openContextualSearch",jH={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsChatChatWithUserQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"createLieIfNotFound"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chatWithUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"createLieIfNotFound"},value:{kind:"Variable",name:{kind:"Name",value:"createLieIfNotFound"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var CH=i(90586);const _H=({commandInput:e,requestContext:{loggerFactory:t,client:i,executionContext:a}})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:s,data:o}}=e,r=t.newLogger("ChatApp onCommandReceived","apps-chat");if(e.command.actor===vH)switch(s){case fH:return{entity:{type:pe.py.chats,action:pe.uk.default},command:{visibilityState:ve.fe.show,stateTransition:ve.su.flush,correlation:{source:k.D.Unknown}}};case bH:if(!(e=>"object"==typeof e&&null!==e&&"mri"in e&&"correlationSource"in e)(o))return void r.error(`Command for action '${s}' requires an mri and correlationSource.`);const e=i,t=yield((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{data:i}=yield e.query({query:jH,variables:{userId:t,createLieIfNotFound:!0},fetchPolicy:"network-only"});return null==i?void 0:i.chatWithUser})))(e,o.mri),c=null==t?void 0:t.id;return c?{entity:{type:pe.py.chats,action:pe.uk.view,id:c},command:{stateTransition:ve.su.new,visibilityState:ve.fe.show,correlation:{id:(0,qe.v4)(),source:o.correlationSource,startTimestamp:Date.now()}}}:void r.error("Could not fetch the user conversation using the mri");case wH:if(!(e=>"object"==typeof e&&null!==e&&"searchQuery"in e&&"entrySource"in e)(o))return void r.error(`Command for action '${s}' requires a searchQuery and entrySource.`);const{entityTypeChat:l,entityTypeChannel:d}=(e=>{var t;const i=null===(t=e.viewEntities.mainEntity)||void 0===t?void 0:t.type;return{entityTypeChat:i===pe.py.chats,entityTypeChannel:i===pe.py.channels}})(a);if(!l&&!d)return void r.error(`Command for action '${s}' requires entity type to be ${pe.py.chats} or ${pe.py.channels}`);const u=((e,t,i)=>{var n,a;const s=t.entrySource===k.D.Autosuggest?`$$${(0,qe.v4)()}`:"";let o;if(i)o=`${null===(n=e.viewEntities.mainEntity)||void 0===n?void 0:n.id}${s}`;else{const t=JSON.parse((null===(a=e.viewEntities.mainEntity)||void 0===a?void 0:a.id)||"").channelId;o=JSON.stringify({channelId:`${t}${s}`})}return o})(a,o,l),m=l?pe.py.chatContextualSearch:pe.py.channelcontextualsearch,g=l?k.D.ChatContextualSearch:k.D.ChannelContextualSearch;return{entity:{id:u,action:pe.uk.info,type:m},command:{visibilityState:ve.fe.show,stateTransition:ve.su.none,correlation:{id:(0,qe.v4)(),source:g}},entityOptions:{detailViewType:CH.em.Search,searchQuery:o.searchQuery,entrySource:o.entrySource}};default:r.error(`Command action '${s}' is not supported at ChatApp.`)}else r.error(`Command for actor '${e.command.actor}' cannot be handled by ChatApp.`)})),TH=({appViewState:e,availableEntities:t,requestContext:i})=>{var n,a,s,o,r,c,l,d,u,m,g;const{selectedChatId:h}=e,{coreSettings:p}=i,v=p.get(S.J.ChatList).bizChatMetaOSAppId;if((null===(n=t.mainEntity)||void 0===n?void 0:n.type)===pe.py.chats&&((null===(a=t.mainEntity)||void 0===a?void 0:a.action)===pe.uk.view||(null===(s=t.mainEntity)||void 0===s?void 0:s.action)===pe.uk.create||(null===(o=t.mainEntity)||void 0===o?void 0:o.action)===pe.uk.default)||(null===(r=t.mainEntity)||void 0===r?void 0:r.type)===pe.py.chatschannelconv&&(null===(c=t.mainEntity)||void 0===c?void 0:c.action)===pe.uk.view||(null===(l=t.mainEntity)||void 0===l?void 0:l.type)===pe.py.chatManageApps){const e=null===(d=t.mainEntity)||void 0===d?void 0:d.id;(null==h?void 0:h.read())!==e&&(null==h||h.update((null===(u=t.mainEntity)||void 0===u?void 0:u.action)===pe.uk.create||null===(m=t.mainEntity)||void 0===m?void 0:m.id))}else if((null===(g=t.mainEntity)||void 0===g?void 0:g.type)===pe.py.extensions&&t.mainEntity.action===pe.uk.view&&t.mainEntity.id){let e;try{e=JSON.parse(t.mainEntity.id).appId}catch(t){e=void 0}e&&v===e&&(null==h?void 0:h.read())!==e&&(null==h||h.update(e))}return Promise.resolve(void 0)},IH={gqlTypeName:"ChatAppViewState",queryFieldName:"chatAppViewState",computedValues:void 0,navigationalFieldDefaultValues:{},nonNavigationalFieldDefaultValues:{selectedChatId:null}},NH=({children:e})=>Se.createElement(Se.Fragment,null,e),EH=(e,t,i)=>{const n=e.command.correlation.source,{entity:a,command:s,entityOptions:o}=e,r=!(!o||!o.messageId),c=null==o?void 0:o.isViewFromSimpleCollab;return a.type===pe.py.chats&&c?z.RG.SimpleCollabChatSwitch:a.type===pe.py.chats&&s.stateTransition===ve.su.new&&s.visibilityState===ve.fe.show?r?z.RG.EntityCommand:(0,vB.j8)(a.id)?z.RG.PhonelinkSmsChatPopOut:z.RG.ChatPopOut:a.type!==pe.py.chats&&a.type!==pe.py.byodchat||a.action!==pe.uk.view&&a.action!==pe.uk.default||s.visibilityState!==ve.fe.show||n===k.D.StandAlone?a.type===pe.py.chatContextualSearch&&a.action===pe.uk.info&&s.visibilityState!==ve.fe.hide?z.RG.ContextualSearchStart:a.type===pe.py.chatHighlightsDetails&&a.action===pe.uk.info&&s.visibilityState===ve.fe.show?z.RG.ChatHighlightsDetailsStart:z.RG.EntityCommand:r?z.RG.EntityCommand:((e,t,i)=>{if(e.id===pB.FX)return z.RG.NewChat;if(t===k.D.ChatListMeetingItem||t===k.D.Calendar||(0,pB.Eu)(e.id))return z.RG.MeetingChatSwitch;const{isFlyoutChat:n}=i.get(S.J.Flyout);if(n)return(0,vB.j8)(e.id)?z.RG.PhonelinkSmsInlineChatSwitch:z.RG.InlineChatSwitch;const{chatSwitchInPopOut:a}=i.get(S.J.Chat);return a?z.RG.ChatSwitchPopOut:(0,vB.j8)(e.id)?z.RG.PhonelinkSmsChatSwitch:z.RG.ChatSwitch})(a,n,i)},FH=({coreServices:e,host:t,prevEntityType:i,screenState:n,windowOptions:a})=>{if(i===pe.py.chats)return null;const{height:s,minHeight:o,minWidth:r,offset:c,width:l}=yH.windowFeatures||{},d={left:(null==t?void 0:t.screenX)||0,top:(null==t?void 0:t.screenY)||0},u=((null==n?void 0:n.numOpenWindows)||1)*(c||1);return Object.assign(Object.assign({additionalFeatures:{minHeight:`${o}`,minWidth:`${r}`},height:s,left:(null==d?void 0:d.left)+u,minHeight:o,minWidth:r,top:(null==d?void 0:d.top)+u,width:l},(null==e?void 0:e.coreSettings.get(S.J.Core).enableRatioToScreenBasedSizing)&&function(e,t){const{widthToScreenWidthRatio:i,heightToWidthRatio:n}=t||{};if(!e||!n||!i)return{};const a=i*e.screen.availWidth;return{height:a*n,width:a}}(t,yH.windowFeatures)),a)};const xH=()=>{const e=({deeplinkUrl:e,context:t})=>{const i=t.loggerFactory.newLogger("ChatApp","apps-chat");return((e,t,i)=>{const{pathname:n}=i,{enableInviteLinks:a}=e.get(S.J.InviteLinks);for(const e of Array.from(dH))if(n.startsWith(e)){if(!a){const e="Invite link redemption is disabled for this experience";return t.error(e),Promise.reject(e)}const n=lH[e];if(void 0===n){const e="No Invite link type found for the specified prefixType";return t.error(e),Promise.reject(e)}return gH(i,n)}const s="No DeeplinkPrefixType found for the specified deeplinkUrl";return t.error(s),Promise.reject(s)})(t.coreSettings,i,e)},t=(e,t)=>{if(t){const t=e.find((e=>e.userContextAccountType===_N.SourceWindow));if(t)return t}return e&&e.length>0?e[e.length-1]:void 0},i={filter:"/l/chat",execute:({deeplinkUrl:e,context:{getUserContexts:i,loggerFactory:a,scenarioFactory:s,coreSettings:o}})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=a.newLogger("ChatApp_parseChatDeeplink","apps-chat"),r=!!o.get(S.J.Chat).chatDeeplinkRespectUserPreference,c=yield i(),l=t(c,r);return((e,t,i,n,a)=>{const s=i.newScenario(z.RG.ExtDeeplinkToChat);if(e.pathname.startsWith("/l/chat/0/0"))return uH(e,t,s,n,a);{const{pathname:o,search:r}=e;t.log(`Parsing deeplinkUrl - pathname: ${o}, search: ${r}`);const c=decodeURIComponent(o),l=c.split("/"),d=null==c?void 0:c.split(/[/?&]/),u=null==d?void 0:d.indexOf("chat"),m=null==d?void 0:d[u+nH.ei],g=l.findIndex((e=>e.startsWith(wB.at.SkypeSpacesThread))),h=l[g],p=new URLSearchParams(r),v=p.get("context");let f;try{f=v&&JSON.parse(v)}catch(e){const t="executeChatDeeplinkUrl(): Unable to parse context.";throw s.fail({reason:t}),new Error(t)}const b=p.get("tenantId")||void 0;if((null==m?void 0:m.startsWith(nH.pQ))||Object.keys(nH.ox).includes(m)){const t=(0,nH.Jj)("",h,e,b,f,m,i);return s.stop({reason:"deeplink to chat tab"}),Promise.resolve(t)}return mH(e,t,s,n,a)}})(e,n,s,l,r)}))},a={filter:e=>{var t;if(null===(t=e.pathname)||void 0===t?void 0:t.startsWith("/l/message")){const t=new URLSearchParams(e.search).get("context");try{const e=null==t?null:JSON.parse(t);return"chat"===(null==e?void 0:e.contextType)}catch(e){return!1}}return!1},execute:({deeplinkUrl:e,preferredCommandInput:i,context:{getUserContexts:a,loggerFactory:s,scenarioFactory:o,coreSettings:r}})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var c,l;const d=s.newLogger("ChatApp_parseChatDeeplink","apps-chat"),u=[k.D.ActivityFeed,k.D.ActivityFeedBellClick],m=!(!!(null===(c=null==i?void 0:i.correlation)||void 0===c?void 0:c.source)&&u.includes(null===(l=null==i?void 0:i.correlation)||void 0===l?void 0:l.source))&&!!r.get(S.J.Chat).chatDeeplinkRespectUserPreference,g=yield a(),h=t(g,m);return((e,t,i,a,s,o,r)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n,c,l;const d=a.newScenario(z.RG.ExtDeeplinkToChatMessage),{enableChatDeeplinkUnhideThread:u}=t.get(S.J.Calling);if(!e.pathname.startsWith("/l/message"))return d.fail({reason:z.ck.ExtDeeplinkToChatMessagePathNotFound}),i.log("ext_deeplink_to_chat_message_path_not_found"),Promise.reject("Deeplink to chat message path not found");const m=e.pathname.split("/"),g=m[3];if(d.appendEventData({"Thread.Id":g}),m.length>3&&!g.startsWith(wB.at.SkypeSpacesThread)&&!g.startsWith(wB.at.PrivateFeed))return d.fail({reason:z.ck.ExtDeeplinkToChatMessageTypeNotSupported}),i.log("ext_deeplink_to_chat_message_type_not_supported"),Promise.reject("Deeplink to chat message type not supported");let h=4<=m.length?m[4]:void 0;h="0"===h?void 0:h,d.mark(z.ck.ExtDeeplinkToChatMessageParamsReceived),i.log("ext_deeplink_to_chat_message_params_received");const p=null===(n=null==o?void 0:o.context)||void 0===n?void 0:n.client;if(p){if(u&&(0,pB.Eu)(g)){const e=`Unhiding chat thread ${g} in deeplink to chat message`;i.log(e),d.mark(z.ck.ExtDeeplinkToChatMessageUnhideThreadStart),yield pH(p,g,i,d)}const{data:e}=yield p.query({query:aH.vh,variables:{convId:g},context:{callerInfo:"apps-chat"}}),t=null==e?void 0:e.chat;if(t&&(!t.memberIds||0===t.memberIds.length))return d.fail({reason:z.ck.ExtDeeplinkToChatMessageUserIsNotMember}),i.log("ext_deeplink_to_chat_message_user_is_not_member."),Promise.resolve({entityCommand:{entity:{type:pe.py.chats,action:pe.uk.error,id:iH.P.UnableToViewChat},command:{stateTransition:ve.su.extend,visibilityState:ve.fe.show}},metadata:{allowAnonymous:!1}})}d.stop({reason:z.ck.ExtDeeplinkToChatMessageResolved}),i.log("ext_deeplink_to_chat_message_resolved");const v=(0,qe.v4)();return Promise.resolve({entityCommand:{entity:{type:pe.py.chats,action:pe.uk.view,id:g},command:{visibilityState:null!==(c=null==s?void 0:s.visibilityState)&&void 0!==c?c:ve.fe.show,stateTransition:null!==(l=null==s?void 0:s.stateTransition)&&void 0!==l?l:ve.su.new},correlation:{source:k.D.ChatDeeplinkMessage},entityOptions:{messageId:h,uniqueId:v}},metadata:{allowAnonymous:!1,accountToUse:hH(r,o)}})})))(e,r,d,o,i,h,m)}))},s={filter:"/l/copilot",execute:({deeplinkUrl:e,context:{getUserContexts:i,loggerFactory:a,coreSettings:s,scenarioFactory:o}})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=!!s.get(S.J.ChatList).enableBizChatMetaOSEntryPoint,r=a.newLogger("ChatApp_parseCopilotDeeplink","apps-chat"),c=!!s.get(S.J.Chat).chatDeeplinkRespectUserPreference,l=yield i(),d=t(l,c);return((e,t,i,n,a)=>{var s,o;const r=null===(s=null==a?void 0:a.context)||void 0===s?void 0:s.client,{search:c}=e,l=i.newScenario(z.RG.CopilotAppDeeplinkExecute);if(!e.pathname.startsWith("/l/copilot"))return l.fail({reason:"Invalid deeplink path"}),Promise.reject("Invalid deeplink path");if(l.mark(z.ck.CopilotAppDeeplinkReceived),!n)return l.stop({reason:"Deeplink call not handled because enableBizChatMetaOSEntryPoint is not enabled."}),Promise.resolve(void 0);if("?bold=false"===c)return l.stop({reason:"Expected: deeplink call not handled due to app reloads."}),Promise.resolve(void 0);try{r.mutate({mutation:oH,variables:{streamStopped:!0},fetchPolicy:"no-cache"}).then((()=>{l.mark(z.ck.CopilotAppDeeplinkStatesWritten),l.stop({reason:"Deeplink call successfully handled."})}))}catch(e){null===(o=t.errorToTelemetry)||void 0===o||o.call(t,"Could not write copilot app states to the cache.","messaging_copilot_app",void 0,!0),l.fail({reason:"Could not write copilot app states to the cache."})}return Promise.resolve(void 0)})(e,r,o,n,d)}))};return[{filter:"/l/claim",execute:e},{filter:"/l/invite/",execute:e},i,a,{filter:({protocol:e,pathname:t})=>{return"im:"===e||"sip:"===e&&(i=t.trim(),/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(i.toLowerCase()));var i},execute:({deeplinkUrl:e,context:{getUserContexts:i,loggerFactory:a,coreSettings:s}})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n;const o=a.newLogger("ChatApp_parseChatProtocolDeeplink","apps-chat"),r=(null===(n=yH.getAllowUserWindowingPreference)||void 0===n?void 0:n.call(yH,{coreSettings:s}))||!1,c=yield i(),l=t(c,r);return((e,t,i,n)=>{const{protocol:a,pathname:s}=e;return t.log(`ChatApp_parseChatProtocolDeeplink: Deeplink to chat from protocol ${a} with pathname: ${s} received`),Promise.resolve({entityCommand:{entity:{type:pe.py.chats,action:pe.uk.view},command:{visibilityState:ve.fe.show,stateTransition:ve.su.new},correlation:{source:k.D.ChatProtocolDeeplink},entityOptions:{users:[e.pathname],isViewFromChatDeeplink:!0}},metadata:{allowAnonymous:!1,accountToUse:hH(n,i)}})})(e,o,l,r)}))},s]};function DH(){const e=xH();return{eventHandlers:SH,getAppPhases:xB,getAppViewEntities:Oz,getAppViewEntitiesProps:Zz,getAppWindowFeatures:FH,getCommandScenarioName:EH,getPlatformAppIdForEntity:e=>e.type===pe.py.chats||e.type===pe.py.chatschannelconv?"86fcd49b-61a2-4701-b771-54728cd291fb":void 0,manifest:yH,onBeforeAddToNavigation:kH,onBeforeCommandHandled:jB,onBeforeDeeplinkParsed:e,onCommandReceived:_H,onPreInit:Cz,onPreWarm:jz,onRegister:e=>{e.registerTask(new Mr)},onViewUpdateCommandResolved:TH,render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:i,coreSettings:a})=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enableEntityMoreInfo:s=!1}=a.get(S.J.Core),{ChatViewsRenderer:o,LPC:r}=yield((e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n="chat-app";t("ChunkLoadStarted",{chunkName:n});const{ChatViewsRenderer:a}=yield(0,Rl.mT)(EB,n,e),{LPC:s}=i?{LPC:NH}:yield(0,Rl.mT)(FB,n,e);return t("ChunkLoadSucceeded",{chunkName:n}),{ChatViewsRenderer:a,LPC:s}})))(i,t,!!s),c=s?NH:cW.p3;return Se.createElement(QL.f,{namespaces:["calling","chatList","compose","extensibility","files","lightbox","messaging","meetingAnalytics","urlPreview","datepicker","phonelinkSms"],loaderRenderer:null},Se.createElement(r,null,Se.createElement(c,null,Se.createElement(o,{appRenderMode:e}))))})),viewStateRegistration:IH,onExperienceIdle:Mz}}const AH={getDefaultCommand:()=>({type:pe.py.meetings,action:pe.uk.view}),id:"com.microsoft.teams.meeting-options",name:"MeetingOptionsApp",supportedRenderModes:[Wt.S.Main,Wt.S.Modal],supportedEntities:[pe.py.meetings,pe.py.meetingsettings,pe.py.licenses,pe.py.meetingoptionscreatedialog],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},MH=e=>{if(PH(e))return OH(e)?{subNavEntity:RH(e),headerEntity:LH(e),startEntity:UH(e),mainEntity:$H(e),endEntity:WH(e)}:null},PH=({layoutMode:e,entity:t})=>{const{action:i=null,type:n}=Object.assign({},t),a=[ve.lO.focus,ve.lO.standard].includes(e),s=[pe.py.meetings,pe.py.meetingsettings,pe.py.licenses,pe.py.meetingoptionscreatedialog].includes(n),o=[pe.uk.default,pe.uk.view],r=i&&o.includes(i);return!!(a&&s&&r)},OH=()=>!0,RH=()=>null,LH=()=>null,UH=()=>null,$H=({entity:e})=>e,WH=()=>null,BH=()=>({[xe.tF7.mainEntity]:{[Wt.S.Main]:{isBackgroundTransparent:!0}}}),zH=()=>Promise.all([i.e(958828),i.e(743719),i.e(923731),i.e(711340),i.e(890032),i.e(983436),i.e(289585),i.e(978428),i.e(356859),i.e(385190),i.e(104526),i.e(290689),i.e(826310),i.e(680562),i.e(404342),i.e(615942),i.e(765745),i.e(375558)]).then(i.bind(i,112853));function HH(){return{getAppViewEntities:MH,getAppViewEntitiesProps:BH,manifest:AH,onRegister:e=>{e.registerTask(new Mr)},render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:i})=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const n="meeting-options-app";t("ChunkLoadStarted",{chunkName:n});const{MeetingOptions:a}=yield(0,Rl.mT)(zH,n,i);return t("ChunkLoadSucceeded",{chunkName:n}),Se.createElement(qH,{scenarioFactory:i},Se.createElement(a,{appRenderMode:e}))}))}}const qH=({scenarioFactory:e,children:t})=>(VH(e),Se.createElement(Se.Fragment,null,t)),VH=e=>{const t=Se.useRef(e.findScenario(z.RG.MeetingOptionsStart));Se.useEffect((()=>{t.current||(t.current=e.cancelExistingAndCreateScenario(z.RG.MeetingOptionsStart,"remount"))}),[e])};var GH=i(369398),JH=i(548996);const KH=new Set([pe.py.chats,pe.py.calls,pe.py.taskmodule,pe.py.hwctaskmodule,pe.py.extensions]);var QH=i(470901),YH=i(18564);const XH="/l/stage",ZH="No DeeplinkPrefixType found for the specified deeplinkUrl",eq=e=>{const{pathname:t,search:i}=e,n=new URLSearchParams(i).get("context"),a=n&&JSON.parse(n),s=t.split(/[/?&]/),o=s.indexOf("stage");return{appId:s[o+1],deeplinkContext:a}},tq={filter:e=>{if(!e.pathname.startsWith(XH))return!1;try{const{appId:t,deeplinkContext:i}=eq(e),{contentUrl:n,websiteUrl:a}=i;return!!(t&&i&&n&&a)}catch(e){return!1}},execute:({deeplinkUrl:e,context:{loggerFactory:t,scenarioFactory:i,coreSettings:a,getUserContexts:s},sourceViewEntity:o})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n;const r=t.newLogger("PlatformApp_parseStageDeeplink","apps-platform-app"),{enableReactStageModal:c,disablePlatformEntityIdDecoding:l}=a.get(S.J.Extensibility);if(!c)return Promise.reject("Stage modal feature flag is disabled");if(!e.pathname.startsWith(XH))return r.log(ZH),Promise.reject(ZH);if(!o){const e="No sourceViewEntity found";return r.log(e),Promise.reject(e)}const{chatId:d,parentMessageId:u,channelMeetingMessageId:m,replyChainId:g,channelId:h}=(0,YH.g)(o,r,!!l),{appId:p,deeplinkContext:v}=eq(e),{contentUrl:f,websiteUrl:b,title:y}=v;let k={appId:p,tabInfo:JSON.stringify({tabInfo:{contentUrl:f,websiteUrl:b,name:y}}),entryPoint:$n.mQ.deepLinkStageModal,convId:""};k=v.threadId?Object.assign(Object.assign({},k),{convId:v.threadId,channelId:v.threadId}):Object.assign(Object.assign({},k),{messageId:m||u,replyChainId:g,convId:null!=h?h:d||"",channelId:h});const w=yield s();let j;return w&&w.length>0?(j=null===(n=w[w.length-1].context)||void 0===n?void 0:n.client,(0,QH.A)(k,a,j,i,r).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e)))):Promise.reject("No user context found")}))},iq={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsHostedWebContentSendExternalAuthDeeplinkMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"authId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"result"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendExternalAuthDeeplink"},arguments:[{kind:"Argument",name:{kind:"Name",value:"authId"},value:{kind:"Variable",name:{kind:"Name",value:"authId"}}},{kind:"Argument",name:{kind:"Name",value:"result"},value:{kind:"Variable",name:{kind:"Name",value:"result"}}}]}]}}]},nq={reloadTrigger:!1},aq={id:""},sq="/l/entity",oq="/l/task",rq="No DeeplinkPrefixType found for the specified deeplinkUrl",cq={[sq]:Kn.DL.PlatformExtension},lq=e=>{const{pathname:t,search:i}=e,n=new URLSearchParams(i),a=n.get("context"),s=n.get("tenantId");let o;try{o=a&&JSON.parse(a)}catch(e){}const r=null==o?void 0:o.channelId,c=null==o?void 0:o.chatId,l=null==t?void 0:t.split(/[/?&]/),d=null==l?void 0:l.indexOf("entity");return{tenantId:s,appId:null==l?void 0:l[d+1],entityId:decodeURIComponent((null==l?void 0:l[d+2])||""),channelId:r,chatId:c,deeplinkContext:o,pathname:t}},dq=new Set([sq]),uq=(e,t,i,n,a,s,o,r,c)=>{null==r||r.mark("create_deeplink_command"),a.log(`create_deeplink_command with appId: ${t} tabEntityId:${i} context: ${n}`);const l=JSON.stringify({appId:t,tabEntityId:i,subEntityId:null==n?void 0:n.subEntityId});s&&aq.id===l?nq.reloadTrigger=!nq.reloadTrigger:nq.reloadTrigger=!1,aq.id=l;const d=!(null==n?void 0:n.channelId)&&!(null==n?void 0:n.chatId)||s?(0,nH.Pq)(t,!1,nq.reloadTrigger,s,k.D.PlatformPersonalAppDeepLink,i,o,null==n?void 0:n.subEntityId,void 0,e,!0):(0,nH.PO)(e,t,n.channelId||"",n.chatId||"",i,o,null==n?void 0:n.subEntityId),u={entityCommand:Object.assign({},d),metadata:{allowAnonymous:!1,tenantId:null!=c?c:void 0}};return null==r||r.mark("return_deeplink_command"),null==r||r.appendEventData({"PlatformTabDeeplink.generatedCommand":u.toString()}),Promise.resolve(u)},mq=()=>i.e(22463).then(i.bind(i,870586)),gq=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{deeplinkUrl:i,preferredCommandInput:n,context:{coreSettings:a,loggerFactory:s,scenarioFactory:o}}=e,r=s.newLogger("platform-app","apps-platform-app"),{enablePlatformDeepLinkRouting:c,appIdList:l,disabledTabAppIds:d,isAllowedAppList:u}=a.get(S.J.Extensibility),m=l&&JSON.parse(l),{appId:g}=lq(i),h=(0,JH.fk)(r,g,!1,d||[],m,u);if(c&&h)return Promise.reject(`App ${g} is not supported for deeplink navigation in T2.1`);const p=new URLSearchParams(i.search).get("context");let v;try{v=p&&JSON.parse(p)}catch(e){null===(t=r.errorToTelemetry)||void 0===t||t.call(r,"[parseAndExecuteDeeplink] could not parse deeplink context","platform_deeplink_context_parse_error")}return!c&&(null==v?void 0:v.channelId)&&(null==v?void 0:v.chatId)?Promise.reject("Feature for parsing teams and channels deep links in T2.1 is not enabled"):((e,t,i,n,a)=>{var s,o,r,c,l;const{appId:d,entityId:u,deeplinkContext:m,pathname:g,tenantId:h}=lq(e);t.log(`Parsing deepLink for platform app - appId: ${d}, pathname: ${g}`);const p=null===(s=null==a?void 0:a.correlation)||void 0===s?void 0:s.source,v=[k.D.ActivityFeed,k.D.ActivityFeedBellClick],f=!!p&&v.includes(p);let b,y;i&&(y=f?$n.mQ.activityFeed:(null==m?void 0:m.channelId)||(null==m?void 0:m.chatId)?m.channelId?$n.mQ.channelTab:m.chatId?$n.mQ.chatTab:"Unknown":$n.mQ.personalApp,null===(o=null==n?void 0:n.findScenario(z.RG.PlatformTabDeeplinkHandling))||void 0===o||o.cancel(),b=null==n?void 0:n.newScenario(z.RG.PlatformTabDeeplinkHandling),(0,GH.ui)(n,d,`${y}Deeplink`,t,!1),b&&(null===(r=null==n?void 0:n.hoistScenarioToCore)||void 0===r||r.call(n,b)),null==b||b.appendEventData({"PlatformTabDeeplink.pathname":e.pathname,"PlatformTabDeeplink.search":e.search}));for(const i of Array.from(dq))if(null==g?void 0:g.startsWith(i))return void 0===cq[i]?(null===(c=t.errorToTelemetry)||void 0===c||c.call(t,rq,"platform_deeplink_prefix_type"),Promise.reject(rq)):uq(e,d,u,m,t,f,a,b,h);return null===(l=t.errorToTelemetry)||void 0===l||l.call(t,rq,"platform_deeplink_prefix_type"),Promise.reject(rq)})(i,r,!!c,o,n)})),hq={filter:oq,execute:({deeplinkUrl:e,context:{loggerFactory:t,scenarioFactory:i,coreSettings:n},sourceViewEntity:a})=>{const s=t.newLogger("PlatformApp_parseTaskModuleDeeplink","apps-platform-app");return pq(e,n,s,i,a)}},pq=(e,t,i,n,a)=>{if(e.pathname.startsWith(oq)){const s=n.newScenario(z.RG.ExtDeeplinkToTaskModule),{enableDeepLinkToTaskModule:o}=t.get(S.J.Extensibility);if(!o)return s.stop({reason:z.ck.ExtDeeplinkToTaskModuleFeatureFlagDisabled}),i.log("ext_deeplink_to_task_module_featureflag_disabled"),Promise.reject("Deeplink to task module feature flag is disabled");if(!a)return s.stop({reason:z.ck.ExtDeeplinkToTaskModuleNotSupported}),i.log("ext_deeplink_to_task_module_not_supported"),Promise.reject("Deeplink to task module is not supported");const r=(0,qe.v4)();return Promise.resolve({entityCommand:{entity:{type:pe.py.taskmodule,action:pe.uk.create,id:r},command:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:k.D.TaskModuleDeeplink}},entityOptions:{deeplinkSourceEntityInput:a,deeplinkUrl:e}},metadata:{allowAnonymous:!1}})}return i.log(rq),Promise.reject(rq)},vq={filter:e=>{if(!e.pathname.startsWith(sq))return!1;const{appId:t,chatId:i,entityId:n,deeplinkContext:a}=lq(e);return!(!(t&&i&&n&&a)||"chat"!==a.contextType&&"meeting"!==a.contextType)},execute:e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{context:{coreSettings:t}}=e,{enablePlatformDeepLinkRouting:i}=t.get(S.J.Extensibility);if(!(({deeplinkUrl:e,sourceViewEntity:t,context:{coreSettings:i}})=>{var n;if("false"===(null===(n=e.searchParams.get("openInMeeting"))||void 0===n?void 0:n.toLowerCase())||!i.get(S.J.Extensibility).handleDeepLinkToMeetingSidePanel||!t)return!1;const{type:a,action:s,linkedEntity:o}=t,r=t;return a===pe.py.calls||!!r.options&&(a===pe.py.extensions&&s===pe.uk.view&&(null==o?void 0:o.type)===pe.py.calls?!!o.id:KH.has(a)&&r.options.includes("teamsCallId"))})(e)){if(i)return gq(e);throw new Error("Groupchat/team scope tab deeplink disabled")}const{executeDeepLinkToGroupChatOrTeamTab:n}=yield(0,Rl.mT)(mq,"platform-app-execute-group-chat-or-team-scope-tab-deeplink");try{return yield n(e)}catch(t){if(i)return gq(e);throw t}}))},fq=[vq,{filter:e=>{try{const{appId:t}=lq(e);return!!t}catch(e){return!1}},execute:gq},hq,tq,{filter:"/l/auth-callback",execute:e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var t,i,n;const{context:{coreSettings:a}}=e,{enablePlatformExternalAuth:s}=a.get(S.J.Extensibility);if(!s)return Promise.reject("External auth feature is not enabled");{const{search:a}=e.deeplinkUrl,s=new URLSearchParams(a),o=s.get("authId"),r=s.get("result"),c=yield e.context.getUserContexts();null===(n=null===(i=null===(t=null==c?void 0:c[0])||void 0===t?void 0:t.context)||void 0===i?void 0:i.client)||void 0===n||n.mutate({mutation:iq,variables:{authId:o,result:r}})}return Promise.resolve(void 0)}))}],bq={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DataClientPlatformAppButtonMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"action"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateAppButtonSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"action"},value:{kind:"Variable",name:{kind:"Name",value:"action"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},yq="platform",kq="viewPlatformApp",Sq="loadPlatformChunks",wq="openAppDetailsDialog",jq="openAboutDialog",Cq="installPlatformApp",_q="uninstallPlatformApp",Tq="blockUnblockBotChat",{getIsFirstFlyoutClickAfterAppLoad:Iq,setIsFirstFlyoutClickAfterAppLoad:Nq}=(()=>{let e=!0;return{getIsFirstFlyoutClickAfterAppLoad:()=>e,setIsFirstFlyoutClickAfterAppLoad:t=>{e=t}}})();var Eq=i(401717);const Fq={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsAppsPlatformQueriesBlockUnblockBotChatForAppMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blockUnblockBotChatForApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}]}]}}]};var xq=i(454809);const Dq=()=>Promise.all([i.e(958828),i.e(743719),i.e(531924),i.e(923731),i.e(433329),i.e(711340),i.e(446977),i.e(705849),i.e(890032),i.e(983436),i.e(832717),i.e(503951),i.e(776103),i.e(210211),i.e(104526),i.e(290689),i.e(826310),i.e(680562),i.e(584571),i.e(193567),i.e(12720),i.e(160235),i.e(983679),i.e(448073),i.e(277110),i.e(252283),i.e(127919),i.e(225330),i.e(822166),i.e(645979),i.e(881128),i.e(803388),i.e(631900),i.e(53502),i.e(485984),i.e(624862),i.e(251451),i.e(692534),i.e(204118),i.e(685464),i.e(256060),i.e(930054),i.e(559067)]).then(i.bind(i,956337)),Aq=({commandInput:e,requestContext:t})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var i,n;const{loggerFactory:a,scenarioFactory:s,client:o,coreSettings:r}=t,c=e.command,l=c.action,d=a.newLogger("PlatformApp onCommandReceived","apps-platform-app");if(e.command.actor===yq)switch(l){case kq:return Mq(c,t,d);case Sq:const{enablePrewarmPlatformChunk:e}=r.get(S.J.Extensibility);return void(e&&Iq()&&(d.log("enablePrewarmPlatformChunk is enabled."),(0,Rl.mT)(Dq,"platform-app",s),Nq(!1)));case wq:return Pq(c);case jq:const{appId:a}=c.data;return{entityOptions:{appId:a,entryPoint:UA.RE.PersonalAppAbout},entity:{id:a,type:pe.py.platformapp,action:pe.uk.create},command:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:k.D.ExtensionCommanding}}};case Cq:{const{appId:e}=c.data;if(null===(i=(yield(0,Eq.yx)(o,e)).staticTabs)||void 0===i?void 0:i.some((e=>{var t;return null===(t=e.scopes)||void 0===t?void 0:t.some((e=>(null==e?void 0:e.toLowerCase())===xe.qi6.Personal.toLowerCase()))}))){const{enableAppsQueryOptimization:i}=r.get(S.J.Extensibility);return yield(0,Eq.eI)(o,s,z.RG.PlatformAppFlyoutJITInstallApp,e,xe.qi6.Personal,d,!!i),Mq(c,t,d)}return Pq(c)}case _q:{const{appId:e,appName:t,isInUse:i}=c.data;return{entityOptions:{appId:e,appName:t,scope:xe.qi6.Personal,navigateToDefaultAppOnUninstall:i},entity:{id:e,type:pe.py.manageapps,action:pe.uk.delete},command:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:k.D.ExtensionCommanding}}}}case Tq:const u=null===(n=c.data)||void 0===n?void 0:n.appId;return u?void(yield o.mutate({mutation:Fq,variables:{appId:u}})):void d.error("app id for block unblock was undefined.");default:d.error(`Command action '${l}' is not supported at PlatformApp.`)}else d.error(`Command for actor '${e.command.actor}' cannot be handled by PlatformApp.`)})),Mq=(e,t,i)=>{var a;const{scenarioFactory:s,executionContext:o,client:r,coreSettings:c}=t,{viewEntities:{mainEntity:l}}=o,{enableMRUSortingPersonalApps:d}=c.get(S.J.Extensibility);if("object"!=typeof(u=e.data)||null===u||!("appId"in u))return void i.error(`Command for action '${e.action}' requires an appId.`);var u;const m=Oq(null==l?void 0:l.id,null==l?void 0:l.type,e.data.appId,i);if(m?((e,t,i,a)=>{(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(!t)return;const n={appId:t,action:i};yield e.mutate({mutation:bq,variables:n}).catch((()=>{var e;return null===(e=a.errorToTelemetry)||void 0===e?void 0:e.call(a,`[AppId: ${t}] Failed to register app button to cache`,"platform_personal_app_app_button_api",void 0,!0)}))}))})(r,e.data.appId,e.action,i):(0,GH.ui)(s,e.data.appId,$n.mQ.personalApp,i,e.data.isMultiWindow),d){const t=e.data.appId;null===(a=i.infoToTelemetry)||void 0===a||a.call(i,`record app usage mutation called for appId ${t}`,"platform_record_app_mru_view_platform_app",{appId:t}),r.mutate({mutation:xq.c,variables:{appId:t}}).catch((()=>{var e;null===(e=i.errorToTelemetry)||void 0===e||e.call(i,`failed to call mutate to record app usage on the appId ${t}`,"platform_record_app_mru_view_platform_app",void 0,!0)}))}return(0,nH.Pq)(e.data.appId,e.data.isMultiWindow||!1,!0,!1,k.D.AppBar,void 0,void 0,void 0,m)},Pq=e=>{var t,i,n;const a=null!==(i=null===(t=e.data)||void 0===t?void 0:t.appId)&&void 0!==i?i:"",s=null===(n=e.data)||void 0===n?void 0:n.scrollToSection;return{entityOptions:{appId:a,entryPoint:UA.RE.PersonalFlyoutAppSuggestions,viewOptions:{scrollToSection:s}},entity:{id:a,type:pe.py.platformapp,action:pe.uk.create},command:{visibilityState:ve.fe.show,stateTransition:ve.su.extend,correlation:{source:k.D.ExtensionCommanding}}}},Oq=(e,t,i,n)=>{var a;try{if(t===pe.py.extensions&&e){return JSON.parse(e).appId===i}return!1}catch(t){return null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`failed to parse main entity id ${e}`,"platform_personal_app_main_entity_parse",void 0,!0),!1}},Rq={onEventReceived:({eventInput:e})=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var t,i;switch(e.event.type){case Ce.uS.expandTab:{const n=null===(i=(t=e.event).data)||void 0===i?void 0:i.call(t);return Promise.resolve({command:Te.CN.expandTab(n)})}case Ce.uS.resetLayoutOverrides:return Promise.resolve({command:Te.CN.resetLayoutOverrides()});case Ce.uS.maximizeTab:return Promise.resolve({command:Te.CN.maximizeTab()})}return Promise.resolve(void 0)}))},Lq=e=>{if(Uq(e))return $q(e)?{subNavEntity:Wq(e),headerEntity:Bq(e),startEntity:zq(e),mainEntity:Hq(e),endEntity:qq(e)}:null},Uq=({contextEntity:e,entity:t,coreSettings:i,layoutMode:n})=>{const{action:a=null,type:s}=Object.assign({},t);if(Vq(t,e,i))return!1;const o=[ve.lO.focus,ve.lO.standard].includes(n),r=[pe.py.platformapp,pe.py.platformappdetails,pe.py.incontextstore,pe.py.platformapps,pe.py.extensions].includes(s),c=[pe.uk.create,pe.uk.default,pe.uk.list,pe.uk.view,pe.uk.update,pe.uk.manage],l=a&&c.includes(a),d=e&&e.action;return!(!o||!r||!l&&!d)},$q=()=>!0,Wq=()=>null,Bq=({contextEntity:e,entity:t,coreSettings:i})=>{const n=null==i?void 0:i.get(S.J.Extensibility).enablePlatformHeaderEntry;if(e&&e.action){if(e.type===pe.py.chats)return t;if(e.type===pe.py.extensions&&n)return e}return n?t:null},zq=()=>null,Hq=({entity:e,contextEntity:t})=>t&&t.action&&(t.type===pe.py.chats||t.type===pe.py.extensions)?t:e,qq=()=>null,Vq=(e,t,i)=>{const n=null==i?void 0:i.get(S.J.Extensibility).enablePlatformHeaderEntry;return e.type===pe.py.extensions&&(null==t?void 0:t.type)===pe.py.extensions&&!n},Gq=({coreSettings:e})=>{var t;return{[xe.tF7.headerEntity]:{[Wt.S.HorizontalBar]:{slotHeightOverrides:(null===(t=null==e?void 0:e.get(S.J.Extensibility))||void 0===t?void 0:t.enablePlatformPersonalAppHeaderLayout)?"auto":void 0}}}},Jq={id:"com.microsoft.teams.platform-app",name:"Platform App",actors:[yq],supportedEntities:[pe.py.extensions,pe.py.taskmodule,pe.py.hwctaskmodule,pe.py.platformapp,pe.py.platformappdetails,pe.py.platformappconsent,pe.py.platformapps,pe.py.platformsubscriptionplans,pe.py.customapp,pe.py.platformauthconsentdialog,pe.py.workflows,pe.py.selectMediaApi,pe.py.viewImagesApi,pe.py.platformtab,pe.py.locationapi,pe.py.selectpeoplepicker,pe.py.platformappratingcoachmark,pe.py.platformcontextlessinstalldialog,pe.py.stagedapps,pe.py.platformTabGallery,pe.py.manageapps,pe.py.manageappswebhook,pe.py.incontextstore,pe.py.platformappdevicepermissions,pe.py.settingsdialog,pe.py.platformstagemodal],supportedRenderModes:[Wt.S.HorizontalBar,Wt.S.Main,Wt.S.Modal,Wt.S.Rail],windowFeatures:{width:800,height:600,minWidth:800,minHeight:600,offset:20}},Kq=({appRenderMode:e,coreSettings:t})=>{const i=new b$.H,{platformAppCriticalPhaseTimeout:n}=t.get(S.J.Extensibility);return"Main"===e&&i.registerAppPhase({phase:De.nh.CRITICAL,signals:[y$.G.PLATFORM_APP_CONTAINER_RENDERED,y$.G.PLATFORM_APP_FRAME_RENDERED,y$.G.PLATFORM_APP_FRAME_CONTENT_RENDERED],timeout:n||35e3}),i.appPhases},Qq=({context:{coreSettings:e,scenarioFactory:t}})=>[{id:"prewarm-platform-app",runOncePerId:!0,job:()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{enablePostALTPrewarmPlatformChunk:n}=e.get(S.J.Extensibility);n&&(yield(0,Rl.mT)((()=>Promise.all([i.e(958828),i.e(743719),i.e(531924),i.e(923731),i.e(433329),i.e(711340),i.e(446977),i.e(705849),i.e(890032),i.e(983436),i.e(832717),i.e(503951),i.e(776103),i.e(210211),i.e(104526),i.e(290689),i.e(826310),i.e(680562),i.e(584571),i.e(193567),i.e(12720),i.e(160235),i.e(983679),i.e(448073),i.e(277110),i.e(252283),i.e(127919),i.e(225330),i.e(822166),i.e(645979),i.e(881128),i.e(803388),i.e(631900),i.e(53502),i.e(485984),i.e(624862),i.e(251451),i.e(692534),i.e(204118),i.e(685464),i.e(256060),i.e(930054),i.e(559067)]).then(i.bind(i,956337))),"platform-app",t))}))}],Yq=()=>Promise.all([i.e(958828),i.e(743719),i.e(531924),i.e(923731),i.e(244738),i.e(446977),i.e(705849),i.e(918043),i.e(270562),i.e(104526),i.e(290689),i.e(826310),i.e(680562),i.e(584571),i.e(193567),i.e(150662),i.e(12720),i.e(404874),i.e(448073),i.e(277110),i.e(252283),i.e(127919),i.e(225330),i.e(822166),i.e(645979),i.e(803388),i.e(631900),i.e(624862),i.e(656283),i.e(740324),i.e(692534),i.e(360941)]).then(i.bind(i,591198)),Xq=()=>Promise.all([i.e(958828),i.e(743719),i.e(531924),i.e(923731),i.e(433329),i.e(711340),i.e(446977),i.e(705849),i.e(890032),i.e(983436),i.e(832717),i.e(503951),i.e(776103),i.e(210211),i.e(104526),i.e(290689),i.e(826310),i.e(680562),i.e(584571),i.e(193567),i.e(12720),i.e(160235),i.e(983679),i.e(448073),i.e(277110),i.e(252283),i.e(127919),i.e(225330),i.e(822166),i.e(645979),i.e(881128),i.e(803388),i.e(631900),i.e(53502),i.e(485984),i.e(624862),i.e(251451),i.e(692534),i.e(204118),i.e(685464),i.e(256060),i.e(930054),i.e(559067)]).then(i.bind(i,956337)),Zq=()=>Promise.all([i.e(774689),i.e(958828),i.e(743719),i.e(247364),i.e(531924),i.e(923731),i.e(433329),i.e(244738),i.e(428421),i.e(814199),i.e(711340),i.e(446977),i.e(705849),i.e(890032),i.e(983436),i.e(395303),i.e(873428),i.e(236315),i.e(189185),i.e(503951),i.e(9606),i.e(776103),i.e(662286),i.e(205126),i.e(210211),i.e(716743),i.e(104526),i.e(290689),i.e(826310),i.e(680562),i.e(475063),i.e(742262),i.e(584571),i.e(193567),i.e(958163),i.e(574803),i.e(12720),i.e(100004),i.e(498871),i.e(160235),i.e(783178),i.e(983679),i.e(448073),i.e(277110),i.e(252283),i.e(127919),i.e(614904),i.e(674821),i.e(225330),i.e(822166),i.e(172670),i.e(645979),i.e(881128),i.e(803388),i.e(631900),i.e(485984),i.e(624862),i.e(251451),i.e(629959),i.e(692534),i.e(204118),i.e(366438),i.e(941569),i.e(865419),i.e(256060),i.e(15817),i.e(400745),i.e(812321),i.e(469792),i.e(588919)]).then(i.bind(i,79022)),eV=({coreServices:e,host:t,screenState:i})=>{const{disablePlatformAppWindowFeatures:n,enablePlatformAppLargePopout:a}=(null==e?void 0:e.coreSettings.get(S.J.Extensibility))||{},s=null==t?void 0:t.screen;if(n||!s)return null;const{minHeight:o,minWidth:r,offset:c=1,height:l=0,width:d=0}=Jq.windowFeatures||{};let u,m,g,h;const p=(((null==i?void 0:i.numOpenWindows)||1)-1)*c;if(a){const t=((e,t)=>{const{minHeight:i=0,minWidth:n=0}=Jq.windowFeatures||{};let{width:a=n,height:s=i}=Jq.windowFeatures||{};if(!t)return{height:s,width:a};const{orientation:{type:o}}=e,{landscapeScreenRatio:r,portraitScreenRatio:c,widthHeightRatio:l}=t.coreSettings.get(S.J.Calling);if(r&&c&&l)switch(o){case"landscape-primary":case"landscape-secondary":const t=r*e.availHeight;s=t>i?t:i,a=l*s;break;case"portrait-primary":case"portrait-secondary":const o=c*e.availWidth;a=o>n?o:n,s=1/l*a}return{height:s,width:a}})(s,e),i=((e,t,i)=>{var n;const a=(null===(n=Jq.windowFeatures)||void 0===n?void 0:n.offset)||0,s="availLeft"in e&&e.availLeft||0,o="availTop"in e&&e.availTop||0,r=s+e.availWidth/2-t/2;let c;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":c=o+a;break;default:c=o+e.availHeight/2-i/2}return{left:r,top:c}})(s,t.width,t.height);u=t.height,m=t.width,g=i.left,h=i.top}else{const e={left:(null==t?void 0:t.screenX)||0,top:(null==t?void 0:t.screenY)||0};u=l,m=d,g=e.left,h=e.top}return{additionalFeatures:{minHeight:`${o}`,minWidth:`${r}`},left:g+p,top:h+p,minHeight:o,minWidth:r,height:u,width:m}};function tV(){const e=()=>null;return{getAppPhases:Kq,getAppViewEntities:Lq,getAppWindowFeatures:eV,getPlatformAppIdForEntity:e=>{if(e.type===pe.py.extensions){const{appId:t}=e.id&&JSON.parse(e.id);return t}},getAppViewEntitiesProps:Gq,onBeforeDeeplinkParsed:fq,manifest:Jq,onCommandReceived:Aq,onRegister:e=>{e.registerTask(new Mr)},render:({appRenderMode:t,scenarioFactory:i,onRenderEvent:a})=>(0,n.__awaiter)(this,void 0,void 0,(function*(){switch(t){case Wt.S.Modal:{const e="platform-modal",{Modal:t}=yield(0,Rl.mT)(Zq,e,i);return Se.createElement(QL.f,{namespace:"extensibility",loaderRenderer:null},Se.createElement(t,null))}case Wt.S.HorizontalBar:case Wt.S.Main:{const e="platform-app",n=null==i?void 0:i.findScenario(z.RG.PlatformTabFrameLoading);(null==n?void 0:n.currentStep)!==z.ck.PlatformTabRenderAfterChunkLoad&&(null==n||n.mark(z.ck.PlatformTabRenderBeforeChunkLoad),null==n||n.startStep(z.ck.PlatformTabRenderAfterChunkLoad)),a("ChunkLoadStarted",{chunkName:e});const{PlatformAppViewsEntryRenderer:s}=yield(0,Rl.mT)(Xq,e,i);return a("ChunkLoadSucceeded",{chunkName:e}),(null==n?void 0:n.currentStep)===z.ck.PlatformTabRenderAfterChunkLoad&&(null==n||n.mark(z.ck.PlatformTabRenderAfterChunkLoad)),Se.createElement(QL.f,{namespace:"extensibility",loaderRenderer:null},Se.createElement(s,{appRenderMode:t}))}case Wt.S.Rail:{const e="platform-app-rail",{PlatformTabPanel:t}=yield(0,Rl.mT)(Yq,e,i);return Se.createElement(QL.f,{namespace:"extensibility",loaderRenderer:null},Se.createElement(t,null))}default:return Se.createElement(e,null)}})),eventHandlers:Rq,onPreWarm:Qq}}var iV=i(437210),nV=i(208569),aV=i(542791),sV=i(377381);class oV{constructor(e){if(this._selfWindow=e,this._threadId="",this._isCallModeStreaming=!1,this._failedInitialize=!1,this._isInEmbedContext=this._selfWindow.self!==this._selfWindow.top,this._disableFullScreenButton=!1,this._hostWindow=this._selfWindow.parent,this._streamDetails=[],this._streamingModeActive=!1,this._forceAttendeeStreaming=!1,this._callMode=void 0,this._meetingRole=void 0,this._correlationId=(0,qe.v4)(),this._streamDetailsUpdateHandler=this._streamDetailsUpdateHandler.bind(this),this._callDataUpdateHandler=this._callDataUpdateHandler.bind(this),this._broadcastEndHandler=this._broadcastEndHandler.bind(this),this._captionsToggleHandler=this._captionsToggleHandler.bind(this),this._subtitleTrackSelectHandler=this._subtitleTrackSelectHandler.bind(this),this._isInEmbedContext){const e=new URLSearchParams(this._selfWindow.location.search),t=e.get("embed");this._isInEmbedContext=""===t||"true"===t;const i=e.get("callMode")||"";this._isCallModeStreaming="streaming"===i.toLowerCase()&&this._isInEmbedContext}}isCallModeStreaming(){return this._isCallModeStreaming}validateEmbedStreamDetailsArray(e){if(e&&e.length>0){const t=[];return e.forEach((e=>{const i=this._validateEmbedStreamDetails(e);i.length&&t.push({streamDetails:e,errorCodes:i})})),{isSuccessful:!!t.length,validationItems:t}}return{isSuccessful:!0}}getStreamDetails(){return this._streamDetails}setStreamDetails(e){this._setStreamDetails(e)}getStreamingMode(){return this._streamingModeActive}setStreamingMode(e){this._streamingModeActive=e}getForceAttendeeStreaming(){return this._getForceAttendeeStreamingV1()||this._forceAttendeeStreaming}setForceAttendeeStreaming(e){this._forceAttendeeStreaming=e}getCallMode(){return this._callMode}setCallMode(e){this._callMode=e}getMeetingRole(){return this._meetingRole}setMeetingRole(e){this._meetingRole=e}isInEmbedContext(){return this._isInEmbedContext}isFullScreenButtonDisabled(){return this._disableFullScreenButton}setFullScreenButton(e){this._disableFullScreenButton=e}setTelemetryData(e,t){this._telemetryData={deviceId:e,platform:t.toLocaleLowerCase()}}getTelemetryData(){return this._telemetryData}getEnablePlayerControlsForStreamingMode(){if(this.isCallModeStreaming()&&this.isInEmbedContext())return this._enablePlayerControlsForStreamingMode}sendInitialize(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this._isInEmbedContext)throw new Error("not hosted");try{return this._initializeResponse=yield this._getResponse("initialize",2e3),this._initializeResponseTime=Date.now(),this._correlationId=(0,qe.v4)(),this._uiLanguagePreference=this._initializeResponse.uiLanguagePreference,this._enablePlayerControlsForStreamingMode=this._initializeResponse.enablePlayerControlsForStreamingMode,this._initializeResponse}catch(e){throw this._failedInitialize=!0,this._isInEmbedContext=!1,e}}))}createStreamUpdateEventListener(e){this._streamUpdateCallback=e,this._selfWindow.addEventListener("message",this._streamDetailsUpdateHandler)}destroyStreamUpdateEventListener(){this._selfWindow.removeEventListener("message",this._streamDetailsUpdateHandler)}createCallDataUpdateEventListener(e){this._callDataUpdateCallback=e,this._selfWindow.addEventListener("message",this._callDataUpdateHandler)}destroyCallDataUpdateEventListener(){this._selfWindow.removeEventListener("message",this._callDataUpdateHandler)}createBroadcastEndEventListener(e){this._broadcastEndCallback=e,this._selfWindow.addEventListener("message",this._broadcastEndHandler)}destroyBroadcastEndEventListener(){this._selfWindow.removeEventListener("message",this._broadcastEndHandler)}createCaptionsToggleEventListener(e){this._captionsToggleCallback=e,this._selfWindow.addEventListener("message",this._captionsToggleHandler)}createSubtitleTrackChangeEventListener(e){this._subtitleTrackChangeCallback=e,this._selfWindow.addEventListener("message",this._subtitleTrackSelectHandler)}destroyCaptionsToggleEventListener(){this._selfWindow.removeEventListener("message",this._captionsToggleHandler)}destroySubtitleTrackChangeEventListener(){this._selfWindow.removeEventListener("message",this._subtitleTrackSelectHandler)}sendHeartbeat(e){if(!this._isInEmbedContext)return;this._postMessageToHost("heartbeat",{message:e})}sendServerError(e,t){this._isInEmbedContext&&this._sendError("server",e,t)}sendDataLoadError(e,t){this._isInEmbedContext&&this._sendError("dataload",e,t)}sendConveneError(e,t){this._isInEmbedContext&&this._sendError("convene",e,t)}sendMetadata(e){if(!this._isInEmbedContext)return;this._postMessageToHost("metadata",e)}sendData(e){if(!this._isInEmbedContext)return;this._postMessageToHost("data",e)}getCorrelationId(){return this._correlationId}getUiLanguagePreference(){return this._uiLanguagePreference}getThreadId(){return this._threadId}initCoreServices(e){const{scenarioFactory:t}=e;this._scenarioFactory=t}logInitializeResponse(e){var t,i;const n=this.isCallModeStreaming()?null===(t=this._scenarioFactory)||void 0===t?void 0:t.createScenarioWithoutStarting(z.RG.StreamingConveneHostMessagingInitialize):null===(i=this._scenarioFactory)||void 0===i?void 0:i.createScenarioWithoutStarting(z.RG.BroadcastConveneHostMessagingInitialize);this._threadId=(0,W$.I2)(e)||"",this._threadId||this.sendConveneError(aV.E5.MissingThreadId,`Thread ID not present in iframe src attirbute: ${e.pathname}`);const a=Object.assign(Object.assign({"Thread.Id":this.getThreadId()},this._getInitializeResponseDataObject()),{correlationId:this.getCorrelationId(),callId:this.getCallId(),participantId:this.getParticipantId()});this._failedInitialize?null==n||n.fail(a):null==n||n.stop(a)}sendReadyToRecieveStreamUpdatesNotification(){this._postMessageToHost(aV.MN)}sendReadyToRecieveCallDataUpdateNotification(){this._postMessageToHost(aV.Bk)}sendReadyToRecieveBroadcastEndNotification(){this._postMessageToHost(aV.G$)}getParticipantId(){var e;return null===(e=this._initializeResponse)||void 0===e?void 0:e.participantId}getCallId(){var e;return null===(e=this._initializeResponse)||void 0===e?void 0:e.callId}isTestUser(){var e;return null===(e=this._initializeResponse)||void 0===e?void 0:e.isTestUser}_getInitializeResponseDataObject(){return Object.assign(Object.assign({},this._initializeResponse),{postMessageTime:this._initializeResponseTime,isCallModeStreaming:this.isCallModeStreaming()})}_sendError(e,t,i){this._postMessageToHost("error",{type:e,responseCode:t,message:i})}_postMessageToHost(e,t){this._isInEmbedContext&&(this._hostWindow&&this._hostWindow.postMessage?this._hostWindow.postMessage({eventId:e,correlationId:this._correlationId,payload:t},"*"):console.error("Unable to post message, host window not available",t))}_getResponse(e,t){let i;return new Promise(((n,a)=>{const s=t=>{t&&t.data&&e===t.data.eventId&&(this._selfWindow.removeEventListener("message",s),this._selfWindow.clearTimeout(i),t.data.payload&&t.data.payload.result?n(t.data.payload):a(new Error("invalid response from host")))};i=this._selfWindow.setTimeout((()=>{this._selfWindow.removeEventListener("message",s),a(new Error("timed out - no response from host"))}),t),this._selfWindow.addEventListener("message",s),this._postMessageToHost(e)}))}_captionsToggleHandler(e){if(e.data.eventId===aV.UF){const t=e.data.payload;this._captionsToggleCallback&&(this._captionsToggleCallback(t),this.sendHeartbeat(aV.Aq.CaptionsToggled))}}_subtitleTrackSelectHandler(e){if(e.data.eventId===aV.fz){const t=e.data.payload;this._subtitleTrackChangeCallback&&(this._subtitleTrackChangeCallback(t),this.sendHeartbeat(aV.Aq.SubtitleTrackRequested))}}_setStreamDetails(e){this._streamDetails=e.map((e=>Object.assign(Object.assign({},e),{id:e.identifier,deliveryPipelineType:this._getStreamDeliveryPipelineType(e.deliveryPipelineType),sdnDetails:e.sdn&&{name:e.sdn.sdnName,playbackInfo:e.sdn.sdnPlaybackInfo,pluginUrl:e.sdn.sdnPluginUrl,sdkUrl:e.sdn.sdnSdkUrl}})))}_getStreamDeliveryPipelineType(e){switch(e){case aV.gB.AMS:return xe.FT_.AMS;case aV.gB.MiddleLaneHttpLiveStreaming:return xe.FT_.MiddleLaneHttpLiveStreaming;case aV.gB.MiddleLaneUltraLowLatency:return xe.FT_.MiddleLaneUltraLowLatency;default:return xe.FT_.AMS}}_validateEmbedStreamDetails(e){var t;const i=[];return(e&&e.urls&&e.deliveryPipelineType&&(null===(t=e.decryptionKey)||void 0===t?void 0:t.value)||e&&e.urls&&e.deliveryPipelineType&&e.deliveryPipelineType===aV.gB.MiddleLaneHttpLiveStreaming&&e.keyAuthorizationToken&&e.setKeyAuthorizationCookieUri)&&i.push(aV.E5.MissingStreamingDetails),i}_streamDetailsUpdateHandler(e){var t,i;if((null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.eventId)===aV.MN){const t=e.data.payload,n=t.streams?t.streams:[],a=this._createScenario(aV.eH.ConveneStreamDetailsUpdate);if(this.validateEmbedStreamDetailsArray(n).isSuccessful){this._setStreamDetails(n),this.sendHeartbeat(aV.Aq.UpdatedStreamDetailsReceived);const e=this.getStreamDetails(),t=null===(i=e[0])||void 0===i?void 0:i.deliveryPipelineType,s=JSON.stringify((0,sV.eG)(n));null==a||a.stop(this._getEventData(void 0,{streamInfo:s||""},t)),this._streamUpdateCallback&&this._streamUpdateCallback(e)}else this._streamUpdateCallback&&this._streamUpdateCallback([],aV.Ar.InvalidStreamDetailsReceived),null==a||a.fail(this._getEventData(JSON.stringify(n))),this.sendConveneError(aV.E5.MissingStreamingDetails,aV.Ar.InvalidStreamDetailsReceived)}}_callDataUpdateHandler(e){var t;if((null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.eventId)===aV.Bk){const t=e.data.payload,i=this._validateCallData(t),n=null==t?void 0:t.callData,a=this._createScenario(aV.eH.ConveneCallDataUpdate);if(!i)return void(null==a||a.fail(this._getEventData(aV.Ar.InvalidCallDataReceived)));const{streamingModeActive:s,meetingCapability:o,callMode:r,meetingRole:c}=n;this.setStreamingMode(s),this.setForceAttendeeStreaming(!!(null==o?void 0:o.forceAttendeeStreaming)),this.setCallMode(r),this.setMeetingRole(c),this.sendHeartbeat(aV.Aq.UpdatedCallDataReceived),this._callDataUpdateCallback&&this._callDataUpdateCallback(s,!!(null==o?void 0:o.forceAttendeeStreaming),r,c),null==a||a.stop(this._getEventData())}}_broadcastEndHandler(e){var t,i;(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.eventId)===aV.G$&&(this.sendHeartbeat(aV.Aq.BroadcastEndDataReceived),this._broadcastEndCallback&&(null===(i=e.data.payload)||void 0===i?void 0:i.broadcastEnded)&&this._broadcastEndCallback())}_getForceAttendeeStreamingV1(){var e;return null===(e=this._initializeResponse)||void 0===e?void 0:e.forceAttendeeStreaming}_createScenario(e){var t,i;return e===aV.eH.ConveneCallDataUpdate?null===(t=this._scenarioFactory)||void 0===t?void 0:t.newScenario(z.RG.StreamingConveneCallDataUpdate):e===aV.eH.ConveneStreamDetailsUpdate?null===(i=this._scenarioFactory)||void 0===i?void 0:i.newScenario(z.RG.StreamingConveneStreamDetailsUpdate):void 0}_getEventData(e,t,i){const n={callMode:this.getCallMode(),meetingRole:this.getMeetingRole(),forceAttendeeStreaming:this.getForceAttendeeStreaming(),streamingModeActive:this.getStreamingMode()};return(0,sV.cX)(n,e,t,i)}_validateCallData(e){return!!(null==e?void 0:e.callData)}}var rV=i(356088);const cV=De.WL.HEADER,lV=De.WL.MAIN,dV=De.WL.MODAL,uV=De.WL.END,mV="minmax(0, 1fr)",gV="minmax(0, 1fr)",hV=[{slots:[lV,cV,dV],responsiveTemplates:[{minWidthBreakpoint:Pz.Rd.IS_GREATER_THAN_0,template:`\n          "${cV}"   auto\n          "${lV}"     ${mV}\n          "${dV}"    auto /\n          ${gV}\n        `}]},{slots:[lV,cV,dV,uV],responsiveTemplates:[{minWidthBreakpoint:Pz.Rd.IS_GREATER_THAN_0,template:`\n        "${cV}           ${cV}"           auto\n        "${lV}             ${uV}"              ${mV} /\n        ${gV}         32rem\n      `}]},{slots:[lV,dV],responsiveTemplates:[{minWidthBreakpoint:Pz.Rd.IS_GREATER_THAN_0,template:`\n          "${lV}"     ${mV}\n          "${dV}"    auto /\n          ${gV}\n        `}]}],pV=De.WL.HEADER,vV=De.WL.MAIN,fV=De.WL.MODAL,bV=[{slots:[vV,pV,fV],responsiveTemplates:[{minWidthBreakpoint:Pz.Rd.IS_GREATER_THAN_0,template:`\n          "${pV}"   auto\n          "${vV}"     minmax(0, 1fr)\n          "${fV}"    auto /\n          minmax(0, 1fr)\n        `}]}];function yV({layoutKey:e,layoutMode:t}){const i={[ve.lO.focus]:bV,[ve.lO.minimal]:[],[ve.lO.standard]:hV};return new rV.ZG({layoutKey:e,layoutMode:t,layoutTemplatesPerLayoutMode:i})}const kV=[{importFunc:()=>Promise.all([i.e(733830),i.e(614904),i.e(934882)]).then(i.bind(i,44123)),chunkName:"data-schema"},{importFunc:()=>Promise.all([i.e(958828),i.e(247364),i.e(923731),i.e(244738),i.e(428421),i.e(814199),i.e(446977),i.e(395303),i.e(873428),i.e(236315),i.e(189185),i.e(193183),i.e(153907),i.e(92464),i.e(680562),i.e(888923),i.e(579735),i.e(498871),i.e(939110),i.e(127919),i.e(511576),i.e(910360),i.e(802054)]).then(i.bind(i,62201)),chunkName:"core-essentials"},{importFunc:()=>Promise.all([i.e(774689),i.e(958828),i.e(743719),i.e(247364),i.e(923731),i.e(433329),i.e(711340),i.e(404256),i.e(446977),i.e(890032),i.e(983436),i.e(551886),i.e(94945),i.e(832717),i.e(503951),i.e(44716),i.e(9606),i.e(640212),i.e(30321),i.e(384008),i.e(463944),i.e(21652),i.e(609356),i.e(104526),i.e(290689),i.e(680562),i.e(100004),i.e(160235),i.e(47775),i.e(92872),i.e(739288),i.e(448073),i.e(277110),i.e(127919),i.e(614904),i.e(674821),i.e(562148),i.e(147647),i.e(519998),i.e(53502),i.e(251451),i.e(32739),i.e(64742),i.e(868167),i.e(988985),i.e(1088),i.e(243220),i.e(305271)]).then(i.bind(i,547661)),chunkName:"shell-app"}];performance&&performance.mark&&performance.mark("start-execute-main-bundle"),i(847928);const SV={Application:{onPreWarm:["auth-state-subscription","cdl-services-state-subscription","graph-item-toast-event-subscription","network-state-subscription","setup-calling-app-events","settings-ecs-fetch","standup-calling","toast-event-subscription","worker-start-sync","start-local-migrated-settings-timer-job","user-settings-signal-subscription","meetings-blocking-signal-subscription","connected-account-refresh-srt-job","prewarm-platform-app"]}},wV=(e,t,n)=>{let a=!1;n&&(0,Rl.mT)((()=>Promise.all([i.e(974361),i.e(774689),i.e(958828),i.e(743719),i.e(247364),i.e(531924),i.e(923731),i.e(433329),i.e(244738),i.e(428421),i.e(814199),i.e(711340),i.e(404256),i.e(446977),i.e(705849),i.e(890032),i.e(983436),i.e(551886),i.e(395303),i.e(873428),i.e(360806),i.e(291431),i.e(404541),i.e(832717),i.e(503951),i.e(44716),i.e(9606),i.e(283305),i.e(236861),i.e(868696),i.e(776103),i.e(115670),i.e(463944),i.e(662286),i.e(92374),i.e(104526),i.e(290689),i.e(826310),i.e(680562),i.e(475063),i.e(742262),i.e(888923),i.e(584571),i.e(193567),i.e(110895),i.e(150662),i.e(450987),i.e(574803),i.e(100004),i.e(579735),i.e(820464),i.e(160235),i.e(260225),i.e(264347),i.e(129880),i.e(983679),i.e(668059),i.e(448073),i.e(277110),i.e(252283),i.e(127919),i.e(614904),i.e(674821),i.e(225330),i.e(822166),i.e(311461),i.e(172670),i.e(728961),i.e(829970),i.e(645979),i.e(663905),i.e(562148),i.e(881128),i.e(803388),i.e(626976),i.e(147647),i.e(343831),i.e(631900),i.e(459687),i.e(519998),i.e(53502),i.e(812126),i.e(485984),i.e(357821),i.e(846369),i.e(615242),i.e(745474),i.e(530825),i.e(251451),i.e(672443),i.e(375119),i.e(32739),i.e(656283),i.e(496769),i.e(69306),i.e(767266),i.e(492721),i.e(244259),i.e(184954),i.e(218831),i.e(740436),i.e(24851),i.e(473165),i.e(629959),i.e(267807),i.e(256483),i.e(366438),i.e(107285),i.e(965573),i.e(685464),i.e(256060),i.e(92854),i.e(146515),i.e(180189),i.e(262933),i.e(930054),i.e(812321),i.e(481647)]).then(i.bind(i,145206))),"chat-app",t).catch((t=>{e.newLogger("Convene","convene").error(`Failed to prefetch Chat App: ${t}`)})),(0,Rl.mT)((()=>Promise.all([i.e(958828),i.e(247364),i.e(923731),i.e(244738),i.e(428421),i.e(814199),i.e(446977),i.e(395303),i.e(873428),i.e(236315),i.e(189185),i.e(193183),i.e(153907),i.e(92464),i.e(680562),i.e(888923),i.e(579735),i.e(498871),i.e(939110),i.e(127919),i.e(511576),i.e(910360),i.e(802054)]).then(i.bind(i,62201))),"core-essentials",t).catch((t=>{e.newLogger("Convene","convene").error(`Failed to prefetch Core Layout: ${t}`),a=a||(e=>((0,R.J)().opener.postMessage(w.W.ExperienceStarted,{message:e.message,errorCode:-1,errorDescription:`${e.code}: ${e.subContext}`}),!0))(t)}))},jV=(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{renderErrorScreen:n}=yield Promise.all([i.e(958828),i.e(247364),i.e(923731),i.e(244738),i.e(428421),i.e(814199),i.e(446977),i.e(395303),i.e(873428),i.e(236315),i.e(189185),i.e(193183),i.e(153907),i.e(680562),i.e(498871),i.e(127919),i.e(511576),i.e(914682)]).then(i.bind(i,46286)),a=document.getElementById("app");a&&n(e,a,(0,R.J)(),void 0,t)})),CV=()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var e,t;const a=Date.now(),s=i(759455),o=new oV(window);yield((e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(t.isInEmbedContext())try{const i=yield t.sendInitialize();if(e.externalCorrelationId=i.correlationId,t.isCallModeStreaming()){const e=t.validateEmbedStreamDetailsArray(i.streams);i.streams&&e.isSuccessful&&t.setStreamDetails(i.streams)}t.setFullScreenButton(!!i.disableFullScreenButton),i.deviceId&&i.platform&&t.setTelemetryData(i.deviceId,i.platform)}catch(e){}})))(s,o);const r=[XL(o),gB(o),DH(),HH(),tV()],c=new NL({config:Object.assign(Object.assign({},s),{startTimeMS:a,lifeCycleJobPermissions:SV}),apps:r,criticalDynamicImports:kV,loadConfigs:AL});let l;try{yield c.init(),l=c.coreServices}catch(e){o.isInEmbedContext()&&o.sendConveneError(aV.E5.CoreInitializationFailure,e.message),jV(e)}if(!l)return;const{coreSettings:d,loggerFactory:u,scenarioFactory:m}=l,{enableChatPreload:g}=d.get(S.J.Chat),h=l.scenarioFactory.newScenario(z.RG.BroadcastConveneCoreRendering);h.appendEventData({correlationId:o.getCorrelationId(),"Thread.Id":(0,W$.I2)(window.location)}),o.initCoreServices(l),o.isInEmbedContext()&&o.logInitializeResponse(window.location);const p={config:s,getLayoutResponsiveTemplates:yV};try{yield(0,iV.o)(c.activeWindows,l,(0,nV.c)(p)),h.stop(),null===(e=l.scenarioFactory.findScenario(z.RG.ExperienceReady))||void 0===e||e.stop()}catch(e){h.fail(),null===(t=l.scenarioFactory.findScenario(z.RG.ExperienceReady))||void 0===t||t.fail({errorCode:e.code,reason:"error rendering windows for the Convene experience"})}wV(u,m,null!=g&&g)}));CV().catch((e=>{jV(e)}))},670974:(e,t,i)=>{"use strict";i.d(t,{rY:()=>s,Ok:()=>o});var n=i(109458);function a(e){if(e.definitions.length>1)return null;const t=e.definitions[0];return"FragmentDefinition"!==t.kind?null:t}function s(e){const t=(0,n.S)(e);if(!(null==t?void 0:t.name))throw new Error("Operation name must be set");return t.name.value}function o(e){var t;let i=(0,n.S)(e);return i||(i=a(e)),(null===(t=null==i?void 0:i.name)||void 0===t?void 0:t.value)||null}},209406:(e,t,i)=>{"use strict";i.d(t,{T:()=>a});var n=i(589718);const a=e=>{const t=performance.now();return{cacheSize:n({data:e.data.data,optimisticData:e.optimisticData.data}),measuringTime:performance.now()-t}}},973877:(e,t,i)=>{"use strict";i.d(t,{TP:()=>s,ad:()=>o,U:()=>c});var n=i(589718);function a(e){var t,i;const n=e.storeReader;return{selectionSetCache:null===(t=null==n?void 0:n.executeSelectionSet)||void 0===t?void 0:t.__DEBUG_ONLY_optimismCache,selectionSetArrayCache:null===(i=null==n?void 0:n.executeSubSelectedArray)||void 0===i?void 0:i.__DEBUG_ONLY_optimismCache}}function s(e){const{selectionSetCache:t,selectionSetArrayCache:i}=a(e),s=performance.now(),o=[Array.from(t.map),Array.from(i.map)];return{cacheSize:n(o),measuringTime:performance.now()-s}}function o(e){const{selectionSetCache:t,selectionSetArrayCache:i}=a(e);return{objectCount:t.map.size,arrayCount:i.map.size}}function r(e){var t,i,n,a;if(0===e.length)return"[Dirty]";let s="";return e[0]&&e[0].result&&(s=null!==(i=null===(t=e[0].result)||void 0===t?void 0:t.__typename)&&void 0!==i?i:"[Query]"),e[1]&&(s+=` (Error: ${null!==(a=null===(n=e[1])||void 0===n?void 0:n.message)&&void 0!==a?a:""})`),s}function c(e){var t;const{selectionSetCache:i}=a(e),n=new Map;for(const e of i.map.values()){const i=r(e.value.value),a=null!==(t=n.get(i))&&void 0!==t?t:0;n.set(i,a+1)}return Array.from(n).sort(((e,t)=>t[1]-e[1]))}},561849:(e,t,i)=>{"use strict";i.d(t,{l:()=>o});var n=i(530014),a=i(599768);const s=["NoNetwork","RemoteOperationFailed"];class o extends n.G{constructor(e,t){super({type:"AuthError",code:r(e,t),prevError:"boolean"==typeof e?void 0:e})}getBoundaryProps(){switch(this.code){case"SIGN_IN_RESTRICTIONS":return{title:"default_signinrestrictions_title",description:"default_signinrestrictions_description",actions:["RESTART"]};case"ERROR_GETUSER_WHEN_ANON_NOT_SUPPORTED":return{title:"default_error_getuser_when_anon_not_supported_title",description:"default_error_getuser_when_anon_not_supported_description"};case"OFFLINE":return{title:"default_auth_no_network_title",description:"default_auth_no_network_description",actions:["RESTART"]};default:return{title:"default_authentication_title",description:"default_authentication_description",actions:["RESTART","SIGN_OUT"]}}}static fromSerialized(e){if("AuthError"!==(null==e?void 0:e.type))return null;const t=new o(void 0,e.code);return t.deserialize(e),t}}function r(e,t){if(t)return t;if("boolean"==typeof e)return e?"SIGN_IN_RESTRICTIONS":"UNKNOWN";if((0,a.a)(e)){const t=e.code;switch(t){case"SignInRestrictions":return"SIGN_IN_RESTRICTIONS";case"ErrorGetUserWhenAnonNotSupported":return"ERROR_GETUSER_WHEN_ANON_NOT_SUPPORTED";default:return s.includes(t)?"OFFLINE":"UNKNOWN"}}return"UNKNOWN"}},864452:(e,t,i)=>{"use strict";i.d(t,{m:()=>a});var n=i(850402);const a=()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return i.e(448981).then(i.bind(i,448981))}))},800418:(e,t,i)=>{"use strict";i.d(t,{b:()=>T});var n=i(850402),a=i(264011),s=i(400871),o=i(787623),r=i(486070),c=i(354571),l=i(974509),d=i(8122),u=i(50805),m=i(132756),g=i(915929),h=i(824303),p=i(921961),v=i(726727),f=i(827748),b=i(236380),y=i(905581);const k=3e5;var S=i(659726);const w="beta/imageauth/cookie",j="beta/users/{objectId}/cookiev2",C=1e3,_=new Map([[v.ej.SKYPE_KEY,[r.Pn.ams,r.Pn.amsV2]],[v.ej.MT_KEY,[r.Pn.mtImageService]]]);class T{constructor(e,t,i,n,m,g,v,S,_,T,I,N,E,F){var x;this._gtmRegistry=t,this._discover=i,this.coreSettings=m,this.windowProvider=g,this.platformService=v,this.localStorage=_,this._authenticationService=T,this.config=I,this.user=N,this.clientState=E,this.networkState=F,this._imageAuthCookieExpiryTsKey="ImageAuthCookieExpiryTime",this._activeAmsRequest={},this._baseImageUrlSubject=new h.X(null),this._isInitialized=!1,this._isImageAuthCookieValidSubject=new h.X(!1),this._imageCookieRetryInterval=2e4,this._imageCookieRetryMaxCount=5,this._isSetupImageCookieInProgress=!1,this._previousClientState=c.pk.Initializing,this.checkImageAuthCookie=()=>{let e=-1;const t=(new Date).getTime()/C,i=this.localStorage&&this.localStorage.get(this._imageAuthCookieExpiryTsKey,"Global")||"-1";e=parseInt(i,10);const n=e>t,a=n?`Image auth cookie has NOT expired. Expiry time stamp: ${e}`:`Image auth cookie has expired. Expiry time stamp: ${e}`;this._logger.log(a),this._isImageAuthCookieValidSubject.next(n),this.startImageAuthCookiePollingTimer(n,e)},this.getRequest=(e,{requestUrl:t,requestBody:i,headers:n,serviceName:a},s)=>this._gtmRegistry.bind(this._send,e)({url:t,headers:n,credentials:"include",method:"POST",body:i,serviceName:a,apiName:s}),this.setupImageAuthCookie=()=>Promise.resolve({constructRequest:()=>{var e,t;return{url:this._isMTMAProfilePicturesEnabled&&(null===(e=this.user)||void 0===e?void 0:e.id)?j.replace("{objectId}",null===(t=this.user)||void 0===t?void 0:t.id):w,method:"POST",headers:{"x-ms-client-caller":"imageAuthCookieSetupEM","x-ms-client-type":(0,p.I)(this.platformService,this.config)},credentials:"include",apiName:"imageAuthCookie"}},allowedResponses:[l.qj.HTTP_2XX],retryPolicy:this.imageCookieRetryPolicy()}),this.setupImageAuthCookieEndpoints=({discover:e,authenticationResources:t})=>({baseUrlPromise:()=>e.regionGtm(r.Pn.middleTier),serviceName:d.E.MiddleTier,authResource:t.mtAuthResource,models:{setupImageAuthCookie:this.setupImageAuthCookie()}}),this._logger=n.newLogger("Content Media Auth","services-io-browser-aync-media"),this._send=(0,a.r)((0,s.B)((0,o.S)(e),l.qb.NO_CONTENT,l.qb.OK),(x=this._logger,{shouldRetry:e=>(0,y.o7)(e)||[l.qb.THROTTLED,-1].indexOf(e)>-1,errorHandler:(e,t)=>{const{serverResponse:{status:i}}=e;if(!t.retriesTable[i])throw new Error(`AsyncMediaAuthServiceRetryPolicy: retry count for ${i} is empty`);return x.error(`asyncMediaAuthServiceRetryPolicy: retrying '[${t.retryCount}]' times due to response status - '[${i}]'`),(0,f._)(t.delay.next())},retryMaxTimeMs:k,maxRetryCount:6,createDelay:()=>new b.df(1e3,2,k)})),this._setupImageAuthCookieApi=S.createApi(this.setupImageAuthCookieEndpoints),this._imageCookieRetryInterval=m.get(u.J.People).imageCookieRetryInterval||2e4,this._imageCookieRetryMaxCount=m.get(u.J.People).imageCookieRetryMaxCount||5,this._isMTMAProfilePicturesEnabled=!!m.get(u.J.People).enableProfilePicturesWithObjectId,this._isDeleteImageAuthCookieEnabled=!!m.get(u.J.People).enableDeleteImageAuthCookie,this._isMTMAProfilePicturesEnabled&&(this._imageAuthCookieExpiryTsKey=`${this._imageAuthCookieExpiryTsKey}_${null==N?void 0:N.id}`)}initAsyncMediaAuthService(){if(this._isInitialized)return;this.initBaseImageUrl().catch((()=>{this._logger.error("Error in initCookieImageAuth")}));const{enableAmsCookieValidation:e}=this.coreSettings.get(u.J.Core),{isImageAuthCookiePollingCheckEnabled:t}=this.coreSettings.get(u.J.People),{skipAmsAuthRequest:i,disableTokenCacheReadEvent:n}=this.coreSettings.get(u.J.Auth);e&&t?this.checkImageAuthCookie():i?this._isImageAuthCookieValidSubject.next(!0):(this._discover.validateSkypeToken().catch((()=>{})),this.subscribeToToken(v.ej.SKYPE_KEY),n?this.subscribeToMiddleTierToken():this.subscribeToToken(v.ej.MT_KEY),this.subscribeToClientState()),this._isInitialized=!0}logout(){var e,t,i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n,s=d.E.Skype;const o=v.ej.MT_KEY,{mtResource:r}=yield this.coreSettings.get(u.J.Auth);if(r&&this._isDeleteImageAuthCookieEnabled&&(null===(e=this.user)||void 0===e?void 0:e.id)&&(null===(t=this._authenticationService)||void 0===t?void 0:t.acquireTokenV2)){const{token:e}=yield null===(i=this._authenticationService)||void 0===i?void 0:i.acquireTokenV2(r),t=null!==(a=_.get(o))&&void 0!==a?a:[],c=this.getHeaders(e,o);n=this._isMTMAProfilePicturesEnabled?"beta/users/{objectId}/deletecookiev2".replace("{objectId}",this.user.id):"beta/imageauth/deletecookie",s=d.E.MiddleTier;const{requireSkypetokenForMT:l}=this.coreSettings.get(u.J.Auth);return l&&(c["x-skypetoken"]=yield this._discover.validateSkypeToken()),this._logger.log("queueing request for deleting image auth cookie"),this.queueRequests(t,o,{requestUrl:n,headers:c,requestBody:undefined,serviceName:s},"deleteCookieOnLogout"),this._activeAmsRequest[o][0]}}))}startImageAuthCookiePollingTimer(e,t){this._imageAuthCookiePollingTimerId&&(this._logger.log(`Clearing image auth cookie polling. Timer ID: ${this._imageAuthCookiePollingTimerId}`),this.windowProvider.clearInterval(this._imageAuthCookiePollingTimerId));const i=Math.abs(t*C-(new Date).getTime()),n=e?i:5e3;this._imageAuthCookiePollingTimerId=this.windowProvider.setInterval((()=>this.checkImageAuthCookie()),n);const a=e?`Image auth cookie valid. expiry check timer started. Timer ID: ${this._imageAuthCookiePollingTimerId}`:`Image auth cookie NOT valid. polling validity timer started. Timer ID: ${this._imageAuthCookiePollingTimerId}`;e||this._logger.warn(a)}initBaseImageUrl(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=null!==(e=_.get(v.ej.MT_KEY))&&void 0!==e?e:[],i=yield this.getBaseUrl(t[0]);i&&this._baseImageUrlSubject.next(i)}))}getBaseUrl(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield this._discover.regionGtm(e);return t||this._logger.error("baseImageUrl is undefined"),t}catch(t){const i=`Fetching baseImageUrl failed from regionGTM, passed gtm: ${e.length}, errorCode: ${null==t?void 0:t.code}, errorContext: ${null==t?void 0:t.context}, errorMessage: ${null==t?void 0:t.message}`,n=(0,S.A)(i);return this._logger.errorToTelemetry?this._logger.errorToTelemetry(n,"async_media_auth_service",void 0,!0):this._logger.error(i),Promise.reject(t)}}))}subscribeToToken(e){var t;e===v.ej.SKYPE_KEY&&this._discover.observeSkypeToken().subscribe((e=>this.persistTokenToAMS(e,v.ej.SKYPE_KEY))),e===v.ej.MT_KEY&&(null===(t=this._authenticationService)||void 0===t||t.observeMiddleTierToken().subscribe((e=>this.persistTokenToAMS(e,v.ej.MT_KEY))))}getHeaders(e,t){const i={},n=(0,g.v4)();return i.Authorization=`${t===v.ej.SKYPE_KEY?"skype_token":"Bearer"} ${e}`,i["Content-Type"]="application/x-www-form-urlencoded",i.RequestId=n,i.CorrelationId=n,i.TransactionId=n,i["x-ms-client-type"]=(0,p.I)(this.platformService,this.config),i}persistTokenToAMS(e,t){var i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n,s,o,r=d.E.Skype;const c=null!==(i=_.get(t))&&void 0!==i?i:[],l=this.getHeaders(e,t);if(!e)return Promise.resolve(null);if(this._activeAmsRequest[t])return this._activeAmsRequest[t];switch(this._logger.log(`persistTokenToAMS: received new token for ${t}`),t){case v.ej.SKYPE_KEY:n=`skypetoken=${e}`,s="v1/skypetokenauth",r=d.E.Skype;break;case v.ej.MT_KEY:s=this._isMTMAProfilePicturesEnabled&&(null===(a=this.user)||void 0===a?void 0:a.id)?j.replace("{objectId}",this.user.id):w,r=d.E.MiddleTier,o=yield this.getBaseUrl(c[0]);const{requireSkypetokenForMT:t}=this.coreSettings.get(u.J.Auth),{disableSkypeTokenInCookieRequest:i}=this.coreSettings.get(u.J.People);t&&!i&&(l["x-skypetoken"]=yield this._discover.validateSkypeToken())}return this._logger.log(`persistTokenToAMS: queueing request for ${t}`),this.queueRequests(c,t,{requestUrl:s,headers:l,requestBody:n,serviceName:r},"persistTokenToAMS"),Promise.all(this._activeAmsRequest[t]).then((()=>{this._activeAmsRequest[t]=void 0,this._logger.log(`persistTokenToAMS: persist token for ${t}`),t===v.ej.MT_KEY&&(this.setImageAuthCookieValidityAndExpiry(),o?this._baseImageUrlSubject.next(o):this._logger.error("baseImageUrl is undefined"))})).catch((e=>{this._logger.error(`Unable to persist token: tokenType ${t} error ${e}`),this._activeAmsRequest[t]=void 0;const{enableRetryAuthCookieWithEM:i}=this.coreSettings.get(u.J.People);i&&(null==e?void 0:e.code)===m.jK.RemoteOperationFailed&&t===v.ej.MT_KEY&&(this._logger.log("persistTokenToAMS: retry cookie set up with EM"),this.setupImageAuthCookieAndExpiry())})),this._activeAmsRequest[t]}))}queueRequests(e,t,i,n){this._activeAmsRequest[t]=[],e.map((e=>{this._activeAmsRequest[t].push(this.getRequest(e,i,n))}))}subscribeToClientState(){var e;const{enableAuthCookieValidityCheck:t}=this.coreSettings.get(u.J.People);t&&(null===(e=this.clientState)||void 0===e||e.observe().subscribe((e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t,i,n;const a=this._previousClientState===c.pk.Inactive||this._previousClientState===c.pk.LongInactive,s=e===c.pk.Active||e===c.pk.VeryActive;if(a&&s){this._previousClientState=e;if(this.isImageCookieExpired()){this._isImageAuthCookieValidSubject.next(!1);const a=null===(t=this.networkState)||void 0===t?void 0:t.isOnline();if(this._logger.log(`clientState ${e} image cookie expired isOnline ${a}`),a){const{mtResource:e}=yield this.coreSettings.get(u.J.Auth);if(e&&(null===(i=this._authenticationService)||void 0===i?void 0:i.acquireTokenV2)){const t=Math.round(Date.now()/C);this._logger.log(`force token refresh now ${t}`);const i=yield null===(n=this._authenticationService)||void 0===n?void 0:n.acquireTokenV2(e);this._logger.log(`refreshed token expiry ${null==i?void 0:i.expires}`)}}}}else this._previousClientState=e})))))}subscribeToMiddleTierToken(){var e;null===(e=this._authenticationService)||void 0===e||e.observeMiddleTierToken().subscribe((e=>{if(e||this.isImageCookieExpired()){const t=e?"token changed":"cookie expired";this._logger.log(`Set up image auth cookie due to: ${t}`),this.setupImageAuthCookieAndExpiry()}else this._isImageAuthCookieValidSubject.next(!0)}))}setImageAuthCookieValidityAndExpiry(){var e,t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){this._isImageAuthCookieValidSubject.next(!0);const{mtResource:n}=(yield this.coreSettings.get(u.J.Auth))||{};if(n&&(null===(e=this._authenticationService)||void 0===e?void 0:e.acquireTokenV2)){const e=yield null===(t=this._authenticationService)||void 0===t?void 0:t.acquireTokenV2(n),a=null==e?void 0:e.expires;a&&(null===(i=this.localStorage)||void 0===i||i.set(this._imageAuthCookieExpiryTsKey,a.toString(),"Global")),this._logger.log(`Successfully set up image auth cookie expiry ${a}`)}}))}setupImageAuthCookieAndExpiry(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this._isSetupImageCookieInProgress){this._isSetupImageCookieInProgress=!0,this._logger.log("Setting up image auth cookie");try{yield this._setupImageAuthCookieApi.setupImageAuthCookie(),this.setImageAuthCookieValidityAndExpiry()}catch(e){this._logger.error(`setupImageAuthCookieAndExpiry error ${e}`)}finally{this._isSetupImageCookieInProgress=!1}}}))}isImageCookieExpired(){var e;const t=Math.round(Date.now()/C),i=(null===(e=this.localStorage)||void 0===e?void 0:e.get(this._imageAuthCookieExpiryTsKey,"Global"))||"-1";return parseInt(i,10)<t}imageCookieRetryPolicy(){return{shouldRetry:(e,t,i)=>{if(t>=l.qb.OK&&t<=l.qb.NOT_MODIFIED)return!1;const n=e<this._imageCookieRetryMaxCount&&t!==l.qb.BAD_REQUEST&&t!==l.qb.NOT_AUTHORIZED&&t!==l.qb.FORBIDDEN;return this._logger.warn(`imageCookieRetryPolicy retry count ${e} responseCode ${t} canRetry ${n}`),n},nextDelay:e=>this._imageCookieRetryInterval*Math.pow(2,e)}}get baseImageUrlObservable(){return this._baseImageUrlSubject.asObservable()}get isImageAuthCookieValidObservable(){return this._isImageAuthCookieValidSubject.asObservable()}get baseImageUrl(){return this._baseImageUrlSubject.value}get isImageAuthCookieValid(){return this._isImageAuthCookieValidSubject.value}}},160368:(e,t,i)=>{"use strict";i.d(t,{p:()=>d});var n=i(850402),a=i(974794),s=i(697337),o=i(627997),r=i(817095),c=i(709009),l=i(50805);let d=class{transform(e,t){const i=t.superSizeEmoticons&&!t.disableBigEmoticons?"large":"small",n=(0,c.cn)(i),a=t=>o.N.DomUtils.getAttributeValue(e,t)||"",d=a("itemid");t.telemetryDatabag&&(t.telemetryDatabag["DataBag.emojiList"]=[...t.telemetryDatabag["DataBag.emojiList"]||[],`Skype.${d}`],t.telemetryDatabag["DataBag.emoji"]=t.telemetryDatabag["DataBag.emojiList"].length);const u=t.isLiteEmoticon?{class:`animated-emoticon-${n}-${d}`}:{contenteditable:"false",title:a("title"),type:`(${d})`,class:`animated-emoticon-${n}-${d}`},m=(0,r.ln)("span",u),g=a("alt")||a("itemscope"),h=t.isLiteEmoticon?{itemid:d,alt:g}:{itemscope:"",itemtype:s.T.emoji,itemid:d,src:(0,c.rO)(d,i,t.coreSettings.get(l.J.Messaging),!1),title:a("title"),alt:g,style:`width:${n}px;height:${n}px;`},p=(0,r.ln)("img",h);return o.N.DomUtils.appendChild(m,p),m}};d=(0,n.__decorate)([(0,a.wx)({name:"EmoticonSerializer",filter:{itemtype:s.T.emoji}})],d)},4902:(e,t,i)=>{"use strict";i.d(t,{D:()=>tt,fh:()=>Xe,Vf:()=>et,bl:()=>Ze});var n=i(850402),a=i(275742),s=i(50805),o=i(738646),r=i(974794),c=i(575644),l=i(43889),d=i(627997),u=i(2246);const m=e=>{e&&d.N.DomUtils.hasAttrib(e,u.zj.type)&&delete e.attribs[u.zj.type]};var g=i(402750),h=i(645534),p=i(697337),v=i(68950),f=i(516909);const b={fileDetailsPromiseResolved:"file_deatails_promise_resolved"};let y=class{constructor(){this._allowAsyncChicletCreation=!1,this._asyncLinkConversionDetailsByItemId=new Map,this._loggerCb=a.noop,this._timeout=0}preTransform(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!e||!t||!d.N.DomUtils.hasAttrib(e,"href"))return;this._setupConstants(t);const n=e.attribs[u.zj.itemid];if(!n)return;const s=!!d.N.DomUtils.hasAttrib(e,u.zj.dataProcessedUrl)&&"true"===e.attribs[u.zj.dataProcessedUrl];if(this._allowAsyncChicletCreation&&!s){const s=(0,a.unescape)(e.attribs.href),{fileReferenceService:r}=t,l=r.parseFileLabelFromUrl(s);if(!l)return void m(e);const d=null===(i=this._scenarioFactory)||void 0===i?void 0:i.newScenario(o.RG.AsyncLinkToChiclet),u=this._asyncLinkConversionDetailsByItemId.get(n);if(u)return void x(u,s,d,(e=>this._asyncLinkConversionDetailsByItemId.set(n,e)));try{const e=(0,c.E)(r.getFileDetails(l,"chat",["fluid"]),this._timeout,"file details call timed out");this._asyncLinkConversionDetailsByItemId.set(n,{fileDetailsPromise:e,scenario:d,linkInfo:{href:s,count:1}})}catch(t){const i=(null==t?void 0:t.message)||"";return F(e,d,i)}}return e}))}transform(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!(e&&d.N.DomUtils.hasAttrib(e,"href")&&t&&t.files&&t.messageProperties&&t.existingLinks))return;const i=e.attribs[u.zj.itemid];if(!i)return;const n=this._asyncLinkConversionDetailsByItemId.get(i);if(n){const{scenario:i}=n;try{const a=yield S(t,e,n);return i&&i.stop(),a}catch(t){return m(e),void(0,g.V)(t,this._loggerCb,i)}}if(!d.N.DomUtils.hasAttrib(e,u.zj.itemProps))return E(e,t);const{files:a}=t;try{const n=N(a,e);if(!n)return;const{shareUrl:s,title:o}=n;s&&(e.attribs.href=s),j(e,o,s),w(n,i,t)}catch(e){return}return e}))}_setupConstants({coreSettings:e,loggerFactory:t,scenarioFactory:i}){this._loggerCb=k(t.newLogger("SharepointLinkSerializer","services-io-files-compose-serializer-extensions")),this._scenarioFactory=i;const{enableFilesAsyncChicletCreationInMultiWindow:n,asyncChicletCreationTimeout:a}=e.get(s.J.Files);this._allowAsyncChicletCreation=!!n,this._timeout=a||3e3}};y=(0,n.__decorate)([(0,r.HR)({name:"SharepointLinkSerializer",filter:"a"})],y);const k=e=>t=>{e.error(t)},S=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{fileDetailsPromise:n,scenario:a}=i,s=yield n;return a&&a.mark(b.fileDetailsPromiseResolved),w(s,s.fileId,e),((e,t)=>{const{files:i}=t;return-1!==i.findIndex((t=>t.id===e.fileId))})(s,e)||I(e,(({objectUrl:e,shareUrl:t,type:i,fileId:n,title:a,baseUrl:s,shareId:o,fileSourceDetail:r})=>{const c=(0,v.gD)(e),{permissionScope:l}=r||{permissionScope:""};return{id:n,baseUrl:s,objectUrl:e,shareUrl:t,shareId:o,type:i,title:a,permissionScope:l,state:f.cj1.reference,isReferencedFile:!0,serviceName:f.a4b.p2p,previewUrl:"",chicletBreadcrumbs:{sourceChannelName:(null==c?void 0:c.sourceChannelName)||null,sourceTeamName:(null==c?void 0:c.sourceTeamName)||null},previewHeight:null,previewWidth:null,progressComplete:null,hasUploadFailed:!1}})(s)),m(t),t})),w=(e,t,i)=>{const{objectUrl:n,shareUrl:a,title:s,type:o}=e,r=_({objectUrl:n,shareUrl:a,itemid:t,type:o,title:s});T(i,r)},j=(e,t,i)=>{e.children&&C(t,e,i)},C=(e,t,i)=>{const n=[t];for(;0!==n.length;){const s=n.pop();if(s&&s.children)for(const o of s.children){if("text"===o.type&&(0,a.startsWith)(o.data,"https"))return o.data=e,t.attribs&&(t.attribs.title=i),!0;n.push(o)}}return!1},_=({objectUrl:e,shareUrl:t,itemid:i,type:n,title:a})=>({title:a,objectUrl:e,description:"",fileShareUrlMeta:{id:i,objectUrl:e,type:n,shareUrl:t}}),T=(e,t)=>{e.messageProperties.embeddedLinks=[...e.messageProperties.embeddedLinks||[],t],e.telemetryDatabag["DataBag.links"]=(e.telemetryDatabag["DataBag.links"]||0)+1},I=(e,t)=>{e.files.push(t)},N=(e,t)=>{const i=t.attribs[u.zj.itemid],n=e.find((e=>e.id===i));if(n){const{shareUrl:e,title:t,objectUrl:i,type:a}=n;return{shareUrl:e||"",title:t||"",type:a||"",objectUrl:i||""}}if(t.attribs[u.zj.itemtype]===p.T.filesHyperlink){const e=t.attribs[u.zj.itemProps];if(e){const t=(0,a.unescape)((0,a.unescape)(e)),i=JSON.parse(t),{type:n,objectUrl:s,shareUrl:o,title:r}=i;return{shareUrl:o,title:r,objectUrl:s,type:n}}}},E=(e,t)=>{if(d.N.DomUtils.hasAttrib(e,"href")){const i=e.attribs.href||"",n=t.existingLinks.filter((e=>{var t;return(null===(t=e.fileShareUrlMeta)||void 0===t?void 0:t.shareUrl)===i}));if(n&&n.length&&n[0].fileShareUrlMeta)return T(t,(0,l.i)(n[0],"__typename")),e}},F=(e,t,i)=>{m(e),null==t||t.fail({errorCode:h.le.telemetry.errorCodes.asyncLinkConversionPretransformFailure,errors:JSON.stringify(i)})},x=(e,t,i,n)=>{const{linkInfo:a}=e;let s="";if(a&&t===a.href){const{count:i}=a;s=`Duplicate links: ${i}`,n(Object.assign(Object.assign({},e),{linkInfo:{href:t,count:i+1}}))}else s="Different href for same itemid";null==i||i.incomplete({errorCode:h.le.telemetry.errorCodes.asyncLinkMultiplePretransform,errors:s})};var D=i(985047),A=i(817095),M=i(760005),P=i(711676);let O=class{constructor(){this._shouldGroupMentions=()=>this._enableComposeFrameworkV2&&this._enableGroupedMentions,this._unescapeMentionText=e=>this._enableComposeFrameworkV2?(0,a.unescape)(e).replace(/&nbsp;/g," "):e,this._removeExtraSpacesInMention=e=>{var t;null===(t=e.parent)||void 0===t||t.children.forEach((e=>{"text"!==e.type||" "!==e.data&&!this._isWhitespaceFromComposeV2(e.data)||d.N.DomUtils.removeElement(e)}))},this._getMentionKey=e=>{var t,i,n;const a=null===(i=null===(t=e.children)||void 0===t?void 0:t[0])||void 0===i?void 0:i.data;return`${null===(n=e.attribs)||void 0===n?void 0:n[u.zj.mri]}_${a}`},this._mergeMentions=(e,t)=>{if(!e.attribs)return;const i=e.attribs[u.zj.mri]||"";let n=this._getNextContigousMention(e,i);for(;e.children&&e.children.length>0&&n;){const a=n.children;if(a&&a.length>0&&a[0].data){const i=this._getMentionKey(n),s=t.get(i);s?t.set(i,s+1):t.set(i,1),e.children[0].data+=` ${a[0].data}`}n=this._getNextContigousMention(n,i)}},this._isWhitespaceFromComposeV2=e=>!("&nbsp;"!==e||!this._shouldGroupMentions()),this._getNextContigousMention=(e,t)=>{var i;if(!e||!e.next)return null;const n=e.next,a=t===(null===(i=null==n?void 0:n.attribs)||void 0===i?void 0:i[u.zj.mri]);return" "===n.data||this._isWhitespaceFromComposeV2(n.data)||a?n:null},this._enableComposeFrameworkV2=!1,this._enableGroupedMentions=!1}transform(e,t){var i,n,o;const{enableComposeFrameworkV2:r}=t.coreSettings.get(s.J.Messaging),{enableGroupedMentions:c}=t.coreSettings.get(s.J.Compose);if(this._enableComposeFrameworkV2=!!r,this._enableGroupedMentions=!!c,!(e&&t&&t.messageProperties&&d.N.DomUtils.hasAttrib(e,u.zj.mri)))return;t.seenMentions||(t.seenMentions=new Map);const l=this._getMentionKey(e),m=t.seenMentions.get(l);if(m)return 1===m?t.seenMentions.delete(l):t.seenMentions.set(l,m-1),null;this._mergeMentions(e,t.seenMentions);const{messageProperties:g,telemetryDatabag:h}=t;g.mentions||(g.mentions=[]),g.onBehalfOf||(g.onBehalfOf=[]);const v=`${g.mentions.length+g.onBehalfOf.length}`,f=this._unescapeMentionText((0,A.Q)(e)),b=(null===(i=null==e?void 0:e.attribs)||void 0===i?void 0:i[u.zj.type])||(R(e)?"bot":"person");if("tag"===b){const t=(null===(o=null===(n=null==e?void 0:e.attribs)||void 0===n?void 0:n[u.zj.mri])||void 0===o?void 0:o.startsWith("s"))?"PeopleTargeting.numScheduledTagMentions":"PeopleTargeting.numTeamTagMentions";h[t]=(h[t]||0)+1}else h["DataBag.atmentions"]=(h["DataBag.atmentions"]||0)+1;const y=(0,A.ln)(D.s.span),k=(0,A.rw)((0,a.escape)(f)),S=d.N.DomUtils.hasAttrib(e,u.zj.stale),w=d.N.DomUtils.getAttributeValue(e,u.zj.mri)||"";return d.N.DomUtils.appendChild(y,k),S||("webhook"===b?(g.onBehalfOf.push({itemId:v,displayName:f,userId:w,mentionType:b}),g.mentions.push({itemId:`${Number(v)+1}`,displayName:f,userId:M.BB.InterceptorBotMris[0],mentionType:b})):g.mentions.push({itemId:v,displayName:f,userId:w,mentionType:b}),y.attribs[u.zj.itemtype]=p.T.mention,y.attribs[u.zj.itemscope]="",y.attribs[u.zj.itemid]=v),this._removeExtraSpacesInMention(e),y}};O=(0,n.__decorate)([(0,r.wx)({name:"AtMentionSerializer",filter:"mention"}),(0,n.__metadata)("design:paramtypes",[])],O);const R=e=>{var t;return(0,P.bl)((null===(t=null==e?void 0:e.attribs)||void 0===t?void 0:t[u.zj.mri])||"")};let L=class{transform(e,t){if(!e.attribs)return void t.logger.error("image attribs is missing");const i=d.N.DomUtils.getAttributeValue(e,u.zj.cacheKey);if(i&&i.length)return e.attribs["data-cke-saved-src"]=void 0,e.attribs.src=t.offlineCacheManager.getCachedUrlByKey(i),e;t.logger.error("image missing cache key")}};L=(0,n.__decorate)([(0,r.wx)({name:"CachedImageSerializer",filter:[{itemtype:p.T.cachedImage}]})],L);let U=class{preTransform(e){return null}};U=(0,n.__decorate)([(0,r.wx)({name:"RemoveHiddenSelectionSerializer",filter:["data-cke-hidden-sel"]})],U);var $=i(513125);let W=class{transform(e){if(e.data&&$.Eh.test(e.data))return e.data=e.data.replace(new RegExp($.Eh,"g"),""),e}};W=(0,n.__decorate)([(0,r.wx)({name:"RemoveZwsSerializer",filter:"text",transient:!0})],W);const B="data-only-whitespace",z=/^(\s|[\u200B-\u200D\uFEFF])*$/;let H=class{preTransform(e,t){return q(e)?void(t.whiteSpaceId&&t.whiteSpaceId++):(t.whiteSpaceId||(t.whiteSpaceId=1),e.attribs||(e.attribs={}),e.attribs[B]=`${t.whiteSpaceId+1}`,e)}};H=(0,n.__decorate)([(0,r.wx)({name:"WhiteSpacePreprocessor",filter:["div","p","br","span","text"],transient:!0})],H);const q=e=>!z.test((0,A.Q)(e))||!!d.N.DomUtils.findOne((e=>{if(e.attribs&&Object.keys(e.attribs).length||!e.name)return!0;switch(e.name.toLowerCase()){case"br":case"div":case"p":case"span":break;default:return!0}return!1}),[e]);let V=class{transform(e,t){const i=d.N.DomUtils.getAttributeValue(e,B);return!t.whiteSpaceId||!i||+i>t.whiteSpaceId?null:(e.attribs&&delete e.attribs[B],e)}};V=(0,n.__decorate)([(0,r.wx)({name:"TrailingWhiteSpaceSerializer",filter:[B],transient:!0})],V);var G=i(945148);const J={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataM365ChatSuggestionStateQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"m365ChatSuggestionState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"convId"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"experience"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"query"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}}]},K={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataM365ChatGeoLocationQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"m365GeoLocation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latitude"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"longitude"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}}]};let Q=class{transform(e,t){const{messageProperties:i,coreSettings:n,conversationMembers:o,cache:r,convId:c,loggerFactory:l}=t,{m365ChatBotIds:m,copilotBotDataVersion:g}=n.get(s.J.Messaging);if(!(Y(m,o,i,l,r,c,g,e)&&e&&t&&t.messageProperties&&d.N.DomUtils.hasAttrib(e,u.zj.itemtype)))return;const h=d.N.DomUtils.getAttributeValue(e,u.zj.itemtype);if(h!==p.T.editorCiqFile&&h!==p.T.editorCiqPeople&&h!==p.T.editorCiqMeeting&&h!==p.T.editorCiqEmail&&h!==p.T.editorCiqChat)return;const v=d.N.DomUtils.getAttributeValue(e,u.zj.itemProps);return v&&X((0,a.unescape)(v),i,null!=g?g:ae,h),e}};Q=(0,n.__decorate)([(0,r.wx)({name:"CopilotSerializer",filter:"*"})],Q);const Y=(e,t,i,n,a,s,o,r)=>{var c,l;const d=null!==(c=null==t?void 0:t.filter((e=>null==e?void 0:e.startsWith("28:"))))&&void 0!==c?c:[];let u=!1;if(1===(null==d?void 0:d.length)&&e){const t=e.indexOf(d[0]);void 0!==t&&(u=t>-1)}let m=null===(l=i.mentions)||void 0===l?void 0:l.find((e=>e.mentionType===ne));if(u&&!m){const e=Z(s,n,a,r);m={itemId:"0",userId:"3209c41b-0e5c-45cb-b72e-68dcecbaa23d",mentionType:ne,displayName:JSON.stringify(Object.assign({copilotBotDataVersion:null!=o?o:"1.0",files:[],people:[],meetings:[],chats:[],emails:[]},e))},i.mentions=[m]}return u},X=(e,t,i,n)=>{var a;let s=null===(a=t.mentions)||void 0===a?void 0:a.find((e=>e.mentionType===ne));s||(s={itemId:"0",userId:"3209c41b-0e5c-45cb-b72e-68dcecbaa23d",mentionType:ne,displayName:JSON.stringify({copilotBotDataVersion:"1.0",files:[],people:[],meetings:[],chats:[],emails:[]})});const o=JSON.parse(s.displayName),r=o.files,c=o.people,l=o.meetings,d=o.chats,u=o.emails,m=o.experienceType,g=o.locationInfo;let h;try{h=JSON.parse(ie(ie(e)))}catch(e){return}n===p.T.editorCiqFile&&r.push(h),n===p.T.editorCiqPeople&&c.push(h),n===p.T.editorCiqMeeting&&l.push(h),n===p.T.editorCiqChat&&d.push(h),n===p.T.editorCiqEmail&&u.push(h);const v={experienceType:m,locationInfo:g,copilotBotDataVersion:i||o.CopilotBotDataVersion,files:r,people:c,meetings:l,chats:d,emails:u};s.displayName=JSON.stringify(v),t.mentions=[s]},Z=(e,t,i,n)=>{const a=t.newLogger("CopilotSerializer","services-io-browser-compose-serializer-extensions");return{experienceType:ee(e,a,i,n),locationInfo:te(i,a)}},ee=(e,t,i,n)=>{const a=f.d$.Default;if(!n)return a;const{experience:s,query:o,convId:r}=((e,t)=>{var i;let n=null;try{n=e.readQuery({query:J})}catch(e){null==t||t.error("Cannot read zero prompt state from the cache.")}const{convId:a,experience:s,query:o}=null!==(i=null==n?void 0:n.m365ChatSuggestionState)&&void 0!==i?i:{};return{convId:a,experience:s,query:o}})(i,t);if(r!==e||!s)return a;let c=s;switch(s){case f.d$.FirstRunContextIQ:case f.d$.FirstRunNoParams:if(c=a,o){d.N.DomUtils.getText(n).substring(0,o.length)===o&&(c=s)}}return c},te=(e,t)=>{const{latitude:i,longitude:n}=((e,t)=>{var i;let n=null;try{n=e.readQuery({query:K})}catch(e){null==t||t.error("Cannot read zero prompt state from the cache.")}const{latitude:a,longitude:s}=null!==(i=null==n?void 0:n.m365GeoLocation)&&void 0!==i?i:{};return{latitude:a,longitude:s}})(e,t);return i&&n?{lat:i,long:n}:void 0},ie=e=>e?e.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g,"Â ").replace(/&amp;/g,"&"):"",ne="Copilot",ae="1.0";var se=i(453489),oe=i(709009);let re=class{transform(e,t){const i=e.attribs.src,n=e.attribs.itemid;if(!i||!n)return;const a=t.superSizeEmoticons?"large":"small",s=(0,oe.cn)(a),o=e.attribs.alt,r=e.attribs.title,c=(0,A.ln)("img",{alt:o,itemid:n,itemtype:p.T.customEmoji,src:i,title:r,style:`width:${s}px;height:${s}px;`}),l=(0,A.ln)("span",{contenteditable:"false"});return d.N.DomUtils.appendChild(l,c),l}};re=(0,n.__decorate)([(0,r.wx)({name:"CustomEmojiSerializer",filter:{itemtype:p.T.customEmoji}})],re);var ce=i(160368);let le=class{transform(e){return d.N.DomUtils.getAttributeValue(e,u.zj.itemProps)&&delete e.attribs[u.zj.itemProps],e}};le=(0,n.__decorate)([(0,r.wx)({name:"FluidEmbedSerializer",filter:{itemtype:p.T.fluidEmbedLink}})],le);var de=i(941478),ue=i(539744);let me=class{transform(e,t){const i=d.N.DomUtils.getAttributeValue(e,"href");if(!i||!e.attribs)return;const n=i.replace(/&amp;/g,"&");d.N.DomUtils.getAttributeValue(e,u.zj.itemProps)&&delete e.attribs[u.zj.itemProps];const a={appId:"fluid-card",cardClientId:(0,de.Z)(),contentType:ue.p.Fluid,content:JSON.stringify({componentUrl:n})};return t.messageProperties.cards=[a],t.files=void 0,e}};me=(0,n.__decorate)([(0,r.wx)({name:"FluidSerializer",filter:{itemtype:p.T.fluidLink}})],me);var ge=i(974509),he=i(188143),pe=i(734625),ve=i(519036),fe=i(671168);let be=class{constructor(){this.getImageBlobUrlFromCache=(e,t)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=yield e.offlineCacheManager.get(t),n=yield i.blob();return URL.createObjectURL(n)})),this.processCachedImage=(e,t)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var i;const n=d.N.DomUtils.getAttributeValue(e,u.zj.cacheKey);if(!n)return void this._logger.error("Cached image missing key attribute.");this._logger.log(`processing cached image: ${n}`);const a=null===(i=this._scenarioFactory)||void 0===i?void 0:i.newScenario(o.RG.SerializeCachedImage);try{const i=d.N.DomUtils.getAttributeValue(e,"src"),s=!!(null==i?void 0:i.startsWith("blob"));let r;try{const e=yield t.offlineCacheManager.get(n);r=yield null==e?void 0:e.blob()}catch(e){r=null,this._logger.warn(`processCachedImage: Could not find cached image with key=${n} in offlineCacheManager`)}if(!r&&s&&i&&(r=yield(0,fe.Hk)(i)),null===r)throw Error("Could not get image Blob neither from cache nor from blob data");null==a||a.mark(o.ck.SerializeCachedImageGotData);const c=yield this.uploadImage(r,t);ke(e,c,t),null==a||a.mark(o.ck.SerializeCachedImageUploadedData),yield this.markCachedImageForDeletionIfUploaded(c,e,n,t,a)}catch(e){throw this._logger.error(`processCachedImage: Failed to process cached image with key=${n}`),null==a||a.fail(),e}finally{null==a||a.stop()}return e}))}transform(e,t){if(this._logger=t.loggerFactory.newLogger("InlineImageSerializer","services-io-browser-compose-serializer-extensions"),e.attribs.itemtype===p.T.customEmoji)return Promise.resolve(e);if(!this.isConfigValid(t))return this._logger.error("invalid config"),Promise.resolve(void 0);this._scenarioFactory=t.scenarioFactory,this._settings=t.coreSettings;let i=d.N.DomUtils.getAttributeValue(e,"src");const{enableImprovedImageHandling:n,enableComposeFrameworkV2:a,enableImageBlobConversionForMessageEdit:o}=this._settings.get(s.J.Messaging);if(!i)return this._logger.error("image src is missing"),Promise.resolve(void 0);if((n||o)&&a){const t=d.N.DomUtils.getAttributeValue(e,"data-orig-src");i=t&&(0,pe.KD)(t)?t:i}const r=(0,pe.KD)(i);if(r)return this.handleAmsSourceTag(r,e,t);return d.N.DomUtils.getAttributeValue(e,u.zj.itemtype)===p.T.cachedImage?this.processCachedImage(e,t):i.startsWith("http://")||i.startsWith("https://")?(0,ve.kf)(i)?this.processKnownImage(i,t.telemetryDatabag):this.handleKnownProtcolSourceTag(i,"HttpUrl",e,t):i.startsWith("blob:")?this.handleKnownProtcolSourceTag(i,"BlobUrl",e,t):(this._logger.error("Unsupported image! deleting it."),Promise.resolve(null))}uploadPermissionsUpdateToCache(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{this._logger.log("uploadPermissionsUpdateToCache: uploading image permissions update to offline cache storage");const i={type:"PermissionsUpdate",amsId:e,convId:t.conversationId},n=JSON.stringify(i),[a,s]=yield t.offlineCacheManager.saveDynamic(new Response(n,{headers:new Headers({"Content-Type":"application/json","Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${n.length}`,Date:(new Date).toUTCString()})}));return this._logger.log(`uploadPermissionsUpdateToCache: Uploaded image permissions update to offline cache, response URL: ${s} objectId: ${a}`),t.messageProperties.offlineAssets=[...t.messageProperties.offlineAssets||[],a],a}catch(e){throw this._logger.error("uploadPermissionsUpdateToCache: uploading image permissions update to offline cache store failed!"),e}}))}handleAmsSourceTag(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const n="AMS",a=yield i.asyncMediaService.forwardContent(e,i.conversationId);return this._logger.log(`forwarded ams image ${e} to ${a.objectId}`),i.messageProperties.amsReferences=[...i.messageProperties.amsReferences||[],a.objectId],ke(t,Object.assign(Object.assign({},a),{uploadType:n}),i),t}catch(e){const{enableAutoEditV2:t}=this._settings.get(s.J.Messaging);if(!t)throw this._logger.error("handleAmsSourceTag: forward content failed!"),e;this._logger.warn("handleAmsSourceTag: initial forward content failed, attempting to upload image to cache")}try{return yield this.uploadPermissionsUpdateToCache(e,i),ye(i),t}catch(e){throw this._logger.error("handleAmsSourceTag: forward content failed! Fallback uploading to the cache also failed!"),e}}))}handleKnownProtcolSourceTag(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield Se(e,t,a),s=yield this.uploadImage(n,a);return ke(i,s,a),i}catch(e){throw this._logger.error("handleKnownProtcolSourceTag: pasted from web image upload failed"),this.addDiagnosticCodeToError(e),e}}))}uploadImage(e,t,i=!1){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{return yield this.uploadImageToAms(e,t,this._logger)}catch(n){this._logger.error("uploadImage: image upload to AMS failed!");const{enableCacheStorageInSendMessageMW:a,msgEnableRestrictImagePasting:o}=this._settings.get(s.J.Messaging);if(!a||o||i)throw n;this._logger.debug("Trying to upload inline image to cache storage");return yield this.uploadToCache(e,t,this._logger)}}))}uploadImageToAms(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=t.asyncMediaService.createAmsScenario(o.RG.AmsImageUpload);try{const a="AMS",s=yield t.asyncMediaService.uploadItem(e,t.conversationId,"IMAGE","MicrosoftTeams-image.png",he.r1.Inline);return i.log(`Uploaded image to ams, image: ${s.inlineSizeUrl} objectId: ${s.objectId}`),n.stop(),t.messageProperties.amsReferences=[...t.messageProperties.amsReferences||[],s.objectId],Object.assign(Object.assign({},s),{uploadType:a})}catch(e){throw n.fail({errors:e.message}),i.error("Ams image upload failed!"),e}}))}uploadToCache(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{i.log("uploading inline image to offline cache storage");const[n,a]=yield t.offlineCacheManager.saveDynamic(new Response(e,{headers:new Headers({"Content-Type":e.type,"Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${e.size}`,Date:(new Date).toUTCString()})}));i.log(`Uploaded image to offline cache, image: ${a} objectId: ${n}`);const s="OfflineCache";t.messageProperties.offlineAssets=[...t.messageProperties.offlineAssets||[],n];return{objectId:n,inlineSizeUrl:yield this.getImageBlobUrlFromCache(t,n),uploadType:s}}catch(e){throw i.error("uploadToCache: uploading inline image to offline cache store failed!"),e}}))}markCachedImageForDeletionIfUploaded(e,t,i,a,s){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return"OfflineCache"!==e.uploadType&&(null==s||s.mark(o.ck.SerializeCachedImageDeletedEntry,void 0),a.nonBlockingDeletableCacheKeys.push(i),t.attribs&&delete t.attribs[u.zj.cacheKey],!0)}))}isConfigValid(e){return!!(e&&e.asyncMediaService&&e.messageProperties&&e.imageProxyService&&e.conversationId&&e.telemetryDatabag&&e.offlineCacheManager)}processKnownImage(e,t){return e.endsWith(".gif")&&(t["DataBag.giphy"]=(t["DataBag.giphy"]||0)+1),Promise.resolve(void 0)}addDiagnosticCodeToError(e){if(e.serverResponse&&e.serverResponse.status){if(e.serverResponse.status===ge.qb.UNSUPPORTED_MEDIA_TYPE)e.reason=Object.assign(Object.assign({},e.reason),{errorCode:pe.hA.IMAGE_SIZE_TOO_LARGE})}}};be=(0,n.__decorate)([(0,r.HR)({name:"InlineImageSerializer",filter:["img","image"]})],be);const ye=e=>{e.telemetryDatabag["DataBag.inlineImages"]=(e.telemetryDatabag["DataBag.inlineImages"]||0)+1},ke=(e,t,i)=>{e.attribs||(e.attribs={}),e.attribs.id=t.objectId,e.attribs.itemid=t.objectId,e.attribs.href=t.inlineSizeUrl,e.attribs["target-src"]=t.inlineSizeUrl,e.attribs.src=t.inlineSizeUrl,e.attribs[u.zj.itemtype]="AMS"===t.uploadType?p.T.amsImage:p.T.cachedImage,ye(i)},Se=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){let n=null;return"BlobUrl"===t?n=yield(0,fe.Hk)(e):"HttpUrl"===t&&(n=yield i.imageProxyService.getImageAsBlob(e)),n}));var we=i(765923),je=i(558632),Ce=i(64217),_e=i(727064),Te=i(643133),Ie=i(899517);const Ne=/[a-z]+-[a-z]+/gi,Ee=e=>{var t;return null!==(t=(0,Ie.LJ)(e).locale)&&void 0!==t?t:e};let Fe=class{transform(e,t){var i,a,r,c;return(0,n.__awaiter)(this,void 0,void 0,(function*(){this._logger=t.loggerFactory.newLogger("InlineVideoSerializer","services-io-browser-compose-serializer-extensions");const{enableInlineVideoMessageClosedCaptionsMultiLanguageSupport:n}=t.coreSettings.get(s.J.Messaging),l=t.scenarioFactory.newScenario(o.RG.InlineVideoAsyncTransform),{conversationId:d,videoMessageLieUpdater:u}=t;if(!(e&&e.attribs&&0!==Object.keys(e.attribs).length&&t.asyncMediaService&&t.offlineCacheManager&&u))return l.fail({errorCode:"unexpected_precondition"}),void(null===(a=(i=this._logger).errorToTelemetry)||void 0===a||a.call(i,`unexpected precondition : element - ${e}`,"messaging_inline_video_serializer_error_tracking",void 0,!0));this._offlineCacheManager=t.offlineCacheManager,this._asyncMediaService=t.asyncMediaService;const m=xe(e);if(!m)return l.fail({errorCode:"malformed_video_message"}),void(null===(c=(r=this._logger).errorToTelemetry)||void 0===c||c.call(r,`malformed video message: element - ${e}, additionalData - ${t}`,"messaging_inline_video_serializer_error_tracking",void 0,!0));l.appendEventData({correlationId:m.cacheKey});const g=yield this.resolveAMSItem(l,d,u,m);if(n){const e=t.scenarioFactory.newScenario(o.RG.VideoMessageTranscriptMetadataUpload);e.appendEventData({correlationId:m.cacheKey}),yield this.uploadTranscriptMetadata(e,g,t.i18n,m.cacheKey,u,m.transcriptUploadStatus),e.stop()}const h=t.scenarioFactory.newScenario(o.RG.VideoMessageThumbnailUpload);h.appendEventData({correlationId:m.cacheKey}),yield this.bestEffortUploadAMSVideoThumbnail(h,g,u,m),h.stop(),yield this.uploadAMSVideo(l,g,u,m),t.messageProperties.amsReferences=[...t.messageProperties.amsReferences||[],g];const p=this.createVideoMessageTag(e.attribs,m.src);return this.bestEffortCleanOfflineCacheManager(l,m.cacheKey,!!m.thumbnailUploadProgress),l.stop(),p}))}createVideoMessageTag(e,t){const i=(0,A.ln)("video",{src:t,itemscope:"",itemtype:p.T.amsVideo,"data-duration":e[u.zj.duration],width:e[u.zj.width],height:e[u.zj.height]});return i.children=[(0,A.rw)(_e.R2)],i}resolveAMSItem(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield this.createAMSObjectIfRequired(e,t,i,a.cacheKey,a.src);return a.src=n.src,n.objectId}catch(t){throw e.fail({errorCode:"create_ams_object_failed"}),new Error(`create ams object failed:${t.toString()}`)}}))}createAMSObjectIfRequired(e,t,i,a,s){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!s){e.mark(o.ck.ItemCreationStart);const n=yield this._asyncMediaService.createVideoObject(t,a),s=(0,_e.$N)(n.amsUrl,n.objectId);return this.bestEffortMessageLieUpdate(e,i,a,u.zj.src,s),e.mark(o.ck.ItemCreationStop),Object.assign(Object.assign({},n),{src:s})}e.mark(o.ck.UploadRetry);return{objectId:(0,pe.KD)(s),amsUrl:(0,je.DW)(s),src:s}}))}bestEffortUploadAMSVideoThumbnail(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(a.thumbnailUploadProgress&&a.thumbnailUploadProgress.progress!==a.thumbnailUploadProgress.total)try{const n=yield this.uploadAMSVideoThumbnail(e,t,i,a.cacheKey);a.thumbnailUploadProgress=n}catch(t){this._logger.warn("video thumbnail upload failed",t),e.fail({errorCode:"thumbnail_upload_failed"})}}))}uploadAMSVideoThumbnail(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){e.mark(o.ck.ThumbnailUploadStart);const n=yield this._offlineCacheManager.get((0,Te.cQ)(a)),s=yield n.blob();yield this._asyncMediaService.uploadVideoThumbnail(t,s,a);const r={progress:s.size,total:s.size};return this.bestEffortMessageLieUpdate(e,i,a,u.zj.thumbnailUploadProgress,(0,_e.tl)(r.progress,r.total)),e.mark(o.ck.ThumbnailUploadStop),r}))}uploadTranscriptMetadata(e,t,i,a,s,r){var c,l;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(r!==_e.b3.success){const n=((e,t,i)=>{const n=new Set;e&&n.add(Ee(e.toLowerCase())),t&&!n.has(t)&&n.add(Ee(t.toLowerCase()));const a=i.map((e=>Ee(e))).filter((e=>e.match(Ne)));if(a)for(const e of a){if(n.size>=4)break;n.has(e.toLowerCase())||n.add(e.toLowerCase())}return[...n].slice(0,4).join(";")})(i.locale,null===(c=i.osLocaleInfo)||void 0===c?void 0:c.regionalFormat,[...(null===(l=(0,we.J)())||void 0===l?void 0:l.navigator.languages)||[]]);try{e.mark(o.ck.TranscriptMetadataUploadStart,{message:n}),yield this._asyncMediaService.uploadTranscriptMetadata(t,n||"en-us",a),this.bestEffortMessageLieUpdate(e,s,a,u.zj.transcriptUploadStatus,_e.b3.success),e.mark(o.ck.TranscriptMetadataUploadStop)}catch(t){e.fail({errorCode:"video_transcript_metadata_upload_failed"}),this.bestEffortMessageLieUpdate(e,s,a,u.zj.transcriptUploadStatus,_e.b3.failure)}}}))}uploadAMSVideo(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{e.mark(o.ck.VideoUploadStart);const n=yield this._offlineCacheManager.get((0,Te.If)(a.cacheKey)),s=yield n.blob();yield this._asyncMediaService.uploadVideo(t,a.uploadProgress.progress,s,this.updateMessageLieVideoUploadProgress(e,i,a),a.cacheKey),e.mark(o.ck.VideoUploadStop)}catch(t){throw e.fail({errorCode:"video_upload_failed"}),new Error(`video upload failed:${t.toString()}`)}}))}bestEffortCleanOfflineCacheManager(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{yield this._offlineCacheManager.delete((0,Te.If)(t))}catch(t){this._logger.warn("video cache cleanup failed",t),e.mark(o.ck.VideoCacheCleanFailed)}try{i&&(yield this._offlineCacheManager.delete((0,Te.cQ)(t)))}catch(t){this._logger.warn("thumbnail cache cleanup failed",t),e.mark(o.ck.ThumbnailCacheCleanFailed)}}))}updateMessageLieVideoUploadProgress(e,t,i){return n=>{const a=n+1;i.uploadProgress.progress=a,this.bestEffortMessageLieUpdate(e,t,i.cacheKey,u.zj.uploadProgress,(0,_e.tl)(i.uploadProgress.progress,i.uploadProgress.total))}}bestEffortMessageLieUpdate(e,t,i,n,a){try{t(i,n,a)}catch(t){e.mark(o.ck.MessageLieUpdateFailed),this._logger.warn(t.toString())}}};Fe=(0,n.__decorate)([(0,r.HR)({name:"InlineVideo",filter:[{itemtype:p.T.amsVideo}]})],Fe);const xe=e=>{const t=d.N.DomUtils.getAttributeValue,i=t(e,u.zj.itemtype),n=t(e,u.zj.cacheKey),a=t(e,u.zj.src),s=t(e,u.zj.transcriptUploadStatus),o=t(e,u.zj.uploadProgress),r=t(e,u.zj.thumbnailUploadProgress),c=t(e,u.zj.duration),l=t(e,u.zj.width),m=t(e,u.zj.height);if(!i||!n||!o||!l||!m||!c||Number.isNaN(l)||Number.isNaN(m)||!(0,_e.cJ)(o))return;const g={itemType:i,cacheKey:n,uploadProgress:(0,_e.VI)(o),width:+l,height:+m,duration:+(0,Ce.J)(c),transcriptUploadStatus:s||_e.b3.pending};return a&&(g.src=a),r&&(g.thumbnailUploadProgress=(0,_e.VI)(r)),g};let De=class{transform(e,t){var i,s,r,c;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!e||!t.messageProperties)return;const n=t.loggerFactory.newLogger("VideoMessageComposeSerializer","services-io-browser-video-message-compose-serializer"),l=t.scenarioFactory.newScenario(o.RG.VideoMessageComposeTransform);l.mark(o.ck.VideoMessageValidation);const u=(0,a.unescape)(d.N.DomUtils.getAttributeValue(e,$.Qq)),m=d.N.DomUtils.getAttributeValue(e,$.fK);if(!u||!m)return null===(i=n.errorToTelemetry)||void 0===i||i.call(n,`The props are invalid from TVC card - ${e}.`,"messaging_inline_video_compose_serializer_error_tracking",void 0,!0),null;l.mark(o.ck.VideoMessageParsing);let g=null;try{g=JSON.parse(u)}catch(t){return null===(s=n.errorToTelemetry)||void 0===s||s.call(n,`Failed to parse props from TVC card - ${e}.`,"messaging_inline_video_compose_serializer_error_tracking",void 0,!0),null}if(!g||!g.amsObjectUrl)return null===(r=n.errorToTelemetry)||void 0===r||r.call(n,`The amsObjectUrl is missing from TVC card - ${e}.`,"messaging_inline_video_compose_serializer_error_tracking",void 0,!0),null;try{l.mark(o.ck.VideoMessageUpdateCard),this._updateCard(m,g,t),l.mark(o.ck.VideoMessageCreateTag);return this.createVideoMessageTag(g,m)}catch(e){return null===(c=n.errorToTelemetry)||void 0===c||c.call(n,"Failed to create the video tag additionalData","messaging_inline_video_compose_serializer_error_tracking",void 0,!0),null}}))}createVideoMessageTag(e,t){const i=(0,A.ln)("video",{src:e.amsObjectUrl,cardId:t,itemscope:"",itemtype:p.T.amsVideo,"data-duration":(0,_e.Hu)(e.duration),width:e.width.toString(),height:e.height.toString()});return i.children=[(0,A.rw)(_e.R2)],i}_updateCard(e,t,i){var n;const{amsObjectId:a}=t,s=i.messageProperties.amsReferences||[];i.messageProperties.amsReferences=[...s,a];const o=(null===(n=i.messageProperties.cards)||void 0===n?void 0:n.filter((t=>t.cardClientId!==e)))||[];i.messageProperties.cards=o}};De=(0,n.__decorate)([(0,r.HR)({name:"VideoMessage",filter:{[$.$S]:"VideoMessageCard"}})],De);var Ae=i(771256);const Me=(e,t,i)=>{e.forEach((e=>Pe(e,t,i)))},Pe=(e,t,i)=>{(0,Ae.gU)(e,{type:"TextBlock"},(e=>{Oe(e.text,t,i)})),(0,Ae.gU)(e,{type:"FactSet"},(e=>{e.facts.forEach((e=>{Oe(e.title,t,i),Oe(e.value,t,i)}))}))},Oe=(e,t,i)=>{const n=e.toLowerCase(),a='itemid="',s=n.indexOf(a),o=s+8;if(s>-1){const a=n.substring(o,o+1);if(t&&a){const n=Re(a,t,i);n&&(e=e.replace(new RegExp(a,"g"),n))}}},Re=(e,t,i)=>{let n="";return t.forEach((t=>{if(t.itemId===e){const{messageProperties:e,telemetryDatabag:a}=i;e.mentions||(e.mentions=[]),n=`${e.mentions.length}`;const s=t.displayName||"",o=t.mentionType||"",r=t.userId||"";a["DataBag.atmentions"]=(a["DataBag.atmentions"]||0)+1,e.mentions.push({itemId:n,displayName:s,userId:r,mentionType:o})}})),n};var Le=i(690250);let Ue=class{transform(e,t){if(!e||!t||!t.messageProperties)return;const{loggerFactory:i,coreSettings:o}=t,r=o.get(s.J.Extensibility).enableJITInstallForACv2FromComposeV2||!1,c=i.newLogger("MessageExtensionCardSerializer","services-io-browser-compose-serializer-extensions"),l=(0,a.unescape)(d.N.DomUtils.getAttributeValue(e,$.Qq)),u=d.N.DomUtils.getAttributeValue(e,$.fK);if(!l)return c.error("The props was missing"),null;if(!u)return c.error("The id of the card was missing"),null;try{const i=t.messageProperties.cards||[],{card:s,renderJitInstallConsentFooter:o}=JSON.parse(l);if(!(0,a.isObject)(s))throw new Error("not valid JSON object");(0,a.isString)(s.contentType)&&s.contentType.toLowerCase()===Le.s.Adaptive&&s.content&&((e,t)=>{const i=JSON.parse(e),n=i.body,a=(0,Ae.NI)(i);a&&n&&Me(n,a,t)})(s.content,t);const{__typename:c}=s,m=(0,n.__rest)(s,["__typename"]);m.cardClientId=u,t.messageProperties.cards=[...i,m];const g=d.N.DomUtils.getElements({"data-tid":"jit-install-consent-footer"},e);(r?!!o:!(0,a.isEmpty)(g))&&(t.messageProperties.appIdsToInstall=(0,a.union)(t.messageProperties.appIdsToInstall,[s.appId]));const h=(0,A.ln)("span",{content:u,itemprop:"cardId"}),v=(0,A.ln)("span",{class:"inline-compose-card",itemid:u,itemscope:"",itemtype:p.T.inputExtension});return d.N.DomUtils.appendChild(v,h),v}catch(e){return c.error("Error while adding message extension card to message",e),null}}};Ue=(0,n.__decorate)([(0,r.wx)({name:"MessageExtension",filter:{[$.$S]:"MessageExtensionCard"}})],Ue);var $e=i(878652);let We=class{constructor(){}transform(e,t){const{loggerFactory:i}=t;if(!e)return;const n=(0,a.unescape)(d.N.DomUtils.getAttributeValue(e,$.Qq));if(!n)return;const s=(0,$e.D)(n);if((0,a.isEmpty)(s))return void i.newLogger("QuotedReplySerializer","services-io-browser-compose-serializer-extensions").error("Json parsing failed: ",n);const{from:o,messageId:r,preview:c,timestamp:l,userName:u}=s;if(!(o&&r&&c&&u))return void i.newLogger("QuotedReplySerializer","services-io-browser-compose-serializer-extensions").error("Json parsing failed: ",n);const m=(0,A.ln)("blockquote",{itemscope:"",itemtype:p.T.reply,itemid:r}),g=(0,A.ln)("strong",{itemprop:"mri",itemid:o}),h=(0,A.rw)((0,a.escape)(u));if(d.N.DomUtils.appendChild(g,h),d.N.DomUtils.appendChild(m,g),l){const e=(0,A.ln)("span",{itemprop:"time",itemid:l.toString()});d.N.DomUtils.appendChild(m,e)}const v=(0,A.ln)("p",{itemprop:"preview"}),f=(0,A.rw)((0,a.escape)(c));return d.N.DomUtils.appendChild(v,f),d.N.DomUtils.appendChild(m,v),m}};We=(0,n.__decorate)([(0,r.wx)({name:"QuotedReply",filter:{[$.$S]:"QuotedReplyCard"}}),(0,n.__metadata)("design:paramtypes",[])],We);let Be=class{transform(e){return(0,a.isEmpty)(e.children)&&d.N.DomUtils.appendChild(e,(0,A.rw)("Â ")),e}};Be=(0,n.__decorate)([(0,r.wx)({name:"TableCellSerializer",filter:"td",transient:!0})],Be);let ze=class{transform(e){return e.attribs.class="copy-paste-table",e.attribs.itemprop="copy-paste-table",e}};ze=(0,n.__decorate)([(0,r.wx)({name:"TableSerializer",filter:"table",transient:!0})],ze);var He=i(125098),qe=i(819438);let Ve=class{transform(e,{authenticationUser:t,convId:i}){if(!e||!d.N.DomUtils.hasAttrib(e,u.zj.itemid))return;const n=(0,A.ln)(D.s.span),a=(0,A.rw)((0,A.Q)(e));d.N.DomUtils.appendChild(n,a);const s=d.N.DomUtils.getAttributeValue(e,u.zj.itemid)||"",o=t?(0,He.I6)({userAadObjectId:t.profile.objectId,tenantAadObjectId:t.profile.tenantId}):void 0;return null==o||o.logEvent(qe.z.ManualTagSend,{topicId:s,isTopicNameNumeric:!isNaN(parseFloat(this._getTopicName(e))),contextId:i}),n.attribs[u.zj.itemtype]=p.T.topic,n.attribs[u.zj.itemid]=s,n}_getTopicName(e){const t=(0,A.Q)(e);return t.startsWith("#")?t.substring(1):t}};Ve=(0,n.__decorate)([(0,r.wx)({name:"TopicSerializer",filter:"topic"})],Ve);var Ge=i(132756),Je=i(80033);let Ke=class{transform(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=t.coreSettings.get(s.J.Extensibility).postSendTimeoutInMs||2e3,{areUrlPreviewsAllowed:n}=t.coreSettings.get(s.J.Messaging);if(!!!n||!t.connectedExperienceEnabled||!e||!t.messageProperties||t.messageProperties.urlPreview||!t.urlPreviewService||!t.appBasedLinkService||!d.N.DomUtils.hasAttrib(e,"href"))return;const a=t.loggerFactory.newLogger("UrlPreviewSerializer","services-io-browser-compose-serializer-extensions"),o=e.attribs.href||"",r=[this.getUrlPreviewFromAppTimed(o,i,t,a),this.getUrlPreviewTimed(o,i,t,a)],[c,l]=yield Promise.all(r),u=c||l&&Ye(l);return u?(t.messageProperties.urlPreview=u,e):void 0}))}getUrlPreviewFromAppTimed(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enableAppBasedLink:n}=i.coreSettings.get(s.J.Extensibility),{enableGetRichLinkToTeamOrChannel:r}=i.coreSettings.get(s.J.TeamsAndChannels),{deepLinkDomains:l}=i.coreSettings.get(s.J.Messaging);if(!n)return Promise.resolve(void 0);const d={enableDomainLinks:r,currentDomainLinks:l};if((0,Je.D)(e,d))return;const u=i.scenarioFactory.newScenario(o.RG.ExtGetAppPreviewPostSend),m=i.getInstalledMessageExtensionApps(),g="post send app preview timed out";try{const n=yield(0,c.E)(i.appBasedLinkService.getUrlPreviewFromApp(e,m,i.getAppDefinitions,u,i.convId),t,g);return u.stop(),n}catch(t){return Qe(t)&&t.code===Ge.jK.TimedOut&&t.context===Ge.w5.Timed?u.incomplete({errors:g}):u.fail(),void a.warn(`fetching app preview for url: ${e} failed with error: ${t}`)}}))}getUrlPreviewTimed(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enableGetRichLinkToTeamOrChannel:n}=i.coreSettings.get(s.J.TeamsAndChannels),{deepLinkDomains:o}=i.coreSettings.get(s.J.Messaging),r={enableDomainLinks:n,currentDomainLinks:o};if(!(0,Je.D)(e,r))try{return yield(0,c.E)(i.urlPreviewService.getPreview(e),t,"url preview timed out")}catch(t){return void a.warn(`fetching url preview for url: ${e} failed with error: ${t}`)}}))}};Ke=(0,n.__decorate)([(0,r.HR)({name:"URLPreviewSerializer",filter:"a",transient:!0})],Ke);const Qe=e=>!!(e&&((0,a.get)(e,"code")&&(0,a.get)(e,"context")||(0,a.get)(e,"reason"))),Ye=e=>({url:e.url,title:e.title,description:e.description,previewEnabled:!0,thumbnail:e.thumbnail,thumbnailMeta:e.thumbnail_meta}),Xe=[O],Ze=[W,U,se.D,O,Q,Ve,Be,ze,re,ce.p,H,V,me,le,Ue,We],et=[be,G.O,De,Ke,y,Fe],tt=[L]},542791:(e,t,i)=>{"use strict";i.d(t,{G$:()=>n,Bk:()=>a,MN:()=>s,UF:()=>o,fz:()=>r,E5:()=>c,Aq:()=>l,gB:()=>d,Ar:()=>u,eH:()=>m});const n="embedBroadcastEnded",a="embedCallDataUpdated",s="embedStreamDetailsUpdated",o="toggleLiveCaptions",r="changeSubtitleTrack";var c,l,d,u,m,g;!function(e){e[e.CoreInitializationFailure=4001]="CoreInitializationFailure",e[e.MissingMeetingId=4002]="MissingMeetingId",e[e.MissingStreamingDetails=4003]="MissingStreamingDetails",e[e.InvalidSdnDetails=4004]="InvalidSdnDetails",e[e.MissingThreadId=4005]="MissingThreadId",e[e.OdspVodPlayerFailedToLoad=4006]="OdspVodPlayerFailedToLoad"}(c||(c={})),function(e){e.WaitingForStart="waiting for start",e.DataLoaded="data loaded",e.FirstFrameRendered="first frame rendered",e.PlaybackStarted="playback started",e.PlaybackPaused="playback paused",e.MeetingStillLive="live meeting",e.MeetingEnded="meeting ended",e.UpdatedStreamDetailsReceived="updated stream details received",e.UpdatedCallDataReceived="updated call data received",e.BroadcastEndDataReceived="broadcast ended data received",e.CaptionsToggled="captions toggled",e.SubtitleTrackRequested="subtitle track requested"}(l||(l={})),function(e){e.AMS="Azure Media Service",e.MiddleLaneUltraLowLatency="Middle Lane ULL Network",e.MiddleLaneHttpLiveStreaming="Middle Lane HLS Network"}(d||(d={})),function(e){e.InvalidCallDataReceived="Invalid call data received",e.InvalidStreamDetailsReceived="Invalid streaming details received",e.UninitializedConveneHostMessagingService="Convene host messaging service is uninitialized"}(u||(u={})),function(e){e.ConveneCallDataUpdate="ConveneCallDataUpdate",e.ConveneStreamDetailsUpdate="ConveneStreamDetailsUpdate"}(m||(m={})),function(e){e.BCP="BCP"}(g||(g={}))},990489:(e,t,i)=>{"use strict";i.d(t,{T:()=>a});var n=i(824303);class a{constructor(){this._executeCommandSubject=new n.X(void 0),this.executeCommand=(e,t)=>{this._executeCommandSubject.next({windowId:e,commandId:t})}}get executeCommandObservable(){return this._executeCommandSubject.asObservable()}}},328283:(e,t,i)=>{"use strict";i.d(t,{N:()=>o});var n=i(850402),a=i(50805),s=i(575644);class o{constructor(e,t,i,n){this.logsCollectorService=t,this.coreSettings=i,this.hostCommunicationService=n,this.defaultLogsFilesDownloadDelayIntervalMs=333,this.defaultLogsFileUploadTimer=15e3,this.logger=e.newLogger("LogsFilesService","services-io-browser-logs-files")}downloadLogsFiles(e,t=!0,i){var s,o,r,c;return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.logsCollectorService.setDownloadLogStatus(!0);let l=!0,d=this.defaultLogsFilesDownloadDelayIntervalMs;if(this.coreSettings){const e=this.coreSettings.get(a.J.Diagnostics);l=e.enableLogsFilesDownload||!1,d=e.logsFilesDownloadDelayIntervalMs||this.defaultLogsFilesDownloadDelayIntervalMs}if(!l)return this.logger.error(`Unabled to download logs files - logs files download is not enabled: ${l}`),!1;if(!e)return this.logger.error(`Unabled to download logs files - no host present: ${e}`),!1;const u=this.hostCommunicationService&&i;let m=0;const g=yield this.logsCollectorService.callOnLogsFiles((t=>(0,n.__awaiter)(this,void 0,void 0,(function*(){let a;const s=new Promise((s=>{a=e.setTimeout((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=u?yield this.uploadLogsFileToVirtualServer(t,e,i,!1):yield this.downloadLogsFile(t,e);s(n)}))),m*d)})).then((t=>(void 0!==a&&e.clearTimeout(a),t)));return m++,s}))),t);if(g){if(u){const e=yield null===(r=this.hostCommunicationService)||void 0===r?void 0:r.loadModule("logscollection");null===(c=null==e?void 0:e.webLogsDownloadCompleted)||void 0===c||c.call(e,{webLogsId:i})}}else{if(u)return null===(o=(s=this.logger).errorToTelemetry)||void 0===o||o.call(s,"Failed to upload all logs files to virtual server","logs_downloading"),this.downloadLogsFiles(e,!0);this.logger.error("Failed to download all logs files")}return this.logsCollectorService.setDownloadLogStatus(!1),g}))}downloadLogsFile(e,t){let i,n="";try{let a;a="string"==typeof e.content?new Blob([null==e?void 0:e.content],{type:"text/plain;charset=utf-8"}):e.content,n=URL.createObjectURL(a);const s=t.document.createElement("a");s.setAttribute("href",n),s.setAttribute("download",null==e?void 0:e.fileName),s.click(),s.remove(),i=!0}catch(t){this.logger.error(`Failed to download logs file ${null==e?void 0:e.fileName} - error:`,t),i=!1}return n&&URL.revokeObjectURL&&URL.revokeObjectURL(n),Promise.resolve(i)}uploadLogsFileToVirtualServer(e,t,i,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n=!1;try{const o=`${t.location.origin}/desktop/upload/log-collector/${i}/${e.fileName}`,r=t.fetch(o,{method:"PUT",headers:{"Content-Type":"text/plain"},body:e.content}),c=yield(0,s.E)(r,this.defaultLogsFileUploadTimer);c.ok?n=!0:this.logger.error(`Failed to upload logs file to virtual server - ${null==e?void 0:e.fileName}, isRetry - ${a}, status - ${c.statusText}`)}catch(t){this.logger.error(`Failed to upload logs file to virtual server - ${null==e?void 0:e.fileName}, - isRetry- ${a}, - in ${this.defaultLogsFileUploadTimer} ms, - error:`,t)}return n||a?Promise.resolve(n):this.uploadLogsFileToVirtualServer(e,t,i,!0)}))}}},838440:(e,t,i)=>{"use strict";i.d(t,{XD:()=>o,jW:()=>r,Ko:()=>c,F$:()=>l,OB:()=>d,bF:()=>u});var n=i(850402),a=i(516909),s=i(58826);const o=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{data:t}=yield e.query({query:s.i8});return null==t?void 0:t.activeWindows})),r=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield o(e);return null==t?void 0:t.find((e=>e.isMainWindow&&e.layoutConfig.layoutMode===a.lOW.standard))})),c=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield o(e);return null==t?void 0:t.filter((e=>e.isMainWindow))})),l=e=>{try{const t=e.readQuery({query:s.i8});return null==t?void 0:t.activeWindows}catch(e){return}},d=e=>e.watchQuery({query:s.i8}),u=(e,t)=>{try{return e.writeQuery({query:s.i8,data:{activeWindows:t}}),!0}catch(e){return!1}}},281423:(e,t,i)=>{"use strict";i.d(t,{E:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ServicesIoDataActiveWindowsSaveReactiveVarsToHistoryMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appIds"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"saveReactiveVarsToHistory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"appIds"},value:{kind:"Variable",name:{kind:"Name",value:"appIds"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},58826:(e,t,i)=>{"use strict";i.d(t,{i8:()=>l});const n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowOptions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowOptions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"left"}},{kind:"Field",name:{kind:"Name",value:"top"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]},a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowOptions"}}]}},{kind:"Field",name:{kind:"Name",value:"linkedEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_linkedEntity"}}]}},{kind:"Field",name:{kind:"Name",value:"entityState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"flushableByLinkedEntity"}}]}}]}},...n.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_linkedEntity"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LinkedEntity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}}]}}]}.definitions]},s={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_window"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"clientLaunchId"}}]}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"blockingEntityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"blockedEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"blockedCommand"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visibilityState"}},{kind:"Field",name:{kind:"Name",value:"stateTransition"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"blockedEntityOptions"}}]}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}},{kind:"Field",name:{kind:"Name",value:"isNotificationsWindow"}},{kind:"Field",name:{kind:"Name",value:"isInitialWindowStateHidden"}},{kind:"Field",name:{kind:"Name",value:"userContextId"}},{kind:"Field",name:{kind:"Name",value:"layoutConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"layoutMode"}},{kind:"Field",name:{kind:"Name",value:"isFullscreen"}},{kind:"Field",name:{kind:"Name",value:"slots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"contextualNotifications"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"header"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"end"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"main"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"monitor"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"nav"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"notifications"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"inAppNotifications"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"start"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"subNav"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"titleBar"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"toasts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}}]}}]}}]}},...a.definitions]},o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeEntities"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ActiveEntities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subNavEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"headerEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"startEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"entityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"monitorEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"inAppNotificationsEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}}]}},...a.definitions]},r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowHistoryItem"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeEntities"}}]}},{kind:"Field",name:{kind:"Name",value:"reactiveVars"}}]}},...o.definitions]},c={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"windowHistoryNavigationState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canNavigateBack"}},{kind:"Field",name:{kind:"Name",value:"canNavigateForward"}},{kind:"Field",name:{kind:"Name",value:"backHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationItem"}}]}},{kind:"Field",name:{kind:"Name",value:"forwardHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationItem"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowHistoryNavigationItem"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"windowHistoryIndex"}},{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}}]}},...a.definitions]}.definitions]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataActiveWindowsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeWindows"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeWindows"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowOptions"}}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_window"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeEntities"}}]}},{kind:"Field",name:{kind:"Name",value:"windowHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryItem"}}]}},{kind:"Field",name:{kind:"Name",value:"currentWindowHistoryIndex"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationState"}}]}},...n.definitions,...s.definitions,...o.definitions,...r.definitions,...c.definitions]}.definitions]}},817861:(e,t,i)=>{"use strict";i.d(t,{x:()=>j});var n,a=i(850402),s=i(275742);!function(e){e.Info="Info",e.Warning="Warning",e.Error="Error",e.Debug="Debug"}(n||(n={}));var o=i(419925),r=i(955105),c=i(50805),l=i(516909),d=i(405501);const u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationUserQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"defaultName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"isMailAddress"},value:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}}},{kind:"Argument",name:{kind:"Name",value:"defaultName"},value:{kind:"Variable",name:{kind:"Name",value:"defaultName"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}}]}}]}}]},m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationGetUsersQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriOrEmailArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}}},{kind:"Argument",name:{kind:"Name",value:"isMailAddress"},value:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"emailForQuery"}}]}}]}}]},g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationPresenceSubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PresenceSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presenceUpdateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"lastSeenAt"}}]}}]}}]},h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationPresencesQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userPresenceRequestArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPresenceRequest"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presences"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userPresenceRequestArray"},value:{kind:"Variable",name:{kind:"Name",value:"userPresenceRequestArray"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"lastSeenAt"}}]}}]}}]},p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationFireCallingIntentMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fireCallingIntent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntent"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationUserCallingSettingsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userCallingSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isCallingAllowed"}},{kind:"Field",name:{kind:"Name",value:"isPstnCallingAllowed"}}]}}]}}]},f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationIsPstnQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"officeIntegrationIsPSTN"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}]}]}}]},b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationTenantVerifiedDomainQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tenantVerifiedDomain"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}]}]}}]};var y,k;!function(e){e[e.UnInitialized=0]="UnInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(y||(y={})),function(e){e.FreDialogDisplayedKey="office-integration-fre-dialog-displayed",e.HasManuallyUnregisteredIMProviderKey="office-integration-has-manually-unregistered"}(k||(k={}));const S="sip:",w=new Map([["InACall","OnThePhone"],["InAConferenceCall","InAMeeting"],["InAMeeting","InAMeeting"],["Presenting","Presenting"],["OffWork","Offline"],["Available","Online"],["Inactive","Idle"],["Busy","Busy"],["DoNotDisturb","Focusing"],["BeRightBack","BeRightBack"],["Away","Away"],["Offline","Offline"],["UrgentInterruptionsOnly","Focusing"],["PresenceUnknown","Unknown"],["OutOfOffice","OutOfOffice"]]);class j{static Instance(e,t,i,n,a,s,o,r){return j.instance||(j.instance=new j(e,t,i,n,a,s,o,r)),j.instance}static defaultInstance(){return j.instance}constructor(e,t,i,n,d,u,m,g){this.hostCommunicationService=e,this.coreSettings=t,this.client=i,this.entityCommanding=d,this.windowProvider=u,this.localStorage=m,this.authenticationUser=g,this.initializedState=y.UnInitialized,this.unsubscribers=[],this.entityCommand={stateTransition:o.su.none,visibilityState:o.fe.show,correlation:{source:r.D.OfficeIntegration}},this.presenceSubscriptionMap=new Map,this.uriToMriCacheMap=new Map,this.selfMri="",this.selfActivity=l.cS$.PresenceUnknown,this.debouncedUnresolvedUriMap=new Map,this.unknownUserSet=new Set,this.verifiedDomains=[],this.getUserCallingSettingsAsync=()=>(0,a.__awaiter)(this,void 0,void 0,(function*(){const{data:e}=yield this.client.query({query:v,variables:{}});return e.userCallingSettings})),this.getIsPstnAsync=e=>(0,a.__awaiter)(this,void 0,void 0,(function*(){const{data:t}=yield this.client.query({query:f,variables:{uri:e}});return t.officeIntegrationIsPSTN})),this.logger=n.newLogger("OfficeIntegration","services-io-data-office-integration");const h=this.coreSettings.get(c.J.People).debounceUriToMriProfileQueryInMilliSeconds||1e3;this.batchProfileQuery=(0,s.debounce)((()=>(0,a.__awaiter)(this,void 0,void 0,(function*(){if(!(0,s.isEmpty)(this.debouncedUnresolvedUriMap)){const e=this.debouncedUnresolvedUriMap;this.debouncedUnresolvedUriMap=new Map,yield this.resolveUrisToMrisFromServiceIntoCache(Array.from(e.values()));const t=Array.from(e.keys()),i=this.resolveUrisToMrisFromCache(t),n=t.filter((e=>i.has(e)));(0,s.isEmpty)(n)||this.handleTrackPresence(n)}}))),h)}initialize(){var e,t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(c.J.People).enableOfficeIntegration)return!1;if(this.initializedState!==y.UnInitialized)return!1;this.initializedState=y.Initializing;const i=yield this.getModule();if(i){const{isRegistered:a,isAdminAccessRequired:s,isUacEnabled:o}=(yield null===(e=i.isRegisteredIMProvider)||void 0===e?void 0:e.call(i))||{};if(this.logger.log(`initialize isRegistered ${a} isAdminAccessRequired ${s} isUacEnabled ${o}`),a)return this.startService(i);if(s&&o)this.startOfficeIntegrationFREDialog();else if(s||this.isLocalStoragePropertySet(k.HasManuallyUnregisteredIMProviderKey)){const e=`Failed to register due to isAdminAccessRequired ${s} isUacEnabled \n          ${o} HasManuallyUnregisteredIMProviderKey ${this.isLocalStoragePropertySet(k.HasManuallyUnregisteredIMProviderKey)}`;this.handleLogToTelemetry(e,"office_integration_register_im_provider",n.Warning)}else{const e=yield null===(t=i.registerIMProvider)||void 0===t?void 0:t.call(i,!1,!!o);if(0===e)return this.startService(i);{const t=`Failed to register during silent registration with result ${e}`;this.handleLogToTelemetry(t,"office_integration_register_im_provider",n.Warning,{errorCode:null==e?void 0:e.toString(16)})}}return!1}return!1}))}finalize(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(c.J.People).enableOfficeIntegration)return!1;if(this.initializedState!==y.Initializing)return!1;const t=yield this.getModule();if(t){const{isRegistered:i}=(yield null===(e=t.isRegisteredIMProvider)||void 0===e?void 0:e.call(t))||{};if(i)return this.startService(t);const a="finalize is called without IM provider registered";return this.handleLogToTelemetry(a,"office_integration_fre_register_finalize_failed",n.Warning),!1}return!1}))}shutdown(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(this.initializedState!==y.Initialized)return!1;this.initializedState=y.UnInitialized,this.unsubscribers.forEach((e=>e()));const t=yield this.getModule();if(t){return!!(null===(e=t.stopComServer)||void 0===e?void 0:e.call(t))}return!1}))}isRegisteredIMProvider(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getModule();return null===(e=null==t?void 0:t.isRegisteredIMProvider)||void 0===e?void 0:e.call(t)}))}registerIMProvider(e,t,i){var s;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const a=yield this.getModule();if(a){const o=yield null===(s=a.registerIMProvider)||void 0===s?void 0:s.call(a,e,t),r=`registerIMProvider result ${o} from ${i}. isAdminAccessRequired ${e} isUacEnabled ${t}`;return this.handleLogToTelemetry(r,"office_integration_register_im_provider",n.Info,{errorCode:null==o?void 0:o.toString(16)}),0===o}return!1}))}unregisterIMProvider(e){var t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.getModule();if(i){const a=yield null===(t=i.unregisterIMProvider)||void 0===t?void 0:t.call(i),s=`unregisterIMProvider result ${a} from ${e}`;return this.handleLogToTelemetry(s,"office_integration_unregister_im_provider",n.Info,{errorCode:null==a?void 0:a.toString(16)}),0===a}return!1}))}toggleIMProvider(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{isRegistered:t,isAdminAccessRequired:i,isUacEnabled:n}=(yield this.isRegisteredIMProvider())||{};if(t){this.setLocalStorageProperty(k.HasManuallyUnregisteredIMProviderKey,"true");const t=yield this.unregisterIMProvider(e);return yield this.waitForRegistryUpdate(),t}this.setLocalStorageProperty(k.HasManuallyUnregisteredIMProviderKey,"false");if(yield this.registerIMProvider(!!i,!!n,e)){const e=yield this.getModule();return!!e&&(this.startService(e),yield this.waitForRegistryUpdate(),!0)}return!1}))}waitForRegistryUpdate(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){let e;yield new Promise((t=>{e=this.windowProvider.setTimeout(t,250)})),this.windowProvider.clearTimeout(e)}))}isLocalStoragePropertySet(e){var t;return"true"===(null===(t=this.localStorage)||void 0===t?void 0:t.get(e))}setLocalStorageProperty(e,t){var i;null===(i=this.localStorage)||void 0===i||i.set(e,t)}getModule(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return this.officeIntegrationModule||(this.officeIntegrationModule=yield this.hostCommunicationService.loadModule("officeintegration")),this.officeIntegrationModule}))}startService(e){var t,i,n,s,o,r,c,l,d,m;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(this.initializedState===y.Initialized)return!1;let a;this.initializedState=y.Initialized,a=null===(t=e.registerForStartChat)||void 0===t?void 0:t.call(e,(e=>this.handleStartChat(e))),a&&this.unsubscribers.push(a),a=null===(i=e.registerForStartCall)||void 0===i?void 0:i.call(e,((e,t,i)=>this.handleStartCall(e,t,i))),a&&this.unsubscribers.push(a),a=null===(n=e.registerForTrackPresence)||void 0===n?void 0:n.call(e,(e=>this.handleTrackPresence(e))),a&&this.unsubscribers.push(a),a=null===(s=e.registerForUntrackPresence)||void 0===s?void 0:s.call(e,(e=>this.handleUntrackPresence(e))),a&&this.unsubscribers.push(a),a=null===(o=e.registerForLogStatement)||void 0===o?void 0:o.call(e,((e,t)=>this.handleLogStatement(e,t))),a&&this.unsubscribers.push(a);const g=(null===(r=this.authenticationUser)||void 0===r?void 0:r.loginUserName)||"",{data:h}=yield this.client.query({query:u,variables:{userId:g,isMailAddress:!0},context:{callerInfo:"office-integration-start"}}),p=null==h?void 0:h.user;if(p){const e=null===(c=p.userPrincipalName)||void 0===c?void 0:c.toLowerCase(),t=null===(l=p.email)||void 0===l?void 0:l.toLowerCase();p.mri&&(this.selfMri=p.mri,e&&this.uriToMriCacheMap.set(e,p.mri),t&&t!==e&&this.uriToMriCacheMap.set(t,p.mri))}const v=yield this.client.query({query:b,variables:{userId:g}});(null===(d=v.data)||void 0===d?void 0:d.tenantVerifiedDomain)&&(this.verifiedDomains=v.data.tenantVerifiedDomain);return!!(yield null===(m=e.startComServer)||void 0===m?void 0:m.call(e,(null==p?void 0:p.userPrincipalName)||g))}))}startOfficeIntegrationFREDialog(){if(this.isLocalStoragePropertySet(k.FreDialogDisplayedKey))this.logger.log("Skipping FRE as it has already been displayed for user");else{this.entityCommanding.shell.openFreDialog(this.entityCommand),this.setLocalStorageProperty(k.FreDialogDisplayedKey,"true");const e="Start office integration FRE through user dialog registration";this.handleLogToTelemetry(e,"office_integration_fre_register_dialog",n.Info)}}notifyPresence(e){var t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.getModule();return null===(t=null==i?void 0:i.notifyPresence)||void 0===t?void 0:t.call(i,e)}))}convertLastSeenAt(e){if(e){return new Date(e).getTime()}}notifyInitialPresence(e,t){const i=[];e.presences.forEach((e=>{const n=l.cS$[e.activity||l.cS$.PresenceUnknown];e.id===this.selfMri&&e.activity&&(this.selfActivity=e.activity),i.push({id:e.id,requestedUri:t.get(e.id)||"",status:w.get(n)||n,lastSeenAt:this.convertLastSeenAt(e.lastSeenAt)})})),this.notifyPresence(i)}handleTrackPresence(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{enableFederatedPresenceForOfficeIntegration:t}=this.coreSettings.get(c.J.People);t||(0,s.isEmpty)(this.verifiedDomains)||(e=e.filter((e=>{const t=e.substring(e.indexOf("@")+1);return(0,s.some)(this.verifiedDomains,(e=>e===t.toLocaleLowerCase()))})));const i=yield this.mapUrisToMris(e,!0),n=[],a=new Map;if(e.forEach((e=>{const t=i.get(e);if(t){const i=this.presenceSubscriptionMap.get(t);if(i)(!i.requestedUris.has(e)||t===this.selfMri&&l.cS$.PresenceUnknown===this.selfActivity)&&(i.requestedUris.add(e),n.push({userId:t,source:l.W8Z.ups}),a.set(t,e));else{const i=this.client.subscribe({query:g,variables:{userId:t,source:l.W8Z.ups}}).subscribe((({data:e})=>{e&&this.notifyUpdatedPresence(e)})),s={requestedUris:new Set,presenceSubscription:i};s.requestedUris.add(e),this.presenceSubscriptionMap.set(t,s),n.push({userId:t,source:l.W8Z.ups}),a.set(t,e)}}})),!(0,s.isEmpty)(n)){const{data:e}=yield this.client.query({query:h,variables:{userPresenceRequestArray:n}});e&&this.notifyInitialPresence(e,a)}}))}mapUrisToMris(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const i=this.resolveUrisToMrisFromCache(e);if(i.size===e.length)return i;{const{enableDebounceUriToMriProfileQuery:n}=this.coreSettings.get(c.J.People),a=t&&n,o=[];return e.forEach((e=>{if(!i.has(e)){const t=e.startsWith(S)?e.substring(4):e;o.push(t),a&&this.debouncedUnresolvedUriMap.set(e,t)}})),(0,s.isEmpty)(o)?i:a?(this.batchProfileQuery(),i):(yield this.resolveUrisToMrisFromServiceIntoCache(o),this.resolveUrisToMrisFromCache(e))}}))}resolveUrisToMrisFromServiceIntoCache(e){var t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(e=e.filter((e=>!this.unknownUserSet.has(e.toLowerCase()))),(0,s.isEmpty)(e))return;const{data:i}=yield this.client.query({query:m,variables:{mriOrEmailArray:e,isMailAddress:!0},context:{callerInfo:"office-integration-uri-resolution"}});null===(t=null==i?void 0:i.getUsers)||void 0===t||t.forEach((e=>{var t,i,n;if(e.mri&&"unknown_email_address@invalid.teams.ms"!==e.email){const a=null===(t=e.userPrincipalName)||void 0===t?void 0:t.toLowerCase(),s=null===(i=e.email)||void 0===i?void 0:i.toLowerCase(),o=null===(n=e.emailForQuery)||void 0===n?void 0:n.toLowerCase();a&&this.uriToMriCacheMap.set(a,e.mri),s&&s!==a&&this.uriToMriCacheMap.set(s,e.mri),o&&o!==a&&o!==s&&this.uriToMriCacheMap.set(o,e.mri)}else e.userPrincipalName&&this.unknownUserSet.add(e.userPrincipalName.toLowerCase())}))}))}resolveUrisToMrisFromCache(e){const t=new Map;return e.forEach((e=>{const i=e.toLowerCase(),n=i.startsWith(S)?i.substring(4):i,a=this.uriToMriCacheMap.get(n);a&&t.set(e,a)})),t}notifyUpdatedPresence(e){const t=e.presenceUpdateEvent;if(t){const e=t.id,i=this.presenceSubscriptionMap.get(e);if(i){const n=[],a=l.cS$[t.activity||l.cS$.PresenceUnknown],s=w.get(a)||a,o=this.convertLastSeenAt(t.lastSeenAt);i.requestedUris.forEach((t=>{n.push({id:e,requestedUri:t,status:s,lastSeenAt:o})})),e===this.selfMri&&t.activity&&(this.selfActivity=t.activity),this.notifyPresence(n)}}}handleUntrackPresence(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){(yield this.mapUrisToMris(e)).forEach(((e,t)=>{const i=this.presenceSubscriptionMap.get(e);i&&(i.requestedUris.delete(t),(0,s.isEmpty)(i.requestedUris)&&(i.presenceSubscription.unsubscribe(),this.presenceSubscriptionMap.delete(e)))}))}))}handleStartChat(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("Starting chat");const t=e.split(";").filter((e=>!!e.trim())),i=yield this.mapUrisToMris(t),a=`mapped ${i.size} uris`;this.handleLogToTelemetry(a,"office_integration_handle_chat",n.Info);const o=Array.from(i.values());(0,s.isEmpty)(o)?this.handleLogToTelemetry("No mapped uris to start chat","office_integration_handle_chat",n.Warning):this.navigateToChat(o)}))}navigateToChat(e,t=o.su.new){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return this.entityCommanding.chat.chatWithUsers({userIds:e,entityCommand:{stateTransition:t,visibilityState:o.fe.show,correlation:{source:r.D.OfficeIntegrationChat}},entityOptions:{shouldCheckChatPolicy:!0}})}))}handleStartCall(e,t,i){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{enableOfficeIntegrationCalling:i}=this.coreSettings.get(c.J.Calling);try{const[a,s]=yield Promise.all([this.getUserCallingSettingsAsync(),this.getIsPstnAsync(e)]);if(!i||s&&!(null==a?void 0:a.isPstnCallingAllowed)||!s&&!(null==a?void 0:a.isCallingAllowed))return void this.handleLogToTelemetry("Office integration calling or policy is disabled","office_integration_handle_call",n.Warning,{context:JSON.stringify({enableOfficeIntegrationCalling:i,isPSTN:s,isVideo:t,isCallingAllowed:null==a?void 0:a.isCallingAllowed,isPstnCallingAllowed:null==a?void 0:a.isPstnCallingAllowed})});this.handleLogToTelemetry("Starting call","office_integration_handle_call",n.Info,{context:JSON.stringify({enableOfficeIntegrationCalling:i,uri:e,isPSTN:s,isVideo:t})});const o=s?this.getPstnCallingIntent(e):yield this.getVoipCallingIntentAndNavigateChat(e,t);yield this.client.mutate({mutation:p,variables:{callingIntent:o}}),this.handleLogToTelemetry("Successfully triggered call","office_integration_handle_call",n.Info,{context:JSON.stringify({enableOfficeIntegrationCalling:i,uri:e,isVideo:t})})}catch(a){this.handleLogToTelemetry("Failed to start call","office_integration_handle_call",n.Error,{context:JSON.stringify({enableOfficeIntegrationCalling:i,uri:e,isVideo:t}),errors:(null==a?void 0:a.message)||a})}}))}getPstnCallingIntent(e){return{type:l.GXC.OneToOneCall,joinOptions:{},coordinates:{oneToOne:{mri:(0,d.DI)(e)}}}}getVoipCallingIntentAndNavigateChat(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const i=(yield this.mapUrisToMris([e])).get(e);if(!i)throw new Error("No mapped uri to start call");return yield this.navigateToChat([i],o.su.flush),{type:l.GXC.OneToOneCall,coordinates:{oneToOne:{mri:i}},joinOptions:{outgoingVideo:t}}}))}handleLogStatement(e,t){switch(t){case n.Info:this.logger.log(e);break;case n.Debug:this.logger.debug(e);break;case n.Error:this.logger.error(e);break;case n.Warning:this.logger.warn(e)}}handleLogToTelemetry(e,t,i,a,s=!0){switch(i){case n.Info:this.logger.infoToTelemetry?this.logger.infoToTelemetry(e,t,a,s):this.logger.log(e);break;case n.Debug:this.logger.debugToTelemetry?this.logger.debugToTelemetry(e,t,a,s):this.logger.debug(e);break;case n.Error:this.logger.errorToTelemetry?this.logger.errorToTelemetry(e,t,a,s):this.logger.error(e);break;case n.Warning:this.logger.warnToTelemetry?this.logger.warnToTelemetry(e,t,a,s):this.logger.warn(e)}}}},781015:(e,t,i)=>{"use strict";var n,a,s;i.d(t,{NE:()=>n,iP:()=>a,x4:()=>r,HX:()=>c,yF:()=>u}),function(e){e.Any="any",e.Never="never",e.Chat="chat",e.Reply="reply",e.ReplyToReply="replyToReply",e.Like="like",e.Mention="mention",e.TeamMembershipChange="teamMembershipChange",e.AddedToTeam="addedToTeam",e.PromotedToTeamAdmin="promotedToTeamAdmin",e.Download="download",e.Follow="follow",e.CallOrMeetup="callOrMeetup",e.ThirdParty="thirdParty",e.Unread="unread",e.Inferred="inferred",e.MessageSendFailed="messageSendFailed",e.LikeInChat="likeInChat",e.MentionInChat="mentionInChat",e.MentionInCommunity="mentionInCommunity",e.ReactionInCommunity="reactionInCommunity",e.CallTransferFailed="callTransferFailed",e.Call="call",e.MissedCall="missedCall",e.Voicemail="voicemail",e.GroupRenewal="groupRenewal",e.Error="error",e.DesktopNotification="desktopNotification",e.Trending="trending",e.ShareFromChat="shareFromChat",e.PresenceStatus="presenceStatus",e.Priority="priority",e.Reaction="reaction",e.ReactionInChat="reactionInChat",e.TeamsTasks="teamsTasks",e.TeamsEngagementActivity="teamsEngagementActivity",e.DLP="dLP",e.MsGraph="msGraph",e.StaffHub="StaffHub",e.SkypeConsumerCall="SkypeConsumerCall",e.SyntheticNotification="syntheticNotification",e.UserActivity="UserActivity",e.NativeNotificationFre="NativeNotificationFre",e.Recommendation="Recommendation",e.JoinInvite="joinInvite",e.CommunityReply="communityReply",e.CommunityReplyToReply="communityReplyToReply",e.CommunityMention="communityMention",e.CommunityMembership="communityMembership",e.Calendar="calendar",e.ReactionInSubCommunity="reactionInSubCommunity",e.MentionInSubCommunity="mentionInSubCommunity"}(n||(n={})),function(e){e.Everyone="everyone",e.Team="team",e.Person="person",e.AddedToTeam="addedToTeam",e.PromotedToTeamAdmin="promotedToTeamAdmin",e.DownloadStarted="downloadStarted",e.Downloaded="downloaded",e.DownloadFailed="downloadFailed",e.ChannelReplyMessage="channelReplyMessage",e.ChannelNewMessage="channelNewMessage",e.Call="call",e.Meetup="meetup",e.Bot="bot",e.Channel="channel",e.Campaign="campaign",e.MissedCall="missedCall",e.Voicemail="voicemail",e.ThirtyDayNotification="thirtyDayNotification",e.RifteenDayNotification="rifteenDayNotification",e.RenewedNotification="renewedNotification",e.OneOnOneChat="oneOnOneChat",e.GroupChat="groupChat",e.ShareFromChat="shareFromChat",e.Like="like",e.Angry="angry",e.Sad="sad",e.Laugh="laugh",e.Heart="heart",e.Surprised="surprised",e.NotifySender="notifySender",e.PendingSelfJoinRequest="pendingSelfJoinRequest",e.PendingOnBehalfOfJoinRequest="pendingOnBehalfOfJoinRequest",e.NativeNotificationFre="nativeNotificationFre",e.PendingOnBehalfOfJoinRequestMultiple="pendingOnBehalfOfJoinRequestMultiple",e.TaskAssignedToYou="taskAssignedToYou",e.UrgentTaskAssignedToYou="urgentTaskAssignedToYou",e.YourTaskWasUpdated="yourTaskWasUpdated",e.YourTaskChangedToNotStarted="yourTaskChangedToNotStarted",e.YourTaskChangedToInProgress="yourTaskChangedToInProgress",e.YourTaskChangedToCompleted="yourTaskChangedToCompleted",e.YourTaskChangedToBlocked="yourTaskChangedToBlocked",e.YourTaskChangedToRemoved="yourTaskChangedToRemoved",e.YourTaskChangedToNotApplicable="yourTaskChangedToNotApplicable",e.YourTaskWasReassigned="yourTaskWasReassigned",e.YourTaskWasDeleted="yourTaskWasDeleted",e.TaskListPublishedToYourTeam="taskListPublishedToYourTeam",e.TaskListRecalledFromYourTeam="taskListRecalledFromYourTeam",e.YourTaskWasMarkedUrgent="yourTaskWasMarkedUrgent",e.YourTaskWasMarkedNotUrgent="yourTaskWasMarkedNotUrgent",e.UrgentTaskPublishedToYourTeam="urgentTaskPublishedToYourTeam",e.SmsChat="smsChat",e.NewShift="newShift",e.SchedulePublished="schedulePublished",e.NewShiftRequest="newShiftRequest",e.ShiftRequestUpdated="shiftRequestUpdated",e.ShiftUpdated="shiftUpdated",e.MissedMeetingNudge="missedMeetingNudge",e.Tag="tag",e.InviteeJoined="inviteeJoined",e.AddedToSharedChannel="addedToSharedChannel",e.TeamShareTeamOwnerNotify="teamShareTeamOwnerNotify",e.PromotedToSharedChannelOwner="promotedToSharedChannelOwner",e.ChannelOwnerUnshareTeamOwnerNotify="channelOwnerUnshareTeamOwnerNotify",e.TeamOwnerUnshareChannelOwnerNotify="teamOwnerUnshareChannelOwnerNotify",e.HostOwnerUnshareChannelOwnerNotify="hostOwnerUnshareChannelOwnerNotify",e.HostOwnerUnshareTeamOwnerNotify="hostOwnerUnshareTeamOwnerNotify",e.Community="community",e.CommunityJoinInviteCreated="communityJoinInviteCreated",e.CommunityJoinInviteAccepted="communityJoinInviteAccepted",e.CommunityMembershipJoinRequestAccepted="communityMembershipJoinRequestAccepted",e.CommunityMembershipJoinRequestCreated="communityMembershipJoinRequestCreated",e.CommunityMembershipPromotedToAdmin="communityMembershipPromotedToAdmin",e.NewCalendarEvent="newCalendarEvent",e.CalendarEventCanceled="calendarEventCanceled",e.CalendarEventUpdated="calendarEventUpdated",e.InviteeJoinedOne2One="inviteeJoinedOne2One",e.InviteeJoinedGroupChat="inviteeJoinedGroupChat",e.InviteeJoinedCommunity="inviteeJoinedCommunity"}(a||(a={})),function(e){e.Call="call",e.Chat="chat"}(s||(s={}));n.Reaction,n.TeamMembershipChange,n.Mention,n.Follow,n.Reply,n.ReplyToReply,n.MentionInChat,n.ReactionInChat,n.Priority;var o,r,c,l,d,u;!function(e){e.MobileOnly="mobile",e.DesktopWebOnly="desktopWeb",e.All="all"}(o||(o={})),function(e){e.taco="2a84919f-59d8-4441-a975-2a8c2643b741",e.calendar="ef56c0de-36fc-4ef8-b417-3d82ba9d073c"}(r||(r={})),function(e){e.toggleActivityRead="toggleActivityRead",e.deleteActivityFeedItem="deleteActivityFeedItem",e.removeActivityFeedItem="removeActivityFeedItem",e.channelNotificationSettings="channelNotificationSettings",e.missedCallFeedCallBackAction="missedCallFeedCallBackAction",e.missedCallFeedChatAction="missedCallFeedChatAction",e.notificationSettings="notificationSettings",e.turnOffLikesAndReactions="turnOffLikesAndReactions",e.muteApp="muteApp",e.turnOffChannel="turnOffChannel",e.turnOffAllTeamAndChannelMentions="turnOffAllTeamAndChannelMentions",e.turnOffRepliesFromChannel="turnOffRepliesFromChannel",e.turnOffPostsFromChannel="turnOffPostsFromChannel"}(c||(c={})),function(e){e.notificationSettings="notificationSettings",e.markAllAsRead="markAllAsRead"}(l||(l={})),function(e){e.mentionIcon="iconsMention",e.likeIcon="iconsReactionsLike",e.sadIcon="iconsReactionsSad",e.wowIcon="iconsReactionsWow",e.angryIcon="iconsReactionsAngry",e.heartIcon="iconsReactionsHeart",e.laughIcon="iconsReactionsLaugh",e.missedCallIcon="missedCallIcon",e.voicemailIcon="voicemailIcon",e.urgentIcon="iconsUrgent",e.defaultIcon="iconDefault",e.addedToTeamIcon="addedToTeamIcon",e.promotedToAdminIcon="promotedToAdminIcon",e.communityMentionIcon="communityMentionIcon",e.channelMentionIcon="channelMentionIcon",e.teamMentionIcon="teamMentionIcon",e.followChannelIcon="followChannelIcon",e.replyIcon="replyIcon",e.customIcon="customIcon",e.channelShareIcon="channelShareIcon",e.channelDismissIcon="channelDismissIcon",e.everyoneMentionIcon="everyoneMentionIcon",e.calendar="calendar",e.appIcon="iconsApp"}(d||(d={})),function(e){e.hasText="hasText",e.sentAFile="sentAFile",e.sentAnImage="sentAnImage",e.sentACard="sentACard",e.previewUnavailable="previewUnavailable",e.DLPMessagePreview="dlpMessagePreview"}(u||(u={}));var m,g;!function(e){e.unread="unread",e.mention="mention",e.reactions="reactions",e.missedcall="missedcall",e.reply="reply",e.apps="apps",e.voicemail="voicemail"}(m||(m={})),function(e){e.navWithoutEarlyFetch="navWithoutEarlyFetch",e.navOnEarlyFetch="navOnEarlyFetch",e.navOnDifferentMainEntity="navOnDifferentMainEntity",e.noNavOnSameMainEntity="noNavOnSameMainEntity"}(g||(g={}))},653266:(e,t,i)=>{"use strict";var n,a,s,o,r;i.d(t,{Nt:()=>n,mL:()=>a}),function(e){e.DEFAULT="DEFAULT",e.CHANNEL="CHANNEL",e.COMMUNITIES="COMMUNITIES"}(n||(n={})),function(e){e.chat="chatCampaign",e.meeting="meetingCampaign",e.files="filesCampaign",e.contactSyncConfirmation="contactSyncConfirmation"}(a||(a={})),function(e){e.channel="channel",e.chat="chat",e.communities="communities",e.communitiesJoinInviteView="communitiesJoinInviteView",e.communitiesJoinRequestsView="communitiesJoinRequestsView",e.communitiesMembersView="communitiesMembersView",e.communitiesCalendarEvent="communitiesCalendarEvent",e.syntheticNotificationCampaign="syntheticNotificationCampaign",e.joinInviteActivity="joinInviteActivity",e.teamPendingJoinRequest="teamPendingJoinRequest",e.manageTeamChannels="manageTeamChannels",e.manageChannelMembers="manageChannelMembers",e.msGraph="msGraph",e.calls="calls",e.communitiesL1View="communitiesL1View",e.onboardedToTeam="onboardedToTeam"}(s||(s={})),function(e){e.teamAvatar="teamAvatar",e.staticImage="staticImage",e.imageUrl="imageUrl",e.default="default"}(o||(o={})),function(e){e.DLP="DLP"}(r||(r={}))},80033:(e,t,i)=>{"use strict";i.d(t,{D:()=>b,W:()=>y});var n=i(850402),a=i(275742),s=i(915929),o=i(50805),r=i(738646),c=i(516909),l=i(199033),d=i(760005),u=i(905581),m=i(132756),g=i(834347),h=i(181620),p=i(34564),v=i(55417);const f=["teams","/l/message/","chat"],b=(e,t)=>{if(null==t?void 0:t.enableDomainLinks){const i=new URL(e),n=t.currentDomainLinks;return!!n&&n.some((e=>{const t=new URL(e);return i.hostname===t.hostname}))}return f.every((t=>e.includes(t)))};class y{constructor(e,t,i,n){this.botsPlatformService=t,this.scenarioFactory=i,this.queryLinkRequestsInProgress={},this.appRedirection=e.get(o.J.Extensibility).appBasedLinkAppRedirection,this.enableAppBasedLinkSsoAuth=e.get(o.J.Extensibility).enableAppBasedLinkSsoAuth,this.tokenPrefetchBots=e.get(o.J.Extensibility).tokenPrefetchBots,this.ssoForBotsDefaultWebResourceEnabledBotIds=e.get(o.J.Extensibility).ssoForBotsDefaultWebResourceEnabledBotIds,this.enableAnonymousAppBasedLink=e.get(o.J.Extensibility).enableAnonymousAppBasedLink,this.anonymousAppBasedLinkApps=e.get(o.J.Extensibility).anonymousAppBasedLinkApps,this.anonymousAppBasedLinkAppRedirection=e.get(o.J.Extensibility).anonymousAppBasedLinkAppRedirection,this.enablePreAuthCard=e.get(o.J.Extensibility).enablePreAuthCard,this.logger=n.newLogger("AppBasedLinkService","services-io-app-based-link"),this.enableGetRichLinkToTeamOrChannel=e.get(o.J.TeamsAndChannels).enableGetRichLinkToTeamOrChannel,this.deepLinkDomains=e.get(o.J.Messaging).deepLinkDomains}getUrlPreviewFromApp(e,t,i,s,o){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n="",r=!1;const l={enableDomainLinks:this.enableGetRichLinkToTeamOrChannel,currentDomainLinks:this.deepLinkDomains};if(v.o===o||b(e,l))return void this.logger.debug(`LinkUnfurling: getUrlPreviewFromApp: url is a chat url and no link preview is needed for url: ${e}`);let d=t&&(0,g.A4)(e,t,this.appRedirection);if(!d&&this.enableAnonymousAppBasedLink){const t=i()||[];(0,a.isEmpty)(t)&&(n="no app defs");const s=(0,g.A4)(e,t.map((e=>({installationState:c.JMQ.NotInstalled,installedScope:c.qi6.Personal,id:e.id,definition:e}))),this.appRedirection);(null==s?void 0:s.definition)&&(0,g.C4)((0,g.dX)(s.definition),this.enableAnonymousAppBasedLink,this.anonymousAppBasedLinkApps)&&(d=s,r=!0)}const u=(null==d?void 0:d.definition)&&(0,g.dX)(d.definition);if(!u)return(0,a.isEmpty)(t)&&!n&&(n="no installed apps"),void s.incomplete({errors:n});let m;if(r?(m=yield this.getAnonymousAppPreview(e,u,o),this.logger.debug(`LinkUnfurling: Fetching anonymous app preview for url: ${e}`)):(m=yield this.getAppPreview(e,u,o),this.logger.debug(`LinkUnfurling: Fetching app preview for url: ${e}`)),(null==m?void 0:m.type)!==c.LYR.HasResult||!m.messageExtensionItem)return void this.logger.debug(`LinkUnfurling: No app preview found for url: ${e}`);const{previewCard:h}=m.messageExtensionItem;return h?(0,p.j)(e,h):void 0}))}getAnonymousAppPreview(e,t,i){var a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const n=!!(null===(a=this.anonymousAppBasedLinkAppRedirection)||void 0===a?void 0:a.find((e=>e===t.id))),s=this.getQueryLinkVariables(e,t,i);if(!s)throw(0,u.Tr)("AppBasedLinkService",m.jK.InvalidInput,"getAnonymousAppPreview",void 0,this.getErrorMessage("Invalid message extension passed to invoke",t));this.queryLinkRequestsInProgress[e]||(this.queryLinkRequestsInProgress[e]=this.queryLink(s,t.id,r.RG.ExtGetAnonymousAppPreview,void 0,n?"composeExtension/queryLink":"composeExtension/anonymousQueryLink"));const o=yield this.queryLinkRequestsInProgress[e];return delete this.queryLinkRequestsInProgress[e],!o||this.isEmptyResult(o)?null:this.matchedAnonymousResult(e,t,o)}catch(t){throw delete this.queryLinkRequestsInProgress[e],t}}))}getAppPreview(e,t,i,a,s){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield this.tryPrefetchingToken(t,s,this.logger),o={},r=null!=s?s:n,c=!!r,l=yield this.getMessageExtensionResult(e,t,i,a,r,o);return delete this.queryLinkRequestsInProgress[e],!l||this.isEmptyResult(l)?null:this.matchedResult(e,t,l,c,i,a,o)}catch(t){throw delete this.queryLinkRequestsInProgress[e],t}}))}matchedAnonymousResult(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){switch(i.type){case c.CO3.result:return this.logger.debug(`LinkUnfurling: Initiating result type response for url: ${e}`),this.handleResultResponse(e,i,t);case c.CO3.auth:return this.logger.debug(`LinkUnfurling: Initiating anonymous auth for url: ${e}`),this.handleAnonymousAuthConfigResponse(e,i,t);default:return this.logger.error(this.getErrorMessage(`LinkUnfurling: Invalid value ${i.type} for field 'type' in invoke response`,t)),null}}))}matchedResult(e,t,i,a,s,o,r){return(0,n.__awaiter)(this,void 0,void 0,(function*(){switch(i.type){case c.CO3.result:return this.logger.debug(`LinkUnfurling: Initiating result type response for url: ${e}`),this.handleResultResponse(e,i,t);case c.CO3.auth:case c.CO3.config:return i.type===c.CO3.config?this.logger.debug(`LinkUnfurling: Initiating config type response for url: ${e}`):this.logger.debug(`LinkUnfurling: Initiating auth type response for url: ${e}`),this.handleAuthConfigResponse(e,i,t);case c.CO3.silentAuth:if(a)return this.logger.error(this.getErrorMessage(`LinkUnfurling: Result type ${i.type} not allowed for duplicate request`,t)),null;if(this.enableAppBasedLinkSsoAuth){if(null==r?void 0:r.consentOverride)return this.handleSsoAuthResponse({isFailure:!1,isConsentRequired:!0,token:void 0},i,e,t,s,o);const n=yield this.tryGetAuthToken(t);return this.handleSsoAuthResponse(n,i,e,t,s,o)}default:return this.logger.error(this.getErrorMessage(`Invalid value ${i.type} for field 'type' in invoke response`,t)),null}}))}isEmptyResult(e){const t=Object.keys(e);return 1===t.length&&"__typename"===t[0]}handleSsoAuthResponse(e,t,i,a,s,o){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{isFailure:n,isConsentRequired:r,token:c}=e;if(n)return null;if(c&&!r){return yield this.getAppPreview(i,a,s,o,{token:c})}return this.handleAuthConfigResponse(i,t,a)}))}getWebApplicationInfo(e){var t;const i=e.messageExtensions&&e.messageExtensions[0].botId;return i&&this.ssoForBotsDefaultWebResourceEnabledBotIds&&(null===(t=this.ssoForBotsDefaultWebResourceEnabledBotIds)||void 0===t?void 0:t.indexOf(i))>=0?{botId:i,resource:`api://botid-${i}`}:{botId:i,resource:e.resource}}tryPrefetchingToken(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{botId:n,resource:a}=this.getWebApplicationInfo(e);if(t||!this.enableAppBasedLinkSsoAuth||!n||!a||!this.tokenPrefetchBots||-1===this.tokenPrefetchBots.indexOf(n))return null;const s=this.scenarioFactory.newScenario(r.RG.AppBasedLinkAadAuth);s.appendEventData({"Bot.Id":n,context:"tokenPrefetch"});try{const e=yield this.botsPlatformService.getAuthTokenForBot(n,a,!0,i);return s.stop(),{token:e}}catch(e){s.incomplete({errors:"tryPrefetchingToken: Token failed to acquire"})}return null}))}tryGetAuthToken(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{botId:t,resource:i}=this.getWebApplicationInfo(e);if(!t||!i)return{isFailure:!0,isConsentRequired:!1,token:void 0};const n=this.scenarioFactory.newScenario(r.RG.AppBasedLinkAadAuth);n.appendEventData({"Bot.Id":t,context:"silent:true"});try{const e=yield this.botsPlatformService.getAuthTokenForBot(t,i,!0,this.logger);return n.stop(),{isFailure:!1,isConsentRequired:!1,token:e}}catch(e){return e.code===m.jK.UserConsentRequired?(n.incomplete(),{isFailure:!1,isConsentRequired:!0,token:void 0}):e.code===m.jK.InvalidInput?(n.stop(),{isFailure:!0,isConsentRequired:!1,token:void 0}):(n.fail({errorCode:e.code}),{isFailure:!0,isConsentRequired:!1,token:void 0})}}))}getMessageExtensionResult(e,t,i,a,s,o){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=(0,g.q_)(this.appRedirection,t.id);if(n)return this.handleAppRedirection(e,t,n,i,a);{const n=this.getQueryLinkVariables(e,t,i,a,s);return n?(this.queryLinkRequestsInProgress[e]||(this.queryLinkRequestsInProgress[e]=this.queryLink(n,t.id,r.RG.GetAppPreviewResult,o)),this.queryLinkRequestsInProgress[e]):(this.logger.error(this.getErrorMessage("Invalid message extension passed to invoke",t)),Promise.resolve(null))}}))}queryLink(e,t,i,n,a){const o=(0,s.v4)(),r=this.scenarioFactory.newScenario(i);return r.appendEventData({"Bot.Id":e.botInvokeParams.botMri,"App.Id":t,"Thread.Id":e.botInvokeParams.threadId,correlationId:o}),this.botsPlatformService.executeBotInvoke(e.botInvokeParams,e.invokeValue,l.CB,this.logger,o,a||"composeExtension/queryLink",void 0,void 0,r).then((e=>(r.stop(),e))).catch((t=>{if(this.logger.warn(`Invoke failed with error: ${t} and args: ${JSON.stringify(e)}`),this.handleInvokeFailure(r,t,n),null==n?void 0:n.consentOverride)return{type:c.CO3.silentAuth};throw t}))}handleInvokeFailure(e,t,i){if(t)if((e=>!!e&&!!(0,a.get)(e,"code")&&!!(0,a.get)(e,"message"))(t))switch(t.code){case m.jK.BotError:case m.jK.BotDisabledByAdmin:e.stop({errorCode:t.code,errors:JSON.stringify([t.message])});break;case m.jK.UserConsentRequired:e.incomplete({errorCode:t.code,errors:JSON.stringify([t.message])}),i&&(i.consentOverride=!0);break;default:e.fail({errorCode:t.code,errors:JSON.stringify([t.message])})}else e.fail({errorCode:m.jK.Unknown});else e.fail()}handleAppRedirection(e,t,i,n,a){const s=e.match(i);if(!s)return this.logger.error(this.getErrorMessage("No app redirection match",t)),Promise.resolve(null);const o=decodeURIComponent(s[s.length-1]),c=this.getSearchMessageExtensionVariables(t,o,n,a);return c?(this.queryLinkRequestsInProgress[e]||(this.queryLinkRequestsInProgress[e]=this.queryLink(c,t.id,r.RG.GetAppPreviewResult,void 0,"composeExtension/query")),this.queryLinkRequestsInProgress[e]):(this.logger.error(this.getErrorMessage("Invalid message extension passed to invoke",t)),Promise.resolve(null))}handleResultResponse(e,t,i){const n=(0,a.first)(t.items),o=null==n?void 0:n.card,{defaultPreviewType:r,cachePolicyType:l}=this.processSuggestedActions(t.suggestedActions);if(o){const t=(0,s.v4)().replace(new RegExp("-","g"),""),d=(0,a.cloneDeep)(o),u=(null==n?void 0:n.previewCard)||this.isSupportedPreviewCardType(d)&&d;return u?Object.assign(Object.assign({__typename:"AppPreviewResult",id:e,type:c.LYR.HasResult,messageExtensionItem:{__typename:"MessageExtensionItem",previewCard:u,card:{__typename:"Card",contentType:o.contentType,content:o.content,cardClientId:t,appId:i.id,appName:i.name,appIcon:i.largeImageUrl}}},r&&{defaultPreviewType:r}),l&&{cachePolicyType:l}):(this.logger.error(this.getErrorMessage(`Could not use card with content type: ${o.contentType} as a preview card`,i)),null)}return null}handleAnonymousAuthConfigResponse(e,t,i){var n,a,s;let o;return this.enablePreAuthCard&&(null===(n=t.items)||void 0===n?void 0:n.length)&&(o=null===(a=t.items[0])||void 0===a?void 0:a.card),(null===(s=t.suggestedActions)||void 0===s?void 0:s.actions)&&this.logger.warn("Suggested actions are not supported for anonymous query link invoke!"),{__typename:"AppPreviewResult",id:e,type:c.LYR.MatchButNeedAuthOrConfig,permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:i.id,card:o,isAnonymous:!0}}}handleAuthConfigResponse(e,t,i){var n,s,o,r;const l=null===(s=null===(n=t.suggestedActions)||void 0===n?void 0:n.actions)||void 0===s?void 0:s[0];let d;if(this.enablePreAuthCard&&(null===(o=t.items)||void 0===o?void 0:o.length)&&(d=null===(r=t.items[0])||void 0===r?void 0:r.card),l&&i.validDomains&&(0,h.Fd)(l.value,(0,a.compact)(i.validDomains)))return{__typename:"AppPreviewResult",id:e,type:c.LYR.MatchButNeedAuthOrConfig,permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:i.id,card:d,openUrlResult:{__typename:"AppBasedLinkOpenUrlResult",title:l.title,url:l.value,isAuth:t.type===c.CO3.auth||t.type===c.CO3.silentAuth}}};const{resource:u}=this.getWebApplicationInfo(i);return t.type===c.CO3.silentAuth&&!l&&u?{__typename:"AppPreviewResult",id:e,type:c.LYR.MatchButNeedAuthOrConfig,permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:i.id,aadAuthResult:{__typename:"AppBasedLinkAadAuthResult",resource:u}}}:(this.logger.error(this.getErrorMessage("Invalid auth/config result from bot",i)),null)}isSupportedPreviewCardType(e){const t=e.contentType.toLowerCase();return"application/vnd.microsoft.card.hero"===t||"application/vnd.microsoft.card.thumbnail"===t}getQueryLinkVariables(e,t,i,n,a){var s,o;const r=null===(s=t.messageExtensions)||void 0===s?void 0:s[0];if(r){return{botInvokeParams:{threadId:null!=i?i:"",botMri:`${d.at.BotPrefix}${null!==(o=r.botId)&&void 0!==o?o:""}`},invokeValue:JSON.stringify(Object.assign(Object.assign({url:e},n&&{state:n}),a&&{authentication:a}))}}}getSearchMessageExtensionVariables(e,t,i,n){var s,o;const r=null===(s=e.messageExtensions)||void 0===s?void 0:s[0];if(r){const e={threadId:null!=i?i:"",botMri:`${d.at.BotPrefix}${null!==(o=r.botId)&&void 0!==o?o:""}`},s=(0,a.first)((0,a.filter)(r.commands,(e=>e.type!==c.wHp.Action))),l=null==s?void 0:s.id,u=(0,a.first)(null==s?void 0:s.parameters);if(u){const i=[{name:u.name,value:t}],a={skip:0,count:1};return{botInvokeParams:e,invokeValue:JSON.stringify(Object.assign(Object.assign(Object.assign(Object.assign({},l&&{commandId:l}),{parameters:i}),a&&{queryOptions:a}),n&&{state:n}))}}}}getErrorMessage(e,t){return`${e} for app id: ${t.id}`}processSuggestedActions(e){var t;let i,n;return e?(null===(t=e.actions)||void 0===t||t.forEach((e=>{switch(e.type){case"setDefaultUrlPreviewType":i=this.getPreviewType(e.value),i||this.logger.error(`Invalid invoke response: invalid setDefaultUrlPreviewType ${e.value}`);break;case"setCachePolicy":try{const t=JSON.parse(e.value);n=this.getCachePolicy(t.type)}catch(t){this.logger.error(`Invalid invoke response: setCachePolicy requires stringified JSON payload, but got ${e.value}`);break}n||this.logger.error("Invalid invoke response: invalid cache policy type");break;default:this.logger.error(`Invalid invoke response: unsupported suggestedAction type: ${e.type}`)}})),{defaultPreviewType:i,cachePolicyType:n}):{defaultPreviewType:i,cachePolicyType:n}}getPreviewType(e){switch(e){case"Thumbnail":return c.sQ6.Thumbnail;case"Card":return c.sQ6.Card;default:return}}getCachePolicy(e){if("no-cache"===e)return c.XW6.NoCache}}},55417:(e,t,i)=>{"use strict";i.d(t,{o:()=>n});const n="48:notes"},297765:(e,t,i)=>{"use strict";i.d(t,{j:()=>o});var n=i(697337),a=i(771256),s=i(738646);const o=(e,t)=>{const i=(0,a.NI)(e),n=e.body;n&&i&&r(n,i,t)},r=(e,t,i)=>{const n=null==i?void 0:i.newScenario(s.RG.ExtCardMentionsInvoke),a={hasMentions:!1};e.forEach((e=>c(e,t,a))),n&&(a.hasMentions?n.mark(s.ck.ExtCardMentionsInvokeComplete):n.mark(s.ck.ExtCardMentionsInvokeMissing),n.stop())},c=(e,t,i)=>{(0,a.gU)(e,{type:"TextBlock"},(e=>{l(t,i)(e)})),(0,a.gU)(e,{type:"FactSet"},(e=>{d(t,i)(e)}))},l=(e,t)=>i=>{e.forEach(((e,n)=>{i.text=u(i.text,n,e,t)}))},d=(e,t)=>i=>{i.facts.forEach((i=>{e.forEach(((e,n)=>{i.title=u(i.title,n,e,t),i.value=u(i.value,n,e,t)}))}))},u=(e,t,i,a)=>{const{mentionsText:s,isMentionsApplied:o}=m(e,t,i,n.T.mention);return a.hasMentions=a.hasMentions||o,s},m=(e,t,i,n)=>{let a=!1;if(-1!==e.indexOf(t)){const s=`<span contenteditable="false" itemscope="" itemtype="${n}" itemid="${i.itemId}">${h(g(t))}</span>`;e=e.replace(new RegExp(t,"g"),s),a=!0}return{mentionsText:e,isMentionsApplied:a}},g=e=>e.substring(4,e.length-5),h=e=>e?e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00a0/g,"&nbsp;"):""},199033:(e,t,i)=>{"use strict";i.d(t,{CB:()=>c,G8:()=>l,$Z:()=>d});var n=i(275742),a=i(461270),s=i(941992),o=i(297765),r=i(690250);const c=(e,t)=>{const i={__typename:"MessageExtensionResult"},n=null==e?void 0:e.composeExtension;if(!n)return i;const a=n.type,s=n.text,c=n.attachments,l=n.suggestedActions;if(!c){const e=u(n.activityPreview);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i),a&&{type:a}),s&&{text:s}),l&&{suggestedActions:l}),e&&{activityPreview:e})}const d=n.attachmentLayout;c.forEach((e=>{e.contentType.toLowerCase()===r.s.Adaptive&&(0,o.j)(e.content,t)}));const m=Object.assign(Object.assign(Object.assign(Object.assign({items:Array.from(c,(e=>({card:{content:JSON.stringify(e.content),contentType:e.contentType},previewCard:e.preview?{content:JSON.stringify(e.preview.content),contentType:e.preview.contentType}:void 0})))},a&&{type:a}),d&&{attachmentLayout:d}),l&&{suggestedActions:l}),s&&{text:s});return Object.assign(Object.assign({},i),m)},l=e=>{if((0,n.isEmpty)(e))return(0,a.VF)(e);switch(e.responseType){case"composeExtension":return c(e);case"task":return(0,a.VF)(e);default:throw(0,s.XD)(s.jI.InvalidInvokeResponseType)}},d=e=>{if(!Array.isArray(e))return;const t=e.map((e=>{const t=(0,n.first)(null==e?void 0:e.attachments);return{type:null==e?void 0:e.type,attachments:t&&[{contentType:t.contentType,content:t.content&&JSON.parse(t.content)}]}})).filter((e=>!!e.attachments));return(0,n.isEmpty)(t)?void 0:t},u=e=>{if(!Array.isArray(e))return;const t=e.map((e=>{const t=(0,n.first)(null==e?void 0:e.attachments);return{type:null==e?void 0:e.type,attachments:t&&[{contentType:t.contentType,content:t.content&&JSON.stringify(t.content)}]}})).filter((e=>!!e.attachments));return(0,n.isEmpty)(t)?void 0:t}},461270:(e,t,i)=>{"use strict";i.d(t,{VF:()=>s,ef:()=>o,Ic:()=>u});var n=i(275742),a=i(941992);const s=e=>{if((0,n.isEmpty)(e))return u();if(r(e))return l(e.task);if(c(e))return d(e.task);throw(0,a.Pn)(a.pF.Unknown)},o=e=>{const t=e.value,i=(0,n.get)(t,"url"),s=(0,n.get)(t,"card");let o;if(!s&&!i)throw(0,a.Pn)(a.pF.MissingCardAndUrl);if(s&&i)throw(0,a.Pn)(a.pF.BothCardAndUrl);if(s)o=g(e);else if(!(0,n.isString)(i))throw(0,a.Pn)(a.pF.InvalidUrl);const{title:r,fallbackUrl:c,completionBotId:l,height:d,width:u}=t;return{title:r,fallbackUrl:c,completionBotId:l,url:i,card:o,height:m(d),width:m(u)}},r=e=>e.task&&"continue"===e.task.type&&(0,n.isObject)(e.task.value),c=e=>e.task&&"message"===e.task.type&&(0,n.isString)(e.task.value),l=e=>{const t=o(e);return{__typename:"TaskModuleTaskContinue",type:e.type,value:t}},d=({type:e,value:t})=>({__typename:"TaskModuleTaskMessage",type:e,value:t}),u=()=>({__typename:"TaskModuleTaskDone",text:"Done"}),m=e=>{if((0,n.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,n.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},g=e=>{const t=e.value.card;try{if(t&&h(t)){const{content:e={},contentType:i}=t;return{__typename:"Card",contentType:i,content:JSON.stringify(e)}}throw(0,a.Pn)(a.pF.InvalidAdaptiveCard)}catch(e){throw(0,a.Pn)(a.pF.InvalidAdaptiveCard)}},h=e=>{const t=(0,n.get)(e,"contentType");return(0,n.isString)(t)&&t.toLowerCase()==="application/vnd.microsoft.card.adaptive".toLowerCase()}},276747:(e,t,i)=>{"use strict";i.d(t,{bD:()=>n,Rz:()=>S,kK:()=>w,c:()=>j,qT:()=>C,K8:()=>_,qg:()=>T,pd:()=>I,se:()=>N,Fh:()=>E,vJ:()=>F,jc:()=>x,Dm:()=>o,wx:()=>r,rS:()=>A,D7:()=>M,Gz:()=>P});var n,a,s,o,r,c=i(850402),l=i(915929),d=i(50805),u=i(446652),m=i(89062),g=i(738646);function h(e){const{clientId:t}=e.get(d.J.Brb);return t}function p(e){const{licenseType:t}=e.get(d.J.UserResources);return t}function v(e,t,i,a){const{adoTagsForAllItems:s,categories:o}=e.get(d.J.Brb),r=null==o?void 0:o.find((e=>(null==e?void 0:e.id)===t)),c=(null==r?void 0:r.additionalAdoTags)||"",l=i.get(n.Ring)||"unknownRing",m=function(e,t){var i,n,a;const{platformAdoTagPrefix:s,platformAdoTagSuffix:o}=e.get(d.J.Brb);let r=`${s||"teams"}_${o||t.config.browser}`;return s&&o&&(null===(i=null==t?void 0:t.config)||void 0===i?void 0:i.platformId)===u.us.Web&&(r=(null===(n=null==t?void 0:t.config)||void 0===n?void 0:n.browser)?`${r}_${null===(a=null==t?void 0:t.config)||void 0===a?void 0:a.browser}`:r),r}(e,a);return[s,c,l,m,i.get(n.MTMA)?"MTMA":""].filter((e=>e)).join(";")}function f(e,t,i){const a=`${function(e){const t=e.get(n.Build)||"";return t.startsWith("local")?"[LOCAL] ":t.indexOf("oncdn")>=0?"[CONTAINER] ":""}(i)||""}${e||""}`,{brbItemTitleMaxLength:s}=t.get(d.J.Brb);return y(a,s||1500)}function b(e,t){const{brbItemDescriptionMaxLength:i}=t.get(d.J.Brb);return y(e||"",i||5e3)}function y(e,t){return(e=e||"No text provided").length>t?`${e.substring(0,t-3)}...`:e}function k(e){let t="";const i=e.get(n.MTMA);i&&"MTMA"===i&&(t="<h3>(This is MTMA scenario, please check logs from user's other accounts under Links tab)</h3><br>");let a="";return null==e||e.forEach(((e,t)=>{a=`${a}<b>${t}:</b> ${e}<br>`})),`<h3><strong>All the logs & screenshots (if attached) are available in the devlogs link which is present in the Links tab.</strong></h3><br>${t}${a}`.trim()}function S(e,t,i){var n,s;return(0,c.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield t.loadModule("toasts");if(i){const t=yield null===(n=null==i?void 0:i.getFocusAssistStateAsync)||void 0===n?void 0:n.call(i);e.set(a.FocusAssistant,t||"");const o=yield null===(s=null==i?void 0:i.getGlobalNotificationSettingsAsync)||void 0===s?void 0:s.call(i);e.set(a.GlobalNotificationSettings,(null==o?void 0:o.global)||"")}}catch(e){i.log("Failed to obtain system notification settings: ",e)}}))}function w(e,t,i,a,s){var o,r,c,l,m,g,h,p,v,f,b,y;e.set(n.UserEmail,(null===(o=null==t?void 0:t.profile)||void 0===o?void 0:o.email)||(null===(r=null==t?void 0:t.profile)||void 0===r?void 0:r.upn)||(null===(c=null==t?void 0:t.profile)||void 0===c?void 0:c.preferred_username)||""),e.set(n.UserType,(null===(l=null==t?void 0:t.type)||void 0===l?void 0:l.toString())||""),e.set(n.TenantID,(null===(m=null==t?void 0:t.profile)||void 0===m?void 0:m.tid)||""),e.set(n.Ring,(null===(h=null===(g=i.get(d.J.Metadata))||void 0===g?void 0:g.ring)||void 0===h?void 0:h.id)||""),e.set(n.UserID,(null===(v=null===(p=null==t?void 0:t.profile)||void 0===p?void 0:p.oid)||void 0===v?void 0:v.toString())||"");const k=(null===(f=i.get(d.J.Brb))||void 0===f?void 0:f.sendBrbMSAlias)?a.config.clientType===u.Bh.Maglev?null==t?void 0:t.userName:(null===(b=null==t?void 0:t.profile)||void 0===b?void 0:b.upn)||(null===(y=null==t?void 0:t.profile)||void 0===y?void 0:y.email):"";e.set(n.MSAlias,k||"");const{sessionId:S}=i.get(d.J.Platform);e.set(n.SessionId,S||""),e.set(n.Language,(null==s?void 0:s.locale)||"")}function j(e,t,i){var a;return(0,c.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield t.loadModule("osutils");if(i){const t=yield null===(a=null==i?void 0:i.getDeviceInfo)||void 0===a?void 0:a.call(i);e.set(n.OsVersion,(null==t?void 0:t.osVersion)||""),e.set(n.UbrVersion,(null==t?void 0:t.ubrVersion)||""),e.set(n.DeviceID,(null==t?void 0:t.deviceId)||"unkown deviceID"),e.set(n.SystemManufacturer,(null==t?void 0:t.make)||""),e.set(n.DeviceModel,(null==t?void 0:t.model)||""),e.set(n.AppCenterInstallerId,(null==t?void 0:t.appCenterInstallerId)||"")}}catch(e){i.log("Error while obtaining BRB device informations: ",e)}}))}function C(e,t,i){var a;return(0,c.__awaiter)(this,void 0,void 0,(function*(){try{e.set(n.slimCoreVersion,(null===(a=null==t?void 0:t.SlimCore)||void 0===a?void 0:a.getVersion().toString())||"unkown slimcore version")}catch(e){i.log("Impossible fetch slimcore version: ",e)}}))}function _(e,t,i,a){var s,o,r;return(0,c.__awaiter)(this,void 0,void 0,(function*(){try{const{browser:a,browserVersion:c,clientVersion:l}=i.get(d.J.Platform);e.set(n.Browser,a||""),e.set(n.BrowserVersion,c||""),e.set(n.WebClientBuild,l||"");const{systemInfoClient:u}=i.get(d.J.Brb);e.set(n.Client,u||"");const{desktopVersion:m}=i.get(d.J.Host);e.set(n.DesktopClientVersion,m||"unknown"),e.set(n.Platform,(null===(o=null===(s=null==t?void 0:t.config)||void 0===s?void 0:s.platformId)||void 0===o?void 0:o.toString())||""),e.set(n.Os,(null===(r=null==t?void 0:t.config)||void 0===r?void 0:r.osPlatform)||"")}catch(e){a.log("Failed to obtain app information: ",e)}}))}function T(e,t,i){return(0,c.__awaiter)(this,void 0,void 0,(function*(){try{const{enableCustomNotificationsForCalls:i,enableCustomNotificationsForChats:n,enableCustomNotificationsOnDesktop:s}=t.get(d.J.Core);e.set(a.CustomNotificationOnDesktop,s?"Enabled":"Disabled"),e.set(a.CustomNotificationForCalls,i?"Enabled":"Disabled"),e.set(a.CustomNotificationForChats,n?"Enabled":"Disabled")}catch(e){i.log("Failed to obtain app information: ",e)}}))}function I(e,t,i){try{const{callingEnableUnifiedJoinFlowForPlaceCalls:i}=t.get(d.J.Calling);e.set(s.callingEnableUnifiedJoinFlowForPlaceCalls,i?"Enabled":"Disabled")}catch(e){i.log("Failed to obtain FF callingEnableUnifiedJoinFlowForPlaceCalls status: ",e)}}function N(e,t){var i;return(0,c.__awaiter)(this,void 0,void 0,(function*(){const a=yield null===(i=null==t?void 0:t.getCachedUsers)||void 0===i?void 0:i.call(t,{id:(0,l.v4)(),scenarioName:g.RG.AuthWebCachedUser,source:"brb-utils::addMTMAInfo"}),s=(null==a?void 0:a.length)&&a.length>1;e.set(n.MTMA,s?"MTMA":"")}))}function E(e,t,i,a,s){return(0,m.u4)({ReportTitle:f(e.text,t,a),ReportDescription:b(e.text,t),CategoryName:e.categoryId,UploadID:(0,l.v4)(),InitiatorIDs:[],ClientID:h(t),ClientVersion:D(a),CorelibVersion:"",Ring:a.get(n.Ring),SkypeAuthToken:i,TenantName:"",TenantID:a.get(n.TenantID),UserID:a.get(n.UserID),Email:a.get(n.UserEmail),MSAlias:a.get(n.MSAlias)||"",SkipEmailNotification:!1,SkipVsoTicketCreation:!1,SystemInfo:k(a),VsoTags:v(t,e.categoryId,a,s),LicenseType:p(t),IsAutoBrb:"true"===a.get(n.IsAutoBrb)})}function F(e,t,i){var a;const{extendBrbReportsUrl:s,clientId:o}=t.get(d.J.Brb);return{baseUrl:null!==(a=null==s?void 0:s.substring(0,s.lastIndexOf("/")))&&void 0!==a?a:"",title:e.text,clientId:null!=o?o:"",clientVersion:D(i),ring:i.get(n.Ring)}}function x(e,t,i,a,s){return(0,m.u4)({ReportTitle:f(e.text,a,s),ReportDescription:b(e.text,a),CategoryName:e.categoryId,SkypeAuthToken:t,UploadID:(0,l.v4)(),InitiatorIDs:[i],ClientID:h(a),ClientVersion:D(s),Email:s.get(n.UserEmail),TenantID:s.get(n.TenantID),UserID:s.get(n.UserID),Ring:s.get(n.Ring)})}function D(e){return e.get(n.WebClientBuild)||"1.1.11.1111_11/1.1.1.1111111111"}function A(e,t,i,n,a){let s=n;s=s?s===r.ApiFailure?r.ApiFailure:s.includes(r.TimedOut)?r.TimedOut:r.Unknown:void 0;let o=e.get(t);return o?(o.uploadStatus=i,o.byteSize=null!=a?a:o.byteSize,o.error=null!=s?s:o.error):(o={uploadStatus:i,byteSize:a,error:s},e.set(t,o)),s}function M(e){let t=!0;const i=[];for(const[n,a]of e.entries()){const e=a.byteSize?`(${a.byteSize} bytes)`:"",s=`Status: ${a.uploadStatus}`;t=a.uploadStatus===o.Success&&t;const r=`FileName: ${n} ${e}, ${s}${a.error?`, error: ${a.error}`:""}`;i.push(r)}return{content:i.join("\r\n"),allLogFilesUploaded:t,summaryFileUploaded:!1}}function P(e){const t=e.split("/"),i=t.length>1?t[t.length-1]:e;return e.includes("WebLogs/Core")?`WebLogs/Core/${i}`:e.includes("WebLogs/User")?`WebLogs/User/${i}`:i}!function(e){e.UserEmail="UserEmail",e.TenantID="TenantID",e.Ring="Ring",e.UserID="UserID",e.WebClientBuild="WebClient build",e.Build="Build",e.MTMA="MTMA",e.MSAlias="MSAlias",e.DeviceID="Device ID",e.Language="Language",e.SystemManufacturer="System Manufacturer",e.DeviceModel="Device Model",e.DesktopVersion="Desktop Version",e.slimCoreVersion="Slimcore Version",e.UbrVersion="Update Build Revision",e.Platform="Platform",e.Os="OS",e.OsVersion="OS Version",e.Browser="Browser",e.BrowserVersion="Browser Version",e.Client="Client",e.UserType="User Type",e.SessionId="Session Id",e.DesktopClientVersion="Desktop Client Version",e.AppCenterInstallerId="AppCenter Installer ID",e.IsAutoBrb="IsAutoBrb"}(n||(n={})),function(e){e.FocusAssistant="Focus Assistant",e.GlobalNotificationSettings="Global Notification Settings",e.CustomNotificationOnDesktop="Custom Notification on Desktop",e.CustomNotificationForChats="Custom Notification for Chats",e.CustomNotificationForCalls="Custom Notification for Calls"}(a||(a={})),function(e){e.callingEnableUnifiedJoinFlowForPlaceCalls="Enable Unified Join Flow For Place Calls"}(s||(s={})),function(e){e.Requested="Requested",e.Success="Success",e.Failure="Failure"}(o||(o={})),function(e){e.TimedOut="TimedOut",e.Unknown="Unknown",e.ApiFailure="ApiFailure",e.NetworkError="NetworkError"}(r||(r={}))},949300:(e,t,i)=>{"use strict";i.d(t,{w:()=>b});var n=i(850402),a=i(50805),s=i(738646),o=i(8122),r=i(974509),c=i(276747),l=i(139171);const d=e=>{const t=e.loggerFactory.newLogger("BrbServiceEndpointsManager","services-io-brb");return{baseUrl:"https://brbv2",serviceName:o.E.BRB,models:{createBrbItem:m(e,t),uploadLogsFile:g(e,t),releaseBrbItem:h(e,t),extendBrbReports:u(e,t)}}},u=(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return{allowedResponses:[r.qb.OK],constructRequest:(i,n,s,o)=>{if(!n){const e=`Skype token is not present: ${n}`;throw t.error(e),new Error(e)}const{extendBrbReportsUrl:r}=e.coreSettings.get(a.J.Brb);if(!r){const e=`Failed to retrieve extend BRB report url from core settings: ${r}`;throw t.error(e),new Error(e)}let l;try{l=(0,c.jc)(i,n,s,e.coreSettings,o)}catch(e){throw t.error("Failed to get extend BRB report request body:",e),e}const d=new URL(r);return{method:"POST",url:d.href,headers:{Host:d.hostname,"Content-Type":"application/json","Content-Length":`${l.length}`},body:l}},abortOnTimeout:!1}})),m=(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return{allowedResponses:[r.qb.OK],constructRequest:(i,n,s)=>{if(!i){const e=`Skype token is not present: ${i}`;throw t.error(e),new Error(e)}const{createBrbRequestUrl:o}=e.coreSettings.get(a.J.Brb);if(!o){const e=`Failed to retrieve create BRB request url from core settings: ${o}`;throw t.error(e),new Error(e)}let r;try{r=(0,c.Fh)(n,e.coreSettings,i,s,e.platformService)}catch(e){throw t.error("Failed to get create BRB item request body:",e),e}const l=new URL(o);return{method:"POST",url:l.href,headers:{Host:l.hostname,"Content-Type":"application/json","Content-Length":`${r.length}`},body:r}}}})),g=(e,t)=>Promise.resolve({allowedResponses:[r.qb.CREATED],constructRequest:(i,n)=>{if(!i){const e=`Create BRB item response body is not present: ${i}`;throw t.error(e),new Error(e)}if(!n){const e=`Logs file is not present: ${n}`;throw t.error(e),new Error(e)}const{enableGzipUpload:s,minSizeToGzip:o}=e.coreSettings.get(a.J.Brb,["enableGzipUpload","minSizeToGzip"]),r=new URL(i.ContainerUrl);let c,d,u;return s&&"string"==typeof n.content&&n.content.length>(null!=o?o:2e3)?(c=(0,l.gzip)(n.content),d=c.length,u=!0):(c=n.content,d="string"==typeof n.content?n.content.length:n.content.size,u=!1),{method:"PUT",url:`${r.href}/${n.fileName}?${i.SASToken}`,headers:Object.assign({Host:r.hostname,"Content-Type":"text/plain","Content-Length":d.toString(),"x-ms-blob-type":"BlockBlob"},u?{"Content-Encoding":"gzip"}:{}),body:c}},transformResponse:()=>Promise.resolve(!0),abortOnTimeout:!1}),h=(e,t)=>Promise.resolve({allowedResponses:[r.qb.OK],constructRequest:i=>{if(!i){const e=`Container ID is not present: ${i}`;throw t.error(e),new Error(e)}const{releaseBrbRequestUrlPrefix:n}=e.coreSettings.get(a.J.Brb);if(!n){const e=`Failed to retrieve release BRB request url prefix from core settings: ${n}`;throw t.error(e),new Error(e)}const s=new URL(`${n}${i}`);return{method:"POST",url:s.href,headers:{Host:s.hostname,"Content-Length":"0"}}},transformResponse:()=>Promise.resolve(!0),abortOnTimeout:!1});var p=i(575644),v=i(838440);class f{constructor(e,t,i,n,a,s,o,r,c,l,d,u,m){this.coreSettings=t,this.logsCollectorService=i,this.authenticationService=n,this.platformService=a,this.discover=s,this.host=o,this.hostCommunicationService=r,this.brbServiceApi=c,this.i18n=l,this.activeWindowsService=d,this.authenticationUser=u,this.apolloClient=m,this.defaultUploadDesktopLogsTimeoutMs=2e4,this.logger=e.newLogger("BrbServiceTasks","services-io-brb")}getSystemInfo(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=new Map;let t;e.set("TimeStamp",(new Date).toISOString()),this.logger.debug("... starting getSystemInfo() brb");try{t=yield this.authenticationService.getUser()}catch(e){this.logger.error("Failed to fetch user:",e)}(0,c.kK)(e,t,this.coreSettings,this.platformService,this.i18n);const{enableMTMA:i}=this.coreSettings.get(a.J.Core);i&&(yield(0,c.se)(e,this.authenticationService)),yield(0,c.qT)(e,this.host,this.logger),yield(0,c.K8)(e,this.platformService,this.coreSettings,this.logger),yield(0,c.c)(e,this.hostCommunicationService,this.logger),yield(0,c.Rz)(e,this.hostCommunicationService,this.logger),yield(0,c.qg)(e,this.coreSettings,this.logger),(0,c.pd)(e,this.coreSettings,this.logger);let n=new Map;try{n=(yield this.logsCollectorService.getSystemInfo())||new Map}catch(e){this.logger.error("Failed to fetch system info from logs collector service:",e)}return new Map([...Array.from(e.entries()),...Array.from(n.entries())])}))}createBrbItem(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let i;try{const n=yield this.discover.validateSkypeToken();i=yield this.brbServiceApi.createBrbItem(n,e,t)}catch(e){return this.logger.error("Failed creating BRB item:",e),null}return i}))}extendBrbReports(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n;try{const a=yield this.discover.validateSkypeToken();n=yield this.brbServiceApi.extendBrbReports(e,a,t,i)}catch(e){return this.logger.error("Failed extending BRB report"),null}return n}))}uploadWebLogsFiles(e,t){var i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const o=new Map,{enableMTMA:r}=this.coreSettings.get(a.J.Core),{maxBRBLogsCountInLogFile:l}=this.coreSettings.get(a.J.Diagnostics),d=i=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=i.content instanceof Blob?i.content.size:new Blob([i.content]).size,a=`File name: ${i.fileName}, size: ${n} bytes`;(0,c.rS)(o,i.fileName,c.Dm.Requested,void 0,n);const r=(0,c.Gz)(i.fileName);try{const l=yield this.brbServiceApi.uploadLogsFile(e,i),d=l?c.Dm.Success:c.Dm.Failure;return(0,c.rS)(o,i.fileName,d,d?void 0:c.wx.ApiFailure,n),null==t||t.mark(s.ck.UploadWebLogsFiles,{reason:a,size:n,context:r},d?"success":"failure"),l}catch(e){return this.logger.error(`Failed to upload logs file - ${i.fileName} - error:`,e),(0,c.rS)(o,i.fileName,c.Dm.Failure,e.toString(),n),null==t||t.mark(s.ck.UploadWebLogsFiles,{reason:a,size:n,context:r},"failure"),!1}}));try{r&&(null===(i=this.authenticationUser)||void 0===i?void 0:i.id)?yield this.logsCollectorService.callOnUserLogsFiles([this.authenticationUser.id],d,!1,!1,l||void 0):yield this.logsCollectorService.callOnLogsFiles(d,!1,!1,l||void 0)}catch(e){return this.logger.error("Failed when calling upload on all logs files:",e),o}return o}))}uploadDesktopLogsFiles(e,t,i){var o;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n="Desktop-Logs-and-Screenshots",r=new Map,l=yield this.hostCommunicationService.loadModule("brb");if(!l)return this.logger.log("uploadDesktopLogsFiles(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."),r;let d;const{enableMTMA:u}=this.coreSettings.get(a.J.Core);if(u&&this.apolloClient){const e=null===(o=this.authenticationUser)||void 0===o?void 0:o.id,i=this.activeWindowsService.enableDecoupleCommandingFromApollo?this.activeWindowsService.getActiveWindows():yield(0,v.XD)(this.apolloClient),n=[];i.forEach((t=>{t.userContextId===e&&n.push(t.id)})),d=null==t?void 0:t.filter((e=>n.includes(e)))}else d=t;if(!l.uploadDesktopLogs)return this.logger.error("uploadDesktopLogs not available on brb module."),r;const m={azureBlobStorageInfo:{sharedAccessSignature:e.SharedAccessSignature},screenshotIds:d},{uploadDesktopLogsTimeoutMs:g}=this.coreSettings.get(a.J.Brb),h=null!=g?g:this.defaultUploadDesktopLogsTimeoutMs;try{const e=yield(0,p.E)(l.uploadDesktopLogs(m),h,`uploadDesktopLogs timed out. Ran for ${h} ms.`),t=!!(null==e?void 0:e.status);return(0,c.rS)(r,n,t?c.Dm.Success:c.Dm.Failure,t?void 0:c.wx.ApiFailure),null==i||i.mark(s.ck.UploadDesktopLogsFiles,t?void 0:{reason:`${c.wx.ApiFailure}`},t?"success":"failure"),r}catch(e){this.logger.error("Failed to upload desktop logs files. Error:",e);const t=(0,p.T)(e)?c.wx.TimedOut:c.wx.Unknown;return(0,c.rS)(r,n,c.Dm.Failure,t),null==i||i.mark(s.ck.UploadDesktopLogsFiles,{reason:t},"failure"),r}}))}uploadHeapSnapshotFiles(e,t){var i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n="Heap-Snapshot",o=new Map,r=yield this.hostCommunicationService.loadModule("brb");if(!r)return this.logger.log("uploadHeapSnapshotFiles(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."),o;if(!r.uploadHeapSnapshot)return this.logger.error("uploadHeapSnapshot not available on brb module."),o;const l={azureBlobStorageInfo:{sharedAccessSignature:e.SharedAccessSignature}};try{const e=yield r.uploadHeapSnapshot(l),i=!!(null==e?void 0:e.status);return(0,c.rS)(o,n,i?c.Dm.Success:c.Dm.Failure,i?void 0:c.wx.ApiFailure),null==t||t.mark(s.ck.UploadHeapSnapshotFiles,i?void 0:{reason:`${c.wx.ApiFailure}`},i?"success":"failure"),o}catch(e){this.logger.error("Failed to upload heapsnapshot files. Error:",e),null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,"Failed to upload heap snapshot file","brb");const r=(0,c.rS)(o,n,c.Dm.Failure,e.toString());return null==t||t.mark(s.ck.UploadHeapSnapshotFiles,{reason:r},"failure"),o}}))}uploadMemoryTracingFile(e,t){var i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n="Memory-Tracing",o=new Map,r=yield this.hostCommunicationService.loadModule("brb");if(!r)return this.logger.log("uploadMemoryTracingFile(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."),o;if(!r.uploadMemoryTracing)return this.logger.error("uploadMemoryTracing not available on brb module."),o;const l={azureBlobStorageInfo:{sharedAccessSignature:e.SharedAccessSignature}};try{const e=yield r.uploadMemoryTracing(l),i=!!(null==e?void 0:e.status);return(0,c.rS)(o,n,i?c.Dm.Success:c.Dm.Failure,i?void 0:c.wx.ApiFailure),null==t||t.mark(s.ck.UploadMemoryTracingFile,i?void 0:{reason:`${c.wx.ApiFailure}`},i?"success":"failure"),o}catch(e){this.logger.error("Failed to upload memory tracing file. Error:",e),null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,"Failed to upload memory tracing file","brb");const r=(0,c.rS)(o,n,c.Dm.Failure,e.toString());return null==t||t.mark(s.ck.UploadMemoryTracingFile,{reason:r},"failure"),o}}))}releaseBrbItem(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let t;try{t=yield this.brbServiceApi.releaseBrbItem(e)}catch(e){return this.logger.error("Failed to release the BRB item - error:",e),!1}return t}))}uploadFileUploadSummary(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=(0,c.D7)(t);try{const t=yield this.brbServiceApi.uploadLogsFile(e,{fileName:"brb-file-upload-summary.txt",content:n.content,isPiiFree:!0});return null==i||i.mark(s.ck.UploadFileUploadSummary),n.summaryFileUploaded=t,n}catch(e){const t=e.toString().includes("TimedOut")?c.wx.TimedOut:c.wx.Unknown;return null==i||i.mark(s.ck.UploadFileUploadSummary,{reason:t},"failure"),n.summaryFileUploaded=!1,n}}))}}class b{constructor(e,t,i,n,a,s,o,r,c,l,u,m,g,h){this.coreSettings=t,this.hostCommunicationService=r,this.scenarioFactory=l,this.defaultDisclaimer='NOTE: Data sent in feedback submissions will be "Support Data" under your agreement for Microsoft 365, including any information that would otherwise be considered "Customer Data" or "Personal Data". Please do not submit feedback that may include data you do not wish to provide to Microsoft as "Support Data".',this.logger=e.newLogger("BrbService","services-io-brb");const p=c.createApi(d);this.brbServiceTasks=new f(e,t,i,n,a,s,o,r,p,u,m,g,h)}getSystemInfo(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let e=new Map;try{e=yield this.brbServiceTasks.getSystemInfo()}catch(e){this.logger.error("Failed to fetch system info:",e)}return Promise.resolve(e)}))}getBrbFormData(){var e,t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{categories:i,disclaimer:n}=this.coreSettings.get(a.J.Brb),s=[];return null==i||i.forEach((e=>{e&&s.push({id:e.id,name:e.name})})),null===(t=(e=this.logger).logNoPii)||void 0===t||t.call(e,"Returning data for BRB form",s),{disclaimer:n||this.defaultDisclaimer,categories:s}}))}getBrbScreenshots(e){var t,i,a,s,o,r,c;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("brb");if(!n)return void(null===(i=(t=this.logger).logNoPii)||void 0===i||i.call(t,"getBrbScreenshots(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."));null===(s=(a=this.logger).logNoPii)||void 0===s||s.call(a,"Requesting screenshots from host");const l=yield null===(o=n.getScreenshotThumbnails)||void 0===o?void 0:o.call(n,{width:e.width,height:e.height||void 0});return null===(c=(r=this.logger).logNoPii)||void 0===c||c.call(r,"Returning host-provided screenshots"),null==l?void 0:l.screenshots}))}createBrbItem(e,t){var i,o;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enableBrb:n}=this.coreSettings.get(a.J.Brb);if(!n)return void(null===(o=(i=this.logger).logNoPii)||void 0===o||o.call(i,"Create BRB item not enabled - setting:",n));const r=this.scenarioFactory.newScenario(s.RG.BrbCreateItem,{timeoutMs:36e5});r.appendEventData({isAutoBrb:t}),r.mark(s.ck.BrbSubmitted);const c=yield this.processCreateBrbRequest(e,t);if("error"!==c.kind)return r.stop(),{containerId:c.response.ContainerID};r.fail({reason:c.reason})}))}extendBrbReports(e,t,i){var o,r,c,l;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enableBrb:n}=this.coreSettings.get(a.J.Brb),d=this.scenarioFactory.newScenario(s.RG.BrbExtendReports);if(d.appendEventData({isAutoBrb:i}),!n){const e="Current account is not internal ring account";return null===(r=(o=this.logger).errorNoPii)||void 0===r||r.call(o,e),d.cancel({reason:e}),!1}const u=yield this.processExtendBrbReportsRequest(e,t.containerId);return u?d.stop():d.fail(),null===(l=(c=this.logger).logNoPii)||void 0===l||l.call(c,"Finished extending brb report"),u}))}processExtendBrbReportsRequest(e,t){var i,a,s,o;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n=new Map;try{n=yield this.brbServiceTasks.getSystemInfo()}catch(e){null===(a=(i=this.logger).errorNoPii)||void 0===a||a.call(i,"Failed to fetch system info")}let r=null;try{r=yield this.brbServiceTasks.extendBrbReports(e,t,n)}catch(e){return null===(o=(s=this.logger).errorNoPii)||void 0===o||o.call(s,"Failed to Extend BRB Reports"),!1}if(!r)return this.logger.error(`Request to Extend BRB Reports failed to receive response body: ${r}`),!1;let c=!1;try{c=yield this.uploadFilesToBrbItem(r,e.includeHeapSnapshot,e.screenshotIds?[...e.screenshotIds]:void 0),c||this.logger.error(`Failed to upload all logs files to first party container: ${t}`)}catch(e){this.logger.error(`Error when uploading all logs files to first party container: ${t}`)}return!0}))}processCreateBrbRequest(e,t){var i,a,s,o;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n=new Map;try{n=yield this.brbServiceTasks.getSystemInfo()}catch(e){this.logger.error("Failed to fetch system info:",e)}n.set(c.bD.IsAutoBrb,t?"true":"");let r=null;try{r=yield this.brbServiceTasks.createBrbItem(e,n)}catch(e){return this.logger.error("Failed to create BRB item:",e),{kind:"error",reason:"Failed to create BRB item"}}if(!r)return this.logger.error(`Request to create BRB item failed to receive response body: ${r}`),{kind:"error",reason:"Request to create BRB item failed to receive response body"};let l=!1;try{l=yield this.uploadFilesToBrbItem(r,e.includeHeapSnapshot,e.screenshotIds?[...e.screenshotIds]:void 0)}catch(e){this.logger.error("Failed to upload all logs files:",e)}l||null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,"Failed to upload all logs files - attempting to complete BRB item","brb");let d=!1;try{d=yield this.brbServiceTasks.releaseBrbItem(r.ContainerID)}catch(e){return this.logger.error("Failed to release BRB item:",e),{kind:"error",reason:"Failed to release BRB item"}}if(!d){const e="Failed to release the BRB item";return null===(o=(s=this.logger).errorNoPii)||void 0===o||o.call(s,e),{kind:"error",reason:e}}return{kind:"response",response:r}}))}uploadFilesToBrbItem(e,t=!1,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=this.scenarioFactory.newScenario(s.RG.BrbUploadLogs),a=[];let o=new Map;t&&(o=yield this.brbServiceTasks.uploadHeapSnapshotFiles(e,n),a.push(this.brbServiceTasks.uploadMemoryTracingFile(e,n))),a.push(this.brbServiceTasks.uploadWebLogsFiles(e,n)),a.push(this.brbServiceTasks.uploadDesktopLogsFiles(e,i,n));(yield Promise.all(a)).forEach((e=>{e.forEach(((e,t)=>{o.set(t,e)}))}));const r=yield this.brbServiceTasks.uploadFileUploadSummary(e,o,n),c=r.allLogFilesUploaded&&r.summaryFileUploaded;return c?n.stop():n.fail(),c}))}}},933736:(e,t,i)=>{"use strict";i.d(t,{V:()=>n,N:()=>a});const n="broadcast-updated-event",a={streamUpdateHubEvent:"streamUpdate",captionsUpdate:"captionsUpdate",subscribeToStreamUpdatesHubEvent:"subscribeToStreamUpdates",notifyStreamSwitch:"notifyStreamSwitch",transcriptionStateUpdate:"transcriptionStateUpdate"}},486390:(e,t,i)=>{"use strict";var n,a;i.d(t,{mN:()=>n,GB:()=>a,yR:()=>s,oo:()=>o,Q0:()=>r,ex:()=>c,PR:()=>l,gh:()=>d,LC:()=>u,Ky:()=>m,ji:()=>g}),function(e){e.InProgress="InProgress",e.Success="Success",e.Error="Error",e.PartialSuccess="PartialSuccess"}(n||(n={})),function(e){e.StatusEntity="Microsoft.SkypeSpaces.MiddleTier.Models.StatusEntity"}(a||(a={}));const s="x-serverrequestid",o="call_blocking_list_refreshed",r=36e5,c="https://teams.microsoft.com/";var l;!function(e){e.getBlockedContacts="getBlockedContacts",e.postBlockedContacts="postBlockedContacts"}(l||(l={}));const d="api/",u=[{id:l.getBlockedContacts,path:"mt/part/msft/beta/userSettings/blocklist"},{id:l.postBlockedContacts,path:"mt/part/msft/beta/userSettings/blocklist/manage"}],m="https://teams.live.com/";var g;!function(e){e.Add="Add",e.Remove="Remove"}(g||(g={}))},815573:(e,t,i)=>{"use strict";i.d(t,{N:()=>a,H:()=>s});const n=", ",a=(e,t)=>{let i=e[0],a=1;for(;a<e.length&&!(i.length+e[a].length>24);a++)i=i.concat(`${n}${e[a]}`);return{displayName:i,count:a<t?t-a+1:void 0}},s=(e,t,i)=>{const s=a(e,t);if(!s.count){const e=s.displayName.split(n);if(e.length>1){const t=new Intl.ListFormat(i).format(e);t.length<=26?s.displayName=t:(s.displayName=e.slice(0,e.length-1).join(n),s.count=2)}}return s}},609485:(e,t,i)=>{"use strict";i.d(t,{HI:()=>n,LC:()=>a,aO:()=>s,YK:()=>o,UQ:()=>r});const n={addMembersToThread:"addMembersToThread",createThread:"createThread",deleteConversation:"deleteConversation",locationSharingQuery:"locationSharingQuery",removeMemberFromThread:"removeMemberFromThread",reportUser:"reportUser",updateThreadProperties:"updateThreadProperties"},a={addMembersToThread:"beta/groups/{threadId}/members",createThread:"beta/groups/create",deleteConversation:"beta/groups/{threadId}/deleteChat",locationSharingQuery:"https://teams.live.com/api/location/prod",removeMemberFromThread:"beta/groups/{threadId}/members/{userMri}",reportUser:"/beta/users/{userMri}/report",updateThreadProperties:"beta/groups/{threadId}/properties"},s="ConsumerGroupsService",o="{threadId}",r="{userMri}"},231194:(e,t,i)=>{"use strict";i.d(t,{jP:()=>v,O5:()=>y,Nc:()=>k});var n=i(50805),a=i(486070),s=i(8122),o=i(299295),r=i(844729),c=i(609485),l=i(372521);const d="v1/threads/{threadId}/members",u="v1/threads",m="v1/threads/{threadId}",g="v1/threads/{threadId}/members/{userMri}",h="/v1/users/{userMri}/report",p="v1/threads/{threadId}/properties",v="https://groupssvc.fl.teams.microsoft.com/teams.readwrite";function f(e){return Promise.resolve({constructRequest:e,rejectHttpError:!0})}const b=(e,t,i)=>{const n=(0,r.h)(t,i),a=(0,o.g)(f,n);return{addMembersToThread:a((0,l.Hd)(e.groupsServiceAddToRosterEndpoint||d,e.groupsServiceThreadIdParameterToken||c.YK)),createThread:a((0,l._)(e.groupsServiceCreateGroupEndpoint||u)).withTransform(l.jI),deleteConversation:a((0,l.uz)(e.groupsServiceDeleteConversationEndpoint||m,e.groupsServiceThreadIdParameterToken||c.YK)),locationSharingQuery:a(l.Jo),removeMemberFromThread:a((0,l.Jr)(e.groupsServiceRemoveFromRosterEndpoint||g,e.groupsServiceThreadIdParameterToken||c.YK,e.groupsServiceUserMriParameterToken||c.UQ)),reportUser:a((0,l.zR)(e.reportUserEndpoint||h,e.groupsServiceUserMriParameterToken||c.UQ)).withTransform(l.Vo),updateConversationTopic:a((0,l.lh)(e.groupsServiceUpdatePropertiesEndpoint||p,e.groupsServiceThreadIdParameterToken||c.YK))}},y=e=>{const{coreSettings:t,platformService:i,authenticationResources:o,authenticationService:r,config:c}=e,l=t.get(n.J.ConsumerGroups);return{serviceName:s.E.GroupsServiceV2,baseUrlPromise:()=>e.discover.regionGtm(a.Pn.groupsServiceV2),authResource:k(r,o,v),models:b(l,i,c)}},k=(e,t,i)=>n=>e.getUser().then((()=>{const a=t.composeAuthResources((t=>e.authorizeRequest(t,i)),t.skypeXTokenAuthResource);return a(n)}))},372521:(e,t,i)=>{"use strict";i.d(t,{Hd:()=>c,_:()=>l,Jr:()=>d,lh:()=>u,uz:()=>m,Jo:()=>g,zR:()=>h,jI:()=>p,Vo:()=>v});var n=i(850402),a=i(8122),s=i(863553),o=i(760005),r=i(609485);const c=(e,t)=>(i,n,s=!0)=>{const c=e.replace(t,encodeURIComponent(i)),l=s?{members:n.map((e=>({id:e.id,role:o.nL.Admin,shareHistoryTime:0})))}:{members:n.map((e=>({id:e.id,role:e.role,shareHistoryTime:0})))};return{url:c,method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(l),serviceName:a.E.GroupsServiceV2,apiName:r.HI.addMembersToThread}},l=e=>(t,i,n,s)=>{const c="true"===i[o.Q5.IsStickyThread],l=""===n,d=""===s,u={members:t.map((e=>({id:e.id,role:c?o.nL.User:o.nL.Admin}))),properties:i,inviterMri:l?void 0:n,inviteLink:d?void 0:s};return{url:e,method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(u),serviceName:a.E.GroupsServiceV2,apiName:r.HI.createThread}},d=(e,t,i)=>(n,s)=>({url:e.replace(t,encodeURIComponent(n)).replace(i,encodeURIComponent(s)),method:"DELETE",headers:{"content-type":"application/json"},serviceName:a.E.GroupsServiceV2,apiName:r.HI.removeMemberFromThread}),u=(e,t)=>(i,n)=>{const s={topic:n};return{url:e.replace(t,encodeURIComponent(i)),method:"PATCH",headers:{"content-type":"application/json"},body:JSON.stringify(s),serviceName:a.E.GroupsServiceV2,apiName:r.HI.updateThreadProperties}},m=(e,t)=>i=>({url:e.replace(t,encodeURIComponent(i)),method:"DELETE",headers:{"content-type":"application/json"},serviceName:a.E.GroupsServiceV2,apiName:r.HI.deleteConversation}),g=(e,t)=>{const i={Query:e};return{url:`${t}/graphql`,method:"POST",headers:{"content-type":"application/json;charset=utf-8"},body:JSON.stringify(i),serviceName:a.E.MiddleTier,apiName:r.HI.locationSharingQuery}},h=(e,t)=>(i,n)=>({url:e.replace(t,encodeURIComponent(i)),method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(n),serviceName:a.E.GroupsServiceV2,apiName:r.HI.reportUser});function p(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{status:t,headers:{location:i},body:n}=e;if(void 0===i)throw new Error("location undefined");return{status:t,threadId:(0,s.F)(i),responseBody:n}}))}function v(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{body:t,status:i}=e;return{status:i,responseBody:t}}))}},232894:(e,t,i)=>{"use strict";var n;i.d(t,{Ut:()=>n,$O:()=>a,Ms:()=>s,h:()=>o,EQ:()=>r}),function(e){e.feed="TeamsFeed",e.syncFeed="TeamsFeedSync"}(n||(n={}));const a={defaultSection:"TeamsFeed",defaultTimeSortedSection:"TeamsFeedTimeSorted",defaultItemsToFetch:3,defaultLoadMoreItemsCount:5,defaultItemsToCompare:3,defaultReadSignalMinDwellTime:5e3,defaultCDLLoadMoreItemsCount:5,defaultDataSyncIntervalTime:3e5,defaultDiscoverTriagingTime:3e5,defaultServerCacheRetentionTimeInHrsSinceFirstCall:72,defaultDiscoverPollingInterval:3e5,defaultMinPageSizeForLoadMoreAPI:1};var s,o,r;!function(e){e.api="api",e.indexDB="indexdb",e.cdlCache="cdlcache",e.apolloCache="apollocache",e.unknown="unknown"}(s||(s={})),function(e){e.polling="polling",e.startup="startup",e.switch="switch",e.scroll="scroll",e.removeContent="removeContent",e.retry="retry",e.newUpdatesPoll="newUpdatesPoll",e.optimizer="optimizer"}(o||(o={})),function(e){e.emptyApiResponse="EMPTY_API_RESPONSE",e.validationFailed="VALIDATION_FAILED",e.hydrationFailed="HYDRATION_FAILED"}(r||(r={}))},867328:(e,t,i)=>{"use strict";var n,a,s;i.d(t,{Hw:()=>n,F4:()=>a,cL:()=>s}),function(e){e[e.Valid=0]="Valid",e[e.Expired=1]="Expired",e[e.NoData=2]="NoData",e[e.NoCache=3]="NoCache"}(n||(n={})),function(e){e.Filters="Filters",e.None="None",e.ConsumerKey="ConsumerKey"}(a||(a={})),function(e){e.OnExpiry="OnExpiry",e.Never="Never"}(s||(s={}))},704680:(e,t,i)=>{"use strict";var n;i.d(t,{m:()=>n}),function(e){e[e.Success=0]="Success",e[e.Success_NoChanges=1]="Success_NoChanges",e[e.Abandoned_ClientVeryActive=2]="Abandoned_ClientVeryActive",e[e.Abandoned_NoNetwork=3]="Abandoned_NoNetwork",e[e.Error_TimedOut=4]="Error_TimedOut",e[e.Error_TransformFailed=5]="Error_TransformFailed",e[e.Error_BrowserError=6]="Error_BrowserError",e[e.Error_Unknown=7]="Error_Unknown",e[e.NotStarted=8]="NotStarted"}(n||(n={}))},143285:(e,t,i)=>{"use strict";var n;i.d(t,{z:()=>n}),function(e){e[e.Manual=0]="Manual",e[e.WhenExpired=1]="WhenExpired"}(n||(n={}))},806982:(e,t,i)=>{"use strict";i.d(t,{bn:()=>S,fh:()=>w,un:()=>k});var n=i(850402),a=i(223005),s=i(915929),o=i(143285),r=i(704680),c=i(867328);class l{constructor(e,t,i){this.serviceName=e,this.ecsParameters=i,this.logger=t.newLogger(`EcsClient_${this.serviceName}`,"services-io-ecs")}initializeCache(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){this.cache={storage:e.storage,partitionOptions:{strategy:e.partitionBy||c.F4.None,excludeFilters:e.excludeFiltersFromPartition||[],consumerKey:e.consumerKey},invalidate:e.invalidateCache||c.cL.Never};const{configKey:t,metadataKey:i}=this.generateCacheKeys();try{const e=yield this.cache.storage.getItem(t),n=yield this.cache.storage.getItem(i);if(e){const i=JSON.parse(e),a=n?JSON.parse(n):{requestStatus:r.m.Success};this.data=Object.assign({ecsConfiguration:i},a),this.logger.log(`Cache successfully loaded: ${t}`)}else this.logger.log(`No cached data found: ${t}`)}catch(e){this.logger.log(`Error while loading from cache '${t}', error:`,e)}}))}get(){var e;return(null===(e=this.cache)||void 0===e?void 0:e.invalidate)===c.cL.OnExpiry&&this.cacheState===c.Hw.Expired&&(this.logger.log("Cache expired, clearing cache"),this.clearCache()),this.data}get expiration(){var e,t;const i=null===(t=null===(e=this.data)||void 0===e?void 0:e.headers)||void 0===t?void 0:t.Expires;return i&&new Date(i)}get cacheState(){return void 0===this.cache?c.Hw.NoCache:this.data?this.expiration&&this.expiration.valueOf()>Date.now()?c.Hw.Valid:c.Hw.Expired:c.Hw.NoData}getDiagnosticInfo(){return{expirationTime:this.expiration}}generateCacheKeys(){if(void 0===this.cache)throw new Error("Cannot generate keys until after initializeCache() is called");const{strategy:e,excludeFilters:t,consumerKey:i}=this.cache.partitionOptions;let n=`ecs.cache.${this.serviceName}`;switch(e){case c.F4.ConsumerKey:if(!i)throw new Error("Cannot generate key using PartitionStrategy.ConsumerKey if consumerKey is not provided");n=`${i}`;break;case c.F4.Filters:{if(!this.ecsParameters)throw new Error("Cannot generate key using PartitionStrategy.Filters if ecsParameters is not set during instantiation");const e=this.ecsParameters.filters||{};t.length&&t.forEach((t=>{e[t]&&delete e[t]}));const i=Object.values(e).filter((e=>void 0!==e||null!==e));i.length&&(n+=`.${i.join(".")}`);break}case c.F4.None:}const a=`${n}.metadata`;return this.logger.debug(`Storage Keys calculated: ${n}, ${a}`),{configKey:n,metadataKey:a}}clearCache(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this.data=void 0,void 0===this.cache)return;const{configKey:e,metadataKey:t}=this.generateCacheKeys();yield this.cache.storage.removeItem(e),yield this.cache.storage.removeItem(t),this.logger.log(`Cache for '${e}' and ${t} cleared.`)}))}}var d=i(974509),u=i(275742);const m="EcsClientWeb",g=(e,t,i,n)=>Promise.resolve({constructRequest:(t,a,s)=>({apiName:"getConfiguration",url:e,method:"GET",headers:Object.assign(Object.assign(Object.assign({},i),n),s?{"If-None-Match":s}:void 0),correlationId:t}),customTelemetry:p,transformResponse:v(t),allowedResponses:[d.qb.OK,d.qb.NOT_MODIFIED,d.qb.CREATED,d.qb.NO_CONTENT]});function h(e,t,i){const n=function(e){return`${e.domain}/config/v1/${e.client}/`}(e),a=function(e){const t=[];if((0,u.forOwn)(e.filters,((e,i)=>{e&&t.push(`${i}=${e}`)})),e.agents){const i=e.agents.join(",");t.push(`agents=${i}`)}return`${e.version}?${t.join("&")}`}(e),s=function(e){const t=e.client,i=e.version;return{"X-ECS-Client-Last-Telemetry-Events":`ecs_client_library_name=${m},ecs_client_app_name=${t},ecs_client_version=${i}`}}(e);return{endpointUrl:`${n}${a}`,endpointModels:()=>({baseUrl:n,serviceName:t,models:{getConfigurationAsync:g(a,i,s,e.additionalHeaders)}})}}function p(e,t,i){return JSON.stringify({correlationId:e,serviceName:t,eTag:i,initialFetch:void 0===i})}const v=e=>t=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var i,n;switch(e.debug(`Response headers: ${JSON.stringify(t.headers)}`),t.status){case d.qb.OK:{const e=yield t.body.json(),a=null!==(i=t.headers.expires)&&void 0!==i?i:e.Headers.Expires,s=null!==(n=t.headers.etag)&&void 0!==n?n:e.Headers.ETag;return{requestStatus:r.m.Success,ecsConfiguration:e,headers:f(a,s)}}case d.qb.NOT_MODIFIED:case d.qb.CREATED:case d.qb.NO_CONTENT:return{requestStatus:r.m.Success_NoChanges,headers:f(t.headers.expires,t.headers.etag)};default:throw new Error(`Response status ${t.status} unexpectedly allowed`)}})),f=(e,t)=>{let i=Date.parse(e);if(isNaN(i)){const t=e.match(/\d+/g);if(t&&1===t.length&&(i=Number.parseInt(e,10)),isNaN(i))throw new Error(`Invalid or missing expiration date: '${e}'`)}if(!t)throw new Error("Missing etag value");return{ETag:t,Expires:new Date(i)}};class b extends l{constructor(e,t,i,n,a,s,r){super(e,i,t),this.ecsParameters=t,this.endpointsManager=n,this.fetchPrecheck=a,this.transformData=s,this.fetchMode=o.z.Manual,this.clientType="EcsClient";const{endpointUrl:c,endpointModels:l}=h(this.ecsParameters,this.serviceName,this.logger);this.fetchUrl=c,this.ecsApi=this.endpointsManager.createApi(l),r&&(this.data=r.data,this.cache=r.cache)}fetch(){var e,t;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i=void 0===this.eTag,n=(0,s.v4)();this.lastAttemptedFetch=new Date,this.logger.log(`Getting ECS configuration from ${this.fetchUrl}. correlationId=${n}, isInitialFetch=${i}`);const a=(null===(e=this.fetchPrecheck)||void 0===e?void 0:e.call(this))||!0;if(!0!==a)return this.scheduleNextConfigurationFetch(),this.logger.debug(`${a.errorMessage}. correlationId=${n}`),{requestStatus:a.requestStatus};try{const e=yield this.ecsApi.getConfigurationAsync(n,this.serviceName,this.eTag);this.logger.log(`ECS configuration fetch complete. status=${r.m[e.requestStatus]}, correlationId=${n}, isInitialFetch=${i}`),this.data=this.onSuccess(e,n),this.configIds=null===(t=e.ecsConfiguration)||void 0===t?void 0:t.ConfigIDs,this.updateCache()}catch(e){return this.onError(e,n)}return this.scheduleNextConfigurationFetch(),this.data}))}startFetchSchedule(e,t){this.host=e,this.callbackFunction=t,this.fetchMode=o.z.WhenExpired,this.logger.debug("Starting ECS configuration fetch schedule in WhenExpired mode."),this.scheduleNextConfigurationFetch()}updateParameters(e){const t=this.fetchUrl,{endpointUrl:i,endpointModels:n}=h(e,this.serviceName,this.logger);return this.fetchUrl=i,this.ecsApi=this.endpointsManager.createApi(n),this.ecsParameters=e,t!==this.fetchUrl}dispose(){this.fetchMode=o.z.Manual,this.clearConfigurationFetchSchedule()}getDiagnosticInfo(){return{configIds:this.configIds,etag:this.eTag,fetchUrl:this.fetchUrl,lastAttemptedFetch:this.lastAttemptedFetch,lastSuccessfulFetch:this.lastSuccessfulFetch,nextScheduledFetch:this.nextScheduledFetch,fetchMode:this.fetchMode,expirationTime:this.expiration}}get eTag(){var e,t;return null===(t=null===(e=this.data)||void 0===e?void 0:e.headers)||void 0===t?void 0:t.ETag}updateCache(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(void 0===this.cache)return;const{storage:t}=this.cache,{configKey:i,metadataKey:a}=this.generateCacheKeys();if(!(null===(e=this.data)||void 0===e?void 0:e.ecsConfiguration)||0===Object.keys(this.data.ecsConfiguration).length)return void this.logger.log(`updateCache() received empty data. Cache State: ${c.Hw[this.cacheState]} (Storage key: ${i})`);const s=this.data,{ecsConfiguration:o}=s,r=(0,n.__rest)(s,["ecsConfiguration"]);yield t.setItem(i,JSON.stringify(o)),yield t.setItem(a,JSON.stringify(r)),this.logger.log(`Cache '${i}' updated.`)}))}onSuccess(e,t){var i;let n;switch(e.requestStatus){case r.m.Success:if(!e.ecsConfiguration)throw new Error("ECS configuration is unexpectedly undefined on a successful response");if(!e.headers)throw new Error("Headers object is unexpectedly undefined on a successful response");n=(null===(i=this.transformData)||void 0===i?void 0:i.call(this,e))||e;break;case r.m.Success_NoChanges:if(!e.headers)throw new Error("Headers object is unexpectedly undefined on a successful response");n=Object.assign(Object.assign({},this.data),{requestStatus:e.requestStatus,headers:e.headers}),this.data=n,this.updateCache(),this.logger.debug(`ECS configuration is unchanged. eTag=${this.eTag}, correlationId=${t}`);break;default:throw new Error(`Received unexpected request status of ${r.m[e.requestStatus]}`)}return this.lastSuccessfulFetch=this.lastAttemptedFetch,n}onError(e,t){var i,n;const s=this.processErrorText(e,"unknown error");let o=r.m.Error_Unknown;switch(e.reason){case a.A.TimedOut:o=r.m.Error_TimedOut;break;case a.A.TransformFailed:o=r.m.Error_TransformFailed;break;default:o=(null==e?void 0:e.reason)===a.A.RejectHttpError&&void 0===(null===(i=null==e?void 0:e.serverResponse)||void 0===i?void 0:i.status)?r.m.Error_BrowserError:r.m.Error_Unknown}return this.logger.error(`Fetching ECS configuration failed. error=${e}, innerExceptionMessage=${null===(n=e.innerException)||void 0===n?void 0:n.message} correlationId=${t}`),{requestStatus:o,errorMessage:s}}processErrorText(e,t){var i;let n=t;return e&&(n=(null===(i=Object.keys(e))||void 0===i?void 0:i.length)>0?JSON.stringify(e):e.message,e.innerException&&(n+=` innerExceptionMessage: ${e.innerException.message}`)),n}clearConfigurationFetchSchedule(){this.setTimeoutHandle&&this.host&&(this.host.clearTimeout(this.setTimeoutHandle),this.setTimeoutHandle=void 0,this.logger.debug("Cleared existing queued configuration fetch"))}scheduleNextConfigurationFetch(){if(this.clearConfigurationFetchSchedule(),this.fetchMode===o.z.Manual)return void this.logger.debug("No need to queue configuration fetch in manual mode, ignoring...");if(!this.host)return void this.logger.error("No host provided, cannot schedule next configuration fetch");const e=this.calculateFetchInterval();this.setTimeoutHandle=this.host.setTimeout((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.fetch();this.callbackFunction&&this.callbackFunction(e)}))),e),this.nextScheduledFetch=new Date(Date.now()+e),this.logger.debug(`Next ECS configuration fetch will occur in ${e}ms at ${this.nextScheduledFetch}`)}calculateFetchInterval(){var e;if(this.fetchMode===o.z.Manual)throw new Error(`Calculating fetch interval is not supported when using ${o.z[this.fetchMode]} fetch mode.`);const t=(null!==(e=this.expiration)&&void 0!==e?e:new Date).valueOf()-Date.now();return t<b.MinimumRefreshIntervalInMilliseconds?(this.logger.warn(`Calculated refresh interval of ${t}ms based on expires header was below the allowed minimum of ${b.MinimumRefreshIntervalInMilliseconds}ms. Minimum value will be used instead.`),b.MinimumRefreshIntervalInMilliseconds):t}}b.MinimumRefreshIntervalInMilliseconds=18e5;class y extends l{constructor(){super(...arguments),this.clientType="LocalEcsClient"}createClient({ecsParameters:e,endpointsManager:t,loggerFactory:i,fetchPrecheck:n,transformData:a}){const s={data:this.data,cache:this.cache};return new b(this.serviceName,e,i,t,n,a,s)}}function k({serviceName:e,cacheOptions:t,loggerFactory:i}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=new y(e,i);return yield n.initializeCache(t),n}))}function S({serviceName:e,ecsParameters:t,loggerFactory:i,endpointsManager:n,fetchPrecheck:a,transformData:s}){return new b(e,t,i,n,a,s)}function w({serviceName:e,ecsParameters:t,cacheOptions:i,loggerFactory:a,endpointsManager:s,fetchPrecheck:o,transformData:r}){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=new b(e,t,a,s,o,r);return yield n.initializeCache(i),n}))}},388522:(e,t,i)=>{"use strict";var n,a,s;i.d(t,{Jv:()=>n,OP:()=>a,cw:()=>s}),function(e){e.NotInstalled="NotInstalled",e.InstalledNotActive="InstalledNotActive",e.InstalledActive="InstalledActive"}(n||(n={})),function(e){e.Teams1="Teams1",e.Teams2="Teams2"}(a||(a={})),function(e){e.DownloadedAndInstalled="DownloadedAndInstalled",e.FailedToDownload="FailedToDownload",e.FailedToInstall="FailedToInstall",e.DownloadPageOpened="DownloadPageOpened"}(s||(s={}))},660378:(e,t,i)=>{"use strict";var n,a,s,o,r,c,l,d,u;i.d(t,{tq:()=>n,dt:()=>a,S1:()=>s,A$:()=>o,p6:()=>r,G5:()=>c,oY:()=>d}),function(e){e.toastFromWeb="toastFromWeb",e.toastFromHost="toastFromHost"}(n||(n={})),function(e){e.calls="calls",e.chats="chats",e.toasts="toasts",e.signout="signout",e.extensions="extensions",e.reminders="reminders",e.channels="channels",e.activity="activity",e.campaignnotifications="campaignnotifications",e.communities="communities",e.callingdeeplink="callingdeeplink",e.communitiesevents="communitiesevents",e.settingsstore="settingsstore",e.communitiesjoinrequest="communitiesjoinrequest",e.communitiesmembers="communitiesmembers"}(a||(a={})),function(e){e.hide="hide",e.show="show"}(s||(s={})),function(e){e.mutate="mutate",e.view="view",e.list="list",e.join="join"}(o||(o={})),function(e){e.success="success",e.critical="critical"}(r||(r={})),function(e){e.start="start",e.quit="quit",e.restart="restart"}(c||(c={})),function(e){e.airgap08="airgap08",e.prod="prod",e.life="life",e.dod="dod",e.gcch="gcch",e.gallatin="gallatin",e.airgap09="airgap09"}(l||(l={})),function(e){e.available="available",e.busy="busy",e.doNotDisturb="doNotDisturb",e.beRightBack="beRightBack",e.away="away",e.offLine="offLine",e.resetAvailability="resetAvailability"}(d||(d={})),function(e){e.inProc="inProc",e.outOfProc="outOfProc"}(u||(u={}))},665380:(e,t,i)=>{"use strict";var n,a,s;i.d(t,{$y:()=>n,f8:()=>a}),function(e){e.Locked="Locked",e.Unlocked="Unlocked",e.Unknown="Unknown",e.Resumed="Resumed",e.Suspending="Suspending"}(n||(n={})),function(e){e.Light="Light",e.Dark="Dark",e.Contrast="Contrast",e.OSTheme="OSTheme"}(a||(a={})),function(e){e.Internal="Internal",e.Clone="Clone",e.Extend="Extend",e.External="External"}(s||(s={}))},749531:(e,t,i)=>{"use strict";var n;i.d(t,{t:()=>n}),function(e){e.activity="activity",e.alarm="alarm",e.alert="alert",e.attention="attention",e.busy="busy",e.error="error",e.oofDoNotDisturb="oofDoNotDisturb",e.oofAvailable="oofAvailable",e.oofAway="oofAway",e.oofBusy="oofBusy",e.oofOffline="oofOffline",e.oofUnknown="oofUnknown",e.available="available",e.away="away",e.doNotDisturb="doNotDisturb",e.offline="offline",e.unknown="unknown"}(n||(n={}))},839856:(e,t,i)=>{"use strict";var n,a,s,o;i.d(t,{GV:()=>a,bT:()=>o}),function(e){e.Unknown="Unknown",e.Persistent="Persistent",e.NonPersistent="NonPersistent"}(n||(n={})),function(e){e.None="None",e.Citrix="Citrix",e.VMware="VMware",e.AVD="AVD",e.Windows365="Windows365"}(a||(a={})),function(e){e.Unknown="Unknown",e.Dedicated="Dedicated",e.Shared="Shared"}(s||(s={})),function(e){e.none="none",e.webrtc="webrtc",e.slimcore="slimcore"}(o||(o={}))},257558:(e,t,i)=>{"use strict";var n,a,s,o,r,c,l;i.d(t,{px:()=>n,i$:()=>o}),function(e){e.None="None",e.Core="Core",e.MeetNow="MeetNow",e.Loading="Loading",e.Main="Main",e.Mini="Mini",e.ChatPopout="ChatPopout",e.Meeting="Meeting",e.Presenter="Presenter"}(n||(n={})),function(e){e.MouseEnter="MouseEnter",e.MouseLeave="MouseLeave",e.Click="Click"}(a||(a={})),function(e){e.Text="Text",e.Pointer="Pointer"}(s||(s={})),function(e){e.ButtonsOnly="ButtonsOnly",e.FullWidth="FullWidth"}(o||(o={})),function(e){e.TopLeft="TopLeft",e.TopRight="TopRight",e.BottomLeft="BottomLeft",e.BottomRight="BottomRight"}(r||(r={})),function(e){e.Hidden="Hidden",e.Visible="Visible",e.Disabled="Disabled"}(c||(c={})),function(e){e.Rectangle="Rectangle"}(l||(l={}))},37117:(e,t,i)=>{"use strict";var n;i.d(t,{$:()=>n}),function(e){e.None="none",e.DayStart="dayStart",e.MeetingPrep="meetingPrep",e.MeetingStart="meetingStart",e.MeetingStarted="meetingStarted",e.MeetingEnd="meetingEnd",e.Feedback="feedback",e.InMeetingActionStatusUpdated="inMeetingActionStatusUpdated",e.InMeetingGreeting="inMeetingGreeting",e.InMeetingShareFile="inMeetingShareFile",e.RunningLate="inMeetingRunningLate",e.ReportUsage="reportUsage"}(n||(n={}))},113851:(e,t,i)=>{"use strict";i.d(t,{h:()=>n});class n{constructor(){}static getInstance(){return this.platformAppConversationService||(this.platformAppConversationService=new n),this.platformAppConversationService}setSubEntityDeepLinkInfo(e){this.deepLink=e}getSubEntityDeepLinkInfo(){return this.deepLink}setClientMessageId(e){this.clientMessageId=e}getClientMessageId(){return this.clientMessageId}}},891822:(e,t,i)=>{"use strict";i.d(t,{r_:()=>s,Sb:()=>o,gt:()=>r,eS:()=>c,JW:()=>l,Qs:()=>d,ZD:()=>u,nf:()=>m,z$:()=>g});var n=i(50805),a=i(594827);const s=e=>"string"==typeof e&&a.zV.indexOf(e)>-1,o=e=>e&&0!==e.length?e[0].toLowerCase()+e.substring(1):e,r=()=>{const e={};return null===a.KB||void 0===a.KB||a.KB.forEach((t=>{const i=t.split("-");2===i.length&&(e[i[1]]=i[0])})),e},c=()=>{const e={};return null===a.KB||void 0===a.KB||a.KB.forEach((t=>{const i=t.split("-");2===i.length&&(e[i[0]]=i[1])})),e},l=e=>{const t=[],i=[],n=Array.from(a.$6).concat(Array.from(a.OL)),s=new Set(null!=n?n:[]);return e.forEach((e=>{s.has(e)?i.push(e):t.push(e)})),{policiesNamespaces:t,settingsNamespaces:i}},d=e=>{if(!e)return e;const t=c();Object.keys(t).forEach((i=>{const n=t[i];e[i]&&!e[n]&&(e[n]=e[i]),e[n]&&!e[i]&&(e[i]=e[n])}));const i={};u().forEach((t=>{e[t]&&(i[t]=e[t])}));const n=Object.assign(Object.assign({},e.policySettings),i);return Object.keys(n).length>0&&(e.policySettings=n),e},u=()=>["byot","callingLineIdentityPolicy","clientPolicy","dialPlanPolicy","locationPolicy","teamsInteropPolicy","teamsMeetingPolicy","voicePolicy"],m=(e,t,i)=>{var n,a,s;if("userPropertiesSettings"===e){const o=t,r=(null==o?void 0:o.isOnCloud)?["rest","substrate"]:["ews"];for(const t of r)if("TaskTimedOut"===(null===(s=null===(a=null===(n=null==o?void 0:o.autodiscoverSettings)||void 0===n?void 0:n[t])||void 0===a?void 0:a.mailboxDiscoverabilityError)||void 0===s?void 0:s.errorCode)){i[e]="TaskTimedOut";break}}},g=(e,t,i)=>{var a,s,o;const r=null!==(a=e("policies").namespaces)&&void 0!==a?a:[],c=null!==(s=t.get(n.J.Core,["unsupportedPoliciesNamespaces"]).unsupportedPoliciesNamespaces)&&void 0!==s?s:[];if(0===c.length)return r;const l=r.filter((e=>c.includes(e)));return l.length>0&&(null===(o=i.infoToTelemetry)||void 0===o||o.call(i,JSON.stringify({skippedUnsupportedNamespaces:l}),"policies_skipped_unsupported_namespaces",void 0,!0)),r.filter((e=>!c.includes(e)))}},594827:(e,t,i)=>{"use strict";i.d(t,{$6:()=>n,OL:()=>a,Ao:()=>s,KB:()=>o,zV:()=>r});const n=["adminSettings","clientSettings","educationSettings","organizationSettings","tenantProperties","tenantSettingsV2","tenantSiteUrl","tenantVoiceSettings","userPropertiesSettings","userResourcesSettings","voiceAdminSettings","teamsMessagingConfiguration","teamsLinkPolicy"],a=["ageConsentPolicy"],s=["branchSurvivabilityPolicy","broadcastMeetingPolicy","callingLineIdentityPolicy","callingPolicy","callParkPolicy","dialPlanPolicy","educationAssignmentsAppPolicy","feedbackPolicy","filesPolicy","meetingPolicy","messagingPolicy","policySettings","shiftsPolicy","syntheticAutomatedCallPolicy","targetingPolicy","teamsAndChannelsPolicy","updateManagementPolicy","upgradePolicy","vdiPolicy","voicemailPolicy","byot","callingLineIdentity","clientPolicy","externalAccessPolicy","locationPolicy","onlineDialinConferencingPolicy","onlineVoicemailPolicy","onlineVoiceRoutingPolicy","teamsBranchSurvivabilityPolicy","teamsCallingPolicy","teamsCallParkPolicy","teamsChannelsPolicy","teamsEducationAssignmentsAppPolicy","teamsEmergencyCallingPolicy","teamsEmergencyCallRoutingPolicy","teamsEnhancedEncryptionPolicy","teamsEventsPolicy","teamsFeedbackPolicy","teamsFilesPolicy","teamsInteropPolicy","teamsMediaLoggingPolicy","teamsMeetingBrandingPolicy","teamsMeetingBroadcastPolicy","teamsMeetingPolicy","teamsMessagingPolicy","teamsRoomVideoTeleConferencingPolicy","teamsShiftsPolicy","teamsSyntheticAutomatedCallPolicy","teamsTargetingPolicy","teamsUpdateManagementPolicy","teamsUpgradePolicy","teamsVdiPolicy","teamsVoiceApplicationsPolicy","tenantDialPlan","voicePolicy","teamsVirtualAppointmentsPolicy","teamsAppPermissionPolicy","teamsAppSetupPolicy"],o=["callingLineIdentity-callingLineIdentityPolicy","onlineVoicemailPolicy-voicemailPolicy","teamsBranchSurvivabilityPolicy-branchSurvivabilityPolicy","teamsCallingPolicy-callingPolicy","teamsCallParkPolicy-callParkPolicy","teamsChannelsPolicy-teamsAndChannelsPolicy","teamsEducationAssignmentsAppPolicy-educationAssignmentsAppPolicy","teamsFeedbackPolicy-feedbackPolicy","teamsFilesPolicy-filesPolicy","teamsMeetingBroadcastPolicy-broadcastMeetingPolicy","teamsMeetingPolicy-meetingPolicy","teamsMessagingPolicy-messagingPolicy","teamsShiftsPolicy-shiftsPolicy","teamsSyntheticAutomatedCallPolicy-syntheticAutomatedCallPolicy","teamsTargetingPolicy-targetingPolicy","teamsUpdateManagementPolicy-updateManagementPolicy","teamsUpgradePolicy-upgradePolicy","teamsVdiPolicy-vdiPolicy","tenantDialPlan-dialPlanPolicy"],r=Array.from(n).concat(Array.from(a)).concat(Array.from(s))},342097:(e,t,i)=>{"use strict";i.d(t,{vc:()=>n,Bd:()=>a,d5:()=>s});const n={EmptyEvent:"EmptyEvent",NotEnabled:"NotEnabled",RequiredFieldMissing:"RequiredFieldMissing",SubscriptionFailed:"SubscriptionFailed",MethodNotAvailable:"showBadge not available on taskbar module.",ModuleUnableToLoad:"HostComms is unable to load taskbar module. We are running on Web or Teams 1.0. Bailing out."},a={ModuleLoaded:"HostComms has loaded taskbar module. Setting badge.",UpdatedEvent:"Updated Taskbar Badge Count:"},s="TaskbarService"},699532:(e,t,i)=>{"use strict";i.d(t,{K:()=>_e});var n=i(516909),a=i(486070),s=i(8122),o=i(974509),r=i(844729),c=i(299295),l=i(850402),d=i(145279),u=i(223005),m=i(89062),g=i(48824);const h={source:"teamsAndChannels"},p=()=>({authOptions:h,apiName:"canCreateTWT",url:"beta/teams/canCreateTWT",method:"GET"}),v=e=>({authOptions:h,apiName:"createTeam",url:"beta/teams/create",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),f=(e,t)=>({authOptions:h,apiName:"editTeam",url:`beta/teams/${e}`,method:"PATCH",body:JSON.stringify(t),headers:{"content-type":"application/json"}}),b=(e,t,i)=>({apiName:"profilepicture",url:`beta/teams/${e}/profilepicture?threadId=${t}`,method:"POST",body:i,headers:{"content-type":"application/json"}}),y=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){if(e.status===o.qb.OK)return!0;throw new Error(`Request to server failed with ${null==e?void 0:e.status} request url: ${null==e?void 0:e.url}`)})),k=e=>({apiName:"defaultProfilePicture",url:`beta/teams/defaultProfilePicture?displayName=${e}&highResolution=true`,method:"GET",headers:{"content-type":"application/json"}}),S=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){if(e.status===o.qb.OK&&(null==e?void 0:e.body)){const t=yield e.body.blob();return(yield(0,g.n)(t))||""}throw(0,d.T)(u.A.TransformFailed,e)})),w=e=>({authOptions:h,apiName:"findJoinRequests",url:"beta/teams/findJoinRequests",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),j=e=>({authOptions:h,apiName:"getChannelEmailSettingsRequest",url:`beta/channels/${e}/email`,method:"GET",headers:{"content-type":"application/json"}}),C=e=>({apiName:"migrateGroupToTeam",url:`beta/teams/migrateGroup/${encodeURIComponent(e.groupId)}`,body:(0,m.u4)(Object.assign(Object.assign({},e),{teamType:Object.keys(n.C9I).indexOf(e.teamType)})),method:"PUT",headers:{"content-type":"application/json"}}),_=e=>({apiName:"myGroupMemberships",url:`beta/teams/usergroups?teamType=${e}`,method:"GET",headers:{"content-type":"application/json"}}),T=(e,t)=>({authOptions:h,apiName:"createChannelEmailSettingsRequest",url:`beta/channels/${e}/email`,body:JSON.stringify(t),method:"POST",headers:{"content-type":"application/json"}}),I=(e,t)=>({authOptions:h,apiName:"updateChannelEmailSettingsRequest",url:`beta/channels/${e}/email`,body:JSON.stringify(t),method:"PUT",headers:{"content-type":"application/json"}}),N=e=>({authOptions:h,apiName:"removeChannelEmailSettingsRequest",url:`beta/channels/${e}/email`,method:"DELETE",headers:{"content-type":"application/json"}}),E=(e,t)=>({authOptions:h,apiName:"handleBulkJoinRequests",url:`beta/teams/bulkJoinRequestAdminAction?silentAction=${t}`,method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),F=(e,t)=>({authOptions:h,apiName:"handleJoinRequest",url:`beta/teams/joinRequestAdminAction?silentAction=${t}`,method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),x=(e,t,i)=>({authOptions:h,apiName:"leaveChannel",url:`beta/teams/${e}/channels/${t}/members/${i}`,method:"DELETE",headers:{"content-type":"application/json"}}),D=e=>({authOptions:h,apiName:"userGroupSettings",url:"beta/users/groupsSettings",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),A=e=>({authOptions:h,apiName:"groupSettings",url:`beta/teams/${e}/groupSettings`,method:"GET"}),M=e=>({authOptions:h,apiName:"setFavoritedTimeForStaleTeams",url:"beta/users/setFavoriteTime",body:JSON.stringify(e),method:"PUT",headers:{"content-type":"application/json"}}),P=(e,t,i)=>({authOptions:h,apiName:"removePrivateChannelMembership",url:`beta/teams/${e}/channels/${t}/members/${i}`,method:"DELETE",headers:{"content-type":"application/json"}}),O=(e,t)=>({authOptions:h,apiName:"restoreChannel",url:`beta/teams/${encodeURIComponent(e)}/channels/${encodeURIComponent(t)}/restore`,method:"PATCH"}),R=(e,t,i)=>({authOptions:h,apiName:"deleteChannel",url:`beta/teams/${encodeURIComponent(e)}/channels/${encodeURIComponent(t)}`,method:"DELETE",body:JSON.stringify(i),headers:{"content-type":"application/json"}}),L=e=>({authOptions:h,apiName:"getSensitivityLabels",url:`beta/users/sensitivityLabels?includeUnscopedLabels=${e}`,method:"GET"}),U=()=>({authOptions:h,apiName:"getSensitivityPolicySettings",url:"beta/users/sensitivityPolicySettings",method:"GET"}),$=(e,t)=>({authOptions:h,apiName:"sponsorJoinRequest",url:`beta/teams/sponsorJoinRequest/${e}`,method:"POST",body:JSON.stringify(t),headers:{"content-type":"application/json"}}),W=e=>e.body.json().then((e=>{var t,i;if(null==e?void 0:e.value)return Object.assign(Object.assign({},e.value),{groupId:null===(i=null===(t=e.value)||void 0===t?void 0:t.siteInfo)||void 0===i?void 0:i.groupId})})).catch((()=>{throw(0,d.T)(u.A.TransformFailed,e)})),B=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield e.body.json();if(t&&t.joinRequestsPerTeam){const e=t.joinRequestsPerTeam,i=Object.keys(e),n=[];for(const t of i)if(e[t])for(const i of e[t])i.teamId=t,n.push(i);return t.joinRequestsPerTeam=n,t}})),z=e=>({authOptions:h,apiName:"validateTeamName",url:"beta/teams/validateNaming",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),H=e=>({authOptions:h,apiName:"allChannels",url:`beta/teams/${e}/allchannels`,method:"PUT",body:JSON.stringify({Channels:[{Type:"standard",State:["deleted"]},{Type:"private",State:["deleted"]},{Type:"shared",State:["deleted"]}]}),headers:{"content-type":"application/json"}}),q=e=>({authOptions:h,apiName:"allChannels",url:`beta/teams/${e}/allchannels`,method:"PUT",body:JSON.stringify({Channels:[{Type:"standard",State:["archived"]},{Type:"private",State:["archived"]},{Type:"shared",State:["archived"]}]}),headers:{"content-type":"application/json"}}),V=(e,t)=>({authOptions:h,apiName:"updateTeamMembership",url:`beta/teams/${encodeURIComponent(e)}/members`,method:"PUT",body:JSON.stringify(t),headers:{"content-type":"application/json"}}),G=(e,t,i,n)=>({authOptions:h,apiName:"updateTeamMembership",url:`beta/teams/${e}/members`,method:"PUT",body:JSON.stringify({groupId:t,userMri:i,updateType:n}),headers:{"content-type":"application/json"}}),J=(e,t,i,n)=>({authOptions:h,apiName:"updatePrivateChannelMembership",url:`beta/teams/${e}/channels/${t}/members/${i}`,method:"PATCH",body:JSON.stringify({mri:i,role:n}),headers:{"content-type":"application/json"}}),K=e=>({authOptions:h,apiName:"resetTeamJoinCode",url:`beta/teams/${e}/joinCode`,method:"PUT",headers:{"content-type":"application/json"}}),Q=e=>({authOptions:h,apiName:"removeTeamJoinCode",url:`beta/teams/${e}/joinCode`,method:"DELETE",headers:{"content-type":"application/json"}}),Y=e=>({authOptions:h,apiName:"renewTeam",url:`beta/teams/${e}/renew`,method:"POST"}),X=(e,t)=>({authOptions:h,apiName:"updateTeamDiscoverability",url:`beta/teams/${e}/discoverable`,method:"PUT",body:JSON.stringify(t)}),Z=e=>({authOptions:h,apiName:"getRecommendedTeams",url:`beta/teams/suggested?accessType=${e}&enableFallback=true`,method:"GET"}),ee=e=>({authOptions:h,apiName:"joinTeamById",url:`beta/teams/joinRequest/${e}`,method:"POST",headers:{"content-type":"application/json"}}),te=(e,t,i)=>({authOptions:h,apiName:"searchRecommendedTeams",url:`beta/teams/find?keywords=${encodeURIComponent(t)}&accessType=${e}&enableKeywordSearch=false&top=100&skipToken=${encodeURIComponent(i||"")}`,method:"GET"}),ie=e=>({authOptions:h,apiName:"joinTeamWithCode",url:"beta/teams/joinByCode",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),ne=e=>({authOptions:h,apiName:"cancelJoinRequest",url:`beta/teams/cancelJoinRequest/${e}`,method:"POST",headers:{"content-type":"application/json"}}),ae=e=>({authOptions:h,apiName:"deleteTeam",url:`beta/teams/${encodeURIComponent(e)}/delete`,method:"DELETE",headers:{"content-type":"application/json"}}),se=e=>({authOptions:h,apiName:"archiveTeam",url:`beta/teams/${encodeURIComponent(e)}/archive`,method:"POST",headers:{"content-type":"application/json"}}),oe=(e,t)=>({authOptions:h,apiName:"unarchiveChannel",url:`beta/teams/${encodeURIComponent(e)}/channels/${t}/unarchive`,method:"POST",headers:{"content-type":"application/json"}}),re=(e,t)=>({authOptions:h,apiName:"archiveChannel",url:`beta/teams/${encodeURIComponent(e)}/channels/${t}/archive`,method:"POST",headers:{"content-type":"application/json"}}),ce=e=>({authOptions:h,apiName:"unarchiveTeam",url:`beta/teams/${encodeURIComponent(e)}/unarchive`,method:"POST",headers:{"content-type":"application/json"}}),le=(e,t)=>({authOptions:h,apiName:"setChannelShowForMember",url:`beta/teams/${e}/setDefaultChannel`,method:t?"PUT":"DELETE",headers:{"content-type":"application/json"}}),de=(e,t)=>({authOptions:h,apiName:"createChannel",url:`beta/teams/${e}/channels`,method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)}),ue=e=>(0,l.__awaiter)(void 0,void 0,void 0,(function*(){return e.body.json().then((e=>({id:e.value.objectId}))).catch((()=>{throw(0,d.T)(u.A.TransformFailed,e)}))})),me=(e,t,i)=>({apiName:"updateChannel",url:`beta/teams/${encodeURIComponent(e)}/channels/${encodeURIComponent(t)}`,method:"PATCH",headers:{"content-type":"application/json"},body:JSON.stringify(i)}),ge=(e,t,i,n)=>{const a={users:i,groupId:t},s=n?"?allowBotsInChannel=true":"";return{authOptions:h,method:"PUT",url:`beta/teams/${encodeURIComponent(e)}/bulkUpdateRoledMembers${s}`,body:(0,m.XC)(a),headers:{"content-type":"application/json"}}},he=(e,t,i)=>{const n={value:i};return{authOptions:h,method:"PUT",url:`beta/teams/${encodeURIComponent(e)}/channels/${encodeURIComponent(t)}/members`,body:(0,m.XC)(n),headers:{"content-type":"application/json"}}},pe=(e,t)=>{const i=t.map((e=>e.mri));return{authOptions:h,method:"POST",url:`beta/teams/sponsorJoinRequest/${encodeURIComponent(e)}`,body:(0,m.XC)(i),headers:{"content-type":"application/json"}}},ve=e=>({authOptions:h,apiName:"getTeamInfo",url:`beta/teams/getTeamInfo?groupId=${e}`,method:"GET",headers:{"content-type":"application/json"}}),fe=(e,t,i)=>{const n=Object.assign(Object.assign({},i),{userType:"Guest"});return{apiName:"inviteAndAddGuest",url:`beta/teams/${encodeURIComponent(e)}/${t}/inviteAndAddGuest`,method:"PUT",headers:{"content-type":"application/json"},body:(0,m.u4)(n)}},be=(e,t,i,n,a)=>{const s={type:e.toLowerCase(),containerId:t,groupId:i,itemId:n,allowXtenantAccess:a};return{authOptions:h,apiName:"deeplink",url:"beta/deeplink",method:"POST",body:JSON.stringify(s),headers:{"content-type":"application/json"}}},ye=(e,t)=>({apiName:"cloneTeam",url:`beta/teams/${encodeURIComponent(e)}/clone`,method:"POST",headers:{"content-type":"application/json"},body:(0,m.u4)(Object.assign(Object.assign({},t),{accessType:Object.keys(n.eUH).indexOf(t.accessType.toString())}))}),ke=e=>({apiName:"templateProvisioningStatus",url:`beta/teams/${encodeURIComponent(e)}/templateProvisioningStatus`,method:"GET",headers:{"content-type":"application/json"}}),Se=e=>{const{authenticationResources:t,discover:i,platformService:n,config:o}=e,l=(0,r.h)(n,o),d=(0,c.g)(we,l),u=(0,c.g)(je,l);return{baseUrlPromise:()=>i.regionGtm(a.Pn.middleTier),serviceName:s.E.MiddleTier,authResource:t.mtAuthWithSkypeXTokenResource,models:{canCreateTWT:d(p),createTeam:d(v).withTransform(W),deletedChannels:d(H),archivedChannels:d(q),editTeam:d(f),changeTeamPicture:d(b).withTransform(y),getDefaultTeamPicture:d(k).withTransform(S),findJoinRequests:d(w).withTransform(B),getChannelEmailSettings:u(j),migrateGroupToTeam:d(C),myGroupMemberships:d(_),createChannelEmailSettings:u(T),updateChannelEmailSettings:u(I),removeChannelEmailSettings:u(N),handleBulkJoinRequests:d(E),handleJoinRequest:d(F),leaveChannel:d(x),groupSettings:d(A),myGroupSettings:d(D),removePrivateChannelMembership:d(P),setFavoritedTimeForStaleTeams:d(M),restoreChannel:d(O),deleteChannel:d(R),editChannel:d(me),sensitivityLabels:d(L),sensitivityPolicySettings:d(U),sponsorJoinRequest:d($),updatePrivateChannelMembership:d(J),updateTeamMembership:d(G),validateTeamName:d(z),removeTeamMembership:d(V),resetTeamJoinCode:d(K),removeTeamJoinCode:d(Q),renewTeam:d(Y),updateTeamDiscoverability:d(X),getRecommendedTeams:d(Z),joinTeamById:d(ee),searchRecommendedTeams:d(te),joinTeamWithCode:d(ie),cancelJoinRequest:d(ne),archiveTeamRequest:d(se),unarchiveTeamRequest:d(ce),archiveChannelRequest:d(re),unarchiveChannelRequest:d(oe),deleteTeamRequest:d(ae),leaveTeamRequest:je(V),setChannelShowForMember:d(le),createChannel:d(de).withTransform(ue),addBulkMembersToTeam:d(ge),addBulkMembersToPrivateChannel:d(he),requestToAddMembersToTeam:d(pe),getTeamByGroupId:d(ve),inviteAndAddGuestToTeam:je(fe),teamsAndChannelsPageDeepLinkUrl:d(be),cloneTeam:d(ye),templateProvisioningStatus:d(ke)}}};function we(e){return Promise.resolve({constructRequest:e,allowedResponses:[o.qj.HTTP_2XX]})}function je(e){return Promise.resolve({constructRequest:e,allowedResponses:[o.qj.HTTP_2XX,o.qj.HTTP_4XX]})}var Ce=i(500396);class _e{constructor(e){this._transport=e.createApi(Se)}canCreateTWT(){return this._transport.canCreateTWT()}createTeam(e){const t=Object.assign(Object.assign({},e),{accessType:this.convertTeamAccessType(e.accessType)});return this._transport.createTeam(t)}deletedChannels(e){return this._transport.deletedChannels(e)}archivedChannels(e){return this._transport.archivedChannels(e)}editTeam(e,t){return this._transport.editTeam(e,t)}changeTeamPicture(e,t,i){return this._transport.changeTeamPicture(e,t,i)}getDefaultTeamPicture(e){return this._transport.getDefaultTeamPicture(e)}findJoinRequests(e){return this._transport.findJoinRequests(e)}getChannelEmailSettings(e){return this._transport.getChannelEmailSettings(e)}createChannelEmailSettings(e,t){return this._transport.createChannelEmailSettings(e,t)}updateChannelEmailSettings(e,t){return this._transport.updateChannelEmailSettings(e,t)}removeChannelEmailSettings(e){return this._transport.removeChannelEmailSettings(e)}handleBulkJoinRequests(e,t){return this._transport.handleBulkJoinRequests(e,t)}handleJoinRequest(e,t){return this._transport.handleJoinRequest(e,t)}leaveChannel(e,t,i){return this._transport.leaveChannel(e,t,i)}setFavoritedTimeForStaleTeams(e){return this._transport.setFavoritedTimeForStaleTeams(e)}removePrivateChannelMembership(e,t,i){return this._transport.removePrivateChannelMembership(e,t,i)}removeTeamMembership(e,t){return this._transport.removeTeamMembership(e,t)}restoreChannel(e,t){return this._transport.restoreChannel(e,t)}deleteChannel(e,t,i){return this._transport.deleteChannel(e,t,i)}myGroupSettings(e){return this._transport.myGroupSettings(e)}groupSettings(e){return this._transport.groupSettings(e)}sensitivityLabels(e=!1){return this._transport.sensitivityLabels(e)}sensitivityPolicySettings(){return this._transport.sensitivityPolicySettings()}sponsorJoinRequest(e,t){return this._transport.sponsorJoinRequest(e,t)}validateTeamName(e){return this._transport.validateTeamName(e)}updateTeamMembership(e,t,i,n){return this._transport.updateTeamMembership(e,t,i,n)}updatePrivateChannelMembership(e,t,i,n){return this._transport.updatePrivateChannelMembership(e,t,i,n)}resetTeamJoinCode(e){return this._transport.resetTeamJoinCode(e)}removeTeamJoinCode(e){return this._transport.removeTeamJoinCode(e)}renewTeam(e){return this._transport.renewTeam(e)}updateTeamDiscoverability(e,t){return this._transport.updateTeamDiscoverability(e,t)}getRecommendedTeams(e){return this._transport.getRecommendedTeams(e)}joinTeamById(e){return this._transport.joinTeamById(e)}searchRecommendedTeams(e,t,i){return this._transport.searchRecommendedTeams(e,t,i)}joinTeamWithCode(e){return this._transport.joinTeamWithCode(e)}cancelJoinRequest(e){return this._transport.cancelJoinRequest(e)}archiveTeamRequest(e){return this._transport.archiveTeamRequest(e)}unarchiveTeamRequest(e){return this._transport.unarchiveTeamRequest(e)}archiveChannelRequest(e,t,i){return this._transport.archiveChannelRequest(e,t,i)}unarchiveChannelRequest(e,t){return this._transport.unarchiveChannelRequest(e,t)}deleteTeamRequest(e){return this._transport.deleteTeamRequest(e)}leaveTeamRequest(e,t){return this._transport.leaveTeamRequest(e,t)}setChannelShowForMember(e,t){return this._transport.setChannelShowForMember(e,t)}myGroupMemberships(e){return this._transport.myGroupMemberships(e)}createChannel(e,t){return this._transport.createChannel(e,t)}editChannel(e,t,i){return this._transport.editChannel(e,t,i)}addBulkMembersToTeam(e,t,i,n){return this._transport.addBulkMembersToTeam(e,t,i,n)}addBulkMembersToPrivateChannel(e,t,i){return this._transport.addBulkMembersToPrivateChannel(e,t,i)}requestToAddMembersToTeam(e,t){return this._transport.requestToAddMembersToTeam(e,t)}migrateGroupToTeam(e){return this._transport.migrateGroupToTeam(e)}getTeamByGroupId(e){return this._transport.getTeamByGroupId(e)}inviteAndAddGuestToTeam(e,t,i){return this._transport.inviteAndAddGuestToTeam(e,t,i)}teamsAndChannelsPageDeepLinkUrl(e,t,i,n,a){return this._transport.teamsAndChannelsPageDeepLinkUrl(e,t,i,n,a)}cloneTeam(e,t){return this._transport.cloneTeam(e,t)}templateProvisioningStatus(e){return this._transport.templateProvisioningStatus(e)}convertTeamAccessType(e){return e===n.eUH.Public?Ce.eU.Public:Ce.eU.Private}}},34564:(e,t,i)=>{"use strict";i.d(t,{j:()=>s});var n=i(340690),a=i(659726);const s=(e,t)=>{var i;try{const n=JSON.parse(t.content);return{url:e,title:n.title&&o(n.title),description:n.text&&o(n.text),thumbnail:n.images&&(null===(i=n.images[0])||void 0===i?void 0:i.url)}}catch(e){throw new Error(`parsing preview content failed with error: ${(0,a.A)(e.message||"")}`)}},o=e=>(new n._).stripHtml(e)||""},805012:(e,t,i)=>{"use strict";i.d(t,{BZ:()=>o});var n=i(765923);const a="isOptedIntoT2Web",s="web_app_switcher_opt_out_redirection_fail";class o{constructor(e,t,i){this.localStorage=e,this.crossTabsService=i,this.logger=t.newLogger("WebAppSwitcherService","services-io-web-app-switcher"),this.logger.log("WebAppSwitcherService initialized")}optOutOfT2Web(e,t){var i,n,a,o;this.crossTabsService?(null===(o=(a=this.logger).warnNoPii)||void 0===o||o.call(a,"Opting user out of T2",e),this.doRedirection(!0,!0,!0,e,t)):null===(n=(i=this.logger).errorToTelemetry)||void 0===n||n.call(i,"Cross tabs service is undefined",s,{commandSource:e},!0)}redirectThisTabToT1(e){this.doRedirection(!1,!1,!1,e)}doRedirection(e,t,i,a,o){var r,c,l,d,u;let m;try{m=this.getT1Url(o)}catch(e){return void(null===(c=(r=this.logger).errorToTelemetry)||void 0===c||c.call(r,"Failed to get T1 url",s,{commandSource:a},!0))}t&&!this.clearOptInFlag(a)||(e&&(null===(l=this.crossTabsService)||void 0===l||l.postMessage("T2WebOptOut")),null===(u=(d=this.logger).warnToTelemetry)||void 0===u||u.call(d,"Redirecting to T1 web","web_app_switcher_opt_out_redirection_success",{endpointUrl:m,commandSource:a},!0),i&&this.localStorage.setSafe("lastT2WebOptOutInfo",JSON.stringify({source:null!=a?a:"Unknown",timestamp:Date.now()}),"Global"),(0,n.J)().location.replace(m))}clearOptInFlag(e){var t,i,n,o,r,c;return this.localStorage.get(a,"Global")?(this.localStorage.remove(a,"Global"),this.localStorage.get(a,"Global")?(null===(o=(n=this.logger).errorToTelemetry)||void 0===o||o.call(n,"Failed to clear opt-in flag",s,{commandSource:e},!0),!1):(null===(c=(r=this.logger).warnNoPii)||void 0===c||c.call(r,"isOptedIntoT2Web flag cleared from local storage",e),!0)):(null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,"Opt-in flag not found",s,{commandSource:e},!0),!1)}getT1Url(e){let t;const i=(0,n.J)();if(e){const i=new URL(e),n=i.pathname+i.search+i.hash,a=new URL(i.origin);a.pathname="/_",a.hash=n,t=a}else{const e=new URL(i.location.href);t=new URL(e.origin)}return t.href}}},61754:(e,t,i)=>{"use strict";i.d(t,{Q:()=>n});class n{static get Instance(){return n._instance||(n._instance=new n),n._instance}constructor(){this.outstandingRequests=void 0,this.mostRecentRequest=void 0,this.requestsMapping=void 0,this.decimalPlaces=void 0,this.subscriber=void 0,this.decimalPlaces=3}processRequest(e,t,i){if(!this.subscriber)return;const{requests:n}=this.outstandingRequests;n.has(e)||n.set(e,{requestsByName:new Map});const{requestsByName:a}=n.get(e),s=a.get(t)||0;a.set(t,s+1),this.requestsMapping.set(i,{operationName:t,operationType:e}),this.notify()}processResponse(e,t){if(!this.subscriber||!this.requestsMapping.has(e))return;const{operationName:i,operationType:n}=this.requestsMapping.get(e);if("subscription"===n)return;this.requestsMapping.delete(e);const a=this.outstandingRequests&&this.outstandingRequests.requests;if(a.has(n)){const{requestsByName:e}=a.get(n);let t=e.get(i);1===t?e.delete(i):t>0&&e.set(i,--t)}const s={requestInfo:{operationName:i,operationType:n},responseTime:t&&parseFloat(t.toFixed(this.decimalPlaces))};this.mostRecentRequest=s,this.notify()}subscribe(e){this.subscriber=e,this.outstandingRequests={requests:new Map},this.requestsMapping=new Map}unsubscribe(){this.subscriber=void 0,this.outstandingRequests=void 0,this.requestsMapping=void 0}notify(){this.subscriber.processUpdate(this.outstandingRequests,this.mostRecentRequest)}}n._instance=void 0},26618:(e,t,i)=>{"use strict";i.d(t,{f5:()=>o,zB:()=>r,m0:()=>c,$J:()=>l,Mf:()=>d,NF:()=>u,UL:()=>m,hR:()=>h,Ij:()=>p,gE:()=>v,Tx:()=>f,IB:()=>k,yN:()=>j,RA:()=>C,OO:()=>_,e2:()=>T,uD:()=>I});var n=i(646388),a=i(89062),s=i(139171);const o="=====",r="Core",c="Logs",l="Core",d=e=>{if(!e||0===e.length)return"";let t="";return e.forEach((e=>{var i,n,a;if(e)if((null===(i=e.message)||void 0===i?void 0:i.startsWith(o))&&(null===(n=e.message)||void 0===n?void 0:n.endsWith(o)))t+=`\n${e.message}\r\n`;else{const i="function"==typeof(null===(a=e.timeStamp)||void 0===a?void 0:a.toISOString)?e.timeStamp.toISOString():e.timeStamp,n="string"==typeof e.levelName?e.levelName.substring(0,3):"unknownLevelName";t+=`${i} ${n}\t${e.message}\r\n`}})),(0,a.LQ)(t)},u=(e,t,i,n,a=!1)=>{if(!e)return;let o=JSON.stringify(void 0===n?t:{sessionId:n,logsArray:t});a&&(o=(0,s.gzip)(o,{to:"string"})),e.setItem(i,o)},m=(e,t,i,n)=>{if(!t)return;const a=t.getItem(i);if(a){const t=JSON.parse(a);if(Array.isArray(t)&&t.length>0){const i=t.map((e=>g(e))).sort(((e,t)=>e.timeStamp.getTime()-t.timeStamp.getTime()));e.addEvents(i)}}n&&t.removeItem(i)};function g(e){const t={message:`DiagnosticsService - Converting event from localStorage failed - ${e}`,isPiiFree:!0,level:n.i.Error,levelName:"error",timeStamp:new Date};try{const i=e;if("timeStamp"in i){if("string"==typeof i.timeStamp){if(isNaN(Date.parse(i.timeStamp)))return t;i.timeStamp=new Date(i.timeStamp)}return i}}catch(e){}return t}const h=(e,t,i,s,o,r=!1)=>{i.length>512&&(i=i.substring(0,512)+"...");const c={message:i=(0,a.LQ)(i),level:t,levelName:n.i[t],timeStamp:o||new Date,isPiiFree:s};return e.addEvent(c,r),c},p=e=>(null==e?void 0:e.length)?e.filter((e=>e.isPiiFree)):e,v=(e,t,i)=>{let n="";try{const a=f(e,t,!1);a&&a.logsArray.length>0&&(i&&(a.logsArray=p(a.logsArray)),n=d(a.logsArray))}catch(e){n="Previous session logs parsing failed"}return n},f=(e,t,i)=>{let n=null==e?void 0:e.getItem(t);if(n)try{if("{"!==n.charAt(0)&&"["!==n.charAt(0))try{n=(0,s.ungzip)(n,{to:"string"})}catch(e){}const a=JSON.parse(n);if(n=null,a)return i&&e.removeItem(t),"logsArray"in a?{sessionId:a.sessionId,logsArray:a.logsArray.map((e=>g(e)))}:{sessionId:"",logsArray:a}}catch(e){}},b="tmp.previousSessionLogs",y="tmp.previousSessionErrorLogs",k=(e,t=!1)=>`${t?y:b}${e?`-${e}`:""}`,S="persistedDiagnostics",w="persistedErrorDiagnostics",j=(e,t=!1)=>`${t?w:S}${e?`-${e}`:""}`,C=(e,t,i,s)=>{const o=e.getBufferedEvents();if(o&&o.length>0){const r={message:`DiagnosticsService: The following logs were persisted from a previous session ${s}`,isPiiFree:!0,level:n.i.Info,levelName:"info",timeStamp:new Date};((e,t,i)=>{e&&e.setItem(t,(0,a.u4)(i))})(t,i,[{message:`DiagnosticsService: The above logs were persisted from a previous session ${s}`,isPiiFree:!0,level:n.i.Info,levelName:"info",timeStamp:o[0].timeStamp},...o,r]),e.addEvent({message:`DiagnosticsService: Persisting diagnostic events for next load. Key: ${i}`,isPiiFree:!0,level:n.i.Warn,levelName:"warn",timeStamp:new Date})}},_=(e,t)=>{try{const i=new Set([k(void 0,!0),k(void 0,!1)].concat(t.map((e=>k(e,!0))),t.map((e=>k(e,!1)))));Object.keys(e).filter((e=>(e.startsWith(b)||e.startsWith(y))&&!i.has(e))).forEach((t=>e.removeItem(t)))}catch(e){}},T=e=>{try{Object.keys(e).filter((e=>e.startsWith(S)||e.startsWith(w))).forEach((t=>e.removeItem(t)))}catch(e){}},I=(e,t)=>{try{const i=k(t,!1);e.removeItem(i);const n=k(t,!0);e.removeItem(n)}catch(e){}}},299295:(e,t,i)=>{"use strict";i.d(t,{K:()=>r,g:()=>c});var n=i(850402),a=i(584192),s=i(486070),o=i(844729);const r=(e,t,i)=>r=>{const{discover:c,authenticationResources:d,platformService:u,config:m}=r,g=(0,o.h)(u,m),{headers:h}=t,p=(0,n.__rest)(t,["headers"]),v=Object.assign(Object.assign({},g),h);return{baseUrlPromise:()=>c.regionGtm(s.Pn.middleTier),serviceName:e,authResource:d.mtAuthResource,models:i((e=>{const t=Promise.resolve(Object.assign({constructRequest:(0,a.$)(e,v)},p));return l(t)}))}},c=(e,t,i)=>n=>{const s=e((0,a.$)(n,t),i);return l(s)},l=e=>{const t=Object.assign(e,{allow:i=>(e.then((e=>e.allowedResponses=i)),t),withCustomTelemetry:i=>(e.then((e=>e.customTelemetry=i)),t),withRetry:i=>(e.then((e=>e.retryPolicy=i)),t),withResponse:i=>(e.then((e=>e.responseType=i)),t),withTransform:i=>(e.then((e=>e.transformResponse=i)),t)});return t}},145279:(e,t,i)=>{"use strict";function n(e,t,i){const n=new Error(e);return Object.assign(n,{reason:e,serverResponse:t,innerException:i})}i.d(t,{T:()=>n})},584192:(e,t,i)=>{"use strict";function n(e,t){return t?(...i)=>{const n=e(...i);return Object.assign(Object.assign({},n),{headers:Object.assign(Object.assign({},t),n.headers)})}:e}i.d(t,{$:()=>n})},80811:(e,t,i)=>{"use strict";i.d(t,{E:()=>n,Z:()=>a});const n="beta/atpsafelinks/getpolicy/",a="atp-safelinks-policy"},723506:(e,t,i)=>{"use strict";i.d(t,{c:()=>v});var n=i(850402),a=i(738646),s=i(303307),o=i(80811),r=i(50805),c=i(787623),l=i(8122),d=i(299295),u=i(974509);const m=()=>({url:o.E,method:"GET",serviceName:l.E.AtpSafelinksService,apiName:"safelink"}),g=(0,d.K)(l.E.AtpSafelinksService,{rejectHttpError:!0,allowedResponses:[u.qj.HTTP_2XX]},(e=>({getPolicy:e(m)}))),h=e=>{const t=(0,c.S)(e);return{getPolicy:p(t)}},p=e=>()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield e(m());return yield t.body.json()}));class v{constructor(e,t,i,n,a,s){this.send=e,this.scenarioFactory=t,this.localStorage=n,this.coreSettings=a,this.logger=i.newLogger("AtpSafelinksService","services-utilities-atp-safelinks"),this.atpSafelinksServiceTransport=((e,t,i)=>{const{enableEndpointsManagerOnAtpSafelinksService:n}=i.get(r.J.Messaging);return n?t.createApi(g):h(e)})(this.send,s,this.coreSettings)}initPolicy(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=this.scenarioFactory.newScenario(a.RG.ATPGetPolicyTask);try{yield this.getPolicy(),e.stop()}catch(t){const i=`Error getting ATP Safelinks policy: ${t.message||""}`;this.logger.error(i),e.fail({errors:i})}}))}getPolicy(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){return null!==(e=this.getPolicyFromLocalStore())&&void 0!==e?e:this.getPolicyFromRemote()}))}getPolicyFromLocalStore(){let e=null;try{const t=this.localStorage.get(o.Z);if(t){const i=JSON.parse(t);(0,s.z)(i.cookie,i.webAffinitizedUrl)?e=i:this.logger.log("Invalid policy found from localStorage, fetching new policy")}}catch(e){this.logger.error(`Error while getting ATP safelinks policy from localStorage: ${e}`)}return e}getPolicyFromRemote(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let t=null;const i=this.scenarioFactory.newScenario(a.RG.ATPGetPolicy);try{const n=yield this.atpSafelinksServiceTransport.getPolicy();null===(e=this.localStorage)||void 0===e||e.setSafe(o.Z,JSON.stringify(n)),this.logger.log(`ATP Policy isATPSafelinksEnabled: ${n.isATPSafelinksEnabled}`),i.stop(),t=n}catch(e){this.logger.error(`AtpSafelinks GetPolicy API failed with Error: ${e&&e.message}`),i.fail({errors:"atp_get_policy_failed"})}return t}))}}},804589:(e,t,i)=>{"use strict";i.d(t,{aw:()=>n,ZU:()=>a,Fz:()=>s,l6:()=>o,$N:()=>r,yc:()=>c,DT:()=>l,SM:()=>d,wK:()=>u,_V:()=>m,fL:()=>g,IY:()=>h,rz:()=>p,ru:()=>v,op:()=>f,ej:()=>b,Hw:()=>y,QN:()=>S,gX:()=>w,ex:()=>C,s9:()=>_,uI:()=>T,rF:()=>I,_6:()=>N,zP:()=>E,GA:()=>F,f:()=>x,u1:()=>D,kI:()=>A,j:()=>M,Tv:()=>P,$l:()=>O});const n="TflFreProfileCardDisplayed",a="LogoutState",s="authSessionId",o="tmp.previous.silent.signin",r="in-progress",c={nopa:"2"},l={coa:"1"},d={AuthProviderLoadError:"AuthProviderLoadError",ErrorGetUserWhenAnonNotSupported:"ErrorGetUserWhenAnonNotSupported",UserNotLicensed:"Forbidden",CloudMismatch:"CloudMismatch",InitFailure:"Core-auth init failure",InteractionRequired:"InteractionRequired",InvalidScopeResource:"invalid_scope",MultipleUsersPresentWithSpecifiedIdentifier:"MultipleUsersPresentWithSpecifiedIdentifier",NativeAuthModuleNotPresent:"NativeAuthModuleNotPresent",NoAccountFound:"NoAccountFound",RemoteOperationFailed:"RemoteOperationFailed",SignInRestrictions:"SignInRestrictions",SsoFirstAccountFailed:"SsoFirstAccountFailed",NoNetwork:"NoNetwork",MachineAsleep:"MachineAsleep",TenantUnredeemed:"TenantUnredeemed",ErrorCodeMissingForTenantLogin:"ErrorCodeMissingForTenantLogin",UserNotAuthenticated:"UserNotAuthenticated",UserNotFoundError:"User not found",LoginRequired:"login_required",ConsentRequired:"consent_required",PopUpWindowError:"popup_window_error",EmptyResponse:"EmptyResponse",InvalidResponse:"InvalidResponse",InvalidToken:"InvalidToken",UnsupportedParameter:"UnsupportedParameter",UserAuthNotAvailable:"UserAuthNotAvailable",MissingRequiredFields:"MissingRequiredFields",CannotUpdateCurrentAccount:"CannotUpdateCurrentAccount",FallbackWithSkypeToken:"FallbackWithSkypeToken",HiddenUserErrorForLogin:"HiddenUserErrorForLogin",MsaUserNotAllowed:"MsaUserNotAllowed",LogOutTriggeredFromCrossCloud:"Log out triggered cross cloud"},u={NoNetwork:"NoNetwork",ApiContractViolation:"ApiContractViolation",UiAlreadyShowing:"Cannot sign in when UI is showing"},m="https://login.microsoftonline.com/",g=[{cloud:"prod",authority:m},{cloud:"gallatin",authority:"https://login.partner.microsoftonline.cn/"},{cloud:"dod",authority:"https://login.microsoftonline.us/"},{cloud:"gcch",authority:"https://login.microsoftonline.us/"},{cloud:"life",authority:m},{cloud:"airgap09",authority:"https://login.microsoftonline.microsoft.scloud/"},{cloud:"airgap08",authority:"https://login.microsoftonline.eaglex.ic.gov/"}],h="InteractionRequiredAuthError",p="skype-token",v="discover-user-details",f="discover-region-gtm";var b,y;!function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.SIGNIN_RESTRICTIONS_KEY="SignInRestrictions",e.AUTHZ_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.IC3_GATEWAY_CAE_KEY="https://ic3.teams.office.com",e.IC3_GATEWAY_AAD_KEY="https://ic3-non-cae.teams.office.com"}(b||(b={})),function(e){e.openId="openId",e.profile="profile"}(y||(y={}));let k=["[auth][authserviceBack][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","aborted","A silent sign-in request was sent but none of the currently signed in user(s) match the requested login hint","Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","Cannot start retry fetch of ADAL tokens, isPassive: false","Cancelling all retries due to: orchestration authenticationService_offline","Cancelling all retries due to: Relogin succeeded. Need to refresh tokens","Due to current app state cannot start retry fetch of ADAL tokens","noAccessForResource","resourceRequiresConsent","resourceDisabled","Seamless single sign on failed for the user. This can happen if the user is unable to access on premises AD or intranet zone is not configured correctly","tokenRevoked","tpmError","Webclient Auth request reached maximum timeout - 60000.","popup_window_error"];const S=e=>(e&&(k=[...k,...e]),k),w=()=>k;let j=[];const C=e=>(e&&(j=[...j,...e]),j),_=e=>j.includes(e);var T,I,N;!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.TEN=10]="TEN",e[e.FIFTEEN=15]="FIFTEEN",e[e.SIXTEEN=16]="SIXTEEN",e[e.TWENTYFOUR=24]="TWENTYFOUR",e[e.THIRTY=30]="THIRTY",e[e.TWO_HUNDRED_FIFTY_FIVE=255]="TWO_HUNDRED_FIFTY_FIVE"}(T||(T={})),function(e){e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.SECONDS_FIVE_MINUTES=300]="SECONDS_FIVE_MINUTES",e[e.ONE_HOUR=36e5]="ONE_HOUR",e[e.ONE_MINUTE=6e4]="ONE_MINUTE",e[e.ONE_DAY=864e5]="ONE_DAY"}(I||(I={})),function(e){e.services="f8cdef31-a31e-4b4a-93e4-5f571e91255a"}(N||(N={}));const E="9188040d-6c67-4c5b-b112-36a304b66dad",F="wids",x="74ebf54e-8a4c-453c-a5ea-3ff41b70afe6",D="b44d8d43-c828-450b-9b6f-ae3788447705",A="X-MS-Migration",M=(T.TWO,I.MILLI_PER_SECOND,I.SECONDS_PER_MINUTE,{SKYPE_REQUEST:"skype_request_start",SKYPE_REQUEST_STOP:"skype_request_stop",SKYPE_SEND_REQUEST:"skype_send_request_start",SKYPE_SEND_REQUEST_STOP:"skype_send_request_stop",SKYPE_RECEIVED_RESPONSE:"skype_received_response",SKYPE_SEND_REQUEST_DESKTOP:"skype_send_request_desktop",SKYPE_SEND_REQUEST_WORKER:"skype_send_request_worker",SKYPE_TOKEN_RECEIVED_WORKER:"skype_token_received_worker",RECEIVE_CLAIM:"receive_claim"}),P={MTO:"MTO"},O={TENANTSV2:"/beta/users/tenantsv2"}},186921:(e,t,i)=>{"use strict";i.d(t,{q:()=>a});var n=i(287474);const a=new class{constructor(){this.logLevel=n.in.Info,this.localCallback=void 0,this.error=e=>this.logMessage(n.in.Error,e),this.warning=e=>this.logMessage(n.in.Warning,e),this.warn=e=>this.logMessage(n.in.Warning,e),this.info=e=>this.logMessage(n.in.Info,e),this.log=e=>this.logMessage(n.in.Info,e),this.verbose=e=>this.logMessage(n.in.Verbose,e),this.debug=e=>this.logMessage(n.in.Verbose,e)}initialize(e,t=n.in.Verbose){this.localCallback=e,this.logLevel=t}executeCallback(e,t){this.localCallback?this.localCallback(e,t):console&&console.log(t)}logMessage(e,t){if(e>this.logLevel)return;const i=`[Auth]: ${t}`;this.executeCallback(e,i)}}},7269:(e,t,i)=>{"use strict";i.d(t,{OU:()=>g,u:()=>m,cv:()=>v,ld:()=>p,Tu:()=>f});var n=i(850402),a=i(186921),s=i(928665),o=i(663945),r=i(59482),c=i(932289);class l{}l._authTelemetryCollection={},l._correlationMap={},l._userBiServiceMap={},l.getUserBiService=e=>l._userBiServiceMap[e]||l._userBiServiceMap.GLOBAL,l.setUserBiService=(e,t)=>{t?l._userBiServiceMap[e]=t:delete l._userBiServiceMap[e]},l.getAuthTelemetry=e=>l._authTelemetryCollection[e],l.setAuthTelemetry=(e,t)=>l._authTelemetryCollection[e]=t,l.delete=e=>{delete l._authTelemetryCollection[e];const t=Object.keys(l._correlationMap);for(const i in t)if(l._correlationMap.hasOwnProperty(t[i])){const n=t[i],a=l._correlationMap[n];a&&(l._correlationMap[n]=a.filter((t=>t!==e)))}},l.getCorrelation=e=>l._correlationMap[e],l.setCorrelation=e=>{if(!e.scenarioName)return;const t=l.getCorrelation(e.scenarioName)||[];-1===t.indexOf(e.id)&&t.push(e.id),l._correlationMap[e.scenarioName]=t};class d{constructor(e,t,i,n,d,u,m,g,h){var p;this._scenarioFactory=e,this._correlation=t,this._asyncAuthCache=i,this._subContext=n,this._shouldCreateScenario=d,this._isBatch=u,this._timeoutMs=m,this._telemetryService=g,this._eventData=[],this._localScenarioEventData={},this._loggingPrefix="",this.appendScenarioEventData=e=>{this._scenario&&this._scenario.appendEventData(e),this._localScenarioEventData=Object.assign(Object.assign({},this._localScenarioEventData),e)},this.addEventData=e=>{Array.prototype.push.apply(this._eventData,e)},this.getEventData=()=>[...this._eventData],this.addScenarioMark=(e,t={},i)=>{t=this._mapEventData(t,i),this._scenario?this._scenario.mark(e,t,t.status):this.addEventData([`${e}:${t.status}`]),this.logMessage(`${this._loggingPrefix} [${e}][${t.status}][scenarioEventData][${(0,s.u4)(t)}]`)},this.closeScenario=(e={},t,i,n)=>{var s;if(e=this._mapEventData(e,t),i)return e.reason&&this.addEventData([`reason:${e.reason}`]),e.errorCode&&this.addEventData([`errorCode:${e.errorCode}`]),void this.addEventData([`${this._subContext}$:${e.status}`]);if(this._isBatch&&this._correlation.scenarioName&&(this._batchScenarioStartTime&&(e.perfDelta=performance.now()-this._batchScenarioStartTime),e.correlationId=null!==(s=e.correlationId)&&void 0!==s?s:this._correlation.id,"success"===e.status?(0,r.ft)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,n):"failure"===e.status?(0,r.EJ)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,n):(0,r.vB)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,n)),!this._scenario){const t=this._shouldCreateScenario?a.q.warn:a.q.log,i=this._shouldCreateScenario?"[N/A]":"";return this.logEventData(t,`${this._loggingPrefix} [stop]${i} [scenarioEventData]`,e),void l.delete(this._correlation.id)}switch(e.status){case"incomplete":this._scenario.incomplete(e);break;case"failure":this._scenario.fail(e);break;case"abandoned":this._scenario.cancel(e);break;default:this._scenario.stop(e)}const o="failure"===e.status?a.q.error:a.q.log;this.logEventData(o,`${this._loggingPrefix} [stop][${e.status}] [e]`,e),l.delete(this._correlation.id)},this.createScenario=(e,t,i)=>{this._scenario?this.logMessage(`createScenario called with [${this._subContext}][${(0,s.u4)(this._correlation)}]::${e}, but there is already a scenario with that correltion id`,a.q.warn):(this._createScenario(e,i||this._timeoutMs,Object.assign(Object.assign({},this._localScenarioEventData),t)),this.logMessage(`${this._loggingPrefix} [create] - scenario created`))},this.recordAuthUserBiTelemetry=(e,t)=>{const i={panelRegion:o.Ai.main,panelType:o.wh.AuthStart,actionWorkload:o.sz.auth,actionSubworkload:o.eD.sisu,actionScenarioType:o.Yu.appAuth,actionScenario:t.scenario,actionGesture:t.actionGesture||o.uS.auto},n=l.getUserBiService(e||"GLOBAL");n&&n.recordPanelAction(i,a.q)},this.setUserToTelemetryContext=e=>{var t;e&&(null===(t=this._telemetryService)||void 0===t||t.setAuthContext(e),this.addScenarioMark(`${this._correlation.scenarioName}_set_user_on_telemetry_context`))},this.setUserDetailsToTelemetryContext=e=>{var t;if(e){const{region:i}=e;void 0!==i&&(null===(t=this._telemetryService)||void 0===t||t.setCoreContext("UserInfo.Region",i)),this.addScenarioMark(`${this._correlation.scenarioName}_set_tenant_details_on_telemetry_context`)}},this._mapEventData=(e,t)=>{var i;return e.subContext=e.subContext||this._subContext,(e=Object.assign(Object.assign({},this._localScenarioEventData),e)).error&&(e.error=Object.assign(Object.assign({},e.error),{message:e.error.message,errorMetaData:void 0}),e.errorCode=null!==(i=e.error.code)&&void 0!==i?i:e.error.errorCode,this.addEventData([`errorCode:${e.error.errorCode}`])),!t&&e.error&&(t=(0,c.ZG)(e.error)?"incomplete":"failure"),e.eventData=this._eventData.join(","),e.status=t||"success",e},this._createScenario=(e,t,i)=>{var n,s,o;const r=t?{timeoutMs:t}:{};this._scenario=null!==(n=this._scenarioFactory.findScenario(e))&&void 0!==n?n:this._scenarioFactory.newScenario(e,r);try{null===(o=(s=this._scenarioFactory).hoistScenarioToCore)||void 0===o||o.call(s,this._scenario)}catch(e){a.q.log(`${this._loggingPrefix} ${e.message}`)}this._scenario.appendEventData(Object.assign({secondaryCorrelationId:this._correlation.id,commandSource:this._correlation.source},i)),this._shouldCreateScenario=!0},this.loggingPrefix=()=>`[Telemetry][${this._correlation.id}][${this._correlation.scenarioName}]`,this.logEventData=(e,t,i)=>{i.error||delete i.error;const n=this.splitStringEqually((0,s.u4)(i));for(const i of n)this.logMessage(`${t}${i}`,e)},this.splitStringEqually=(e,t=300)=>{const i=new RegExp(`.{1,${t}}`,"g"),n=e.match(i);return n||[]},this.logMessage=(e,t)=>{this._isBatch||(t?t(e):a.q.log(e))},this._loggingPrefix=this.loggingPrefix(),this._isBatch&&(this._batchScenarioStartTime=performance.now()),d&&(h?this._scenario=h:(null===(p=this._correlation)||void 0===p?void 0:p.scenarioName)&&this._createScenario(this._correlation.scenarioName,this._timeoutMs,void 0)),this.logMessage(`${this._loggingPrefix} [start] - telemetry provider created for ${this._subContext}, source: ${this._correlation.source} with shouldCreateScenario: [${d}]`),this._eventData.push(`^source:${this._correlation.source},fn:${this._subContext}`)}get correlation(){return Object.assign({},this._correlation)}}class u{constructor(e,t,i){this._scenarioProvider=e,this._asyncAuthCache=t,this._telemetryService=i,this.create=e=>this._createScenario(e,!0),this.createNew=e=>{var t;const i=new d(this._scenarioProvider,e.correlation,this._asyncAuthCache,e.subContext,!0,null!==(t=e.isBatch)&&void 0!==t&&t,e.timeoutMs,this._telemetryService);return e.scenarioEventData&&i.appendScenarioEventData(e.scenarioEventData),i},this.createWithoutScenario=e=>this._createScenario(e,!1),this.getCorrelation=e=>l.getCorrelation(e)||[],this._createScenario=(e,t)=>{var i,n;const{correlation:a,subContext:s,scenarioEventData:o,timeoutMs:r,scenario:c,isBatch:u}=e;let m=l.getAuthTelemetry(a.id);if(m)m.addEventData([`fn:${s}`]);else{const o=null===(i=this._telemetryService)||void 0===i?void 0:i.getTelemetryServicesCache().get(null===(n=e.scenarioEventData)||void 0===n?void 0:n.accountId);m=new d((null==o?void 0:o.coreScenarioFactory)||this._scenarioProvider,a,this._asyncAuthCache,s,t,null!=u&&u,r,(null==o?void 0:o.telemetryService)||this._telemetryService,c),l.setAuthTelemetry(a.id,m)}return o&&m.appendScenarioEventData(o),l.setCorrelation(a),m}}}const m=(e,t)=>{l.setUserBiService(e||"GLOBAL",t)},g=e=>{var t,i,a,o,r,c;e.options.correlation={id:null!==(i=null===(t=e.options.correlation)||void 0===t?void 0:t.id)&&void 0!==i?i:(0,s.pW)(),scenarioName:null!==(o=null===(a=e.options.correlation)||void 0===a?void 0:a.scenarioName)&&void 0!==o?o:e.scenarioName,source:null!==(c=null===(r=e.options.correlation)||void 0===r?void 0:r.source)&&void 0!==c?c:e.source};const{options:{correlation:l}}=e,d=(0,n.__rest)(e,["options"]);return h(Object.assign({correlation:l},d))},h=e=>{const{correlation:t,subContext:i,scenarioEventData:n,eventData:a,timeoutMs:s,scenario:o,isBatch:r}=e,c=l.getAuthTelemetry(t.id),d=(e.startWithoutScenario||!t.scenarioName?v.createWithoutScenario:v.create)({correlation:t,subContext:i,scenarioEventData:n,timeoutMs:s,scenario:o,isBatch:r});a&&d.addEventData(a);return[d,(e,t,i)=>d.closeScenario(e,t,!!c,i)]},p=e=>v.getCorrelation(e);let v;const f=(e,t,i)=>{v||(v=new u(e,t,i),a.q.log("authTelemetryProvider initialized"))}},551400:(e,t,i)=>{"use strict";i.d(t,{sX:()=>c,mH:()=>u,Wn:()=>m});var n=i(850402),a=i(50805),s=i(448850);const o={access_token:{xms_cc:{values:["CP1"]}}},r=JSON.stringify(o),c=(e,t,i,n,s)=>{const c=((e,t)=>{const{caeEnabledResources:i}=(null==t?void 0:t.get(a.J.Auth))||{};return!(!e||!i||!(Array.isArray(i)&&i.findIndex((t=>e.includes(t)))>-1))})(e,s);let u=d(t,i,n);if(c&&(u=((e,t)=>{var i;if(!t)return r;try{const e=JSON.parse(t);return(null==e?void 0:e.access_token)?JSON.stringify({access_token:Object.assign(Object.assign({},e.access_token),o.access_token)}):r}catch(t){return void(null===(i=null==e?void 0:e.errorToTelemetry)||void 0===i||i.call(e,"getClaimsForRequest: Json parsing failed","auth_add_claims_to_request",void 0,!0))}})(n,u)),null==i||i.addEventData(["cp1"+((null==u?void 0:u.includes("CP1"))?"on":"off")]),t&&u&&u!==r){const e=l(u,n);e&&(null==i||i.addEventData([`claimsChallengeHeaderList:${e}`]))}return u},l=(e,t)=>{var i,a;try{const{access_token:t}=JSON.parse(e);if(t){if((null===(i=t.xms_caeerror)||void 0===i?void 0:i.value)&&!isNaN(Number(t.xms_caeerror.value))){const{xms_caeerror:e}=t,i=(0,n.__rest)(t,["xms_caeerror"]),a=`xms_caeerror_${e.value}`;return[...Object.keys(i),a].join()}return Object.keys(t).join()}return null}catch(e){return null===(a=null==t?void 0:t.errorToTelemetry)||void 0===a||a.call(t,"getClaimChallengeKeys: Json parsing failed","auth_add_claims_to_request",void 0,!0),null}},d=(e,t,i)=>{var n;if(e&&"string"==typeof e&&""!==e.trim())try{const n=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/.test(e)?(0,s.G)(e):e,a=JSON.parse(n);if(a&&"object"==typeof a)return null==t||t.addEventData(["claim:"+ +!!n]),n;null==t||t.addEventData(["invalidJSON"]),null==i||i.log("Claims are not a valid json object, returning undefined.")}catch(e){null==t||t.addEventData(["base64DecodeFail"]),null===(n=null==i?void 0:i.errorToTelemetry)||void 0===n||n.call(i,"validateAndDecodeClaims: invalid base64 string input","auth_add_claims_to_request",void 0,!0)}};var u;!function(e){e.WWW_AUTHENTICATE_HEADER="www-authenticate",e.ERROR_PREFIX="error=",e.CLAIMS_PREFIX="claims=",e.INSUFFICIENT_CLAIMS="insufficient_claims"}(u||(u={}));const m=(e,t)=>{const i={error:void 0,claims:void 0},n=null==e?void 0:e[u.WWW_AUTHENTICATE_HEADER];if(!n)return i;const a=n.split(",").filter(Boolean).map((e=>e.trim()));for(const e of a){const n=e.split('"');if(3===n.length)switch(n[0].toLocaleLowerCase()){case u.ERROR_PREFIX:i.error=n[1];break;case u.CLAIMS_PREFIX:i.claims=t?n[1]:(0,s.G)(n[1])}}return i}},59482:(e,t,i)=>{"use strict";i.d(t,{Q7:()=>l,ft:()=>d,EJ:()=>u,vB:()=>m,mM:()=>g});var n=i(850402),a=i(186921),s=i(928665);const o=1e3,r="batch_",c=e=>({typeName:"BatchScenario",user:e});function l(e){const t=e.getAllOfType("User");null==t||t.forEach((t=>{try{const i={user:{tenantId:t.profile.tid,oid:t.profile.oid,accountType:t.type,userName:t.userName,id:t.id},typeName:"BatchScenario"};e.del(i)}catch(e){a.q.log("[deleteAllBatchDataFromStorage] - failed to delete batcScenario from storage")}}))}function d(e,t,i,n,a){h(e,t,`${r}${i}`,(e=>(e.successMetaData=f(n,e.successMetaData),e.successMetaData.batchScenarioCounter)),a)}function u(e,t,i,n,a){h(e,t,`${r}${i}`,(e=>(e.failureMetaData=f(n,e.failureMetaData),e.failureMetaData.batchScenarioCounter)),a)}function m(e,t,i,n,a){h(e,t,`${r}${i}`,(e=>(e.abandonedMetaData=f(n,e.abandonedMetaData),e.abandonedMetaData.batchScenarioCounter)),a)}const g=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=c(i),a=yield t.getValue(n);if(a){for(const t in a)if(a[t]){const n=a[t];p(e,t,n,i.id)}t.del(n)}}));function h(e,t,i,n,s){if(!s)return void a.q.log("[updateBatchScenarioCount] Unable to get batch cache key: user is not defined");const r=c(s);t.getValue(r).then((c=>{var l;const d=null!==(l=null==c?void 0:c[i])&&void 0!==l?l:{};n(d)>=o?(p(e,i,d,s.id),function(e,t,i,n){try{a.q.log(`[clearBatchScenarioFromCache] scenario: ${i}`),null==n||delete n[i],e.put(t,n)}catch(e){a.q.log(`[clearBatchScenarioFromCache] ${null==e?void 0:e.message}`)}}(t,r,i,c)):function(e,t,i,n,s){try{return s?s[i]=n:s={[i]:n},e.put(t,s),!0}catch(e){return a.q.log(`[setBatchScenarioToAuthCache] ${null==e?void 0:e.message}`),!1}}(t,r,i,d,c)}))}function p(e,t,i,n){(null==i?void 0:i.successMetaData)&&v(e,t,i.successMetaData,"success",n),(null==i?void 0:i.failureMetaData)&&v(e,t,i.failureMetaData,"failure",n),(null==i?void 0:i.abandonedMetaData)&&v(e,t,i.abandonedMetaData,"abandoned",n)}function v(e,t,i,n,o){const r=e.newScenario(t),c=(0,s.pW)();a.q.log(`[sendBatchScenario] for ${t}, status: ${n}, correlationId:${c}`);const l={accountId:o,context:"auth-telemetry-helper",secondaryCorrelationId:c,batchScenarioData:i};switch(n){case"success":r.stop(l);break;case"failure":r.fail(l);break;default:r.cancel(l)}}function f(e,t){return t?(t.batchScenarioCounter++,t.batchEventData.push(e)):t={batchScenarioCounter:1,batchEventData:[e]},t}},932289:(e,t,i)=>{"use strict";i.d(t,{Tr:()=>o,q2:()=>r,MD:()=>c,Yf:()=>l,ZG:()=>d,fj:()=>u});var n=i(804589),a=i(132756),s=i(928665);function o(e){const t=new Error(e.message);return Object.assign(t,{context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError})}const r=(e,t,i)=>{switch(e.code){case a.jK.NoNetwork:return c({name:"offlineEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"OfflineError",errorMetaData:void 0});case a.jK.SignInRestrictions:return c({name:"signInRestrictionEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"SignInRestriction",errorMetaData:i})}return e};function c(e){const t=new Error(e.message);return Object.assign(t,{authSubErrorCode:e.authSubErrorCode,errorMetaData:e.errorMetaData,context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError})}function l(e){return(0,n.gX)().indexOf(e)>=0}function d(e){return e&&(e.isExpected||l(e.errorCode)||!!(t=e.message)&&(0,n.gX)().map((e=>t.indexOf(e)>=0)).filter(Boolean).length>0);var t}function u(e,t,i,n=!0){let o,r,l="";switch(t){case"LicenseError":o="licenseEndPage",r="show-license-error",l=a.jK.Forbidden;break;case"SignInRestriction":o="signInRestrictionEndPage",r="show-signin-restriction-error",l=a.jK.SignInRestrictions;break;default:o="",r=""}const{name:d,email:u,pictureBlob:m,customError:g}=e;return c({authSubErrorCode:t,errorCode:l,errorMetaData:{accountId:i,name:d,email:u,pictureBlob:m,userLoggedIn:n},name:o,message:(null==g?void 0:g.message)||"",correlationId:(null==g?void 0:g.correlationId)||(0,s.pW)(),context:(null==g?void 0:g.context)||"endPageDataToAuthError",subContext:(null==g?void 0:g.subContext)||r})}},747741:(e,t,i)=>{"use strict";i.d(t,{pZ:()=>g,eH:()=>h,Qk:()=>p,JX:()=>y,xT:()=>k,ce:()=>j,Ay:()=>C});var n=i(850402),a=i(287474),s=i(466094),o=i(738646),r=i(50805),c=i(551400),l=i(804589),d=i(7269),u=i(928665);const m=l.uI.TWENTYFOUR*l.rF.ONE_HOUR;function g(e,t,i,o,r,d,u,m,g){var h;return(0,n.__awaiter)(this,void 0,void 0,(function*(){let n=a.Zw.Skype;const[p,v]=T(t,m),{forceRenew:S,tokenToRenew:w}=g||{};let I=!1;I=(null===(h=yield i.getUser())||void 0===h?void 0:h.type)===s.Ch.Anonymous,null==p||p.addScenarioMark("ic3-gateway-token-helper-get-token-start",{commandSource:t,context:`preferredTokenTypes: ${e.map((e=>a.Zw[e]))}`});const N=I?a.Zw.Skype:k(t,r);let E;if(null==p||p.addScenarioMark("ic3-gateway-token-helper-get-token-type-from-config",{commandSource:t,context:`SupportedTokenType: ${a.Zw[N]}`}),!I&&void 0!==d){const e="WWW-Authenticate",n=d.get(e);if(n){let e;if(null==p||p.addScenarioMark("ic3-gateway-token-helper-parse-www-authn-header",{commandSource:t,context:"WWW-Authenticate headers present: true"}),void 0!==(e=_(n))){const t=(0,c.sX)(l.ej.IC3_GATEWAY_CAE_KEY,e,p,u,r);return b(l.ej.IC3_GATEWAY_CAE_KEY,a.Zw.CAE,i,p,v,t)}j(n)&&(null==p||p.addScenarioMark("ic3-gateway-token-helper-parse-www-authn-header",{commandSource:t,context:"isSkypeTokenMigrationHeader: true"}),E=C(n),null==p||p.addScenarioMark("ic3-gateway-token-helper-header-is-stm",{commandSource:t,context:`protocolFromHeader: ${a.Zw[E]}`}))}}switch(n=I?a.Zw.Skype:y(e,N,E),null==p||p.addScenarioMark("ic3-gateway-token-helper-protocol-to-use",{commandSource:t,context:`protocolToUse: ${a.Zw[n]}`}),n){case a.Zw.Skype:return f(o,p,v,S);case a.Zw.AAD:return b(l.ej.IC3_GATEWAY_AAD_KEY,n,i,p,v,void 0,w);case a.Zw.CAE:return b(l.ej.IC3_GATEWAY_CAE_KEY,n,i,p,v);default:throw null==v||v({authEventData:"ic3-gateway-token-helper-get-token-end",reason:"Cannot determine protocol to use.",status:"failure"}),new Error(`cannot determine protocol to use. ${e}, ${t}, ${i}, ${o}, ${r}, ${d}`)}}))}const h=(e,t,i)=>{if(!e||!t)return;const n=e.get(t);if(n){if(!v(n.fallbackTime,i))return n.tokenType;e.delete(t)}},p=(e,t,i)=>{e&&t&&void 0!==i&&e.set(t,{tokenType:i,fallbackTime:(new Date).getTime()})},v=(e,t)=>{const{stmFallbackMapTimerInHr:i}=t.get(r.J.Auth),n=i?i*l.rF.ONE_HOUR:m;return(new Date).getTime()-e>n},f=(e,t,i,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{null==t||t.addScenarioMark("ic3-gateway-token-helper-acquire-skype-token-start",{authEventData:`forceRenew: ${s}`}),yield e.validateSkypeToken({forceRenew:s});const n=yield e.getSkypeTokenInfoFromDiscoveryResponse(),o=Object.assign({},n);return o.expiration=Math.round(o.expiration/l.rF.MILLI_PER_SECOND),null==t||t.addScenarioMark("ic3-gateway-token-helper-acquire-skype-token-end",{authEventData:`expiry in seconds: ${o.expiration}`,message:`expiry in seconds: ${o.expiration}`,status:"success"}),null==i||i(),{token:o,tokenType:a.Zw.Skype}}catch(e){throw null==t||t.addScenarioMark("ic3-gateway-token-helper-acquire-skype-token-end",{error:e,status:"failure"}),null==i||i({error:e}),e}})),b=(e,t,i,a,s,o,r)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{if(null==a||a.addScenarioMark("ic3-gateway-token-helper-acquire-aad-token-start",{authEventData:`resource: ${e}, tokenToRenew: ${!!r}`}),i.acquireTokenV2){const n=Object.assign({tflClaim:r},void 0!==o&&{claim:o}),c=yield i.acquireTokenV2(e,n),d=Date.now(),u=((null==c?void 0:c.expires)-l.rF.SECONDS_PER_MINUTE)*l.rF.MILLI_PER_SECOND;return u<=d&&(null==a||a.addScenarioMark("ic3-gateway-token-helper-retry-aad-token-expiry-offset",{authEventData:`resource: ${e}, expiry in seconds: ${c.expires}, now: ${d}, time_diff: ${u-d}, fromCache: ${c.fromCache}`,message:`resource: ${e}, expiry in seconds: ${c.expires}, now: ${d}, time_diff: ${u-d}, fromCache: ${c.fromCache}`})),null==a||a.addScenarioMark("ic3-gateway-token-helper-acquire-aad-token-end",{authEventData:`resource: ${e}, expiry_AuthService: ${c.expires}, fromCache: ${c.fromCache}`,message:`resource: ${e}, expiry_AuthService: ${c.expires}, fromCache: ${c.fromCache}`,status:"success"}),null==s||s(),{token:c,tokenType:t}}throw null==s||s({authEventData:`resource: ${e}`,reason:"IAuthenticationService does not have acquireTokenV2",status:"failure"}),new Error("IAuthenticationService does not have acquireTokenV2")}catch(t){throw null==a||a.addScenarioMark("ic3-gateway-token-helper-acquire-aad-token-end",{authEventData:`resource: ${e}`,status:"failure",error:t}),null==s||s({error:t}),t}})),y=(e,t,i)=>{e.sort(((e,t)=>t-e));const n=[e[0],t];return void 0!==i&&n.push(i),n.sort(((e,t)=>e-t)),n[0]},k=(e,t,i,n)=>{if(void 0===e||void 0===t||(null==n?void 0:n.type)===s.Ch.Anonymous)return a.Zw.Skype;const{skypeTokenMigrationServiceInfo:o}=t.get(r.J.Auth),c=null==o?void 0:o.find((t=>(null==t?void 0:t.source)===e));if(void 0===c)return a.Zw.Skype;null==i||i.addEventData([`source: ${null==c?void 0:c.source}, isOnboarded: ${null==c?void 0:c.isOnboarded},type: ${null==c?void 0:c.tokenType}`]);const l=null==c?void 0:c.isOnboarded,d=null==c?void 0:c.tokenType;return l&&d?S(d):a.Zw.Skype},S=e=>{switch(e){case"Skype":return a.Zw.Skype;case"AAD":return a.Zw.AAD;case"CAE":return a.Zw.CAE}return e};var w;!function(e){e.TOKEN_TYPES="token_types="}(w||(w={}));const j=e=>e&&e.indexOf(w.TOKEN_TYPES)>-1&&e.indexOf(a.hO.BEARER)>-1,C=e=>{const t=null==e?void 0:e.toLowerCase();return(null==t?void 0:t.indexOf("cae"))>-1?a.Zw.CAE:(null==t?void 0:t.indexOf("aad"))>-1?a.Zw.AAD:(null==t||t.indexOf("skype"),a.Zw.Skype)},_=e=>{const t={[c.mH.WWW_AUTHENTICATE_HEADER]:e},i=(0,c.Wn)(t);return i&&i.error===c.mH.INSUFFICIENT_CLAIMS?i.claims:void 0},T=(e,t)=>{const i=o.RG.GetIC3GatewayToken,n={id:void 0!==t?t:(0,u.pW)(),scenarioName:i,source:e};try{const[e,t]=(0,d.OU)({options:{correlation:n},source:"ic3-gateway-token-helper",scenarioName:i,subContext:"ic3-gateway-token-helper::getIC3GateWayToken",startWithoutScenario:!1});return[e,t]}catch(e){return[void 0,void 0]}}},928665:(e,t,i)=>{"use strict";i.d(t,{u4:()=>a,VK:()=>s,pW:()=>c});const n=globalThis;function a(e,t){const i=new WeakSet;return JSON.stringify(e,((e,t)=>{if(!i.has(t)){if(t&&"object"==typeof t){if(i.add(t),t instanceof Map||t instanceof Set)return Array.from(t);if(null==t?void 0:t.errorCode)return t;if(t instanceof Error)return`${t.name}: ${t.message}`;if(t.constructor&&t.constructor!==Object&&t.constructor!==Array||t.prototype)return}return t}}),t)}function s(e,t=!0){if(null==e)return"";if("string"==typeof e)return e;try{return JSON.stringify(e,r(o(t)))}catch(e){return"Stringifying error failed"}}const o=(e=!0)=>(t,i)=>{if(i instanceof Error){const t={};return Object.getOwnPropertyNames(i).forEach((n=>{"stack"===n?e||(t[n]=("string"==typeof i.stack?i.stack:"").split("\n").map((e=>e.trim())).filter((e=>!!e))):t[n]=i[n]})),t}return i},r=e=>{const t=new WeakSet;return(i,n)=>{if("object"==typeof n&&null!==n){if(t.has(n))return;t.add(n)}return e(i,n)}},c=()=>{try{const e=n.msCrypto||n.crypto;return`${[1e7]}-1000-4000-8000-100000000000`.replace(/[018]/g,(t=>(t^e.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))}catch(e){const t="xxxxxxxx-xxxx-8xxx-yxxx-xxxxxxxxxxxx",i="0123456789abcdef";let n=0,a="";for(let e=0;e<36;e++)"-"!==t[e]&&"4"!==t[e]&&(n=16*Math.random()|0),"x"===t[e]?a+=i[n]:"y"===t[e]?(n&=3,n|=8,a+=i[n]):a+=t[e];return a}}},871538:(e,t,i)=>{"use strict";i.d(t,{lq:()=>o,hY:()=>r,bE:()=>c,s0:()=>l,MC:()=>d,gK:()=>u,SL:()=>m,m7:()=>g,oh:()=>h,gu:()=>p,JY:()=>v,VU:()=>f,FT:()=>b});var n=i(516909),a=i(905581),s=i(132756);const o="announcement-card",r="application/vnd.microsoft.teams.messaging-announcementBanner",c=1317,l=366,d=878,u=244,m="Designer",g="designer-img",h=(e=[])=>{const t=e.findIndex((e=>e.contentType===r));return{announcementCard:e[t],announcementCardIndex:t}},p=e=>{const{announcementCard:t}=h(e);if(t)try{return JSON.parse(t.content)}catch(e){throw(0,a.Tr)("PostComposeHelpers",s.jK.Undefined,"getAnnouncementCardContentFromDraft::JsonParseError")}},v=e=>{var t,i,n,a,s,o,r,c,l,d,u;const m=p((null===(t=null==e?void 0:e.computed)||void 0===t?void 0:t.cards)||[]);return{title:(null==e?void 0:e.title)||"",colorTheme:(null==m?void 0:m.colorTheme)||null,originalImageUrl:(null===(n=null===(i=null==m?void 0:m.imageData)||void 0===i?void 0:i.origImage)||void 0===n?void 0:n.src)||null,croppedImageUrl:(null===(s=null===(a=null==m?void 0:m.imageData)||void 0===a?void 0:a.croppedImage)||void 0===s?void 0:s.src)||null,croppedImageHeight:(null===(r=null===(o=null==m?void 0:m.imageData)||void 0===o?void 0:o.croppedImage)||void 0===r?void 0:r.imageHeight)||null,croppedImageWidth:(null===(l=null===(c=null==m?void 0:m.imageData)||void 0===c?void 0:c.croppedImage)||void 0===l?void 0:l.imageWidth)||null,croppedImageAltText:(null===(u=null===(d=null==m?void 0:m.imageData)||void 0===d?void 0:d.croppedImage)||void 0===u?void 0:u.imageAltText)||null,isTeamsIllustration:null}},f=(e,t,i)=>i===n.hQF.Guardians&&t?y(e,t):e,b=(e,t)=>t===n.hQF.Guardians?"":e,y=(e,t)=>`<div><h1 style="font-weight: 600;">${t}</h1>${e}</div>`},402129:(e,t,i)=>{"use strict";i.d(t,{qr:()=>d,al:()=>u,QW:()=>m});var n=i(516909),a=i(760005),s=i(711676),o=i(876661),r=i(708975),c=i(738646),l=i(451567);const d=(e,t,i,l,d,u,m)=>{const g=d;if((null==t?void 0:t.postType)===n.hQF.Guardians)return c.RG.GuardiansSendAnnouncement;const h=(null==l?void 0:l.length)===a.Uy,p=null==l?void 0:l.some((e=>(0,s.Nl)(e))),v=null==l?void 0:l.some((e=>(0,s.ug)(e))),f=i||"",b=!g&&h&&p&&!(0,o.Bl)(f),y=g&&h&&v;switch(e){case n.xyM.Create:return(0,r.Jn)(f)?c.RG.P2PSendNewMessageSfB:(0,o.Bl)(f)?c.RG.P2PSendNewMessageSfC:m?c.RG.CommentStreamSendMessage:(0,o.As)(f)?c.RG.P2PSendNewMessageFederated:u?c.RG.P2PSendNewMessageNativeFederated:b?c.RG.P2PSendNewMessageTfl:y?c.RG.P2PSendNewMessageTfw:(null==t?void 0:t.crossPostChannels)&&(null==t?void 0:t.crossPostChannels.length)>1?c.RG.CrossPostSendMessage:(0,o.j8)(f)?c.RG.PhonelinkSmsChatSendMessage:c.RG.ChatSendMessage;case n.xyM.Update:return(null==t?void 0:t.crossPostChannels)&&(null==t?void 0:t.crossPostChannels.length)>1?c.RG.CrossPostEditMessage:c.RG.EditMessage}return c.RG.ChatSendMessage},u=e=>!(!e||e.isOneOnOne||e.isMeeting||!e.hasFederatedUser),m=(e,t,i,n)=>!!((null==e?void 0:e.includes(a.U0))||(null==e?void 0:e.includes(a.m_))||(null==e?void 0:e.includes(a.vN))||(null==e?void 0:e.includes(a.WU))||(null==e?void 0:e.includes(a.IS))||(null==e?void 0:e.includes(a.M9))||(null==e?void 0:e.includes(a.RS))||t||(null==i?void 0:i.some(l.eo.isEnterpriseUserMri))&&(n||(null==i?void 0:i.some((e=>(0,s.Nl)(e))))))},921961:(e,t,i)=>{"use strict";i.d(t,{I:()=>a});var n=i(446652);function a(e,t){var i;const a=null!==(i=null==t?void 0:t.clientTypeServiceHeader)&&void 0!==i?i:e.config.clientType,s=null==t?void 0:t.embedContext;return a===n.Bh.CDLWorker?n.Bh.CDLWorker:a===n.Bh.Embed&&s?`${n.Bh.Embed}-${s}`:a}},448850:(e,t,i)=>{"use strict";i.d(t,{J:()=>s,G:()=>o});var n=i(905581),a=i(132756);function s(e){if(!e)throw(0,n.Tr)(a.w5.Authentication,a.jK.InvalidInput,"parseJWT",void 0,`invalid token, value = ${e}`);try{const[,t]=e.split("."),i=o(t);return JSON.parse(i)}catch(t){throw(0,n.Tr)(a.w5.Authentication,a.jK.InvalidInput,"parseJWT",{innerError:t},`token contains dot = ${e.includes(".")}; token length = ${e.length}`)}}function o(e){if(!e)throw(0,n.Tr)(a.w5.Authentication,a.jK.InvalidInput,"base64DecodeStringUrlSafe",void 0,`invalid base64 string input, value = ${e}`);return e=e.replace(/-/g,"+").replace(/_/g,"/"),decodeURIComponent(escape(atob(e)))}},458561:(e,t,i)=>{"use strict";i.d(t,{g:()=>a});var n=i(275742);const a=(e,t)=>{if((0,n.isArray)(e))return t}},917556:(e,t,i)=>{"use strict";i.d(t,{E:()=>a,Y:()=>s});const n=({osName:e,osVersion:t})=>{var i;if((null===(i=null==e?void 0:e.toLowerCase())||void 0===i?void 0:i.includes("windows"))&&t)try{const e=t.match(/^(\d+)\.(\d+)\.(\d+)$/),i=4,n=1,a=2,s=3;if(e&&e.length===i){const t=parseInt(e[n],10),i=parseInt(e[a],10);return{majorVersion:t,minorVersion:i,revision:parseInt(e[s],10)}}}catch(e){}},a=({osName:e,osVersion:t})=>{const i=n({osName:e,osVersion:t});return void 0!==i&&(i.majorVersion>=10&&i.minorVersion>=0&&i.revision>=22e3)},s=({osName:e,osVersion:t})=>{const i=n({osName:e,osVersion:t});return void 0!==i&&(10===i.majorVersion&&0===i.minorVersion&&i.revision<22e3&&i.revision>=10240)}},322910:(e,t,i)=>{"use strict";i.d(t,{GW:()=>s,R3:()=>o,Kx:()=>r});var n=i(888418);const a=/[xy]/g;function s(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(a,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function o(e,t){try{if(void 0!==e&&"number"==typeof e)return t===n.V.None?!(e&n.V.LoggedInConsole):!!(e&t)}catch(e){console.log("Not valid")}}function r(e,t){return t|e}},844729:(e,t,i)=>{"use strict";i.d(t,{h:()=>s});var n=i(8122),a=i(921961);function s(e,t,i,s){return{[n.f.xMsClientType]:(0,a.I)(e,t),[n.f.xMsClientVersion]:e.config.clientVersion,[n.f.xMsSessionId]:e.host.sessionId,[n.f.xMsRequestId]:i||"",[n.f.xMsClientCaller]:s||""}}},820140:(e,t,i)=>{"use strict";i.d(t,{WD:()=>n,av:()=>a,ax:()=>s,Hs:()=>o,nC:()=>r,bM:()=>c});const n="mainAppWindowActiveEntities",a="appActiveEntitiesHistory",s="mainWindowNavHistory",o="mainWindowNavHistoryIndex",r=e=>{const t=["mainAppWindowActiveEntities","mainWindowNavHistory","mainWindowNavHistoryIndex"];return e&&t.push(`${e}-mainAppWindowActiveEntities`,`${e}-mainWindowNavHistory`,`${e}-mainWindowNavHistoryIndex`),t},c=(e,t)=>`${t?`${t}-`:""}${e}`},649247:(e,t,i)=>{"use strict";i.d(t,{q:()=>n});const n=e=>e instanceof Date&&!isNaN(e.getTime())},375754:(e,t,i)=>{"use strict";i.d(t,{H:()=>c,c:()=>l});var n=i(850402),a=i(328942),s=i(132756),o=i(738646),r=i(928665);const c="serviceId";class l{constructor(e,t,i,o,r,c){this.rebootService=e,this.host=t,this.logger=i,this.authenticationService=o,this.localStorage=r,this.experienceConfig=c,this.switchRing=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){yield this.clearCachedIndexFile();const t={qsps:{ring:e}};this.rebootService.rebootApp(a.Z.RingSwitch,a.d.DeveloperSwitchersService,t)})),this.clearContainer=()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){yield this.clearCachedIndexFile();this.rebootService.rebootApp(a.Z.ClearContainer,a.d.DeveloperSwitchersService,{qsps:{clearcontainer:"true"}})})),this.clearCachedIndexFile=()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var e;try{if(void 0!==this.host.caches){const t=yield this.host.caches.open(s.eL);yield t.delete(`/${null===(e=this.experienceConfig)||void 0===e?void 0:e.basePath}/`)}}catch(e){this.logger.error(`Clear cached index file before switching ring failed with error: ${e}`)}}))}switchService(e){var t,i,a,s;return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this.logger.log(`Switch service to ${e}`),this.authenticationService.logout){const n=this.localStorage.get(c,"Experience")||void 0;this.localStorage.setSafe(c,e,"Experience");const a=`logging out user to switch to service ${e}`;null===(i=(t=this.logger).infoToTelemetry)||void 0===i||i.call(t,a,"service_switch",{currentState:n,newState:e},!0);const s={id:(0,r.pW)(),source:"developer-switchers-resolvers",scenarioName:o.RG.AuthWebLogout};return yield this.authenticationService.logout({reason:a,correlation:s}),Promise.resolve(!0)}const n="authenticationService.logout not implemented!";return null===(s=(a=this.logger).errorToTelemetry)||void 0===s||s.call(a,n,"service_switch",{newState:e,error:n},!0),Promise.resolve(!1)}))}}},68950:(e,t,i)=>{"use strict";i.d(t,{gD:()=>u,fM:()=>m});var n=i(298117),a=i(475230);const s=new RegExp(a.yH.oneNoteTargetRegex),o=new RegExp(a.yH.oneNoteSectionRegex),r=e=>{const t=s.exec(e);let i="";return t&&(i=t[1]),i},c=e=>{const t=o.exec(e);let i="";return t&&(i=t[1]),i},l=new RegExp(a.yH.oneDriveFile),d=new RegExp(a.yH.sharePointFile),u=(e,t,i)=>{const s=(0,n.Q)(e),o=s?s.replace(a.yH.trailingSlashRegex,""):"";let r=null;if(l.test(e)){r={sourceTeamName:a.HV.personal,sourceChannelName:o.split("/").pop()}}else if(d.test(e)){const t=o.split("/").pop()||"",i=2;r={sourceTeamName:decodeURIComponent(t),sourceChannelName:decodeURIComponent(e.substring(o.length-1).split("/")[i])}}if(t===a.BY.extension&&-1!==(null==i?void 0:i.indexOf(a.BY.extensionWithDot))){const e=h(i);(null==e?void 0:e.sectionGroup)&&r&&(r.sourceChannelName=`${r.sourceChannelName} > ${e.sectionGroup}`),(null==e?void 0:e.section)&&r&&(r.sourceChannelName=`${r.sourceChannelName} > ${e.section}`)}return r},m=(e,t)=>{let i=null;const n=decodeURIComponent(e);let a=r(n),s=c(a),o="";if(s.includes("/")){const e=s.lastIndexOf("/");a=a.substring(e+1),s=s.substring(e+1)}s=g(s);const l=t;t=s;const d=a.indexOf("/");if(-1!==d){const e=a.lastIndexOf("|");let i=a.substring(d+1,e);i=g(i),t=i,o=s}return i={title:t,noteBook:l,section:o},i},g=e=>e.replace(/(?:\\(.))/g,"$1"),h=e=>{let t=null,i="",n="",a="";e&&(i=decodeURIComponent(e));let s=r(i),o=c(s);if(o.includes("/")){const e=o.lastIndexOf("/");if(a=o.substring(0,e),a){const e=a.split("/");let t="";e.forEach((e=>{t=""===t?e:`${t} > ${e}`})),a=t}s=s.substring(e+1),o=o.substring(e+1)}return-1!==s.indexOf("/")&&(n=o),t={sectionGroup:g(a),section:g(n)},t}},402750:(e,t,i)=>{"use strict";i.d(t,{V:()=>r});var n=i(514958),a=i(385589),s=i(475230),o=i(905581);const r=(e,t,i)=>{const r=l(e),d=(0,o.O$)(e,n.z.internalErrorCode),u=(0,o.O$)(e,n.z.httpCode,(null==e?void 0:e.code)||d||""),m={errorMessage:r,serverRequestId:(0,o.O$)(e,n.z.correlationId)};t(r),(0,a.X)(parseInt(u||"",10))&&!c(parseInt(u||"",10),d)?i&&i.fail({errors:JSON.stringify(m),errorCode:`${u}`}):i&&i.incomplete({errors:JSON.stringify(m),errorCode:`${u||s.BS.Unhandled}`})},c=(e,t)=>e&&e===s.Bx.badRequest&&t&&t===s.BS.InvalidRequest,l=e=>{let t=(0,o.O$)(e,n.z.logErrorMessage,(null==e?void 0:e.message)||"");const i=(0,o.O$)(e,"innerError",{message:""});t=`${t}. ${i?i.message:""}`;const a={context:null==e?void 0:e.context,subContext:null==e?void 0:e.subContext};return t=`${t}. ${JSON.stringify(a)}`,t}},596025:(e,t,i)=>{"use strict";i.d(t,{qB:()=>n,rF:()=>a,IJ:()=>s,Zw:()=>o});const n={SSO_TOKEN:"OutlookSSOToken",ADDIN_ERROR:"OutlookAddInError",SSO_READY:"OutlookSSOReady",USE_CACHED_SSO_TOKEN:"OutlookUseCachedSSOToken",SSO_COMPLETE_TIME:"OutlookSSOCompleteTime",DIALOG_TRIGGER_TIME:"OutlookDialogTriggerTime",CONTEXT:"STTOutlookContext",STEP_MARKERS:"STTOutlookStepMarkers",AUTH_STRAP_ERROR:"STTOutlookAuthStrapError",AUTH_STRAP_REDIRECT_TIME:"STTOutlookAuthStrapRedirect",OAUTH_START_TIME:"OutlookOAuthStartTime",OAUTH_ELAPSED_TIME:"OutlookOAuthElapsedTime",PLATFORM_INFO:"OutlookPlatformInfo",STT_START_TIME:"STTExperienceStartTime"};var a,s,o;!function(e){e[e.HOURS_PER_DAY=24]="HOURS_PER_DAY",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MILLISECS_PER_SECOND=1e3]="MILLISECS_PER_SECOND",e[e.TOKEN_EXP_MINUTE=10]="TOKEN_EXP_MINUTE",e[e.SSO_TIMEOUT_MILLISEC=7e3]="SSO_TIMEOUT_MILLISEC",e[e.SSO_RETRY_INTERVAL=100]="SSO_RETRY_INTERVAL",e[e.SSO_CLAIM_TIMEOUT_MINUTES=5]="SSO_CLAIM_TIMEOUT_MINUTES",e[e.SSO_CLAIM_TIMEOUT_MILLISEC=3e5]="SSO_CLAIM_TIMEOUT_MILLISEC",e[e.SSO_CLAIM_RETRY_INTERVAL=1e3]="SSO_CLAIM_RETRY_INTERVAL",e[e.STT_USAGE_EXPIRATION_DAYS=15]="STT_USAGE_EXPIRATION_DAYS",e[e.STT_USAGE_EXPIRATION_MILLISEC=1296e6]="STT_USAGE_EXPIRATION_MILLISEC"}(a||(a={})),function(e){e.NotProvided="NotProvided",e.Expired="Expired",e.Valid="Valid",e.Invalid="Invalid"}(s||(s={})),function(e){e.SSO="SSO",e.OAuth="OAuth"}(o||(o={}))},929778:(e,t,i)=>{"use strict";i.d(t,{j:()=>o});var n=i(337625),a=i(318379),s=i(433728);const o=(e,t,i,o)=>(0,n.z)((0,a.R)(((i,n)=>Array.from(function*(e,t,i,n){const a=e[Symbol.iterator](),s=t[Symbol.iterator]();let o=a.next(),r=s.next();for(;!r.done||!o.done;)r.done||!o.done&&r.value.id>o.value[0].id?(n(o.value[1]),o=a.next()):o.done||r.value.id<o.value[0].id?(yield[r.value,i(r.value)],r=s.next()):(yield[r.value,o.value[1]],o=a.next(),r=s.next())}(i,Array.from(n).sort(((e,t)=>e.id.localeCompare(t.id))),(t=>{try{return{type:"value",value:e(t)}}catch(e){return o&&o(t,e),{type:"error",error:e}}}),(e=>{if("error"!==e.type)return t(e.value)})))),[]),(0,s.U)((e=>e.filter((e=>"value"===e[1].type)).map((e=>i(e[0],e[1].value))))))},377381:(e,t,i)=>{"use strict";i.d(t,{eG:()=>r,Pe:()=>o,cX:()=>c});var n=i(516909);const a={callId:"callId",threadId:"threadId",participantId:"participantId",callState:"call_state",callMode:"callMode",meetingRole:"meetingRole",streamingType:"streamingType",streamingData:"streamingData",streamingError:"streamingError",deliveryPipelineType:"delivery_pipeline_type"},s={townhall:"townhall",overflowV2:"overflowV2"},o=e=>e?n.fNg.Townhall:n.fNg.OverflowV2,r=e=>{const t=e.map((e=>{var t,i,n,a,s,o,r,c,l;let d=JSON.stringify(e);(null==e?void 0:e.keyAuthorizationToken)&&(d=d.replace(e.keyAuthorizationToken,e.keyAuthorizationToken?"valid":"invalid")),(null===(t=null==e?void 0:e.decryptionKey)||void 0===t?void 0:t.value)&&(d=d.replace(null===(i=null==e?void 0:e.decryptionKey)||void 0===i?void 0:i.value,(null===(n=null==e?void 0:e.decryptionKey)||void 0===n?void 0:n.value)?"valid":"invalid"));const u=null==e?void 0:e.transcription;return(null===(a=null==u?void 0:u.aesKey)||void 0===a?void 0:a.key)&&(d=d.replace(null===(s=null==u?void 0:u.aesKey)||void 0===s?void 0:s.key,(null===(o=null==u?void 0:u.aesKey)||void 0===o?void 0:o.key)?"valid":"invalid")),(null===(r=null==u?void 0:u.aesKey)||void 0===r?void 0:r.iv)&&(d=d.replace(null===(c=u.aesKey)||void 0===c?void 0:c.iv,(null===(l=u.aesKey)||void 0===l?void 0:l.iv)?"valid":"invalid")),d}));return JSON.stringify(t)},c=(e,t,i,n)=>{if(!e)return{};const{callId:o,threadId:r,participantId:c,callMode:l,meetingRole:d,forceAttendeeStreaming:u,streamingModeActive:m,participantBotId:g}=e,h={};o&&(h[a.callId]=o),r&&(h[a.threadId]=r),c&&(h[a.participantId]=c),h[a.callMode]=l||"",h[a.meetingRole]=d,h[a.streamingData]=JSON.stringify({forceAttendeeStreaming:u,streamingModeActive:m}),u?h[a.streamingType]=s.townhall:m&&(h[a.streamingType]=s.overflowV2);let p=g?{forceAttendeeStreaming:u,streamingModeActive:m}:{forceAttendeeStreaming:u,streamingModeActive:m,participantBotId:g};return i&&(p=Object.assign(Object.assign({},p),i)),h[a.streamingData]=JSON.stringify(p),n&&(h[a.deliveryPipelineType]=n),t&&(h[a.streamingError]=JSON.stringify(t)),h}},641639:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var n=i(263662);const a=(e,t)=>{try{return e.matchMedia(n.s0.ColorContrastOverride).matches?(null==t||t.log(`OS Theme Matches: ${n.s0.ColorContrastOverride}`),n.f8.Contrast):e.matchMedia(n.s0.Dark).matches?(null==t||t.log(`OS Theme Matches: ${n.s0.Dark}`),n.f8.Dark):e.matchMedia(n.s0.Light).matches?(null==t||t.log(`OS Theme Matches: ${n.s0.Light}`),n.f8.Light):(null==t||t.log("OS Theme Matches: None. Returning theme type light."),n.f8.Light)}catch(e){return void(null==t||t.log(`Couldn't resolve getOsTheme: ${e.message}`))}}},383392:(e,t,i)=>{"use strict";i.d(t,{R6:()=>o,OA:()=>c,u_:()=>l});var n=i(793377),a=i(263662),s=i(641639);const o=e=>({[a.f8.Light]:e===n.s.life?a.Q2.DefaultTfl:a.Q2.DefaultV2,[a.f8.Dark]:e===n.s.life?a.Q2.DarkTfl:a.Q2.DarkV2,[a.f8.Contrast]:a.Q2.HighContrast}),r=(e,t)=>t[e]||a.Q2.DefaultV2,c=e=>((e,t)=>t[e]||a.f8.Light)(e,{[a.Q2.Default]:a.f8.Light,[a.Q2.DefaultV2]:a.f8.Light,[a.Q2.DefaultTfl]:a.f8.Light,[a.Q2.Dark]:a.f8.Dark,[a.Q2.DarkV2]:a.f8.Dark,[a.Q2.DarkTfl]:a.f8.Dark,[a.Q2.HighContrast]:a.f8.Contrast}),l=(e,t,i,n)=>{var o;const c=d(t);if(c)return c;const l=null!==(o=e.getPreferences("theme"))&&void 0!==o?o:{};if(l.followOsTheme){const e=(0,s.Z)(t,n);if(e)return r(e,i)}else if(l.userTheme)return r(l.userTheme,i);return a.Q2.DefaultV2},d=e=>{const t=new URLSearchParams(e.location.search).get("theme");if(t){const e=Object.keys(a.Q2).find((e=>e.toUpperCase()===t.toUpperCase()));return a.Q2[e]}}},535151:(e,t,i)=>{"use strict";i.d(t,{as:()=>n});const n=(e,t)=>{if(e.is(t))return t;throw new TypeError}},122057:(e,t,i)=>{var n={"./ar-sa/activity.js":[298228,548479],"./ar-sa/artifacts-platform.js":[88162,93e3],"./ar-sa/audience-view-dialog.js":[888145,965514],"./ar-sa/auth.js":[595308,354735],"./ar-sa/autosuggest.js":[543117,518048],"./ar-sa/avatar.js":[607748,64426],"./ar-sa/biometric-enrollment.js":[772192,157733],"./ar-sa/breakout-rooms.js":[992492,22175],"./ar-sa/broadcast.js":[567708,991574],"./ar-sa/calendar.js":[864153,356098],"./ar-sa/calling.js":[195108,628202],"./ar-sa/campaign-notifications.js":[191240,722426],"./ar-sa/carousel-multi-card.js":[189519,347758],"./ar-sa/cast.js":[74267,847398],"./ar-sa/channels.js":[141251,551018],"./ar-sa/chat-list.js":[445002,996388],"./ar-sa/coach-report.js":[660310,853988],"./ar-sa/comment-stream.js":[413591,68194],"./ar-sa/communities.js":[336272,322610],"./ar-sa/compose.js":[548512,548329],"./ar-sa/contacts.js":[637084,1639],"./ar-sa/datepicker.js":[316194,931640],"./ar-sa/desktop.js":[780276,780364],"./ar-sa/digital-signage.js":[233502,704803],"./ar-sa/discover-surface.js":[475585,515885],"./ar-sa/edu.js":[934064,352415],"./ar-sa/embed.js":[113687,642420],"./ar-sa/errors.js":[530122,925455],"./ar-sa/esp.js":[601750,120778],"./ar-sa/extensibility-ptz-extension.js":[399801,209921],"./ar-sa/extensibility-room-remote.js":[529276,972675],"./ar-sa/extensibility.js":[114969,78385],"./ar-sa/feedback.js":[749779,598244],"./ar-sa/files.js":[832242,375804],"./ar-sa/framework.js":[6173,872239],"./ar-sa/freemium-upgrade.js":[335725,257931],"./ar-sa/freemium.js":[922242,293506],"./ar-sa/funstuff.js":[137745,864486],"./ar-sa/gallery.js":[358430,632896],"./ar-sa/growth.js":[282773,641847],"./ar-sa/guardians.js":[975917,481608],"./ar-sa/health.js":[78071,173399],"./ar-sa/help.js":[514014,823029],"./ar-sa/hololens.js":[500181,155138],"./ar-sa/host-controls.js":[5994,406740],"./ar-sa/jana.js":[276413,622768],"./ar-sa/lightbox.js":[405856,521202],"./ar-sa/live-persona-card.js":[435088,165950],"./ar-sa/live-persona-editor.js":[608250,163348],"./ar-sa/lms-integration.js":[707115,593038],"./ar-sa/meet-for-work.js":[119432,245171],"./ar-sa/meeting-analytics.js":[179106,530807],"./ar-sa/meeting-apis-app.js":[447927,299785],"./ar-sa/meeting-bot.js":[560816,68316],"./ar-sa/meeting-collaboration.js":[814319,844630],"./ar-sa/meeting-flyout.js":[363053,376422],"./ar-sa/meeting-meet-app.js":[3367,309711],"./ar-sa/meeting-options.js":[325264,300420],"./ar-sa/meeting-recap.js":[273372,492685],"./ar-sa/meeting-room-console.js":[991860,706421],"./ar-sa/meeting-stream-app.js":[996841,953166],"./ar-sa/message-escalate-dialog.js":[781308,66608],"./ar-sa/messaging.js":[185498,348151],"./ar-sa/mtma-missed-notifications.js":[990846,715715],"./ar-sa/nova.js":[874036,208738],"./ar-sa/people-app.js":[413784,906848],"./ar-sa/people-picker.js":[591045,617235],"./ar-sa/people-targeting.js":[967062,749962],"./ar-sa/people.js":[1227,802050],"./ar-sa/person.js":[748843,208981],"./ar-sa/phonelink-sms.js":[629996,441788],"./ar-sa/pre-core.js":[202332,938083],"./ar-sa/premium-benefits.js":[805199,389026],"./ar-sa/presence.js":[703038,154803],"./ar-sa/queues.js":[67334,388172],"./ar-sa/recurrence.js":[738554,434022],"./ar-sa/rsc-application-permissions.js":[789964,14153],"./ar-sa/search.js":[212523,701333],"./ar-sa/semantic-object.js":[256916,646647],"./ar-sa/settings.js":[19448,481968],"./ar-sa/share-in-meetings.js":[718033,220996],"./ar-sa/share-to-teams-outlook-addin.js":[907486,968620],"./ar-sa/share-to-teams-third-party.js":[642731,20676],"./ar-sa/share-to-teams.js":[455594,581675],"./ar-sa/shortcut.js":[307893,658610],"./ar-sa/shortcuts.js":[594776,670947],"./ar-sa/simple-collab.js":[412227,944423],"./ar-sa/smart-device.js":[338471,867187],"./ar-sa/survey.js":[271363,986127],"./ar-sa/sv-flyout.js":[742358,589487],"./ar-sa/teams-and-channels.js":[364241,967034],"./ar-sa/teams-insider.js":[574280,284843],"./ar-sa/telemetry.js":[426556,913560],"./ar-sa/tfl-homepage.js":[262728,346447],"./ar-sa/tfl-onboarding.js":[954278,195584],"./ar-sa/toast-notifications.js":[223006,904183],"./ar-sa/unified-search.js":[295939,717268],"./ar-sa/unsupported-browser.js":[939676,528229],"./ar-sa/url-preview.js":[622171,551689],"./ar-sa/video-capture.js":[21592,85245],"./ar-sa/video-message.js":[131535,58562],"./ar-sa/virtual-events.js":[385164,269548],"./ar-sa/webinar.js":[987909,322845],"./ar-sa/welcome-bot.js":[507519,735776],"./ar-sa/whats-new.js":[126945,343531],"./ar-sa/wiki.js":[223433,715379],"./az-latn-az/activity.js":[687364,104016],"./az-latn-az/artifacts-platform.js":[111918,557579],"./az-latn-az/audience-view-dialog.js":[573645,186931],"./az-latn-az/auth.js":[430280,869707],"./az-latn-az/autosuggest.js":[12614,250148],"./az-latn-az/avatar.js":[455166,550237],"./az-latn-az/biometric-enrollment.js":[312605,121617],"./az-latn-az/breakout-rooms.js":[37296,608178],"./az-latn-az/broadcast.js":[242698,967758],"./az-latn-az/calendar.js":[784508,289297],"./az-latn-az/calling.js":[23929,81686],"./az-latn-az/campaign-notifications.js":[144149,34904],"./az-latn-az/carousel-multi-card.js":[917386,798392],"./az-latn-az/cast.js":[429021,837860],"./az-latn-az/channels.js":[892980,949835],"./az-latn-az/chat-list.js":[935940,622562],"./az-latn-az/coach-report.js":[77752,743811],"./az-latn-az/comment-stream.js":[389229,656713],"./az-latn-az/communities.js":[971158,844563],"./az-latn-az/compose.js":[459118,54193],"./az-latn-az/contacts.js":[609885,901657],"./az-latn-az/datepicker.js":[877411,993829],"./az-latn-az/desktop.js":[864014,993433],"./az-latn-az/digital-signage.js":[239530,126715],"./az-latn-az/discover-surface.js":[157995,761242],"./az-latn-az/edu.js":[581861,949702],"./az-latn-az/embed.js":[125631,948952],"./az-latn-az/errors.js":[455173,508850],"./az-latn-az/esp.js":[34051,449610],"./az-latn-az/extensibility-ptz-extension.js":[687437,97312],"./az-latn-az/extensibility-room-remote.js":[675329,219850],"./az-latn-az/extensibility.js":[639092,931868],"./az-latn-az/feedback.js":[612295,730027],"./az-latn-az/files.js":[305138,235512],"./az-latn-az/framework.js":[967296,187556],"./az-latn-az/freemium-upgrade.js":[439698,468660],"./az-latn-az/freemium.js":[985993,593704],"./az-latn-az/funstuff.js":[304579,639910],"./az-latn-az/gallery.js":[13550,822399],"./az-latn-az/growth.js":[471030,984601],"./az-latn-az/guardians.js":[615265,215710],"./az-latn-az/health.js":[384375,625344],"./az-latn-az/help.js":[624759,868485],"./az-latn-az/hololens.js":[381837,506865],"./az-latn-az/host-controls.js":[443087,384896],"./az-latn-az/jana.js":[223783,457725],"./az-latn-az/lightbox.js":[463515,366629],"./az-latn-az/live-persona-card.js":[20600,617804],"./az-latn-az/live-persona-editor.js":[490024,346646],"./az-latn-az/lms-integration.js":[727003,173524],"./az-latn-az/meet-for-work.js":[292367,419632],"./az-latn-az/meeting-analytics.js":[175229,525152],"./az-latn-az/meeting-apis-app.js":[410943,609301],"./az-latn-az/meeting-bot.js":[528259,619158],"./az-latn-az/meeting-collaboration.js":[869178,281978],"./az-latn-az/meeting-flyout.js":[893412,977012],"./az-latn-az/meeting-meet-app.js":[309995,440840],"./az-latn-az/meeting-options.js":[884935,17836],"./az-latn-az/meeting-recap.js":[143912,32567],"./az-latn-az/meeting-room-console.js":[656869,739791],"./az-latn-az/meeting-stream-app.js":[7495,354540],"./az-latn-az/message-escalate-dialog.js":[767625,956147],"./az-latn-az/messaging.js":[146971,167685],"./az-latn-az/mtma-missed-notifications.js":[77989,451825],"./az-latn-az/nova.js":[549160,28043],"./az-latn-az/people-app.js":[690151,706295],"./az-latn-az/people-picker.js":[257045,924380],"./az-latn-az/people-targeting.js":[33099,753596],"./az-latn-az/people.js":[193730,996028],"./az-latn-az/person.js":[643245,94505],"./az-latn-az/phonelink-sms.js":[34067,118013],"./az-latn-az/pre-core.js":[606665,97392],"./az-latn-az/premium-benefits.js":[345927,601712],"./az-latn-az/presence.js":[599444,884358],"./az-latn-az/queues.js":[202888,317627],"./az-latn-az/recurrence.js":[981881,523871],"./az-latn-az/rsc-application-permissions.js":[899085,695765],"./az-latn-az/search.js":[456853,70125],"./az-latn-az/semantic-object.js":[986718,631007],"./az-latn-az/settings.js":[144439,726882],"./az-latn-az/share-in-meetings.js":[929819,430624],"./az-latn-az/share-to-teams-outlook-addin.js":[754829,435812],"./az-latn-az/share-to-teams-third-party.js":[240764,26078],"./az-latn-az/share-to-teams.js":[673975,390904],"./az-latn-az/shortcut.js":[658541,965641],"./az-latn-az/shortcuts.js":[819260,563258],"./az-latn-az/simple-collab.js":[839975,540958],"./az-latn-az/smart-device.js":[290589,254723],"./az-latn-az/survey.js":[772445,809264],"./az-latn-az/sv-flyout.js":[96338,931860],"./az-latn-az/teams-and-channels.js":[642409,642298],"./az-latn-az/teams-insider.js":[367276,21524],"./az-latn-az/telemetry.js":[79433,274225],"./az-latn-az/tfl-homepage.js":[317572,301252],"./az-latn-az/tfl-onboarding.js":[379901,385312],"./az-latn-az/toast-notifications.js":[272620,607729],"./az-latn-az/unified-search.js":[541976,352277],"./az-latn-az/unsupported-browser.js":[762693,257687],"./az-latn-az/url-preview.js":[579462,94385],"./az-latn-az/video-capture.js":[97013,282534],"./az-latn-az/video-message.js":[486314,215738],"./az-latn-az/virtual-events.js":[910969,694925],"./az-latn-az/webinar.js":[469951,520068],"./az-latn-az/welcome-bot.js":[273165,620244],"./az-latn-az/whats-new.js":[231175,75783],"./az-latn-az/wiki.js":[406101,370004],"./bg-bg/activity.js":[271390,542212],"./bg-bg/artifacts-platform.js":[956094,557148],"./bg-bg/audience-view-dialog.js":[907319,228743],"./bg-bg/auth.js":[923495,732214],"./bg-bg/autosuggest.js":[115652,48771],"./bg-bg/avatar.js":[571935,486238],"./bg-bg/biometric-enrollment.js":[40165,555811],"./bg-bg/breakout-rooms.js":[286088,306529],"./bg-bg/broadcast.js":[245489,624838],"./bg-bg/calendar.js":[535505,674562],"./bg-bg/calling.js":[367578,358342],"./bg-bg/campaign-notifications.js":[800223,79091],"./bg-bg/carousel-multi-card.js":[995403,844070],"./bg-bg/cast.js":[699103,755859],"./bg-bg/channels.js":[906821,689908],"./bg-bg/chat-list.js":[334918,13167],"./bg-bg/coach-report.js":[239658,908199],"./bg-bg/comment-stream.js":[251148,72340],"./bg-bg/communities.js":[946077,25118],"./bg-bg/compose.js":[40584,957070],"./bg-bg/contacts.js":[821789,773469],"./bg-bg/datepicker.js":[757005,504752],"./bg-bg/desktop.js":[512734,96545],"./bg-bg/digital-signage.js":[340656,409393],"./bg-bg/discover-surface.js":[324353,826844],"./bg-bg/edu.js":[979877,42250],"./bg-bg/embed.js":[469220,870024],"./bg-bg/errors.js":[130743,315084],"./bg-bg/esp.js":[153596,740083],"./bg-bg/extensibility-ptz-extension.js":[166732,56508],"./bg-bg/extensibility-room-remote.js":[230033,979530],"./bg-bg/extensibility.js":[30873,888900],"./bg-bg/feedback.js":[249425,573484],"./bg-bg/files.js":[447659,973221],"./bg-bg/framework.js":[374608,506606],"./bg-bg/freemium-upgrade.js":[878855,391809],"./bg-bg/freemium.js":[929706,691548],"./bg-bg/funstuff.js":[82961,124099],"./bg-bg/gallery.js":[310654,695651],"./bg-bg/growth.js":[793190,621125],"./bg-bg/guardians.js":[924970,682389],"./bg-bg/health.js":[759762,454145],"./bg-bg/help.js":[972175,400101],"./bg-bg/hololens.js":[722758,849027],"./bg-bg/host-controls.js":[972002,676634],"./bg-bg/jana.js":[787676,992546],"./bg-bg/lightbox.js":[79091,638563],"./bg-bg/live-persona-card.js":[960370,891782],"./bg-bg/live-persona-editor.js":[798306,418505],"./bg-bg/lms-integration.js":[516755,168204],"./bg-bg/meet-for-work.js":[682769,991987],"./bg-bg/meeting-analytics.js":[971873,528944],"./bg-bg/meeting-apis-app.js":[757732,994095],"./bg-bg/meeting-bot.js":[194041,694153],"./bg-bg/meeting-collaboration.js":[723047,626298],"./bg-bg/meeting-flyout.js":[611422,666917],"./bg-bg/meeting-meet-app.js":[387788,149373],"./bg-bg/meeting-options.js":[786780,66062],"./bg-bg/meeting-recap.js":[612996,644924],"./bg-bg/meeting-room-console.js":[956165,410067],"./bg-bg/meeting-stream-app.js":[923627,354905],"./bg-bg/message-escalate-dialog.js":[77514,795079],"./bg-bg/messaging.js":[153968,682645],"./bg-bg/mtma-missed-notifications.js":[696268,878330],"./bg-bg/nova.js":[575596,730418],"./bg-bg/people-app.js":[132978,564900],"./bg-bg/people-picker.js":[358008,53945],"./bg-bg/people-targeting.js":[809330,811511],"./bg-bg/people.js":[939180,984815],"./bg-bg/person.js":[417112,239620],"./bg-bg/phonelink-sms.js":[875957,85537],"./bg-bg/pre-core.js":[380474,372298],"./bg-bg/premium-benefits.js":[173487,21237],"./bg-bg/presence.js":[641233,35621],"./bg-bg/queues.js":[578802,354725],"./bg-bg/recurrence.js":[232682,237946],"./bg-bg/rsc-application-permissions.js":[648873,985324],"./bg-bg/search.js":[185417,854343],"./bg-bg/semantic-object.js":[66619,329123],"./bg-bg/settings.js":[798720,996681],"./bg-bg/share-in-meetings.js":[372062,424998],"./bg-bg/share-to-teams-outlook-addin.js":[894938,301315],"./bg-bg/share-to-teams-third-party.js":[665090,339008],"./bg-bg/share-to-teams.js":[501089,770078],"./bg-bg/shortcut.js":[183282,250449],"./bg-bg/shortcuts.js":[439841,707520],"./bg-bg/simple-collab.js":[151537,52334],"./bg-bg/smart-device.js":[975155,570014],"./bg-bg/survey.js":[82625,534909],"./bg-bg/sv-flyout.js":[728558,440281],"./bg-bg/teams-and-channels.js":[689885,353488],"./bg-bg/teams-insider.js":[207829,409586],"./bg-bg/telemetry.js":[612708,742986],"./bg-bg/tfl-homepage.js":[464975,484734],"./bg-bg/tfl-onboarding.js":[126555,464824],"./bg-bg/toast-notifications.js":[623136,190387],"./bg-bg/unified-search.js":[27584,981968],"./bg-bg/unsupported-browser.js":[523529,320457],"./bg-bg/url-preview.js":[989155,437061],"./bg-bg/video-capture.js":[896494,672603],"./bg-bg/video-message.js":[808889,449680],"./bg-bg/virtual-events.js":[232420,519960],"./bg-bg/webinar.js":[756834,379413],"./bg-bg/welcome-bot.js":[765766,792821],"./bg-bg/whats-new.js":[872404,815451],"./bg-bg/wiki.js":[26458,216161],"./ca-es-valencia/activity.js":[12467,20136],"./ca-es-valencia/artifacts-platform.js":[408541,449898],"./ca-es-valencia/audience-view-dialog.js":[66496,548697],"./ca-es-valencia/auth.js":[156705,964669],"./ca-es-valencia/autosuggest.js":[367912,984098],"./ca-es-valencia/avatar.js":[252446,87899],"./ca-es-valencia/biometric-enrollment.js":[240891,900837],"./ca-es-valencia/breakout-rooms.js":[682573,680441],"./ca-es-valencia/broadcast.js":[748779,294553],"./ca-es-valencia/calendar.js":[945905,800502],"./ca-es-valencia/calling.js":[618139,223341],"./ca-es-valencia/campaign-notifications.js":[852129,221265],"./ca-es-valencia/carousel-multi-card.js":[91079,903862],"./ca-es-valencia/cast.js":[340614,238456],"./ca-es-valencia/channels.js":[255741,458001],"./ca-es-valencia/chat-list.js":[632874,975602],"./ca-es-valencia/coach-report.js":[533486,632287],"./ca-es-valencia/comment-stream.js":[514259,797209],"./ca-es-valencia/communities.js":[446515,813665],"./ca-es-valencia/compose.js":[374365,135869],"./ca-es-valencia/contacts.js":[987475,845302],"./ca-es-valencia/datepicker.js":[372784,591540],"./ca-es-valencia/desktop.js":[433411,614553],"./ca-es-valencia/digital-signage.js":[357284,687007],"./ca-es-valencia/discover-surface.js":[504406,934410],"./ca-es-valencia/edu.js":[988085,237271],"./ca-es-valencia/embed.js":[258081,212352],"./ca-es-valencia/errors.js":[321064,24054],"./ca-es-valencia/esp.js":[775643,266302],"./ca-es-valencia/extensibility-ptz-extension.js":[312068,759478],"./ca-es-valencia/extensibility-room-remote.js":[328261,494286],"./ca-es-valencia/extensibility.js":[318357,188231],"./ca-es-valencia/feedback.js":[446402,557931],"./ca-es-valencia/files.js":[226584,154645],"./ca-es-valencia/framework.js":[55604,944566],"./ca-es-valencia/freemium-upgrade.js":[928837,474404],"./ca-es-valencia/freemium.js":[717759,870760],"./ca-es-valencia/funstuff.js":[628342,154251],"./ca-es-valencia/gallery.js":[196271,581857],"./ca-es-valencia/growth.js":[254194,614991],"./ca-es-valencia/guardians.js":[435602,223041],"./ca-es-valencia/health.js":[3438,133047],"./ca-es-valencia/help.js":[920604,853760],"./ca-es-valencia/hololens.js":[929743,97740],"./ca-es-valencia/host-controls.js":[451483,814557],"./ca-es-valencia/jana.js":[741691,838171],"./ca-es-valencia/lightbox.js":[405037,268355],"./ca-es-valencia/live-persona-card.js":[463066,364681],"./ca-es-valencia/live-persona-editor.js":[408057,6204],"./ca-es-valencia/lms-integration.js":[37622,281439],"./ca-es-valencia/meet-for-work.js":[206974,254641],"./ca-es-valencia/meeting-analytics.js":[396298,380400],"./ca-es-valencia/meeting-apis-app.js":[396425,150577],"./ca-es-valencia/meeting-bot.js":[499204,520455],"./ca-es-valencia/meeting-collaboration.js":[468590,360940],"./ca-es-valencia/meeting-flyout.js":[626336,259659],"./ca-es-valencia/meeting-meet-app.js":[23535,472905],"./ca-es-valencia/meeting-options.js":[988223,175245],"./ca-es-valencia/meeting-recap.js":[912737,665670],"./ca-es-valencia/meeting-room-console.js":[830171,162689],"./ca-es-valencia/meeting-stream-app.js":[846352,363651],"./ca-es-valencia/message-escalate-dialog.js":[307400,601959],"./ca-es-valencia/messaging.js":[3674,792645],"./ca-es-valencia/mtma-missed-notifications.js":[704847,5631],"./ca-es-valencia/nova.js":[304086,657191],"./ca-es-valencia/people-app.js":[532742,133346],"./ca-es-valencia/people-picker.js":[281561,179041],"./ca-es-valencia/people-targeting.js":[864092,164557],"./ca-es-valencia/people.js":[75049,758206],"./ca-es-valencia/person.js":[897923,178429],"./ca-es-valencia/phonelink-sms.js":[183074,369263],"./ca-es-valencia/pre-core.js":[62511,564138],"./ca-es-valencia/premium-benefits.js":[331810,56071],"./ca-es-valencia/presence.js":[346318,182773],"./ca-es-valencia/queues.js":[836480,357352],"./ca-es-valencia/recurrence.js":[460728,635815],"./ca-es-valencia/rsc-application-permissions.js":[77773,875412],"./ca-es-valencia/search.js":[499971,847885],"./ca-es-valencia/semantic-object.js":[2617,875261],"./ca-es-valencia/settings.js":[416674,581512],"./ca-es-valencia/share-in-meetings.js":[291528,736018],"./ca-es-valencia/share-to-teams-outlook-addin.js":[781784,549437],"./ca-es-valencia/share-to-teams-third-party.js":[126913,254789],"./ca-es-valencia/share-to-teams.js":[928115,692889],"./ca-es-valencia/shortcut.js":[919731,750054],"./ca-es-valencia/shortcuts.js":[701357,302773],"./ca-es-valencia/simple-collab.js":[666972,158267],"./ca-es-valencia/smart-device.js":[146542,114580],"./ca-es-valencia/survey.js":[794807,149558],"./ca-es-valencia/sv-flyout.js":[445921,839966],"./ca-es-valencia/teams-and-channels.js":[17256,210130],"./ca-es-valencia/teams-insider.js":[304003,87647],"./ca-es-valencia/telemetry.js":[408335,644880],"./ca-es-valencia/tfl-homepage.js":[500923,862986],"./ca-es-valencia/tfl-onboarding.js":[656013,233408],"./ca-es-valencia/toast-notifications.js":[513251,544136],"./ca-es-valencia/unified-search.js":[451392,927265],"./ca-es-valencia/unsupported-browser.js":[640657,510129],"./ca-es-valencia/url-preview.js":[275142,701963],"./ca-es-valencia/video-capture.js":[547471,663304],"./ca-es-valencia/video-message.js":[732839,299224],"./ca-es-valencia/virtual-events.js":[166362,539854],"./ca-es-valencia/webinar.js":[34011,219300],"./ca-es-valencia/welcome-bot.js":[313153,838313],"./ca-es-valencia/whats-new.js":[691254,391559],"./ca-es-valencia/wiki.js":[903778,423968],"./ca-es/activity.js":[219480,569979],"./ca-es/artifacts-platform.js":[87800,13358],"./ca-es/audience-view-dialog.js":[294035,815281],"./ca-es/auth.js":[590272,812701],"./ca-es/autosuggest.js":[462820,996730],"./ca-es/avatar.js":[596172,320464],"./ca-es/biometric-enrollment.js":[101372,471042],"./ca-es/breakout-rooms.js":[340251,885059],"./ca-es/broadcast.js":[366520,182363],"./ca-es/calendar.js":[65327,5694],"./ca-es/calling.js":[277835,992180],"./ca-es/campaign-notifications.js":[96211,99023],"./ca-es/carousel-multi-card.js":[266188,366176],"./ca-es/cast.js":[806436,310861],"./ca-es/channels.js":[886868,765593],"./ca-es/chat-list.js":[668979,511807],"./ca-es/coach-report.js":[48935,826703],"./ca-es/comment-stream.js":[295285,581181],"./ca-es/communities.js":[999489,927462],"./ca-es/compose.js":[961357,883840],"./ca-es/contacts.js":[281997,881073],"./ca-es/datepicker.js":[630467,747958],"./ca-es/desktop.js":[414773,812188],"./ca-es/digital-signage.js":[216620,265130],"./ca-es/discover-surface.js":[954229,647799],"./ca-es/edu.js":[271104,267041],"./ca-es/embed.js":[317485,166046],"./ca-es/errors.js":[450345,581369],"./ca-es/esp.js":[80584,56865],"./ca-es/extensibility-ptz-extension.js":[530336,319722],"./ca-es/extensibility-room-remote.js":[998849,812099],"./ca-es/extensibility.js":[142619,305551],"./ca-es/feedback.js":[147435,980234],"./ca-es/files.js":[908523,613734],"./ca-es/framework.js":[408222,602605],"./ca-es/freemium-upgrade.js":[982435,984464],"./ca-es/freemium.js":[741027,794780],"./ca-es/funstuff.js":[187769,701796],"./ca-es/gallery.js":[380508,271497],"./ca-es/growth.js":[503341,388561],"./ca-es/guardians.js":[129003,107648],"./ca-es/health.js":[119534,465017],"./ca-es/help.js":[32412,275221],"./ca-es/hololens.js":[178328,759214],"./ca-es/host-controls.js":[535841,640182],"./ca-es/jana.js":[927267,346208],"./ca-es/lightbox.js":[114404,203183],"./ca-es/live-persona-card.js":[784037,777253],"./ca-es/live-persona-editor.js":[957699,165191],"./ca-es/lms-integration.js":[445257,752426],"./ca-es/meet-for-work.js":[383095,670966],"./ca-es/meeting-analytics.js":[415163,797124],"./ca-es/meeting-apis-app.js":[866115,617981],"./ca-es/meeting-bot.js":[951762,23742],"./ca-es/meeting-collaboration.js":[179961,926162],"./ca-es/meeting-flyout.js":[313713,383371],"./ca-es/meeting-meet-app.js":[412928,321003],"./ca-es/meeting-options.js":[739407,393253],"./ca-es/meeting-recap.js":[192498,876073],"./ca-es/meeting-room-console.js":[595939,987245],"./ca-es/meeting-stream-app.js":[526847,735674],"./ca-es/message-escalate-dialog.js":[326868,544689],"./ca-es/messaging.js":[969388,885763],"./ca-es/mtma-missed-notifications.js":[232864,6095],"./ca-es/nova.js":[382646,377504],"./ca-es/people-app.js":[602460,291346],"./ca-es/people-picker.js":[121792,618231],"./ca-es/people-targeting.js":[908073,549118],"./ca-es/people.js":[381498,416117],"./ca-es/person.js":[211378,72526],"./ca-es/phonelink-sms.js":[762931,831722],"./ca-es/pre-core.js":[61565,75727],"./ca-es/premium-benefits.js":[482552,157269],"./ca-es/presence.js":[423059,78269],"./ca-es/queues.js":[960409,49742],"./ca-es/recurrence.js":[698906,108416],"./ca-es/rsc-application-permissions.js":[441917,678932],"./ca-es/search.js":[969225,72869],"./ca-es/semantic-object.js":[697997,595214],"./ca-es/settings.js":[7038,95884],"./ca-es/share-in-meetings.js":[453419,306978],"./ca-es/share-to-teams-outlook-addin.js":[753092,922637],"./ca-es/share-to-teams-third-party.js":[46064,287688],"./ca-es/share-to-teams.js":[716774,371306],"./ca-es/shortcut.js":[708220,290134],"./ca-es/shortcuts.js":[951071,739577],"./ca-es/simple-collab.js":[95685,419926],"./ca-es/smart-device.js":[347365,313304],"./ca-es/survey.js":[92859,771767],"./ca-es/sv-flyout.js":[972159,592101],"./ca-es/teams-and-channels.js":[860774,974697],"./ca-es/teams-insider.js":[154447,495284],"./ca-es/telemetry.js":[717785,556929],"./ca-es/tfl-homepage.js":[605919,51487],"./ca-es/tfl-onboarding.js":[740381,743783],"./ca-es/toast-notifications.js":[207965,971365],"./ca-es/unified-search.js":[790744,764722],"./ca-es/unsupported-browser.js":[838041,684619],"./ca-es/url-preview.js":[860458,18081],"./ca-es/video-capture.js":[111666,733401],"./ca-es/video-message.js":[286812,800682],"./ca-es/virtual-events.js":[564248,641355],"./ca-es/webinar.js":[745923,574615],"./ca-es/welcome-bot.js":[671916,316968],"./ca-es/whats-new.js":[106914,387728],"./ca-es/wiki.js":[31660,462438],"./cs-cz/activity.js":[850979,739192],"./cs-cz/artifacts-platform.js":[650946,162582],"./cs-cz/audience-view-dialog.js":[714313,302621],"./cs-cz/auth.js":[390459,703250],"./cs-cz/autosuggest.js":[280930,588593],"./cs-cz/avatar.js":[569204,803291],"./cs-cz/biometric-enrollment.js":[720178,331224],"./cs-cz/breakout-rooms.js":[947363,45978],"./cs-cz/broadcast.js":[529226,336969],"./cs-cz/calendar.js":[582789,587864],"./cs-cz/calling.js":[643919,544349],"./cs-cz/campaign-notifications.js":[393461,455810],"./cs-cz/carousel-multi-card.js":[84302,313011],"./cs-cz/cast.js":[886323,206955],"./cs-cz/channels.js":[890629,562256],"./cs-cz/chat-list.js":[901315,713028],"./cs-cz/coach-report.js":[120311,375136],"./cs-cz/comment-stream.js":[836044,700374],"./cs-cz/communities.js":[854671,439095],"./cs-cz/compose.js":[676964,958977],"./cs-cz/contacts.js":[678314,561579],"./cs-cz/datepicker.js":[469988,995990],"./cs-cz/desktop.js":[734731,554696],"./cs-cz/digital-signage.js":[551922,64223],"./cs-cz/discover-surface.js":[339989,114029],"./cs-cz/edu.js":[951703,332403],"./cs-cz/embed.js":[569257,801218],"./cs-cz/errors.js":[679807,429326],"./cs-cz/esp.js":[539044,718034],"./cs-cz/extensibility-ptz-extension.js":[386010,821319],"./cs-cz/extensibility-room-remote.js":[765516,933202],"./cs-cz/extensibility.js":[155869,83084],"./cs-cz/feedback.js":[48257,165873],"./cs-cz/files.js":[879807,934570],"./cs-cz/framework.js":[587042,864696],"./cs-cz/freemium-upgrade.js":[893771,141912],"./cs-cz/freemium.js":[629143,152685],"./cs-cz/funstuff.js":[883899,488303],"./cs-cz/gallery.js":[270755,726804],"./cs-cz/growth.js":[697938,630209],"./cs-cz/guardians.js":[436047,548494],"./cs-cz/health.js":[108255,640852],"./cs-cz/help.js":[578653,690408],"./cs-cz/hololens.js":[770883,811974],"./cs-cz/host-controls.js":[638686,429331],"./cs-cz/jana.js":[178198,234848],"./cs-cz/lightbox.js":[727105,775557],"./cs-cz/live-persona-card.js":[447546,744319],"./cs-cz/live-persona-editor.js":[229782,102635],"./cs-cz/lms-integration.js":[368653,726852],"./cs-cz/meet-for-work.js":[568920,66246],"./cs-cz/meeting-analytics.js":[960296,318968],"./cs-cz/meeting-apis-app.js":[969674,327525],"./cs-cz/meeting-bot.js":[211443,780579],"./cs-cz/meeting-collaboration.js":[767012,92352],"./cs-cz/meeting-flyout.js":[966953,941204],"./cs-cz/meeting-meet-app.js":[281203,825268],"./cs-cz/meeting-options.js":[835352,365379],"./cs-cz/meeting-recap.js":[149887,135851],"./cs-cz/meeting-room-console.js":[250572,898507],"./cs-cz/meeting-stream-app.js":[808855,127005],"./cs-cz/message-escalate-dialog.js":[238752,820293],"./cs-cz/messaging.js":[214264,811878],"./cs-cz/mtma-missed-notifications.js":[635060,279849],"./cs-cz/nova.js":[727746,922784],"./cs-cz/people-app.js":[122210,390354],"./cs-cz/people-picker.js":[180046,834568],"./cs-cz/people-targeting.js":[1236,720041],"./cs-cz/people.js":[968097,988890],"./cs-cz/person.js":[337686,803061],"./cs-cz/phonelink-sms.js":[328386,439573],"./cs-cz/pre-core.js":[877314,243280],"./cs-cz/premium-benefits.js":[33542,282249],"./cs-cz/presence.js":[47206,120514],"./cs-cz/queues.js":[208699,909611],"./cs-cz/recurrence.js":[582906,723969],"./cs-cz/rsc-application-permissions.js":[573343,911346],"./cs-cz/search.js":[792429,583576],"./cs-cz/semantic-object.js":[492091,477356],"./cs-cz/settings.js":[214625,165278],"./cs-cz/share-in-meetings.js":[141126,872746],"./cs-cz/share-to-teams-outlook-addin.js":[822992,206890],"./cs-cz/share-to-teams-third-party.js":[807999,650575],"./cs-cz/share-to-teams.js":[359768,379688],"./cs-cz/shortcut.js":[477026,615700],"./cs-cz/shortcuts.js":[105821,13896],"./cs-cz/simple-collab.js":[690849,358825],"./cs-cz/smart-device.js":[837005,713738],"./cs-cz/survey.js":[716441,882204],"./cs-cz/sv-flyout.js":[495872,506878],"./cs-cz/teams-and-channels.js":[665418,663799],"./cs-cz/teams-insider.js":[746684,100299],"./cs-cz/telemetry.js":[326694,823654],"./cs-cz/tfl-homepage.js":[331010,94719],"./cs-cz/tfl-onboarding.js":[718543,904757],"./cs-cz/toast-notifications.js":[673999,760728],"./cs-cz/unified-search.js":[364298,883608],"./cs-cz/unsupported-browser.js":[386226,543003],"./cs-cz/url-preview.js":[629621,614640],"./cs-cz/video-capture.js":[512694,81502],"./cs-cz/video-message.js":[216950,905663],"./cs-cz/virtual-events.js":[289218,737738],"./cs-cz/webinar.js":[194524,627058],"./cs-cz/welcome-bot.js":[591732,489194],"./cs-cz/whats-new.js":[41703,316931],"./cs-cz/wiki.js":[77782,158095],"./cy-gb/activity.js":[743940,627576],"./cy-gb/artifacts-platform.js":[712725,533519],"./cy-gb/audience-view-dialog.js":[349682,416023],"./cy-gb/auth.js":[248369,529713],"./cy-gb/autosuggest.js":[100459,639977],"./cy-gb/avatar.js":[314393,430745],"./cy-gb/biometric-enrollment.js":[756524,955442],"./cy-gb/breakout-rooms.js":[515442,78846],"./cy-gb/broadcast.js":[676909,945493],"./cy-gb/calendar.js":[551864,522030],"./cy-gb/calling.js":[549471,223845],"./cy-gb/campaign-notifications.js":[702240,948007],"./cy-gb/carousel-multi-card.js":[695208,710832],"./cy-gb/cast.js":[284581,783415],"./cy-gb/channels.js":[859756,447958],"./cy-gb/chat-list.js":[536168,69057],"./cy-gb/coach-report.js":[926494,405861],"./cy-gb/comment-stream.js":[822669,465681],"./cy-gb/communities.js":[727934,866495],"./cy-gb/compose.js":[402422,761906],"./cy-gb/contacts.js":[116014,303919],"./cy-gb/datepicker.js":[940215,498287],"./cy-gb/desktop.js":[477793,306158],"./cy-gb/digital-signage.js":[604035,194534],"./cy-gb/discover-surface.js":[473938,993027],"./cy-gb/edu.js":[707153,231100],"./cy-gb/embed.js":[296109,646586],"./cy-gb/errors.js":[975418,245372],"./cy-gb/esp.js":[200144,788695],"./cy-gb/extensibility-ptz-extension.js":[781515,536471],"./cy-gb/extensibility-room-remote.js":[984792,360351],"./cy-gb/extensibility.js":[809065,118862],"./cy-gb/feedback.js":[574807,250818],"./cy-gb/files.js":[393450,521690],"./cy-gb/framework.js":[221199,612145],"./cy-gb/freemium-upgrade.js":[374918,922587],"./cy-gb/freemium.js":[395356,830964],"./cy-gb/funstuff.js":[851538,982248],"./cy-gb/gallery.js":[666524,844473],"./cy-gb/growth.js":[990805,814043],"./cy-gb/guardians.js":[230418,231852],"./cy-gb/health.js":[260026,577783],"./cy-gb/help.js":[256529,923304],"./cy-gb/hololens.js":[311440,777418],"./cy-gb/host-controls.js":[660184,491647],"./cy-gb/jana.js":[918403,998175],"./cy-gb/lightbox.js":[702070,796014],"./cy-gb/live-persona-card.js":[552222,261006],"./cy-gb/live-persona-editor.js":[886732,821074],"./cy-gb/lms-integration.js":[267111,952327],"./cy-gb/meet-for-work.js":[947290,732003],"./cy-gb/meeting-analytics.js":[668957,243301],"./cy-gb/meeting-apis-app.js":[84911,807945],"./cy-gb/meeting-bot.js":[280856,87507],"./cy-gb/meeting-collaboration.js":[516907,116471],"./cy-gb/meeting-flyout.js":[298702,874176],"./cy-gb/meeting-meet-app.js":[381564,195933],"./cy-gb/meeting-options.js":[450017,806409],"./cy-gb/meeting-recap.js":[418848,220493],"./cy-gb/meeting-room-console.js":[100544,120652],"./cy-gb/meeting-stream-app.js":[197561,159696],"./cy-gb/message-escalate-dialog.js":[670499,686681],"./cy-gb/messaging.js":[199699,411341],"./cy-gb/mtma-missed-notifications.js":[804984,856007],"./cy-gb/nova.js":[394668,353833],"./cy-gb/people-app.js":[118497,993532],"./cy-gb/people-picker.js":[143781,539087],"./cy-gb/people-targeting.js":[950071,636446],"./cy-gb/people.js":[333745,500365],"./cy-gb/person.js":[510313,896146],"./cy-gb/phonelink-sms.js":[767190,984898],"./cy-gb/pre-core.js":[348510,40294],"./cy-gb/premium-benefits.js":[337524,703842],"./cy-gb/presence.js":[959406,206792],"./cy-gb/queues.js":[737663,841817],"./cy-gb/recurrence.js":[588834,578683],"./cy-gb/rsc-application-permissions.js":[276992,411158],"./cy-gb/search.js":[407976,987833],"./cy-gb/semantic-object.js":[95257,981245],"./cy-gb/settings.js":[862364,31678],"./cy-gb/share-in-meetings.js":[949036,179405],"./cy-gb/share-to-teams-outlook-addin.js":[688653,875410],"./cy-gb/share-to-teams-third-party.js":[80047,972123],"./cy-gb/share-to-teams.js":[733739,137833],"./cy-gb/shortcut.js":[519918,821864],"./cy-gb/shortcuts.js":[907560,155133],"./cy-gb/simple-collab.js":[66470,393339],"./cy-gb/smart-device.js":[217009,406607],"./cy-gb/survey.js":[257311,310050],"./cy-gb/sv-flyout.js":[667419,279764],"./cy-gb/teams-and-channels.js":[781786,377707],"./cy-gb/teams-insider.js":[861758,93163],"./cy-gb/telemetry.js":[937415,863647],"./cy-gb/tfl-homepage.js":[836020,341018],"./cy-gb/tfl-onboarding.js":[270746,849579],"./cy-gb/toast-notifications.js":[619511,6851],"./cy-gb/unified-search.js":[597371,292958],"./cy-gb/unsupported-browser.js":[69145,978910],"./cy-gb/url-preview.js":[842671,715707],"./cy-gb/video-capture.js":[216894,644019],"./cy-gb/video-message.js":[47900,373965],"./cy-gb/virtual-events.js":[261375,924760],"./cy-gb/webinar.js":[87450,22193],"./cy-gb/welcome-bot.js":[94360,738694],"./cy-gb/whats-new.js":[315046,43199],"./cy-gb/wiki.js":[210417,595638],"./da-dk/activity.js":[615959,676028],"./da-dk/artifacts-platform.js":[64012,359168],"./da-dk/audience-view-dialog.js":[244353,23588],"./da-dk/auth.js":[564194,219259],"./da-dk/autosuggest.js":[602696,865687],"./da-dk/avatar.js":[432169,774799],"./da-dk/biometric-enrollment.js":[560380,594431],"./da-dk/breakout-rooms.js":[688180,454172],"./da-dk/broadcast.js":[748687,199382],"./da-dk/calendar.js":[544983,416189],"./da-dk/calling.js":[948710,950769],"./da-dk/campaign-notifications.js":[957007,769626],"./da-dk/carousel-multi-card.js":[365530,524101],"./da-dk/cast.js":[684065,866028],"./da-dk/channels.js":[832977,394222],"./da-dk/chat-list.js":[387150,33955],"./da-dk/coach-report.js":[299702,217646],"./da-dk/comment-stream.js":[856465,110550],"./da-dk/communities.js":[988949,693053],"./da-dk/compose.js":[533217,80937],"./da-dk/contacts.js":[413855,457512],"./da-dk/datepicker.js":[269252,532268],"./da-dk/desktop.js":[552533,776755],"./da-dk/digital-signage.js":[199275,413015],"./da-dk/discover-surface.js":[813588,938794],"./da-dk/edu.js":[59300,993560],"./da-dk/embed.js":[778224,8670],"./da-dk/errors.js":[742152,514572],"./da-dk/esp.js":[639958,976985],"./da-dk/extensibility-ptz-extension.js":[927098,77802],"./da-dk/extensibility-room-remote.js":[69698,183158],"./da-dk/extensibility.js":[45056,192544],"./da-dk/feedback.js":[328711,533298],"./da-dk/files.js":[888405,292538],"./da-dk/framework.js":[828214,626851],"./da-dk/freemium-upgrade.js":[990314,602452],"./da-dk/freemium.js":[732174,458075],"./da-dk/funstuff.js":[877967,949502],"./da-dk/gallery.js":[83627,871219],"./da-dk/growth.js":[372739,469063],"./da-dk/guardians.js":[788317,374817],"./da-dk/health.js":[347430,738562],"./da-dk/help.js":[527858,899246],"./da-dk/hololens.js":[548706,340513],"./da-dk/host-controls.js":[115605,279281],"./da-dk/jana.js":[406035,98983],"./da-dk/lightbox.js":[461895,720830],"./da-dk/live-persona-card.js":[453175,760200],"./da-dk/live-persona-editor.js":[2817,8113],"./da-dk/lms-integration.js":[866451,156512],"./da-dk/meet-for-work.js":[314427,873974],"./da-dk/meeting-analytics.js":[685983,106140],"./da-dk/meeting-apis-app.js":[894980,315811],"./da-dk/meeting-bot.js":[92762,955681],"./da-dk/meeting-collaboration.js":[33910,935379],"./da-dk/meeting-flyout.js":[358957,842562],"./da-dk/meeting-meet-app.js":[677254,641308],"./da-dk/meeting-options.js":[106372,195696],"./da-dk/meeting-recap.js":[496302,866787],"./da-dk/meeting-room-console.js":[443478,567548],"./da-dk/meeting-stream-app.js":[601122,310446],"./da-dk/message-escalate-dialog.js":[749743,807978],"./da-dk/messaging.js":[812086,667128],"./da-dk/mtma-missed-notifications.js":[17736,214744],"./da-dk/nova.js":[86801,852423],"./da-dk/people-app.js":[153519,774952],"./da-dk/people-picker.js":[209706,852005],"./da-dk/people-targeting.js":[2432,943443],"./da-dk/people.js":[597843,814318],"./da-dk/person.js":[346359,623134],"./da-dk/phonelink-sms.js":[926853,605823],"./da-dk/pre-core.js":[8972,29954],"./da-dk/premium-benefits.js":[510666,67046],"./da-dk/presence.js":[605482,202985],"./da-dk/queues.js":[188247,885875],"./da-dk/recurrence.js":[487004,630793],"./da-dk/rsc-application-permissions.js":[376296,219574],"./da-dk/search.js":[631926,536743],"./da-dk/semantic-object.js":[122623,544750],"./da-dk/settings.js":[899472,953517],"./da-dk/share-in-meetings.js":[655741,75381],"./da-dk/share-to-teams-outlook-addin.js":[675054,614538],"./da-dk/share-to-teams-third-party.js":[761683,881510],"./da-dk/share-to-teams.js":[507669,752130],"./da-dk/shortcut.js":[563267,890885],"./da-dk/shortcuts.js":[780664,864829],"./da-dk/simple-collab.js":[801405,674802],"./da-dk/smart-device.js":[469145,519426],"./da-dk/survey.js":[233911,151673],"./da-dk/sv-flyout.js":[693277,725361],"./da-dk/teams-and-channels.js":[727218,202480],"./da-dk/teams-insider.js":[626888,122721],"./da-dk/telemetry.js":[898502,647584],"./da-dk/tfl-homepage.js":[996277,158048],"./da-dk/tfl-onboarding.js":[37856,745022],"./da-dk/toast-notifications.js":[585305,592546],"./da-dk/unified-search.js":[993456,660334],"./da-dk/unsupported-browser.js":[447839,402845],"./da-dk/url-preview.js":[169296,780511],"./da-dk/video-capture.js":[807026,703854],"./da-dk/video-message.js":[231422,778709],"./da-dk/virtual-events.js":[346895,437458],"./da-dk/webinar.js":[492657,407138],"./da-dk/welcome-bot.js":[395758,621177],"./da-dk/whats-new.js":[324879,716170],"./da-dk/wiki.js":[689567,666518],"./de-de/activity.js":[831656,416696],"./de-de/artifacts-platform.js":[853517,175822],"./de-de/audience-view-dialog.js":[717560,986875],"./de-de/auth.js":[31766,782245],"./de-de/autosuggest.js":[198757,661111],"./de-de/avatar.js":[368491,518983],"./de-de/biometric-enrollment.js":[539415,660956],"./de-de/breakout-rooms.js":[764295,648372],"./de-de/broadcast.js":[729303,170726],"./de-de/calendar.js":[621183,198364],"./de-de/calling.js":[957171,129425],"./de-de/campaign-notifications.js":[968482,867294],"./de-de/carousel-multi-card.js":[125376,21767],"./de-de/cast.js":[339457,68891],"./de-de/channels.js":[772757,748338],"./de-de/chat-list.js":[22592,502319],"./de-de/coach-report.js":[675847,891738],"./de-de/comment-stream.js":[205879,747762],"./de-de/communities.js":[217698,920800],"./de-de/compose.js":[371071,374929],"./de-de/contacts.js":[829345,955447],"./de-de/datepicker.js":[924189,219847],"./de-de/desktop.js":[581154,627994],"./de-de/digital-signage.js":[380601,327724],"./de-de/discover-surface.js":[497805,445624],"./de-de/edu.js":[232394,583959],"./de-de/embed.js":[52052,318112],"./de-de/errors.js":[520899,766555],"./de-de/esp.js":[397492,433071],"./de-de/extensibility-ptz-extension.js":[13984,648123],"./de-de/extensibility-room-remote.js":[298866,519838],"./de-de/extensibility.js":[774283,400060],"./de-de/feedback.js":[876678,455520],"./de-de/files.js":[789749,24506],"./de-de/framework.js":[709707,895655],"./de-de/freemium-upgrade.js":[290559,725344],"./de-de/freemium.js":[168527,311165],"./de-de/funstuff.js":[899793,143544],"./de-de/gallery.js":[765771,395569],"./de-de/growth.js":[760567,670362],"./de-de/guardians.js":[146923,87014],"./de-de/health.js":[349952,434946],"./de-de/help.js":[387162,154228],"./de-de/hololens.js":[147035,624191],"./de-de/host-controls.js":[595807,426054],"./de-de/jana.js":[535658,147213],"./de-de/lightbox.js":[980893,527789],"./de-de/live-persona-card.js":[1878,362201],"./de-de/live-persona-editor.js":[168981,830909],"./de-de/lms-integration.js":[626190,422371],"./de-de/meet-for-work.js":[504586,99155],"./de-de/meeting-analytics.js":[931236,450960],"./de-de/meeting-apis-app.js":[848410,384105],"./de-de/meeting-bot.js":[5684,803756],"./de-de/meeting-collaboration.js":[936824,362497],"./de-de/meeting-flyout.js":[714761,720962],"./de-de/meeting-meet-app.js":[42019,732126],"./de-de/meeting-options.js":[136940,858719],"./de-de/meeting-recap.js":[20167,751181],"./de-de/meeting-room-console.js":[12206,675826],"./de-de/meeting-stream-app.js":[72859,950134],"./de-de/message-escalate-dialog.js":[109714,839399],"./de-de/messaging.js":[32515,782570],"./de-de/mtma-missed-notifications.js":[234800,169321],"./de-de/nova.js":[778853,31177],"./de-de/people-app.js":[916712,244029],"./de-de/people-picker.js":[724989,953670],"./de-de/people-targeting.js":[583277,964864],"./de-de/people.js":[119238,488996],"./de-de/person.js":[129642,912235],"./de-de/phonelink-sms.js":[860582,952844],"./de-de/pre-core.js":[678896,486006],"./de-de/premium-benefits.js":[629087,954596],"./de-de/presence.js":[384614,716550],"./de-de/queues.js":[60550,523051],"./de-de/recurrence.js":[865561,120446],"./de-de/rsc-application-permissions.js":[22249,370388],"./de-de/search.js":[253013,473863],"./de-de/semantic-object.js":[677039,727066],"./de-de/settings.js":[784026,30010],"./de-de/share-in-meetings.js":[240794,55135],"./de-de/share-to-teams-outlook-addin.js":[812265,292866],"./de-de/share-to-teams-third-party.js":[461146,469387],"./de-de/share-to-teams.js":[290598,159111],"./de-de/shortcut.js":[786389,369429],"./de-de/shortcuts.js":[885191,755294],"./de-de/simple-collab.js":[942266,933564],"./de-de/smart-device.js":[164722,937719],"./de-de/survey.js":[622225,775950],"./de-de/sv-flyout.js":[373486,522299],"./de-de/teams-and-channels.js":[489562,167107],"./de-de/teams-insider.js":[250481,484520],"./de-de/telemetry.js":[771706,842214],"./de-de/tfl-homepage.js":[953906,591049],"./de-de/tfl-onboarding.js":[733569,169179],"./de-de/toast-notifications.js":[944361,123015],"./de-de/unified-search.js":[717065,987485],"./de-de/unsupported-browser.js":[486570,60398],"./de-de/url-preview.js":[267432,35661],"./de-de/video-capture.js":[236313,828134],"./de-de/video-message.js":[623652,218100],"./de-de/virtual-events.js":[846167,809287],"./de-de/webinar.js":[748598,379265],"./de-de/welcome-bot.js":[297901,207554],"./de-de/whats-new.js":[22200,892494],"./de-de/wiki.js":[715489,119974],"./el-gr/activity.js":[122434,362363],"./el-gr/artifacts-platform.js":[43130,481786],"./el-gr/audience-view-dialog.js":[45397,139680],"./el-gr/auth.js":[383125,626988],"./el-gr/autosuggest.js":[222619,188532],"./el-gr/avatar.js":[894735,753332],"./el-gr/biometric-enrollment.js":[666654,898050],"./el-gr/breakout-rooms.js":[779262,967037],"./el-gr/broadcast.js":[27555,158301],"./el-gr/calendar.js":[822575,589438],"./el-gr/calling.js":[282770,74295],"./el-gr/campaign-notifications.js":[607571,470530],"./el-gr/carousel-multi-card.js":[808042,7910],"./el-gr/cast.js":[13288,207202],"./el-gr/channels.js":[121906,668987],"./el-gr/chat-list.js":[507330,388634],"./el-gr/coach-report.js":[173623,262895],"./el-gr/comment-stream.js":[951413,4768],"./el-gr/communities.js":[306308,764297],"./el-gr/compose.js":[113030,183183],"./el-gr/contacts.js":[226943,521954],"./el-gr/datepicker.js":[629617,526915],"./el-gr/desktop.js":[688504,899328],"./el-gr/digital-signage.js":[844758,683178],"./el-gr/discover-surface.js":[332026,566681],"./el-gr/edu.js":[891581,328662],"./el-gr/embed.js":[927087,356113],"./el-gr/errors.js":[641245,749687],"./el-gr/esp.js":[267187,478942],"./el-gr/extensibility-ptz-extension.js":[167316,833467],"./el-gr/extensibility-room-remote.js":[734997,349539],"./el-gr/extensibility.js":[661032,667606],"./el-gr/feedback.js":[379816,351606],"./el-gr/files.js":[185425,479078],"./el-gr/framework.js":[13107,593860],"./el-gr/freemium-upgrade.js":[870181,690678],"./el-gr/freemium.js":[570830,831267],"./el-gr/funstuff.js":[416644,656922],"./el-gr/gallery.js":[366956,333577],"./el-gr/growth.js":[660384,553598],"./el-gr/guardians.js":[215036,1675],"./el-gr/health.js":[924368,341245],"./el-gr/help.js":[697655,737174],"./el-gr/hololens.js":[105183,650091],"./el-gr/host-controls.js":[556355,741606],"./el-gr/jana.js":[375649,670810],"./el-gr/lightbox.js":[649702,783591],"./el-gr/live-persona-card.js":[557221,879485],"./el-gr/live-persona-editor.js":[687044,333089],"./el-gr/lms-integration.js":[302878,208579],"./el-gr/meet-for-work.js":[959047,947799],"./el-gr/meeting-analytics.js":[849150,787085],"./el-gr/meeting-apis-app.js":[991652,587438],"./el-gr/meeting-bot.js":[893354,982546],"./el-gr/meeting-collaboration.js":[512112,215842],"./el-gr/meeting-flyout.js":[490626,465423],"./el-gr/meeting-meet-app.js":[450431,984067],"./el-gr/meeting-options.js":[545427,793546],"./el-gr/meeting-recap.js":[580786,905207],"./el-gr/meeting-room-console.js":[923164,40191],"./el-gr/meeting-stream-app.js":[945006,302518],"./el-gr/message-escalate-dialog.js":[824673,937757],"./el-gr/messaging.js":[780246,725621],"./el-gr/mtma-missed-notifications.js":[864519,697866],"./el-gr/nova.js":[868841,249504],"./el-gr/people-app.js":[66271,541335],"./el-gr/people-picker.js":[77290,709928],"./el-gr/people-targeting.js":[505038,584228],"./el-gr/people.js":[734320,315961],"./el-gr/person.js":[239723,689774],"./el-gr/phonelink-sms.js":[494484,150532],"./el-gr/pre-core.js":[730809,409199],"./el-gr/premium-benefits.js":[852729,835235],"./el-gr/presence.js":[594987,194051],"./el-gr/queues.js":[293907,186806],"./el-gr/recurrence.js":[334927,549779],"./el-gr/rsc-application-permissions.js":[792954,691648],"./el-gr/search.js":[52655,275578],"./el-gr/semantic-object.js":[544916,336907],"./el-gr/settings.js":[708537,985081],"./el-gr/share-in-meetings.js":[293058,860075],"./el-gr/share-to-teams-outlook-addin.js":[501251,420199],"./el-gr/share-to-teams-third-party.js":[939301,359808],"./el-gr/share-to-teams.js":[140749,241095],"./el-gr/shortcut.js":[686757,632606],"./el-gr/shortcuts.js":[758717,45669],"./el-gr/simple-collab.js":[448815,236388],"./el-gr/smart-device.js":[707528,124503],"./el-gr/survey.js":[285738,306644],"./el-gr/sv-flyout.js":[748586,578787],"./el-gr/teams-and-channels.js":[490614,183141],"./el-gr/teams-insider.js":[19019,893691],"./el-gr/telemetry.js":[247528,63915],"./el-gr/tfl-homepage.js":[796494,854785],"./el-gr/tfl-onboarding.js":[100467,358766],"./el-gr/toast-notifications.js":[131432,533453],"./el-gr/unified-search.js":[62625,172353],"./el-gr/unsupported-browser.js":[378047,362979],"./el-gr/url-preview.js":[44554,68857],"./el-gr/video-capture.js":[705381,846501],"./el-gr/video-message.js":[420374,429502],"./el-gr/virtual-events.js":[830190,912766],"./el-gr/webinar.js":[189920,578351],"./el-gr/welcome-bot.js":[566206,288376],"./el-gr/whats-new.js":[332422,339195],"./el-gr/wiki.js":[50798,943718],"./en-gb/activity.js":[485273,199668],"./en-gb/artifacts-platform.js":[161640,118881],"./en-gb/audience-view-dialog.js":[754655,35786],"./en-gb/auth.js":[390153,27563],"./en-gb/autosuggest.js":[127858,177884],"./en-gb/avatar.js":[183536,610358],"./en-gb/biometric-enrollment.js":[46759,897586],"./en-gb/breakout-rooms.js":[977996,672819],"./en-gb/broadcast.js":[379249,316439],"./en-gb/calendar.js":[155841,299382],"./en-gb/calling.js":[441651,30756],"./en-gb/campaign-notifications.js":[323644,465181],"./en-gb/carousel-multi-card.js":[572049,737920],"./en-gb/cast.js":[243677,875763],"./en-gb/channels.js":[139958,853029],"./en-gb/chat-list.js":[34324,723995],"./en-gb/coach-report.js":[3166,488571],"./en-gb/comment-stream.js":[721910,125768],"./en-gb/communities.js":[664007,992542],"./en-gb/compose.js":[829922,873095],"./en-gb/contacts.js":[432708,72857],"./en-gb/datepicker.js":[988078,49618],"./en-gb/desktop.js":[990597,350842],"./en-gb/digital-signage.js":[461019,257246],"./en-gb/discover-surface.js":[253269,422297],"./en-gb/edu.js":[172255,217807],"./en-gb/embed.js":[425074,812086],"./en-gb/errors.js":[234194,770616],"./en-gb/esp.js":[538378,95862],"./en-gb/extensibility-ptz-extension.js":[391750,747139],"./en-gb/extensibility-room-remote.js":[157536,222316],"./en-gb/extensibility.js":[106415,324669],"./en-gb/feedback.js":[88476,704339],"./en-gb/files.js":[133060,918758],"./en-gb/framework.js":[847093,541602],"./en-gb/freemium-upgrade.js":[763722,696798],"./en-gb/freemium.js":[432300,328502],"./en-gb/funstuff.js":[842870,972388],"./en-gb/gallery.js":[754447,287683],"./en-gb/growth.js":[681896,471342],"./en-gb/guardians.js":[645655,664140],"./en-gb/health.js":[530486,336029],"./en-gb/help.js":[242803,107706],"./en-gb/hololens.js":[209137,653903],"./en-gb/host-controls.js":[844840,683245],"./en-gb/jana.js":[692827,137764],"./en-gb/lightbox.js":[539703,297136],"./en-gb/live-persona-card.js":[705762,47361],"./en-gb/live-persona-editor.js":[682211,214607],"./en-gb/lms-integration.js":[334668,236754],"./en-gb/meet-for-work.js":[734850,236663],"./en-gb/meeting-analytics.js":[53171,691730],"./en-gb/meeting-apis-app.js":[102385,491563],"./en-gb/meeting-bot.js":[573807,459169],"./en-gb/meeting-collaboration.js":[448927,929057],"./en-gb/meeting-flyout.js":[323951,984983],"./en-gb/meeting-meet-app.js":[927017,693681],"./en-gb/meeting-options.js":[840957,361256],"./en-gb/meeting-recap.js":[264322,71530],"./en-gb/meeting-room-console.js":[688717,131103],"./en-gb/meeting-stream-app.js":[860456,733427],"./en-gb/message-escalate-dialog.js":[692543,395300],"./en-gb/messaging.js":[969756,65489],"./en-gb/mtma-missed-notifications.js":[628266,938751],"./en-gb/nova.js":[44945,731094],"./en-gb/people-app.js":[705610,49248],"./en-gb/people-picker.js":[940872,831240],"./en-gb/people-targeting.js":[852248,918427],"./en-gb/people.js":[441139,942866],"./en-gb/person.js":[595025,891467],"./en-gb/phonelink-sms.js":[37400,314263],"./en-gb/pre-core.js":[95157,440226],"./en-gb/premium-benefits.js":[793223,621583],"./en-gb/presence.js":[978506,95196],"./en-gb/queues.js":[697149,760569],"./en-gb/recurrence.js":[841212,803591],"./en-gb/rsc-application-permissions.js":[492397,346852],"./en-gb/search.js":[365631,424188],"./en-gb/semantic-object.js":[281596,959374],"./en-gb/settings.js":[637825,816644],"./en-gb/share-in-meetings.js":[107449,564898],"./en-gb/share-to-teams-outlook-addin.js":[616562,739253],"./en-gb/share-to-teams-third-party.js":[202183,302747],"./en-gb/share-to-teams.js":[879578,181329],"./en-gb/shortcut.js":[830876,376238],"./en-gb/shortcuts.js":[453006,171395],"./en-gb/simple-collab.js":[806818,274873],"./en-gb/smart-device.js":[377389,779221],"./en-gb/survey.js":[988810,684198],"./en-gb/sv-flyout.js":[709696,630962],"./en-gb/teams-and-channels.js":[611512,303821],"./en-gb/teams-insider.js":[881467,104874],"./en-gb/telemetry.js":[496978,745513],"./en-gb/tfl-homepage.js":[923515,998062],"./en-gb/tfl-onboarding.js":[80163,823275],"./en-gb/toast-notifications.js":[994428,528264],"./en-gb/unified-search.js":[601166,453806],"./en-gb/unsupported-browser.js":[659436,511250],"./en-gb/url-preview.js":[999474,963701],"./en-gb/video-capture.js":[960443,718392],"./en-gb/video-message.js":[255755,156506],"./en-gb/virtual-events.js":[394782,149040],"./en-gb/webinar.js":[361179,312727],"./en-gb/welcome-bot.js":[15107,435573],"./en-gb/whats-new.js":[30719,966247],"./en-gb/wiki.js":[517538,18739],"./en-us/activity.js":[60520,51403],"./en-us/artifacts-platform.js":[280189,382317],"./en-us/audience-view-dialog.js":[259545,602252],"./en-us/auth.js":[83902,907954],"./en-us/autosuggest.js":[493977,956690],"./en-us/avatar.js":[665401,21366],"./en-us/biometric-enrollment.js":[232769,774675],"./en-us/breakout-rooms.js":[712680,460649],"./en-us/broadcast.js":[6162,845550],"./en-us/calendar.js":[158300,722762],"./en-us/calling.js":[102466,56884],"./en-us/campaign-notifications.js":[733785,7105],"./en-us/carousel-multi-card.js":[894617,578006],"./en-us/cast.js":[78499,411742],"./en-us/channels.js":[814117,131530],"./en-us/chat-list.js":[889367,958184],"./en-us/coach-report.js":[390464,606232],"./en-us/comment-stream.js":[693333,959671],"./en-us/communities.js":[666071,739281],"./en-us/compose.js":[652407,979786],"./en-us/contacts.js":[767921,248492],"./en-us/datepicker.js":[843754,641463],"./en-us/desktop.js":[159682,343223],"./en-us/digital-signage.js":[219055,776900],"./en-us/discover-surface.js":[844621,535868],"./en-us/edu.js":[136835,43191],"./en-us/embed.js":[307155,222032],"./en-us/errors.js":[763500,74934],"./en-us/esp.js":[898367,436323],"./en-us/extensibility-ptz-extension.js":[842282,101650],"./en-us/extensibility-room-remote.js":[214042,603983],"./en-us/extensibility.js":[718907,632262],"./en-us/feedback.js":[468130,688487],"./en-us/files.js":[341579,779920],"./en-us/framework.js":[954208,953497],"./en-us/freemium-upgrade.js":[487942,436519],"./en-us/freemium.js":[501548,236076],"./en-us/funstuff.js":[251122,769315],"./en-us/gallery.js":[484025,307494],"./en-us/growth.js":[274198,121645],"./en-us/guardians.js":[98822,461005],"./en-us/health.js":[373414,532112],"./en-us/help.js":[98080,546928],"./en-us/hololens.js":[98998,543142],"./en-us/host-controls.js":[464621,444199],"./en-us/jana.js":[419835,844607],"./en-us/lightbox.js":[394736,209361],"./en-us/live-persona-card.js":[982513,400514],"./en-us/live-persona-editor.js":[65967,86994],"./en-us/lms-integration.js":[942722,911987],"./en-us/meet-for-work.js":[197104,85441],"./en-us/meeting-analytics.js":[243650,267623],"./en-us/meeting-apis-app.js":[619821,581871],"./en-us/meeting-bot.js":[718534,905069],"./en-us/meeting-collaboration.js":[962021,493866],"./en-us/meeting-flyout.js":[210370,545046],"./en-us/meeting-meet-app.js":[130968,881363],"./en-us/meeting-options.js":[875934,999326],"./en-us/meeting-recap.js":[736872,958095],"./en-us/meeting-room-console.js":[703249,352250],"./en-us/meeting-stream-app.js":[748608,865520],"./en-us/message-escalate-dialog.js":[728298,437804],"./en-us/messaging.js":[17698,266215],"./en-us/mtma-missed-notifications.js":[872008,861967],"./en-us/nova.js":[453178,311115],"./en-us/people-app.js":[731322,330725],"./en-us/people-picker.js":[511645,64904],"./en-us/people-targeting.js":[506156,207423],"./en-us/people.js":[38565,950703],"./en-us/person.js":[920713,773716],"./en-us/phonelink-sms.js":[412849,325021],"./en-us/pre-core.js":[934217,147960],"./en-us/premium-benefits.js":[945779,984012],"./en-us/presence.js":[613451,940188],"./en-us/queues.js":[437346,546487],"./en-us/recurrence.js":[647048,22383],"./en-us/rsc-application-permissions.js":[640527,123976],"./en-us/search.js":[327920,199081],"./en-us/semantic-object.js":[229442,994177],"./en-us/settings.js":[550500,177409],"./en-us/share-in-meetings.js":[905167,930122],"./en-us/share-to-teams-outlook-addin.js":[442558,594865],"./en-us/share-to-teams-third-party.js":[656226,187643],"./en-us/share-to-teams.js":[848498,97324],"./en-us/shortcut.js":[605988,294169],"./en-us/shortcuts.js":[69836,823506],"./en-us/simple-collab.js":[810995,893832],"./en-us/smart-device.js":[894057,66639],"./en-us/survey.js":[162863,414658],"./en-us/sv-flyout.js":[91097,64230],"./en-us/teams-and-channels.js":[55662,615632],"./en-us/teams-insider.js":[200231,769614],"./en-us/telemetry.js":[553318,98420],"./en-us/tfl-homepage.js":[648010,108235],"./en-us/tfl-onboarding.js":[308585,760712],"./en-us/toast-notifications.js":[622802,257610],"./en-us/unified-search.js":[593988,907872],"./en-us/unsupported-browser.js":[977816,733806],"./en-us/url-preview.js":[645425,32974],"./en-us/video-capture.js":[961970,510800],"./en-us/video-message.js":[989906,2221],"./en-us/virtual-events.js":[822136,68481],"./en-us/webinar.js":[689665,237775],"./en-us/welcome-bot.js":[713737,676362],"./en-us/whats-new.js":[335216,689284],"./en-us/wiki.js":[3226,131282],"./es-es/activity.js":[311245,885034],"./es-es/artifacts-platform.js":[274746,628895],"./es-es/audience-view-dialog.js":[125212,683398],"./es-es/auth.js":[459692,205543],"./es-es/autosuggest.js":[717371,930178],"./es-es/avatar.js":[580284,403066],"./es-es/biometric-enrollment.js":[241924,904428],"./es-es/breakout-rooms.js":[759383,571850],"./es-es/broadcast.js":[754019,873606],"./es-es/calendar.js":[951608,519199],"./es-es/calling.js":[930887,44644],"./es-es/campaign-notifications.js":[12963,929745],"./es-es/carousel-multi-card.js":[899082,613179],"./es-es/cast.js":[388307,886643],"./es-es/channels.js":[405974,831257],"./es-es/chat-list.js":[656660,424831],"./es-es/coach-report.js":[492773,350782],"./es-es/comment-stream.js":[567394,304952],"./es-es/communities.js":[30194,134257],"./es-es/compose.js":[622715,701562],"./es-es/contacts.js":[253980,126034],"./es-es/datepicker.js":[644563,42072],"./es-es/desktop.js":[691857,472202],"./es-es/digital-signage.js":[864084,721128],"./es-es/discover-surface.js":[565157,811016],"./es-es/edu.js":[50357,506681],"./es-es/embed.js":[457267,364517],"./es-es/errors.js":[926137,958215],"./es-es/esp.js":[494736,640162],"./es-es/extensibility-ptz-extension.js":[997007,564559],"./es-es/extensibility-room-remote.js":[466862,789992],"./es-es/extensibility.js":[303399,629504],"./es-es/feedback.js":[926456,179475],"./es-es/files.js":[432527,574649],"./es-es/framework.js":[481449,767456],"./es-es/freemium-upgrade.js":[447783,505952],"./es-es/freemium.js":[152169,572766],"./es-es/funstuff.js":[772684,640347],"./es-es/gallery.js":[448441,704618],"./es-es/growth.js":[921072,564752],"./es-es/guardians.js":[84722,876571],"./es-es/health.js":[959169,295824],"./es-es/help.js":[696359,895581],"./es-es/hololens.js":[638974,219081],"./es-es/host-controls.js":[806893,964951],"./es-es/jana.js":[449054,439201],"./es-es/lightbox.js":[280407,217672],"./es-es/live-persona-card.js":[483468,32847],"./es-es/live-persona-editor.js":[557168,806792],"./es-es/lms-integration.js":[704937,559515],"./es-es/meet-for-work.js":[68554,465041],"./es-es/meeting-analytics.js":[906702,661765],"./es-es/meeting-apis-app.js":[225261,137643],"./es-es/meeting-bot.js":[329870,486723],"./es-es/meeting-collaboration.js":[147099,533508],"./es-es/meeting-flyout.js":[319345,906767],"./es-es/meeting-meet-app.js":[923198,582678],"./es-es/meeting-options.js":[173523,151566],"./es-es/meeting-recap.js":[936362,960337],"./es-es/meeting-room-console.js":[528226,819277],"./es-es/meeting-stream-app.js":[19665,270621],"./es-es/message-escalate-dialog.js":[771418,337427],"./es-es/messaging.js":[899921,416829],"./es-es/mtma-missed-notifications.js":[293308,122331],"./es-es/nova.js":[890684,160618],"./es-es/people-app.js":[703040,592053],"./es-es/people-picker.js":[671397,300524],"./es-es/people-targeting.js":[549834,535268],"./es-es/people.js":[113407,572781],"./es-es/person.js":[59952,439912],"./es-es/phonelink-sms.js":[143547,516649],"./es-es/pre-core.js":[882668,284463],"./es-es/premium-benefits.js":[134436,333433],"./es-es/presence.js":[746729,691589],"./es-es/queues.js":[124461,990486],"./es-es/recurrence.js":[316710,566626],"./es-es/rsc-application-permissions.js":[547893,365132],"./es-es/search.js":[83360,434817],"./es-es/semantic-object.js":[538243,564709],"./es-es/settings.js":[41280,38842],"./es-es/share-in-meetings.js":[268938,264496],"./es-es/share-to-teams-outlook-addin.js":[378872,816287],"./es-es/share-to-teams-third-party.js":[266073,610698],"./es-es/share-to-teams.js":[183534,380673],"./es-es/shortcut.js":[933922,474786],"./es-es/shortcuts.js":[777648,742297],"./es-es/simple-collab.js":[346473,297139],"./es-es/smart-device.js":[654683,378377],"./es-es/survey.js":[227518,514423],"./es-es/sv-flyout.js":[257902,300374],"./es-es/teams-and-channels.js":[322393,926908],"./es-es/teams-insider.js":[491810,46696],"./es-es/telemetry.js":[671230,32795],"./es-es/tfl-homepage.js":[988960,643138],"./es-es/tfl-onboarding.js":[905246,407615],"./es-es/toast-notifications.js":[731874,8401],"./es-es/unified-search.js":[223872,547236],"./es-es/unsupported-browser.js":[216959,922345],"./es-es/url-preview.js":[281735,988005],"./es-es/video-capture.js":[701394,759124],"./es-es/video-message.js":[668243,230915],"./es-es/virtual-events.js":[179491,702115],"./es-es/webinar.js":[360716,224925],"./es-es/welcome-bot.js":[716271,306292],"./es-es/whats-new.js":[910271,641816],"./es-es/wiki.js":[634442,17672],"./es-mx/activity.js":[782151,756291],"./es-mx/artifacts-platform.js":[623093,771880],"./es-mx/audience-view-dialog.js":[350324,925940],"./es-mx/auth.js":[600229,559176],"./es-mx/autosuggest.js":[4074,456038],"./es-mx/avatar.js":[215e3,392572],"./es-mx/biometric-enrollment.js":[942753,727335],"./es-mx/breakout-rooms.js":[803811,951568],"./es-mx/broadcast.js":[490022,199886],"./es-mx/calendar.js":[580521,67775],"./es-mx/calling.js":[806645,940073],"./es-mx/campaign-notifications.js":[739180,625033],"./es-mx/carousel-multi-card.js":[983770,970129],"./es-mx/cast.js":[96347,414766],"./es-mx/channels.js":[731075,107009],"./es-mx/chat-list.js":[709393,59228],"./es-mx/coach-report.js":[534300,655167],"./es-mx/comment-stream.js":[512606,937677],"./es-mx/communities.js":[233269,104575],"./es-mx/compose.js":[924017,954661],"./es-mx/contacts.js":[42278,50729],"./es-mx/datepicker.js":[632446,330768],"./es-mx/desktop.js":[613009,354989],"./es-mx/digital-signage.js":[682575,37943],"./es-mx/discover-surface.js":[770587,898862],"./es-mx/edu.js":[961422,991696],"./es-mx/embed.js":[137572,171418],"./es-mx/errors.js":[186140,324138],"./es-mx/esp.js":[942730,268756],"./es-mx/extensibility-ptz-extension.js":[672197,471680],"./es-mx/extensibility-room-remote.js":[584837,777340],"./es-mx/extensibility.js":[22685,161967],"./es-mx/feedback.js":[383136,203069],"./es-mx/files.js":[214835,736344],"./es-mx/framework.js":[163817,167828],"./es-mx/freemium-upgrade.js":[623439,942270],"./es-mx/freemium.js":[766512,877236],"./es-mx/funstuff.js":[253692,964539],"./es-mx/gallery.js":[202797,151194],"./es-mx/growth.js":[785826,675336],"./es-mx/guardians.js":[882238,573694],"./es-mx/health.js":[495256,167225],"./es-mx/help.js":[871141,380571],"./es-mx/hololens.js":[336898,543779],"./es-mx/host-controls.js":[890233,753113],"./es-mx/jana.js":[416341,576215],"./es-mx/lightbox.js":[34357,516471],"./es-mx/live-persona-card.js":[882517,808289],"./es-mx/live-persona-editor.js":[758329,953909],"./es-mx/lms-integration.js":[686069,325064],"./es-mx/meet-for-work.js":[717823,689134],"./es-mx/meeting-analytics.js":[933253,376001],"./es-mx/meeting-apis-app.js":[513792,283285],"./es-mx/meeting-bot.js":[413226,929732],"./es-mx/meeting-collaboration.js":[266842,147097],"./es-mx/meeting-flyout.js":[957743,922956],"./es-mx/meeting-meet-app.js":[546333,590640],"./es-mx/meeting-options.js":[283775,17834],"./es-mx/meeting-recap.js":[412142,507563],"./es-mx/meeting-room-console.js":[886657,28719],"./es-mx/meeting-stream-app.js":[315463,698767],"./es-mx/message-escalate-dialog.js":[409086,429391],"./es-mx/messaging.js":[332222,263573],"./es-mx/mtma-missed-notifications.js":[428406,935193],"./es-mx/nova.js":[99140,92606],"./es-mx/people-app.js":[403688,633780],"./es-mx/people-picker.js":[740055,879231],"./es-mx/people-targeting.js":[566666,82039],"./es-mx/people.js":[65897,139668],"./es-mx/person.js":[946411,770613],"./es-mx/phonelink-sms.js":[526293,497407],"./es-mx/pre-core.js":[800476,782891],"./es-mx/premium-benefits.js":[453134,646391],"./es-mx/presence.js":[820291,576100],"./es-mx/queues.js":[804690,446246],"./es-mx/recurrence.js":[602910,537307],"./es-mx/rsc-application-permissions.js":[25029,15367],"./es-mx/search.js":[95644,501384],"./es-mx/semantic-object.js":[142505,522191],"./es-mx/settings.js":[708340,641886],"./es-mx/share-in-meetings.js":[149386,737744],"./es-mx/share-to-teams-outlook-addin.js":[228073,823394],"./es-mx/share-to-teams-third-party.js":[793479,149130],"./es-mx/share-to-teams.js":[647085,165285],"./es-mx/shortcut.js":[549203,739751],"./es-mx/shortcuts.js":[683284,478744],"./es-mx/simple-collab.js":[196356,108689],"./es-mx/smart-device.js":[889800,168331],"./es-mx/survey.js":[697422,436512],"./es-mx/sv-flyout.js":[253764,395709],"./es-mx/teams-and-channels.js":[964913,773155],"./es-mx/teams-insider.js":[18498,867079],"./es-mx/telemetry.js":[777616,543386],"./es-mx/tfl-homepage.js":[747618,259877],"./es-mx/tfl-onboarding.js":[971189,24358],"./es-mx/toast-notifications.js":[45891,417471],"./es-mx/unified-search.js":[81793,718119],"./es-mx/unsupported-browser.js":[612846,632173],"./es-mx/url-preview.js":[381097,34183],"./es-mx/video-capture.js":[127209,233e3],"./es-mx/video-message.js":[758468,952422],"./es-mx/virtual-events.js":[644445,964665],"./es-mx/webinar.js":[94914,616052],"./es-mx/welcome-bot.js":[464759,474248],"./es-mx/whats-new.js":[93340,475962],"./es-mx/wiki.js":[513486,74903],"./et-ee/activity.js":[186694,975715],"./et-ee/artifacts-platform.js":[159365,12252],"./et-ee/audience-view-dialog.js":[881077,496751],"./et-ee/auth.js":[14293,598071],"./et-ee/autosuggest.js":[282832,401742],"./et-ee/avatar.js":[402085,401466],"./et-ee/biometric-enrollment.js":[838819,966913],"./et-ee/breakout-rooms.js":[891978,979227],"./et-ee/broadcast.js":[738635,6834],"./et-ee/calendar.js":[991415,309164],"./et-ee/calling.js":[526163,737813],"./et-ee/campaign-notifications.js":[264015,640637],"./et-ee/carousel-multi-card.js":[530925,557458],"./et-ee/cast.js":[330198,642301],"./et-ee/channels.js":[754586,519301],"./et-ee/chat-list.js":[579300,377610],"./et-ee/coach-report.js":[390260,523857],"./et-ee/comment-stream.js":[596931,635677],"./et-ee/communities.js":[571387,568330],"./et-ee/compose.js":[241010,987430],"./et-ee/contacts.js":[186490,680028],"./et-ee/datepicker.js":[82211,801173],"./et-ee/desktop.js":[61837,90245],"./et-ee/digital-signage.js":[832417,672023],"./et-ee/discover-surface.js":[941302,936962],"./et-ee/edu.js":[565355,888965],"./et-ee/embed.js":[365862,664930],"./et-ee/errors.js":[936183,40348],"./et-ee/esp.js":[799e3,569102],"./et-ee/extensibility-ptz-extension.js":[633921,571406],"./et-ee/extensibility-room-remote.js":[149067,860362],"./et-ee/extensibility.js":[211870,781026],"./et-ee/feedback.js":[815274,387621],"./et-ee/files.js":[639447,61233],"./et-ee/framework.js":[495682,897290],"./et-ee/freemium-upgrade.js":[614823,324697],"./et-ee/freemium.js":[13787,199784],"./et-ee/funstuff.js":[366681,371222],"./et-ee/gallery.js":[194436,522134],"./et-ee/growth.js":[246362,639237],"./et-ee/guardians.js":[45202,632825],"./et-ee/health.js":[34780,232805],"./et-ee/help.js":[378662,134164],"./et-ee/hololens.js":[370602,224946],"./et-ee/host-controls.js":[556909,31738],"./et-ee/jana.js":[397604,283938],"./et-ee/lightbox.js":[609622,826930],"./et-ee/live-persona-card.js":[551955,672975],"./et-ee/live-persona-editor.js":[368756,749871],"./et-ee/lms-integration.js":[733507,373809],"./et-ee/meet-for-work.js":[543448,813881],"./et-ee/meeting-analytics.js":[582659,352609],"./et-ee/meeting-apis-app.js":[331442,426476],"./et-ee/meeting-bot.js":[219856,281894],"./et-ee/meeting-collaboration.js":[760020,417678],"./et-ee/meeting-flyout.js":[553895,766724],"./et-ee/meeting-meet-app.js":[428283,966227],"./et-ee/meeting-options.js":[185354,404800],"./et-ee/meeting-recap.js":[503380,551632],"./et-ee/meeting-room-console.js":[420900,489425],"./et-ee/meeting-stream-app.js":[358942,498580],"./et-ee/message-escalate-dialog.js":[972309,612579],"./et-ee/messaging.js":[333965,13491],"./et-ee/mtma-missed-notifications.js":[200559,72895],"./et-ee/nova.js":[122903,478930],"./et-ee/people-app.js":[616018,873895],"./et-ee/people-picker.js":[854962,272252],"./et-ee/people-targeting.js":[793712,258830],"./et-ee/people.js":[318868,899304],"./et-ee/person.js":[704959,882621],"./et-ee/phonelink-sms.js":[285472,202308],"./et-ee/pre-core.js":[138359,191071],"./et-ee/premium-benefits.js":[477205,527973],"./et-ee/presence.js":[895574,195211],"./et-ee/queues.js":[55115,640250],"./et-ee/recurrence.js":[689783,940899],"./et-ee/rsc-application-permissions.js":[183158,473572],"./et-ee/search.js":[429304,215424],"./et-ee/semantic-object.js":[722356,289232],"./et-ee/settings.js":[777258,54303],"./et-ee/share-in-meetings.js":[429546,263408],"./et-ee/share-to-teams-outlook-addin.js":[817026,867900],"./et-ee/share-to-teams-third-party.js":[554388,394387],"./et-ee/share-to-teams.js":[182010,770682],"./et-ee/shortcut.js":[718532,91125],"./et-ee/shortcuts.js":[222830,386491],"./et-ee/simple-collab.js":[26462,555910],"./et-ee/smart-device.js":[482658,738623],"./et-ee/survey.js":[394068,169281],"./et-ee/sv-flyout.js":[222721,846493],"./et-ee/teams-and-channels.js":[849981,537956],"./et-ee/teams-insider.js":[548846,554189],"./et-ee/telemetry.js":[983945,927634],"./et-ee/tfl-homepage.js":[267393,735063],"./et-ee/tfl-onboarding.js":[282677,808589],"./et-ee/toast-notifications.js":[290039,617703],"./et-ee/unified-search.js":[143886,968148],"./et-ee/unsupported-browser.js":[84493,495937],"./et-ee/url-preview.js":[309119,102678],"./et-ee/video-capture.js":[509784,279568],"./et-ee/video-message.js":[863588,851133],"./et-ee/virtual-events.js":[933503,5453],"./et-ee/webinar.js":[442460,808421],"./et-ee/welcome-bot.js":[708458,669065],"./et-ee/whats-new.js":[733289,390758],"./et-ee/wiki.js":[595559,492922],"./eu-es/activity.js":[112246,282184],"./eu-es/artifacts-platform.js":[570130,179802],"./eu-es/audience-view-dialog.js":[408049,748032],"./eu-es/auth.js":[939156,405032],"./eu-es/autosuggest.js":[822101,279132],"./eu-es/avatar.js":[823511,513802],"./eu-es/biometric-enrollment.js":[279216,677504],"./eu-es/breakout-rooms.js":[10731,812289],"./eu-es/broadcast.js":[38816,990398],"./eu-es/calendar.js":[368562,491411],"./eu-es/calling.js":[653569,748403],"./eu-es/campaign-notifications.js":[323023,37045],"./eu-es/carousel-multi-card.js":[834341,107766],"./eu-es/cast.js":[405943,7196],"./eu-es/channels.js":[996216,306223],"./eu-es/chat-list.js":[835853,680051],"./eu-es/coach-report.js":[339176,475060],"./eu-es/comment-stream.js":[229906,672046],"./eu-es/communities.js":[731942,558862],"./eu-es/compose.js":[391961,555437],"./eu-es/contacts.js":[210179,75370],"./eu-es/datepicker.js":[419554,39858],"./eu-es/desktop.js":[761171,765645],"./eu-es/digital-signage.js":[934871,580120],"./eu-es/discover-surface.js":[623202,365093],"./eu-es/edu.js":[49911,393940],"./eu-es/embed.js":[935938,460039],"./eu-es/errors.js":[114269,208969],"./eu-es/esp.js":[683922,307674],"./eu-es/extensibility-ptz-extension.js":[121996,430892],"./eu-es/extensibility-room-remote.js":[763078,942643],"./eu-es/extensibility.js":[23633,472209],"./eu-es/feedback.js":[804898,799610],"./eu-es/files.js":[439641,692073],"./eu-es/framework.js":[651524,288301],"./eu-es/freemium-upgrade.js":[191599,462843],"./eu-es/freemium.js":[112846,205767],"./eu-es/funstuff.js":[867807,600788],"./eu-es/gallery.js":[245213,505556],"./eu-es/growth.js":[83898,103385],"./eu-es/guardians.js":[991313,229039],"./eu-es/health.js":[547773,461234],"./eu-es/help.js":[581810,144655],"./eu-es/hololens.js":[572081,150544],"./eu-es/host-controls.js":[908222,721041],"./eu-es/jana.js":[961316,111517],"./eu-es/lightbox.js":[543936,413058],"./eu-es/live-persona-card.js":[55273,818155],"./eu-es/live-persona-editor.js":[896440,114312],"./eu-es/lms-integration.js":[708265,712087],"./eu-es/meet-for-work.js":[158655,770778],"./eu-es/meeting-analytics.js":[122863,848646],"./eu-es/meeting-apis-app.js":[287843,927480],"./eu-es/meeting-bot.js":[123561,287988],"./eu-es/meeting-collaboration.js":[409616,983644],"./eu-es/meeting-flyout.js":[685555,591554],"./eu-es/meeting-meet-app.js":[157518,872928],"./eu-es/meeting-options.js":[974300,261742],"./eu-es/meeting-recap.js":[341363,269337],"./eu-es/meeting-room-console.js":[542021,196451],"./eu-es/meeting-stream-app.js":[950038,597442],"./eu-es/message-escalate-dialog.js":[83667,501653],"./eu-es/messaging.js":[614744,932192],"./eu-es/mtma-missed-notifications.js":[292923,263140],"./eu-es/nova.js":[716964,915868],"./eu-es/people-app.js":[681571,234794],"./eu-es/people-picker.js":[771884,34704],"./eu-es/people-targeting.js":[886710,811902],"./eu-es/people.js":[780611,116634],"./eu-es/person.js":[744885,447818],"./eu-es/phonelink-sms.js":[412918,534460],"./eu-es/pre-core.js":[122247,343742],"./eu-es/premium-benefits.js":[946373,414736],"./eu-es/presence.js":[211874,188013],"./eu-es/queues.js":[931878,8057],"./eu-es/recurrence.js":[766539,729284],"./eu-es/rsc-application-permissions.js":[85389,252018],"./eu-es/search.js":[743441,643511],"./eu-es/semantic-object.js":[770134,139651],"./eu-es/settings.js":[426180,135393],"./eu-es/share-in-meetings.js":[378556,948373],"./eu-es/share-to-teams-outlook-addin.js":[454833,326722],"./eu-es/share-to-teams-third-party.js":[330135,467775],"./eu-es/share-to-teams.js":[394733,569981],"./eu-es/shortcut.js":[20595,587495],"./eu-es/shortcuts.js":[462886,394341],"./eu-es/simple-collab.js":[95338,742241],"./eu-es/smart-device.js":[877555,909331],"./eu-es/survey.js":[566436,820004],"./eu-es/sv-flyout.js":[534981,628041],"./eu-es/teams-and-channels.js":[714714,729772],"./eu-es/teams-insider.js":[122871,83794],"./eu-es/telemetry.js":[99825,278522],"./eu-es/tfl-homepage.js":[73189,756585],"./eu-es/tfl-onboarding.js":[481947,91128],"./eu-es/toast-notifications.js":[28128,881080],"./eu-es/unified-search.js":[312528,410349],"./eu-es/unsupported-browser.js":[913147,542167],"./eu-es/url-preview.js":[388353,754384],"./eu-es/video-capture.js":[146239,292105],"./eu-es/video-message.js":[372996,17906],"./eu-es/virtual-events.js":[173079,138487],"./eu-es/webinar.js":[381415,744140],"./eu-es/welcome-bot.js":[308844,477285],"./eu-es/whats-new.js":[667931,347958],"./eu-es/wiki.js":[15895,961854],"./fi-fi/activity.js":[426357,327735],"./fi-fi/artifacts-platform.js":[375712,216166],"./fi-fi/audience-view-dialog.js":[454980,440348],"./fi-fi/auth.js":[425239,469742],"./fi-fi/autosuggest.js":[558789,536677],"./fi-fi/avatar.js":[176776,454275],"./fi-fi/biometric-enrollment.js":[72159,858216],"./fi-fi/breakout-rooms.js":[634632,658310],"./fi-fi/broadcast.js":[863833,642548],"./fi-fi/calendar.js":[772100,113336],"./fi-fi/calling.js":[790322,39355],"./fi-fi/campaign-notifications.js":[571937,908566],"./fi-fi/carousel-multi-card.js":[975650,969594],"./fi-fi/cast.js":[710808,753678],"./fi-fi/channels.js":[611536,297884],"./fi-fi/chat-list.js":[775782,32186],"./fi-fi/coach-report.js":[513031,332160],"./fi-fi/comment-stream.js":[353478,832740],"./fi-fi/communities.js":[809302,454356],"./fi-fi/compose.js":[742372,915229],"./fi-fi/contacts.js":[484913,485391],"./fi-fi/datepicker.js":[102489,617589],"./fi-fi/desktop.js":[210067,193101],"./fi-fi/digital-signage.js":[710313,745692],"./fi-fi/discover-surface.js":[944264,557810],"./fi-fi/edu.js":[282388,751221],"./fi-fi/embed.js":[926855,499615],"./fi-fi/errors.js":[604984,720555],"./fi-fi/esp.js":[425519,765160],"./fi-fi/extensibility-ptz-extension.js":[880485,187923],"./fi-fi/extensibility-room-remote.js":[777669,568260],"./fi-fi/extensibility.js":[724029,982420],"./fi-fi/feedback.js":[926516,95182],"./fi-fi/files.js":[864567,207711],"./fi-fi/framework.js":[351030,278895],"./fi-fi/freemium-upgrade.js":[789669,188483],"./fi-fi/freemium.js":[307589,785873],"./fi-fi/funstuff.js":[761401,725454],"./fi-fi/gallery.js":[537011,453547],"./fi-fi/growth.js":[295869,120394],"./fi-fi/guardians.js":[853678,145085],"./fi-fi/health.js":[241192,309779],"./fi-fi/help.js":[872528,478087],"./fi-fi/hololens.js":[756399,27878],"./fi-fi/host-controls.js":[276921,793399],"./fi-fi/jana.js":[138469,752226],"./fi-fi/lightbox.js":[17410,472788],"./fi-fi/live-persona-card.js":[974357,633004],"./fi-fi/live-persona-editor.js":[541998,922427],"./fi-fi/lms-integration.js":[393315,6437],"./fi-fi/meet-for-work.js":[908984,42756],"./fi-fi/meeting-analytics.js":[658574,339122],"./fi-fi/meeting-apis-app.js":[267124,538850],"./fi-fi/meeting-bot.js":[281862,632562],"./fi-fi/meeting-collaboration.js":[556451,802772],"./fi-fi/meeting-flyout.js":[683930,604178],"./fi-fi/meeting-meet-app.js":[800157,916960],"./fi-fi/meeting-options.js":[412314,589989],"./fi-fi/meeting-recap.js":[262934,755703],"./fi-fi/meeting-room-console.js":[937178,610883],"./fi-fi/meeting-stream-app.js":[718973,531527],"./fi-fi/message-escalate-dialog.js":[81392,257611],"./fi-fi/messaging.js":[879263,823207],"./fi-fi/mtma-missed-notifications.js":[951510,114373],"./fi-fi/nova.js":[639597,120642],"./fi-fi/people-app.js":[244861,281374],"./fi-fi/people-picker.js":[709714,941411],"./fi-fi/people-targeting.js":[197569,605706],"./fi-fi/people.js":[702526,417747],"./fi-fi/person.js":[636213,884006],"./fi-fi/phonelink-sms.js":[190043,343430],"./fi-fi/pre-core.js":[505648,870597],"./fi-fi/premium-benefits.js":[965837,466938],"./fi-fi/presence.js":[654615,797113],"./fi-fi/queues.js":[460865,437570],"./fi-fi/recurrence.js":[255619,871147],"./fi-fi/rsc-application-permissions.js":[661704,229997],"./fi-fi/search.js":[359217,673049],"./fi-fi/semantic-object.js":[842940,726096],"./fi-fi/settings.js":[951151,7799],"./fi-fi/share-in-meetings.js":[147599,229364],"./fi-fi/share-to-teams-outlook-addin.js":[825060,587492],"./fi-fi/share-to-teams-third-party.js":[603482,251600],"./fi-fi/share-to-teams.js":[340398,794334],"./fi-fi/shortcut.js":[90529,771211],"./fi-fi/shortcuts.js":[290214,732154],"./fi-fi/simple-collab.js":[850830,589005],"./fi-fi/smart-device.js":[810599,119749],"./fi-fi/survey.js":[90076,912870],"./fi-fi/sv-flyout.js":[81133,785617],"./fi-fi/teams-and-channels.js":[529514,382998],"./fi-fi/teams-insider.js":[477124,805136],"./fi-fi/telemetry.js":[194853,498278],"./fi-fi/tfl-homepage.js":[329033,217602],"./fi-fi/tfl-onboarding.js":[779145,470178],"./fi-fi/toast-notifications.js":[310196,785486],"./fi-fi/unified-search.js":[663361,488461],"./fi-fi/unsupported-browser.js":[417227,493799],"./fi-fi/url-preview.js":[607534,29694],"./fi-fi/video-capture.js":[90196,153342],"./fi-fi/video-message.js":[741061,749317],"./fi-fi/virtual-events.js":[521103,421056],"./fi-fi/webinar.js":[452711,62225],"./fi-fi/welcome-bot.js":[961743,658291],"./fi-fi/whats-new.js":[373916,664864],"./fi-fi/wiki.js":[932148,351161],"./fil-ph/activity.js":[273363,118109],"./fil-ph/artifacts-platform.js":[431944,91085],"./fil-ph/audience-view-dialog.js":[938274,975213],"./fil-ph/auth.js":[705927,763664],"./fil-ph/autosuggest.js":[83075,372354],"./fil-ph/avatar.js":[578622,270767],"./fil-ph/biometric-enrollment.js":[969410,291920],"./fil-ph/breakout-rooms.js":[476595,432250],"./fil-ph/broadcast.js":[473904,197577],"./fil-ph/calendar.js":[246720,221045],"./fil-ph/calling.js":[771276,951407],"./fil-ph/campaign-notifications.js":[465539,93726],"./fil-ph/carousel-multi-card.js":[465813,36271],"./fil-ph/cast.js":[597460,680472],"./fil-ph/channels.js":[444221,798877],"./fil-ph/chat-list.js":[285882,708832],"./fil-ph/coach-report.js":[797145,226741],"./fil-ph/comment-stream.js":[691199,726189],"./fil-ph/communities.js":[93779,739245],"./fil-ph/compose.js":[722503,350650],"./fil-ph/contacts.js":[461293,112391],"./fil-ph/datepicker.js":[630231,77247],"./fil-ph/desktop.js":[223626,902921],"./fil-ph/digital-signage.js":[681,817222],"./fil-ph/discover-surface.js":[658265,59208],"./fil-ph/edu.js":[873011,633602],"./fil-ph/embed.js":[4290,152395],"./fil-ph/errors.js":[699604,264815],"./fil-ph/esp.js":[446525,2987],"./fil-ph/extensibility-ptz-extension.js":[547418,136175],"./fil-ph/extensibility-room-remote.js":[733343,784676],"./fil-ph/extensibility.js":[552317,831103],"./fil-ph/feedback.js":[637553,581034],"./fil-ph/files.js":[324255,179246],"./fil-ph/framework.js":[812749,502217],"./fil-ph/freemium-upgrade.js":[286899,578991],"./fil-ph/freemium.js":[779542,145128],"./fil-ph/funstuff.js":[979310,948678],"./fil-ph/gallery.js":[853632,328141],"./fil-ph/growth.js":[970954,824610],"./fil-ph/guardians.js":[901554,867630],"./fil-ph/health.js":[300854,705390],"./fil-ph/help.js":[490514,840209],"./fil-ph/hololens.js":[898996,505794],"./fil-ph/host-controls.js":[215365,116894],"./fil-ph/jana.js":[333089,189760],"./fil-ph/lightbox.js":[767186,590145],"./fil-ph/live-persona-card.js":[604394,717421],"./fil-ph/live-persona-editor.js":[669600,198294],"./fil-ph/lms-integration.js":[393035,173764],"./fil-ph/meet-for-work.js":[706405,942786],"./fil-ph/meeting-analytics.js":[127860,420609],"./fil-ph/meeting-apis-app.js":[758858,970308],"./fil-ph/meeting-bot.js":[348535,173410],"./fil-ph/meeting-collaboration.js":[739924,945812],"./fil-ph/meeting-flyout.js":[836257,615584],"./fil-ph/meeting-meet-app.js":[183349,631845],"./fil-ph/meeting-options.js":[59820,29154],"./fil-ph/meeting-recap.js":[614620,256485],"./fil-ph/meeting-room-console.js":[810442,280886],"./fil-ph/meeting-stream-app.js":[385411,697029],"./fil-ph/message-escalate-dialog.js":[182286,394925],"./fil-ph/messaging.js":[102910,13872],"./fil-ph/mtma-missed-notifications.js":[925602,107922],"./fil-ph/nova.js":[757857,313795],"./fil-ph/people-app.js":[608127,451477],"./fil-ph/people-picker.js":[75778,410528],"./fil-ph/people-targeting.js":[326156,376072],"./fil-ph/people.js":[638275,387918],"./fil-ph/person.js":[920839,914537],"./fil-ph/phonelink-sms.js":[938381,742450],"./fil-ph/pre-core.js":[428177,272913],"./fil-ph/premium-benefits.js":[386105,449062],"./fil-ph/presence.js":[258313,18711],"./fil-ph/queues.js":[185374,686189],"./fil-ph/recurrence.js":[295980,60042],"./fil-ph/rsc-application-permissions.js":[494583,153087],"./fil-ph/search.js":[604374,996502],"./fil-ph/semantic-object.js":[623143,703299],"./fil-ph/settings.js":[827176,842583],"./fil-ph/share-in-meetings.js":[257449,607028],"./fil-ph/share-to-teams-outlook-addin.js":[717010,424685],"./fil-ph/share-to-teams-third-party.js":[965284,662305],"./fil-ph/share-to-teams.js":[987129,549895],"./fil-ph/shortcut.js":[607050,555145],"./fil-ph/shortcuts.js":[581576,1879],"./fil-ph/simple-collab.js":[874771,727819],"./fil-ph/smart-device.js":[114153,826020],"./fil-ph/survey.js":[495581,94050],"./fil-ph/sv-flyout.js":[810189,457490],"./fil-ph/teams-and-channels.js":[243085,748167],"./fil-ph/teams-insider.js":[804746,179588],"./fil-ph/telemetry.js":[617934,705900],"./fil-ph/tfl-homepage.js":[427964,26022],"./fil-ph/tfl-onboarding.js":[40927,231914],"./fil-ph/toast-notifications.js":[848107,86407],"./fil-ph/unified-search.js":[102366,488806],"./fil-ph/unsupported-browser.js":[112582,97880],"./fil-ph/url-preview.js":[374594,855615],"./fil-ph/video-capture.js":[864657,170499],"./fil-ph/video-message.js":[648792,537971],"./fil-ph/virtual-events.js":[134480,272457],"./fil-ph/webinar.js":[76429,756171],"./fil-ph/welcome-bot.js":[259277,22422],"./fil-ph/whats-new.js":[183780,189386],"./fil-ph/wiki.js":[891068,900389],"./fr-ca/activity.js":[534619,222874],"./fr-ca/artifacts-platform.js":[182747,432794],"./fr-ca/audience-view-dialog.js":[909638,739182],"./fr-ca/auth.js":[549476,622892],"./fr-ca/autosuggest.js":[347724,658736],"./fr-ca/avatar.js":[465979,27656],"./fr-ca/biometric-enrollment.js":[500534,169128],"./fr-ca/breakout-rooms.js":[397153,985093],"./fr-ca/broadcast.js":[915395,738057],"./fr-ca/calendar.js":[103426,747131],"./fr-ca/calling.js":[828390,10035],"./fr-ca/campaign-notifications.js":[233962,593357],"./fr-ca/carousel-multi-card.js":[66644,580620],"./fr-ca/cast.js":[954416,508842],"./fr-ca/channels.js":[392389,69987],"./fr-ca/chat-list.js":[54650,835221],"./fr-ca/coach-report.js":[762860,924826],"./fr-ca/comment-stream.js":[85211,601667],"./fr-ca/communities.js":[950036,50333],"./fr-ca/compose.js":[762766,241384],"./fr-ca/contacts.js":[863311,975303],"./fr-ca/datepicker.js":[878690,102003],"./fr-ca/desktop.js":[320954,763572],"./fr-ca/digital-signage.js":[951705,919990],"./fr-ca/discover-surface.js":[466684,531199],"./fr-ca/edu.js":[68031,14006],"./fr-ca/embed.js":[528027,4104],"./fr-ca/errors.js":[875031,41389],"./fr-ca/esp.js":[131376,127994],"./fr-ca/extensibility-ptz-extension.js":[86552,638620],"./fr-ca/extensibility-room-remote.js":[68907,381319],"./fr-ca/extensibility.js":[415046,404522],"./fr-ca/feedback.js":[185715,504454],"./fr-ca/files.js":[191376,1161],"./fr-ca/framework.js":[695512,563393],"./fr-ca/freemium-upgrade.js":[765510,137831],"./fr-ca/freemium.js":[807110,52001],"./fr-ca/funstuff.js":[707710,909179],"./fr-ca/gallery.js":[180299,441404],"./fr-ca/growth.js":[286574,36631],"./fr-ca/guardians.js":[766222,885924],"./fr-ca/health.js":[25418,527297],"./fr-ca/help.js":[112814,321149],"./fr-ca/hololens.js":[804749,174890],"./fr-ca/host-controls.js":[50436,71358],"./fr-ca/jana.js":[805195,377004],"./fr-ca/lightbox.js":[279371,848912],"./fr-ca/live-persona-card.js":[459093,723113],"./fr-ca/live-persona-editor.js":[85037,435611],"./fr-ca/lms-integration.js":[960027,555856],"./fr-ca/meet-for-work.js":[215465,455513],"./fr-ca/meeting-analytics.js":[836961,624704],"./fr-ca/meeting-apis-app.js":[405581,706165],"./fr-ca/meeting-bot.js":[408802,419525],"./fr-ca/meeting-collaboration.js":[93741,649133],"./fr-ca/meeting-flyout.js":[504710,441931],"./fr-ca/meeting-meet-app.js":[605261,324784],"./fr-ca/meeting-options.js":[322593,871504],"./fr-ca/meeting-recap.js":[463886,835949],"./fr-ca/meeting-room-console.js":[542085,382272],"./fr-ca/meeting-stream-app.js":[917794,792146],"./fr-ca/message-escalate-dialog.js":[741545,411185],"./fr-ca/messaging.js":[44231,727767],"./fr-ca/mtma-missed-notifications.js":[760332,110131],"./fr-ca/nova.js":[122504,637854],"./fr-ca/people-app.js":[482029,151286],"./fr-ca/people-picker.js":[474569,585918],"./fr-ca/people-targeting.js":[74142,417016],"./fr-ca/people.js":[486606,498086],"./fr-ca/person.js":[384905,912325],"./fr-ca/phonelink-sms.js":[561103,878054],"./fr-ca/pre-core.js":[98958,178800],"./fr-ca/premium-benefits.js":[240612,677307],"./fr-ca/presence.js":[669008,571118],"./fr-ca/queues.js":[396577,204729],"./fr-ca/recurrence.js":[520121,149884],"./fr-ca/rsc-application-permissions.js":[257143,632712],"./fr-ca/search.js":[820388,902654],"./fr-ca/semantic-object.js":[830692,85589],"./fr-ca/settings.js":[106300,171576],"./fr-ca/share-in-meetings.js":[813748,757595],"./fr-ca/share-to-teams-outlook-addin.js":[440725,969693],"./fr-ca/share-to-teams-third-party.js":[594612,427201],"./fr-ca/share-to-teams.js":[491806,88167],"./fr-ca/shortcut.js":[238473,334170],"./fr-ca/shortcuts.js":[460926,923658],"./fr-ca/simple-collab.js":[688290,5523],"./fr-ca/smart-device.js":[334584,238298],"./fr-ca/survey.js":[759606,161464],"./fr-ca/sv-flyout.js":[337127,332107],"./fr-ca/teams-and-channels.js":[470546,558202],"./fr-ca/teams-insider.js":[309874,58208],"./fr-ca/telemetry.js":[497224,898275],"./fr-ca/tfl-homepage.js":[885240,466886],"./fr-ca/tfl-onboarding.js":[710196,144795],"./fr-ca/toast-notifications.js":[779927,823263],"./fr-ca/unified-search.js":[21756,53340],"./fr-ca/unsupported-browser.js":[390593,350223],"./fr-ca/url-preview.js":[49769,752908],"./fr-ca/video-capture.js":[259914,123288],"./fr-ca/video-message.js":[311355,116608],"./fr-ca/virtual-events.js":[324895,292751],"./fr-ca/webinar.js":[683620,328508],"./fr-ca/welcome-bot.js":[547634,233710],"./fr-ca/whats-new.js":[395533,469518],"./fr-ca/wiki.js":[239649,977727],"./fr-fr/activity.js":[896049,766789],"./fr-fr/artifacts-platform.js":[210992,303105],"./fr-fr/audience-view-dialog.js":[444291,977326],"./fr-fr/auth.js":[51073,897485],"./fr-fr/autosuggest.js":[911025,335101],"./fr-fr/avatar.js":[653487,697962],"./fr-fr/biometric-enrollment.js":[610251,227471],"./fr-fr/breakout-rooms.js":[545472,462239],"./fr-fr/broadcast.js":[601885,876750],"./fr-fr/calendar.js":[603217,98685],"./fr-fr/calling.js":[43915,659141],"./fr-fr/campaign-notifications.js":[879295,349410],"./fr-fr/carousel-multi-card.js":[544414,177754],"./fr-fr/cast.js":[976631,587218],"./fr-fr/channels.js":[468332,839180],"./fr-fr/chat-list.js":[917655,87397],"./fr-fr/coach-report.js":[107122,754805],"./fr-fr/comment-stream.js":[900094,172787],"./fr-fr/communities.js":[459251,464759],"./fr-fr/compose.js":[134120,715229],"./fr-fr/contacts.js":[802889,519937],"./fr-fr/datepicker.js":[441859,29300],"./fr-fr/desktop.js":[500959,153767],"./fr-fr/digital-signage.js":[25666,772618],"./fr-fr/discover-surface.js":[251526,669027],"./fr-fr/edu.js":[462012,556625],"./fr-fr/embed.js":[182396,607726],"./fr-fr/errors.js":[905818,618827],"./fr-fr/esp.js":[786857,100595],"./fr-fr/extensibility-ptz-extension.js":[531136,839247],"./fr-fr/extensibility-room-remote.js":[149216,289304],"./fr-fr/extensibility.js":[443598,743744],"./fr-fr/feedback.js":[886410,11938],"./fr-fr/files.js":[569471,293783],"./fr-fr/framework.js":[956931,88762],"./fr-fr/freemium-upgrade.js":[645015,864748],"./fr-fr/freemium.js":[94268,348010],"./fr-fr/funstuff.js":[495557,923352],"./fr-fr/gallery.js":[977803,229349],"./fr-fr/growth.js":[480795,203213],"./fr-fr/guardians.js":[277551,92277],"./fr-fr/health.js":[816300,678893],"./fr-fr/help.js":[850264,347262],"./fr-fr/hololens.js":[413765,91882],"./fr-fr/host-controls.js":[39592,393061],"./fr-fr/jana.js":[245645,624179],"./fr-fr/lightbox.js":[915013,389708],"./fr-fr/live-persona-card.js":[616866,54583],"./fr-fr/live-persona-editor.js":[671122,581354],"./fr-fr/lms-integration.js":[881481,616774],"./fr-fr/meet-for-work.js":[366905,114394],"./fr-fr/meeting-analytics.js":[607816,66654],"./fr-fr/meeting-apis-app.js":[8453,736583],"./fr-fr/meeting-bot.js":[553269,564830],"./fr-fr/meeting-collaboration.js":[554827,200755],"./fr-fr/meeting-flyout.js":[834686,968671],"./fr-fr/meeting-meet-app.js":[648821,711762],"./fr-fr/meeting-options.js":[804758,800531],"./fr-fr/meeting-recap.js":[235798,937331],"./fr-fr/meeting-room-console.js":[1971,469728],"./fr-fr/meeting-stream-app.js":[941940,426705],"./fr-fr/message-escalate-dialog.js":[342257,635968],"./fr-fr/messaging.js":[936121,158094],"./fr-fr/mtma-missed-notifications.js":[324702,19219],"./fr-fr/nova.js":[690761,313615],"./fr-fr/people-app.js":[62085,779406],"./fr-fr/people-picker.js":[390128,191238],"./fr-fr/people-targeting.js":[346755,509141],"./fr-fr/people.js":[240293,358861],"./fr-fr/person.js":[56327,869185],"./fr-fr/phonelink-sms.js":[81994,154365],"./fr-fr/pre-core.js":[628764,775341],"./fr-fr/premium-benefits.js":[255790,606645],"./fr-fr/presence.js":[103282,686206],"./fr-fr/queues.js":[298347,969701],"./fr-fr/recurrence.js":[364561,956593],"./fr-fr/rsc-application-permissions.js":[678491,863403],"./fr-fr/search.js":[756845,785769],"./fr-fr/semantic-object.js":[517889,854304],"./fr-fr/settings.js":[332867,962127],"./fr-fr/share-in-meetings.js":[769992,743081],"./fr-fr/share-to-teams-outlook-addin.js":[147180,791224],"./fr-fr/share-to-teams-third-party.js":[423648,221519],"./fr-fr/share-to-teams.js":[938173,221165],"./fr-fr/shortcut.js":[82892,485268],"./fr-fr/shortcuts.js":[422350,120889],"./fr-fr/simple-collab.js":[730721,233586],"./fr-fr/smart-device.js":[334173,413508],"./fr-fr/survey.js":[433828,477358],"./fr-fr/sv-flyout.js":[202953,655939],"./fr-fr/teams-and-channels.js":[717977,399388],"./fr-fr/teams-insider.js":[505781,23786],"./fr-fr/telemetry.js":[922195,8733],"./fr-fr/tfl-homepage.js":[551168,665284],"./fr-fr/tfl-onboarding.js":[998303,736580],"./fr-fr/toast-notifications.js":[325212,634077],"./fr-fr/unified-search.js":[415529,289682],"./fr-fr/unsupported-browser.js":[566661,83035],"./fr-fr/url-preview.js":[162812,41610],"./fr-fr/video-capture.js":[120220,849399],"./fr-fr/video-message.js":[386549,940461],"./fr-fr/virtual-events.js":[587595,623310],"./fr-fr/webinar.js":[32433,678241],"./fr-fr/welcome-bot.js":[557435,120998],"./fr-fr/whats-new.js":[425571,318941],"./fr-fr/wiki.js":[428562,417982],"./gl-es/activity.js":[967858,972523],"./gl-es/artifacts-platform.js":[250142,691830],"./gl-es/audience-view-dialog.js":[608600,705175],"./gl-es/auth.js":[464651,335171],"./gl-es/autosuggest.js":[597358,579536],"./gl-es/avatar.js":[232794,235921],"./gl-es/biometric-enrollment.js":[12414,754106],"./gl-es/breakout-rooms.js":[843392,19085],"./gl-es/broadcast.js":[432191,111969],"./gl-es/calendar.js":[462507,533203],"./gl-es/calling.js":[933004,561631],"./gl-es/campaign-notifications.js":[887716,927335],"./gl-es/carousel-multi-card.js":[840032,611529],"./gl-es/cast.js":[480749,754955],"./gl-es/channels.js":[646590,886960],"./gl-es/chat-list.js":[483567,171721],"./gl-es/coach-report.js":[928445,727879],"./gl-es/comment-stream.js":[337997,952639],"./gl-es/communities.js":[145324,278225],"./gl-es/compose.js":[664900,972563],"./gl-es/contacts.js":[857367,152208],"./gl-es/datepicker.js":[95348,317323],"./gl-es/desktop.js":[632441,717462],"./gl-es/digital-signage.js":[195166,89964],"./gl-es/discover-surface.js":[603112,382977],"./gl-es/edu.js":[133824,749612],"./gl-es/embed.js":[555796,113353],"./gl-es/errors.js":[27039,594210],"./gl-es/esp.js":[836739,889378],"./gl-es/extensibility-ptz-extension.js":[859067,299677],"./gl-es/extensibility-room-remote.js":[906199,257292],"./gl-es/extensibility.js":[297867,159923],"./gl-es/feedback.js":[780277,665682],"./gl-es/files.js":[808151,462223],"./gl-es/framework.js":[115333,299451],"./gl-es/freemium-upgrade.js":[129882,566001],"./gl-es/freemium.js":[135525,34392],"./gl-es/funstuff.js":[814974,877540],"./gl-es/gallery.js":[256650,711743],"./gl-es/growth.js":[146990,16852],"./gl-es/guardians.js":[231265,354258],"./gl-es/health.js":[969855,258711],"./gl-es/help.js":[392246,868839],"./gl-es/hololens.js":[306819,947008],"./gl-es/host-controls.js":[628762,825948],"./gl-es/jana.js":[516835,293946],"./gl-es/lightbox.js":[557918,137499],"./gl-es/live-persona-card.js":[463133,223071],"./gl-es/live-persona-editor.js":[892326,516942],"./gl-es/lms-integration.js":[867018,625331],"./gl-es/meet-for-work.js":[947535,168090],"./gl-es/meeting-analytics.js":[397258,141425],"./gl-es/meeting-apis-app.js":[651152,307298],"./gl-es/meeting-bot.js":[913182,664543],"./gl-es/meeting-collaboration.js":[708191,437808],"./gl-es/meeting-flyout.js":[537582,666581],"./gl-es/meeting-meet-app.js":[912247,670125],"./gl-es/meeting-options.js":[323492,558990],"./gl-es/meeting-recap.js":[784024,137885],"./gl-es/meeting-room-console.js":[777670,3985],"./gl-es/meeting-stream-app.js":[653505,869348],"./gl-es/message-escalate-dialog.js":[653603,155566],"./gl-es/messaging.js":[335954,983155],"./gl-es/mtma-missed-notifications.js":[896775,63318],"./gl-es/nova.js":[802173,10905],"./gl-es/people-app.js":[302644,642371],"./gl-es/people-picker.js":[945315,702762],"./gl-es/people-targeting.js":[360847,255278],"./gl-es/people.js":[524042,642904],"./gl-es/person.js":[249028,917784],"./gl-es/phonelink-sms.js":[505684,994389],"./gl-es/pre-core.js":[846810,573381],"./gl-es/premium-benefits.js":[49816,444977],"./gl-es/presence.js":[564002,340938],"./gl-es/queues.js":[332160,479132],"./gl-es/recurrence.js":[876569,188070],"./gl-es/rsc-application-permissions.js":[120976,427038],"./gl-es/search.js":[32893,803482],"./gl-es/semantic-object.js":[865204,993715],"./gl-es/settings.js":[912160,926754],"./gl-es/share-in-meetings.js":[53101,770646],"./gl-es/share-to-teams-outlook-addin.js":[549208,597732],"./gl-es/share-to-teams-third-party.js":[879988,953628],"./gl-es/share-to-teams.js":[888687,235069],"./gl-es/shortcut.js":[43235,754386],"./gl-es/shortcuts.js":[49133,866926],"./gl-es/simple-collab.js":[903456,197322],"./gl-es/smart-device.js":[92363,511290],"./gl-es/survey.js":[161333,53258],"./gl-es/sv-flyout.js":[207142,904692],"./gl-es/teams-and-channels.js":[945788,965169],"./gl-es/teams-insider.js":[187635,203868],"./gl-es/telemetry.js":[959336,848954],"./gl-es/tfl-homepage.js":[801848,24240],"./gl-es/tfl-onboarding.js":[826412,730112],"./gl-es/toast-notifications.js":[837090,187194],"./gl-es/unified-search.js":[886752,218440],"./gl-es/unsupported-browser.js":[35502,320585],"./gl-es/url-preview.js":[385698,383606],"./gl-es/video-capture.js":[434895,701800],"./gl-es/video-message.js":[131718,209379],"./gl-es/virtual-events.js":[698741,966277],"./gl-es/webinar.js":[961330,918876],"./gl-es/welcome-bot.js":[457439,209480],"./gl-es/whats-new.js":[19186,472674],"./gl-es/wiki.js":[884618,437859],"./he-il/activity.js":[403597,267509],"./he-il/artifacts-platform.js":[112677,615372],"./he-il/audience-view-dialog.js":[548263,133912],"./he-il/auth.js":[129209,576476],"./he-il/autosuggest.js":[758075,92193],"./he-il/avatar.js":[959602,590538],"./he-il/biometric-enrollment.js":[725446,672830],"./he-il/breakout-rooms.js":[613801,655736],"./he-il/broadcast.js":[957221,298216],"./he-il/calendar.js":[680733,296327],"./he-il/calling.js":[104053,733146],"./he-il/campaign-notifications.js":[916319,878698],"./he-il/carousel-multi-card.js":[526901,840015],"./he-il/cast.js":[390480,990659],"./he-il/channels.js":[388121,589142],"./he-il/chat-list.js":[177459,601032],"./he-il/coach-report.js":[958007,719582],"./he-il/comment-stream.js":[673652,799487],"./he-il/communities.js":[18953,18299],"./he-il/compose.js":[851415,295422],"./he-il/contacts.js":[253322,793631],"./he-il/datepicker.js":[186840,126479],"./he-il/desktop.js":[854605,240651],"./he-il/digital-signage.js":[656860,813658],"./he-il/discover-surface.js":[543772,544162],"./he-il/edu.js":[279873,301294],"./he-il/embed.js":[588411,844976],"./he-il/errors.js":[770819,398667],"./he-il/esp.js":[978759,440170],"./he-il/extensibility-ptz-extension.js":[405628,358685],"./he-il/extensibility-room-remote.js":[500941,218167],"./he-il/extensibility.js":[947426,868537],"./he-il/feedback.js":[633223,527105],"./he-il/files.js":[923499,200434],"./he-il/framework.js":[622681,759836],"./he-il/freemium-upgrade.js":[448612,174478],"./he-il/freemium.js":[313621,741880],"./he-il/funstuff.js":[413215,106858],"./he-il/gallery.js":[834354,136666],"./he-il/growth.js":[452430,371194],"./he-il/guardians.js":[464657,961804],"./he-il/health.js":[888198,871089],"./he-il/help.js":[107214,83344],"./he-il/hololens.js":[280646,656157],"./he-il/host-controls.js":[344719,486974],"./he-il/jana.js":[165342,193050],"./he-il/lightbox.js":[908591,108482],"./he-il/live-persona-card.js":[532384,446525],"./he-il/live-persona-editor.js":[595887,923355],"./he-il/lms-integration.js":[433769,424252],"./he-il/meet-for-work.js":[251606,13770],"./he-il/meeting-analytics.js":[110754,305081],"./he-il/meeting-apis-app.js":[227079,681826],"./he-il/meeting-bot.js":[776081,625769],"./he-il/meeting-collaboration.js":[620147,690461],"./he-il/meeting-flyout.js":[955884,296767],"./he-il/meeting-meet-app.js":[778121,170387],"./he-il/meeting-options.js":[645997,299567],"./he-il/meeting-recap.js":[958835,390096],"./he-il/meeting-room-console.js":[648773,560311],"./he-il/meeting-stream-app.js":[630428,324001],"./he-il/message-escalate-dialog.js":[287358,236830],"./he-il/messaging.js":[146480,764980],"./he-il/mtma-missed-notifications.js":[507470,417787],"./he-il/nova.js":[914559,843118],"./he-il/people-app.js":[830038,436148],"./he-il/people-picker.js":[62058,571238],"./he-il/people-targeting.js":[627426,90578],"./he-il/people.js":[892894,164485],"./he-il/person.js":[987573,289707],"./he-il/phonelink-sms.js":[180325,579706],"./he-il/pre-core.js":[788411,494060],"./he-il/premium-benefits.js":[199926,34805],"./he-il/presence.js":[35110,767200],"./he-il/queues.js":[37406,674093],"./he-il/recurrence.js":[88528,295295],"./he-il/rsc-application-permissions.js":[16647,548645],"./he-il/search.js":[919336,9716],"./he-il/semantic-object.js":[480295,210377],"./he-il/settings.js":[783859,463153],"./he-il/share-in-meetings.js":[500127,654943],"./he-il/share-to-teams-outlook-addin.js":[822854,583344],"./he-il/share-to-teams-third-party.js":[744195,945331],"./he-il/share-to-teams.js":[976007,252164],"./he-il/shortcut.js":[775530,892250],"./he-il/shortcuts.js":[524378,812910],"./he-il/simple-collab.js":[52370,354599],"./he-il/smart-device.js":[17675,81952],"./he-il/survey.js":[528169,72259],"./he-il/sv-flyout.js":[995768,849381],"./he-il/teams-and-channels.js":[510202,284323],"./he-il/teams-insider.js":[391101,602398],"./he-il/telemetry.js":[92694,777685],"./he-il/tfl-homepage.js":[825862,159507],"./he-il/tfl-onboarding.js":[442642,741824],"./he-il/toast-notifications.js":[227256,973008],"./he-il/unified-search.js":[330809,11049],"./he-il/unsupported-browser.js":[848209,169548],"./he-il/url-preview.js":[823822,868665],"./he-il/video-capture.js":[143989,390291],"./he-il/video-message.js":[824559,278975],"./he-il/virtual-events.js":[938771,249996],"./he-il/webinar.js":[906705,303061],"./he-il/welcome-bot.js":[910346,274511],"./he-il/whats-new.js":[341607,657107],"./he-il/wiki.js":[203297,147696],"./hi-in/activity.js":[782904,68654],"./hi-in/artifacts-platform.js":[428342,759867],"./hi-in/audience-view-dialog.js":[569654,812044],"./hi-in/auth.js":[188123,865898],"./hi-in/autosuggest.js":[199521,517418],"./hi-in/avatar.js":[428229,862823],"./hi-in/biometric-enrollment.js":[844642,925587],"./hi-in/breakout-rooms.js":[348325,970113],"./hi-in/broadcast.js":[369479,736405],"./hi-in/calendar.js":[647248,361001],"./hi-in/calling.js":[143354,349519],"./hi-in/campaign-notifications.js":[878729,793266],"./hi-in/carousel-multi-card.js":[951706,28894],"./hi-in/cast.js":[551565,988164],"./hi-in/channels.js":[571109,13891],"./hi-in/chat-list.js":[72517,551442],"./hi-in/coach-report.js":[865957,563179],"./hi-in/comment-stream.js":[869209,496741],"./hi-in/communities.js":[416640,705980],"./hi-in/compose.js":[616649,983188],"./hi-in/contacts.js":[177247,713516],"./hi-in/datepicker.js":[286977,575962],"./hi-in/desktop.js":[977703,492567],"./hi-in/digital-signage.js":[733778,325223],"./hi-in/discover-surface.js":[27968,52791],"./hi-in/edu.js":[96499,660273],"./hi-in/embed.js":[872593,801299],"./hi-in/errors.js":[25470,909255],"./hi-in/esp.js":[468717,38252],"./hi-in/extensibility-ptz-extension.js":[23688,98578],"./hi-in/extensibility-room-remote.js":[480763,360016],"./hi-in/extensibility.js":[542502,305036],"./hi-in/feedback.js":[878961,91727],"./hi-in/files.js":[934060,186248],"./hi-in/framework.js":[521740,571047],"./hi-in/freemium-upgrade.js":[199842,234914],"./hi-in/freemium.js":[647024,971563],"./hi-in/funstuff.js":[882656,553762],"./hi-in/gallery.js":[195232,697302],"./hi-in/growth.js":[717070,423385],"./hi-in/guardians.js":[86813,58041],"./hi-in/health.js":[776167,462623],"./hi-in/help.js":[724138,247410],"./hi-in/hololens.js":[97717,845330],"./hi-in/host-controls.js":[61968,970387],"./hi-in/jana.js":[276790,732571],"./hi-in/lightbox.js":[513271,321051],"./hi-in/live-persona-card.js":[868120,583175],"./hi-in/live-persona-editor.js":[691374,186781],"./hi-in/lms-integration.js":[725057,551783],"./hi-in/meet-for-work.js":[545023,735342],"./hi-in/meeting-analytics.js":[68836,246157],"./hi-in/meeting-apis-app.js":[534510,420494],"./hi-in/meeting-bot.js":[558982,151167],"./hi-in/meeting-collaboration.js":[542733,716185],"./hi-in/meeting-flyout.js":[798545,880389],"./hi-in/meeting-meet-app.js":[932430,321881],"./hi-in/meeting-options.js":[112298,352931],"./hi-in/meeting-recap.js":[911188,938450],"./hi-in/meeting-room-console.js":[128899,68903],"./hi-in/meeting-stream-app.js":[930121,142297],"./hi-in/message-escalate-dialog.js":[486187,586812],"./hi-in/messaging.js":[757891,220516],"./hi-in/mtma-missed-notifications.js":[410656,417671],"./hi-in/nova.js":[130591,808338],"./hi-in/people-app.js":[91120,397922],"./hi-in/people-picker.js":[866391,451815],"./hi-in/people-targeting.js":[981659,510568],"./hi-in/people.js":[576024,435182],"./hi-in/person.js":[106614,417361],"./hi-in/phonelink-sms.js":[89892,796766],"./hi-in/pre-core.js":[172709,334137],"./hi-in/premium-benefits.js":[247468,706338],"./hi-in/presence.js":[634738,795121],"./hi-in/queues.js":[71790,479807],"./hi-in/recurrence.js":[991822,605671],"./hi-in/rsc-application-permissions.js":[96142,647882],"./hi-in/search.js":[691101,73067],"./hi-in/semantic-object.js":[608386,695636],"./hi-in/settings.js":[325510,695489],"./hi-in/share-in-meetings.js":[990167,7653],"./hi-in/share-to-teams-outlook-addin.js":[723610,46003],"./hi-in/share-to-teams-third-party.js":[798553,862969],"./hi-in/share-to-teams.js":[289648,15154],"./hi-in/shortcut.js":[780341,240855],"./hi-in/shortcuts.js":[833424,932070],"./hi-in/simple-collab.js":[512101,319446],"./hi-in/smart-device.js":[307820,892371],"./hi-in/survey.js":[43284,468701],"./hi-in/sv-flyout.js":[460433,818166],"./hi-in/teams-and-channels.js":[161806,996350],"./hi-in/teams-insider.js":[979749,24529],"./hi-in/telemetry.js":[229823,439949],"./hi-in/tfl-homepage.js":[10668,384056],"./hi-in/tfl-onboarding.js":[109558,376548],"./hi-in/toast-notifications.js":[808965,815983],"./hi-in/unified-search.js":[798871,30548],"./hi-in/unsupported-browser.js":[898159,969548],"./hi-in/url-preview.js":[577308,528126],"./hi-in/video-capture.js":[951548,454161],"./hi-in/video-message.js":[231582,17197],"./hi-in/virtual-events.js":[504500,226634],"./hi-in/webinar.js":[697294,803475],"./hi-in/welcome-bot.js":[494957,135764],"./hi-in/whats-new.js":[254347,917736],"./hi-in/wiki.js":[773568,143768],"./hr-hr/activity.js":[299780,101870],"./hr-hr/artifacts-platform.js":[447477,84655],"./hr-hr/audience-view-dialog.js":[713107,169834],"./hr-hr/auth.js":[913546,849223],"./hr-hr/autosuggest.js":[757525,319420],"./hr-hr/avatar.js":[556611,959806],"./hr-hr/biometric-enrollment.js":[101619,522509],"./hr-hr/breakout-rooms.js":[294497,414118],"./hr-hr/broadcast.js":[864623,904297],"./hr-hr/calendar.js":[279118,39159],"./hr-hr/calling.js":[532841,943866],"./hr-hr/campaign-notifications.js":[54447,777752],"./hr-hr/carousel-multi-card.js":[163642,405109],"./hr-hr/cast.js":[824457,866217],"./hr-hr/channels.js":[145796,396705],"./hr-hr/chat-list.js":[444600,800691],"./hr-hr/coach-report.js":[917355,668508],"./hr-hr/comment-stream.js":[392051,632877],"./hr-hr/communities.js":[570727,727809],"./hr-hr/compose.js":[466539,165227],"./hr-hr/contacts.js":[860528,328571],"./hr-hr/datepicker.js":[827327,548278],"./hr-hr/desktop.js":[789726,945951],"./hr-hr/digital-signage.js":[174844,512748],"./hr-hr/discover-surface.js":[431937,345855],"./hr-hr/edu.js":[505418,439961],"./hr-hr/embed.js":[89603,293465],"./hr-hr/errors.js":[793573,20639],"./hr-hr/esp.js":[490035,524937],"./hr-hr/extensibility-ptz-extension.js":[314201,611343],"./hr-hr/extensibility-room-remote.js":[507340,389097],"./hr-hr/extensibility.js":[63702,472415],"./hr-hr/feedback.js":[170863,664084],"./hr-hr/files.js":[898204,260457],"./hr-hr/framework.js":[225667,997891],"./hr-hr/freemium-upgrade.js":[611003,905722],"./hr-hr/freemium.js":[945689,581695],"./hr-hr/funstuff.js":[784273,920155],"./hr-hr/gallery.js":[301895,203249],"./hr-hr/growth.js":[616056,657330],"./hr-hr/guardians.js":[610263,955083],"./hr-hr/health.js":[591781,464241],"./hr-hr/help.js":[180324,377323],"./hr-hr/hololens.js":[882032,810333],"./hr-hr/host-controls.js":[577970,70672],"./hr-hr/jana.js":[317817,799905],"./hr-hr/lightbox.js":[891561,598854],"./hr-hr/live-persona-card.js":[496288,850069],"./hr-hr/live-persona-editor.js":[73473,270912],"./hr-hr/lms-integration.js":[750137,981614],"./hr-hr/meet-for-work.js":[628173,547224],"./hr-hr/meeting-analytics.js":[821137,318838],"./hr-hr/meeting-apis-app.js":[960025,942706],"./hr-hr/meeting-bot.js":[503268,575489],"./hr-hr/meeting-collaboration.js":[122288,835509],"./hr-hr/meeting-flyout.js":[349010,861224],"./hr-hr/meeting-meet-app.js":[437139,422012],"./hr-hr/meeting-options.js":[710573,944843],"./hr-hr/meeting-recap.js":[461399,637865],"./hr-hr/meeting-room-console.js":[131554,54473],"./hr-hr/meeting-stream-app.js":[119184,966522],"./hr-hr/message-escalate-dialog.js":[90,964460],"./hr-hr/messaging.js":[147983,704913],"./hr-hr/mtma-missed-notifications.js":[964194,778823],"./hr-hr/nova.js":[867838,539270],"./hr-hr/people-app.js":[71417,762856],"./hr-hr/people-picker.js":[917806,741249],"./hr-hr/people-targeting.js":[23585,170976],"./hr-hr/people.js":[80847,239743],"./hr-hr/person.js":[492615,440391],"./hr-hr/phonelink-sms.js":[395282,681535],"./hr-hr/pre-core.js":[915437,769048],"./hr-hr/premium-benefits.js":[956733,688354],"./hr-hr/presence.js":[692379,529516],"./hr-hr/queues.js":[307849,362281],"./hr-hr/recurrence.js":[671969,963396],"./hr-hr/rsc-application-permissions.js":[86915,767378],"./hr-hr/search.js":[495394,480810],"./hr-hr/semantic-object.js":[32077,197259],"./hr-hr/settings.js":[863314,675311],"./hr-hr/share-in-meetings.js":[401866,624361],"./hr-hr/share-to-teams-outlook-addin.js":[389011,333012],"./hr-hr/share-to-teams-third-party.js":[705743,477547],"./hr-hr/share-to-teams.js":[305436,958408],"./hr-hr/shortcut.js":[182737,84370],"./hr-hr/shortcuts.js":[271781,569598],"./hr-hr/simple-collab.js":[852609,994040],"./hr-hr/smart-device.js":[515365,914543],"./hr-hr/survey.js":[707897,477482],"./hr-hr/sv-flyout.js":[221185,117339],"./hr-hr/teams-and-channels.js":[552242,632993],"./hr-hr/teams-insider.js":[270894,429698],"./hr-hr/telemetry.js":[196843,48601],"./hr-hr/tfl-homepage.js":[284752,431589],"./hr-hr/tfl-onboarding.js":[634178,203090],"./hr-hr/toast-notifications.js":[874895,517693],"./hr-hr/unified-search.js":[890274,600511],"./hr-hr/unsupported-browser.js":[177956,769941],"./hr-hr/url-preview.js":[958494,31664],"./hr-hr/video-capture.js":[651386,341224],"./hr-hr/video-message.js":[697410,828048],"./hr-hr/virtual-events.js":[194332,249882],"./hr-hr/webinar.js":[185866,720674],"./hr-hr/welcome-bot.js":[887362,944372],"./hr-hr/whats-new.js":[76353,334850],"./hr-hr/wiki.js":[673741,883555],"./hu-hu/activity.js":[904281,83324],"./hu-hu/artifacts-platform.js":[542516,698203],"./hu-hu/audience-view-dialog.js":[703027,981774],"./hu-hu/auth.js":[103993,595554],"./hu-hu/autosuggest.js":[273743,98521],"./hu-hu/avatar.js":[589162,614200],"./hu-hu/biometric-enrollment.js":[429251,456109],"./hu-hu/breakout-rooms.js":[491897,327059],"./hu-hu/broadcast.js":[989321,430915],"./hu-hu/calendar.js":[627163,63725],"./hu-hu/calling.js":[527362,359350],"./hu-hu/campaign-notifications.js":[363803,573366],"./hu-hu/carousel-multi-card.js":[500684,16975],"./hu-hu/cast.js":[235279,763213],"./hu-hu/channels.js":[831005,293050],"./hu-hu/chat-list.js":[703405,885456],"./hu-hu/coach-report.js":[338313,584858],"./hu-hu/comment-stream.js":[832126,643461],"./hu-hu/communities.js":[253892,462773],"./hu-hu/compose.js":[615903,766968],"./hu-hu/contacts.js":[637672,120199],"./hu-hu/datepicker.js":[328628,78721],"./hu-hu/desktop.js":[167290,978776],"./hu-hu/digital-signage.js":[456805,271312],"./hu-hu/discover-surface.js":[66879,843953],"./hu-hu/edu.js":[853212,613762],"./hu-hu/embed.js":[331463,76586],"./hu-hu/errors.js":[568604,398326],"./hu-hu/esp.js":[101303,120103],"./hu-hu/extensibility-ptz-extension.js":[652445,97986],"./hu-hu/extensibility-room-remote.js":[180562,197689],"./hu-hu/extensibility.js":[878493,740278],"./hu-hu/feedback.js":[972081,127687],"./hu-hu/files.js":[365766,810831],"./hu-hu/framework.js":[99476,273113],"./hu-hu/freemium-upgrade.js":[308852,903279],"./hu-hu/freemium.js":[970032,301930],"./hu-hu/funstuff.js":[692889,50593],"./hu-hu/gallery.js":[89249,580075],"./hu-hu/growth.js":[817190,817896],"./hu-hu/guardians.js":[762806,459683],"./hu-hu/health.js":[932208,250612],"./hu-hu/help.js":[553006,223245],"./hu-hu/hololens.js":[51030,738288],"./hu-hu/host-controls.js":[703017,608470],"./hu-hu/jana.js":[801426,928046],"./hu-hu/lightbox.js":[834396,732283],"./hu-hu/live-persona-card.js":[708236,872177],"./hu-hu/live-persona-editor.js":[141140,692872],"./hu-hu/lms-integration.js":[213236,486855],"./hu-hu/meet-for-work.js":[114121,379531],"./hu-hu/meeting-analytics.js":[664611,787370],"./hu-hu/meeting-apis-app.js":[566530,330424],"./hu-hu/meeting-bot.js":[735791,819918],"./hu-hu/meeting-collaboration.js":[939127,518102],"./hu-hu/meeting-flyout.js":[380084,349174],"./hu-hu/meeting-meet-app.js":[566856,858275],"./hu-hu/meeting-options.js":[67270,267998],"./hu-hu/meeting-recap.js":[462972,916471],"./hu-hu/meeting-room-console.js":[188236,648173],"./hu-hu/meeting-stream-app.js":[58181,67722],"./hu-hu/message-escalate-dialog.js":[220001,318689],"./hu-hu/messaging.js":[592174,221253],"./hu-hu/mtma-missed-notifications.js":[6596,412194],"./hu-hu/nova.js":[446226,135084],"./hu-hu/people-app.js":[923475,299189],"./hu-hu/people-picker.js":[92469,432670],"./hu-hu/people-targeting.js":[588313,427161],"./hu-hu/people.js":[967897,550341],"./hu-hu/person.js":[14930,452230],"./hu-hu/phonelink-sms.js":[88461,693610],"./hu-hu/pre-core.js":[796902,578065],"./hu-hu/premium-benefits.js":[654742,480103],"./hu-hu/presence.js":[495337,47556],"./hu-hu/queues.js":[720645,470507],"./hu-hu/recurrence.js":[604825,778592],"./hu-hu/rsc-application-permissions.js":[113098,58824],"./hu-hu/search.js":[803125,364183],"./hu-hu/semantic-object.js":[394881,145106],"./hu-hu/settings.js":[317805,745116],"./hu-hu/share-in-meetings.js":[675600,368732],"./hu-hu/share-to-teams-outlook-addin.js":[366617,411584],"./hu-hu/share-to-teams-third-party.js":[209426,917250],"./hu-hu/share-to-teams.js":[684468,697202],"./hu-hu/shortcut.js":[761456,391386],"./hu-hu/shortcuts.js":[885910,98950],"./hu-hu/simple-collab.js":[635877,335902],"./hu-hu/smart-device.js":[472343,367949],"./hu-hu/survey.js":[512483,165389],"./hu-hu/sv-flyout.js":[904089,92325],"./hu-hu/teams-and-channels.js":[646870,852382],"./hu-hu/teams-insider.js":[311615,613763],"./hu-hu/telemetry.js":[641951,196126],"./hu-hu/tfl-homepage.js":[785246,594037],"./hu-hu/tfl-onboarding.js":[563337,345315],"./hu-hu/toast-notifications.js":[614100,489721],"./hu-hu/unified-search.js":[517904,119711],"./hu-hu/unsupported-browser.js":[348649,188979],"./hu-hu/url-preview.js":[334218,69817],"./hu-hu/video-capture.js":[942464,254431],"./hu-hu/video-message.js":[506789,781676],"./hu-hu/virtual-events.js":[185314,207272],"./hu-hu/webinar.js":[751170,347800],"./hu-hu/welcome-bot.js":[108233,327076],"./hu-hu/whats-new.js":[196987,810170],"./hu-hu/wiki.js":[499709,867576],"./id-id/activity.js":[945925,466585],"./id-id/artifacts-platform.js":[92031,226381],"./id-id/audience-view-dialog.js":[677667,824966],"./id-id/auth.js":[42897,879934],"./id-id/autosuggest.js":[651774,673411],"./id-id/avatar.js":[352273,745695],"./id-id/biometric-enrollment.js":[497856,396710],"./id-id/breakout-rooms.js":[382830,761889],"./id-id/broadcast.js":[88468,880740],"./id-id/calendar.js":[596288,90257],"./id-id/calling.js":[842720,917098],"./id-id/campaign-notifications.js":[391213,551961],"./id-id/carousel-multi-card.js":[735956,118516],"./id-id/cast.js":[976031,285818],"./id-id/channels.js":[400717,848979],"./id-id/chat-list.js":[561838,211385],"./id-id/coach-report.js":[188752,742051],"./id-id/comment-stream.js":[924765,864701],"./id-id/communities.js":[470603,469997],"./id-id/compose.js":[586157,330200],"./id-id/contacts.js":[656329,805887],"./id-id/datepicker.js":[535325,653937],"./id-id/desktop.js":[23955,690115],"./id-id/digital-signage.js":[570958,256759],"./id-id/discover-surface.js":[495061,700122],"./id-id/edu.js":[557966,997651],"./id-id/embed.js":[691120,935205],"./id-id/errors.js":[125996,313563],"./id-id/esp.js":[758262,155672],"./id-id/extensibility-ptz-extension.js":[626035,699993],"./id-id/extensibility-room-remote.js":[793847,830755],"./id-id/extensibility.js":[916235,390590],"./id-id/feedback.js":[477966,994803],"./id-id/files.js":[313630,678609],"./id-id/framework.js":[977620,497907],"./id-id/freemium-upgrade.js":[230665,705464],"./id-id/freemium.js":[938489,364946],"./id-id/funstuff.js":[598990,501054],"./id-id/gallery.js":[604464,843596],"./id-id/growth.js":[321287,9205],"./id-id/guardians.js":[89568,394185],"./id-id/health.js":[828412,917572],"./id-id/help.js":[901746,515143],"./id-id/hololens.js":[168420,310262],"./id-id/host-controls.js":[861997,295598],"./id-id/jana.js":[408992,131607],"./id-id/lightbox.js":[515570,696384],"./id-id/live-persona-card.js":[417981,754743],"./id-id/live-persona-editor.js":[472135,366053],"./id-id/lms-integration.js":[135977,387758],"./id-id/meet-for-work.js":[585962,606227],"./id-id/meeting-analytics.js":[528262,844329],"./id-id/meeting-apis-app.js":[739586,150585],"./id-id/meeting-bot.js":[495834,725168],"./id-id/meeting-collaboration.js":[614780,953894],"./id-id/meeting-flyout.js":[540518,765294],"./id-id/meeting-meet-app.js":[471160,245247],"./id-id/meeting-options.js":[150396,358132],"./id-id/meeting-recap.js":[91342,827852],"./id-id/meeting-room-console.js":[799790,24782],"./id-id/meeting-stream-app.js":[693358,145987],"./id-id/message-escalate-dialog.js":[829682,974543],"./id-id/messaging.js":[184210,960267],"./id-id/mtma-missed-notifications.js":[406554,479377],"./id-id/nova.js":[508181,715013],"./id-id/people-app.js":[610083,335542],"./id-id/people-picker.js":[486492,545549],"./id-id/people-targeting.js":[393998,202852],"./id-id/people.js":[241700,723099],"./id-id/person.js":[658356,52277],"./id-id/phonelink-sms.js":[906002,636934],"./id-id/pre-core.js":[867271,541874],"./id-id/premium-benefits.js":[979177,997110],"./id-id/presence.js":[540661,728849],"./id-id/queues.js":[849816,660171],"./id-id/recurrence.js":[889886,174851],"./id-id/rsc-application-permissions.js":[311344,415279],"./id-id/search.js":[263449,959916],"./id-id/semantic-object.js":[680061,515179],"./id-id/settings.js":[740526,915001],"./id-id/share-in-meetings.js":[535838,446538],"./id-id/share-to-teams-outlook-addin.js":[134499,77370],"./id-id/share-to-teams-third-party.js":[701433,382732],"./id-id/share-to-teams.js":[288333,40400],"./id-id/shortcut.js":[106559,949795],"./id-id/shortcuts.js":[860581,986183],"./id-id/simple-collab.js":[190374,723695],"./id-id/smart-device.js":[572776,868239],"./id-id/survey.js":[586490,880475],"./id-id/sv-flyout.js":[498364,133587],"./id-id/teams-and-channels.js":[446983,652906],"./id-id/teams-insider.js":[121604,871475],"./id-id/telemetry.js":[478413,625454],"./id-id/tfl-homepage.js":[578523,615482],"./id-id/tfl-onboarding.js":[394735,167721],"./id-id/toast-notifications.js":[333267,374154],"./id-id/unified-search.js":[655984,133043],"./id-id/unsupported-browser.js":[511424,396008],"./id-id/url-preview.js":[946876,234786],"./id-id/video-capture.js":[419699,862815],"./id-id/video-message.js":[192688,266828],"./id-id/virtual-events.js":[381700,938094],"./id-id/webinar.js":[667844,697834],"./id-id/welcome-bot.js":[400435,175586],"./id-id/whats-new.js":[39926,211101],"./id-id/wiki.js":[69076,2223],"./is-is/activity.js":[52576,390627],"./is-is/artifacts-platform.js":[76760,551444],"./is-is/audience-view-dialog.js":[572578,479017],"./is-is/auth.js":[691212,887246],"./is-is/autosuggest.js":[652800,492278],"./is-is/avatar.js":[84050,412851],"./is-is/biometric-enrollment.js":[116939,37934],"./is-is/breakout-rooms.js":[513181,855638],"./is-is/broadcast.js":[210414,440487],"./is-is/calendar.js":[26375,225215],"./is-is/calling.js":[549134,521590],"./is-is/campaign-notifications.js":[817064,632412],"./is-is/carousel-multi-card.js":[675474,741149],"./is-is/cast.js":[77199,918688],"./is-is/channels.js":[142562,92563],"./is-is/chat-list.js":[5169,475450],"./is-is/coach-report.js":[199042,279229],"./is-is/comment-stream.js":[385105,248136],"./is-is/communities.js":[844284,372389],"./is-is/compose.js":[299106,536674],"./is-is/contacts.js":[247664,834439],"./is-is/datepicker.js":[825719,129345],"./is-is/desktop.js":[18415,678489],"./is-is/digital-signage.js":[595878,410752],"./is-is/discover-surface.js":[753264,181529],"./is-is/edu.js":[901525,124922],"./is-is/embed.js":[685656,589799],"./is-is/errors.js":[991092,805157],"./is-is/esp.js":[444941,550853],"./is-is/extensibility-ptz-extension.js":[562815,699870],"./is-is/extensibility-room-remote.js":[839849,717269],"./is-is/extensibility.js":[727824,43206],"./is-is/feedback.js":[16e3,575e3],"./is-is/files.js":[331673,444808],"./is-is/framework.js":[862425,379883],"./is-is/freemium-upgrade.js":[562531,595017],"./is-is/freemium.js":[7965,87506],"./is-is/funstuff.js":[632337,295890],"./is-is/gallery.js":[235860,147475],"./is-is/growth.js":[62246,338734],"./is-is/guardians.js":[629994,175608],"./is-is/health.js":[48460,383533],"./is-is/help.js":[17344,380975],"./is-is/hololens.js":[107399,819890],"./is-is/host-controls.js":[897566,519586],"./is-is/jana.js":[173357,561706],"./is-is/lightbox.js":[256370,813584],"./is-is/live-persona-card.js":[384842,696248],"./is-is/live-persona-editor.js":[393440,20962],"./is-is/lms-integration.js":[779012,324494],"./is-is/meet-for-work.js":[389259,786694],"./is-is/meeting-analytics.js":[402334,611893],"./is-is/meeting-apis-app.js":[675330,192021],"./is-is/meeting-bot.js":[913293,681255],"./is-is/meeting-collaboration.js":[640489,257010],"./is-is/meeting-flyout.js":[600797,27472],"./is-is/meeting-meet-app.js":[279397,845470],"./is-is/meeting-options.js":[654528,319154],"./is-is/meeting-recap.js":[152746,369402],"./is-is/meeting-room-console.js":[920661,539457],"./is-is/meeting-stream-app.js":[199692,117843],"./is-is/message-escalate-dialog.js":[612913,727303],"./is-is/messaging.js":[475169,653758],"./is-is/mtma-missed-notifications.js":[121979,538094],"./is-is/nova.js":[896454,632584],"./is-is/people-app.js":[810057,395059],"./is-is/people-picker.js":[443950,953629],"./is-is/people-targeting.js":[946242,720056],"./is-is/people.js":[579240,340469],"./is-is/person.js":[605697,847336],"./is-is/phonelink-sms.js":[743569,74592],"./is-is/pre-core.js":[554524,224984],"./is-is/premium-benefits.js":[383119,53285],"./is-is/presence.js":[278252,943338],"./is-is/queues.js":[993146,226461],"./is-is/recurrence.js":[705605,324348],"./is-is/rsc-application-permissions.js":[245107,260020],"./is-is/search.js":[642507,650930],"./is-is/semantic-object.js":[545366,113401],"./is-is/settings.js":[670322,320483],"./is-is/share-in-meetings.js":[276560,578781],"./is-is/share-to-teams-outlook-addin.js":[839738,838116],"./is-is/share-to-teams-third-party.js":[973506,249153],"./is-is/share-to-teams.js":[593252,534464],"./is-is/shortcut.js":[158948,794282],"./is-is/shortcuts.js":[22427,969060],"./is-is/simple-collab.js":[145973,481618],"./is-is/smart-device.js":[601807,315622],"./is-is/survey.js":[851432,515406],"./is-is/sv-flyout.js":[623578,607015],"./is-is/teams-and-channels.js":[274137,708916],"./is-is/teams-insider.js":[608007,178500],"./is-is/telemetry.js":[414911,741333],"./is-is/tfl-homepage.js":[299766,353991],"./is-is/tfl-onboarding.js":[283637,668781],"./is-is/toast-notifications.js":[903385,726510],"./is-is/unified-search.js":[258366,235709],"./is-is/unsupported-browser.js":[194242,791911],"./is-is/url-preview.js":[741075,443208],"./is-is/video-capture.js":[515739,138011],"./is-is/video-message.js":[448634,308019],"./is-is/virtual-events.js":[672974,971344],"./is-is/webinar.js":[421989,527770],"./is-is/welcome-bot.js":[972084,914821],"./is-is/whats-new.js":[162238,223548],"./is-is/wiki.js":[245509,695131],"./it-it/activity.js":[456881,482682],"./it-it/artifacts-platform.js":[371514,617716],"./it-it/audience-view-dialog.js":[675884,829150],"./it-it/auth.js":[745598,735581],"./it-it/autosuggest.js":[250641,184998],"./it-it/avatar.js":[113258,781738],"./it-it/biometric-enrollment.js":[217654,786389],"./it-it/breakout-rooms.js":[661054,976501],"./it-it/broadcast.js":[398028,460820],"./it-it/calendar.js":[470011,627145],"./it-it/calling.js":[899116,357005],"./it-it/campaign-notifications.js":[846711,273130],"./it-it/carousel-multi-card.js":[637035,758371],"./it-it/cast.js":[10294,846752],"./it-it/channels.js":[51845,389301],"./it-it/chat-list.js":[594336,844812],"./it-it/coach-report.js":[220892,795282],"./it-it/comment-stream.js":[213313,246814],"./it-it/communities.js":[799408,456403],"./it-it/compose.js":[561395,788211],"./it-it/contacts.js":[685471,934978],"./it-it/datepicker.js":[776049,258789],"./it-it/desktop.js":[678594,831992],"./it-it/digital-signage.js":[58804,152081],"./it-it/discover-surface.js":[961735,247533],"./it-it/edu.js":[5866,653295],"./it-it/embed.js":[575899,540434],"./it-it/errors.js":[551820,23995],"./it-it/esp.js":[148165,970578],"./it-it/extensibility-ptz-extension.js":[532856,767948],"./it-it/extensibility-room-remote.js":[112689,774054],"./it-it/extensibility.js":[963736,16457],"./it-it/feedback.js":[477867,749502],"./it-it/files.js":[173495,420144],"./it-it/framework.js":[426910,404686],"./it-it/freemium-upgrade.js":[741178,498023],"./it-it/freemium.js":[375566,915097],"./it-it/funstuff.js":[224927,754273],"./it-it/gallery.js":[54677,898408],"./it-it/growth.js":[324260,588116],"./it-it/guardians.js":[601728,257380],"./it-it/health.js":[804199,572914],"./it-it/help.js":[115640,676618],"./it-it/hololens.js":[939027,357786],"./it-it/host-controls.js":[692059,4606],"./it-it/jana.js":[875327,412560],"./it-it/lightbox.js":[847917,944607],"./it-it/live-persona-card.js":[490468,126241],"./it-it/live-persona-editor.js":[771340,529790],"./it-it/lms-integration.js":[8498,548220],"./it-it/meet-for-work.js":[700282,82218],"./it-it/meeting-analytics.js":[35350,899768],"./it-it/meeting-apis-app.js":[11662,315850],"./it-it/meeting-bot.js":[591609,81228],"./it-it/meeting-collaboration.js":[847933,552198],"./it-it/meeting-flyout.js":[295002,37506],"./it-it/meeting-meet-app.js":[971177,736307],"./it-it/meeting-options.js":[864705,488821],"./it-it/meeting-recap.js":[7189,98032],"./it-it/meeting-room-console.js":[434179,571078],"./it-it/meeting-stream-app.js":[397980,17040],"./it-it/message-escalate-dialog.js":[543291,927019],"./it-it/messaging.js":[210444,27203],"./it-it/mtma-missed-notifications.js":[63072,879883],"./it-it/nova.js":[624921,581771],"./it-it/people-app.js":[683531,177104],"./it-it/people-picker.js":[388501,797834],"./it-it/people-targeting.js":[875195,138794],"./it-it/people.js":[634997,113982],"./it-it/person.js":[107507,755728],"./it-it/phonelink-sms.js":[575154,397679],"./it-it/pre-core.js":[71033,416369],"./it-it/premium-benefits.js":[885448,230523],"./it-it/presence.js":[795240,95927],"./it-it/queues.js":[776307,694287],"./it-it/recurrence.js":[962813,385659],"./it-it/rsc-application-permissions.js":[365782,199775],"./it-it/search.js":[745475,264759],"./it-it/semantic-object.js":[775580,454758],"./it-it/settings.js":[421893,762526],"./it-it/share-in-meetings.js":[592800,500979],"./it-it/share-to-teams-outlook-addin.js":[996135,404564],"./it-it/share-to-teams-third-party.js":[488601,781677],"./it-it/share-to-teams.js":[447229,641773],"./it-it/shortcut.js":[314e3,922785],"./it-it/shortcuts.js":[920467,834073],"./it-it/simple-collab.js":[991537,887028],"./it-it/smart-device.js":[991011,318128],"./it-it/survey.js":[838575,749971],"./it-it/sv-flyout.js":[722314,770662],"./it-it/teams-and-channels.js":[218005,168943],"./it-it/teams-insider.js":[548566,971790],"./it-it/telemetry.js":[288338,510128],"./it-it/tfl-homepage.js":[140263,604835],"./it-it/tfl-onboarding.js":[861324,819632],"./it-it/toast-notifications.js":[635257,908992],"./it-it/unified-search.js":[134738,946838],"./it-it/unsupported-browser.js":[845484,174883],"./it-it/url-preview.js":[702626,535188],"./it-it/video-capture.js":[381812,647708],"./it-it/video-message.js":[386781,387503],"./it-it/virtual-events.js":[194212,586367],"./it-it/webinar.js":[770361,124468],"./it-it/welcome-bot.js":[61644,670825],"./it-it/whats-new.js":[509732,671219],"./it-it/wiki.js":[83676,23812],"./ja-jp/activity.js":[847091,954441],"./ja-jp/artifacts-platform.js":[299522,872171],"./ja-jp/audience-view-dialog.js":[814385,212425],"./ja-jp/auth.js":[645352,86002],"./ja-jp/autosuggest.js":[116152,311602],"./ja-jp/avatar.js":[103314,484066],"./ja-jp/biometric-enrollment.js":[438159,132880],"./ja-jp/breakout-rooms.js":[600172,909100],"./ja-jp/broadcast.js":[936844,694255],"./ja-jp/calendar.js":[886239,892517],"./ja-jp/calling.js":[254014,601407],"./ja-jp/campaign-notifications.js":[853053,725919],"./ja-jp/carousel-multi-card.js":[472612,925262],"./ja-jp/cast.js":[660853,153894],"./ja-jp/channels.js":[618273,319648],"./ja-jp/chat-list.js":[111241,157251],"./ja-jp/coach-report.js":[94736,473449],"./ja-jp/comment-stream.js":[500166,484639],"./ja-jp/communities.js":[90288,621535],"./ja-jp/compose.js":[994212,683256],"./ja-jp/contacts.js":[487308,327081],"./ja-jp/datepicker.js":[656517,29889],"./ja-jp/desktop.js":[422474,77930],"./ja-jp/digital-signage.js":[362729,699309],"./ja-jp/discover-surface.js":[7501,202001],"./ja-jp/edu.js":[261419,473262],"./ja-jp/embed.js":[28332,494385],"./ja-jp/errors.js":[783896,258263],"./ja-jp/esp.js":[943975,130500],"./ja-jp/extensibility-ptz-extension.js":[4593,4864],"./ja-jp/extensibility-room-remote.js":[982327,132539],"./ja-jp/extensibility.js":[626302,340718],"./ja-jp/feedback.js":[418935,468479],"./ja-jp/files.js":[854450,46366],"./ja-jp/framework.js":[482063,50105],"./ja-jp/freemium-upgrade.js":[908681,113962],"./ja-jp/freemium.js":[317958,820048],"./ja-jp/funstuff.js":[238081,265106],"./ja-jp/gallery.js":[964809,515537],"./ja-jp/growth.js":[664960,251573],"./ja-jp/guardians.js":[261537,830208],"./ja-jp/health.js":[57477,299116],"./ja-jp/help.js":[854873,280359],"./ja-jp/hololens.js":[622894,308640],"./ja-jp/host-controls.js":[42584,201384],"./ja-jp/jana.js":[523209,449355],"./ja-jp/lightbox.js":[28375,88995],"./ja-jp/live-persona-card.js":[748622,213230],"./ja-jp/live-persona-editor.js":[897620,334794],"./ja-jp/lms-integration.js":[449137,887363],"./ja-jp/meet-for-work.js":[490420,295252],"./ja-jp/meeting-analytics.js":[281811,784083],"./ja-jp/meeting-apis-app.js":[183604,848094],"./ja-jp/meeting-bot.js":[733377,668029],"./ja-jp/meeting-collaboration.js":[431923,237456],"./ja-jp/meeting-flyout.js":[446786,23746],"./ja-jp/meeting-meet-app.js":[968318,248708],"./ja-jp/meeting-options.js":[326721,539908],"./ja-jp/meeting-recap.js":[451079,839029],"./ja-jp/meeting-room-console.js":[176045,94946],"./ja-jp/meeting-stream-app.js":[571324,962601],"./ja-jp/message-escalate-dialog.js":[363373,363557],"./ja-jp/messaging.js":[674781,148784],"./ja-jp/mtma-missed-notifications.js":[453088,68547],"./ja-jp/nova.js":[67394,533818],"./ja-jp/people-app.js":[608191,105301],"./ja-jp/people-picker.js":[782286,34715],"./ja-jp/people-targeting.js":[980739,569423],"./ja-jp/people.js":[696078,220112],"./ja-jp/person.js":[189935,940373],"./ja-jp/phonelink-sms.js":[552602,716572],"./ja-jp/pre-core.js":[663446,199673],"./ja-jp/premium-benefits.js":[150828,227936],"./ja-jp/presence.js":[484361,47693],"./ja-jp/queues.js":[820644,613078],"./ja-jp/recurrence.js":[854420,3612],"./ja-jp/rsc-application-permissions.js":[416696,831664],"./ja-jp/search.js":[216316,899533],"./ja-jp/semantic-object.js":[686134,468661],"./ja-jp/settings.js":[484485,710191],"./ja-jp/share-in-meetings.js":[662845,958185],"./ja-jp/share-to-teams-outlook-addin.js":[347926,964507],"./ja-jp/share-to-teams-third-party.js":[227668,34185],"./ja-jp/share-to-teams.js":[966618,821714],"./ja-jp/shortcut.js":[510648,481218],"./ja-jp/shortcuts.js":[591299,433401],"./ja-jp/simple-collab.js":[796156,17994],"./ja-jp/smart-device.js":[341168,140661],"./ja-jp/survey.js":[354003,299366],"./ja-jp/sv-flyout.js":[797615,328985],"./ja-jp/teams-and-channels.js":[353520,227234],"./ja-jp/teams-insider.js":[568189,680292],"./ja-jp/telemetry.js":[232678,95503],"./ja-jp/tfl-homepage.js":[476784,982074],"./ja-jp/tfl-onboarding.js":[650448,101797],"./ja-jp/toast-notifications.js":[962841,557549],"./ja-jp/unified-search.js":[555706,909269],"./ja-jp/unsupported-browser.js":[626664,469445],"./ja-jp/url-preview.js":[743275,544947],"./ja-jp/video-capture.js":[764734,914532],"./ja-jp/video-message.js":[804636,287071],"./ja-jp/virtual-events.js":[178183,683026],"./ja-jp/webinar.js":[877228,790449],"./ja-jp/welcome-bot.js":[672065,448111],"./ja-jp/whats-new.js":[225776,950790],"./ja-jp/wiki.js":[337404,91878],"./ka-ge/activity.js":[752615,903152],"./ka-ge/artifacts-platform.js":[694446,920995],"./ka-ge/audience-view-dialog.js":[848978,803367],"./ka-ge/auth.js":[734596,635300],"./ka-ge/autosuggest.js":[698484,250228],"./ka-ge/avatar.js":[854187,797149],"./ka-ge/biometric-enrollment.js":[979622,306157],"./ka-ge/breakout-rooms.js":[701408,363339],"./ka-ge/broadcast.js":[942527,449401],"./ka-ge/calendar.js":[440981,353936],"./ka-ge/calling.js":[377770,508390],"./ka-ge/campaign-notifications.js":[625627,342436],"./ka-ge/carousel-multi-card.js":[472314,111108],"./ka-ge/cast.js":[420824,830721],"./ka-ge/channels.js":[504426,307581],"./ka-ge/chat-list.js":[315898,689312],"./ka-ge/coach-report.js":[24171,624307],"./ka-ge/comment-stream.js":[165171,909191],"./ka-ge/communities.js":[733174,692915],"./ka-ge/compose.js":[54162,743251],"./ka-ge/contacts.js":[378342,318194],"./ka-ge/datepicker.js":[609074,890249],"./ka-ge/desktop.js":[375844,121508],"./ka-ge/digital-signage.js":[49454,306760],"./ka-ge/discover-surface.js":[570987,443981],"./ka-ge/edu.js":[266675,160762],"./ka-ge/embed.js":[161539,41655],"./ka-ge/errors.js":[2264,560303],"./ka-ge/esp.js":[999189,530035],"./ka-ge/extensibility-ptz-extension.js":[21880,638042],"./ka-ge/extensibility-room-remote.js":[626431,127746],"./ka-ge/extensibility.js":[393009,556551],"./ka-ge/feedback.js":[63403,993270],"./ka-ge/files.js":[503075,587321],"./ka-ge/framework.js":[872417,548666],"./ka-ge/freemium-upgrade.js":[317408,992359],"./ka-ge/freemium.js":[62636,284022],"./ka-ge/funstuff.js":[609678,764419],"./ka-ge/gallery.js":[114852,250500],"./ka-ge/growth.js":[464072,812447],"./ka-ge/guardians.js":[18825,990236],"./ka-ge/health.js":[913389,210181],"./ka-ge/help.js":[628281,476553],"./ka-ge/hololens.js":[119428,907202],"./ka-ge/host-controls.js":[955145,337062],"./ka-ge/jana.js":[674492,815301],"./ka-ge/lightbox.js":[318997,161100],"./ka-ge/live-persona-card.js":[140020,515711],"./ka-ge/live-persona-editor.js":[27519,146811],"./ka-ge/lms-integration.js":[365834,283385],"./ka-ge/meet-for-work.js":[992431,909231],"./ka-ge/meeting-analytics.js":[577252,817746],"./ka-ge/meeting-apis-app.js":[22557,121388],"./ka-ge/meeting-bot.js":[829030,398391],"./ka-ge/meeting-collaboration.js":[76006,322117],"./ka-ge/meeting-flyout.js":[574546,257673],"./ka-ge/meeting-meet-app.js":[336431,862602],"./ka-ge/meeting-options.js":[34332,273104],"./ka-ge/meeting-recap.js":[515789,701919],"./ka-ge/meeting-room-console.js":[413182,233364],"./ka-ge/meeting-stream-app.js":[460768,682210],"./ka-ge/message-escalate-dialog.js":[623187,875814],"./ka-ge/messaging.js":[856109,992277],"./ka-ge/mtma-missed-notifications.js":[61084,218376],"./ka-ge/nova.js":[981111,211332],"./ka-ge/people-app.js":[322185,615263],"./ka-ge/people-picker.js":[513957,230075],"./ka-ge/people-targeting.js":[740518,322473],"./ka-ge/people.js":[858825,451958],"./ka-ge/person.js":[115389,307473],"./ka-ge/phonelink-sms.js":[510825,566206],"./ka-ge/pre-core.js":[341671,6442],"./ka-ge/premium-benefits.js":[761367,192500],"./ka-ge/presence.js":[494989,317120],"./ka-ge/queues.js":[456604,968972],"./ka-ge/recurrence.js":[853475,120607],"./ka-ge/rsc-application-permissions.js":[874459,799463],"./ka-ge/search.js":[496668,894382],"./ka-ge/semantic-object.js":[207404,165930],"./ka-ge/settings.js":[660377,400347],"./ka-ge/share-in-meetings.js":[943166,465665],"./ka-ge/share-to-teams-outlook-addin.js":[289405,914264],"./ka-ge/share-to-teams-third-party.js":[570609,669528],"./ka-ge/share-to-teams.js":[985756,984835],"./ka-ge/shortcut.js":[724956,319085],"./ka-ge/shortcuts.js":[184832,714073],"./ka-ge/simple-collab.js":[295828,543405],"./ka-ge/smart-device.js":[715350,976576],"./ka-ge/survey.js":[203471,249839],"./ka-ge/sv-flyout.js":[974982,943933],"./ka-ge/teams-and-channels.js":[725321,739657],"./ka-ge/teams-insider.js":[340855,911124],"./ka-ge/telemetry.js":[624591,503485],"./ka-ge/tfl-homepage.js":[795277,222877],"./ka-ge/tfl-onboarding.js":[230986,534037],"./ka-ge/toast-notifications.js":[283364,381852],"./ka-ge/unified-search.js":[24541,669721],"./ka-ge/unsupported-browser.js":[981914,675831],"./ka-ge/url-preview.js":[76306,22258],"./ka-ge/video-capture.js":[265605,53330],"./ka-ge/video-message.js":[660584,679943],"./ka-ge/virtual-events.js":[320949,474189],"./ka-ge/webinar.js":[886662,404216],"./ka-ge/welcome-bot.js":[485014,425102],"./ka-ge/whats-new.js":[846172,831388],"./ka-ge/wiki.js":[672758,959152],"./kk-kz/activity.js":[953432,4845],"./kk-kz/artifacts-platform.js":[469535,81769],"./kk-kz/audience-view-dialog.js":[695022,827187],"./kk-kz/auth.js":[768607,620089],"./kk-kz/autosuggest.js":[398241,764855],"./kk-kz/avatar.js":[644035,182627],"./kk-kz/biometric-enrollment.js":[608197,405506],"./kk-kz/breakout-rooms.js":[747723,956166],"./kk-kz/broadcast.js":[398711,649841],"./kk-kz/calendar.js":[992264,839675],"./kk-kz/calling.js":[986196,190277],"./kk-kz/campaign-notifications.js":[526318,415498],"./kk-kz/carousel-multi-card.js":[483113,322466],"./kk-kz/cast.js":[279850,851779],"./kk-kz/channels.js":[44654,583517],"./kk-kz/chat-list.js":[233306,617091],"./kk-kz/coach-report.js":[262379,223454],"./kk-kz/comment-stream.js":[636151,115853],"./kk-kz/communities.js":[200030,816299],"./kk-kz/compose.js":[816436,910582],"./kk-kz/contacts.js":[183124,408631],"./kk-kz/datepicker.js":[565151,344729],"./kk-kz/desktop.js":[59995,367809],"./kk-kz/digital-signage.js":[423437,552154],"./kk-kz/discover-surface.js":[960823,874691],"./kk-kz/edu.js":[940059,397241],"./kk-kz/embed.js":[915523,437974],"./kk-kz/errors.js":[37591,761269],"./kk-kz/esp.js":[270787,339750],"./kk-kz/extensibility-ptz-extension.js":[443516,865270],"./kk-kz/extensibility-room-remote.js":[400505,701505],"./kk-kz/extensibility.js":[724784,395826],"./kk-kz/feedback.js":[422152,498034],"./kk-kz/files.js":[610795,510122],"./kk-kz/framework.js":[636806,265420],"./kk-kz/freemium-upgrade.js":[481041,844988],"./kk-kz/freemium.js":[888554,710496],"./kk-kz/funstuff.js":[862722,339501],"./kk-kz/gallery.js":[53175,196755],"./kk-kz/growth.js":[680611,187956],"./kk-kz/guardians.js":[853197,781787],"./kk-kz/health.js":[487258,782107],"./kk-kz/help.js":[414067,249319],"./kk-kz/hololens.js":[544318,971917],"./kk-kz/host-controls.js":[331897,422705],"./kk-kz/jana.js":[977176,84134],"./kk-kz/lightbox.js":[780100,308690],"./kk-kz/live-persona-card.js":[560367,516511],"./kk-kz/live-persona-editor.js":[118489,283976],"./kk-kz/lms-integration.js":[761742,788890],"./kk-kz/meet-for-work.js":[858274,490245],"./kk-kz/meeting-analytics.js":[405663,33524],"./kk-kz/meeting-apis-app.js":[512924,205629],"./kk-kz/meeting-bot.js":[344600,462109],"./kk-kz/meeting-collaboration.js":[340648,920748],"./kk-kz/meeting-flyout.js":[248562,705111],"./kk-kz/meeting-meet-app.js":[234028,240276],"./kk-kz/meeting-options.js":[71884,514689],"./kk-kz/meeting-recap.js":[589605,456751],"./kk-kz/meeting-room-console.js":[774387,913830],"./kk-kz/meeting-stream-app.js":[95531,424855],"./kk-kz/message-escalate-dialog.js":[356492,347778],"./kk-kz/messaging.js":[696721,923257],"./kk-kz/mtma-missed-notifications.js":[195755,794079],"./kk-kz/nova.js":[749651,350505],"./kk-kz/people-app.js":[274677,100251],"./kk-kz/people-picker.js":[479879,621819],"./kk-kz/people-targeting.js":[303664,706785],"./kk-kz/people.js":[10815,126838],"./kk-kz/person.js":[367454,438427],"./kk-kz/phonelink-sms.js":[914553,270649],"./kk-kz/pre-core.js":[119896,49343],"./kk-kz/premium-benefits.js":[471878,601687],"./kk-kz/presence.js":[253444,970237],"./kk-kz/queues.js":[413492,413110],"./kk-kz/recurrence.js":[703317,418252],"./kk-kz/rsc-application-permissions.js":[830803,807618],"./kk-kz/search.js":[96959,21085],"./kk-kz/semantic-object.js":[245439,641725],"./kk-kz/settings.js":[687300,209387],"./kk-kz/share-in-meetings.js":[804913,8890],"./kk-kz/share-to-teams-outlook-addin.js":[581227,598805],"./kk-kz/share-to-teams-third-party.js":[728312,826981],"./kk-kz/share-to-teams.js":[937697,791530],"./kk-kz/shortcut.js":[135068,415289],"./kk-kz/shortcuts.js":[745906,597475],"./kk-kz/simple-collab.js":[569028,645284],"./kk-kz/smart-device.js":[336246,591200],"./kk-kz/survey.js":[280171,993013],"./kk-kz/sv-flyout.js":[708345,24268],"./kk-kz/teams-and-channels.js":[700601,355573],"./kk-kz/teams-insider.js":[180866,155327],"./kk-kz/telemetry.js":[704241,640184],"./kk-kz/tfl-homepage.js":[934205,342426],"./kk-kz/tfl-onboarding.js":[302961,896173],"./kk-kz/toast-notifications.js":[9906,963378],"./kk-kz/unified-search.js":[254145,833923],"./kk-kz/unsupported-browser.js":[673480,563136],"./kk-kz/url-preview.js":[945944,277419],"./kk-kz/video-capture.js":[395765,202667],"./kk-kz/video-message.js":[570918,601349],"./kk-kz/virtual-events.js":[316610,487914],"./kk-kz/webinar.js":[430398,827403],"./kk-kz/welcome-bot.js":[558892,996430],"./kk-kz/whats-new.js":[820284,879166],"./kk-kz/wiki.js":[309238,836179],"./ko-kr/activity.js":[290002,712857],"./ko-kr/artifacts-platform.js":[472845,480976],"./ko-kr/audience-view-dialog.js":[837275,193305],"./ko-kr/auth.js":[209236,699357],"./ko-kr/autosuggest.js":[739303,325383],"./ko-kr/avatar.js":[142220,43991],"./ko-kr/biometric-enrollment.js":[172785,867824],"./ko-kr/breakout-rooms.js":[339255,354673],"./ko-kr/broadcast.js":[799877,529311],"./ko-kr/calendar.js":[918398,620461],"./ko-kr/calling.js":[613762,907908],"./ko-kr/campaign-notifications.js":[339028,198900],"./ko-kr/carousel-multi-card.js":[182765,203776],"./ko-kr/cast.js":[799895,37697],"./ko-kr/channels.js":[611674,567922],"./ko-kr/chat-list.js":[997333,626913],"./ko-kr/coach-report.js":[176738,637418],"./ko-kr/comment-stream.js":[975464,639696],"./ko-kr/communities.js":[40636,438529],"./ko-kr/compose.js":[533207,154085],"./ko-kr/contacts.js":[776464,527002],"./ko-kr/datepicker.js":[951748,230470],"./ko-kr/desktop.js":[847491,609636],"./ko-kr/digital-signage.js":[422319,157918],"./ko-kr/discover-surface.js":[371541,527466],"./ko-kr/edu.js":[546534,549343],"./ko-kr/embed.js":[220465,337244],"./ko-kr/errors.js":[227760,838373],"./ko-kr/esp.js":[473811,258715],"./ko-kr/extensibility-ptz-extension.js":[994917,122484],"./ko-kr/extensibility-room-remote.js":[374737,667615],"./ko-kr/extensibility.js":[893292,851453],"./ko-kr/feedback.js":[972639,420169],"./ko-kr/files.js":[829761,116083],"./ko-kr/framework.js":[539406,43886],"./ko-kr/freemium-upgrade.js":[964923,477536],"./ko-kr/freemium.js":[459466,5588],"./ko-kr/funstuff.js":[287325,842859],"./ko-kr/gallery.js":[673912,630041],"./ko-kr/growth.js":[428354,816113],"./ko-kr/guardians.js":[576846,297038],"./ko-kr/health.js":[987158,520715],"./ko-kr/help.js":[203390,137648],"./ko-kr/hololens.js":[863448,54825],"./ko-kr/host-controls.js":[902486,442122],"./ko-kr/jana.js":[643957,205927],"./ko-kr/lightbox.js":[129202,832506],"./ko-kr/live-persona-card.js":[38663,495045],"./ko-kr/live-persona-editor.js":[212964,237264],"./ko-kr/lms-integration.js":[247920,447863],"./ko-kr/meet-for-work.js":[448434,836815],"./ko-kr/meeting-analytics.js":[963234,414692],"./ko-kr/meeting-apis-app.js":[758835,821945],"./ko-kr/meeting-bot.js":[375691,324622],"./ko-kr/meeting-collaboration.js":[188827,271972],"./ko-kr/meeting-flyout.js":[45488,366971],"./ko-kr/meeting-meet-app.js":[939531,863868],"./ko-kr/meeting-options.js":[92316,226835],"./ko-kr/meeting-recap.js":[193383,56193],"./ko-kr/meeting-room-console.js":[9559,407071],"./ko-kr/meeting-stream-app.js":[977917,927218],"./ko-kr/message-escalate-dialog.js":[278019,911692],"./ko-kr/messaging.js":[688132,879579],"./ko-kr/mtma-missed-notifications.js":[66204,123578],"./ko-kr/nova.js":[16357,592366],"./ko-kr/people-app.js":[147021,708945],"./ko-kr/people-picker.js":[275250,444908],"./ko-kr/people-targeting.js":[390319,755732],"./ko-kr/people.js":[503887,408750],"./ko-kr/person.js":[895336,548380],"./ko-kr/phonelink-sms.js":[152843,725153],"./ko-kr/pre-core.js":[267073,49704],"./ko-kr/premium-benefits.js":[821854,115840],"./ko-kr/presence.js":[594781,568725],"./ko-kr/queues.js":[541947,475487],"./ko-kr/recurrence.js":[252254,141442],"./ko-kr/rsc-application-permissions.js":[827694,934026],"./ko-kr/search.js":[987897,479108],"./ko-kr/semantic-object.js":[538807,623440],"./ko-kr/settings.js":[547476,421014],"./ko-kr/share-in-meetings.js":[427857,541228],"./ko-kr/share-to-teams-outlook-addin.js":[409389,589434],"./ko-kr/share-to-teams-third-party.js":[621277,636318],"./ko-kr/share-to-teams.js":[419049,439665],"./ko-kr/shortcut.js":[343511,356871],"./ko-kr/shortcuts.js":[444765,504166],"./ko-kr/simple-collab.js":[138721,70112],"./ko-kr/smart-device.js":[448590,339441],"./ko-kr/survey.js":[340334,959775],"./ko-kr/sv-flyout.js":[104407,113468],"./ko-kr/teams-and-channels.js":[579635,594311],"./ko-kr/teams-insider.js":[253558,914202],"./ko-kr/telemetry.js":[329122,883891],"./ko-kr/tfl-homepage.js":[367033,772813],"./ko-kr/tfl-onboarding.js":[114433,103187],"./ko-kr/toast-notifications.js":[597969,57681],"./ko-kr/unified-search.js":[160176,902978],"./ko-kr/unsupported-browser.js":[296950,884183],"./ko-kr/url-preview.js":[806062,691270],"./ko-kr/video-capture.js":[6559,415768],"./ko-kr/video-message.js":[254545,897043],"./ko-kr/virtual-events.js":[902043,113787],"./ko-kr/webinar.js":[452066,995627],"./ko-kr/welcome-bot.js":[133472,636358],"./ko-kr/whats-new.js":[212236,868635],"./ko-kr/wiki.js":[94867,900945],"./lt-lt/activity.js":[828117,18555],"./lt-lt/artifacts-platform.js":[251259,569839],"./lt-lt/audience-view-dialog.js":[808633,704933],"./lt-lt/auth.js":[885397,818102],"./lt-lt/autosuggest.js":[863435,719080],"./lt-lt/avatar.js":[560712,243393],"./lt-lt/biometric-enrollment.js":[419061,290799],"./lt-lt/breakout-rooms.js":[508157,784801],"./lt-lt/broadcast.js":[382227,333515],"./lt-lt/calendar.js":[759586,552708],"./lt-lt/calling.js":[208768,665061],"./lt-lt/campaign-notifications.js":[596729,487948],"./lt-lt/carousel-multi-card.js":[169845,536061],"./lt-lt/cast.js":[894308,260438],"./lt-lt/channels.js":[323301,428763],"./lt-lt/chat-list.js":[144462,587588],"./lt-lt/coach-report.js":[22178,205341],"./lt-lt/comment-stream.js":[322893,735788],"./lt-lt/communities.js":[254554,517784],"./lt-lt/compose.js":[941041,946945],"./lt-lt/contacts.js":[491921,429655],"./lt-lt/datepicker.js":[726576,215734],"./lt-lt/desktop.js":[159341,174711],"./lt-lt/digital-signage.js":[608368,482887],"./lt-lt/discover-surface.js":[181540,702869],"./lt-lt/edu.js":[381101,881484],"./lt-lt/embed.js":[59817,553026],"./lt-lt/errors.js":[451749,951313],"./lt-lt/esp.js":[183465,551379],"./lt-lt/extensibility-ptz-extension.js":[878195,426132],"./lt-lt/extensibility-room-remote.js":[891306,460301],"./lt-lt/extensibility.js":[685734,669469],"./lt-lt/feedback.js":[699472,817791],"./lt-lt/files.js":[841429,690042],"./lt-lt/framework.js":[996939,964009],"./lt-lt/freemium-upgrade.js":[809587,758095],"./lt-lt/freemium.js":[48532,42900],"./lt-lt/funstuff.js":[30081,755720],"./lt-lt/gallery.js":[676475,840298],"./lt-lt/growth.js":[803185,480220],"./lt-lt/guardians.js":[533745,827404],"./lt-lt/health.js":[902350,448601],"./lt-lt/help.js":[236723,38184],"./lt-lt/hololens.js":[239435,75489],"./lt-lt/host-controls.js":[914248,155121],"./lt-lt/jana.js":[66590,581414],"./lt-lt/lightbox.js":[416221,433166],"./lt-lt/live-persona-card.js":[589988,838429],"./lt-lt/live-persona-editor.js":[498113,176247],"./lt-lt/lms-integration.js":[652854,714260],"./lt-lt/meet-for-work.js":[913639,248126],"./lt-lt/meeting-analytics.js":[750474,332701],"./lt-lt/meeting-apis-app.js":[505270,314925],"./lt-lt/meeting-bot.js":[558032,945941],"./lt-lt/meeting-collaboration.js":[879192,580871],"./lt-lt/meeting-flyout.js":[266175,78312],"./lt-lt/meeting-meet-app.js":[654062,937127],"./lt-lt/meeting-options.js":[85676,153022],"./lt-lt/meeting-recap.js":[930534,298758],"./lt-lt/meeting-room-console.js":[772153,850473],"./lt-lt/meeting-stream-app.js":[876874,870220],"./lt-lt/message-escalate-dialog.js":[570730,64020],"./lt-lt/messaging.js":[807707,159344],"./lt-lt/mtma-missed-notifications.js":[407721,964418],"./lt-lt/nova.js":[218133,401130],"./lt-lt/people-app.js":[35141,827400],"./lt-lt/people-picker.js":[135602,394622],"./lt-lt/people-targeting.js":[561677,837863],"./lt-lt/people.js":[888631,130480],"./lt-lt/person.js":[253849,485140],"./lt-lt/phonelink-sms.js":[317444,34679],"./lt-lt/pre-core.js":[345356,773974],"./lt-lt/premium-benefits.js":[490520,543191],"./lt-lt/presence.js":[432571,83948],"./lt-lt/queues.js":[708840,145413],"./lt-lt/recurrence.js":[18321,251367],"./lt-lt/rsc-application-permissions.js":[39563,568942],"./lt-lt/search.js":[631250,235129],"./lt-lt/semantic-object.js":[700448,479474],"./lt-lt/settings.js":[185138,127564],"./lt-lt/share-in-meetings.js":[423013,418219],"./lt-lt/share-to-teams-outlook-addin.js":[896351,990961],"./lt-lt/share-to-teams-third-party.js":[169427,776507],"./lt-lt/share-to-teams.js":[624078,794395],"./lt-lt/shortcut.js":[628153,868931],"./lt-lt/shortcuts.js":[354417,716633],"./lt-lt/simple-collab.js":[845563,698430],"./lt-lt/smart-device.js":[947571,468504],"./lt-lt/survey.js":[489045,892920],"./lt-lt/sv-flyout.js":[848575,303014],"./lt-lt/teams-and-channels.js":[747538,780487],"./lt-lt/teams-insider.js":[551721,192301],"./lt-lt/telemetry.js":[408594,778561],"./lt-lt/tfl-homepage.js":[555814,108021],"./lt-lt/tfl-onboarding.js":[93325,127818],"./lt-lt/toast-notifications.js":[371882,761033],"./lt-lt/unified-search.js":[381320,626889],"./lt-lt/unsupported-browser.js":[565675,532365],"./lt-lt/url-preview.js":[833398,744672],"./lt-lt/video-capture.js":[216140,856256],"./lt-lt/video-message.js":[434840,652828],"./lt-lt/virtual-events.js":[778658,637388],"./lt-lt/webinar.js":[914362,84743],"./lt-lt/welcome-bot.js":[968331,537295],"./lt-lt/whats-new.js":[656956,132279],"./lt-lt/wiki.js":[681530,983958],"./lv-lv/activity.js":[810778,355015],"./lv-lv/artifacts-platform.js":[406515,326594],"./lv-lv/audience-view-dialog.js":[980082,840813],"./lv-lv/auth.js":[155042,630672],"./lv-lv/autosuggest.js":[602273,194800],"./lv-lv/avatar.js":[890133,28091],"./lv-lv/biometric-enrollment.js":[995924,583651],"./lv-lv/breakout-rooms.js":[508130,933113],"./lv-lv/broadcast.js":[733048,612154],"./lv-lv/calendar.js":[28132,328580],"./lv-lv/calling.js":[93116,71247],"./lv-lv/campaign-notifications.js":[151235,67976],"./lv-lv/carousel-multi-card.js":[478169,112505],"./lv-lv/cast.js":[933752,396092],"./lv-lv/channels.js":[444587,43522],"./lv-lv/chat-list.js":[31725,951449],"./lv-lv/coach-report.js":[218590,866531],"./lv-lv/comment-stream.js":[365803,639455],"./lv-lv/communities.js":[445226,802378],"./lv-lv/compose.js":[842524,686049],"./lv-lv/contacts.js":[594108,146815],"./lv-lv/datepicker.js":[99505,900657],"./lv-lv/desktop.js":[936070,98169],"./lv-lv/digital-signage.js":[157253,299041],"./lv-lv/discover-surface.js":[398832,798182],"./lv-lv/edu.js":[692181,361123],"./lv-lv/embed.js":[74,164053],"./lv-lv/errors.js":[122524,871983],"./lv-lv/esp.js":[913396,129692],"./lv-lv/extensibility-ptz-extension.js":[783526,252483],"./lv-lv/extensibility-room-remote.js":[468739,965090],"./lv-lv/extensibility.js":[715985,172169],"./lv-lv/feedback.js":[377071,950103],"./lv-lv/files.js":[939108,849331],"./lv-lv/framework.js":[991326,193284],"./lv-lv/freemium-upgrade.js":[176352,898458],"./lv-lv/freemium.js":[101427,574214],"./lv-lv/funstuff.js":[669100,852233],"./lv-lv/gallery.js":[122904,249707],"./lv-lv/growth.js":[463905,379084],"./lv-lv/guardians.js":[573703,70074],"./lv-lv/health.js":[704045,336463],"./lv-lv/help.js":[635663,600574],"./lv-lv/hololens.js":[837548,525831],"./lv-lv/host-controls.js":[810269,916452],"./lv-lv/jana.js":[806900,561458],"./lv-lv/lightbox.js":[272099,253108],"./lv-lv/live-persona-card.js":[462857,884489],"./lv-lv/live-persona-editor.js":[60117,770498],"./lv-lv/lms-integration.js":[873605,748309],"./lv-lv/meet-for-work.js":[797649,885547],"./lv-lv/meeting-analytics.js":[664849,868706],"./lv-lv/meeting-apis-app.js":[129137,994621],"./lv-lv/meeting-bot.js":[2208,240863],"./lv-lv/meeting-collaboration.js":[499614,238524],"./lv-lv/meeting-flyout.js":[548682,811133],"./lv-lv/meeting-meet-app.js":[937090,450050],"./lv-lv/meeting-options.js":[688730,10599],"./lv-lv/meeting-recap.js":[375729,210651],"./lv-lv/meeting-room-console.js":[303599,131077],"./lv-lv/meeting-stream-app.js":[610770,471096],"./lv-lv/message-escalate-dialog.js":[828616,765101],"./lv-lv/messaging.js":[647054,96228],"./lv-lv/mtma-missed-notifications.js":[693302,433242],"./lv-lv/nova.js":[821981,81798],"./lv-lv/people-app.js":[834867,526657],"./lv-lv/people-picker.js":[622496,854008],"./lv-lv/people-targeting.js":[394882,279646],"./lv-lv/people.js":[620533,139313],"./lv-lv/person.js":[540410,846499],"./lv-lv/phonelink-sms.js":[373965,634517],"./lv-lv/pre-core.js":[182304,902132],"./lv-lv/premium-benefits.js":[54597,332275],"./lv-lv/presence.js":[911375,14283],"./lv-lv/queues.js":[798857,695957],"./lv-lv/recurrence.js":[841922,16758],"./lv-lv/rsc-application-permissions.js":[798176,215674],"./lv-lv/search.js":[69441,470359],"./lv-lv/semantic-object.js":[741570,312327],"./lv-lv/settings.js":[413551,77910],"./lv-lv/share-in-meetings.js":[392020,21993],"./lv-lv/share-to-teams-outlook-addin.js":[677135,822447],"./lv-lv/share-to-teams-third-party.js":[897766,550752],"./lv-lv/share-to-teams.js":[229842,645207],"./lv-lv/shortcut.js":[734538,889338],"./lv-lv/shortcuts.js":[345307,198662],"./lv-lv/simple-collab.js":[189522,99816],"./lv-lv/smart-device.js":[222813,979695],"./lv-lv/survey.js":[290285,413690],"./lv-lv/sv-flyout.js":[611120,398409],"./lv-lv/teams-and-channels.js":[951495,529992],"./lv-lv/teams-insider.js":[444901,718049],"./lv-lv/telemetry.js":[903190,938093],"./lv-lv/tfl-homepage.js":[774015,862885],"./lv-lv/tfl-onboarding.js":[447320,189206],"./lv-lv/toast-notifications.js":[695182,147938],"./lv-lv/unified-search.js":[213720,325814],"./lv-lv/unsupported-browser.js":[817890,190171],"./lv-lv/url-preview.js":[871092,930616],"./lv-lv/video-capture.js":[529535,9642],"./lv-lv/video-message.js":[701829,556964],"./lv-lv/virtual-events.js":[165149,988849],"./lv-lv/webinar.js":[622197,350038],"./lv-lv/welcome-bot.js":[264561,888983],"./lv-lv/whats-new.js":[64360,913390],"./lv-lv/wiki.js":[152701,498810],"./mk-mk/activity.js":[909191,893802],"./mk-mk/artifacts-platform.js":[494084,872565],"./mk-mk/audience-view-dialog.js":[220869,312939],"./mk-mk/auth.js":[389416,718262],"./mk-mk/autosuggest.js":[133534,403018],"./mk-mk/avatar.js":[317522,165903],"./mk-mk/biometric-enrollment.js":[329561,320271],"./mk-mk/breakout-rooms.js":[941650,185977],"./mk-mk/broadcast.js":[602441,945614],"./mk-mk/calendar.js":[437019,814453],"./mk-mk/calling.js":[720616,6578],"./mk-mk/campaign-notifications.js":[248648,855225],"./mk-mk/carousel-multi-card.js":[275905,404416],"./mk-mk/cast.js":[245263,734151],"./mk-mk/channels.js":[361645,829924],"./mk-mk/chat-list.js":[248254,677202],"./mk-mk/coach-report.js":[68753,905548],"./mk-mk/comment-stream.js":[75135,831046],"./mk-mk/communities.js":[155242,775860],"./mk-mk/compose.js":[637823,570619],"./mk-mk/contacts.js":[827809,974521],"./mk-mk/datepicker.js":[673538,842336],"./mk-mk/desktop.js":[345513,719180],"./mk-mk/digital-signage.js":[689720,793573],"./mk-mk/discover-surface.js":[36796,945935],"./mk-mk/edu.js":[180414,305129],"./mk-mk/embed.js":[361096,72713],"./mk-mk/errors.js":[560254,232421],"./mk-mk/esp.js":[127773,596201],"./mk-mk/extensibility-ptz-extension.js":[157175,517823],"./mk-mk/extensibility-room-remote.js":[8476,645722],"./mk-mk/extensibility.js":[21305,727055],"./mk-mk/feedback.js":[285960,803841],"./mk-mk/files.js":[108999,555045],"./mk-mk/framework.js":[463391,981480],"./mk-mk/freemium-upgrade.js":[887583,970293],"./mk-mk/freemium.js":[276719,816180],"./mk-mk/funstuff.js":[972483,96450],"./mk-mk/gallery.js":[635976,780924],"./mk-mk/growth.js":[224439,531714],"./mk-mk/guardians.js":[559779,699384],"./mk-mk/health.js":[429712,184079],"./mk-mk/help.js":[659354,709976],"./mk-mk/hololens.js":[723614,508230],"./mk-mk/host-controls.js":[15311,963095],"./mk-mk/jana.js":[692686,460927],"./mk-mk/lightbox.js":[280982,99311],"./mk-mk/live-persona-card.js":[889510,233051],"./mk-mk/live-persona-editor.js":[430161,302667],"./mk-mk/lms-integration.js":[215299,542443],"./mk-mk/meet-for-work.js":[724988,866287],"./mk-mk/meeting-analytics.js":[895901,356149],"./mk-mk/meeting-apis-app.js":[456039,563694],"./mk-mk/meeting-bot.js":[438856,704667],"./mk-mk/meeting-collaboration.js":[926230,323987],"./mk-mk/meeting-flyout.js":[800708,913651],"./mk-mk/meeting-meet-app.js":[691758,902471],"./mk-mk/meeting-options.js":[769873,768046],"./mk-mk/meeting-recap.js":[624722,280509],"./mk-mk/meeting-room-console.js":[692662,137302],"./mk-mk/meeting-stream-app.js":[761189,103117],"./mk-mk/message-escalate-dialog.js":[905584,605412],"./mk-mk/messaging.js":[742921,551947],"./mk-mk/mtma-missed-notifications.js":[920516,858687],"./mk-mk/nova.js":[604625,784105],"./mk-mk/people-app.js":[731352,606114],"./mk-mk/people-picker.js":[500598,997285],"./mk-mk/people-targeting.js":[170001,240790],"./mk-mk/people.js":[405451,257077],"./mk-mk/person.js":[293055,901636],"./mk-mk/phonelink-sms.js":[116953,879992],"./mk-mk/pre-core.js":[944257,579093],"./mk-mk/premium-benefits.js":[859378,704092],"./mk-mk/presence.js":[14184,789071],"./mk-mk/queues.js":[280934,215525],"./mk-mk/recurrence.js":[757355,676165],"./mk-mk/rsc-application-permissions.js":[520072,447085],"./mk-mk/search.js":[431751,648496],"./mk-mk/semantic-object.js":[264360,316711],"./mk-mk/settings.js":[513110,187657],"./mk-mk/share-in-meetings.js":[219927,847819],"./mk-mk/share-to-teams-outlook-addin.js":[2946,964083],"./mk-mk/share-to-teams-third-party.js":[159360,868200],"./mk-mk/share-to-teams.js":[298113,836276],"./mk-mk/shortcut.js":[912659,502111],"./mk-mk/shortcuts.js":[88887,955850],"./mk-mk/simple-collab.js":[850482,829602],"./mk-mk/smart-device.js":[605044,623135],"./mk-mk/survey.js":[705062,986753],"./mk-mk/sv-flyout.js":[111454,240411],"./mk-mk/teams-and-channels.js":[648120,532397],"./mk-mk/teams-insider.js":[393690,608468],"./mk-mk/telemetry.js":[427155,526996],"./mk-mk/tfl-homepage.js":[460690,34972],"./mk-mk/tfl-onboarding.js":[758879,499614],"./mk-mk/toast-notifications.js":[605459,627366],"./mk-mk/unified-search.js":[511422,68699],"./mk-mk/unsupported-browser.js":[221596,75987],"./mk-mk/url-preview.js":[77556,86985],"./mk-mk/video-capture.js":[801625,842659],"./mk-mk/video-message.js":[612707,392449],"./mk-mk/virtual-events.js":[805724,709785],"./mk-mk/webinar.js":[682103,54984],"./mk-mk/welcome-bot.js":[690526,336934],"./mk-mk/whats-new.js":[379758,941478],"./mk-mk/wiki.js":[642602,12615],"./nb-no/activity.js":[435653,463648],"./nb-no/artifacts-platform.js":[912093,551353],"./nb-no/audience-view-dialog.js":[975144,530629],"./nb-no/auth.js":[924385,932170],"./nb-no/autosuggest.js":[88420,456832],"./nb-no/avatar.js":[597638,349347],"./nb-no/biometric-enrollment.js":[757379,653314],"./nb-no/breakout-rooms.js":[946421,635791],"./nb-no/broadcast.js":[859035,394358],"./nb-no/calendar.js":[22512,55106],"./nb-no/calling.js":[789290,56962],"./nb-no/campaign-notifications.js":[8200,454242],"./nb-no/carousel-multi-card.js":[595365,255346],"./nb-no/cast.js":[57023,182392],"./nb-no/channels.js":[699907,70434],"./nb-no/chat-list.js":[157447,936650],"./nb-no/coach-report.js":[926014,712173],"./nb-no/comment-stream.js":[341041,755697],"./nb-no/communities.js":[645119,787581],"./nb-no/compose.js":[506129,761014],"./nb-no/contacts.js":[937622,361029],"./nb-no/datepicker.js":[271741,682202],"./nb-no/desktop.js":[461611,780563],"./nb-no/digital-signage.js":[499555,429864],"./nb-no/discover-surface.js":[239239,962613],"./nb-no/edu.js":[927034,121479],"./nb-no/embed.js":[614720,10961],"./nb-no/errors.js":[759531,231588],"./nb-no/esp.js":[565991,573292],"./nb-no/extensibility-ptz-extension.js":[594374,388009],"./nb-no/extensibility-room-remote.js":[777434,9318],"./nb-no/extensibility.js":[343131,616179],"./nb-no/feedback.js":[538539,312417],"./nb-no/files.js":[254800,403201],"./nb-no/framework.js":[466244,459476],"./nb-no/freemium-upgrade.js":[335207,549584],"./nb-no/freemium.js":[713824,527558],"./nb-no/funstuff.js":[389772,932159],"./nb-no/gallery.js":[550744,383738],"./nb-no/growth.js":[158986,871770],"./nb-no/guardians.js":[211555,850868],"./nb-no/health.js":[785629,896091],"./nb-no/help.js":[38294,466987],"./nb-no/hololens.js":[112147,236345],"./nb-no/host-controls.js":[947125,236840],"./nb-no/jana.js":[666613,109557],"./nb-no/lightbox.js":[676756,245974],"./nb-no/live-persona-card.js":[39571,345709],"./nb-no/live-persona-editor.js":[955620,280180],"./nb-no/lms-integration.js":[121028,624879],"./nb-no/meet-for-work.js":[451111,746774],"./nb-no/meeting-analytics.js":[757084,348658],"./nb-no/meeting-apis-app.js":[746318,384215],"./nb-no/meeting-bot.js":[124844,731830],"./nb-no/meeting-collaboration.js":[160405,368283],"./nb-no/meeting-flyout.js":[140228,999722],"./nb-no/meeting-meet-app.js":[206547,733899],"./nb-no/meeting-options.js":[950514,890634],"./nb-no/meeting-recap.js":[822755,422726],"./nb-no/meeting-room-console.js":[423661,932126],"./nb-no/meeting-stream-app.js":[528061,22194],"./nb-no/message-escalate-dialog.js":[220621,846552],"./nb-no/messaging.js":[762883,616415],"./nb-no/mtma-missed-notifications.js":[859489,683628],"./nb-no/nova.js":[660938,548736],"./nb-no/people-app.js":[616639,804534],"./nb-no/people-picker.js":[64498,189840],"./nb-no/people-targeting.js":[308676,298150],"./nb-no/people.js":[950932,169035],"./nb-no/person.js":[887542,672754],"./nb-no/phonelink-sms.js":[518350,739064],"./nb-no/pre-core.js":[940254,945193],"./nb-no/premium-benefits.js":[892795,950081],"./nb-no/presence.js":[431821,832611],"./nb-no/queues.js":[434571,445434],"./nb-no/recurrence.js":[993668,622490],"./nb-no/rsc-application-permissions.js":[732184,581322],"./nb-no/search.js":[91168,269928],"./nb-no/semantic-object.js":[625061,520351],"./nb-no/settings.js":[202856,531505],"./nb-no/share-in-meetings.js":[189129,400014],"./nb-no/share-to-teams-outlook-addin.js":[745689,362362],"./nb-no/share-to-teams-third-party.js":[430762,209807],"./nb-no/share-to-teams.js":[203257,346525],"./nb-no/shortcut.js":[664449,603418],"./nb-no/shortcuts.js":[367953,404542],"./nb-no/simple-collab.js":[46633,191950],"./nb-no/smart-device.js":[634241,376505],"./nb-no/survey.js":[742775,89254],"./nb-no/sv-flyout.js":[13086,417066],"./nb-no/teams-and-channels.js":[120451,140521],"./nb-no/teams-insider.js":[53395,134500],"./nb-no/telemetry.js":[319228,983258],"./nb-no/tfl-homepage.js":[759445,667978],"./nb-no/tfl-onboarding.js":[558212,561702],"./nb-no/toast-notifications.js":[894802,540444],"./nb-no/unified-search.js":[844892,305264],"./nb-no/unsupported-browser.js":[452863,613785],"./nb-no/url-preview.js":[73737,547092],"./nb-no/video-capture.js":[76751,585678],"./nb-no/video-message.js":[393337,948051],"./nb-no/virtual-events.js":[472281,682225],"./nb-no/webinar.js":[333161,792725],"./nb-no/welcome-bot.js":[18831,141267],"./nb-no/whats-new.js":[263126,919523],"./nb-no/wiki.js":[955308,480090],"./nl-nl/activity.js":[809043,942768],"./nl-nl/artifacts-platform.js":[301038,835223],"./nl-nl/audience-view-dialog.js":[909057,372397],"./nl-nl/auth.js":[135286,43883],"./nl-nl/autosuggest.js":[792757,494074],"./nl-nl/avatar.js":[84998,633868],"./nl-nl/biometric-enrollment.js":[912494,49780],"./nl-nl/breakout-rooms.js":[390829,774933],"./nl-nl/broadcast.js":[379404,170874],"./nl-nl/calendar.js":[505173,154821],"./nl-nl/calling.js":[624511,434029],"./nl-nl/campaign-notifications.js":[792090,923139],"./nl-nl/carousel-multi-card.js":[808171,381170],"./nl-nl/cast.js":[136668,731961],"./nl-nl/channels.js":[116294,726921],"./nl-nl/chat-list.js":[781037,922808],"./nl-nl/coach-report.js":[151299,59401],"./nl-nl/comment-stream.js":[393063,534566],"./nl-nl/communities.js":[191120,394483],"./nl-nl/compose.js":[588338,564670],"./nl-nl/contacts.js":[796181,653930],"./nl-nl/datepicker.js":[197339,596860],"./nl-nl/desktop.js":[760669,152442],"./nl-nl/digital-signage.js":[121915,525265],"./nl-nl/discover-surface.js":[308421,793180],"./nl-nl/edu.js":[426291,504210],"./nl-nl/embed.js":[319853,114390],"./nl-nl/errors.js":[844726,362660],"./nl-nl/esp.js":[781514,351085],"./nl-nl/extensibility-ptz-extension.js":[11684,336961],"./nl-nl/extensibility-room-remote.js":[350669,57055],"./nl-nl/extensibility.js":[270966,174377],"./nl-nl/feedback.js":[151046,694037],"./nl-nl/files.js":[891205,595239],"./nl-nl/framework.js":[957889,470083],"./nl-nl/freemium-upgrade.js":[293790,472589],"./nl-nl/freemium.js":[287149,217439],"./nl-nl/funstuff.js":[606518,135829],"./nl-nl/gallery.js":[267378,468840],"./nl-nl/growth.js":[236166,309235],"./nl-nl/guardians.js":[773846,335225],"./nl-nl/health.js":[189930,339888],"./nl-nl/help.js":[192900,722761],"./nl-nl/hololens.js":[842646,515045],"./nl-nl/host-controls.js":[175929,974211],"./nl-nl/jana.js":[382824,363127],"./nl-nl/lightbox.js":[517741,798397],"./nl-nl/live-persona-card.js":[599794,728881],"./nl-nl/live-persona-editor.js":[277063,803625],"./nl-nl/lms-integration.js":[887394,616760],"./nl-nl/meet-for-work.js":[370301,668416],"./nl-nl/meeting-analytics.js":[296833,454658],"./nl-nl/meeting-apis-app.js":[791343,448863],"./nl-nl/meeting-bot.js":[748965,638830],"./nl-nl/meeting-collaboration.js":[779728,831618],"./nl-nl/meeting-flyout.js":[369413,823511],"./nl-nl/meeting-meet-app.js":[900710,641781],"./nl-nl/meeting-options.js":[271238,650073],"./nl-nl/meeting-recap.js":[121922,913340],"./nl-nl/meeting-room-console.js":[318826,982425],"./nl-nl/meeting-stream-app.js":[201117,905407],"./nl-nl/message-escalate-dialog.js":[531489,229154],"./nl-nl/messaging.js":[695026,413446],"./nl-nl/mtma-missed-notifications.js":[594913,3021],"./nl-nl/nova.js":[406376,205745],"./nl-nl/people-app.js":[887187,407893],"./nl-nl/people-picker.js":[597558,497800],"./nl-nl/people-targeting.js":[382970,595655],"./nl-nl/people.js":[496304,510085],"./nl-nl/person.js":[340233,16993],"./nl-nl/phonelink-sms.js":[16604,361849],"./nl-nl/pre-core.js":[565360,631211],"./nl-nl/premium-benefits.js":[92819,648337],"./nl-nl/presence.js":[721453,178761],"./nl-nl/queues.js":[107322,712017],"./nl-nl/recurrence.js":[729195,175776],"./nl-nl/rsc-application-permissions.js":[691627,780174],"./nl-nl/search.js":[246018,571341],"./nl-nl/semantic-object.js":[258087,164066],"./nl-nl/settings.js":[890448,53598],"./nl-nl/share-in-meetings.js":[627184,879918],"./nl-nl/share-to-teams-outlook-addin.js":[541695,746155],"./nl-nl/share-to-teams-third-party.js":[52002,409866],"./nl-nl/share-to-teams.js":[31033,817037],"./nl-nl/shortcut.js":[703714,999481],"./nl-nl/shortcuts.js":[641280,131089],"./nl-nl/simple-collab.js":[857030,774924],"./nl-nl/smart-device.js":[120626,37608],"./nl-nl/survey.js":[997613,73509],"./nl-nl/sv-flyout.js":[449991,497439],"./nl-nl/teams-and-channels.js":[747540,681150],"./nl-nl/teams-insider.js":[822570,865618],"./nl-nl/telemetry.js":[890211,521709],"./nl-nl/tfl-homepage.js":[350194,915401],"./nl-nl/tfl-onboarding.js":[47647,832306],"./nl-nl/toast-notifications.js":[542942,133939],"./nl-nl/unified-search.js":[871460,38523],"./nl-nl/unsupported-browser.js":[370080,909283],"./nl-nl/url-preview.js":[667828,956232],"./nl-nl/video-capture.js":[356066,97206],"./nl-nl/video-message.js":[936528,783403],"./nl-nl/virtual-events.js":[300498,867647],"./nl-nl/webinar.js":[374272,944923],"./nl-nl/welcome-bot.js":[819203,23095],"./nl-nl/whats-new.js":[76880,147700],"./nl-nl/wiki.js":[809665,524506],"./nn-no/activity.js":[904742,798880],"./nn-no/artifacts-platform.js":[428297,283364],"./nn-no/audience-view-dialog.js":[213665,526202],"./nn-no/auth.js":[372211,470472],"./nn-no/autosuggest.js":[380266,525219],"./nn-no/avatar.js":[895426,665934],"./nn-no/biometric-enrollment.js":[811554,217195],"./nn-no/breakout-rooms.js":[921195,487151],"./nn-no/broadcast.js":[110069,614316],"./nn-no/calendar.js":[599780,983088],"./nn-no/calling.js":[56636,297276],"./nn-no/campaign-notifications.js":[712134,804674],"./nn-no/carousel-multi-card.js":[6478,341802],"./nn-no/cast.js":[216462,66830],"./nn-no/channels.js":[214962,751041],"./nn-no/chat-list.js":[898327,435062],"./nn-no/coach-report.js":[882739,961614],"./nn-no/comment-stream.js":[516640,600025],"./nn-no/communities.js":[158360,408781],"./nn-no/compose.js":[11995,315427],"./nn-no/contacts.js":[212335,624518],"./nn-no/datepicker.js":[64047,755519],"./nn-no/desktop.js":[311166,644746],"./nn-no/digital-signage.js":[921923,17939],"./nn-no/discover-surface.js":[969330,188079],"./nn-no/edu.js":[792650,534047],"./nn-no/embed.js":[359684,871818],"./nn-no/errors.js":[663008,617598],"./nn-no/esp.js":[64748,103474],"./nn-no/extensibility-ptz-extension.js":[263235,27631],"./nn-no/extensibility-room-remote.js":[671998,158670],"./nn-no/extensibility.js":[804227,385090],"./nn-no/feedback.js":[794491,768817],"./nn-no/files.js":[758782,383505],"./nn-no/framework.js":[24013,535737],"./nn-no/freemium-upgrade.js":[637563,958338],"./nn-no/freemium.js":[485510,485504],"./nn-no/funstuff.js":[321986,400604],"./nn-no/gallery.js":[24587,203386],"./nn-no/growth.js":[188330,508209],"./nn-no/guardians.js":[141296,794694],"./nn-no/health.js":[130812,311794],"./nn-no/help.js":[32712,733580],"./nn-no/hololens.js":[664119,878885],"./nn-no/host-controls.js":[388080,926851],"./nn-no/jana.js":[10474,607275],"./nn-no/lightbox.js":[18645,754294],"./nn-no/live-persona-card.js":[992348,801518],"./nn-no/live-persona-editor.js":[22066,636608],"./nn-no/lms-integration.js":[303545,732644],"./nn-no/meet-for-work.js":[147070,684214],"./nn-no/meeting-analytics.js":[330444,869939],"./nn-no/meeting-apis-app.js":[361934,138796],"./nn-no/meeting-bot.js":[216255,28955],"./nn-no/meeting-collaboration.js":[888735,427301],"./nn-no/meeting-flyout.js":[182268,875819],"./nn-no/meeting-meet-app.js":[678365,76552],"./nn-no/meeting-options.js":[503481,340437],"./nn-no/meeting-recap.js":[359381,595809],"./nn-no/meeting-room-console.js":[443166,423927],"./nn-no/meeting-stream-app.js":[249255,907058],"./nn-no/message-escalate-dialog.js":[695515,970640],"./nn-no/messaging.js":[439151,928641],"./nn-no/mtma-missed-notifications.js":[253861,969617],"./nn-no/nova.js":[624348,305303],"./nn-no/people-app.js":[875515,271812],"./nn-no/people-picker.js":[622566,17803],"./nn-no/people-targeting.js":[819662,349191],"./nn-no/people.js":[141900,487899],"./nn-no/person.js":[465504,417266],"./nn-no/phonelink-sms.js":[193526,674399],"./nn-no/pre-core.js":[413852,284100],"./nn-no/premium-benefits.js":[47503,301097],"./nn-no/presence.js":[113980,401848],"./nn-no/queues.js":[215070,631593],"./nn-no/recurrence.js":[42812,846497],"./nn-no/rsc-application-permissions.js":[946644,914704],"./nn-no/search.js":[812534,726373],"./nn-no/semantic-object.js":[251843,318049],"./nn-no/settings.js":[314273,601576],"./nn-no/share-in-meetings.js":[18016,332999],"./nn-no/share-to-teams-outlook-addin.js":[929346,185240],"./nn-no/share-to-teams-third-party.js":[328279,739113],"./nn-no/share-to-teams.js":[778777,285351],"./nn-no/shortcut.js":[173247,489568],"./nn-no/shortcuts.js":[614619,89189],"./nn-no/simple-collab.js":[146641,198532],"./nn-no/smart-device.js":[578667,900038],"./nn-no/survey.js":[638835,851135],"./nn-no/sv-flyout.js":[815598,346704],"./nn-no/teams-and-channels.js":[967152,790546],"./nn-no/teams-insider.js":[454670,63159],"./nn-no/telemetry.js":[72691,865906],"./nn-no/tfl-homepage.js":[646655,624796],"./nn-no/tfl-onboarding.js":[799216,870470],"./nn-no/toast-notifications.js":[862443,100401],"./nn-no/unified-search.js":[872692,367636],"./nn-no/unsupported-browser.js":[691969,592222],"./nn-no/url-preview.js":[242629,684932],"./nn-no/video-capture.js":[126574,304106],"./nn-no/video-message.js":[72223,301267],"./nn-no/virtual-events.js":[786282,700722],"./nn-no/webinar.js":[988642,652953],"./nn-no/welcome-bot.js":[984537,260630],"./nn-no/whats-new.js":[424543,976201],"./nn-no/wiki.js":[949678,742104],"./pl-pl/activity.js":[148487,644878],"./pl-pl/artifacts-platform.js":[9598,895194],"./pl-pl/audience-view-dialog.js":[818733,506971],"./pl-pl/auth.js":[813870,755649],"./pl-pl/autosuggest.js":[661808,529540],"./pl-pl/avatar.js":[15265,726324],"./pl-pl/biometric-enrollment.js":[920024,900140],"./pl-pl/breakout-rooms.js":[807319,181453],"./pl-pl/broadcast.js":[719136,341722],"./pl-pl/calendar.js":[807137,845437],"./pl-pl/calling.js":[68270,99630],"./pl-pl/campaign-notifications.js":[685875,265360],"./pl-pl/carousel-multi-card.js":[584063,409863],"./pl-pl/cast.js":[17348,964227],"./pl-pl/channels.js":[591371,109332],"./pl-pl/chat-list.js":[40991,833131],"./pl-pl/coach-report.js":[577219,677406],"./pl-pl/comment-stream.js":[666114,49339],"./pl-pl/communities.js":[500461,284678],"./pl-pl/compose.js":[135028,185873],"./pl-pl/contacts.js":[945282,808277],"./pl-pl/datepicker.js":[438941,347451],"./pl-pl/desktop.js":[347213,644626],"./pl-pl/digital-signage.js":[885379,238069],"./pl-pl/discover-surface.js":[539862,210461],"./pl-pl/edu.js":[298698,366591],"./pl-pl/embed.js":[694069,890445],"./pl-pl/errors.js":[637902,746300],"./pl-pl/esp.js":[76643,608927],"./pl-pl/extensibility-ptz-extension.js":[993416,673546],"./pl-pl/extensibility-room-remote.js":[3386,2272],"./pl-pl/extensibility.js":[548400,543791],"./pl-pl/feedback.js":[824970,425874],"./pl-pl/files.js":[365233,567997],"./pl-pl/framework.js":[160633,458179],"./pl-pl/freemium-upgrade.js":[157062,776502],"./pl-pl/freemium.js":[84120,523656],"./pl-pl/funstuff.js":[347447,975194],"./pl-pl/gallery.js":[195924,822956],"./pl-pl/growth.js":[291277,909709],"./pl-pl/guardians.js":[240128,410926],"./pl-pl/health.js":[202831,5797],"./pl-pl/help.js":[664221,630964],"./pl-pl/hololens.js":[114447,150802],"./pl-pl/host-controls.js":[35071,77111],"./pl-pl/jana.js":[707207,846325],"./pl-pl/lightbox.js":[595961,375434],"./pl-pl/live-persona-card.js":[978570,348040],"./pl-pl/live-persona-editor.js":[203634,996414],"./pl-pl/lms-integration.js":[528408,526332],"./pl-pl/meet-for-work.js":[901894,104679],"./pl-pl/meeting-analytics.js":[113523,60441],"./pl-pl/meeting-apis-app.js":[853805,531422],"./pl-pl/meeting-bot.js":[219244,787657],"./pl-pl/meeting-collaboration.js":[771549,554280],"./pl-pl/meeting-flyout.js":[708332,762722],"./pl-pl/meeting-meet-app.js":[310879,905920],"./pl-pl/meeting-options.js":[18731,19100],"./pl-pl/meeting-recap.js":[652853,418433],"./pl-pl/meeting-room-console.js":[349651,726909],"./pl-pl/meeting-stream-app.js":[340964,653406],"./pl-pl/message-escalate-dialog.js":[406335,213262],"./pl-pl/messaging.js":[802794,138738],"./pl-pl/mtma-missed-notifications.js":[599523,49776],"./pl-pl/nova.js":[20681,992870],"./pl-pl/people-app.js":[472839,773282],"./pl-pl/people-picker.js":[308929,667069],"./pl-pl/people-targeting.js":[299965,119815],"./pl-pl/people.js":[278926,489003],"./pl-pl/person.js":[581705,821567],"./pl-pl/phonelink-sms.js":[516797,333802],"./pl-pl/pre-core.js":[788972,76882],"./pl-pl/premium-benefits.js":[233233,467254],"./pl-pl/presence.js":[771447,109159],"./pl-pl/queues.js":[345646,971783],"./pl-pl/recurrence.js":[393577,32853],"./pl-pl/rsc-application-permissions.js":[582213,707084],"./pl-pl/search.js":[425579,69021],"./pl-pl/semantic-object.js":[435149,404198],"./pl-pl/settings.js":[233332,795341],"./pl-pl/share-in-meetings.js":[988861,226296],"./pl-pl/share-to-teams-outlook-addin.js":[884827,230897],"./pl-pl/share-to-teams-third-party.js":[88190,796387],"./pl-pl/share-to-teams.js":[213139,486600],"./pl-pl/shortcut.js":[285433,599025],"./pl-pl/shortcuts.js":[519112,168179],"./pl-pl/simple-collab.js":[759496,336354],"./pl-pl/smart-device.js":[410621,418012],"./pl-pl/survey.js":[639840,797003],"./pl-pl/sv-flyout.js":[872659,965082],"./pl-pl/teams-and-channels.js":[976834,111847],"./pl-pl/teams-insider.js":[12457,455080],"./pl-pl/telemetry.js":[195220,85810],"./pl-pl/tfl-homepage.js":[606085,52573],"./pl-pl/tfl-onboarding.js":[45097,860630],"./pl-pl/toast-notifications.js":[130837,547946],"./pl-pl/unified-search.js":[125967,720094],"./pl-pl/unsupported-browser.js":[262595,260371],"./pl-pl/url-preview.js":[231369,527386],"./pl-pl/video-capture.js":[666752,578990],"./pl-pl/video-message.js":[666998,16288],"./pl-pl/virtual-events.js":[143732,167105],"./pl-pl/webinar.js":[497858,560437],"./pl-pl/welcome-bot.js":[243800,332295],"./pl-pl/whats-new.js":[231524,642242],"./pl-pl/wiki.js":[367181,836005],"./pt-br/activity.js":[237939,775196],"./pt-br/artifacts-platform.js":[511555,61184],"./pt-br/audience-view-dialog.js":[967927,166229],"./pt-br/auth.js":[464680,471213],"./pt-br/autosuggest.js":[704102,282280],"./pt-br/avatar.js":[658613,511154],"./pt-br/biometric-enrollment.js":[570519,24018],"./pt-br/breakout-rooms.js":[457624,64487],"./pt-br/broadcast.js":[639510,544703],"./pt-br/calendar.js":[798999,863396],"./pt-br/calling.js":[548913,446684],"./pt-br/campaign-notifications.js":[809431,435859],"./pt-br/carousel-multi-card.js":[13944,499522],"./pt-br/cast.js":[917282,235865],"./pt-br/channels.js":[21182,235095],"./pt-br/chat-list.js":[653759,313279],"./pt-br/coach-report.js":[779225,862313],"./pt-br/comment-stream.js":[322134,636324],"./pt-br/communities.js":[941345,236636],"./pt-br/compose.js":[496313,714809],"./pt-br/contacts.js":[472804,393015],"./pt-br/datepicker.js":[4099,838311],"./pt-br/desktop.js":[820897,840333],"./pt-br/digital-signage.js":[591329,656777],"./pt-br/discover-surface.js":[457035,918266],"./pt-br/edu.js":[859541,119440],"./pt-br/embed.js":[517869,329294],"./pt-br/errors.js":[314573,572239],"./pt-br/esp.js":[850317,955985],"./pt-br/extensibility-ptz-extension.js":[301762,788316],"./pt-br/extensibility-room-remote.js":[820100,872826],"./pt-br/extensibility.js":[788446,944307],"./pt-br/feedback.js":[643786,767937],"./pt-br/files.js":[321724,786331],"./pt-br/framework.js":[539618,213345],"./pt-br/freemium-upgrade.js":[400759,196366],"./pt-br/freemium.js":[742802,497475],"./pt-br/funstuff.js":[312557,926711],"./pt-br/gallery.js":[108396,938996],"./pt-br/growth.js":[303507,388962],"./pt-br/guardians.js":[804950,180923],"./pt-br/health.js":[934699,80698],"./pt-br/help.js":[402748,60031],"./pt-br/hololens.js":[51957,580947],"./pt-br/host-controls.js":[522736,30373],"./pt-br/jana.js":[232362,140755],"./pt-br/lightbox.js":[942735,147484],"./pt-br/live-persona-card.js":[135158,519531],"./pt-br/live-persona-editor.js":[25972,186169],"./pt-br/lms-integration.js":[923937,47681],"./pt-br/meet-for-work.js":[53931,492894],"./pt-br/meeting-analytics.js":[222049,269586],"./pt-br/meeting-apis-app.js":[77828,832422],"./pt-br/meeting-bot.js":[769948,808744],"./pt-br/meeting-collaboration.js":[280563,259723],"./pt-br/meeting-flyout.js":[102962,318806],"./pt-br/meeting-meet-app.js":[740082,784138],"./pt-br/meeting-options.js":[195102,960928],"./pt-br/meeting-recap.js":[69702,970310],"./pt-br/meeting-room-console.js":[197840,350030],"./pt-br/meeting-stream-app.js":[484020,736822],"./pt-br/message-escalate-dialog.js":[596066,286813],"./pt-br/messaging.js":[848531,196282],"./pt-br/mtma-missed-notifications.js":[619653,984085],"./pt-br/nova.js":[554689,485211],"./pt-br/people-app.js":[102760,486418],"./pt-br/people-picker.js":[47823,678669],"./pt-br/people-targeting.js":[20714,54738],"./pt-br/people.js":[235049,95432],"./pt-br/person.js":[869224,442482],"./pt-br/phonelink-sms.js":[537823,737175],"./pt-br/pre-core.js":[776894,13795],"./pt-br/premium-benefits.js":[396502,849632],"./pt-br/presence.js":[243412,216764],"./pt-br/queues.js":[653439,178533],"./pt-br/recurrence.js":[801452,218288],"./pt-br/rsc-application-permissions.js":[863259,864566],"./pt-br/search.js":[299690,406868],"./pt-br/semantic-object.js":[658323,945005],"./pt-br/settings.js":[558634,509366],"./pt-br/share-in-meetings.js":[709515,841391],"./pt-br/share-to-teams-outlook-addin.js":[588086,949634],"./pt-br/share-to-teams-third-party.js":[835558,39938],"./pt-br/share-to-teams.js":[692514,248432],"./pt-br/shortcut.js":[794634,135357],"./pt-br/shortcuts.js":[740335,648292],"./pt-br/simple-collab.js":[459931,2941],"./pt-br/smart-device.js":[75743,952253],"./pt-br/survey.js":[800692,649330],"./pt-br/sv-flyout.js":[38778,673124],"./pt-br/teams-and-channels.js":[110995,800106],"./pt-br/teams-insider.js":[708726,395433],"./pt-br/telemetry.js":[880239,427923],"./pt-br/tfl-homepage.js":[160038,846378],"./pt-br/tfl-onboarding.js":[99371,644713],"./pt-br/toast-notifications.js":[17026,666949],"./pt-br/unified-search.js":[341837,308418],"./pt-br/unsupported-browser.js":[814468,445698],"./pt-br/url-preview.js":[183678,241609],"./pt-br/video-capture.js":[52013,120284],"./pt-br/video-message.js":[746346,13419],"./pt-br/virtual-events.js":[246722,886568],"./pt-br/webinar.js":[556296,79286],"./pt-br/welcome-bot.js":[85375,28643],"./pt-br/whats-new.js":[669971,205283],"./pt-br/wiki.js":[226422,171794],"./pt-pt/activity.js":[832975,316673],"./pt-pt/artifacts-platform.js":[345512,747715],"./pt-pt/audience-view-dialog.js":[146149,232064],"./pt-pt/auth.js":[74435,292978],"./pt-pt/autosuggest.js":[741886,913261],"./pt-pt/avatar.js":[98575,631240],"./pt-pt/biometric-enrollment.js":[89021,125565],"./pt-pt/breakout-rooms.js":[808300,466622],"./pt-pt/broadcast.js":[892508,208189],"./pt-pt/calendar.js":[412986,662283],"./pt-pt/calling.js":[846015,499607],"./pt-pt/campaign-notifications.js":[901757,830338],"./pt-pt/carousel-multi-card.js":[66366,161958],"./pt-pt/cast.js":[747009,519400],"./pt-pt/channels.js":[799753,545055],"./pt-pt/chat-list.js":[496413,11528],"./pt-pt/coach-report.js":[503262,914058],"./pt-pt/comment-stream.js":[436143,734054],"./pt-pt/communities.js":[382679,894744],"./pt-pt/compose.js":[999750,272976],"./pt-pt/contacts.js":[723809,802365],"./pt-pt/datepicker.js":[226297,699941],"./pt-pt/desktop.js":[499170,329589],"./pt-pt/digital-signage.js":[668936,696376],"./pt-pt/discover-surface.js":[103526,486340],"./pt-pt/edu.js":[674461,351752],"./pt-pt/embed.js":[987233,238020],"./pt-pt/errors.js":[754746,497626],"./pt-pt/esp.js":[661125,263409],"./pt-pt/extensibility-ptz-extension.js":[810232,462170],"./pt-pt/extensibility-room-remote.js":[700994,392937],"./pt-pt/extensibility.js":[634363,999919],"./pt-pt/feedback.js":[537068,65606],"./pt-pt/files.js":[3530,55328],"./pt-pt/framework.js":[831538,24348],"./pt-pt/freemium-upgrade.js":[909342,24285],"./pt-pt/freemium.js":[855181,787961],"./pt-pt/funstuff.js":[646615,107330],"./pt-pt/gallery.js":[933024,773622],"./pt-pt/growth.js":[132591,514603],"./pt-pt/guardians.js":[713065,588257],"./pt-pt/health.js":[592483,759442],"./pt-pt/help.js":[376837,724287],"./pt-pt/hololens.js":[34533,457155],"./pt-pt/host-controls.js":[644712,716712],"./pt-pt/jana.js":[775765,846650],"./pt-pt/lightbox.js":[783176,22935],"./pt-pt/live-persona-card.js":[932134,152542],"./pt-pt/live-persona-editor.js":[261111,871829],"./pt-pt/lms-integration.js":[513439,884803],"./pt-pt/meet-for-work.js":[382931,880848],"./pt-pt/meeting-analytics.js":[555926,848366],"./pt-pt/meeting-apis-app.js":[500986,857220],"./pt-pt/meeting-bot.js":[975496,219673],"./pt-pt/meeting-collaboration.js":[979112,52389],"./pt-pt/meeting-flyout.js":[400487,785175],"./pt-pt/meeting-meet-app.js":[894597,206718],"./pt-pt/meeting-options.js":[884274,444968],"./pt-pt/meeting-recap.js":[933838,531858],"./pt-pt/meeting-room-console.js":[466176,958948],"./pt-pt/meeting-stream-app.js":[960573,599619],"./pt-pt/message-escalate-dialog.js":[859721,138495],"./pt-pt/messaging.js":[380504,509113],"./pt-pt/mtma-missed-notifications.js":[309216,742261],"./pt-pt/nova.js":[411346,504295],"./pt-pt/people-app.js":[831313,329094],"./pt-pt/people-picker.js":[706549,902611],"./pt-pt/people-targeting.js":[675764,241196],"./pt-pt/people.js":[239681,807669],"./pt-pt/person.js":[144301,26183],"./pt-pt/phonelink-sms.js":[486212,253436],"./pt-pt/pre-core.js":[192687,450612],"./pt-pt/premium-benefits.js":[973569,746428],"./pt-pt/presence.js":[454250,72143],"./pt-pt/queues.js":[479689,510901],"./pt-pt/recurrence.js":[347869,597291],"./pt-pt/rsc-application-permissions.js":[52705,715469],"./pt-pt/search.js":[330729,566875],"./pt-pt/semantic-object.js":[730949,735309],"./pt-pt/settings.js":[131151,288891],"./pt-pt/share-in-meetings.js":[523538,613973],"./pt-pt/share-to-teams-outlook-addin.js":[555436,462591],"./pt-pt/share-to-teams-third-party.js":[10898,375610],"./pt-pt/share-to-teams.js":[7677,798510],"./pt-pt/shortcut.js":[202187,428631],"./pt-pt/shortcuts.js":[398960,951278],"./pt-pt/simple-collab.js":[111187,989309],"./pt-pt/smart-device.js":[298456,180332],"./pt-pt/survey.js":[513346,409884],"./pt-pt/sv-flyout.js":[123041,852378],"./pt-pt/teams-and-channels.js":[686933,450366],"./pt-pt/teams-insider.js":[908173,894777],"./pt-pt/telemetry.js":[383312,368037],"./pt-pt/tfl-homepage.js":[912072,127089],"./pt-pt/tfl-onboarding.js":[798872,197778],"./pt-pt/toast-notifications.js":[537134,786260],"./pt-pt/unified-search.js":[668658,770957],"./pt-pt/unsupported-browser.js":[715241,159425],"./pt-pt/url-preview.js":[828316,690784],"./pt-pt/video-capture.js":[99582,730041],"./pt-pt/video-message.js":[480059,499230],"./pt-pt/virtual-events.js":[103251,911478],"./pt-pt/webinar.js":[420379,132655],"./pt-pt/welcome-bot.js":[198391,415582],"./pt-pt/whats-new.js":[538578,332303],"./pt-pt/wiki.js":[288418,518790],"./ro-ro/activity.js":[750704,9473],"./ro-ro/artifacts-platform.js":[928382,478826],"./ro-ro/audience-view-dialog.js":[358715,674946],"./ro-ro/auth.js":[350032,236376],"./ro-ro/autosuggest.js":[301729,163568],"./ro-ro/avatar.js":[823678,804686],"./ro-ro/biometric-enrollment.js":[676284,736050],"./ro-ro/breakout-rooms.js":[684740,255428],"./ro-ro/broadcast.js":[265880,186706],"./ro-ro/calendar.js":[612622,652168],"./ro-ro/calling.js":[468587,714079],"./ro-ro/campaign-notifications.js":[43532,964084],"./ro-ro/carousel-multi-card.js":[510858,167790],"./ro-ro/cast.js":[263684,632626],"./ro-ro/channels.js":[228217,442284],"./ro-ro/chat-list.js":[731310,774443],"./ro-ro/coach-report.js":[175545,974974],"./ro-ro/comment-stream.js":[409444,847318],"./ro-ro/communities.js":[551914,589947],"./ro-ro/compose.js":[937636,666907],"./ro-ro/contacts.js":[533777,12564],"./ro-ro/datepicker.js":[521579,106279],"./ro-ro/desktop.js":[687345,116645],"./ro-ro/digital-signage.js":[852744,341305],"./ro-ro/discover-surface.js":[785635,298696],"./ro-ro/edu.js":[134068,603921],"./ro-ro/embed.js":[290499,385591],"./ro-ro/errors.js":[394293,35237],"./ro-ro/esp.js":[75637,647821],"./ro-ro/extensibility-ptz-extension.js":[5024,144588],"./ro-ro/extensibility-room-remote.js":[714576,636601],"./ro-ro/extensibility.js":[266561,695545],"./ro-ro/feedback.js":[246322,275948],"./ro-ro/files.js":[895747,812827],"./ro-ro/framework.js":[295766,496925],"./ro-ro/freemium-upgrade.js":[170329,920474],"./ro-ro/freemium.js":[811135,135453],"./ro-ro/funstuff.js":[75189,289817],"./ro-ro/gallery.js":[65073,597090],"./ro-ro/growth.js":[524477,621958],"./ro-ro/guardians.js":[210511,507448],"./ro-ro/health.js":[606446,698087],"./ro-ro/help.js":[318572,189344],"./ro-ro/hololens.js":[55806,477307],"./ro-ro/host-controls.js":[160424,347600],"./ro-ro/jana.js":[103668,154002],"./ro-ro/lightbox.js":[870197,376461],"./ro-ro/live-persona-card.js":[737564,826044],"./ro-ro/live-persona-editor.js":[331733,682653],"./ro-ro/lms-integration.js":[525108,807102],"./ro-ro/meet-for-work.js":[888130,927018],"./ro-ro/meeting-analytics.js":[548295,38038],"./ro-ro/meeting-apis-app.js":[525478,589154],"./ro-ro/meeting-bot.js":[618212,295590],"./ro-ro/meeting-collaboration.js":[34282,696208],"./ro-ro/meeting-flyout.js":[264371,197913],"./ro-ro/meeting-meet-app.js":[971064,855499],"./ro-ro/meeting-options.js":[959265,427788],"./ro-ro/meeting-recap.js":[849910,326427],"./ro-ro/meeting-room-console.js":[381233,653353],"./ro-ro/meeting-stream-app.js":[695057,813204],"./ro-ro/message-escalate-dialog.js":[987059,644009],"./ro-ro/messaging.js":[618390,703834],"./ro-ro/mtma-missed-notifications.js":[772385,572067],"./ro-ro/nova.js":[35397,890971],"./ro-ro/people-app.js":[187554,263732],"./ro-ro/people-picker.js":[312150,267296],"./ro-ro/people-targeting.js":[341708,952771],"./ro-ro/people.js":[263688,30735],"./ro-ro/person.js":[446886,742925],"./ro-ro/phonelink-sms.js":[172115,607948],"./ro-ro/pre-core.js":[679541,264710],"./ro-ro/premium-benefits.js":[407849,60650],"./ro-ro/presence.js":[18430,975472],"./ro-ro/queues.js":[718680,71645],"./ro-ro/recurrence.js":[739585,163221],"./ro-ro/rsc-application-permissions.js":[635511,981360],"./ro-ro/search.js":[478226,746520],"./ro-ro/semantic-object.js":[125769,281728],"./ro-ro/settings.js":[824188,423864],"./ro-ro/share-in-meetings.js":[318368,561877],"./ro-ro/share-to-teams-outlook-addin.js":[632931,888188],"./ro-ro/share-to-teams-third-party.js":[578326,646156],"./ro-ro/share-to-teams.js":[869947,44472],"./ro-ro/shortcut.js":[467164,83977],"./ro-ro/shortcuts.js":[462374,734764],"./ro-ro/simple-collab.js":[343583,126118],"./ro-ro/smart-device.js":[483121,339830],"./ro-ro/survey.js":[895972,285539],"./ro-ro/sv-flyout.js":[80843,54390],"./ro-ro/teams-and-channels.js":[930783,83155],"./ro-ro/teams-insider.js":[929755,592424],"./ro-ro/telemetry.js":[779960,809440],"./ro-ro/tfl-homepage.js":[882445,534853],"./ro-ro/tfl-onboarding.js":[131082,530597],"./ro-ro/toast-notifications.js":[6911,409094],"./ro-ro/unified-search.js":[207718,499534],"./ro-ro/unsupported-browser.js":[51153,76027],"./ro-ro/url-preview.js":[10134,212030],"./ro-ro/video-capture.js":[449780,608077],"./ro-ro/video-message.js":[36541,41266],"./ro-ro/virtual-events.js":[456713,267226],"./ro-ro/webinar.js":[390210,444963],"./ro-ro/welcome-bot.js":[908033,927433],"./ro-ro/whats-new.js":[659960,995936],"./ro-ro/wiki.js":[534279,636501],"./ru-ru/activity.js":[715498,948706],"./ru-ru/artifacts-platform.js":[372835,838377],"./ru-ru/audience-view-dialog.js":[701795,376222],"./ru-ru/auth.js":[122721,196303],"./ru-ru/autosuggest.js":[554041,963691],"./ru-ru/avatar.js":[405055,170238],"./ru-ru/biometric-enrollment.js":[228323,468846],"./ru-ru/breakout-rooms.js":[110455,187737],"./ru-ru/broadcast.js":[617766,341502],"./ru-ru/calendar.js":[683780,484188],"./ru-ru/calling.js":[933397,50129],"./ru-ru/campaign-notifications.js":[348271,76862],"./ru-ru/carousel-multi-card.js":[95620,32786],"./ru-ru/cast.js":[457770,637406],"./ru-ru/channels.js":[537241,366973],"./ru-ru/chat-list.js":[219352,995234],"./ru-ru/coach-report.js":[269508,592203],"./ru-ru/comment-stream.js":[42464,22332],"./ru-ru/communities.js":[23197,428126],"./ru-ru/compose.js":[205132,547175],"./ru-ru/contacts.js":[194426,897856],"./ru-ru/datepicker.js":[372548,250792],"./ru-ru/desktop.js":[930774,708189],"./ru-ru/digital-signage.js":[204966,481162],"./ru-ru/discover-surface.js":[841769,343945],"./ru-ru/edu.js":[100948,433040],"./ru-ru/embed.js":[933868,403222],"./ru-ru/errors.js":[73771,543200],"./ru-ru/esp.js":[773652,439691],"./ru-ru/extensibility-ptz-extension.js":[436276,548818],"./ru-ru/extensibility-room-remote.js":[885205,536585],"./ru-ru/extensibility.js":[217243,465385],"./ru-ru/feedback.js":[831545,167116],"./ru-ru/files.js":[1804,65940],"./ru-ru/framework.js":[11500,128109],"./ru-ru/freemium-upgrade.js":[633875,136529],"./ru-ru/freemium.js":[769262,432285],"./ru-ru/funstuff.js":[736101,170727],"./ru-ru/gallery.js":[101785,241852],"./ru-ru/growth.js":[40964,939394],"./ru-ru/guardians.js":[653887,206864],"./ru-ru/health.js":[60014,547091],"./ru-ru/help.js":[202759,152481],"./ru-ru/hololens.js":[859784,62921],"./ru-ru/host-controls.js":[819933,588637],"./ru-ru/jana.js":[96648,410425],"./ru-ru/lightbox.js":[9608,976008],"./ru-ru/live-persona-card.js":[941872,358035],"./ru-ru/live-persona-editor.js":[175891,137171],"./ru-ru/lms-integration.js":[475277,598330],"./ru-ru/meet-for-work.js":[610899,331625],"./ru-ru/meeting-analytics.js":[715725,215994],"./ru-ru/meeting-apis-app.js":[592347,717260],"./ru-ru/meeting-bot.js":[159123,927665],"./ru-ru/meeting-collaboration.js":[556468,678891],"./ru-ru/meeting-flyout.js":[14663,937890],"./ru-ru/meeting-meet-app.js":[513115,624149],"./ru-ru/meeting-options.js":[406126,334581],"./ru-ru/meeting-recap.js":[536066,320555],"./ru-ru/meeting-room-console.js":[746307,183819],"./ru-ru/meeting-stream-app.js":[884506,879923],"./ru-ru/message-escalate-dialog.js":[290331,265042],"./ru-ru/messaging.js":[100987,738088],"./ru-ru/mtma-missed-notifications.js":[683255,787349],"./ru-ru/nova.js":[675443,553613],"./ru-ru/people-app.js":[319716,886269],"./ru-ru/people-picker.js":[966786,871256],"./ru-ru/people-targeting.js":[995855,217609],"./ru-ru/people.js":[305130,713901],"./ru-ru/person.js":[821765,522594],"./ru-ru/phonelink-sms.js":[489954,400386],"./ru-ru/pre-core.js":[875122,344452],"./ru-ru/premium-benefits.js":[9793,573936],"./ru-ru/presence.js":[326249,154351],"./ru-ru/queues.js":[979364,535352],"./ru-ru/recurrence.js":[842750,708749],"./ru-ru/rsc-application-permissions.js":[564970,433555],"./ru-ru/search.js":[268345,570498],"./ru-ru/semantic-object.js":[212536,99834],"./ru-ru/settings.js":[794753,153385],"./ru-ru/share-in-meetings.js":[975384,73058],"./ru-ru/share-to-teams-outlook-addin.js":[997554,575810],"./ru-ru/share-to-teams-third-party.js":[537223,899067],"./ru-ru/share-to-teams.js":[790822,423752],"./ru-ru/shortcut.js":[520327,893806],"./ru-ru/shortcuts.js":[148319,401926],"./ru-ru/simple-collab.js":[592210,862550],"./ru-ru/smart-device.js":[603367,528939],"./ru-ru/survey.js":[335117,106328],"./ru-ru/sv-flyout.js":[883504,531254],"./ru-ru/teams-and-channels.js":[452713,376713],"./ru-ru/teams-insider.js":[518951,729614],"./ru-ru/telemetry.js":[971796,839990],"./ru-ru/tfl-homepage.js":[46478,195107],"./ru-ru/tfl-onboarding.js":[487054,670719],"./ru-ru/toast-notifications.js":[771366,913519],"./ru-ru/unified-search.js":[920647,829089],"./ru-ru/unsupported-browser.js":[397606,549746],"./ru-ru/url-preview.js":[146631,314457],"./ru-ru/video-capture.js":[318322,740366],"./ru-ru/video-message.js":[826779,110425],"./ru-ru/virtual-events.js":[780895,885119],"./ru-ru/webinar.js":[477637,321487],"./ru-ru/welcome-bot.js":[651552,315956],"./ru-ru/whats-new.js":[387086,922608],"./ru-ru/wiki.js":[253048,417332],"./sk-sk/activity.js":[844208,370696],"./sk-sk/artifacts-platform.js":[238274,668265],"./sk-sk/audience-view-dialog.js":[223159,271732],"./sk-sk/auth.js":[266059,95837],"./sk-sk/autosuggest.js":[237091,950860],"./sk-sk/avatar.js":[388928,407139],"./sk-sk/biometric-enrollment.js":[240670,633866],"./sk-sk/breakout-rooms.js":[195187,706663],"./sk-sk/broadcast.js":[689891,292406],"./sk-sk/calendar.js":[184297,954113],"./sk-sk/calling.js":[498735,276673],"./sk-sk/campaign-notifications.js":[449083,889008],"./sk-sk/carousel-multi-card.js":[532170,822114],"./sk-sk/cast.js":[148919,791690],"./sk-sk/channels.js":[429604,576306],"./sk-sk/chat-list.js":[823741,409312],"./sk-sk/coach-report.js":[977121,681146],"./sk-sk/comment-stream.js":[249576,920418],"./sk-sk/communities.js":[540640,590132],"./sk-sk/compose.js":[118387,461956],"./sk-sk/contacts.js":[714898,879947],"./sk-sk/datepicker.js":[126616,193939],"./sk-sk/desktop.js":[514352,140955],"./sk-sk/digital-signage.js":[195183,344114],"./sk-sk/discover-surface.js":[582241,714914],"./sk-sk/edu.js":[771430,617759],"./sk-sk/embed.js":[809622,479539],"./sk-sk/errors.js":[907092,721346],"./sk-sk/esp.js":[352007,174279],"./sk-sk/extensibility-ptz-extension.js":[626727,692030],"./sk-sk/extensibility-room-remote.js":[311186,844015],"./sk-sk/extensibility.js":[535243,900860],"./sk-sk/feedback.js":[523456,760081],"./sk-sk/files.js":[941573,814014],"./sk-sk/framework.js":[887181,165150],"./sk-sk/freemium-upgrade.js":[749033,46985],"./sk-sk/freemium.js":[339101,39865],"./sk-sk/funstuff.js":[772466,813642],"./sk-sk/gallery.js":[277257,967088],"./sk-sk/growth.js":[985443,683107],"./sk-sk/guardians.js":[980127,163084],"./sk-sk/health.js":[161785,905506],"./sk-sk/help.js":[793793,592496],"./sk-sk/hololens.js":[632475,458306],"./sk-sk/host-controls.js":[130354,397536],"./sk-sk/jana.js":[440412,661172],"./sk-sk/lightbox.js":[162779,991046],"./sk-sk/live-persona-card.js":[254117,807971],"./sk-sk/live-persona-editor.js":[332451,983510],"./sk-sk/lms-integration.js":[878535,371374],"./sk-sk/meet-for-work.js":[984151,536166],"./sk-sk/meeting-analytics.js":[860698,154206],"./sk-sk/meeting-apis-app.js":[362965,248549],"./sk-sk/meeting-bot.js":[958944,931090],"./sk-sk/meeting-collaboration.js":[81976,167955],"./sk-sk/meeting-flyout.js":[171654,983025],"./sk-sk/meeting-meet-app.js":[600662,606780],"./sk-sk/meeting-options.js":[370356,593058],"./sk-sk/meeting-recap.js":[636799,716111],"./sk-sk/meeting-room-console.js":[21813,790115],"./sk-sk/meeting-stream-app.js":[754717,199228],"./sk-sk/message-escalate-dialog.js":[259998,871887],"./sk-sk/messaging.js":[856016,557681],"./sk-sk/mtma-missed-notifications.js":[599079,28521],"./sk-sk/nova.js":[465174,199360],"./sk-sk/people-app.js":[113103,17363],"./sk-sk/people-picker.js":[71385,793742],"./sk-sk/people-targeting.js":[13684,507562],"./sk-sk/people.js":[810271,675676],"./sk-sk/person.js":[176794,857426],"./sk-sk/phonelink-sms.js":[238926,54705],"./sk-sk/pre-core.js":[40404,524088],"./sk-sk/premium-benefits.js":[440425,83109],"./sk-sk/presence.js":[417879,573668],"./sk-sk/queues.js":[935035,455097],"./sk-sk/recurrence.js":[183644,933324],"./sk-sk/rsc-application-permissions.js":[19718,23046],"./sk-sk/search.js":[416134,336826],"./sk-sk/semantic-object.js":[166645,155795],"./sk-sk/settings.js":[18207,797628],"./sk-sk/share-in-meetings.js":[748535,963003],"./sk-sk/share-to-teams-outlook-addin.js":[690521,675293],"./sk-sk/share-to-teams-third-party.js":[654438,696363],"./sk-sk/share-to-teams.js":[864323,307828],"./sk-sk/shortcut.js":[653453,340848],"./sk-sk/shortcuts.js":[42926,529092],"./sk-sk/simple-collab.js":[901861,257666],"./sk-sk/smart-device.js":[774139,400081],"./sk-sk/survey.js":[361437,813129],"./sk-sk/sv-flyout.js":[982585,624099],"./sk-sk/teams-and-channels.js":[607780,806382],"./sk-sk/teams-insider.js":[890813,240090],"./sk-sk/telemetry.js":[940105,853912],"./sk-sk/tfl-homepage.js":[467899,889379],"./sk-sk/tfl-onboarding.js":[552982,459461],"./sk-sk/toast-notifications.js":[941831,592294],"./sk-sk/unified-search.js":[724273,704980],"./sk-sk/unsupported-browser.js":[145171,457748],"./sk-sk/url-preview.js":[174514,556073],"./sk-sk/video-capture.js":[26776,19818],"./sk-sk/video-message.js":[901103,417062],"./sk-sk/virtual-events.js":[303476,553182],"./sk-sk/webinar.js":[20889,989719],"./sk-sk/welcome-bot.js":[517785,581588],"./sk-sk/whats-new.js":[685589,686692],"./sk-sk/wiki.js":[68176,177186],"./sl-si/activity.js":[639390,832141],"./sl-si/artifacts-platform.js":[972402,703007],"./sl-si/audience-view-dialog.js":[479881,128358],"./sl-si/auth.js":[438232,335251],"./sl-si/autosuggest.js":[552821,897988],"./sl-si/avatar.js":[146457,951652],"./sl-si/biometric-enrollment.js":[690237,697399],"./sl-si/breakout-rooms.js":[501549,119764],"./sl-si/broadcast.js":[86739,910345],"./sl-si/calendar.js":[605202,243069],"./sl-si/calling.js":[830794,791742],"./sl-si/campaign-notifications.js":[572668,805914],"./sl-si/carousel-multi-card.js":[807757,320174],"./sl-si/cast.js":[626547,319113],"./sl-si/channels.js":[865780,264796],"./sl-si/chat-list.js":[643083,150960],"./sl-si/coach-report.js":[910916,984935],"./sl-si/comment-stream.js":[695869,305406],"./sl-si/communities.js":[26398,31161],"./sl-si/compose.js":[75805,514631],"./sl-si/contacts.js":[543606,587577],"./sl-si/datepicker.js":[314853,679680],"./sl-si/desktop.js":[830331,510846],"./sl-si/digital-signage.js":[96253,105853],"./sl-si/discover-surface.js":[912781,886222],"./sl-si/edu.js":[736319,344742],"./sl-si/embed.js":[481126,886028],"./sl-si/errors.js":[707293,791794],"./sl-si/esp.js":[327044,165009],"./sl-si/extensibility-ptz-extension.js":[382959,383464],"./sl-si/extensibility-room-remote.js":[687220,749959],"./sl-si/extensibility.js":[721004,156852],"./sl-si/feedback.js":[798045,942535],"./sl-si/files.js":[413794,741014],"./sl-si/framework.js":[419960,12133],"./sl-si/freemium-upgrade.js":[708419,90384],"./sl-si/freemium.js":[519198,381631],"./sl-si/funstuff.js":[263616,323233],"./sl-si/gallery.js":[256615,711561],"./sl-si/growth.js":[179319,779041],"./sl-si/guardians.js":[833798,88811],"./sl-si/health.js":[375659,382958],"./sl-si/help.js":[597192,582897],"./sl-si/hololens.js":[936776,859185],"./sl-si/host-controls.js":[441278,770411],"./sl-si/jana.js":[465197,267553],"./sl-si/lightbox.js":[657826,947356],"./sl-si/live-persona-card.js":[481028,536251],"./sl-si/live-persona-editor.js":[450428,618225],"./sl-si/lms-integration.js":[978710,890876],"./sl-si/meet-for-work.js":[975378,35974],"./sl-si/meeting-analytics.js":[898889,415785],"./sl-si/meeting-apis-app.js":[40074,482161],"./sl-si/meeting-bot.js":[414296,17244],"./sl-si/meeting-collaboration.js":[444508,140536],"./sl-si/meeting-flyout.js":[648439,366411],"./sl-si/meeting-meet-app.js":[15578,180657],"./sl-si/meeting-options.js":[771467,108732],"./sl-si/meeting-recap.js":[769314,394425],"./sl-si/meeting-room-console.js":[585445,493429],"./sl-si/meeting-stream-app.js":[944990,880511],"./sl-si/message-escalate-dialog.js":[195581,411828],"./sl-si/messaging.js":[20294,305142],"./sl-si/mtma-missed-notifications.js":[121764,482544],"./sl-si/nova.js":[830605,334731],"./sl-si/people-app.js":[857565,40674],"./sl-si/people-picker.js":[408059,628474],"./sl-si/people-targeting.js":[628879,837108],"./sl-si/people.js":[649637,871522],"./sl-si/person.js":[788156,455339],"./sl-si/phonelink-sms.js":[413879,435175],"./sl-si/pre-core.js":[339620,690265],"./sl-si/premium-benefits.js":[207396,174455],"./sl-si/presence.js":[263584,209849],"./sl-si/queues.js":[951963,835922],"./sl-si/recurrence.js":[659552,378872],"./sl-si/rsc-application-permissions.js":[656399,803959],"./sl-si/search.js":[789091,802907],"./sl-si/semantic-object.js":[956373,771733],"./sl-si/settings.js":[875500,613796],"./sl-si/share-in-meetings.js":[853211,748575],"./sl-si/share-to-teams-outlook-addin.js":[125956,489147],"./sl-si/share-to-teams-third-party.js":[621938,304523],"./sl-si/share-to-teams.js":[568974,528081],"./sl-si/shortcut.js":[608140,88599],"./sl-si/shortcuts.js":[437178,913462],"./sl-si/simple-collab.js":[924552,976917],"./sl-si/smart-device.js":[231619,232019],"./sl-si/survey.js":[671737,889026],"./sl-si/sv-flyout.js":[967791,372697],"./sl-si/teams-and-channels.js":[330058,264509],"./sl-si/teams-insider.js":[901842,663580],"./sl-si/telemetry.js":[688856,111064],"./sl-si/tfl-homepage.js":[351520,965794],"./sl-si/tfl-onboarding.js":[74574,734244],"./sl-si/toast-notifications.js":[891485,919949],"./sl-si/unified-search.js":[724527,316146],"./sl-si/unsupported-browser.js":[151784,140846],"./sl-si/url-preview.js":[521807,755406],"./sl-si/video-capture.js":[100617,808712],"./sl-si/video-message.js":[43131,963772],"./sl-si/virtual-events.js":[393721,108401],"./sl-si/webinar.js":[104843,70767],"./sl-si/welcome-bot.js":[695232,142980],"./sl-si/whats-new.js":[586932,525271],"./sl-si/wiki.js":[693384,115381],"./sq-al/activity.js":[218050,491500],"./sq-al/artifacts-platform.js":[64652,563123],"./sq-al/audience-view-dialog.js":[533182,180717],"./sq-al/auth.js":[251715,276958],"./sq-al/autosuggest.js":[496449,884741],"./sq-al/avatar.js":[849476,162374],"./sq-al/biometric-enrollment.js":[401762,272871],"./sq-al/breakout-rooms.js":[683985,590842],"./sq-al/broadcast.js":[598979,28875],"./sq-al/calendar.js":[408264,141147],"./sq-al/calling.js":[118658,42215],"./sq-al/campaign-notifications.js":[622966,55471],"./sq-al/carousel-multi-card.js":[758562,11003],"./sq-al/cast.js":[279616,956858],"./sq-al/channels.js":[889190,437829],"./sq-al/chat-list.js":[456280,92996],"./sq-al/coach-report.js":[608883,590442],"./sq-al/comment-stream.js":[928338,134005],"./sq-al/communities.js":[308724,559349],"./sq-al/compose.js":[342515,356383],"./sq-al/contacts.js":[253875,816986],"./sq-al/datepicker.js":[705296,411338],"./sq-al/desktop.js":[748882,404517],"./sq-al/digital-signage.js":[675236,768731],"./sq-al/discover-surface.js":[565812,744957],"./sq-al/edu.js":[723498,763661],"./sq-al/embed.js":[442128,518371],"./sq-al/errors.js":[896153,792523],"./sq-al/esp.js":[155304,545212],"./sq-al/extensibility-ptz-extension.js":[977512,239578],"./sq-al/extensibility-room-remote.js":[629903,646900],"./sq-al/extensibility.js":[313457,805842],"./sq-al/feedback.js":[468720,280412],"./sq-al/files.js":[466125,611880],"./sq-al/framework.js":[616396,825477],"./sq-al/freemium-upgrade.js":[827673,768556],"./sq-al/freemium.js":[512727,636878],"./sq-al/funstuff.js":[99063,385686],"./sq-al/gallery.js":[120439,797638],"./sq-al/growth.js":[706090,184895],"./sq-al/guardians.js":[599568,704087],"./sq-al/health.js":[643554,171636],"./sq-al/help.js":[981087,788002],"./sq-al/hololens.js":[976293,663763],"./sq-al/host-controls.js":[67625,8277],"./sq-al/jana.js":[948428,378958],"./sq-al/lightbox.js":[390301,782685],"./sq-al/live-persona-card.js":[599445,26352],"./sq-al/live-persona-editor.js":[458499,322216],"./sq-al/lms-integration.js":[874636,928339],"./sq-al/meet-for-work.js":[317890,254185],"./sq-al/meeting-analytics.js":[274438,169819],"./sq-al/meeting-apis-app.js":[412771,271650],"./sq-al/meeting-bot.js":[29820,897118],"./sq-al/meeting-collaboration.js":[159466,881744],"./sq-al/meeting-flyout.js":[850998,380690],"./sq-al/meeting-meet-app.js":[828231,465904],"./sq-al/meeting-options.js":[965149,341267],"./sq-al/meeting-recap.js":[754916,656765],"./sq-al/meeting-room-console.js":[578344,339902],"./sq-al/meeting-stream-app.js":[617933,145324],"./sq-al/message-escalate-dialog.js":[100205,769490],"./sq-al/messaging.js":[486002,871502],"./sq-al/mtma-missed-notifications.js":[556078,521943],"./sq-al/nova.js":[309675,454726],"./sq-al/people-app.js":[291727,688222],"./sq-al/people-picker.js":[102044,50945],"./sq-al/people-targeting.js":[545943,974167],"./sq-al/people.js":[492338,65016],"./sq-al/person.js":[612353,569797],"./sq-al/phonelink-sms.js":[302424,686855],"./sq-al/pre-core.js":[870706,576708],"./sq-al/premium-benefits.js":[782605,671994],"./sq-al/presence.js":[873418,490530],"./sq-al/queues.js":[18060,173817],"./sq-al/recurrence.js":[356012,77099],"./sq-al/rsc-application-permissions.js":[519054,974818],"./sq-al/search.js":[464060,708660],"./sq-al/semantic-object.js":[585307,32583],"./sq-al/settings.js":[241518,634930],"./sq-al/share-in-meetings.js":[98386,345988],"./sq-al/share-to-teams-outlook-addin.js":[22904,603874],"./sq-al/share-to-teams-third-party.js":[293206,190434],"./sq-al/share-to-teams.js":[845858,333785],"./sq-al/shortcut.js":[182276,457744],"./sq-al/shortcuts.js":[147271,107222],"./sq-al/simple-collab.js":[776312,695659],"./sq-al/smart-device.js":[412110,155945],"./sq-al/survey.js":[387196,540694],"./sq-al/sv-flyout.js":[594012,172001],"./sq-al/teams-and-channels.js":[389095,555662],"./sq-al/teams-insider.js":[806643,937529],"./sq-al/telemetry.js":[481847,646936],"./sq-al/tfl-homepage.js":[548822,993870],"./sq-al/tfl-onboarding.js":[224763,576971],"./sq-al/toast-notifications.js":[276940,779456],"./sq-al/unified-search.js":[556793,471344],"./sq-al/unsupported-browser.js":[235013,25778],"./sq-al/url-preview.js":[781233,850145],"./sq-al/video-capture.js":[520395,441920],"./sq-al/video-message.js":[697841,651995],"./sq-al/virtual-events.js":[107021,151772],"./sq-al/webinar.js":[140773,995319],"./sq-al/welcome-bot.js":[819976,422474],"./sq-al/whats-new.js":[720163,7065],"./sq-al/wiki.js":[511218,484754],"./sr-latn-rs/activity.js":[437497,55041],"./sr-latn-rs/artifacts-platform.js":[795396,391945],"./sr-latn-rs/audience-view-dialog.js":[400539,353749],"./sr-latn-rs/auth.js":[644457,466786],"./sr-latn-rs/autosuggest.js":[754128,686626],"./sr-latn-rs/avatar.js":[201424,841525],"./sr-latn-rs/biometric-enrollment.js":[117127,165558],"./sr-latn-rs/breakout-rooms.js":[11543,717722],"./sr-latn-rs/broadcast.js":[952543,979068],"./sr-latn-rs/calendar.js":[788352,166288],"./sr-latn-rs/calling.js":[146906,1371],"./sr-latn-rs/campaign-notifications.js":[881436,259010],"./sr-latn-rs/carousel-multi-card.js":[837833,159611],"./sr-latn-rs/cast.js":[671298,512248],"./sr-latn-rs/channels.js":[924575,356862],"./sr-latn-rs/chat-list.js":[149520,598410],"./sr-latn-rs/coach-report.js":[580144,904872],"./sr-latn-rs/comment-stream.js":[184538,610234],"./sr-latn-rs/communities.js":[418761,467957],"./sr-latn-rs/compose.js":[4031,129638],"./sr-latn-rs/contacts.js":[144896,912212],"./sr-latn-rs/datepicker.js":[511378,582862],"./sr-latn-rs/desktop.js":[791613,437490],"./sr-latn-rs/digital-signage.js":[954843,260067],"./sr-latn-rs/discover-surface.js":[728683,801258],"./sr-latn-rs/edu.js":[221638,153797],"./sr-latn-rs/embed.js":[473288,484396],"./sr-latn-rs/errors.js":[455591,494409],"./sr-latn-rs/esp.js":[287289,485292],"./sr-latn-rs/extensibility-ptz-extension.js":[124571,842573],"./sr-latn-rs/extensibility-room-remote.js":[397759,575107],"./sr-latn-rs/extensibility.js":[411333,783969],"./sr-latn-rs/feedback.js":[761251,310612],"./sr-latn-rs/files.js":[699049,27394],"./sr-latn-rs/framework.js":[572242,616738],"./sr-latn-rs/freemium-upgrade.js":[327291,509834],"./sr-latn-rs/freemium.js":[657260,697113],"./sr-latn-rs/funstuff.js":[711784,520665],"./sr-latn-rs/gallery.js":[913797,216244],"./sr-latn-rs/growth.js":[251723,56125],"./sr-latn-rs/guardians.js":[935629,62545],"./sr-latn-rs/health.js":[43670,68072],"./sr-latn-rs/help.js":[184585,594527],"./sr-latn-rs/hololens.js":[979632,536544],"./sr-latn-rs/host-controls.js":[752738,770216],"./sr-latn-rs/jana.js":[529453,413602],"./sr-latn-rs/lightbox.js":[351808,779814],"./sr-latn-rs/live-persona-card.js":[374260,633145],"./sr-latn-rs/live-persona-editor.js":[915976,598885],"./sr-latn-rs/lms-integration.js":[405828,43105],"./sr-latn-rs/meet-for-work.js":[393839,337884],"./sr-latn-rs/meeting-analytics.js":[424236,56716],"./sr-latn-rs/meeting-apis-app.js":[532620,481135],"./sr-latn-rs/meeting-bot.js":[601025,905327],"./sr-latn-rs/meeting-collaboration.js":[622806,815155],"./sr-latn-rs/meeting-flyout.js":[584422,728709],"./sr-latn-rs/meeting-meet-app.js":[536870,649941],"./sr-latn-rs/meeting-options.js":[996501,291343],"./sr-latn-rs/meeting-recap.js":[446224,528342],"./sr-latn-rs/meeting-room-console.js":[164242,570357],"./sr-latn-rs/meeting-stream-app.js":[968421,19310],"./sr-latn-rs/message-escalate-dialog.js":[809274,678341],"./sr-latn-rs/messaging.js":[422600,183512],"./sr-latn-rs/mtma-missed-notifications.js":[884608,69476],"./sr-latn-rs/nova.js":[186975,615505],"./sr-latn-rs/people-app.js":[948277,624754],"./sr-latn-rs/people-picker.js":[613438,725579],"./sr-latn-rs/people-targeting.js":[371646,200326],"./sr-latn-rs/people.js":[40480,977578],"./sr-latn-rs/person.js":[416291,2875],"./sr-latn-rs/phonelink-sms.js":[370897,367961],"./sr-latn-rs/pre-core.js":[350491,884718],"./sr-latn-rs/premium-benefits.js":[536681,782767],"./sr-latn-rs/presence.js":[132428,915771],"./sr-latn-rs/queues.js":[262921,313459],"./sr-latn-rs/recurrence.js":[557309,890134],"./sr-latn-rs/rsc-application-permissions.js":[119855,152407],"./sr-latn-rs/search.js":[72226,426712],"./sr-latn-rs/semantic-object.js":[944166,188644],"./sr-latn-rs/settings.js":[360984,815985],"./sr-latn-rs/share-in-meetings.js":[59213,263067],"./sr-latn-rs/share-to-teams-outlook-addin.js":[339323,989297],"./sr-latn-rs/share-to-teams-third-party.js":[405215,722086],"./sr-latn-rs/share-to-teams.js":[47943,129551],"./sr-latn-rs/shortcut.js":[714376,638829],"./sr-latn-rs/shortcuts.js":[840466,462365],"./sr-latn-rs/simple-collab.js":[762385,97497],"./sr-latn-rs/smart-device.js":[262128,939181],"./sr-latn-rs/survey.js":[194514,469374],"./sr-latn-rs/sv-flyout.js":[47212,970509],"./sr-latn-rs/teams-and-channels.js":[986777,546821],"./sr-latn-rs/teams-insider.js":[776710,584405],"./sr-latn-rs/telemetry.js":[144057,658511],"./sr-latn-rs/tfl-homepage.js":[696796,613963],"./sr-latn-rs/tfl-onboarding.js":[458243,93843],"./sr-latn-rs/toast-notifications.js":[787597,122471],"./sr-latn-rs/unified-search.js":[529999,157907],"./sr-latn-rs/unsupported-browser.js":[434759,970563],"./sr-latn-rs/url-preview.js":[133875,512033],"./sr-latn-rs/video-capture.js":[122080,288478],"./sr-latn-rs/video-message.js":[600323,313417],"./sr-latn-rs/virtual-events.js":[206528,249424],"./sr-latn-rs/webinar.js":[445407,839254],"./sr-latn-rs/welcome-bot.js":[834371,530677],"./sr-latn-rs/whats-new.js":[927927,947603],"./sr-latn-rs/wiki.js":[126508,937411],"./sv-se/activity.js":[677710,155903],"./sv-se/artifacts-platform.js":[366996,226099],"./sv-se/audience-view-dialog.js":[377497,496872],"./sv-se/auth.js":[841941,291916],"./sv-se/autosuggest.js":[249954,719678],"./sv-se/avatar.js":[814878,623822],"./sv-se/biometric-enrollment.js":[875637,515781],"./sv-se/breakout-rooms.js":[573026,822245],"./sv-se/broadcast.js":[11405,963572],"./sv-se/calendar.js":[2633,414790],"./sv-se/calling.js":[505313,102499],"./sv-se/campaign-notifications.js":[203197,857824],"./sv-se/carousel-multi-card.js":[660966,545931],"./sv-se/cast.js":[337010,760262],"./sv-se/channels.js":[626452,704498],"./sv-se/chat-list.js":[183940,536336],"./sv-se/coach-report.js":[907997,261809],"./sv-se/comment-stream.js":[656379,768229],"./sv-se/communities.js":[461058,71824],"./sv-se/compose.js":[5208,704922],"./sv-se/contacts.js":[403981,869534],"./sv-se/datepicker.js":[921850,744963],"./sv-se/desktop.js":[23355,12012],"./sv-se/digital-signage.js":[241106,137827],"./sv-se/discover-surface.js":[713095,315614],"./sv-se/edu.js":[950259,265735],"./sv-se/embed.js":[348617,928422],"./sv-se/errors.js":[303117,620477],"./sv-se/esp.js":[331998,609962],"./sv-se/extensibility-ptz-extension.js":[28739,51660],"./sv-se/extensibility-room-remote.js":[987533,514880],"./sv-se/extensibility.js":[714268,279403],"./sv-se/feedback.js":[712029,14657],"./sv-se/files.js":[866139,308104],"./sv-se/framework.js":[120102,995550],"./sv-se/freemium-upgrade.js":[266970,12947],"./sv-se/freemium.js":[32174,918419],"./sv-se/funstuff.js":[256247,863389],"./sv-se/gallery.js":[939060,158143],"./sv-se/growth.js":[491114,176935],"./sv-se/guardians.js":[69834,297071],"./sv-se/health.js":[590214,659045],"./sv-se/help.js":[112893,895289],"./sv-se/hololens.js":[181258,573790],"./sv-se/host-controls.js":[468432,18637],"./sv-se/jana.js":[703661,626102],"./sv-se/lightbox.js":[836210,928662],"./sv-se/live-persona-card.js":[606610,303241],"./sv-se/live-persona-editor.js":[507748,672007],"./sv-se/lms-integration.js":[11178,728658],"./sv-se/meet-for-work.js":[780844,558632],"./sv-se/meeting-analytics.js":[634955,102087],"./sv-se/meeting-apis-app.js":[68989,411743],"./sv-se/meeting-bot.js":[639153,535334],"./sv-se/meeting-collaboration.js":[919772,660243],"./sv-se/meeting-flyout.js":[619604,894381],"./sv-se/meeting-meet-app.js":[715044,292831],"./sv-se/meeting-options.js":[352,257298],"./sv-se/meeting-recap.js":[728871,886317],"./sv-se/meeting-room-console.js":[717546,582193],"./sv-se/meeting-stream-app.js":[524336,298059],"./sv-se/message-escalate-dialog.js":[223203,24601],"./sv-se/messaging.js":[889162,104664],"./sv-se/mtma-missed-notifications.js":[124078,511020],"./sv-se/nova.js":[80434,304195],"./sv-se/people-app.js":[446223,262262],"./sv-se/people-picker.js":[724198,62417],"./sv-se/people-targeting.js":[938185,349785],"./sv-se/people.js":[10696,906707],"./sv-se/person.js":[937123,559521],"./sv-se/phonelink-sms.js":[123775,130649],"./sv-se/pre-core.js":[984822,792615],"./sv-se/premium-benefits.js":[824175,597256],"./sv-se/presence.js":[615864,371493],"./sv-se/queues.js":[50114,817926],"./sv-se/recurrence.js":[828493,369944],"./sv-se/rsc-application-permissions.js":[153783,152022],"./sv-se/search.js":[83607,855010],"./sv-se/semantic-object.js":[473151,168915],"./sv-se/settings.js":[962806,989104],"./sv-se/share-in-meetings.js":[914038,269222],"./sv-se/share-to-teams-outlook-addin.js":[143945,498539],"./sv-se/share-to-teams-third-party.js":[364436,17004],"./sv-se/share-to-teams.js":[670219,402236],"./sv-se/shortcut.js":[143779,523667],"./sv-se/shortcuts.js":[479870,943768],"./sv-se/simple-collab.js":[675354,414251],"./sv-se/smart-device.js":[19266,317961],"./sv-se/survey.js":[465444,385177],"./sv-se/sv-flyout.js":[105210,977114],"./sv-se/teams-and-channels.js":[682173,756590],"./sv-se/teams-insider.js":[52624,318888],"./sv-se/telemetry.js":[808041,722536],"./sv-se/tfl-homepage.js":[557369,18809],"./sv-se/tfl-onboarding.js":[402517,389402],"./sv-se/toast-notifications.js":[315302,997893],"./sv-se/unified-search.js":[424957,863764],"./sv-se/unsupported-browser.js":[286479,856067],"./sv-se/url-preview.js":[771259,324857],"./sv-se/video-capture.js":[841305,495249],"./sv-se/video-message.js":[597550,899700],"./sv-se/virtual-events.js":[733636,500439],"./sv-se/webinar.js":[386673,985029],"./sv-se/welcome-bot.js":[672012,992468],"./sv-se/whats-new.js":[505342,644688],"./sv-se/wiki.js":[687153,736151],"./th-th/activity.js":[652026,974770],"./th-th/artifacts-platform.js":[548027,979869],"./th-th/audience-view-dialog.js":[34178,732937],"./th-th/auth.js":[618711,456205],"./th-th/autosuggest.js":[172200,225604],"./th-th/avatar.js":[236175,921719],"./th-th/biometric-enrollment.js":[189018,147468],"./th-th/breakout-rooms.js":[944235,394301],"./th-th/broadcast.js":[706426,83561],"./th-th/calendar.js":[802119,755905],"./th-th/calling.js":[578920,934857],"./th-th/campaign-notifications.js":[28586,774922],"./th-th/carousel-multi-card.js":[792468,626252],"./th-th/cast.js":[510733,134898],"./th-th/channels.js":[645252,888766],"./th-th/chat-list.js":[566880,714947],"./th-th/coach-report.js":[887152,506093],"./th-th/comment-stream.js":[797926,70978],"./th-th/communities.js":[29388,566124],"./th-th/compose.js":[883654,277118],"./th-th/contacts.js":[224156,786697],"./th-th/datepicker.js":[956180,99062],"./th-th/desktop.js":[107942,135608],"./th-th/digital-signage.js":[414656,104814],"./th-th/discover-surface.js":[566306,701685],"./th-th/edu.js":[488113,469929],"./th-th/embed.js":[929330,334723],"./th-th/errors.js":[804165,676717],"./th-th/esp.js":[748737,45617],"./th-th/extensibility-ptz-extension.js":[974265,619436],"./th-th/extensibility-room-remote.js":[862321,397230],"./th-th/extensibility.js":[149772,200670],"./th-th/feedback.js":[698462,719234],"./th-th/files.js":[4008,195544],"./th-th/framework.js":[523631,572108],"./th-th/freemium-upgrade.js":[697200,426302],"./th-th/freemium.js":[876004,804328],"./th-th/funstuff.js":[688322,265996],"./th-th/gallery.js":[103207,284863],"./th-th/growth.js":[647164,664915],"./th-th/guardians.js":[424362,938493],"./th-th/health.js":[131219,75083],"./th-th/help.js":[846245,370533],"./th-th/hololens.js":[274414,987929],"./th-th/host-controls.js":[955423,448436],"./th-th/jana.js":[408559,385249],"./th-th/lightbox.js":[767564,837437],"./th-th/live-persona-card.js":[649431,157352],"./th-th/live-persona-editor.js":[143106,374059],"./th-th/lms-integration.js":[357079,365664],"./th-th/meet-for-work.js":[350587,97492],"./th-th/meeting-analytics.js":[420284,851244],"./th-th/meeting-apis-app.js":[253264,750392],"./th-th/meeting-bot.js":[61180,693980],"./th-th/meeting-collaboration.js":[637124,472804],"./th-th/meeting-flyout.js":[32879,991580],"./th-th/meeting-meet-app.js":[53570,926958],"./th-th/meeting-options.js":[386194,100526],"./th-th/meeting-recap.js":[447672,921638],"./th-th/meeting-room-console.js":[956477,552067],"./th-th/meeting-stream-app.js":[72190,832820],"./th-th/message-escalate-dialog.js":[808708,652116],"./th-th/messaging.js":[139743,361024],"./th-th/mtma-missed-notifications.js":[938992,716130],"./th-th/nova.js":[942201,209067],"./th-th/people-app.js":[43711,923386],"./th-th/people-picker.js":[129986,19844],"./th-th/people-targeting.js":[334433,581598],"./th-th/people.js":[340341,521475],"./th-th/person.js":[614603,68715],"./th-th/phonelink-sms.js":[109801,656660],"./th-th/pre-core.js":[327933,489682],"./th-th/premium-benefits.js":[991735,703957],"./th-th/presence.js":[757463,288413],"./th-th/queues.js":[527796,955166],"./th-th/recurrence.js":[896828,30100],"./th-th/rsc-application-permissions.js":[60579,677258],"./th-th/search.js":[272657,929488],"./th-th/semantic-object.js":[128170,833513],"./th-th/settings.js":[237495,98301],"./th-th/share-in-meetings.js":[205256,394089],"./th-th/share-to-teams-outlook-addin.js":[509059,736585],"./th-th/share-to-teams-third-party.js":[194284,755090],"./th-th/share-to-teams.js":[733234,881943],"./th-th/shortcut.js":[86233,525603],"./th-th/shortcuts.js":[732950,369061],"./th-th/simple-collab.js":[914779,128690],"./th-th/smart-device.js":[598198,333004],"./th-th/survey.js":[222671,43775],"./th-th/sv-flyout.js":[941072,839716],"./th-th/teams-and-channels.js":[773966,433384],"./th-th/teams-insider.js":[64889,742705],"./th-th/telemetry.js":[346712,835579],"./th-th/tfl-homepage.js":[739538,163861],"./th-th/tfl-onboarding.js":[635914,49112],"./th-th/toast-notifications.js":[296657,377087],"./th-th/unified-search.js":[132052,61117],"./th-th/unsupported-browser.js":[436422,768262],"./th-th/url-preview.js":[755499,6698],"./th-th/video-capture.js":[727971,446990],"./th-th/video-message.js":[489088,470141],"./th-th/virtual-events.js":[179899,462270],"./th-th/webinar.js":[861e3,874919],"./th-th/welcome-bot.js":[219500,913084],"./th-th/whats-new.js":[862944,178913],"./th-th/wiki.js":[900568,225570],"./tr-tr/activity.js":[646039,738368],"./tr-tr/artifacts-platform.js":[790394,931447],"./tr-tr/audience-view-dialog.js":[31296,865487],"./tr-tr/auth.js":[810341,824842],"./tr-tr/autosuggest.js":[1011,312773],"./tr-tr/avatar.js":[615204,587989],"./tr-tr/biometric-enrollment.js":[801094,549629],"./tr-tr/breakout-rooms.js":[626132,532919],"./tr-tr/broadcast.js":[231259,136390],"./tr-tr/calendar.js":[962472,543611],"./tr-tr/calling.js":[655526,97366],"./tr-tr/campaign-notifications.js":[448576,894852],"./tr-tr/carousel-multi-card.js":[581594,793716],"./tr-tr/cast.js":[298701,481571],"./tr-tr/channels.js":[310152,761522],"./tr-tr/chat-list.js":[264765,784071],"./tr-tr/coach-report.js":[990463,930037],"./tr-tr/comment-stream.js":[570731,877047],"./tr-tr/communities.js":[896467,718358],"./tr-tr/compose.js":[507535,165656],"./tr-tr/contacts.js":[774813,77151],"./tr-tr/datepicker.js":[684477,38987],"./tr-tr/desktop.js":[104518,503420],"./tr-tr/digital-signage.js":[125732,58486],"./tr-tr/discover-surface.js":[128858,357260],"./tr-tr/edu.js":[220057,993392],"./tr-tr/embed.js":[750966,658335],"./tr-tr/errors.js":[420825,929861],"./tr-tr/esp.js":[869045,54594],"./tr-tr/extensibility-ptz-extension.js":[790371,232349],"./tr-tr/extensibility-room-remote.js":[956629,741513],"./tr-tr/extensibility.js":[945022,567014],"./tr-tr/feedback.js":[302755,606824],"./tr-tr/files.js":[218560,520663],"./tr-tr/framework.js":[952269,83905],"./tr-tr/freemium-upgrade.js":[251315,546944],"./tr-tr/freemium.js":[943699,498416],"./tr-tr/funstuff.js":[161294,629233],"./tr-tr/gallery.js":[140926,948569],"./tr-tr/growth.js":[94638,109245],"./tr-tr/guardians.js":[958927,468994],"./tr-tr/health.js":[942495,518402],"./tr-tr/help.js":[696887,981173],"./tr-tr/hololens.js":[17003,275782],"./tr-tr/host-controls.js":[392607,6634],"./tr-tr/jana.js":[831681,459174],"./tr-tr/lightbox.js":[142517,767218],"./tr-tr/live-persona-card.js":[978433,533634],"./tr-tr/live-persona-editor.js":[279274,923115],"./tr-tr/lms-integration.js":[262461,809587],"./tr-tr/meet-for-work.js":[949107,229652],"./tr-tr/meeting-analytics.js":[218178,328436],"./tr-tr/meeting-apis-app.js":[241030,50824],"./tr-tr/meeting-bot.js":[513924,538718],"./tr-tr/meeting-collaboration.js":[160841,112395],"./tr-tr/meeting-flyout.js":[806427,817118],"./tr-tr/meeting-meet-app.js":[108922,222848],"./tr-tr/meeting-options.js":[145723,471055],"./tr-tr/meeting-recap.js":[121724,423136],"./tr-tr/meeting-room-console.js":[71655,545233],"./tr-tr/meeting-stream-app.js":[574845,176502],"./tr-tr/message-escalate-dialog.js":[762739,73627],"./tr-tr/messaging.js":[938294,916105],"./tr-tr/mtma-missed-notifications.js":[575669,273423],"./tr-tr/nova.js":[125223,126476],"./tr-tr/people-app.js":[822863,706763],"./tr-tr/people-picker.js":[723176,975041],"./tr-tr/people-targeting.js":[652842,244299],"./tr-tr/people.js":[401389,131689],"./tr-tr/person.js":[953821,246053],"./tr-tr/phonelink-sms.js":[847691,966773],"./tr-tr/pre-core.js":[665979,205572],"./tr-tr/premium-benefits.js":[169167,536427],"./tr-tr/presence.js":[951813,40352],"./tr-tr/queues.js":[181728,408902],"./tr-tr/recurrence.js":[267978,468196],"./tr-tr/rsc-application-permissions.js":[226899,342195],"./tr-tr/search.js":[544725,773873],"./tr-tr/semantic-object.js":[984903,246810],"./tr-tr/settings.js":[396219,575575],"./tr-tr/share-in-meetings.js":[705659,19171],"./tr-tr/share-to-teams-outlook-addin.js":[51460,725745],"./tr-tr/share-to-teams-third-party.js":[64135,812223],"./tr-tr/share-to-teams.js":[220280,727014],"./tr-tr/shortcut.js":[787468,71428],"./tr-tr/shortcuts.js":[466713,551702],"./tr-tr/simple-collab.js":[983527,225445],"./tr-tr/smart-device.js":[34440,356693],"./tr-tr/survey.js":[35707,936191],"./tr-tr/sv-flyout.js":[73704,591776],"./tr-tr/teams-and-channels.js":[887059,848640],"./tr-tr/teams-insider.js":[387249,968823],"./tr-tr/telemetry.js":[565841,371336],"./tr-tr/tfl-homepage.js":[785954,993467],"./tr-tr/tfl-onboarding.js":[732349,666397],"./tr-tr/toast-notifications.js":[619078,703475],"./tr-tr/unified-search.js":[229654,709479],"./tr-tr/unsupported-browser.js":[91962,258717],"./tr-tr/url-preview.js":[814332,842088],"./tr-tr/video-capture.js":[911505,644935],"./tr-tr/video-message.js":[594144,305652],"./tr-tr/virtual-events.js":[169878,196367],"./tr-tr/webinar.js":[916198,868187],"./tr-tr/welcome-bot.js":[758618,814298],"./tr-tr/whats-new.js":[596547,180370],"./tr-tr/wiki.js":[251185,804734],"./uk-ua/activity.js":[731419,372479],"./uk-ua/artifacts-platform.js":[775929,889732],"./uk-ua/audience-view-dialog.js":[603067,371595],"./uk-ua/auth.js":[346610,414026],"./uk-ua/autosuggest.js":[341596,862301],"./uk-ua/avatar.js":[229230,262283],"./uk-ua/biometric-enrollment.js":[129867,351002],"./uk-ua/breakout-rooms.js":[783613,221816],"./uk-ua/broadcast.js":[543266,683254],"./uk-ua/calendar.js":[503762,783668],"./uk-ua/calling.js":[223720,772704],"./uk-ua/campaign-notifications.js":[827745,912508],"./uk-ua/carousel-multi-card.js":[543887,263542],"./uk-ua/cast.js":[773628,399954],"./uk-ua/channels.js":[851403,100671],"./uk-ua/chat-list.js":[763488,735874],"./uk-ua/coach-report.js":[25134,656906],"./uk-ua/comment-stream.js":[630042,891128],"./uk-ua/communities.js":[50605,156998],"./uk-ua/compose.js":[465639,536050],"./uk-ua/contacts.js":[656535,406788],"./uk-ua/datepicker.js":[225443,995387],"./uk-ua/desktop.js":[809298,541081],"./uk-ua/digital-signage.js":[154528,299351],"./uk-ua/discover-surface.js":[348051,554800],"./uk-ua/edu.js":[175553,420786],"./uk-ua/embed.js":[79946,962432],"./uk-ua/errors.js":[788553,107139],"./uk-ua/esp.js":[958789,323817],"./uk-ua/extensibility-ptz-extension.js":[529986,637327],"./uk-ua/extensibility-room-remote.js":[901233,858187],"./uk-ua/extensibility.js":[473901,212922],"./uk-ua/feedback.js":[983525,997180],"./uk-ua/files.js":[882483,56511],"./uk-ua/framework.js":[613932,660920],"./uk-ua/freemium-upgrade.js":[331560,149557],"./uk-ua/freemium.js":[65475,559216],"./uk-ua/funstuff.js":[862529,20617],"./uk-ua/gallery.js":[63761,354881],"./uk-ua/growth.js":[776537,782096],"./uk-ua/guardians.js":[555240,193937],"./uk-ua/health.js":[869251,528226],"./uk-ua/help.js":[601183,104475],"./uk-ua/hololens.js":[951854,868060],"./uk-ua/host-controls.js":[111785,162566],"./uk-ua/jana.js":[39400,359034],"./uk-ua/lightbox.js":[379117,520424],"./uk-ua/live-persona-card.js":[300715,118660],"./uk-ua/live-persona-editor.js":[109437,717490],"./uk-ua/lms-integration.js":[833977,356545],"./uk-ua/meet-for-work.js":[124090,924371],"./uk-ua/meeting-analytics.js":[673591,592295],"./uk-ua/meeting-apis-app.js":[43420,62317],"./uk-ua/meeting-bot.js":[756625,959394],"./uk-ua/meeting-collaboration.js":[824858,762674],"./uk-ua/meeting-flyout.js":[111983,656276],"./uk-ua/meeting-meet-app.js":[629005,958973],"./uk-ua/meeting-options.js":[9964,4472],"./uk-ua/meeting-recap.js":[883780,825188],"./uk-ua/meeting-room-console.js":[930655,207664],"./uk-ua/meeting-stream-app.js":[72082,849586],"./uk-ua/message-escalate-dialog.js":[406593,677579],"./uk-ua/messaging.js":[651010,471167],"./uk-ua/mtma-missed-notifications.js":[366969,268342],"./uk-ua/nova.js":[8934,579804],"./uk-ua/people-app.js":[744930,440591],"./uk-ua/people-picker.js":[155837,652975],"./uk-ua/people-targeting.js":[48988,974286],"./uk-ua/people.js":[1187,587450],"./uk-ua/person.js":[370159,827168],"./uk-ua/phonelink-sms.js":[400510,67579],"./uk-ua/pre-core.js":[362132,983096],"./uk-ua/premium-benefits.js":[821753,9161],"./uk-ua/presence.js":[216936,63862],"./uk-ua/queues.js":[711394,178367],"./uk-ua/recurrence.js":[518742,57400],"./uk-ua/rsc-application-permissions.js":[664306,434791],"./uk-ua/search.js":[303876,131346],"./uk-ua/semantic-object.js":[803810,231885],"./uk-ua/settings.js":[666072,689864],"./uk-ua/share-in-meetings.js":[775422,766558],"./uk-ua/share-to-teams-outlook-addin.js":[762288,35091],"./uk-ua/share-to-teams-third-party.js":[488104,163030],"./uk-ua/share-to-teams.js":[18758,783914],"./uk-ua/shortcut.js":[376330,446276],"./uk-ua/shortcuts.js":[252298,633510],"./uk-ua/simple-collab.js":[680954,509862],"./uk-ua/smart-device.js":[814298,39450],"./uk-ua/survey.js":[855305,143147],"./uk-ua/sv-flyout.js":[486562,321437],"./uk-ua/teams-and-channels.js":[446784,790788],"./uk-ua/teams-insider.js":[811210,302696],"./uk-ua/telemetry.js":[744234,375470],"./uk-ua/tfl-homepage.js":[592125,195820],"./uk-ua/tfl-onboarding.js":[735547,327082],"./uk-ua/toast-notifications.js":[779729,112447],"./uk-ua/unified-search.js":[244115,761587],"./uk-ua/unsupported-browser.js":[620630,216822],"./uk-ua/url-preview.js":[240361,993724],"./uk-ua/video-capture.js":[374562,89862],"./uk-ua/video-message.js":[729690,199628],"./uk-ua/virtual-events.js":[294069,628035],"./uk-ua/webinar.js":[999832,64937],"./uk-ua/welcome-bot.js":[582973,484322],"./uk-ua/whats-new.js":[424867,513731],"./uk-ua/wiki.js":[102367,509098],"./vi-vn/activity.js":[742189,791093],"./vi-vn/artifacts-platform.js":[945449,285267],"./vi-vn/audience-view-dialog.js":[606347,332313],"./vi-vn/auth.js":[748300,446210],"./vi-vn/autosuggest.js":[961763,995316],"./vi-vn/avatar.js":[185937,590769],"./vi-vn/biometric-enrollment.js":[16008,273754],"./vi-vn/breakout-rooms.js":[234104,176290],"./vi-vn/broadcast.js":[160050,899181],"./vi-vn/calendar.js":[679304,827594],"./vi-vn/calling.js":[474946,554309],"./vi-vn/campaign-notifications.js":[215154,966368],"./vi-vn/carousel-multi-card.js":[657269,952202],"./vi-vn/cast.js":[697324,475837],"./vi-vn/channels.js":[731841,463770],"./vi-vn/chat-list.js":[708717,281415],"./vi-vn/coach-report.js":[445206,515778],"./vi-vn/comment-stream.js":[303975,711690],"./vi-vn/communities.js":[984559,157358],"./vi-vn/compose.js":[353838,609408],"./vi-vn/contacts.js":[262866,685678],"./vi-vn/datepicker.js":[64963,433013],"./vi-vn/desktop.js":[204781,795424],"./vi-vn/digital-signage.js":[9788,280605],"./vi-vn/discover-surface.js":[42766,525249],"./vi-vn/edu.js":[999803,268782],"./vi-vn/embed.js":[389597,285108],"./vi-vn/errors.js":[585634,605239],"./vi-vn/esp.js":[622426,522589],"./vi-vn/extensibility-ptz-extension.js":[884037,73e4],"./vi-vn/extensibility-room-remote.js":[965327,602092],"./vi-vn/extensibility.js":[461588,257936],"./vi-vn/feedback.js":[647386,863033],"./vi-vn/files.js":[293521,891020],"./vi-vn/framework.js":[350930,805034],"./vi-vn/freemium-upgrade.js":[688065,408311],"./vi-vn/freemium.js":[256588,968456],"./vi-vn/funstuff.js":[452065,717758],"./vi-vn/gallery.js":[953437,561861],"./vi-vn/growth.js":[786997,436143],"./vi-vn/guardians.js":[14011,641133],"./vi-vn/health.js":[289923,256370],"./vi-vn/help.js":[633640,481580],"./vi-vn/hololens.js":[295299,549270],"./vi-vn/host-controls.js":[966642,650165],"./vi-vn/jana.js":[829497,565327],"./vi-vn/lightbox.js":[689403,659074],"./vi-vn/live-persona-card.js":[737915,636805],"./vi-vn/live-persona-editor.js":[623646,819451],"./vi-vn/lms-integration.js":[72894,603081],"./vi-vn/meet-for-work.js":[276010,357973],"./vi-vn/meeting-analytics.js":[843877,338059],"./vi-vn/meeting-apis-app.js":[287096,694886],"./vi-vn/meeting-bot.js":[762008,752388],"./vi-vn/meeting-collaboration.js":[555645,713307],"./vi-vn/meeting-flyout.js":[357046,217117],"./vi-vn/meeting-meet-app.js":[42250,719560],"./vi-vn/meeting-options.js":[205063,495468],"./vi-vn/meeting-recap.js":[786472,654272],"./vi-vn/meeting-room-console.js":[985899,288470],"./vi-vn/meeting-stream-app.js":[23185,689045],"./vi-vn/message-escalate-dialog.js":[187170,41912],"./vi-vn/messaging.js":[843458,521646],"./vi-vn/mtma-missed-notifications.js":[461476,840068],"./vi-vn/nova.js":[450091,15233],"./vi-vn/people-app.js":[448202,182695],"./vi-vn/people-picker.js":[696589,85834],"./vi-vn/people-targeting.js":[796927,838531],"./vi-vn/people.js":[458234,768866],"./vi-vn/person.js":[604072,349682],"./vi-vn/phonelink-sms.js":[720294,534677],"./vi-vn/pre-core.js":[309371,718418],"./vi-vn/premium-benefits.js":[103015,185632],"./vi-vn/presence.js":[477589,734931],"./vi-vn/queues.js":[470737,466976],"./vi-vn/recurrence.js":[674312,262995],"./vi-vn/rsc-application-permissions.js":[485440,602311],"./vi-vn/search.js":[183911,941305],"./vi-vn/semantic-object.js":[898713,99268],"./vi-vn/settings.js":[832291,55909],"./vi-vn/share-in-meetings.js":[295988,454485],"./vi-vn/share-to-teams-outlook-addin.js":[491173,992564],"./vi-vn/share-to-teams-third-party.js":[194639,702055],"./vi-vn/share-to-teams.js":[681154,334406],"./vi-vn/shortcut.js":[791070,208466],"./vi-vn/shortcuts.js":[286350,283601],"./vi-vn/simple-collab.js":[190392,7868],"./vi-vn/smart-device.js":[269686,375271],"./vi-vn/survey.js":[713806,132475],"./vi-vn/sv-flyout.js":[820377,425813],"./vi-vn/teams-and-channels.js":[892760,906350],"./vi-vn/teams-insider.js":[605171,481683],"./vi-vn/telemetry.js":[403962,824671],"./vi-vn/tfl-homepage.js":[81176,249438],"./vi-vn/tfl-onboarding.js":[35442,773449],"./vi-vn/toast-notifications.js":[682092,611853],"./vi-vn/unified-search.js":[694155,347386],"./vi-vn/unsupported-browser.js":[323764,827106],"./vi-vn/url-preview.js":[856241,14076],"./vi-vn/video-capture.js":[529188,527818],"./vi-vn/video-message.js":[466538,458232],"./vi-vn/virtual-events.js":[440246,311358],"./vi-vn/webinar.js":[890513,637947],"./vi-vn/welcome-bot.js":[954422,542340],"./vi-vn/whats-new.js":[804119,668331],"./vi-vn/wiki.js":[494984,75774],"./zh-cn/activity.js":[429266,535771],"./zh-cn/artifacts-platform.js":[773451,709962],"./zh-cn/audience-view-dialog.js":[420528,588658],"./zh-cn/auth.js":[457660,217526],"./zh-cn/autosuggest.js":[822146,751856],"./zh-cn/avatar.js":[886898,386296],"./zh-cn/biometric-enrollment.js":[513806,69526],"./zh-cn/breakout-rooms.js":[379667,618845],"./zh-cn/broadcast.js":[64529,355835],"./zh-cn/calendar.js":[719643,938090],"./zh-cn/calling.js":[716281,398411],"./zh-cn/campaign-notifications.js":[689043,660693],"./zh-cn/carousel-multi-card.js":[232015,364961],"./zh-cn/cast.js":[272930,818015],"./zh-cn/channels.js":[670970,367254],"./zh-cn/chat-list.js":[304345,17451],"./zh-cn/coach-report.js":[980488,759073],"./zh-cn/comment-stream.js":[922257,961444],"./zh-cn/communities.js":[633379,271254],"./zh-cn/compose.js":[242487,161864],"./zh-cn/contacts.js":[186146,906585],"./zh-cn/datepicker.js":[169918,368e3],"./zh-cn/desktop.js":[984762,150216],"./zh-cn/digital-signage.js":[824631,575207],"./zh-cn/discover-surface.js":[622829,997381],"./zh-cn/edu.js":[946605,391863],"./zh-cn/embed.js":[667041,354564],"./zh-cn/errors.js":[590016,750676],"./zh-cn/esp.js":[457560,518359],"./zh-cn/extensibility-ptz-extension.js":[327263,762771],"./zh-cn/extensibility-room-remote.js":[243689,742465],"./zh-cn/extensibility.js":[958025,676801],"./zh-cn/feedback.js":[765025,317915],"./zh-cn/files.js":[441773,561319],"./zh-cn/framework.js":[695029,159276],"./zh-cn/freemium-upgrade.js":[535316,492077],"./zh-cn/freemium.js":[858354,844807],"./zh-cn/funstuff.js":[32028,663296],"./zh-cn/gallery.js":[900966,505751],"./zh-cn/growth.js":[146519,299893],"./zh-cn/guardians.js":[662570,771351],"./zh-cn/health.js":[195919,372713],"./zh-cn/help.js":[926764,720944],"./zh-cn/hololens.js":[688174,977982],"./zh-cn/host-controls.js":[93716,879421],"./zh-cn/jana.js":[681781,788726],"./zh-cn/lightbox.js":[985381,616789],"./zh-cn/live-persona-card.js":[435788,190505],"./zh-cn/live-persona-editor.js":[681031,233061],"./zh-cn/lms-integration.js":[484173,616862],"./zh-cn/meet-for-work.js":[645722,879753],"./zh-cn/meeting-analytics.js":[588370,849122],"./zh-cn/meeting-apis-app.js":[926522,871408],"./zh-cn/meeting-bot.js":[255992,835268],"./zh-cn/meeting-collaboration.js":[348645,730807],"./zh-cn/meeting-flyout.js":[422752,861205],"./zh-cn/meeting-meet-app.js":[819754,189035],"./zh-cn/meeting-options.js":[290677,927092],"./zh-cn/meeting-recap.js":[501069,441252],"./zh-cn/meeting-room-console.js":[716135,673930],"./zh-cn/meeting-stream-app.js":[241037,522155],"./zh-cn/message-escalate-dialog.js":[357266,925500],"./zh-cn/messaging.js":[237838,161413],"./zh-cn/mtma-missed-notifications.js":[462294,642449],"./zh-cn/nova.js":[90116,741200],"./zh-cn/people-app.js":[538657,177795],"./zh-cn/people-picker.js":[910892,389905],"./zh-cn/people-targeting.js":[356579,894629],"./zh-cn/people.js":[40091,368763],"./zh-cn/person.js":[76790,882732],"./zh-cn/phonelink-sms.js":[194952,904435],"./zh-cn/pre-core.js":[197693,354265],"./zh-cn/premium-benefits.js":[682267,580480],"./zh-cn/presence.js":[854915,212521],"./zh-cn/queues.js":[756108,93671],"./zh-cn/recurrence.js":[534246,770706],"./zh-cn/rsc-application-permissions.js":[657764,78044],"./zh-cn/search.js":[816563,750948],"./zh-cn/semantic-object.js":[796499,357498],"./zh-cn/settings.js":[364637,596181],"./zh-cn/share-in-meetings.js":[367881,954129],"./zh-cn/share-to-teams-outlook-addin.js":[339166,54498],"./zh-cn/share-to-teams-third-party.js":[50793,89545],"./zh-cn/share-to-teams.js":[215069,742843],"./zh-cn/shortcut.js":[874867,329392],"./zh-cn/shortcuts.js":[151106,527317],"./zh-cn/simple-collab.js":[613901,134521],"./zh-cn/smart-device.js":[911406,849310],"./zh-cn/survey.js":[767507,142479],"./zh-cn/sv-flyout.js":[554649,733924],"./zh-cn/teams-and-channels.js":[846982,167981],"./zh-cn/teams-insider.js":[368391,502317],"./zh-cn/telemetry.js":[943825,33287],"./zh-cn/tfl-homepage.js":[110233,164752],"./zh-cn/tfl-onboarding.js":[887627,89785],"./zh-cn/toast-notifications.js":[38527,471790],"./zh-cn/unified-search.js":[385901,193774],"./zh-cn/unsupported-browser.js":[998254,720828],"./zh-cn/url-preview.js":[74485,916857],"./zh-cn/video-capture.js":[554348,84919],"./zh-cn/video-message.js":[252011,682304],"./zh-cn/virtual-events.js":[730877,698556],"./zh-cn/webinar.js":[117122,716110],"./zh-cn/welcome-bot.js":[49238,242291],"./zh-cn/whats-new.js":[619011,637662],"./zh-cn/wiki.js":[165513,414071],"./zh-tw/activity.js":[453726,700944],"./zh-tw/artifacts-platform.js":[145572,845699],"./zh-tw/audience-view-dialog.js":[904400,111814],"./zh-tw/auth.js":[228907,727133],"./zh-tw/autosuggest.js":[85394,829831],"./zh-tw/avatar.js":[429188,519989],"./zh-tw/biometric-enrollment.js":[605248,181701],"./zh-tw/breakout-rooms.js":[873803,754409],"./zh-tw/broadcast.js":[53403,207748],"./zh-tw/calendar.js":[213374,147549],"./zh-tw/calling.js":[531351,800393],"./zh-tw/campaign-notifications.js":[120677,150713],"./zh-tw/carousel-multi-card.js":[846755,107583],"./zh-tw/cast.js":[727508,967908],"./zh-tw/channels.js":[940702,956713],"./zh-tw/chat-list.js":[867761,564762],"./zh-tw/coach-report.js":[76508,886972],"./zh-tw/comment-stream.js":[419709,662091],"./zh-tw/communities.js":[667812,965271],"./zh-tw/compose.js":[550178,468792],"./zh-tw/contacts.js":[426859,311313],"./zh-tw/datepicker.js":[348684,841316],"./zh-tw/desktop.js":[990151,183201],"./zh-tw/digital-signage.js":[933896,579538],"./zh-tw/discover-surface.js":[843958,928491],"./zh-tw/edu.js":[716469,253546],"./zh-tw/embed.js":[207130,397238],"./zh-tw/errors.js":[220705,476524],"./zh-tw/esp.js":[679569,823531],"./zh-tw/extensibility-ptz-extension.js":[522019,380217],"./zh-tw/extensibility-room-remote.js":[784963,851484],"./zh-tw/extensibility.js":[192149,784899],"./zh-tw/feedback.js":[8008,793572],"./zh-tw/files.js":[855992,280680],"./zh-tw/framework.js":[713717,860192],"./zh-tw/freemium-upgrade.js":[15592,89514],"./zh-tw/freemium.js":[929779,53042],"./zh-tw/funstuff.js":[62451,493486],"./zh-tw/gallery.js":[672091,414422],"./zh-tw/growth.js":[682144,809809],"./zh-tw/guardians.js":[256596,791405],"./zh-tw/health.js":[92329,398048],"./zh-tw/help.js":[466914,33724],"./zh-tw/hololens.js":[122119,202751],"./zh-tw/host-controls.js":[635309,751484],"./zh-tw/jana.js":[834945,443608],"./zh-tw/lightbox.js":[118871,154941],"./zh-tw/live-persona-card.js":[176190,480094],"./zh-tw/live-persona-editor.js":[448862,314149],"./zh-tw/lms-integration.js":[106070,360345],"./zh-tw/meet-for-work.js":[536318,495120],"./zh-tw/meeting-analytics.js":[141160,579333],"./zh-tw/meeting-apis-app.js":[229112,369265],"./zh-tw/meeting-bot.js":[89047,79305],"./zh-tw/meeting-collaboration.js":[11128,904063],"./zh-tw/meeting-flyout.js":[188527,35444],"./zh-tw/meeting-meet-app.js":[734778,175567],"./zh-tw/meeting-options.js":[701654,705313],"./zh-tw/meeting-recap.js":[693553,190769],"./zh-tw/meeting-room-console.js":[573920,267415],"./zh-tw/meeting-stream-app.js":[199927,380702],"./zh-tw/message-escalate-dialog.js":[483566,561542],"./zh-tw/messaging.js":[376764,537596],"./zh-tw/mtma-missed-notifications.js":[737382,252885],"./zh-tw/nova.js":[276001,81020],"./zh-tw/people-app.js":[761274,882162],"./zh-tw/people-picker.js":[946184,138052],"./zh-tw/people-targeting.js":[769922,438011],"./zh-tw/people.js":[301751,517759],"./zh-tw/person.js":[145237,855739],"./zh-tw/phonelink-sms.js":[14079,51073],"./zh-tw/pre-core.js":[187822,905305],"./zh-tw/premium-benefits.js":[107755,582523],"./zh-tw/presence.js":[877945,735457],"./zh-tw/queues.js":[663686,326801],"./zh-tw/recurrence.js":[181825,335438],"./zh-tw/rsc-application-permissions.js":[908992,862807],"./zh-tw/search.js":[908461,222856],"./zh-tw/semantic-object.js":[359856,794114],"./zh-tw/settings.js":[526279,889973],"./zh-tw/share-in-meetings.js":[972315,815182],"./zh-tw/share-to-teams-outlook-addin.js":[938595,776805],"./zh-tw/share-to-teams-third-party.js":[334294,851082],"./zh-tw/share-to-teams.js":[547527,789266],"./zh-tw/shortcut.js":[271861,330467],"./zh-tw/shortcuts.js":[161944,584266],"./zh-tw/simple-collab.js":[678081,268204],"./zh-tw/smart-device.js":[811471,401011],"./zh-tw/survey.js":[115564,174548],"./zh-tw/sv-flyout.js":[664335,509149],"./zh-tw/teams-and-channels.js":[65512,930815],"./zh-tw/teams-insider.js":[296395,1567],"./zh-tw/telemetry.js":[845113,726937],"./zh-tw/tfl-homepage.js":[777600,953506],"./zh-tw/tfl-onboarding.js":[492598,10062],"./zh-tw/toast-notifications.js":[16986,408600],"./zh-tw/unified-search.js":[688295,527900],"./zh-tw/unsupported-browser.js":[589403,209265],"./zh-tw/url-preview.js":[329381,348671],"./zh-tw/video-capture.js":[192776,81283],"./zh-tw/video-message.js":[738426,803481],"./zh-tw/virtual-events.js":[729745,115992],"./zh-tw/webinar.js":[854344,564113],"./zh-tw/welcome-bot.js":[419353,115717],"./zh-tw/whats-new.js":[450443,37137],"./zh-tw/wiki.js":[392718,85070]};function a(e){if(!i.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],a=t[0];return i.e(t[1]).then((()=>i(a)))}a.keys=()=>Object.keys(n),a.id=122057,e.exports=a},668397:e=>{"use strict";e.exports=ITEMS_VIEW_STRINGS},214797:e=>{"use strict";if("undefined"==typeof componentsWebRecorderLoaderHVCV1Helper){var t=new Error("Cannot find module 'componentsWebRecorderLoaderHVCV1Helper'");throw t.code="MODULE_NOT_FOUND",t}e.exports=componentsWebRecorderLoaderHVCV1Helper},759455:e=>{"use strict";e.exports=JSON.parse('{"clientId":"5e3ce6c0-2b1f-4285-8d4b-75ee78787346","experienceName":"convene","clientTypeTelemetry":"convene","clientTypeServiceHeader":"convene","fallbackLocale":"en-us","basePath":"convene","useReactWebClientCoreTasks":true,"build":{"ckeditor":false},"loggingConstants":{"appTokens":{"test":"0b15014f683e4999989a5e66bc942700-51caff43-39b8-4cc9-a7d5-fcbf318ce0c2-6867"},"silent":false,"telemetryserver":"https://teams.events.data.microsoft.com/Collector/3.0/"},"webAuth":{"cacheLocation":"localStorage","navigateToLoginRequestUrl":true,"top":{"popUp":false},"iframe":{"redirectPath":"auth"}},"anon":[{"anonUrlMatch":"/convene/meetings"}],"partitionCacheByExperience":true}')}},d={};function u(e){var t=d[e];if(void 0!==t)return t.exports;var i=d[e]={id:e,loaded:!1,exports:{}};return l[e].call(i.exports,i,i.exports,u),i.loaded=!0,i.exports}u.m=l,u.amdO={},e=[],u.O=(t,i,n,a)=>{if(!i){var s=1/0;for(l=0;l<e.length;l++){for(var[i,n,a]=e[l],o=!0,r=0;r<i.length;r++)(!1&a||s>=a)&&Object.keys(u.O).every((e=>u.O[e](i[r])))?i.splice(r--,1):(o=!1,a<s&&(s=a));if(o){e.splice(l--,1);var c=n();void 0!==c&&(t=c)}}return t}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[i,n,a]},u.F={},u.E=e=>{Object.keys(u.F).map((t=>{u.F[t](e)}))},u.H={},u.G=e=>{Object.keys(u.H).map((t=>{u.H[t](e)}))},u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},i=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,u.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var a=Object.create(null);u.r(a);var s={};t=t||[null,i({}),i([]),i(i)];for(var o=2&n&&e;"object"==typeof o&&!~t.indexOf(o);o=i(o))Object.getOwnPropertyNames(o).forEach((t=>s[t]=()=>e[t]));return s.default=()=>e,u.d(a,s),a},u.d=(e,t)=>{for(var i in t)u.o(t,i)&&!u.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},u.f={},u.e=e=>Promise.all(Object.keys(u.f).reduce(((t,i)=>(u.f[i](e,t),t)),[])),u.u=e=>(({145:"components-screen-recorder2",229:"data-resolvers-browser-share",1091:"sht-cortextopictypeswebstrings_ta",1161:"fr-ca-files-js",1264:"components-calling-paywall-image-lazy",1371:"sr-latn-rs-calling-js",1567:"zh-tw-teams-insider-js",1639:"ar-sa-contacts-js",1675:"el-gr-guardians-js",1879:"fil-ph-shortcuts-js",2221:"en-us-video-message-js",2223:"id-id-wiki-js",2272:"pl-pl-extensibility-room-remote-js",2875:"sr-latn-rs-person-js",2941:"pt-br-simple-collab-js",2951:"r_data-resolvers-app-device-permission",2953:"hostDefaultsStrings46",2987:"fil-ph-esp-js",3021:"nl-nl-mtma-missed-notifications-js",3612:"ja-jp-recurrence-js",3985:"gl-es-meeting-room-console-js",4104:"fr-ca-embed-js",4387:"incremental-link",4472:"uk-ua-meeting-options-js",4606:"it-it-host-controls-js",4768:"el-gr-comment-stream-js",4845:"kk-kz-activity-js",4864:"ja-jp-extensibility-ptz-extension-js",5453:"et-ee-virtual-events-js",5523:"fr-ca-simple-collab-js",5588:"ko-kr-freemium-js",5608:"scaht-searchconvergedanswerteamsstrings-be-by",5631:"ca-es-valencia-mtma-missed-notifications-js",5694:"ca-es-calendar-js",5797:"pl-pl-health-js",5895:"sht-teams-answerroutercontainer",6095:"ca-es-mtma-missed-notifications-js",6204:"ca-es-valencia-live-persona-editor-js",6431:"hostUxStrings23",6437:"fi-fi-lms-integration-js",6442:"ka-ge-pre-core-js",6578:"mk-mk-calling-js",6634:"tr-tr-host-controls-js",6698:"th-th-url-preview-js",6834:"et-ee-broadcast-js",6851:"cy-gb-toast-notifications-js",6938:"fns59",7065:"sq-al-whats-new-js",7105:"en-us-campaign-notifications-js",7196:"eu-es-cast-js",7653:"hi-in-share-in-meetings-js",7696:"fns44",7799:"fi-fi-settings-js",7868:"vi-vn-simple-collab-js",7910:"el-gr-carousel-multi-card-js",8049:"hostUxStrings2",8057:"eu-es-queues-js",8074:"hi-IN-UiStrings-json",8113:"da-dk-live-persona-editor-js",8277:"sq-al-host-controls-js",8401:"es-es-toast-notifications-js",8670:"da-dk-embed-js",8733:"fr-fr-telemetry-js",8806:"data-resolvers-browser-ams",8890:"kk-kz-share-in-meetings-js",9161:"uk-ua-premium-benefits-js",9205:"id-id-growth-js",9318:"nb-no-extensibility-room-remote-js",9320:"scaht-cortextopictypeswebstrings_nn-no",9469:"hostUxStrings81",9473:"ro-ro-activity-js",9474:"scaht-cortextopictypeswebstrings_bn-in",9590:"otlang100",9642:"lv-lv-video-capture-js",9691:"sht-cortextopictypeswebstrings_da",9716:"he-il-search-js",10014:"scaht-cortextopictypeswebstrings_fi",10035:"fr-ca-calling-js",10062:"zh-tw-tfl-onboarding-js",10203:"create-folder-wizard",10236:"InformationProtectionStrings56",10599:"lv-lv-meeting-options-js",10675:"sht-search-answer-strings",10905:"gl-es-nova-js",10961:"nb-no-embed-js",11003:"sq-al-carousel-multi-card-js",11049:"he-il-unified-search-js",11528:"pt-pt-chat-list-js",11938:"fr-fr-feedback-js",12012:"sv-se-desktop-js",12133:"sl-si-framework-js",12181:"scaht-searchconvergedanswerteamsstrings-ms",12252:"et-ee-artifacts-platform-js",12535:"hostDefaultsStrings65",12549:"services-broadcast-signalr",12564:"ro-ro-contacts-js",12615:"mk-mk-wiki-js",12638:"pt-BR-UiStrings-json",12947:"sv-se-freemium-upgrade-js",13167:"bg-bg-chat-list-js",13358:"ca-es-artifacts-platform-js",13419:"pt-br-video-message-js",13491:"et-ee-messaging-js",13770:"he-il-meet-for-work-js",13795:"pt-br-pre-core-js",13872:"fil-ph-messaging-js",13891:"hi-in-channels-js",13896:"cs-cz-shortcuts-js",14006:"fr-ca-edu-js",14076:"vi-vn-url-preview-js",14153:"ar-sa-rsc-application-permissions-js",14283:"lv-lv-presence-js",14657:"sv-se-feedback-js",14743:"onecamera-locale-lv",14787:"msal-service",15154:"hi-in-share-to-teams-js",15233:"vi-vn-nova-js",15367:"es-mx-rsc-application-permissions-js",15943:"InformationProtectionStrings12",15965:"r_data-resolvers-teams-and-channels",16014:"services-translate",16288:"pl-pl-video-message-js",16457:"it-it-extensibility-js",16758:"lv-lv-recurrence-js",16852:"gl-es-growth-js",16975:"hu-hu-carousel-multi-card-js",16993:"nl-nl-person-js",17004:"sv-se-share-to-teams-third-party-js",17013:"scaht-cortextopictypeswebstrings_km-kh",17040:"it-it-meeting-stream-app-js",17197:"hi-in-video-message-js",17244:"sl-si-meeting-bot-js",17297:"onecamera-locale-da",17363:"sk-sk-people-app-js",17451:"zh-cn-chat-list-js",17624:"hostUxStrings62",17672:"es-es-wiki-js",17803:"nn-no-people-picker-js",17834:"es-mx-meeting-options-js",17836:"az-latn-az-meeting-options-js",17906:"eu-es-video-message-js",17939:"nn-no-digital-signage-js",17994:"ja-jp-simple-collab-js",18081:"ca-es-url-preview-js",18299:"he-il-communities-js",18555:"lt-lt-activity-js",18637:"sv-se-host-controls-js",18711:"fil-ph-presence-js",18739:"en-gb-wiki-js",18809:"sv-se-tfl-homepage-js",18898:"lt-strings-jsonThinRes",18950:"hostDefaultsStrings1",19085:"gl-es-breakout-rooms-js",19100:"pl-pl-meeting-options-js",19171:"tr-tr-share-in-meetings-js",19219:"fr-fr-mtma-missed-notifications-js",19310:"sr-latn-rs-meeting-stream-app-js",19420:"fr-FR-UiStrings-json",19476:"data-resolvers-public-preview",19818:"sk-sk-video-capture-js",19844:"th-th-people-picker-js",20136:"ca-es-valencia-activity-js",20617:"uk-ua-funstuff-js",20639:"hr-hr-errors-js",20676:"ar-sa-share-to-teams-third-party-js",20962:"is-is-live-persona-editor-js",20998:"webrec2-language-vi",21085:"kk-kz-search-js",21237:"bg-bg-premium-benefits-js",21366:"en-us-avatar-js",21390:"data-resolvers-web-app-switcher",21524:"az-latn-az-teams-insider-js",21767:"de-de-carousel-multi-card-js",21829:"platform-app-details-renderer",21868:"webrec2-language-cy-gb",21962:"scaht-cortextopictypeswebstrings_mk",21993:"lv-lv-share-in-meetings-js",22175:"ar-sa-breakout-rooms-js",22182:"scaht-cortextopictypeswebstrings_ky",22193:"cy-gb-webinar-js",22194:"nb-no-meeting-stream-app-js",22197:"scaht-cortextopictypeswebstrings_cs",22258:"ka-ge-url-preview-js",22332:"ru-ru-comment-stream-js",22383:"en-us-recurrence-js",22422:"fil-ph-welcome-bot-js",22463:"platform-app-deeplink-to-sidepanel-execute",22935:"pt-pt-lightbox-js",23046:"sk-sk-rsc-application-permissions-js",23095:"nl-nl-welcome-bot-js",23136:"scaht-cortextopictypeswebstrings_ga-ie",23363:"services-scis",23588:"da-dk-audience-view-dialog-js",23742:"ca-es-meeting-bot-js",23746:"ja-jp-meeting-flyout-js",23786:"fr-fr-teams-insider-js",23787:"services-substrate-bot-platform",23812:"it-it-wiki-js",23989:"data-resolvers-mru",23995:"it-it-errors-js",24018:"pt-br-biometric-enrollment-js",24054:"ca-es-valencia-errors-js",24240:"gl-es-tfl-homepage-js",24268:"kk-kz-sv-flyout-js",24285:"pt-pt-freemium-upgrade-js",24348:"pt-pt-framework-js",24358:"es-mx-tfl-onboarding-js",24506:"de-de-files-js",24529:"hi-in-teams-insider-js",24601:"sv-se-message-escalate-dialog-js",24782:"id-id-meeting-room-console-js",25118:"bg-bg-communities-js",25350:"categories-th-th-json",25778:"sq-al-unsupported-browser-js",26022:"fil-ph-tfl-homepage-js",26078:"az-latn-az-share-to-teams-third-party-js",26183:"pt-pt-person-js",26205:"hostUxStrings45",26352:"sq-al-live-persona-card-js",26525:"sht-searchanswerteamsstrings_es-ca",26610:"sht-searchanswerteamsstrings_es-de",26960:"sht-lpc",27069:"r_data-resolvers-third-party-calendar",27133:"data-resolvers-developer-switchers",27163:"sb-commanding-light",27203:"it-it-messaging-js",27394:"sr-latn-rs-files-js",27472:"is-is-meeting-flyout-js",27563:"en-gb-auth-js",27631:"nn-no-extensibility-ptz-extension-js",27656:"fr-ca-avatar-js",27878:"fi-fi-hololens-js",28043:"az-latn-az-nova-js",28091:"lv-lv-avatar-js",28242:"hostDefaultsStrings5",28521:"sk-sk-mtma-missed-notifications-js",28643:"pt-br-welcome-bot-js",28719:"es-mx-meeting-room-console-js",28812:"share-tray",28875:"sq-al-broadcast-js",28894:"hi-in-carousel-multi-card-js",28955:"nn-no-meeting-bot-js",29154:"fil-ph-meeting-options-js",29300:"fr-fr-datepicker-js",29311:"libphonenumber-bundle",29694:"fi-fi-url-preview-js",29780:"categories-tr-tr-json",29889:"ja-jp-datepicker-js",29942:"hostDefaultsStrings11",29954:"da-dk-pre-core-js",30010:"de-de-settings-js",30100:"th-th-recurrence-js",30206:"hostDefaultsStrings9",30373:"pt-br-host-controls-js",30548:"hi-in-unified-search-js",30735:"ro-ro-people-js",30756:"en-gb-calling-js",31161:"sl-si-communities-js",31177:"de-de-nova-js",31664:"hr-hr-url-preview-js",31678:"cy-gb-settings-js",31738:"et-ee-host-controls-js",32034:"services-connected-accounts",32186:"fi-fi-chat-list-js",32567:"az-latn-az-meeting-recap-js",32583:"sq-al-semantic-object-js",32786:"ru-ru-carousel-multi-card-js",32795:"es-es-telemetry-js",32847:"es-es-live-persona-card-js",32853:"pl-pl-recurrence-js",32966:"sht-cortextopictypeswebstrings_sq",32974:"en-us-url-preview-js",33287:"zh-cn-telemetry-js",33524:"kk-kz-meeting-analytics-js",33724:"zh-tw-help-js",33955:"da-dk-chat-list-js",34183:"es-mx-url-preview-js",34185:"ja-jp-share-to-teams-third-party-js",34392:"gl-es-freemium-js",34471:"r_data-resolvers-meeting-options",34679:"lt-lt-phonelink-sms-js",34704:"eu-es-people-picker-js",34715:"ja-jp-people-picker-js",34805:"he-il-premium-benefits-js",34904:"az-latn-az-campaign-notifications-js",34972:"mk-mk-tfl-homepage-js",35091:"uk-ua-share-to-teams-outlook-addin-js",35237:"ro-ro-errors-js",35444:"zh-tw-meeting-flyout-js",35575:"onecamera-locale-en-gb",35621:"bg-bg-presence-js",35632:"scaht-searchconvergedanswerteamsstrings-as-in",35661:"de-de-url-preview-js",35786:"en-gb-audience-view-dialog-js",35795:"gl-strings-jsonThinRes",35974:"sl-si-meet-for-work-js",36271:"fil-ph-carousel-multi-card-js",36552:"components-screen-recorder10",36631:"fr-ca-growth-js",37045:"eu-es-campaign-notifications-js",37137:"zh-tw-whats-new-js",37288:"sht-cortextopictypeswebstrings_et",37342:"services-viva-insights",37506:"it-it-meeting-flyout-js",37608:"nl-nl-smart-device-js",37697:"ko-kr-cast-js",37888:"r_data-resolvers-browser-share",37934:"is-is-biometric-enrollment-js",37943:"es-mx-digital-signage-js",38038:"ro-ro-meeting-analytics-js",38160:"scaht-searchconvergedanswerteamsstrings-th",38184:"lt-lt-help-js",38246:"broadcast-toolbar-container",38252:"hi-in-esp-js",38523:"nl-nl-unified-search-js",38842:"es-es-settings-js",38920:"r_data-resolvers-browser-settings",38987:"tr-tr-datepicker-js",39159:"hr-hr-calendar-js",39355:"fi-fi-calling-js",39450:"uk-ua-smart-device-js",39858:"eu-es-datepicker-js",39865:"sk-sk-freemium-js",39938:"pt-br-share-to-teams-third-party-js",40191:"el-gr-meeting-room-console-js",40294:"cy-gb-pre-core-js",40348:"et-ee-errors-js",40352:"tr-tr-presence-js",40400:"id-id-share-to-teams-js",40674:"sl-si-people-app-js",41050:"channel-notification-settings",41266:"ro-ro-video-message-js",41389:"fr-ca-errors-js",41610:"fr-fr-url-preview-js",41655:"ka-ge-embed-js",41912:"vi-vn-message-escalate-dialog-js",42072:"es-es-datepicker-js",42215:"sq-al-calling-js",42250:"bg-bg-edu-js",42279:"video-effects-and-avatar-panel",42388:"sht-cortextopictypeswebstrings_eu",42754:"sht-cortextopictypeswebstrings_si-lk",42756:"fi-fi-meet-for-work-js",42900:"lt-lt-freemium-js",43105:"sr-latn-rs-lms-integration-js",43136:"data-resolvers-channel-activity-settings",43191:"en-us-edu-js",43199:"cy-gb-whats-new-js",43206:"is-is-extensibility-js",43522:"lv-lv-channels-js",43597:"sht-cortextopictypeswebstrings_ca-es-valencia",43775:"th-th-survey-js",43883:"nl-nl-auth-js",43886:"ko-kr-framework-js",43983:"sht-cortextopictypeswebstrings_ka",43991:"ko-kr-avatar-js",44472:"ro-ro-share-to-teams-js",44644:"es-es-calling-js",45029:"data-resolvers-host-updates",45419:"InformationProtectionStrings77",45617:"th-th-esp-js",45669:"el-gr-shortcuts-js",45978:"cs-cz-breakout-rooms-js",46003:"hi-in-share-to-teams-outlook-addin-js",46148:"r_data-resolvers-artifacts-platform",46366:"ja-jp-files-js",46696:"es-es-teams-insider-js",46985:"sk-sk-freemium-upgrade-js",47064:"r_data-resolvers-reply-chains",47361:"en-gb-live-persona-card-js",47423:"webrec2-language-mk",47556:"hu-hu-presence-js",47681:"pt-br-lms-integration-js",47693:"ja-jp-presence-js",48601:"hr-hr-telemetry-js",48623:"sht-topics-sdk-loki-api",48771:"bg-bg-autosuggest-js",48839:"ur-PK-UiStrings-json",49087:"data-resolvers-loki",49112:"th-th-tfl-onboarding-js",49248:"en-gb-people-app-js",49339:"pl-pl-comment-stream-js",49343:"kk-kz-pre-core-js",49618:"en-gb-datepicker-js",49704:"ko-kr-pre-core-js",49742:"ca-es-queues-js",49776:"pl-pl-mtma-missed-notifications-js",49780:"nl-nl-biometric-enrollment-js",49863:"sr-Cyrl-BA-UiStrings-json",50105:"ja-jp-framework-js",50129:"ru-ru-calling-js",50333:"fr-ca-communities-js",50593:"hu-hu-funstuff-js",50729:"es-mx-contacts-js",50770:"lazy-extensible-app-with-consent-container",50824:"tr-tr-meeting-apis-app-js",50861:"scaht-searchconvergedanswerteamsstrings-ar",50886:"data-resolvers-message-common",50945:"sq-al-people-picker-js",51073:"zh-tw-phonelink-sms-js",51260:"categories-bg-bg-json",51397:"webrec2-language-ms",51403:"en-us-activity-js",51404:"InformationProtectionStrings52",51487:"ca-es-tfl-homepage-js",51539:"sht-searchanswerteamsstrings_es-ug-cn",51660:"sv-se-extensibility-ptz-extension-js",52001:"fr-ca-freemium-js",52144:"categories-tn-za-json",52277:"id-id-person-js",52334:"bg-bg-simple-collab-js",52389:"pt-pt-meeting-collaboration-js",52407:"r_data-resolvers-desktop-client-shortcuts",52455:"r_data-resolvers-msa-authentication",52573:"pl-pl-tfl-homepage-js",52791:"hi-in-discover-surface-js",53042:"zh-tw-freemium-js",53258:"gl-es-survey-js",53285:"is-is-premium-benefits-js",53330:"ka-ge-video-capture-js",53340:"fr-ca-unified-search-js",53393:"webrec2-language-zh-cn",53598:"nl-nl-settings-js",53945:"bg-bg-people-picker-js",53971:"sht-cortextopictypeswebstrings_prs",54014:"sht-cortextopictypeswebstrings_mk",54193:"az-latn-az-compose-js",54303:"et-ee-settings-js",54390:"ro-ro-sv-flyout-js",54473:"hr-hr-meeting-room-console-js",54498:"zh-cn-share-to-teams-outlook-addin-js",54583:"fr-fr-live-persona-card-js",54594:"tr-tr-esp-js",54705:"sk-sk-phonelink-sms-js",54738:"pt-br-people-targeting-js",54825:"ko-kr-hololens-js",54984:"mk-mk-webinar-js",55041:"sr-latn-rs-activity-js",55091:"hostDefaultsStrings71",55106:"nb-no-calendar-js",55135:"de-de-share-in-meetings-js",55328:"pt-pt-files-js",55471:"sq-al-campaign-notifications-js",55579:"mediaSettingsEditEmptyState",55678:"hostDefaultsStrings76",55909:"vi-vn-settings-js",56071:"ca-es-valencia-premium-benefits-js",56125:"sr-latn-rs-growth-js",56193:"ko-kr-meeting-recap-js",56448:"data-resolvers-m365-links",56508:"bg-bg-extensibility-ptz-extension-js",56511:"uk-ua-files-js",56716:"sr-latn-rs-meeting-analytics-js",56820:"scaht-searchconvergedanswerteamsstrings-ta",56865:"ca-es-esp-js",56884:"en-us-calling-js",56962:"nb-no-calling-js",57055:"nl-nl-extensibility-room-remote-js",57245:"hostDefaultsStrings75",57264:"services-io-mru",57368:"webrec2-language-fr-ca",57400:"uk-ua-recurrence-js",57681:"ko-kr-toast-notifications-js",57746:"data-resolvers-immersive-reader",58041:"hi-in-guardians-js",58089:"r_data-resolvers-user",58208:"fr-ca-teams-insider-js",58267:"webrec2-language-fi",58486:"tr-tr-digital-signage-js",58562:"ar-sa-video-message-js",58824:"hu-hu-rsc-application-permissions-js",59208:"fil-ph-discover-surface-js",59228:"es-mx-chat-list-js",59401:"nl-nl-coach-report-js",59616:"services-user-license",59959:"hostDefaultsStrings79",60031:"pt-br-help-js",60042:"fil-ph-recurrence-js",60088:"fr-strings-jsonThinRes",60123:"hostUxStrings27",60398:"de-de-unsupported-browser-js",60441:"pl-pl-meeting-analytics-js",60650:"ro-ro-premium-benefits-js",60982:"it-strings-jsonThinRes",61033:"hostUxStrings24",61117:"th-th-unified-search-js",61184:"pt-br-artifacts-platform-js",61233:"et-ee-files-js",62225:"fi-fi-webinar-js",62317:"uk-ua-meeting-apis-app-js",62417:"sv-se-people-picker-js",62545:"sr-latn-rs-guardians-js",62665:"components-screen-recorder82",62686:"scaht-searchconvergedanswerteamsstrings-sv",62921:"ru-ru-hololens-js",63159:"nn-no-teams-insider-js",63318:"gl-es-mtma-missed-notifications-js",63366:"fluid-picker-renderer",63725:"hu-hu-calendar-js",63862:"uk-ua-presence-js",63915:"el-gr-telemetry-js",64020:"lt-lt-message-escalate-dialog-js",64223:"cs-cz-digital-signage-js",64230:"en-us-sv-flyout-js",64426:"ar-sa-avatar-js",64487:"pt-br-breakout-rooms-js",64620:"categories-lb-lu-json",64729:"messageBar",64904:"en-us-people-picker-js",64937:"uk-ua-webinar-js",65016:"sq-al-people-js",65489:"en-gb-messaging-js",65606:"pt-pt-feedback-js",65940:"ru-ru-files-js",66062:"bg-bg-meeting-options-js",66204:"chat-call-button",66246:"cs-cz-meet-for-work-js",66424:"webrec2-language-hi",66608:"ar-sa-message-escalate-dialog-js",66639:"en-us-smart-device-js",66654:"fr-fr-meeting-analytics-js",66718:"scaht-searchconvergedanswerteamsstrings-fi",66830:"nn-no-cast-js",67046:"da-dk-premium-benefits-js",67579:"uk-ua-phonelink-sms-js",67722:"hu-hu-meeting-stream-app-js",67738:"el-strings-jsonThinRes",67775:"es-mx-calendar-js",67818:"components-calling-e2ee-end-screen",67976:"lv-lv-campaign-notifications-js",68072:"sr-latn-rs-health-js",68194:"ar-sa-comment-stream-js",68316:"ar-sa-meeting-bot-js",68400:"data-resolvers-mfu-contacts",68481:"en-us-virtual-events-js",68516:"data-resolvers-extensibility-app-picker",68547:"ja-jp-mtma-missed-notifications-js",68654:"hi-in-activity-js",68699:"mk-mk-unified-search-js",68715:"th-th-person-js",68857:"el-gr-url-preview-js",68891:"de-de-cast-js",68903:"hi-in-meeting-room-console-js",69021:"pl-pl-search-js",69057:"cy-gb-chat-list-js",69195:"categories-nb-no-json",69476:"sr-latn-rs-mtma-missed-notifications-js",69526:"zh-cn-biometric-enrollment-js",69752:"categories-ga-ie-json",69817:"hu-hu-url-preview-js",69987:"fr-ca-channels-js",70074:"lv-lv-guardians-js",70112:"ko-kr-simple-collab-js",70125:"az-latn-az-search-js",70434:"nb-no-channels-js",70672:"hr-hr-host-controls-js",70767:"sl-si-webinar-js",70978:"th-th-comment-stream-js",71247:"lv-lv-calling-js",71358:"fr-ca-host-controls-js",71428:"tr-tr-shortcut-js",71530:"en-gb-meeting-recap-js",71546:"SharepointInformationProtectionService",71645:"ro-ro-queues-js",71824:"sv-se-communities-js",71856:"InformationProtectionStrings84",71979:"scaht-searchconvergedanswerteamsstrings-et",72143:"pt-pt-presence-js",72259:"he-il-survey-js",72340:"bg-bg-comment-stream-js",72526:"ca-es-person-js",72713:"mk-mk-embed-js",72857:"en-gb-contacts-js",72869:"ca-es-search-js",72895:"et-ee-mtma-missed-notifications-js",73058:"ru-ru-share-in-meetings-js",73067:"hi-in-search-js",73206:"officeFluidOneDsSink",73509:"nl-nl-survey-js",73627:"tr-tr-message-escalate-dialog-js",73825:"sht-cortextopictypeswebstrings_ky",74295:"el-gr-calling-js",74592:"is-is-phonelink-sms-js",74712:"scaht-cortextopictypeswebstrings_sr-cyrl-ba",74747:"onecamera-locale-ko",74801:"services-targeting-hierarchy",74903:"es-mx-wiki-js",74934:"en-us-errors-js",75083:"th-th-health-js",75370:"eu-es-contacts-js",75381:"da-dk-share-in-meetings-js",75489:"lt-lt-hololens-js",75727:"ca-es-pre-core-js",75774:"vi-vn-wiki-js",75783:"az-latn-az-whats-new-js",75810:"calling-empty-notes-page",75818:"data-resolvers-browser-app-state",75987:"mk-mk-unsupported-browser-js",76027:"ro-ro-unsupported-browser-js",76057:"r_data-resolvers-browser-voicemail",76552:"nn-no-meeting-meet-app-js",76586:"hu-hu-embed-js",76862:"ru-ru-campaign-notifications-js",76882:"pl-pl-pre-core-js",77099:"sq-al-recurrence-js",77111:"pl-pl-host-controls-js",77151:"tr-tr-contacts-js",77183:"sht-searchanswerteamsstrings_es-sd-arab-pk",77247:"fil-ph-datepicker-js",77370:"id-id-share-to-teams-outlook-addin-js",77741:"hostDefaultsStrings49",77771:"fns6",77772:"components-screen-recorder44",77802:"da-dk-extensibility-ptz-extension-js",77910:"lv-lv-settings-js",77930:"ja-jp-desktop-js",78044:"zh-cn-rsc-application-permissions-js",78248:"scaht-searchconvergedanswerteamsstrings-fa",78269:"ca-es-presence-js",78312:"lt-lt-meeting-flyout-js",78385:"ar-sa-extensibility-js",78594:"data-resolvers-apps-platform",78623:"fns25",78721:"hu-hu-datepicker-js",78733:"r_data-resolvers-people-targeting",78846:"cy-gb-breakout-rooms-js",79091:"bg-bg-campaign-notifications-js",79156:"fns1",79286:"pt-br-webinar-js",79305:"zh-tw-meeting-bot-js",79357:"scaht-searchconvergedanswerteamsstrings-hr",79443:"components-post-meeting-comms",79455:"data-resolvers-browser-virtual-events",79506:"services-search",79613:"sht-cortextopictypeswebstrings_fr-ca",79803:"call-health-service",79889:"fns27",80070:"categories-zh-cn-json",80129:"hostUxStrings82",80275:"sht-searchanswerteamsstrings_es-mn-mn",80698:"pt-br-health-js",80937:"da-dk-compose-js",81020:"zh-tw-nova-js",81025:"scaht-search-answer-strings",81228:"it-it-meeting-bot-js",81283:"zh-tw-video-capture-js",81502:"cs-cz-video-capture-js",81686:"az-latn-az-calling-js",81769:"kk-kz-artifacts-platform-js",81798:"lv-lv-nova-js",81939:"otlang42",81952:"he-il-smart-device-js",82039:"es-mx-people-targeting-js",82218:"it-it-meet-for-work-js",82329:"data-resolvers-platform-tabs",82870:"sht-cortextopictypeswebstrings_kk",83035:"fr-fr-unsupported-browser-js",83084:"cs-cz-extensibility-js",83109:"sk-sk-premium-benefits-js",83155:"ro-ro-teams-and-channels-js",83324:"hu-hu-activity-js",83344:"he-il-help-js",83561:"th-th-broadcast-js",83563:"MeetingNotesShareService",83644:"cs-CZ-UiStrings-json",83794:"eu-es-teams-insider-js",83801:"relay-data-client",83905:"tr-tr-framework-js",83948:"lt-lt-presence-js",83977:"ro-ro-shortcut-js",84042:"data-resolvers-brb",84134:"kk-kz-jana-js",84226:"data-resolvers-contacts-sync-settings",84370:"hr-hr-shortcut-js",84655:"hr-hr-artifacts-platform-js",84743:"lt-lt-webinar-js",84765:"sht-cortextopictypeswebstrings_ko",84919:"zh-cn-video-capture-js",85070:"zh-tw-wiki-js",85245:"ar-sa-video-capture-js",85441:"en-us-meet-for-work-js",85537:"bg-bg-phonelink-sms-js",85589:"fr-ca-semantic-object-js",85810:"pl-pl-telemetry-js",85834:"vi-vn-people-picker-js",85993:"sht-searchanswerteamsstrings_es-ha-latn-ng",86002:"ja-jp-auth-js",86407:"fil-ph-toast-notifications-js",86985:"mk-mk-url-preview-js",86994:"en-us-live-persona-editor-js",87014:"de-de-guardians-js",87397:"fr-fr-chat-list-js",87506:"is-is-freemium-js",87507:"cy-gb-meeting-bot-js",87547:"fns32",87647:"ca-es-valencia-teams-insider-js",87899:"ca-es-valencia-avatar-js",88137:"services-meeting-templates",88167:"fr-ca-share-to-teams-js",88599:"sl-si-shortcut-js",88762:"fr-fr-framework-js",88811:"sl-si-guardians-js",88926:"r_data-resolvers-search",88995:"ja-jp-lightbox-js",89107:"categories-ar-sa-json",89189:"nn-no-shortcuts-js",89254:"nb-no-survey-js",89514:"zh-tw-freemium-upgrade-js",89545:"zh-cn-share-to-teams-third-party-js",89785:"zh-cn-tfl-onboarding-js",89862:"uk-ua-video-capture-js",89964:"gl-es-digital-signage-js",90245:"et-ee-desktop-js",90257:"id-id-calendar-js",90384:"sl-si-freemium-upgrade-js",90578:"he-il-people-targeting-js",90999:"download-the-latest-desktop-app",91085:"fil-ph-artifacts-platform-js",91125:"et-ee-shortcut-js",91128:"eu-es-tfl-onboarding-js",91727:"hi-in-feedback-js",91878:"ja-jp-wiki-js",91882:"fr-fr-hololens-js",92193:"he-il-autosuggest-js",92277:"fr-fr-guardians-js",92325:"hu-hu-sv-flyout-js",92352:"cs-cz-meeting-collaboration-js",92563:"is-is-channels-js",92567:"sht-cortextopictypeswebstrings_te",92598:"r_data-resolvers-search-feedback",92606:"es-mx-nova-js",92996:"sq-al-chat-list-js",93e3:"ar-sa-artifacts-platform-js",93163:"cy-gb-teams-insider-js",93564:"webrec2-language-da",93671:"zh-cn-queues-js",93726:"fil-ph-campaign-notifications-js",93843:"sr-latn-rs-tfl-onboarding-js",94050:"fil-ph-survey-js",94341:"webrec2-language-de",94385:"az-latn-az-url-preview-js",94451:"sht-cortextopictypeswebstrings_id",94462:"spaddondataonlydeferred",94505:"az-latn-az-person-js",94719:"cs-cz-tfl-homepage-js",94946:"ja-jp-meeting-room-console-js",95182:"fi-fi-feedback-js",95196:"en-gb-presence-js",95213:"data-resolvers-augloop",95432:"pt-br-people-js",95465:"sl-SI-UiStrings-json",95503:"ja-jp-telemetry-js",95837:"sk-sk-auth-js",95862:"en-gb-esp-js",95884:"ca-es-settings-js",95927:"it-it-presence-js",96228:"lv-lv-messaging-js",96450:"mk-mk-funstuff-js",96545:"bg-bg-desktop-js",96698:"esp-coachmark",96978:"services-live-state-broadcast",97206:"nl-nl-video-capture-js",97312:"az-latn-az-extensibility-ptz-extension-js",97324:"en-us-share-to-teams-js",97366:"tr-tr-calling-js",97392:"az-latn-az-pre-core-js",97431:"hostDefaultsStrings19",97492:"th-th-meet-for-work-js",97497:"sr-latn-rs-simple-collab-js",97740:"ca-es-valencia-hololens-js",97880:"fil-ph-unsupported-browser-js",97986:"hu-hu-extensibility-ptz-extension-js",98032:"it-it-meeting-recap-js",98169:"lv-lv-desktop-js",98208:"data-resolvers-browser-esp",98301:"th-th-settings-js",98420:"en-us-telemetry-js",98521:"hu-hu-autosuggest-js",98578:"hi-in-extensibility-ptz-extension-js",98685:"fr-fr-calendar-js",98687:"categories-hu-hu-json",98790:"categories-sr-latn-rs-json",98950:"hu-hu-shortcuts-js",98983:"da-dk-jana-js",99023:"ca-es-campaign-notifications-js",99062:"th-th-datepicker-js",99155:"de-de-meet-for-work-js",99268:"vi-vn-semantic-object-js",99311:"mk-mk-lightbox-js",99630:"pl-pl-calling-js",99641:"sr-latn-rs-strings-jsonThinRes",99816:"lv-lv-simple-collab-js",99834:"ru-ru-semantic-object-js",100251:"kk-kz-people-app-js",100299:"cs-cz-teams-insider-js",100401:"nn-no-toast-notifications-js",100526:"th-th-meeting-options-js",100545:"r_data-resolvers-external-calendar-email-address",100588:"data-resolvers-toast",100595:"fr-fr-esp-js",100671:"uk-ua-channels-js",101026:"fns36",101650:"en-us-extensibility-ptz-extension-js",101797:"ja-jp-tfl-onboarding-js",101870:"hr-hr-activity-js",101989:"sht-cortextopictypeswebstrings_de",102003:"fr-ca-datepicker-js",102087:"sv-se-meeting-analytics-js",102499:"sv-se-calling-js",102635:"cs-cz-live-persona-editor-js",102678:"et-ee-url-preview-js",102893:"id-ID-UiStrings-json",103117:"mk-mk-meeting-stream-app-js",103187:"ko-kr-tfl-onboarding-js",103385:"eu-es-growth-js",103474:"nn-no-esp-js",103842:"breakout-rooms",103998:"services-guardians",104016:"az-latn-az-activity-js",104346:"hostUxStrings32",104475:"uk-ua-help-js",104575:"es-mx-communities-js",104664:"sv-se-messaging-js",104679:"pl-pl-meet-for-work-js",104814:"th-th-digital-signage-js",104874:"en-gb-teams-insider-js",105301:"ja-jp-people-app-js",105632:"data-resolvers-calendar",105853:"sl-si-digital-signage-js",105887:"az-latn-az-strings-jsonThinRes",106140:"da-dk-meeting-analytics-js",106279:"ro-ro-datepicker-js",106328:"ru-ru-survey-js",106428:"webrec2-language-sq",106652:"services-dynamics-virtual-events",106858:"he-il-funstuff-js",107009:"es-mx-channels-js",107139:"uk-ua-errors-js",107222:"sq-al-shortcuts-js",107330:"pt-pt-funstuff-js",107458:"r_data-resolvers-esp-target",107583:"zh-tw-carousel-multi-card-js",107648:"ca-es-guardians-js",107706:"en-gb-help-js",107766:"eu-es-carousel-multi-card-js",107832:"sht-searchanswerteamsstrings_es-ro",107922:"fil-ph-mtma-missed-notifications-js",108021:"lt-lt-tfl-homepage-js",108083:"scaht-cortextopictypeswebstrings_uz",108235:"en-us-tfl-homepage-js",108401:"sl-si-virtual-events-js",108416:"ca-es-recurrence-js",108482:"he-il-lightbox-js",108525:"r_data-resolvers-browser-style-my-room",108689:"es-mx-simple-collab-js",108725:"components-files-personal-picker",108732:"sl-si-meeting-options-js",108897:"categories-nn-no-json",109030:"sht-searchanswerteamsstrings_es-fr",109159:"pl-pl-presence-js",109245:"tr-tr-growth-js",109332:"pl-pl-channels-js",109505:"hostUxStrings56",109557:"nb-no-jana-js",110131:"fr-ca-mtma-missed-notifications-js",110425:"ru-ru-video-message-js",110550:"da-dk-comment-stream-js",110849:"r_data-resolvers-browser-1gql-view-data",111064:"sl-si-telemetry-js",111108:"ka-ge-carousel-multi-card-js",111198:"meeting-room-front-row-chat",111318:"keyboardShortcutsModal",111517:"eu-es-jana-js",111814:"zh-tw-audience-view-dialog-js",111847:"pl-pl-teams-and-channels-js",111969:"gl-es-broadcast-js",112002:"reactions-overlay-renderer",112047:"r_data-resolvers-channel-info-pane",112279:"services-io-waffle",112391:"fil-ph-contacts-js",112395:"tr-tr-meeting-collaboration-js",112447:"uk-ua-toast-notifications-js",112505:"lv-lv-carousel-multi-card-js",113265:"wasmcv-web-worker",113336:"fi-fi-calendar-js",113353:"gl-es-embed-js",113401:"is-is-semantic-object-js",113468:"ko-kr-sv-flyout-js",113787:"ko-kr-virtual-events-js",113842:"scaht-searchconvergedanswerteamsstrings-ha-latn-ng",113962:"ja-jp-freemium-upgrade-js",113982:"it-it-people-js",114029:"cs-cz-discover-surface-js",114312:"eu-es-live-persona-editor-js",114373:"fi-fi-mtma-missed-notifications-js",114390:"nl-nl-embed-js",114394:"fr-fr-meet-for-work-js",114580:"ca-es-valencia-smart-device-js",114681:"SharepointShareService",114826:"services-url-preview",115381:"sl-si-wiki-js",115717:"zh-tw-welcome-bot-js",115840:"ko-kr-premium-benefits-js",115853:"kk-kz-comment-stream-js",115992:"zh-tw-virtual-events-js",116083:"ko-kr-files-js",116205:"services-ai-insights-sds",116267:"sht-cortextopictypeswebstrings_it",116471:"cy-gb-meeting-collaboration-js",116608:"fr-ca-video-message-js",116634:"eu-es-people-js",116645:"ro-ro-desktop-js",116894:"fil-ph-host-controls-js",117339:"hr-hr-sv-flyout-js",117843:"is-is-meeting-stream-app-js",118013:"az-latn-az-phonelink-sms-js",118109:"fil-ph-activity-js",118223:"document-creator",118390:"r_data-resolvers-team-gallery",118491:"hostUxStrings21",118516:"id-id-carousel-multi-card-js",118660:"uk-ua-live-persona-card-js",118698:"mk-MK-UiStrings-json",118862:"cy-gb-extensibility-js",118881:"en-gb-artifacts-platform-js",119330:"hostUxStrings36",119440:"pt-br-edu-js",119711:"hu-hu-unified-search-js",119749:"fi-fi-smart-device-js",119764:"sl-si-breakout-rooms-js",119790:"r_data-resolvers-bots-platform-worker",119815:"pl-pl-people-targeting-js",119825:"webrec2-language-hr",119974:"de-de-wiki-js",120012:"categories-ru-ru-json",120103:"hu-hu-esp-js",120155:"hostDefaultsStrings42",120197:"search-answer-v2",120199:"hu-hu-contacts-js",120284:"pt-br-video-capture-js",120394:"fi-fi-growth-js",120446:"de-de-recurrence-js",120514:"cs-cz-presence-js",120607:"ka-ge-recurrence-js",120642:"fi-fi-nova-js",120652:"cy-gb-meeting-room-console-js",120660:"components-centro-license-request",120778:"ar-sa-esp-js",120889:"fr-fr-shortcuts-js",120998:"fr-fr-welcome-bot-js",121388:"ka-ge-meeting-apis-app-js",121479:"nb-no-edu-js",121508:"ka-ge-desktop-js",121617:"az-latn-az-biometric-enrollment-js",121645:"en-us-growth-js",122331:"es-es-mtma-missed-notifications-js",122471:"sr-latn-rs-toast-notifications-js",122484:"ko-kr-extensibility-ptz-extension-js",122699:"r_data-resolvers-tenant-analytics",122721:"da-dk-teams-insider-js",122767:"sht-cortextopictypeswebstrings_cs",123015:"de-de-toast-notifications-js",123288:"fr-ca-video-capture-js",123293:"fns75",123578:"ko-kr-mtma-missed-notifications-js",123976:"en-us-rsc-application-permissions-js",124053:"otlang28",124099:"bg-bg-funstuff-js",124197:"fluid-compose-container",124468:"it-it-webinar-js",124503:"el-gr-smart-device-js",124922:"is-is-edu-js",125447:"hostDefaultsStrings83",125565:"pt-pt-biometric-enrollment-js",125612:"zh-CN-UiStrings-json",125768:"en-gb-comment-stream-js",125841:"components-screen-recorder106",125891:"sht-cortextopictypeswebstrings_zh-hant",126034:"es-es-contacts-js",126118:"ro-ro-simple-collab-js",126241:"it-it-live-persona-card-js",126476:"tr-tr-nova-js",126479:"he-il-datepicker-js",126715:"az-latn-az-digital-signage-js",126756:"data-resolvers-browser-notifications-settings",126838:"kk-kz-people-js",126924:"ug-CN-UiStrings-json",127005:"cs-cz-meeting-stream-app-js",127006:"scaht-cortextopictypeswebstrings_prs",127089:"pt-pt-tfl-homepage-js",127109:"hostDefaultsStrings51",127490:"data-resolvers-browser-voicemail",127564:"lt-lt-settings-js",127687:"hu-hu-feedback-js",127746:"ka-ge-extensibility-room-remote-js",127818:"lt-lt-tfl-onboarding-js",127994:"fr-ca-esp-js",128109:"ru-ru-framework-js",128358:"sl-si-audience-view-dialog-js",128560:"services-broadcast-captions",128690:"th-th-simple-collab-js",128846:"quz-PE-UiStrings-json",128887:"r_data-resolvers-platform-tabs-state",129323:"InformationProtectionStrings78",129345:"is-is-datepicker-js",129425:"de-de-calling-js",129551:"sr-latn-rs-share-to-teams-js",129638:"sr-latn-rs-compose-js",129692:"lv-lv-esp-js",129884:"categories-ig-ng-json",130192:"r_data-resolvers-ai-insights-sds",130288:"services-sharepoint-share",130313:"InformationProtectionStrings70",130480:"lt-lt-people-js",130500:"ja-jp-esp-js",130649:"sv-se-phonelink-sms-js",130778:"repIssue",131077:"lv-lv-meeting-room-console-js",131089:"nl-nl-shortcuts-js",131103:"en-gb-meeting-room-console-js",131282:"en-us-wiki-js",131346:"uk-ua-search-js",131530:"en-us-channels-js",131607:"id-id-jana-js",131689:"tr-tr-people-js",132238:"sht-cortextopictypeswebstrings_es-mx",132279:"lt-lt-whats-new-js",132475:"vi-vn-survey-js",132529:"data-resolvers-import-msa-contacts",132539:"ja-jp-extensibility-room-remote-js",132655:"pt-pt-webinar-js",132880:"ja-jp-biometric-enrollment-js",133043:"id-id-unified-search-js",133047:"ca-es-valencia-health-js",133346:"ca-es-valencia-people-app-js",133587:"id-id-sv-flyout-js",133912:"he-il-audience-view-dialog-js",133939:"nl-nl-toast-notifications-js",134005:"sq-al-comment-stream-js",134125:"services-cloud-storage-folders",134164:"et-ee-help-js",134257:"es-es-communities-js",134500:"nb-no-teams-insider-js",134521:"zh-cn-simple-collab-js",134697:"sv-strings-jsonThinRes",134898:"th-th-cast-js",135084:"hu-hu-nova-js",135357:"pt-br-shortcut-js",135393:"eu-es-settings-js",135453:"ro-ro-freemium-js",135608:"th-th-desktop-js",135764:"hi-in-welcome-bot-js",135829:"nl-nl-funstuff-js",135851:"cs-cz-meeting-recap-js",135869:"ca-es-valencia-compose-js",136175:"fil-ph-extensibility-ptz-extension-js",136390:"tr-tr-broadcast-js",136529:"ru-ru-freemium-upgrade-js",136665:"InformationProtectionStrings16",136666:"he-il-gallery-js",137171:"ru-ru-live-persona-editor-js",137302:"mk-mk-meeting-room-console-js",137499:"gl-es-lightbox-js",137643:"es-es-meeting-apis-app-js",137648:"ko-kr-help-js",137764:"en-gb-jana-js",137827:"sv-se-digital-signage-js",137831:"fr-ca-freemium-upgrade-js",137833:"cy-gb-share-to-teams-js",137885:"gl-es-meeting-recap-js",138011:"is-is-video-capture-js",138052:"zh-tw-people-picker-js",138487:"eu-es-virtual-events-js",138495:"pt-pt-message-escalate-dialog-js",138566:"scaht-searchconvergedanswerteamsstrings-ru",138738:"pl-pl-messaging-js",138794:"it-it-people-targeting-js",138796:"nn-no-meeting-apis-app-js",139155:"r_data-resolvers-update-client-state",139313:"lv-lv-people-js",139442:"sht-cortextopictypeswebstrings_sr",139651:"eu-es-semantic-object-js",139668:"es-mx-people-js",139680:"el-gr-audience-view-dialog-js",139746:"r_data-resolvers-search-substrate",139947:"discover-surface-caught-main",140521:"nb-no-teams-and-channels-js",140536:"sl-si-meeting-collaboration-js",140660:"scaht-searchconvergedanswerteamsstrings-sd-arab-pk",140661:"ja-jp-smart-device-js",140755:"pt-br-jana-js",140846:"sl-si-unsupported-browser-js",140955:"sk-sk-desktop-js",141147:"sq-al-calendar-js",141210:"r_data-resolvers-transcript-feedback",141267:"nb-no-welcome-bot-js",141425:"gl-es-meeting-analytics-js",141442:"ko-kr-recurrence-js",141719:"fns62",141912:"cs-cz-freemium-upgrade-js",142297:"hi-in-meeting-stream-app-js",142479:"zh-cn-survey-js",142705:"immersive-reader-service",142771:"r_data-resolvers-channel-activity-settings",142919:"sht-searchanswerteamsstrings_es-fr-ca",142980:"sl-si-welcome-bot-js",143147:"uk-ua-survey-js",143544:"de-de-funstuff-js",143673:"scaht-searchconvergedanswerteamsstrings-or",143688:"scaht-cortextopictypeswebstrings_is",143768:"hi-in-wiki-js",143825:"r_data-resolvers-browser-url-preview",144588:"ro-ro-extensibility-ptz-extension-js",144655:"eu-es-help-js",144741:"webrec2-language-pt-pt",144777:"r_data-resolvers-browser-lms-integration",144795:"fr-ca-tfl-onboarding-js",144801:"scaht-searchconvergedanswerteamsstrings-tt",145020:"sht-cortextopictypeswebstrings_hr",145085:"fi-fi-guardians-js",145106:"hu-hu-semantic-object-js",145128:"fil-ph-freemium-js",145260:"scaht-cortextopictypeswebstrings_zh-hans",145324:"sq-al-meeting-stream-app-js",145332:"services-io-mtma-user-data",145413:"lt-lt-queues-js",145742:"hostUxStrings43",145987:"id-id-meeting-stream-app-js",146811:"ka-ge-live-persona-editor-js",146815:"lv-lv-contacts-js",147097:"es-mx-meeting-collaboration-js",147213:"de-de-jana-js",147468:"th-th-biometric-enrollment-js",147475:"is-is-gallery-js",147484:"pt-br-lightbox-js",147549:"zh-tw-calendar-js",147696:"he-il-wiki-js",147700:"nl-nl-whats-new-js",147938:"lv-lv-toast-notifications-js",147960:"en-us-pre-core-js",148084:"r_data-resolvers-external-accounts",148784:"ja-jp-messaging-js",149040:"en-gb-virtual-events-js",149130:"es-mx-share-to-teams-third-party-js",149373:"bg-bg-meeting-meet-app-js",149557:"uk-ua-freemium-upgrade-js",149558:"ca-es-valencia-survey-js",149576:"AshaUtils",149884:"fr-ca-recurrence-js",150216:"zh-cn-desktop-js",150532:"el-gr-phonelink-sms-js",150544:"eu-es-hololens-js",150557:"scaht-cortextopictypeswebstrings_uk",150577:"ca-es-valencia-meeting-apis-app-js",150585:"id-id-meeting-apis-app-js",150591:"onePlayerLoader2",150713:"zh-tw-campaign-notifications-js",150802:"pl-pl-hololens-js",150960:"sl-si-chat-list-js",151167:"hi-in-meeting-bot-js",151194:"es-mx-gallery-js",151286:"fr-ca-people-app-js",151303:"fns72",151469:"data-resolvers-viva-insights",151566:"es-es-meeting-options-js",151673:"da-dk-survey-js",151772:"sq-al-virtual-events-js",152022:"sv-se-rsc-application-permissions-js",152081:"it-it-digital-signage-js",152208:"gl-es-contacts-js",152281:"onecamera-locale-nb",152395:"fil-ph-embed-js",152407:"sr-latn-rs-rsc-application-permissions-js",152442:"nl-nl-desktop-js",152481:"ru-ru-help-js",152542:"pt-pt-live-persona-card-js",152685:"cs-cz-freemium-js",153021:"r_data-apollo-broadcast-streaming-attendee",153022:"lt-lt-meeting-options-js",153087:"fil-ph-rsc-application-permissions-js",153326:"hostUxStrings67",153342:"fi-fi-video-capture-js",153385:"ru-ru-settings-js",153767:"fr-fr-desktop-js",153797:"sr-latn-rs-edu-js",153894:"ja-jp-cast-js",154002:"ro-ro-jana-js",154007:"r_data-resolvers-browser-meeting-scheduling-service",154085:"ko-kr-compose-js",154206:"sk-sk-meeting-analytics-js",154228:"de-de-help-js",154251:"ca-es-valencia-funstuff-js",154351:"ru-ru-presence-js",154365:"fr-fr-phonelink-sms-js",154645:"ca-es-valencia-files-js",154803:"ar-sa-presence-js",154821:"nl-nl-calendar-js",154941:"zh-tw-lightbox-js",155121:"lt-lt-host-controls-js",155133:"cy-gb-shortcuts-js",155138:"ar-sa-hololens-js",155327:"kk-kz-teams-insider-js",155340:"r_data-resolvers-browser-survey",155393:"chat-reject-call-button",155566:"gl-es-message-escalate-dialog-js",155672:"id-id-esp-js",155795:"sk-sk-semantic-object-js",155903:"sv-se-activity-js",155945:"sq-al-smart-device-js",156255:"services-biometric-enrollment",156506:"en-gb-video-message-js",156512:"da-dk-lms-integration-js",156852:"sl-si-extensibility-js",156998:"uk-ua-communities-js",157251:"ja-jp-chat-list-js",157269:"ca-es-premium-benefits-js",157312:"es-ES-UiStrings-json",157352:"th-th-live-persona-card-js",157358:"vi-vn-communities-js",157733:"ar-sa-biometric-enrollment-js",157907:"sr-latn-rs-unified-search-js",157918:"ko-kr-digital-signage-js",158048:"da-dk-tfl-homepage-js",158094:"fr-fr-messaging-js",158095:"cs-cz-wiki-js",158143:"sv-se-gallery-js",158267:"ca-es-valencia-simple-collab-js",158301:"el-gr-broadcast-js",158670:"nn-no-extensibility-room-remote-js",159111:"de-de-share-to-teams-js",159206:"common-post-types",159225:"fns13",159276:"zh-cn-framework-js",159344:"lt-lt-messaging-js",159425:"pt-pt-unsupported-browser-js",159507:"he-il-tfl-homepage-js",159551:"r_data-resolvers-guardians",159611:"sr-latn-rs-carousel-multi-card-js",159696:"cy-gb-meeting-stream-app-js",159753:"hostUxStrings70",159818:"auth",159923:"gl-es-extensibility-js",160295:"fns52",160479:"fns86",160568:"esp-quickguide",160618:"es-es-nova-js",160762:"ka-ge-edu-js",160848:"data-resolvers-search-meeting-summary",161100:"ka-ge-lightbox-js",161413:"zh-cn-messaging-js",161459:"otlang30",161464:"fr-ca-survey-js",161530:"r_data-resolvers-tfl-meeting-links",161864:"zh-cn-compose-js",161958:"pt-pt-carousel-multi-card-js",161967:"es-mx-extensibility-js",162374:"sq-al-avatar-js",162566:"uk-ua-host-controls-js",162582:"cs-cz-artifacts-platform-js",162689:"ca-es-valencia-meeting-room-console-js",163030:"uk-ua-share-to-teams-third-party-js",163084:"sk-sk-guardians-js",163221:"ro-ro-recurrence-js",163348:"ar-sa-live-persona-editor-js",163568:"ro-ro-autosuggest-js",163861:"th-th-tfl-homepage-js",164053:"lv-lv-embed-js",164066:"nl-nl-semantic-object-js",164485:"he-il-people-js",164557:"ca-es-valencia-people-targeting-js",164752:"zh-cn-tfl-homepage-js",165009:"sl-si-esp-js",165150:"sk-sk-framework-js",165191:"ca-es-live-persona-editor-js",165227:"hr-hr-compose-js",165278:"cs-cz-settings-js",165285:"es-mx-share-to-teams-js",165389:"hu-hu-survey-js",165441:"services-augloop",165518:"r_data-resolvers-communities",165558:"sr-latn-rs-biometric-enrollment-js",165656:"tr-tr-compose-js",165745:"user-onboarding-team",165873:"cs-cz-feedback-js",165903:"mk-mk-avatar-js",165930:"ka-ge-semantic-object-js",165950:"ar-sa-live-persona-card-js",166046:"ca-es-embed-js",166229:"pt-br-audience-view-dialog-js",166288:"sr-latn-rs-calendar-js",166450:"sq-strings-jsonThinRes",166937:"r_data-resolvers-community-settings",167105:"pl-pl-virtual-events-js",167107:"de-de-teams-and-channels-js",167116:"ru-ru-feedback-js",167225:"es-mx-health-js",167685:"az-latn-az-messaging-js",167721:"id-id-tfl-onboarding-js",167790:"ro-ro-carousel-multi-card-js",167828:"es-mx-framework-js",167955:"sk-sk-meeting-collaboration-js",167981:"zh-cn-teams-and-channels-js",168090:"gl-es-meet-for-work-js",168179:"pl-pl-shortcuts-js",168204:"bg-bg-lms-integration-js",168331:"es-mx-smart-device-js",168889:"onecamera-locale-sv",168915:"sv-se-semantic-object-js",168943:"it-it-teams-and-channels-js",169035:"nb-no-people-js",169128:"fr-ca-biometric-enrollment-js",169179:"de-de-tfl-onboarding-js",169281:"et-ee-survey-js",169321:"de-de-mtma-missed-notifications-js",169369:"WSETFoundInPlaces",169548:"he-il-unsupported-browser-js",169790:"sht-searchanswerteamsstrings_es-kn",169819:"sq-al-meeting-analytics-js",169834:"hr-hr-audience-view-dialog-js",170152:"tti-polyfill",170238:"ru-ru-avatar-js",170318:"scaht-cortextopictypeswebstrings_en-us",170387:"he-il-meeting-meet-app-js",170499:"fil-ph-video-capture-js",170558:"r_data-resolvers-privacy-settings",170726:"de-de-broadcast-js",170727:"ru-ru-funstuff-js",170874:"nl-nl-broadcast-js",170976:"hr-hr-people-targeting-js",171395:"en-gb-shortcuts-js",171418:"es-mx-embed-js",171576:"fr-ca-settings-js",171627:"sht-cortextopictypeswebstrings_es",171636:"sq-al-health-js",171721:"gl-es-chat-list-js",171794:"pt-br-wiki-js",172001:"sq-al-sv-flyout-js",172042:"services-io-sensitivity-label-policy-settings",172169:"lv-lv-extensibility-js",172353:"el-gr-unified-search-js",172557:"services-tenant-service",172787:"fr-fr-comment-stream-js",172842:"services-search-meeting-summary",173378:"scaht-searchconvergedanswerteamsstrings-es",173399:"ar-sa-health-js",173410:"fil-ph-meeting-bot-js",173524:"az-latn-az-lms-integration-js",173661:"hostDefaultsStrings22",173764:"fil-ph-lms-integration-js",173817:"sq-al-queues-js",173890:"onecamera-locale-pl",174279:"sk-sk-esp-js",174361:"onecamera-locale-tr",174377:"nl-nl-extensibility-js",174455:"sl-si-premium-benefits-js",174478:"he-il-freemium-upgrade-js",174548:"zh-tw-survey-js",174691:"sk-strings-jsonThinRes",174711:"lt-lt-desktop-js",174851:"id-id-recurrence-js",174883:"it-it-unsupported-browser-js",174890:"fr-ca-hololens-js",175245:"ca-es-valencia-meeting-options-js",175567:"zh-tw-meeting-meet-app-js",175586:"id-id-welcome-bot-js",175608:"is-is-guardians-js",175776:"nl-nl-recurrence-js",175822:"de-de-artifacts-platform-js",175925:"services-calling",176153:"eu-ES-UiStrings-json",176247:"lt-lt-live-persona-editor-js",176290:"vi-vn-breakout-rooms-js",176502:"tr-tr-meeting-stream-app-js",176935:"sv-se-growth-js",177060:"components-screen-recorder52",177104:"it-it-people-app-js",177186:"sk-sk-wiki-js",177362:"sht-searchanswerteamsstrings_es-ta",177409:"en-us-settings-js",177754:"fr-fr-carousel-multi-card-js",177795:"zh-cn-people-app-js",177846:"scaht-searchconvergedanswerteamsstrings-prs",177884:"en-gb-autosuggest-js",178367:"uk-ua-queues-js",178429:"ca-es-valencia-person-js",178500:"is-is-teams-insider-js",178533:"pt-br-queues-js",178761:"nl-nl-presence-js",178800:"fr-ca-pre-core-js",178815:"services-meeting-bot",178832:"services-emoticon",178866:"data-resolvers-team-gallery",178913:"th-th-whats-new-js",179041:"ca-es-valencia-people-picker-js",179246:"fil-ph-files-js",179405:"cy-gb-share-in-meetings-js",179475:"es-es-feedback-js",179588:"fil-ph-teams-insider-js",179802:"eu-es-artifacts-platform-js",179993:"sht-searchanswerteamsstrings_es-mr",180243:"hostUxStrings47",180280:"r_data-resolvers-azure-maps",180332:"pt-pt-smart-device-js",180370:"tr-tr-whats-new-js",180560:"fns4",180657:"sl-si-meeting-meet-app-js",180717:"sq-al-audience-view-dialog-js",180923:"pt-br-guardians-js",181174:"view-schema",181329:"en-gb-share-to-teams-js",181453:"pl-pl-breakout-rooms-js",181529:"is-is-discover-surface-js",181701:"zh-tw-biometric-enrollment-js",181802:"otlang12",182363:"ca-es-broadcast-js",182392:"nb-no-cast-js",182409:"webrec2-effects-backdrops",182627:"kk-kz-avatar-js",182695:"vi-vn-people-app-js",182773:"ca-es-valencia-presence-js",182786:"sht-searchanswerteamsstrings_es-or",183141:"el-gr-teams-and-channels-js",183158:"da-dk-extensibility-room-remote-js",183183:"el-gr-compose-js",183201:"zh-tw-desktop-js",183483:"services-google-calendar-authentication",183512:"sr-latn-rs-messaging-js",183663:"components-screen-recorder62",183703:"te-IN-UiStrings-json",183707:"r_data-resolvers-shell",183819:"ru-ru-meeting-room-console-js",184074:"otlang92",184079:"mk-mk-health-js",184277:"otlang96",184427:"data-resolvers-closed-captions",184586:"holographic-canvas",184874:"r_data-resolvers-browser-app-state",184895:"sq-al-growth-js",184998:"it-it-autosuggest-js",185240:"nn-no-share-to-teams-outlook-addin-js",185632:"vi-vn-premium-benefits-js",185873:"pl-pl-compose-js",185977:"mk-mk-breakout-rooms-js",186169:"pt-br-live-persona-editor-js",186248:"hi-in-files-js",186354:"onecamera-locale-th",186706:"ro-ro-broadcast-js",186781:"hi-in-live-persona-editor-js",186806:"el-gr-queues-js",186931:"az-latn-az-audience-view-dialog-js",187194:"gl-es-toast-notifications-js",187452:"fns0",187556:"az-latn-az-framework-js",187643:"en-us-share-to-teams-third-party-js",187657:"mk-mk-settings-js",187737:"ru-ru-breakout-rooms-js",187923:"fi-fi-extensibility-ptz-extension-js",187956:"kk-kz-growth-js",188013:"eu-es-presence-js",188070:"gl-es-recurrence-js",188079:"nn-no-discover-surface-js",188231:"ca-es-valencia-extensibility-js",188483:"fi-fi-freemium-upgrade-js",188532:"el-gr-autosuggest-js",188644:"sr-latn-rs-semantic-object-js",188975:"services-logs-files",188979:"hu-hu-unsupported-browser-js",189035:"zh-cn-meeting-meet-app-js",189086:"otlang16",189206:"lv-lv-tfl-onboarding-js",189344:"ro-ro-help-js",189386:"fil-ph-whats-new-js",189755:"lv-LV-UiStrings-json",189760:"fil-ph-jana-js",189840:"nb-no-people-picker-js",190171:"lv-lv-unsupported-browser-js",190277:"kk-kz-calling-js",190387:"bg-bg-toast-notifications-js",190434:"sq-al-share-to-teams-third-party-js",190505:"zh-cn-live-persona-card-js",190587:"scaht-cortextopictypeswebstrings_sr-cyrl",190769:"zh-tw-meeting-recap-js",191071:"et-ee-pre-core-js",191238:"fr-fr-people-picker-js",191549:"uk-UA-UiStrings-json",191872:"BohemiaCodeLoaderFactory",191950:"nb-no-simple-collab-js",192021:"is-is-meeting-apis-app-js",192151:"data-apollo-broadcast-streaming-attendee",192203:"scaht-topicanswerplugin",192301:"lt-lt-teams-insider-js",192500:"ka-ge-premium-benefits-js",192544:"da-dk-extensibility-js",193050:"he-il-jana-js",193101:"fi-fi-desktop-js",193284:"lv-lv-framework-js",193305:"ko-kr-audience-view-dialog-js",193553:"data-resolvers-browser-settings",193774:"zh-cn-unified-search-js",193841:"sht-searchanswerteamsstrings_es-ky",193937:"uk-ua-guardians-js",193939:"sk-sk-datepicker-js",194051:"el-gr-presence-js",194248:"services-gallery",194421:"addon-sp-deferredactions",194534:"cy-gb-digital-signage-js",194800:"lv-lv-autosuggest-js",195107:"ru-ru-tfl-homepage-js",195211:"et-ee-presence-js",195270:"services-meeting-scheduling-service",195320:"sht-cortextopictypeswebstrings_tr",195544:"th-th-files-js",195584:"ar-sa-tfl-onboarding-js",195696:"da-dk-meeting-options-js",195820:"uk-ua-tfl-homepage-js",195933:"cy-gb-meeting-meet-app-js",196001:"scaht-searchconvergedanswerteamsstrings-pl",196126:"hu-hu-telemetry-js",196188:"scaht-searchconvergedanswerteamsstrings-pt",196282:"pt-br-messaging-js",196303:"ru-ru-auth-js",196366:"pt-br-freemium-upgrade-js",196367:"tr-tr-virtual-events-js",196451:"eu-es-meeting-room-console-js",196710:"sht-searchanswerteamsstrings_es-ml",196755:"kk-kz-gallery-js",196951:"r_data-resolvers-gallery",197259:"hr-hr-semantic-object-js",197322:"gl-es-simple-collab-js",197577:"fil-ph-broadcast-js",197689:"hu-hu-extensibility-room-remote-js",197778:"pt-pt-tfl-onboarding-js",197913:"ro-ro-meeting-flyout-js",198050:"data-resolvers-phonelink-sms",198163:"components-screen-recorder78",198294:"fil-ph-live-persona-editor-js",198364:"de-de-calendar-js",198532:"nn-no-simple-collab-js",198662:"lv-lv-shortcuts-js",198722:"data-resolvers-browser-core",198900:"ko-kr-campaign-notifications-js",199081:"en-us-search-js",199228:"sk-sk-meeting-stream-app-js",199360:"sk-sk-nova-js",199382:"da-dk-broadcast-js",199628:"uk-ua-video-message-js",199668:"en-gb-activity-js",199673:"ja-jp-pre-core-js",199775:"it-it-rsc-application-permissions-js",199784:"et-ee-freemium-js",199886:"es-mx-broadcast-js",200326:"sr-latn-rs-people-targeting-js",200434:"he-il-files-js",200670:"th-th-extensibility-js",200755:"fr-fr-meeting-collaboration-js",201384:"ja-jp-host-controls-js",201514:"sht-cortex-topics-bootstrapper-topics-sdk",201814:"scaht-searchconvergedanswerteamsstrings-id",202001:"ja-jp-discover-surface-js",202066:"services-manage-tenant",202090:"data-resolvers-reply-chains",202115:"scaht-searchconvergedanswerteamsstrings-sr",202146:"scaht-searchconvergedanswerteamsstrings-it",202301:"precompiled-web-recorder-web-worker",202308:"et-ee-phonelink-sms-js",202480:"da-dk-teams-and-channels-js",202667:"kk-kz-video-capture-js",202751:"zh-tw-hololens-js",202852:"id-id-people-targeting-js",202895:"m365chat-card-container",202985:"da-dk-presence-js",203047:"fns8",203069:"es-mx-feedback-js",203090:"hr-hr-tfl-onboarding-js",203137:"services-files",203183:"ca-es-lightbox-js",203213:"fr-fr-growth-js",203249:"hr-hr-gallery-js",203386:"nn-no-gallery-js",203441:"data-resolvers-translation-settings",203776:"ko-kr-carousel-multi-card-js",203868:"gl-es-teams-insider-js",204672:"r_data-resolvers-distribution-list",204729:"fr-ca-queues-js",205023:"onecamera-locale-ga",205283:"pt-br-whats-new-js",205341:"lt-lt-coach-report-js",205445:"scaht-cortextopictypeswebstrings_eu",205543:"es-es-auth-js",205572:"tr-tr-pre-core-js",205629:"kk-kz-meeting-apis-app-js",205688:"InformationProtectionStrings20",205745:"nl-nl-nova-js",205767:"eu-es-freemium-js",205927:"ko-kr-jana-js",205961:"r_data-resolvers-store",206718:"pt-pt-meeting-meet-app-js",206792:"cy-gb-presence-js",206864:"ru-ru-guardians-js",206890:"cs-cz-share-to-teams-outlook-addin-js",206955:"cs-cz-cast-js",207202:"el-gr-cast-js",207272:"hu-hu-virtual-events-js",207351:"webrec2-language-tr",207356:"categories-es-mx-json",207423:"en-us-people-targeting-js",207514:"zh-hans-strings-jsonThinRes",207554:"de-de-welcome-bot-js",207664:"uk-ua-meeting-room-console-js",207711:"fi-fi-files-js",207723:"onecamera-locale-ja",207748:"zh-tw-broadcast-js",208189:"pt-pt-broadcast-js",208466:"vi-vn-shortcut-js",208579:"el-gr-lms-integration-js",208738:"ar-sa-nova-js",208969:"eu-es-errors-js",208981:"ar-sa-person-js",209067:"th-th-nova-js",209265:"zh-tw-unsupported-browser-js",209361:"en-us-lightbox-js",209379:"gl-es-video-message-js",209387:"kk-kz-settings-js",209480:"gl-es-welcome-bot-js",209807:"nb-no-share-to-teams-third-party-js",209849:"sl-si-presence-js",209921:"ar-sa-extensibility-ptz-extension-js",210035:"sht-searchanswerteamsstrings_es-zu-za",210130:"ca-es-valencia-teams-and-channels-js",210181:"ka-ge-health-js",210377:"he-il-semantic-object-js",210419:"nb-NO-UiStrings-json",210461:"pl-pl-discover-surface-js",210621:"scaht-searchconvergedanswerteamsstrings-ga-ie",210651:"lv-lv-meeting-recap-js",211101:"id-id-whats-new-js",211238:"data-resolvers-search-feedback",211332:"ka-ge-nova-js",211385:"id-id-chat-list-js",211591:"teams-dashboard",211752:"r_data-resolvers-unified-consent",211847:"InformationProtectionStrings2",212030:"ro-ro-url-preview-js",212177:"r_data-resolvers-external-search-suggestions",212216:"components-calling-call-accepted-elsewhere-screen",212352:"ca-es-valencia-embed-js",212353:"data-resolvers-browser-broadcast-attendee",212401:"add-thread-member-dialog-entity-view",212425:"ja-jp-audience-view-dialog-js",212521:"zh-cn-presence-js",212882:"categories-et-ee-json",212922:"uk-ua-extensibility-js",213230:"ja-jp-live-persona-card-js",213262:"pl-pl-message-escalate-dialog-js",213345:"pt-br-framework-js",213862:"data-resolvers-tfl-homepage",214169:"data-resolvers-browser-style-my-room",214495:"r_data-resolvers-share-to-teams",214607:"en-gb-live-persona-editor-js",214699:"r_data-resolvers-meeting-templates",214744:"da-dk-mtma-missed-notifications-js",214988:"services-example",215424:"et-ee-search-js",215525:"mk-mk-queues-js",215674:"lv-lv-rsc-application-permissions-js",215710:"az-latn-az-guardians-js",215734:"lt-lt-datepicker-js",215738:"az-latn-az-video-message-js",215793:"services-share",215842:"el-gr-meeting-collaboration-js",215994:"ru-ru-meeting-analytics-js",216147:"components-screen-recorder102",216161:"bg-bg-wiki-js",216166:"fi-fi-artifacts-platform-js",216244:"sr-latn-rs-gallery-js",216266:"InformationProtectionStrings28",216366:"data-resolvers-chat",216419:"metaos-core",216489:"sht-cortextopictypeswebstrings_sr-cyrl",216764:"pt-br-presence-js",216822:"uk-ua-unsupported-browser-js",217117:"vi-vn-meeting-flyout-js",217195:"nn-no-biometric-enrollment-js",217439:"nl-nl-freemium-js",217526:"zh-cn-auth-js",217602:"fi-fi-tfl-homepage-js",217609:"ru-ru-people-targeting-js",217646:"da-dk-coach-report-js",217672:"es-es-lightbox-js",217807:"en-gb-edu-js",218027:"scaht-searchconvergedanswerteamsstrings-uk",218100:"de-de-video-message-js",218129:"diagnostics-panel-renderer",218167:"he-il-extensibility-room-remote-js",218288:"pt-br-recurrence-js",218376:"ka-ge-mtma-missed-notifications-js",218440:"gl-es-unified-search-js",218484:"bg-strings-jsonThinRes",218519:"r_data-resolvers-activity-bell-count",219081:"es-es-hololens-js",219259:"da-dk-auth-js",219300:"ca-es-valencia-webinar-js",219574:"da-dk-rsc-application-permissions-js",219673:"pt-pt-meeting-bot-js",219847:"de-de-datepicker-js",219850:"az-latn-az-extensibility-room-remote-js",220112:"ja-jp-people-js",220493:"cy-gb-meeting-recap-js",220516:"hi-in-messaging-js",220996:"ar-sa-share-in-meetings-js",221045:"fil-ph-calendar-js",221165:"fr-fr-share-to-teams-js",221247:"webrec2-language-bs-latn-ba",221253:"hu-hu-messaging-js",221264:"hostUxStrings30",221265:"ca-es-valencia-campaign-notifications-js",221477:"InformationProtectionStrings73",221519:"fr-fr-share-to-teams-third-party-js",221816:"uk-ua-breakout-rooms-js",221985:"InformationProtectionStrings62",222032:"en-us-embed-js",222073:"LazyFluidMessageBannerStack",222316:"en-gb-extensibility-room-remote-js",222348:"fns42",222479:"ot",222848:"tr-tr-meeting-meet-app-js",222856:"zh-tw-search-js",222874:"fr-ca-activity-js",222877:"ka-ge-tfl-homepage-js",223041:"ca-es-valencia-guardians-js",223071:"gl-es-live-persona-card-js",223245:"hu-hu-help-js",223341:"ca-es-valencia-calling-js",223454:"kk-kz-coach-report-js",223490:"search-answer-override",223548:"is-is-whats-new-js",223828:"webrec2-wasmcv",223845:"cy-gb-calling-js",223935:"services-developer-switchers",224541:"components-screen-recorder100",224632:"hostUxStrings7",224925:"es-es-webinar-js",224946:"et-ee-hololens-js",224984:"is-is-pre-core-js",225160:"components-calling-anon-meeting-end-screen",225215:"is-is-calendar-js",225445:"tr-tr-simple-collab-js",225570:"th-th-wiki-js",225604:"th-th-autosuggest-js",226099:"sv-se-artifacts-platform-js",226296:"pl-pl-share-in-meetings-js",226381:"id-id-artifacts-platform-js",226461:"is-is-queues-js",226634:"hi-in-virtual-events-js",226741:"fil-ph-coach-report-js",226835:"ko-kr-meeting-options-js",226842:"core-services-settings-debug",227234:"ja-jp-teams-and-channels-js",227471:"fr-fr-biometric-enrollment-js",227936:"ja-jp-premium-benefits-js",228048:"fns50",228443:"sht-searchanswerteamsstrings_es-fil",228743:"bg-bg-audience-view-dialog-js",229039:"eu-es-guardians-js",229117:"sht-cortextopictypeswebstrings_pt-pt",229154:"nl-nl-message-escalate-dialog-js",229349:"fr-fr-gallery-js",229364:"fi-fi-share-in-meetings-js",229533:"hostUxStrings38",229539:"sht-cortextopictypeswebstrings_el",229652:"tr-tr-meet-for-work-js",229959:"components-screen-recorder108",229997:"fi-fi-rsc-application-permissions-js",230040:"unified-bar-container-manager",230075:"ka-ge-people-picker-js",230318:"hostDefaultsStrings27",230470:"ko-kr-datepicker-js",230523:"it-it-premium-benefits-js",230897:"pl-pl-share-to-teams-outlook-addin-js",230915:"es-es-video-message-js",231100:"cy-gb-edu-js",231588:"nb-no-errors-js",231852:"cy-gb-guardians-js",231885:"uk-ua-semantic-object-js",231914:"fil-ph-tfl-onboarding-js",232019:"sl-si-smart-device-js",232064:"pt-pt-audience-view-dialog-js",232334:"react-virtualized-tree-list",232349:"tr-tr-extensibility-ptz-extension-js",232421:"mk-mk-errors-js",232805:"et-ee-health-js",233e3:"es-mx-video-capture-js",233025:"fns56",233051:"mk-mk-live-persona-card-js",233061:"zh-cn-live-persona-editor-js",233364:"ka-ge-meeting-room-console-js",233408:"ca-es-valencia-tfl-onboarding-js",233586:"fr-fr-simple-collab-js",233710:"fr-ca-welcome-bot-js",233745:"data-resolvers-connectors",234396:"r_data-resolvers-browser-files",234786:"id-id-url-preview-js",234794:"eu-es-people-app-js",234848:"cs-cz-jana-js",234914:"hi-in-freemium-upgrade-js",235069:"gl-es-share-to-teams-js",235095:"pt-br-channels-js",235129:"lt-lt-search-js",235430:"services-external-accounts-response",235512:"az-latn-az-files-js",235709:"is-is-unified-search-js",235865:"pt-br-cast-js",235921:"gl-es-avatar-js",236076:"en-us-freemium-js",236345:"nb-no-hololens-js",236376:"ro-ro-auth-js",236388:"el-gr-simple-collab-js",236636:"pt-br-communities-js",236663:"en-gb-meet-for-work-js",236754:"en-gb-lms-integration-js",236830:"he-il-message-escalate-dialog-js",236840:"nb-no-host-controls-js",237264:"ko-kr-live-persona-editor-js",237271:"ca-es-valencia-edu-js",237456:"ja-jp-meeting-collaboration-js",237572:"sht-searchanswerteamsstrings_es-gl",237591:"hostDefaultsStrings69",237775:"en-us-webinar-js",237946:"bg-bg-recurrence-js",238020:"pt-pt-embed-js",238069:"pl-pl-digital-signage-js",238298:"fr-ca-smart-device-js",238456:"ca-es-valencia-cast-js",238524:"lv-lv-meeting-collaboration-js",238535:"sht-cortextopictypeswebstrings_ha-latn-ng",239578:"sq-al-extensibility-ptz-extension-js",239620:"bg-bg-person-js",239717:"data-resolvers-share-to-teams",239743:"hr-hr-people-js",240090:"sk-sk-teams-insider-js",240276:"kk-kz-meeting-meet-app-js",240411:"mk-mk-sv-flyout-js",240651:"he-il-desktop-js",240790:"mk-mk-people-targeting-js",240855:"hi-in-shortcut-js",240863:"lv-lv-meeting-bot-js",241095:"el-gr-share-to-teams-js",241196:"pt-pt-people-targeting-js",241348:"sht-searchanswerteamsstrings_es-eu",241384:"fr-ca-compose-js",241557:"platform-app-metaos-service",241609:"pt-br-url-preview-js",241852:"ru-ru-gallery-js",242291:"zh-cn-welcome-bot-js",242411:"sht-searchanswerteamsstrings_es-ka",242636:"categories-uz-latn-uz-json",242917:"components-screen-recorder46",243069:"sl-si-calendar-js",243223:"otlang60",243280:"cs-cz-pre-core-js",243301:"cy-gb-meeting-analytics-js",243364:"hostUxStrings19",243393:"lt-lt-avatar-js",244029:"de-de-people-app-js",244299:"tr-tr-people-targeting-js",244546:"r_data-resolvers-health-scenarios",244680:"da-DK-UiStrings-json",244690:"InformationProtectionStrings74",244775:"ko-KR-UiStrings-json",244858:"r_data-resolvers-calendar",245171:"ar-sa-meet-for-work-js",245247:"id-id-meeting-meet-app-js",245372:"cy-gb-errors-js",245974:"nb-no-lightbox-js",246053:"tr-tr-person-js",246157:"hi-in-meeting-analytics-js",246383:"data-resolvers-browser-meeting-scheduling-service",246810:"tr-tr-semantic-object-js",246814:"it-it-comment-stream-js",247339:"hostUxStrings11",247410:"hi-in-help-js",247533:"it-it-discover-surface-js",247632:"pluginDebug",248126:"lt-lt-meet-for-work-js",248136:"is-is-comment-stream-js",248432:"pt-br-share-to-teams-js",248447:"InformationProtectionStrings34",248492:"en-us-contacts-js",248549:"sk-sk-meeting-apis-app-js",248708:"ja-jp-meeting-meet-app-js",248735:"config-dod",249153:"is-is-share-to-teams-third-party-js",249203:"r_data-resolvers-browser-meeting-room",249319:"kk-kz-help-js",249394:"categories-en-us-json",249424:"sr-latn-rs-virtual-events-js",249438:"vi-vn-tfl-homepage-js",249504:"el-gr-nova-js",249707:"lv-lv-gallery-js",249839:"ka-ge-survey-js",249882:"hr-hr-virtual-events-js",249996:"he-il-virtual-events-js",250063:"categories-bs-latn-ba-json",250148:"az-latn-az-autosuggest-js",250228:"ka-ge-autosuggest-js",250432:"scaht-cortextopictypeswebstrings_zh-hant",250449:"bg-bg-shortcut-js",250500:"ka-ge-gallery-js",250612:"hu-hu-health-js",250792:"ru-ru-datepicker-js",250818:"cy-gb-feedback-js",251074:"services-locked-teams",251083:"sht-cortextopictypeswebstrings_be-by",251367:"lt-lt-recurrence-js",251425:"services-fluid",251452:"webrec2-language-sl",251573:"ja-jp-growth-js",251600:"fi-fi-share-to-teams-third-party-js",252018:"eu-es-rsc-application-permissions-js",252164:"he-il-share-to-teams-js",252405:"scaht-cortextopictypeswebstrings_te",252483:"lv-lv-extensibility-ptz-extension-js",252797:"hostDefaultsStrings55",252885:"zh-tw-mtma-missed-notifications-js",253046:"hostUxStrings84",253108:"lv-lv-lightbox-js",253119:"createNewModule",253436:"pt-pt-phonelink-sms-js",253506:"supermassive-incremental-link",253546:"zh-tw-edu-js",254166:"fns20",254185:"sq-al-meet-for-work-js",254419:"scaht-cortextopictypeswebstrings_as-in",254431:"hu-hu-video-capture-js",254641:"ca-es-valencia-meet-for-work-js",254692:"services-toast-image",254723:"az-latn-az-smart-device-js",254789:"ca-es-valencia-share-to-teams-third-party-js",254903:"scaht-searchconvergedanswerteamsstrings-hu",254964:"services-discover-surface-feedback",255046:"components-screen-recorder54",255278:"gl-es-people-targeting-js",255346:"nb-no-carousel-multi-card-js",255428:"ro-ro-breakout-rooms-js",256166:"data-resolvers-browser-meeting-bot",256370:"vi-vn-health-js",256485:"fil-ph-meeting-recap-js",256657:"components-customize-reactions",256759:"id-id-digital-signage-js",257010:"is-is-meeting-collaboration-js",257077:"mk-mk-people-js",257246:"en-gb-digital-signage-js",257292:"gl-es-extensibility-room-remote-js",257298:"sv-se-meeting-options-js",257380:"it-it-guardians-js",257610:"en-us-toast-notifications-js",257611:"fi-fi-message-escalate-dialog-js",257666:"sk-sk-simple-collab-js",257673:"ka-ge-meeting-flyout-js",257687:"az-latn-az-unsupported-browser-js",257931:"ar-sa-freemium-upgrade-js",257936:"vi-vn-extensibility-js",258263:"ja-jp-errors-js",258466:"sht-searchanswerteamsstrings_es-hy",258711:"gl-es-health-js",258715:"ko-kr-esp-js",258717:"tr-tr-unsupported-browser-js",258789:"it-it-datepicker-js",258830:"et-ee-people-targeting-js",258877:"sht-searchanswerteamsstrings_es-hi",259010:"sr-latn-rs-campaign-notifications-js",259164:"services-meeting-recap-working-set-files",259465:"categories-fi-fi-json",259659:"ca-es-valencia-meeting-flyout-js",259723:"pt-br-meeting-collaboration-js",259844:"compose-copilot-container",259877:"es-mx-tfl-homepage-js",260020:"is-is-rsc-application-permissions-js",260067:"sr-latn-rs-digital-signage-js",260371:"pl-pl-unsupported-browser-js",260438:"lt-lt-cast-js",260457:"hr-hr-files-js",260509:"InformationProtectionStrings43",260630:"nn-no-welcome-bot-js",260758:"r_data-resolvers-browser-meeting-artifacts",260891:"discover-surface-error-main",261006:"cy-gb-live-persona-card-js",261742:"eu-es-meeting-options-js",261784:"sht-cortextopictypeswebstrings_hu",261809:"sv-se-coach-report-js",262027:"guardians-post-type",262199:"nn-NO-UiStrings-json",262262:"sv-se-people-app-js",262283:"uk-ua-avatar-js",262475:"fns17",262895:"el-gr-coach-report-js",262995:"vi-vn-recurrence-js",263038:"components-calling-healthy-tips",263067:"sr-latn-rs-share-in-meetings-js",263140:"eu-es-mtma-missed-notifications-js",263311:"bs-latn-ba-strings-jsonThinRes",263408:"et-ee-share-in-meetings-js",263409:"pt-pt-esp-js",263542:"uk-ua-carousel-multi-card-js",263573:"es-mx-messaging-js",263732:"ro-ro-people-app-js",263907:"sht-searchanswerteamsstrings_es-bg",263998:"scaht-searchconvergedanswerteamsstrings-zh-hans",264496:"es-es-share-in-meetings-js",264509:"sl-si-teams-and-channels-js",264602:"scaht-cortextopictypeswebstrings_az-latn-az",264710:"ro-ro-pre-core-js",264759:"it-it-search-js",264779:"sht-cortextopictypeswebstrings_he",264796:"sl-si-channels-js",264815:"fil-ph-errors-js",265042:"ru-ru-message-escalate-dialog-js",265106:"ja-jp-funstuff-js",265130:"ca-es-digital-signage-js",265360:"pl-pl-campaign-notifications-js",265420:"kk-kz-framework-js",265630:"pt-pt-strings-jsonThinRes",265735:"sv-se-edu-js",265996:"th-th-funstuff-js",266215:"en-us-messaging-js",266281:"fns26",266302:"ca-es-valencia-esp-js",266711:"scaht-searchconvergedanswerteamsstrings-sw",266828:"id-id-video-message-js",267041:"ca-es-edu-js",267099:"hostDefaultsStrings84",267226:"ro-ro-virtual-events-js",267228:"it-IT-UiStrings-json",267296:"ro-ro-people-picker-js",267415:"zh-tw-meeting-room-console-js",267509:"he-il-activity-js",267553:"sl-si-jana-js",267623:"en-us-meeting-analytics-js",267996:"r_data-resolvers-appbar",267998:"hu-hu-meeting-options-js",268204:"zh-tw-simple-collab-js",268342:"uk-ua-mtma-missed-notifications-js",268355:"ca-es-valencia-lightbox-js",268446:"hostDefaultsStrings80",268462:"data-resolvers-vdi",268756:"es-mx-esp-js",268782:"vi-vn-edu-js",269222:"sv-se-share-in-meetings-js",269337:"eu-es-meeting-recap-js",269541:"components-screen-recorder32",269548:"ar-sa-virtual-events-js",269586:"pt-br-meeting-analytics-js",269775:"scaht-searchconvergedanswerteamsstrings-he",269928:"nb-no-search-js",270410:"calling-devices-panel",270621:"es-es-meeting-stream-app-js",270649:"kk-kz-phonelink-sms-js",270767:"fil-ph-avatar-js",270912:"hr-hr-live-persona-editor-js",271254:"zh-cn-communities-js",271312:"hu-hu-digital-signage-js",271497:"ca-es-gallery-js",271599:"sht-cortextopictypeswebstrings_ml",271650:"sq-al-meeting-apis-app-js",271722:"sht-cortextopictypeswebstrings_sw",271732:"sk-sk-audience-view-dialog-js",271812:"nn-no-people-app-js",271972:"ko-kr-meeting-collaboration-js",272252:"et-ee-people-picker-js",272457:"fil-ph-virtual-events-js",272526:"sht-searchanswerteamsstrings_es-kok",272734:"discover-surface-empty-main",272871:"sq-al-biometric-enrollment-js",272913:"fil-ph-pre-core-js",272976:"pt-pt-compose-js",273104:"ka-ge-meeting-options-js",273113:"hu-hu-framework-js",273130:"it-it-campaign-notifications-js",273423:"tr-tr-mtma-missed-notifications-js",273754:"vi-vn-biometric-enrollment-js",273806:"services-giphy",273824:"fns79",273836:"itemsettileslist",274225:"az-latn-az-telemetry-js",274511:"he-il-welcome-bot-js",274543:"categories-ne-np-json",274580:"InformationProtectionStrings13",274873:"en-gb-simple-collab-js",275174:"sht-searchanswerteamsstrings_es-ja",275221:"ca-es-help-js",275287:"otlang86",275292:"hostUxStrings4",275578:"el-gr-search-js",275782:"tr-tr-hololens-js",275948:"ro-ro-feedback-js",275996:"scaht-searchconvergedanswerteamsstrings-lo-la",276087:"r_data-resolvers-tenant-membership",276518:"r_data-resolvers-immersive-view",276673:"sk-sk-calling-js",276958:"sq-al-auth-js",277118:"th-th-compose-js",277412:"services-third-party-calendar",277419:"kk-kz-url-preview-js",277639:"ar-strings-jsonThinRes",278225:"gl-es-communities-js",278522:"eu-es-telemetry-js",278895:"fi-fi-framework-js",278910:"InformationProtectionStrings82",278975:"he-il-video-message-js",278996:"data-resolvers-meeting-templates",279132:"eu-es-autosuggest-js",279229:"is-is-coach-report-js",279281:"da-dk-host-controls-js",279403:"sv-se-extensibility-js",279552:"video-context",279568:"et-ee-video-capture-js",279646:"lv-lv-people-targeting-js",279673:"card-shared-header",279764:"cy-gb-sv-flyout-js",279849:"cs-cz-mtma-missed-notifications-js",279932:"data-resolvers-people-targeting",280180:"nb-no-live-persona-editor-js",280359:"ja-jp-help-js",280412:"sq-al-feedback-js",280509:"mk-mk-meeting-recap-js",280574:"data-resolvers-taskbar",280579:"data-resolvers-notifications",280605:"vi-vn-digital-signage-js",280664:"zh-tw-strings-jsonThinRes",280680:"zh-tw-files-js",280886:"fil-ph-meeting-room-console-js",281374:"fi-fi-people-app-js",281415:"vi-vn-chat-list-js",281439:"ca-es-valencia-lms-integration-js",281728:"ro-ro-semantic-object-js",281894:"et-ee-meeting-bot-js",281978:"az-latn-az-meeting-collaboration-js",282009:"onecamera-locale-ka",282033:"sht-searchanswerteamsstrings_es-tr",282184:"eu-es-activity-js",282249:"cs-cz-premium-benefits-js",282280:"pt-br-autosuggest-js",282534:"az-latn-az-video-capture-js",282596:"hostDefaultsStrings61",282789:"sht-teams-paaanswers",282850:"onecamera-locale-mk",283035:"calling-cdl-calling-package-loader",283285:"es-mx-meeting-apis-app-js",283364:"nn-no-artifacts-platform-js",283385:"ka-ge-lms-integration-js",283601:"vi-vn-shortcuts-js",283938:"et-ee-jana-js",283976:"kk-kz-live-persona-editor-js",284004:"components-calling-quality-feedback",284022:"ka-ge-freemium-js",284100:"nn-no-pre-core-js",284323:"he-il-teams-and-channels-js",284463:"es-es-pre-core-js",284678:"pl-pl-communities-js",284843:"ar-sa-teams-insider-js",284863:"th-th-gallery-js",284870:"sht-cortextopictypeswebstrings_bn-in",285108:"vi-vn-embed-js",285260:"sht-searchanswerteamsstrings_es-sr-cyrl-ba",285267:"vi-vn-artifacts-platform-js",285351:"nn-no-share-to-teams-js",285538:"sht-cortextopictypeswebstrings_kok",285539:"ro-ro-survey-js",285818:"id-id-cast-js",286190:"r_data-resolvers-search-prefetch",286813:"pt-br-message-escalate-dialog-js",286973:"kk-KZ-UiStrings-json",287071:"ja-jp-video-message-js",287683:"en-gb-gallery-js",287688:"ca-es-share-to-teams-third-party-js",287988:"eu-es-meeting-bot-js",288301:"eu-es-framework-js",288376:"el-gr-welcome-bot-js",288413:"th-th-presence-js",288421:"scaht-cortextopictypeswebstrings_ja",288470:"vi-vn-meeting-room-console-js",288475:"services-tenant-analytics",288478:"sr-latn-rs-video-capture-js",288542:"data-resolvers-external-accounts",288771:"InformationProtectionStrings50",288891:"pt-pt-settings-js",289142:"otlang64",289232:"et-ee-semantic-object-js",289297:"az-latn-az-calendar-js",289304:"fr-fr-extensibility-room-remote-js",289526:"hostDefaultsStrings81",289682:"fr-fr-unified-search-js",289707:"he-il-person-js",289817:"ro-ro-funstuff-js",290080:"InformationProtectionStrings37",290134:"ca-es-shortcut-js",290378:"data-resolvers-external-accounts-response",290799:"lt-lt-biometric-enrollment-js",291343:"sr-latn-rs-meeting-options-js",291346:"ca-es-people-app-js",291443:"data-resolvers-cypress-only",291550:"r_data-resolvers-hosted-web-content-log",291600:"otlang20",291916:"sv-se-auth-js",291920:"fil-ph-biometric-enrollment-js",292105:"eu-es-video-capture-js",292406:"sk-sk-broadcast-js",292538:"da-dk-files-js",292751:"fr-ca-virtual-events-js",292831:"sv-se-meeting-meet-app-js",292866:"de-de-share-to-teams-outlook-addin-js",292958:"cy-gb-unified-search-js",292978:"pt-pt-auth-js",292998:"scaht-searchconvergedanswerteamsstrings-nl",293050:"hu-hu-channels-js",293072:"scaht-cortextopictypeswebstrings_kok",293186:"hostUxStrings58",293465:"hr-hr-embed-js",293506:"ar-sa-freemium-js",293740:"services-cmd-meeting-intelligence",293783:"fr-fr-files-js",293946:"gl-es-jana-js",294157:"web_recorder_v2",294169:"en-us-shortcut-js",294263:"data-resolvers-communities",294267:"sht-cortextopictypeswebstrings_nn-no",294553:"ca-es-valencia-broadcast-js",295014:"workflow-flyout-container",295252:"ja-jp-meet-for-work-js",295295:"he-il-recurrence-js",295417:"ca-Es-VALENCIA-UiStrings-json",295422:"he-il-compose-js",295590:"ro-ro-meeting-bot-js",295598:"id-id-host-controls-js",295746:"da-strings-jsonThinRes",295797:"km-KH-UiStrings-json",295824:"es-es-health-js",295890:"is-is-funstuff-js",296327:"he-il-calendar-js",296386:"data-resolvers-bots-platform-worker",296728:"hostUxStrings50",296767:"he-il-meeting-flyout-js",297038:"ko-kr-guardians-js",297071:"sv-se-guardians-js",297136:"en-gb-lightbox-js",297139:"es-es-simple-collab-js",297276:"nn-no-calling-js",297399:"sht-searchanswerteamsstrings_es-ne-np",297816:"sht-searchanswerteamsstrings_es-da",297884:"fi-fi-channels-js",298059:"sv-se-meeting-stream-app-js",298068:"holographic-toolbar",298150:"nb-no-people-targeting-js",298216:"he-il-broadcast-js",298696:"ro-ro-discover-surface-js",298758:"lt-lt-meeting-recap-js",299041:"lv-lv-digital-signage-js",299116:"ja-jp-health-js",299189:"hu-hu-people-app-js",299224:"ca-es-valencia-video-message-js",299306:"hostUxStrings60",299351:"uk-ua-digital-signage-js",299366:"ja-jp-survey-js",299382:"en-gb-calendar-js",299451:"gl-es-framework-js",299567:"he-il-meeting-options-js",299677:"gl-es-extensibility-ptz-extension-js",299785:"ar-sa-meeting-apis-app-js",299893:"zh-cn-growth-js",300374:"es-es-sv-flyout-js",300420:"ar-sa-meeting-options-js",300524:"es-es-people-picker-js",300866:"categories-hy-am-json",301097:"nn-no-premium-benefits-js",301252:"az-latn-az-tfl-homepage-js",301267:"nn-no-video-message-js",301294:"he-il-edu-js",301315:"bg-bg-share-to-teams-outlook-addin-js",301420:"data-resolvers-appbar",301741:"teams-compose-box",301930:"hu-hu-freemium-js",302168:"sht-cortextopictypeswebstrings_mi-nz",302518:"el-gr-meeting-stream-app-js",302621:"cs-cz-audience-view-dialog-js",302653:"services-file-download-manager",302667:"mk-mk-live-persona-editor-js",302696:"uk-ua-teams-insider-js",302747:"en-gb-share-to-teams-third-party-js",302773:"ca-es-valencia-shortcuts-js",302959:"r_data-resolvers-capiv3-contacts-state",303014:"lt-lt-sv-flyout-js",303061:"he-il-webinar-js",303105:"fr-fr-artifacts-platform-js",303220:"webrec2-language-it",303241:"sv-se-live-persona-card-js",303460:"ms-strings-jsonThinRes",303762:"components-screen-recorder64",303821:"en-gb-teams-and-channels-js",303919:"cy-gb-contacts-js",304106:"nn-no-video-capture-js",304195:"sv-se-nova-js",304212:"InformationProtectionStrings75",304523:"sl-si-share-to-teams-third-party-js",304596:"data-resolvers-meeting-summary-qna-history",304609:"services-policies",304952:"es-es-comment-stream-js",305036:"hi-in-extensibility-js",305081:"he-il-meeting-analytics-js",305129:"mk-mk-edu-js",305142:"sl-si-messaging-js",305264:"nb-no-unified-search-js",305271:"shell-app",305303:"nn-no-nova-js",305406:"sl-si-comment-stream-js",305551:"ca-es-extensibility-js",305652:"tr-tr-video-message-js",306157:"ka-ge-biometric-enrollment-js",306158:"cy-gb-desktop-js",306223:"eu-es-channels-js",306292:"es-es-welcome-bot-js",306529:"bg-bg-breakout-rooms-js",306644:"el-gr-survey-js",306760:"ka-ge-digital-signage-js",306978:"ca-es-share-in-meetings-js",307290:"categories-fa-ir-json",307298:"gl-es-meeting-apis-app-js",307473:"ka-ge-person-js",307494:"en-us-gallery-js",307581:"ka-ge-channels-js",307674:"eu-es-esp-js",307738:"precompiled-screen-recorder-web-worker",307828:"sk-sk-share-to-teams-js",308019:"is-is-video-message-js",308063:"categories-gl-es-json",308104:"sv-se-files-js",308398:"ms-MY-UiStrings-json",308418:"pt-br-unified-search-js",308640:"ja-jp-hololens-js",308687:"data-resolvers-meeting-analytics",308690:"kk-kz-lightbox-js",308725:"r_data-resolvers-browser-webinar",309051:"scaht-cortextopictypeswebstrings_hr",309119:"af-ZA-UiStrings-json",309164:"et-ee-calendar-js",309235:"nl-nl-growth-js",309342:"services-io-data-smb-user-intent",309711:"ar-sa-meeting-meet-app-js",309779:"fi-fi-health-js",309800:"data-resolvers-app-usage-details",310050:"cy-gb-survey-js",310262:"id-id-hololens-js",310446:"da-dk-meeting-stream-app-js",310612:"sr-latn-rs-feedback-js",310683:"data-resolvers-activity",310861:"ca-es-cast-js",311115:"en-us-nova-js",311165:"de-de-freemium-js",311313:"zh-tw-contacts-js",311338:"scaht-cortextopictypeswebstrings_gd-gb",311358:"vi-vn-virtual-events-js",311368:"navigationPanel",311602:"ja-jp-autosuggest-js",311794:"nn-no-health-js",312064:"scaht-searchconvergedanswerteamsstrings-az-latn-az",312327:"lv-lv-semantic-object-js",312417:"nb-no-feedback-js",312727:"en-gb-webinar-js",312773:"tr-tr-autosuggest-js",312939:"mk-mk-audience-view-dialog-js",313011:"cs-cz-carousel-multi-card-js",313170:"fns76",313279:"pt-br-chat-list-js",313304:"ca-es-smart-device-js",313311:"hostDefaultsStrings57",313417:"sr-latn-rs-video-message-js",313459:"sr-latn-rs-queues-js",313563:"id-id-errors-js",313615:"fr-fr-nova-js",313795:"fil-ph-nova-js",313832:"mt-MT-UiStrings-json",314149:"zh-tw-live-persona-editor-js",314263:"en-gb-phonelink-sms-js",314457:"ru-ru-url-preview-js",314717:"P2PFilesListContainer",314748:"onecamera-locale-is",314925:"lt-lt-meeting-apis-app-js",315084:"bg-bg-errors-js",315427:"nn-no-compose-js",315614:"sv-se-discover-surface-js",315622:"is-is-smart-device-js",315811:"da-dk-meeting-apis-app-js",315850:"it-it-meeting-apis-app-js",315956:"ru-ru-welcome-bot-js",315961:"el-gr-people-js",316146:"sl-si-unified-search-js",316439:"en-gb-broadcast-js",316673:"pt-pt-activity-js",316711:"mk-mk-semantic-object-js",316907:"components-screen-recorder76",316931:"cs-cz-whats-new-js",316953:"categories-lv-lv-json",316968:"ca-es-welcome-bot-js",317120:"ka-ge-presence-js",317323:"gl-es-datepicker-js",317438:"scaht-searchconvergedanswerteamsstrings-gl",317601:"onecamera-locale-fr-ca",317627:"az-latn-az-queues-js",317915:"zh-cn-feedback-js",317961:"sv-se-smart-device-js",318049:"nn-no-semantic-object-js",318112:"de-de-embed-js",318128:"it-it-smart-device-js",318194:"ka-ge-contacts-js",318689:"hu-hu-message-escalate-dialog-js",318806:"pt-br-meeting-flyout-js",318838:"hr-hr-meeting-analytics-js",318888:"sv-se-teams-insider-js",318941:"fr-fr-whats-new-js",318968:"cs-cz-meeting-analytics-js",319002:"components-screen-recorder70",319049:"scaht-searchconvergedanswerteamsstrings-sl",319085:"ka-ge-shortcut-js",319113:"sl-si-cast-js",319154:"is-is-meeting-options-js",319420:"hr-hr-autosuggest-js",319446:"hi-in-simple-collab-js",319648:"ja-jp-channels-js",319676:"categories-rw-rw-json",319722:"ca-es-extensibility-ptz-extension-js",319870:"tr-strings-jsonThinRes",319974:"onecamera-locale-pt-pt",320174:"sl-si-carousel-multi-card-js",320271:"mk-mk-biometric-enrollment-js",320406:"fns60",320427:"calling-app-prejoin-v1",320457:"bg-bg-unsupported-browser-js",320464:"ca-es-avatar-js",320483:"is-is-settings-js",320555:"ru-ru-meeting-recap-js",320585:"gl-es-unsupported-browser-js",321003:"ca-es-meeting-meet-app-js",321051:"hi-in-lightbox-js",321141:"categories-eu-es-json",321149:"fr-ca-help-js",321437:"uk-ua-sv-flyout-js",321487:"ru-ru-webinar-js",321571:"fns68",321672:"sht-searchanswerteamsstrings_es-lv",321881:"hi-in-meeting-meet-app-js",322117:"ka-ge-meeting-collaboration-js",322216:"sq-al-live-persona-editor-js",322466:"kk-kz-carousel-multi-card-js",322473:"ka-ge-people-targeting-js",322499:"fns46",322540:"data-resolvers-browser-lms-integration",322581:"services-lms-integration",322610:"ar-sa-communities-js",322825:"scaht-searchconvergedanswerteamsstrings-mt-mt",322845:"ar-sa-webinar-js",322999:"scaht-cortextopictypeswebstrings_or",323134:"sht-cortextopictypeswebstrings_vi",323172:"chat-pane-image",323233:"sl-si-funstuff-js",323817:"uk-ua-esp-js",323987:"mk-mk-meeting-collaboration-js",324001:"he-il-meeting-stream-app-js",324138:"es-mx-errors-js",324348:"is-is-recurrence-js",324494:"is-is-lms-integration-js",324622:"ko-kr-meeting-bot-js",324669:"en-gb-extensibility-js",324697:"et-ee-freemium-upgrade-js",324784:"fr-ca-meeting-meet-app-js",324857:"sv-se-url-preview-js",324925:"config-gcc",325021:"en-us-phonelink-sms-js",325064:"es-mx-lms-integration-js",325175:"sht-searchanswerteamsstrings_es-gu",325223:"hi-in-digital-signage-js",325383:"ko-kr-autosuggest-js",325428:"sht-thor-proactive-search-query",325585:"data-resolvers-channel-info-pane",325603:"r_data-resolvers-targeting-hierarchy",325814:"lv-lv-unified-search-js",326427:"ro-ro-meeting-recap-js",326594:"lv-lv-artifacts-platform-js",326722:"eu-es-share-to-teams-outlook-addin-js",326801:"zh-tw-queues-js",327059:"hu-hu-breakout-rooms-js",327076:"hu-hu-welcome-bot-js",327081:"ja-jp-contacts-js",327082:"uk-ua-tfl-onboarding-js",327340:"r_data-resolvers-extensibility-app-picker",327525:"cs-cz-meeting-apis-app-js",327724:"de-de-digital-signage-js",327735:"fi-fi-activity-js",327853:"hostDefaultsStrings73",328141:"fil-ph-gallery-js",328281:"webrec2-language-ka",328403:"scaht-searchconvergedanswerteamsstrings-vi",328436:"tr-tr-meeting-analytics-js",328457:"otlang90",328502:"en-gb-freemium-js",328508:"fr-ca-webinar-js",328571:"hr-hr-contacts-js",328580:"lv-lv-calendar-js",328662:"el-gr-edu-js",328985:"ja-jp-sv-flyout-js",329094:"pt-pt-people-app-js",329123:"bg-bg-semantic-object-js",329294:"pt-br-embed-js",329392:"zh-cn-shortcut-js",329589:"pt-pt-desktop-js",330200:"id-id-compose-js",330424:"hu-hu-meeting-apis-app-js",330467:"zh-tw-shortcut-js",330480:"InformationProtectionStrings45",330725:"en-us-people-app-js",330768:"es-mx-datepicker-js",331224:"cs-cz-biometric-enrollment-js",331625:"ru-ru-meet-for-work-js",331986:"hostUxStrings74",332107:"fr-ca-sv-flyout-js",332160:"fi-fi-coach-report-js",332275:"lv-lv-premium-benefits-js",332295:"pl-pl-welcome-bot-js",332303:"pt-pt-whats-new-js",332313:"vi-vn-audience-view-dialog-js",332403:"cs-cz-edu-js",332701:"lt-lt-meeting-analytics-js",332999:"nn-no-share-in-meetings-js",333004:"th-th-smart-device-js",333012:"hr-hr-share-to-teams-outlook-addin-js",333089:"el-gr-live-persona-editor-js",333176:"sht-searchanswerteamsstrings_es-prs",333433:"es-es-premium-benefits-js",333515:"lt-lt-broadcast-js",333577:"el-gr-gallery-js",333684:"sht-searchanswerteamsstrings_es-bn-in",333785:"sq-al-share-to-teams-js",333802:"pl-pl-phonelink-sms-js",334137:"hi-in-pre-core-js",334170:"fr-ca-shortcut-js",334343:"scaht-cortextopictypeswebstrings_mr",334406:"vi-vn-share-to-teams-js",334581:"ru-ru-meeting-options-js",334704:"r_data-resolvers-yammer-notification",334723:"th-th-embed-js",334731:"sl-si-nova-js",334794:"ja-jp-live-persona-editor-js",334850:"hr-hr-whats-new-js",335101:"fr-fr-autosuggest-js",335171:"gl-es-auth-js",335225:"nl-nl-guardians-js",335251:"sl-si-auth-js",335255:"sr-Latn-RS-UiStrings-json",335376:"ta-IN-UiStrings-json",335413:"components-stream-camera",335438:"zh-tw-recurrence-js",335542:"id-id-people-app-js",335902:"hu-hu-simple-collab-js",336029:"en-gb-health-js",336037:"webrec2-language-lv",336217:"sht-cortextopictypeswebstrings_mt-mt",336354:"pl-pl-simple-collab-js",336463:"lv-lv-health-js",336826:"sk-sk-search-js",336907:"el-gr-semantic-object-js",336934:"mk-mk-welcome-bot-js",336961:"nl-nl-extensibility-ptz-extension-js",336969:"cs-cz-broadcast-js",337042:"r_data-resolvers-browser-calls-screen",337062:"ka-ge-host-controls-js",337085:"sht-cortextopictypeswebstrings_hy",337244:"ko-kr-embed-js",337301:"data-resolvers-files",337427:"es-es-message-escalate-dialog-js",337793:"fns19",337884:"sr-latn-rs-meet-for-work-js",338059:"vi-vn-meeting-analytics-js",338259:"categories-pt-br-json",338299:"onecamera-locale-sk",338586:"categories-uk-ua-json",338625:"scaht-cortextopictypeswebstrings_lt",338734:"is-is-growth-js",339008:"bg-bg-share-to-teams-third-party-js",339122:"fi-fi-meeting-analytics-js",339195:"el-gr-whats-new-js",339410:"sht-searchanswerteamsstrings_es-gd-gb",339441:"ko-kr-smart-device-js",339501:"kk-kz-funstuff-js",339541:"hostDefaultsStrings6",339750:"kk-kz-esp-js",339830:"ro-ro-smart-device-js",339888:"nl-nl-health-js",339902:"sq-al-meeting-room-console-js",340060:"services-brb",340285:"otlang44",340437:"nn-no-meeting-options-js",340469:"is-is-people-js",340513:"da-dk-hololens-js",340718:"ja-jp-extensibility-js",340848:"sk-sk-shortcut-js",340938:"gl-es-presence-js",341009:"discover-surface-up-dialog",341018:"cy-gb-tfl-homepage-js",341224:"hr-hr-video-capture-js",341245:"el-gr-health-js",341267:"sq-al-meeting-options-js",341305:"ro-ro-digital-signage-js",341502:"ru-ru-broadcast-js",341722:"pl-pl-broadcast-js",341802:"nn-no-carousel-multi-card-js",341875:"scaht-cortextopictypeswebstrings_ca-es-valencia",342195:"tr-tr-rsc-application-permissions-js",342426:"kk-kz-tfl-homepage-js",342436:"ka-ge-campaign-notifications-js",342461:"services-petrol",343151:"r_data-resolvers-app-usage-details",343223:"en-us-desktop-js",343430:"fi-fi-phonelink-sms-js",343531:"ar-sa-whats-new-js",343577:"sht-cortextopictypeswebstrings_hi",343607:"services-ods",343742:"eu-es-pre-core-js",343945:"ru-ru-discover-surface-js",344114:"sk-sk-digital-signage-js",344452:"ru-ru-pre-core-js",344729:"kk-kz-datepicker-js",344742:"sl-si-edu-js",345315:"hu-hu-tfl-onboarding-js",345626:"services-meeting-artifacts",345709:"nb-no-live-persona-card-js",345805:"ga-ie-strings-jsonThinRes",345855:"hr-hr-discover-surface-js",345933:"components-screen-recorder18",345988:"sq-al-share-in-meetings-js",346082:"sht-searchanswerteamsstrings_es-az-latn-az",346208:"ca-es-jana-js",346447:"ar-sa-tfl-homepage-js",346525:"nb-no-share-to-teams-js",346646:"az-latn-az-live-persona-editor-js",346704:"nn-no-sv-flyout-js",346789:"hostUxStrings73",346852:"en-gb-rsc-application-permissions-js",347162:"hostDefaultsStrings10",347262:"fr-fr-help-js",347386:"vi-vn-unified-search-js",347400:"bs-Latn-BA-UiStrings-json",347451:"pl-pl-datepicker-js",347600:"ro-ro-host-controls-js",347758:"ar-sa-carousel-multi-card-js",347778:"kk-kz-message-escalate-dialog-js",347800:"hu-hu-webinar-js",347958:"eu-es-whats-new-js",348010:"fr-fr-freemium-js",348025:"data-resolvers-global-mtma-user-data",348040:"pl-pl-live-persona-card-js",348151:"ar-sa-messaging-js",348166:"english strings",348627:"webrec2-language-en",348658:"nb-no-meeting-analytics-js",348671:"zh-tw-url-preview-js",348678:"InformationProtectionStrings83",348687:"data-resolvers-browser-communities",348840:"data-resolvers-browser-logs-files",349073:"data-resolvers-activity-bell-count",349174:"hu-hu-meeting-flyout-js",349191:"nn-no-people-targeting-js",349346:"calling-end-screen",349347:"nb-no-avatar-js",349410:"fr-fr-campaign-notifications-js",349519:"hi-in-calling-js",349539:"el-gr-extensibility-room-remote-js",349682:"vi-vn-person-js",349785:"sv-se-people-targeting-js",350030:"pt-br-meeting-room-console-js",350038:"lv-lv-webinar-js",350192:"scaht-cortextopictypeswebstrings_sr",350223:"fr-ca-unsupported-browser-js",350505:"kk-kz-nova-js",350650:"fil-ph-compose-js",350718:"services-files-personal",350782:"es-es-coach-report-js",350842:"en-gb-desktop-js",350961:"hostDefaultsStrings18",350977:"components-calling-guest-meeting-end-screen",351002:"uk-ua-biometric-enrollment-js",351085:"nl-nl-esp-js",351161:"fi-fi-wiki-js",351606:"el-gr-feedback-js",351752:"pt-pt-edu-js",351816:"sht-converged-logger",351914:"InformationProtectionStrings29",352250:"en-us-meeting-room-console-js",352277:"az-latn-az-unified-search-js",352324:"components-screen-recorder90",352415:"ar-sa-edu-js",352585:"scaht-cortextopictypeswebstrings_sv",352609:"et-ee-meeting-analytics-js",352820:"sht-searchanswerteamsstrings_es-pa-in",352849:"components-screen-recorder80",352931:"hi-in-meeting-options-js",352933:"otlang58",353236:"webrec2-language-he",353488:"bg-bg-teams-and-channels-js",353749:"sr-latn-rs-audience-view-dialog-js",353833:"cy-gb-nova-js",353936:"ka-ge-calendar-js",353991:"is-is-tfl-homepage-js",354258:"gl-es-guardians-js",354265:"zh-cn-pre-core-js",354456:"scaht-cortextopictypeswebstrings_gu",354540:"az-latn-az-meeting-stream-app-js",354548:"fns45",354564:"zh-cn-embed-js",354599:"he-il-simple-collab-js",354673:"ko-kr-breakout-rooms-js",354725:"bg-bg-queues-js",354735:"ar-sa-auth-js",354881:"uk-ua-gallery-js",354905:"bg-bg-meeting-stream-app-js",354936:"webrec2-language-hu",354989:"es-mx-desktop-js",355015:"lv-lv-activity-js",355221:"data-resolvers-browser-files",355430:"r_data-resolvers-device",355573:"kk-kz-teams-and-channels-js",355835:"zh-cn-broadcast-js",356053:"scaht-cortextopictypeswebstrings_ur",356098:"ar-sa-calendar-js",356113:"el-gr-embed-js",356149:"mk-mk-meeting-analytics-js",356383:"sq-al-compose-js",356545:"uk-ua-lms-integration-js",356564:"fns30",356693:"tr-tr-smart-device-js",356862:"sr-latn-rs-channels-js",356871:"ko-kr-shortcut-js",356956:"scaht-searchconvergedanswerteamsstrings-is",357005:"it-it-calling-js",357260:"tr-tr-discover-surface-js",357298:"vi-strings-jsonThinRes",357352:"ca-es-valencia-queues-js",357498:"zh-cn-semantic-object-js",357625:"ca-strings-jsonThinRes",357786:"it-it-hololens-js",357973:"vi-vn-meet-for-work-js",358035:"ru-ru-live-persona-card-js",358132:"id-id-meeting-options-js",358342:"bg-bg-calling-js",358512:"sht-cortextopictypeswebstrings_sl",358685:"he-il-extensibility-ptz-extension-js",358766:"el-gr-tfl-onboarding-js",358825:"cs-cz-simple-collab-js",358861:"fr-fr-people-js",359034:"uk-ua-jana-js",359168:"da-dk-artifacts-platform-js",359350:"hu-hu-calling-js",359514:"onecamera-locale-lt",359571:"webrec2-language-cs",359808:"el-gr-share-to-teams-third-party-js",359923:"components-screen-recorder14",360016:"hi-in-extensibility-room-remote-js",360345:"zh-tw-lms-integration-js",360351:"cy-gb-extensibility-room-remote-js",360532:"data-resolvers-presence",360695:"cypress-tests-only",360940:"ca-es-valencia-meeting-collaboration-js",360941:"platform-app-rail",361001:"hi-in-calendar-js",361024:"th-th-messaging-js",361029:"nb-no-contacts-js",361123:"lv-lv-edu-js",361256:"en-gb-meeting-options-js",361748:"scaht-searchconvergedanswerteamsstrings-hi",361849:"nl-nl-phonelink-sms-js",362201:"de-de-live-persona-card-js",362281:"hr-hr-queues-js",362362:"nb-no-share-to-teams-outlook-addin-js",362363:"el-gr-activity-js",362376:"config-prod",362387:"sht-searchanswerteamsstrings_es-th",362437:"services-tenant-membership",362497:"de-de-meeting-collaboration-js",362660:"nl-nl-errors-js",362979:"el-gr-unsupported-browser-js",363127:"nl-nl-jana-js",363184:"hostUxStrings66",363339:"ka-ge-breakout-rooms-js",363557:"ja-jp-message-escalate-dialog-js",363651:"ca-es-valencia-meeting-stream-app-js",363685:"services-broadcast-attendee",364183:"hu-hu-search-js",364517:"es-es-embed-js",364681:"ca-es-valencia-live-persona-card-js",364786:"scaht-searchconvergedanswerteamsstrings-hy",364946:"id-id-freemium-js",364961:"zh-cn-carousel-multi-card-js",365093:"eu-es-discover-surface-js",365132:"es-es-rsc-application-permissions-js",365161:"scaht-searchconvergedanswerteamsstrings-ml",365379:"cs-cz-meeting-options-js",365664:"th-th-lms-integration-js",366053:"id-id-live-persona-editor-js",366155:"scaht-searchconvergedanswerteamsstrings-bn-in",366176:"ca-es-carousel-multi-card-js",366263:"data-resolvers-fluid",366373:"scaht-searchconvergedanswerteamsstrings-kn",366411:"sl-si-meeting-flyout-js",366591:"pl-pl-edu-js",366620:"scaht-cortextopictypeswebstrings_si-lk",366629:"az-latn-az-lightbox-js",366962:"categories-ka-ge-json",366971:"ko-kr-meeting-flyout-js",366973:"ru-ru-channels-js",367254:"zh-cn-channels-js",367374:"r_data-resolvers-external-accounts-response",367636:"nn-no-unified-search-js",367809:"kk-kz-desktop-js",367949:"hu-hu-smart-device-js",367961:"sr-latn-rs-phonelink-sms-js",368e3:"zh-cn-datepicker-js",368037:"pt-pt-telemetry-js",368283:"nb-no-meeting-collaboration-js",368732:"hu-hu-share-in-meetings-js",368763:"zh-cn-people-js",369061:"th-th-shortcuts-js",369263:"ca-es-valencia-phonelink-sms-js",369265:"zh-tw-meeting-apis-app-js",369402:"is-is-meeting-recap-js",369429:"de-de-shortcut-js",369617:"copilot-ufd-control",369944:"sv-se-recurrence-js",370004:"az-latn-az-wiki-js",370388:"de-de-rsc-application-permissions-js",370409:"sv-SE-UiStrings-json",370533:"th-th-help-js",370582:"otlang6",370696:"sk-sk-activity-js",371040:"fns41",371194:"he-il-growth-js",371222:"et-ee-funstuff-js",371306:"ca-es-share-to-teams-js",371336:"tr-tr-telemetry-js",371374:"sk-sk-lms-integration-js",371401:"r_data-resolvers-ai-insights-feedback",371493:"sv-se-presence-js",371595:"uk-ua-audience-view-dialog-js",372136:"hostDefaultsStrings54",372298:"bg-bg-pre-core-js",372349:"r_data-resolvers-app-suggestions",372354:"fil-ph-autosuggest-js",372371:"InformationProtectionStrings41",372389:"is-is-communities-js",372397:"nl-nl-audience-view-dialog-js",372479:"uk-ua-activity-js",372697:"sl-si-sv-flyout-js",372713:"zh-cn-health-js",372936:"hostDefaultsStrings47",373369:"components-broadcast-auto-rejoin-screen",373809:"et-ee-lms-integration-js",373965:"cy-gb-video-message-js",374059:"th-th-live-persona-editor-js",374154:"id-id-toast-notifications-js",374424:"sht-searchanswerteamsstrings_es-nl",374736:"closed-captions-settings-panel",374750:"data-resolvers-ai-insights-feedback",374817:"da-dk-guardians-js",374863:"hostUxStrings12",374929:"de-de-compose-js",374934:"hostUxStrings35",375136:"cs-cz-coach-report-js",375271:"vi-vn-smart-device-js",375434:"pl-pl-lightbox-js",375470:"uk-ua-telemetry-js",375558:"meeting-options-app",375610:"pt-pt-share-to-teams-third-party-js",375616:"categories-or-in-json",375804:"ar-sa-files-js",376001:"es-mx-meeting-analytics-js",376049:"services-payment",376072:"fil-ph-people-targeting-js",376090:"scaht-searchconvergedanswerteamsstrings-es-mx",376222:"ru-ru-audience-view-dialog-js",376238:"en-gb-shortcut-js",376422:"ar-sa-meeting-flyout-js",376445:"cortex-topics-bootstrapper-topics-sdk",376461:"ro-ro-lightbox-js",376505:"nb-no-smart-device-js",376548:"hi-in-tfl-onboarding-js",376713:"ru-ru-teams-and-channels-js",376803:"components-screen-recorder94",377004:"fr-ca-jana-js",377087:"th-th-toast-notifications-js",377149:"artifacts-platform-content-container",377159:"components-screen-recorder0",377323:"hr-hr-help-js",377459:"InformationProtectionStrings6",377504:"ca-es-nova-js",377610:"et-ee-chat-list-js",377707:"cy-gb-teams-and-channels-js",378066:"sht-searchanswerteamsstrings_es-pt",378092:"hostUxStrings85",378117:"InformationProtectionStrings49",378377:"es-es-smart-device-js",378872:"sl-si-recurrence-js",378958:"sq-al-jana-js",379033:"r_data-resolvers-global-mtma-user-data",379084:"lv-lv-growth-js",379265:"de-de-webinar-js",379413:"bg-bg-webinar-js",379531:"hu-hu-meet-for-work-js",379688:"cs-cz-share-to-teams-js",379786:"sht-searchanswerteamsstrings_es-quz-pe",379883:"is-is-framework-js",380024:"lv-strings-jsonThinRes",380052:"chat-join-screen-share-button",380217:"zh-tw-extensibility-ptz-extension-js",380400:"ca-es-valencia-meeting-analytics-js",380571:"es-mx-help-js",380673:"es-es-share-to-teams-js",380690:"sq-al-meeting-flyout-js",380702:"zh-tw-meeting-stream-app-js",380975:"is-is-help-js",381170:"nl-nl-carousel-multi-card-js",381274:"r_data-resolvers-translation-settings",381293:"components-screen-recorder92",381319:"fr-ca-extensibility-room-remote-js",381364:"staticFluentEmojis",381631:"sl-si-freemium-js",381637:"r_data-resolvers-browser-broadcast-attendee",381852:"ka-ge-toast-notifications-js",381916:"InformationProtectionStrings4",382178:"scaht-searchconvergedanswerteamsstrings-gd-gb",382272:"fr-ca-meeting-room-console-js",382317:"en-us-artifacts-platform-js",382415:"ro-RO-UiStrings-json",382506:"r_data-resolvers-browser-call-recording",382732:"id-id-share-to-teams-third-party-js",382874:"categories-vi-vn-json",382958:"sl-si-health-js",382977:"gl-es-discover-surface-js",382998:"fi-fi-teams-and-channels-js",383028:"data-resolvers-update-client-state",383371:"ca-es-meeting-flyout-js",383464:"sl-si-extensibility-ptz-extension-js",383505:"nn-no-files-js",383533:"is-is-health-js",383606:"gl-es-url-preview-js",383738:"nb-no-gallery-js",383995:"r_data-resolvers-user-license",384056:"hi-in-tfl-homepage-js",384100:"otlang88",384105:"de-de-meeting-apis-app-js",384215:"nb-no-meeting-apis-app-js",384548:"components-screen-recorder8",384896:"az-latn-az-host-controls-js",384910:"eu-strings-jsonThinRes",384977:"services-store-devices",385090:"nn-no-extensibility-js",385177:"sv-se-survey-js",385249:"th-th-jana-js",385312:"az-latn-az-tfl-onboarding-js",385446:"data-resolvers-discover-surface",385591:"ro-ro-embed-js",385659:"it-it-recurrence-js",385686:"sq-al-funstuff-js",386296:"zh-cn-avatar-js",386491:"et-ee-shortcuts-js",386657:"or-IN-UiStrings-json",386669:"data-resolvers-organization",386886:"categories-cy-gb-json",387503:"it-it-video-message-js",387621:"et-ee-feedback-js",387728:"ca-es-whats-new-js",387758:"id-id-lms-integration-js",387918:"fil-ph-people-js",388009:"nb-no-extensibility-ptz-extension-js",388172:"ar-sa-queues-js",388339:"r_data-resolvers-browser-activity",388412:"otlang80",388561:"ca-es-growth-js",388628:"precompiled-editor-web-worker",388634:"el-gr-chat-list-js",388951:"InformationProtectionStrings38",388962:"pt-br-growth-js",389026:"ar-sa-premium-benefits-js",389097:"hr-hr-extensibility-room-remote-js",389301:"it-it-channels-js",389402:"sv-se-tfl-onboarding-js",389465:"sht-searchanswerteamsstrings_es-pl",389571:"scaht-cortextopictypeswebstrings_pl",389708:"fr-fr-lightbox-js",389905:"zh-cn-people-picker-js",390096:"he-il-meeting-recap-js",390291:"he-il-video-capture-js",390354:"cs-cz-people-app-js",390387:"r_data-resolvers-address-autosuggest",390590:"id-id-extensibility-js",390627:"is-is-activity-js",390684:"categories-cs-cz-json",390750:"discover-surface-lazy",390758:"et-ee-whats-new-js",390904:"az-latn-az-share-to-teams-js",391025:"calling-meeting-info-panel",391063:"copilot-plugin-manager",391386:"hu-hu-shortcut-js",391559:"ca-es-valencia-whats-new-js",391679:"gu-IN-UiStrings-json",391809:"bg-bg-freemium-upgrade-js",391838:"post-echo-bot-screen",391863:"zh-cn-edu-js",391929:"services-io-cmd-calling-mocks",391945:"sr-latn-rs-artifacts-platform-js",392313:"hr-HR-UiStrings-json",392449:"mk-mk-video-message-js",392572:"es-mx-avatar-js",392937:"pt-pt-extensibility-room-remote-js",393015:"pt-br-contacts-js",393061:"fr-fr-host-controls-js",393253:"ca-es-meeting-options-js",393258:"webrec2-language-ar",393339:"cy-gb-simple-collab-js",393735:"discover-surface-l2-back",393940:"eu-es-edu-js",394089:"th-th-share-in-meetings-js",394125:"onecamera-locale-es",394185:"id-id-guardians-js",394222:"da-dk-channels-js",394301:"th-th-breakout-rooms-js",394341:"eu-es-shortcuts-js",394358:"nb-no-broadcast-js",394387:"et-ee-share-to-teams-third-party-js",394425:"sl-si-meeting-recap-js",394483:"nl-nl-communities-js",394548:"categories-mk-mk-json",394601:"call-transcript-panel",394622:"lt-lt-people-picker-js",394761:"nl-NL-UiStrings-json",394925:"fil-ph-message-escalate-dialog-js",395059:"is-is-people-app-js",395300:"en-gb-message-escalate-dialog-js",395433:"pt-br-teams-insider-js",395569:"de-de-gallery-js",395709:"es-mx-sv-flyout-js",395826:"kk-kz-extensibility-js",395834:"sht-searchanswerteamsstrings_es-fi",396008:"id-id-unsupported-browser-js",396092:"lv-lv-cast-js",396209:"scaht-cortextopictypeswebstrings_es",396705:"hr-hr-channels-js",396710:"id-id-biometric-enrollment-js",396917:"components-calling-end-upsell-screen",397230:"th-th-extensibility-room-remote-js",397238:"zh-tw-embed-js",397241:"kk-kz-edu-js",397265:"InformationProtectionStrings40",397323:"data-resolvers-gallery",397423:"fluid-paste-container",397523:"data-resolvers-community-settings",397536:"sk-sk-host-controls-js",397679:"it-it-phonelink-sms-js",397922:"hi-in-people-app-js",398048:"zh-tw-health-js",398326:"hu-hu-errors-js",398391:"ka-ge-meeting-bot-js",398409:"lv-lv-sv-flyout-js",398411:"zh-cn-calling-js",398667:"he-il-errors-js",398845:"scaht-searchconvergedanswerteamsstrings-mi-nz",398911:"data-resolvers-odsp-transcript",399388:"fr-fr-teams-and-channels-js",399808:"sht-cortextopictypeswebstrings_no",399837:"th-TH-UiStrings-json",399954:"uk-ua-cast-js",400014:"nb-no-share-in-meetings-js",400060:"de-de-extensibility-js",400081:"sk-sk-smart-device-js",400101:"bg-bg-help-js",400162:"InformationProtectionStrings48",400200:"InformationProtectionStrings3",400347:"ka-ge-settings-js",400386:"ru-ru-phonelink-sms-js",400514:"en-us-live-persona-card-js",400604:"nn-no-funstuff-js",400880:"sht-searchanswerteamsstrings_es-ms",400912:"otlang18",401011:"zh-tw-smart-device-js",401130:"lt-lt-nova-js",401351:"fns63",401421:"onecamera-locale-ms",401466:"et-ee-avatar-js",401742:"et-ee-autosuggest-js",401848:"nn-no-presence-js",401926:"ru-ru-shortcuts-js",402236:"sv-se-share-to-teams-js",402845:"da-dk-unsupported-browser-js",403018:"mk-mk-autosuggest-js",403066:"es-es-avatar-js",403201:"nb-no-files-js",403222:"ru-ru-embed-js",403528:"otlang10",403818:"scaht-searchconvergedanswerteamsstrings-gu",404177:"components-screen-recorder84",404198:"pl-pl-semantic-object-js",404216:"ka-ge-webinar-js",404416:"mk-mk-carousel-multi-card-js",404517:"sq-al-desktop-js",404522:"fr-ca-extensibility-js",404542:"nb-no-shortcuts-js",404564:"it-it-share-to-teams-outlook-addin-js",404686:"it-it-framework-js",404800:"et-ee-meeting-options-js",405032:"eu-es-auth-js",405109:"hr-hr-carousel-multi-card-js",405151:"r_data-resolvers-smb-user-intent",405506:"kk-kz-biometric-enrollment-js",405667:"hostDefaultsStrings29",405851:"hostDefaultsStrings25",405861:"cy-gb-coach-report-js",406607:"cy-gb-smart-device-js",406740:"ar-sa-host-controls-js",406746:"InformationProtectionStrings63",406788:"uk-ua-contacts-js",406868:"pt-br-search-js",406880:"scaht-cortextopictypeswebstrings_sw",407071:"ko-kr-meeting-room-console-js",407138:"da-dk-webinar-js",407139:"sk-sk-avatar-js",407560:"data-resolvers-unified-consent",407598:"data-resolvers-search-suggestions",407615:"es-es-tfl-onboarding-js",407760:"empty-chat-wave-button",407893:"nl-nl-people-app-js",408311:"vi-vn-freemium-upgrade-js",408376:"sht-teams-topicanswerchunk",408535:"hostUxStrings78",408600:"zh-tw-toast-notifications-js",408631:"kk-kz-contacts-js",408750:"ko-kr-people-js",408781:"nn-no-communities-js",408819:"hostDefaultsStrings21",408902:"tr-tr-queues-js",409094:"ro-ro-toast-notifications-js",409199:"el-gr-pre-core-js",409312:"sk-sk-chat-list-js",409393:"bg-bg-digital-signage-js",409586:"bg-bg-teams-insider-js",409863:"pl-pl-carousel-multi-card-js",409866:"nl-nl-share-to-teams-third-party-js",409884:"pt-pt-survey-js",410067:"bg-bg-meeting-room-console-js",410229:"hostDefaultsStrings43",410349:"eu-es-unified-search-js",410425:"ru-ru-jana-js",410528:"fil-ph-people-picker-js",410752:"is-is-digital-signage-js",410812:"data-resolvers-ai-insights-sds",410926:"pl-pl-guardians-js",411048:"onecamera-locale-ru",411158:"cy-gb-rsc-application-permissions-js",411185:"fr-ca-message-escalate-dialog-js",411338:"sq-al-datepicker-js",411341:"cy-gb-messaging-js",411584:"hu-hu-share-to-teams-outlook-addin-js",411742:"en-us-cast-js",411743:"sv-se-meeting-apis-app-js",411828:"sl-si-message-escalate-dialog-js",412136:"data-resolvers-address-autosuggest",412194:"hu-hu-mtma-missed-notifications-js",412281:"r_data-resolvers-browser-ddv",412560:"it-it-jana-js",412590:"scaht-cortextopictypeswebstrings_ne-np",412850:"fns80",412851:"is-is-avatar-js",413015:"da-dk-digital-signage-js",413058:"eu-es-lightbox-js",413110:"kk-kz-queues-js",413446:"nl-nl-messaging-js",413508:"fr-fr-smart-device-js",413602:"sr-latn-rs-jana-js",413690:"lv-lv-survey-js",414026:"uk-ua-auth-js",414071:"zh-cn-wiki-js",414118:"hr-hr-breakout-rooms-js",414251:"sv-se-simple-collab-js",414422:"zh-tw-gallery-js",414658:"en-us-survey-js",414692:"ko-kr-meeting-analytics-js",414736:"eu-es-premium-benefits-js",414766:"es-mx-cast-js",414790:"sv-se-calendar-js",415279:"id-id-rsc-application-permissions-js",415289:"kk-kz-shortcut-js",415331:"sht-searchanswerteamsstrings_es-is",415340:"lazy-ppt-loader",415498:"kk-kz-campaign-notifications-js",415582:"pt-pt-welcome-bot-js",415768:"ko-kr-video-capture-js",415785:"sl-si-meeting-analytics-js",415806:"fns81",415953:"sht-cortextopictypeswebstrings_is",416023:"cy-gb-audience-view-dialog-js",416117:"ca-es-people-js",416189:"da-dk-calendar-js",416347:"calling-meeting-details-panel",416369:"it-it-pre-core-js",416523:"sht-searchanswerteamsstrings_es-sq",416696:"de-de-activity-js",416829:"es-es-messaging-js",417016:"fr-ca-people-targeting-js",417062:"sk-sk-video-message-js",417066:"nb-no-sv-flyout-js",417220:"fns28",417266:"nn-no-person-js",417298:"hostDefaultsStrings41",417332:"ru-ru-wiki-js",417341:"services-io-apps-monet",417361:"hi-in-person-js",417471:"es-mx-toast-notifications-js",417671:"hi-in-mtma-missed-notifications-js",417678:"et-ee-meeting-collaboration-js",417747:"fi-fi-people-js",417787:"he-il-mtma-missed-notifications-js",417902:"data-resolvers-teams-meeting-policies",417957:"otlang2",417982:"fr-fr-wiki-js",418012:"pl-pl-smart-device-js",418035:"meeting-lock-back-image",418219:"lt-lt-share-in-meetings-js",418252:"kk-kz-recurrence-js",418433:"pl-pl-meeting-recap-js",418505:"bg-bg-live-persona-editor-js",418642:"onecamera-locale-kk",418699:"r_data-resolvers-augloop",419161:"services-search-substrate",419318:"data-resolvers-whats-new",419525:"fr-ca-meeting-bot-js",419632:"az-latn-az-meet-for-work-js",419926:"ca-es-simple-collab-js",419939:"r_data-resolvers-channels",420144:"it-it-files-js",420169:"ko-kr-feedback-js",420199:"el-gr-share-to-teams-outlook-addin-js",420494:"hi-in-meeting-apis-app-js",420609:"fil-ph-meeting-analytics-js",420786:"uk-ua-edu-js",421014:"ko-kr-settings-js",421056:"fi-fi-virtual-events-js",421174:"services-esp",422012:"hr-hr-meeting-meet-app-js",422297:"en-gb-discover-surface-js",422371:"de-de-lms-integration-js",422452:"InformationProtectionStrings51",422474:"sq-al-welcome-bot-js",422616:"data-resolvers-people-avatar",422705:"kk-kz-host-controls-js",422726:"nb-no-meeting-recap-js",422765:"deferredoperations",423017:"onecamera-locale-fi",423136:"tr-tr-meeting-recap-js",423385:"hi-in-growth-js",423752:"ru-ru-share-to-teams-js",423864:"ro-ro-settings-js",423927:"nn-no-meeting-room-console-js",423968:"ca-es-valencia-wiki-js",424096:"scaht-cortextopictypeswebstrings_sd-arab-pk",424188:"en-gb-search-js",424252:"he-il-lms-integration-js",424333:"sht-searchanswerteamsstrings_es-be-by",424685:"fil-ph-share-to-teams-outlook-addin-js",424831:"es-es-chat-list-js",424855:"kk-kz-meeting-stream-app-js",424998:"bg-bg-share-in-meetings-js",425102:"ka-ge-welcome-bot-js",425270:"data-resolvers-store",425813:"vi-vn-sv-flyout-js",425874:"pl-pl-feedback-js",425901:"InformationProtectionStrings64",426054:"de-de-host-controls-js",426132:"lt-lt-extensibility-ptz-extension-js",426302:"th-th-freemium-upgrade-js",426443:"InformationProtectionStrings76",426476:"et-ee-meeting-apis-app-js",426705:"fr-fr-meeting-stream-app-js",426712:"sr-latn-rs-search-js",427038:"gl-es-rsc-application-permissions-js",427078:"data-resolvers-device",427161:"hu-hu-people-targeting-js",427201:"fr-ca-share-to-teams-third-party-js",427301:"nn-no-meeting-collaboration-js",427573:"config-ag08",427788:"ro-ro-meeting-options-js",427923:"pt-br-telemetry-js",428126:"ru-ru-communities-js",428394:"sht-searchanswerteamsstrings_es-uz",428497:"hostUxStrings79",428508:"pstn-dialog-manager",428631:"pt-pt-shortcut-js",428763:"lt-lt-channels-js",428767:"sht-cortextopictypeswebstrings_lv",428933:"broadcast-quality-feedback-container",429326:"cs-cz-errors-js",429331:"cs-cz-host-controls-js",429391:"es-mx-message-escalate-dialog-js",429502:"el-gr-video-message-js",429636:"r_data-resolvers-browser-floodgate",429655:"lt-lt-contacts-js",429698:"hr-hr-teams-insider-js",429864:"nb-no-digital-signage-js",430174:"hostDefaultsStrings35",430520:"scaht-cortextopictypeswebstrings_th",430624:"az-latn-az-share-in-meetings-js",430745:"cy-gb-avatar-js",430892:"eu-es-extensibility-ptz-extension-js",430915:"hu-hu-broadcast-js",431044:"es-mx-strings-jsonThinRes",431589:"hr-hr-tfl-homepage-js",432250:"fil-ph-breakout-rooms-js",432285:"ru-ru-freemium-js",432412:"r_data-resolvers-m365-links",432670:"hu-hu-people-picker-js",432794:"fr-ca-artifacts-platform-js",433013:"vi-vn-datepicker-js",433040:"ru-ru-edu-js",433071:"de-de-esp-js",433166:"lt-lt-lightbox-js",433242:"lv-lv-mtma-missed-notifications-js",433282:"sht-searchanswerteamsstrings_es-bs-latn-ba",433384:"th-th-teams-and-channels-js",433401:"ja-jp-shortcuts-js",433555:"ru-ru-rsc-application-permissions-js",434e3:"hostDefaultsStrings0",434022:"ar-sa-recurrence-js",434029:"nl-nl-calling-js",434518:"categories-pl-pl-json",434791:"uk-ua-rsc-application-permissions-js",434817:"es-es-search-js",434871:"hostDefaultsStrings64",434946:"de-de-health-js",435062:"nn-no-chat-list-js",435175:"sl-si-phonelink-sms-js",435182:"hi-in-people-js",435364:"InformationProtectionStrings39",435573:"en-gb-welcome-bot-js",435611:"fr-ca-live-persona-editor-js",435812:"az-latn-az-share-to-teams-outlook-addin-js",435859:"pt-br-campaign-notifications-js",436009:"components-screen-recorder16",436058:"InformationProtectionStrings31",436143:"vi-vn-growth-js",436148:"he-il-people-app-js",436314:"scaht-searchconvergedanswerteamsstrings-ko",436323:"en-us-esp-js",436512:"es-mx-survey-js",436519:"en-us-freemium-upgrade-js",437061:"bg-bg-url-preview-js",437209:"hostUxStrings77",437425:"InformationProtectionStrings17",437458:"da-dk-virtual-events-js",437490:"sr-latn-rs-desktop-js",437570:"fi-fi-queues-js",437804:"en-us-message-escalate-dialog-js",437808:"gl-es-meeting-collaboration-js",437829:"sq-al-channels-js",437859:"gl-es-wiki-js",437974:"kk-kz-embed-js",438011:"zh-tw-people-targeting-js",438427:"kk-kz-person-js",438529:"ko-kr-communities-js",438860:"webrec2-language-uk",439095:"cs-cz-communities-js",439151:"r_data-resolvers-connected-calendar",439201:"es-es-jana-js",439573:"cs-cz-phonelink-sms-js",439613:"services-io-browser-consent-state",439665:"ko-kr-share-to-teams-js",439691:"ru-ru-esp-js",439912:"es-es-person-js",439949:"hi-in-telemetry-js",439961:"hr-hr-edu-js",440170:"he-il-esp-js",440226:"en-gb-pre-core-js",440281:"bg-bg-sv-flyout-js",440348:"fi-fi-audience-view-dialog-js",440391:"hr-hr-person-js",440487:"is-is-broadcast-js",440591:"uk-ua-people-app-js",440634:"scaht-cortextopictypeswebstrings_lb-lu",440840:"az-latn-az-meeting-meet-app-js",440857:"zh-TW-UiStrings-json",441252:"zh-cn-meeting-recap-js",441404:"fr-ca-gallery-js",441788:"ar-sa-phonelink-sms-js",441920:"sq-al-video-capture-js",441931:"fr-ca-meeting-flyout-js",442122:"ko-kr-host-controls-js",442284:"ro-ro-channels-js",442482:"pt-br-person-js",442501:"header-graphql-search-box-utils",442651:"scaht-searchconvergedanswerteamsstrings-no",443091:"services-health",443208:"is-is-url-preview-js",443608:"zh-tw-jana-js",443981:"ka-ge-discover-surface-js",444199:"en-us-host-controls-js",444808:"is-is-files-js",444908:"ko-kr-people-picker-js",444963:"ro-ro-webinar-js",444968:"pt-pt-meeting-options-js",444977:"gl-es-premium-benefits-js",445170:"zh-cn-strings-jsonThinRes",445434:"nb-no-queues-js",445620:"categories-ps-af-json",445624:"de-de-discover-surface-js",445698:"pt-br-unsupported-browser-js",446210:"vi-vn-auth-js",446246:"es-mx-queues-js",446276:"uk-ua-shortcut-js",446525:"he-il-live-persona-card-js",446538:"id-id-share-in-meetings-js",446684:"pt-br-calling-js",446848:"components-screen-recorder96",446885:"scaht-searchconvergedanswerteamsstrings-mk",446990:"th-th-video-capture-js",447085:"mk-mk-rsc-application-permissions-js",447244:"scaht-searchconvergedanswerteamsstrings-en-gb",447818:"eu-es-person-js",447863:"ko-kr-lms-integration-js",447958:"cy-gb-channels-js",448025:"InformationProtectionStrings32",448111:"ja-jp-welcome-bot-js",448436:"th-th-host-controls-js",448557:"message-extension-flyout-popup-container",448601:"lt-lt-health-js",448863:"nl-nl-meeting-apis-app-js",449062:"fil-ph-premium-benefits-js",449355:"ja-jp-jana-js",449401:"ka-ge-broadcast-js",449610:"az-latn-az-esp-js",449680:"bg-bg-video-message-js",449898:"ca-es-valencia-artifacts-platform-js",449902:"fns54",450050:"lv-lv-meeting-meet-app-js",450067:"hostDefaultsStrings26",450084:"fns82",450157:"es-MX-UiStrings-json",450366:"pt-pt-teams-and-channels-js",450612:"pt-pt-pre-core-js",450912:"InformationProtectionStrings55",450960:"de-de-meeting-analytics-js",451060:"InformationProtectionStrings59",451254:"sht-searchanswerteamsstrings_es-el",451477:"fil-ph-people-app-js",451540:"r_data-resolvers-invite-links",451796:"fns33",451815:"hi-in-people-picker-js",451825:"az-latn-az-mtma-missed-notifications-js",451958:"ka-ge-people-js",452230:"hu-hu-person-js",452574:"onecamera-locale-eu",452579:"categories-ky-kg-json",452713:"components-screen-recorder86",453547:"fi-fi-gallery-js",453806:"en-gb-unified-search-js",454145:"bg-bg-health-js",454161:"hi-in-video-capture-js",454165:"services-people-targeting",454172:"da-dk-breakout-rooms-js",454242:"nb-no-campaign-notifications-js",454275:"fi-fi-avatar-js",454281:"nb-strings-jsonThinRes",454356:"fi-fi-communities-js",454485:"vi-vn-share-in-meetings-js",454658:"nl-nl-meeting-analytics-js",454687:"convene-app",454726:"sq-al-nova-js",454730:"hostDefaultsStrings50",454758:"it-it-semantic-object-js",454835:"webrec2-language-el",455080:"pl-pl-teams-insider-js",455097:"sk-sk-queues-js",455143:"components-file-sharing-dialog",455339:"sl-si-person-js",455513:"fr-ca-meet-for-work-js",455520:"de-de-feedback-js",455555:"sht-searchanswerteamsstrings_es-lb-lu",455627:"components-screen-recorder60",455810:"cs-cz-campaign-notifications-js",456038:"es-mx-autosuggest-js",456109:"hu-hu-biometric-enrollment-js",456205:"th-th-auth-js",456403:"it-it-communities-js",456751:"kk-kz-meeting-recap-js",456809:"onecamera-locale-et",456832:"nb-no-autosuggest-js",456904:"search-app",456970:"InformationProtectionStrings53",457155:"pt-pt-hololens-js",457375:"data-resolvers-favorite-user",457490:"fil-ph-sv-flyout-js",457512:"da-dk-contacts-js",457725:"az-latn-az-jana-js",457744:"sq-al-shortcut-js",457748:"sk-sk-unsupported-browser-js",457964:"onecamera-locale-es-mx",458001:"ca-es-valencia-channels-js",458075:"da-dk-freemium-js",458179:"pl-pl-framework-js",458232:"vi-vn-video-message-js",458306:"sk-sk-hololens-js",458771:"services-community-settings",458820:"onecamera-locale-el",458966:"r_data-resolvers-toast",459169:"en-gb-meeting-bot-js",459174:"tr-tr-jana-js",459357:"scaht-cortextopictypeswebstrings_bg",459461:"sk-sk-tfl-onboarding-js",459476:"nb-no-framework-js",459683:"hu-hu-guardians-js",460039:"eu-es-embed-js",460041:"bn-IN-UiStrings-json",460301:"lt-lt-extensibility-room-remote-js",460649:"en-us-breakout-rooms-js",460820:"it-it-broadcast-js",460893:"r_data-resolvers-mention",460927:"mk-mk-jana-js",461005:"en-us-guardians-js",461045:"webrec2-language-fil-ph",461118:"hostDefaultsStrings58",461203:"InformationProtectionStrings35",461234:"eu-es-health-js",461251:"hostUxStrings20",461409:"categories-hi-in-json",461627:"data-resolvers-contacts-sync-banner",461956:"sk-sk-compose-js",462109:"kk-kz-meeting-bot-js",462115:"InformationProtectionStrings60",462170:"pt-pt-extensibility-ptz-extension-js",462223:"gl-es-files-js",462239:"fr-fr-breakout-rooms-js",462270:"th-th-virtual-events-js",462315:"InformationProtectionStrings68",462365:"sr-latn-rs-shortcuts-js",462432:"scaht-cortextopictypeswebstrings_pt-pt",462438:"ca-es-wiki-js",462478:"data-resolvers-meeting-intelligence",462591:"pt-pt-share-to-teams-outlook-addin-js",462623:"hi-in-health-js",462773:"hu-hu-communities-js",462843:"eu-es-freemium-upgrade-js",462939:"hostDefaultsStrings37",463153:"he-il-settings-js",463402:"hostUxStrings57",463473:"services-smb-user-intent",463648:"nb-no-activity-js",463770:"vi-vn-channels-js",463848:"scaht-cortextopictypeswebstrings_nl",464189:"sht-searchanswerteamsstrings_es-hr",464236:"calling-webcv",464241:"hr-hr-health-js",464759:"fr-fr-communities-js",464824:"bg-bg-tfl-onboarding-js",465017:"ca-es-health-js",465041:"es-es-meet-for-work-js",465181:"en-gb-campaign-notifications-js",465385:"ru-ru-extensibility-js",465423:"el-gr-meeting-flyout-js",465486:"call-health-panel",465665:"ka-ge-share-in-meetings-js",465677:"hostDefaultsStrings77",465681:"cy-gb-comment-stream-js",465904:"sq-al-meeting-meet-app-js",466204:"data-resolvers-contacts-sync",466476:"sht-cortextopictypeswebstrings_en-gb",466585:"id-id-activity-js",466622:"pt-pt-breakout-rooms-js",466786:"sr-latn-rs-auth-js",466886:"fr-ca-tfl-homepage-js",466938:"fi-fi-premium-benefits-js",466973:"scaht-cortextopictypeswebstrings_pa-in",466976:"vi-vn-queues-js",466987:"nb-no-help-js",467254:"pl-pl-premium-benefits-js",467764:"r_data-resolvers-dynamics-marketing",467767:"data-resolvers-distribution-list",467775:"eu-es-share-to-teams-third-party-js",467785:"data-resolvers-team-settings",467957:"sr-latn-rs-communities-js",468196:"tr-tr-recurrence-js",468318:"shareCallout",468341:"hostUxStrings51",468479:"ja-jp-feedback-js",468504:"lt-lt-smart-device-js",468660:"az-latn-az-freemium-upgrade-js",468661:"ja-jp-semantic-object-js",468677:"hostUxStrings59",468701:"hi-in-survey-js",468771:"otlang22",468792:"zh-tw-compose-js",468840:"nl-nl-gallery-js",468846:"ru-ru-biometric-enrollment-js",468880:"hostUxStrings55",468994:"tr-tr-guardians-js",469063:"da-dk-growth-js",469081:"services-external-accounts",469374:"sr-latn-rs-survey-js",469375:"otlang108",469387:"de-de-share-to-teams-third-party-js",469445:"ja-jp-unsupported-browser-js",469518:"fr-ca-whats-new-js",469728:"fr-fr-meeting-room-console-js",469742:"fi-fi-auth-js",469929:"th-th-edu-js",469997:"id-id-communities-js",470083:"nl-nl-framework-js",470141:"th-th-video-message-js",470178:"fi-fi-tfl-onboarding-js",470225:"data-resolvers-shell",470359:"lv-lv-search-js",470472:"nn-no-auth-js",470507:"hu-hu-queues-js",470530:"el-gr-campaign-notifications-js",471042:"ca-es-biometric-enrollment-js",471055:"tr-tr-meeting-options-js",471096:"lv-lv-meeting-stream-app-js",471136:"sht-cortextopictypeswebstrings_en-us",471167:"uk-ua-messaging-js",471213:"pt-br-auth-js",471342:"en-gb-growth-js",471344:"sq-al-unified-search-js",471680:"es-mx-extensibility-ptz-extension-js",471726:"video-message",471782:"otlang0",471790:"zh-cn-toast-notifications-js",472202:"es-es-desktop-js",472209:"eu-es-extensibility-js",472415:"hr-hr-extensibility-js",472589:"nl-nl-freemium-upgrade-js",472674:"gl-es-whats-new-js",472788:"fi-fi-lightbox-js",472804:"th-th-meeting-collaboration-js",472905:"ca-es-valencia-meeting-meet-app-js",473262:"ja-jp-edu-js",473442:"otlang8",473449:"ja-jp-coach-report-js",473572:"et-ee-rsc-application-permissions-js",473676:"data-resolvers-user",473863:"de-de-search-js",474189:"ka-ge-virtual-events-js",474248:"es-mx-welcome-bot-js",474404:"ca-es-valencia-freemium-upgrade-js",474786:"es-es-shortcut-js",474833:"onecamera-locale-bs",475060:"eu-es-coach-report-js",475063:"services-store-markdown-it",475450:"is-is-chat-list-js",475487:"ko-kr-queues-js",475758:"msteams/components-hosted-web-content",475837:"vi-vn-cast-js",475962:"es-mx-whats-new-js",476023:"data-resolvers-browser-tpn",476158:"data-resolvers-copilot-plugin-user-config",476476:"webrec2-language-nl",476524:"zh-tw-errors-js",476553:"ka-ge-help-js",476843:"onecamera-locale-bg",476896:"fns78",477078:"hostDefaultsStrings30",477209:"services-chat",477285:"eu-es-welcome-bot-js",477307:"ro-ro-hololens-js",477356:"cs-cz-semantic-object-js",477358:"fr-fr-survey-js",477482:"hr-hr-survey-js",477536:"ko-kr-freemium-upgrade-js",477547:"hr-hr-share-to-teams-third-party-js",477697:"data-resolvers-browser-payment",477970:"appbar-control-flyoutbuttonbadge",478001:"data-resolvers-search-substrate",478053:"services-search-prefetch",478087:"fi-fi-help-js",478744:"es-mx-shortcuts-js",478826:"ro-ro-artifacts-platform-js",478930:"et-ee-nova-js",478942:"el-gr-esp-js",479017:"is-is-audience-view-dialog-js",479071:"data-resolvers-artifacts-platform",479078:"el-gr-files-js",479108:"ko-kr-search-js",479132:"gl-es-queues-js",479377:"id-id-mtma-missed-notifications-js",479474:"lt-lt-semantic-object-js",479539:"sk-sk-embed-js",479807:"hi-in-queues-js",480017:"r_data-resolvers-low-friction-trial",480041:"compose-box-v1-renderer",480090:"nb-no-wiki-js",480094:"zh-tw-live-persona-card-js",480103:"hu-hu-premium-benefits-js",480220:"lt-lt-growth-js",480809:"onecamera-locale-nl",480810:"hr-hr-search-js",480976:"ko-kr-artifacts-platform-js",481135:"sr-latn-rs-meeting-apis-app-js",481162:"ru-ru-digital-signage-js",481218:"ja-jp-shortcut-js",481571:"tr-tr-cast-js",481580:"vi-vn-help-js",481608:"ar-sa-guardians-js",481618:"is-is-simple-collab-js",481647:"chat-app",481683:"vi-vn-teams-insider-js",481694:"data-resolvers-third-party-calendar",481786:"el-gr-artifacts-platform-js",481968:"ar-sa-settings-js",482161:"sl-si-meeting-apis-app-js",482544:"sl-si-mtma-missed-notifications-js",482682:"it-it-activity-js",482887:"lt-lt-digital-signage-js",482991:"data-resolvers-channels",483650:"data-resolvers-cross-tenant-policies",484066:"ja-jp-avatar-js",484188:"ru-ru-calendar-js",484322:"uk-ua-welcome-bot-js",484396:"sr-latn-rs-embed-js",484520:"de-de-teams-insider-js",484639:"ja-jp-comment-stream-js",484671:"ja-JP-UiStrings-json",484734:"bg-bg-tfl-homepage-js",484754:"sq-al-wiki-js",485140:"lt-lt-person-js",485197:"hu-HU-UiStrings-json",485211:"pt-br-nova-js",485268:"fr-fr-shortcut-js",485292:"sr-latn-rs-esp-js",485391:"fi-fi-contacts-js",485491:"r_data-resolvers-teams",485504:"nn-no-freemium-js",486006:"de-de-pre-core-js",486238:"bg-bg-avatar-js",486340:"pt-pt-discover-surface-js",486418:"pt-br-people-app-js",486600:"pl-pl-share-to-teams-js",486723:"es-es-meeting-bot-js",486855:"hu-hu-lms-integration-js",486974:"he-il-host-controls-js",487151:"nn-no-breakout-rooms-js",487899:"nn-no-people-js",487914:"kk-kz-virtual-events-js",487948:"lt-lt-campaign-notifications-js",488303:"cs-cz-funstuff-js",488338:"custom-audience-view-backgrounds-dialog",488461:"fi-fi-unified-search-js",488571:"en-gb-coach-report-js",488729:"components-screen-recorder98",488806:"fil-ph-unified-search-js",488821:"it-it-meeting-options-js",488996:"de-de-people-js",489003:"pl-pl-people-js",489147:"sl-si-share-to-teams-outlook-addin-js",489194:"cs-cz-welcome-bot-js",489425:"et-ee-meeting-room-console-js",489568:"nn-no-shortcut-js",489589:"categories-ta-in-json",489682:"th-th-pre-core-js",489721:"hu-hu-toast-notifications-js",489931:"otlang84",490017:"chat-audio-drop-in-live-roster-button",490245:"kk-kz-meet-for-work-js",490281:"scaht-searchconvergedanswerteamsstrings-km-kh",490530:"sq-al-presence-js",491029:"data-resolvers-browser-meeting-artifacts",491036:"teams-search-prefetch-configs",491411:"eu-es-calendar-js",491500:"sq-al-activity-js",491563:"en-gb-meeting-apis-app-js",491647:"cy-gb-host-controls-js",491773:"sht-searchanswerteamsstrings_es-es",492077:"zh-cn-freemium-upgrade-js",492230:"postPlaybackCore",492278:"is-is-autosuggest-js",492567:"hi-in-desktop-js",492685:"ar-sa-meeting-recap-js",492699:"r_data-resolvers-organization",492894:"pt-br-meet-for-work-js",492922:"et-ee-wiki-js",493352:"topics-sdk-km-api",493429:"sl-si-meeting-room-console-js",493486:"zh-tw-funstuff-js",493799:"fi-fi-unsupported-browser-js",493866:"en-us-meeting-collaboration-js",493902:"data-resolvers-privacy-settings",494060:"he-il-pre-core-js",494074:"nl-nl-autosuggest-js",494217:"sht-cortextopictypeswebstrings_or",494286:"ca-es-valencia-extensibility-room-remote-js",494385:"ja-jp-embed-js",494409:"sr-latn-rs-errors-js",494431:"watermarkContainer",494810:"fns35",495045:"ko-kr-live-persona-card-js",495049:"categories-it-it-json",495120:"zh-tw-meet-for-work-js",495195:"scaht-searchconvergedanswerteamsstrings-kk",495249:"sv-se-video-capture-js",495284:"ca-es-teams-insider-js",495468:"vi-vn-meeting-options-js",495937:"et-ee-unsupported-browser-js",496106:"auth_v2",496488:"sht-searchanswerteamsstrings_es-no",496656:"components-screen-recorder4",496741:"hi-in-comment-stream-js",496751:"et-ee-audience-view-dialog-js",496872:"sv-se-audience-view-dialog-js",496925:"ro-ro-framework-js",497407:"es-mx-phonelink-sms-js",497439:"nl-nl-sv-flyout-js",497475:"pt-br-freemium-js",497626:"pt-pt-errors-js",497800:"nl-nl-people-picker-js",497907:"id-id-framework-js",497979:"hostDefaultsStrings38",498023:"it-it-freemium-upgrade-js",498034:"kk-kz-feedback-js",498086:"fr-ca-people-js",498278:"fi-fi-telemetry-js",498287:"cy-gb-datepicker-js",498416:"tr-tr-freemium-js",498539:"sv-se-share-to-teams-outlook-addin-js",498580:"et-ee-meeting-stream-app-js",498810:"lv-lv-wiki-js",498846:"vi-VN-UiStrings-json",499230:"pt-pt-video-message-js",499240:"hostUxStrings49",499433:"scaht-cortextopictypeswebstrings_mi-nz",499522:"pt-br-carousel-multi-card-js",499534:"ro-ro-unified-search-js",499607:"pt-pt-calling-js",499614:"mk-mk-tfl-onboarding-js",499615:"fi-fi-embed-js",500365:"cy-gb-people-js",500439:"sv-se-virtual-events-js",500923:"services-distribution-list",500979:"it-it-share-in-meetings-js",501054:"id-id-funstuff-js",501129:"services-substrate-recommendations",501131:"en-gb-strings-jsonThinRes",501375:"hostDefaultsStrings63",501384:"es-mx-search-js",501653:"eu-es-message-escalate-dialog-js",502111:"mk-mk-shortcut-js",502217:"fil-ph-framework-js",502219:"ariawrapper",502317:"zh-cn-teams-insider-js",502319:"de-de-chat-list-js",503013:"components-calling-retry-screen",503420:"tr-tr-desktop-js",503485:"ka-ge-telemetry-js",503743:"fil-ph-strings-jsonThinRes",503908:"hostDefaultsStrings67",504166:"ko-kr-shortcuts-js",504210:"nl-nl-edu-js",504295:"pt-pt-nova-js",504454:"fr-ca-feedback-js",504631:"sht-searchanswerteamsstrings_es-af",504703:"categories-da-dk-json",504752:"bg-bg-datepicker-js",505556:"eu-es-gallery-js",505751:"zh-cn-gallery-js",505794:"fil-ph-hololens-js",505952:"es-es-freemium-upgrade-js",506020:"data-resolvers-calling",506093:"th-th-coach-report-js",506312:"sht-searchanswerteamsstrings_es-en-us",506606:"bg-bg-framework-js",506681:"es-es-edu-js",506693:"data-client-calling",506865:"az-latn-az-hololens-js",506878:"cs-cz-sv-flyout-js",506886:"sht-searchanswerteamsstrings_es-hu",506901:"scaht-cortextopictypeswebstrings_lo-la",506971:"pl-pl-audience-view-dialog-js",507296:"scaht-cortextopictypeswebstrings_es-mx",507413:"webrec2-language-ga-ie",507448:"ro-ro-guardians-js",507469:"r_data-resolvers-system-settings",507562:"sk-sk-people-targeting-js",507563:"es-mx-meeting-recap-js",507830:"scaht-searchconvergedanswerteamsstrings-cy",508025:"categories-he-il-json",508209:"nn-no-growth-js",508230:"mk-mk-hololens-js",508390:"ka-ge-calling-js",508751:"ml-IN-UiStrings-json",508842:"fr-ca-cast-js",508850:"az-latn-az-errors-js",509098:"uk-ua-wiki-js",509113:"pt-pt-messaging-js",509141:"fr-fr-people-targeting-js",509149:"zh-tw-sv-flyout-js",509228:"r_data-resolvers-presence",509352:"fns40",509366:"pt-br-settings-js",509834:"sr-latn-rs-freemium-upgrade-js",509862:"uk-ua-simple-collab-js",510085:"nl-nl-people-js",510104:"data-resolvers-browser-live-stream-rendering",510122:"kk-kz-files-js",510128:"it-it-telemetry-js",510129:"ca-es-valencia-unsupported-browser-js",510318:"sht-searchanswerteamsstrings_es-uk",510568:"hi-in-people-targeting-js",510800:"en-us-video-capture-js",510846:"sl-si-desktop-js",510901:"pt-pt-queues-js",510919:"scaht-searchconvergedanswerteamsstrings-bn-bd",511020:"sv-se-mtma-missed-notifications-js",511141:"sht-cortextopictypeswebstrings_tt",511154:"pt-br-avatar-js",511250:"en-gb-unsupported-browser-js",511290:"gl-es-smart-device-js",511596:"scaht-cortextopictypeswebstrings_ru",511807:"ca-es-chat-list-js",512033:"sr-latn-rs-url-preview-js",512097:"categories-sv-se-json",512159:"services-style-my-room",512248:"sr-latn-rs-cast-js",512748:"hr-hr-digital-signage-js",512767:"data-resolvers-compose-language",513731:"uk-ua-whats-new-js",513802:"eu-es-avatar-js",513901:"r_data-resolvers-browser-tpn",514027:"r_data-resolvers-browser-mention",514423:"es-es-survey-js",514572:"da-dk-errors-js",514603:"pt-pt-growth-js",514621:"room-remote",514631:"sl-si-compose-js",514689:"kk-kz-meeting-options-js",514880:"sv-se-extensibility-room-remote-js",515045:"nl-nl-hololens-js",515061:"sht-searchanswerteamsstrings_es-he",515143:"id-id-help-js",515179:"id-id-semantic-object-js",515406:"is-is-survey-js",515450:"hostDefaultsStrings52",515537:"ja-jp-gallery-js",515636:"scaht-searchconvergedanswerteamsstrings-zu-za",515711:"ka-ge-live-persona-card-js",515778:"vi-vn-coach-report-js",515781:"sv-se-biometric-enrollment-js",515885:"ar-sa-discover-surface-js",516095:"hostUxStrings42",516471:"es-mx-lightbox-js",516511:"kk-kz-live-persona-card-js",516649:"es-es-phonelink-sms-js",516942:"gl-es-live-persona-editor-js",517097:"data-resolvers-azure-maps",517107:"summaryModule",517193:"scaht-searchconvergedanswerteamsstrings-uz",517418:"hi-in-autosuggest-js",517495:"onecamera-locale-sr-cyrl-rs",517583:"sht-cortextopictypeswebstrings_nl",517693:"hr-hr-toast-notifications-js",517759:"zh-tw-people-js",517784:"lt-lt-communities-js",517823:"mk-mk-extensibility-ptz-extension-js",517921:"data-resolvers-health-scenarios",517965:"services-instant-answers",518048:"ar-sa-autosuggest-js",518102:"hu-hu-meeting-collaboration-js",518254:"hostDefaultsStrings56",518359:"zh-cn-esp-js",518371:"sq-al-embed-js",518402:"tr-tr-health-js",518790:"pt-pt-wiki-js",518983:"de-de-avatar-js",519146:"scaht-searchconvergedanswerteamsstrings-sk",519199:"es-es-calendar-js",519301:"et-ee-channels-js",519319:"emoji-one-service",519400:"pt-pt-cast-js",519426:"da-dk-smart-device-js",519531:"pt-br-live-persona-card-js",519586:"is-is-host-controls-js",519838:"de-de-extensibility-room-remote-js",519853:"fns73",519937:"fr-fr-contacts-js",519960:"bg-bg-virtual-events-js",519989:"zh-tw-avatar-js",520068:"az-latn-az-webinar-js",520320:"r_data-resolvers-search-contextual",520351:"nb-no-semantic-object-js",520424:"uk-ua-lightbox-js",520455:"ca-es-valencia-meeting-bot-js",520499:"otlang32",520663:"tr-tr-files-js",520665:"sr-latn-rs-funstuff-js",520715:"ko-kr-health-js",520764:"InformationProtectionStrings25",520873:"sr-cyrl-rs-strings-jsonThinRes",520930:"gum-modal",521112:"hostUxStrings25",521202:"ar-sa-lightbox-js",521475:"th-th-people-js",521529:"components-screen-recorder88",521590:"is-is-calling-js",521646:"vi-vn-messaging-js",521690:"cy-gb-files-js",521709:"nl-nl-telemetry-js",521943:"sq-al-mtma-missed-notifications-js",521954:"el-gr-contacts-js",522030:"cy-gb-calendar-js",522134:"et-ee-gallery-js",522155:"zh-cn-meeting-stream-app-js",522191:"es-mx-semantic-object-js",522299:"de-de-sv-flyout-js",522509:"hr-hr-biometric-enrollment-js",522580:"axessible-module",522589:"vi-vn-esp-js",522594:"ru-ru-person-js",522764:"onecamera-locale-cy",522857:"fns61",523051:"de-de-queues-js",523656:"pl-pl-freemium-js",523667:"sv-se-shortcut-js",523747:"fns2",523857:"et-ee-coach-report-js",523871:"az-latn-az-recurrence-js",523890:"hostUxStrings17",524088:"sk-sk-pre-core-js",524101:"da-dk-carousel-multi-card-js",524177:"r_data-resolvers-search-suggestions",524282:"sht-cortextopictypeswebstrings_lo-la",524489:"hostDefaultsStrings14",524506:"nl-nl-wiki-js",524937:"hr-hr-esp-js",525145:"fluid-debugger",525152:"az-latn-az-meeting-analytics-js",525219:"nn-no-autosuggest-js",525249:"vi-vn-discover-surface-js",525265:"nl-nl-digital-signage-js",525271:"sl-si-whats-new-js",525575:"fns37",525603:"th-th-shortcut-js",525831:"lv-lv-hololens-js",526124:"data-resolvers-browser-webinar",526202:"nn-no-audience-view-dialog-js",526332:"pl-pl-lms-integration-js",526657:"lv-lv-people-app-js",526915:"el-gr-datepicker-js",526996:"mk-mk-telemetry-js",527002:"ko-kr-contacts-js",527105:"he-il-feedback-js",527297:"fr-ca-health-js",527317:"zh-cn-shortcuts-js",527386:"pl-pl-url-preview-js",527466:"ko-kr-discover-surface-js",527558:"nb-no-freemium-js",527770:"is-is-webinar-js",527789:"de-de-lightbox-js",527818:"vi-vn-video-capture-js",527900:"zh-tw-unified-search-js",527973:"et-ee-premium-benefits-js",528081:"sl-si-share-to-teams-js",528126:"hi-in-url-preview-js",528186:"sht-cortextopictypeswebstrings_fi",528224:"components-screen-recorder48",528226:"uk-ua-health-js",528229:"ar-sa-unsupported-browser-js",528264:"en-gb-toast-notifications-js",528342:"sr-latn-rs-meeting-recap-js",528939:"ru-ru-smart-device-js",528944:"bg-bg-meeting-analytics-js",529092:"sk-sk-shortcuts-js",529188:"ka-strings-jsonThinRes",529311:"ko-kr-broadcast-js",529516:"hr-hr-presence-js",529540:"pl-pl-autosuggest-js",529709:"config-ag09",529713:"cy-gb-auth-js",529790:"it-it-live-persona-editor-js",529992:"lv-lv-teams-and-channels-js",530035:"ka-ge-esp-js",530135:"scaht-searchconvergedanswerteamsstrings-lb-lu",530174:"r_data-resolvers-biometric-enrollment",530321:"sht-cortextopictypeswebstrings_quz-pe",530597:"ro-ro-tfl-onboarding-js",530629:"nb-no-audience-view-dialog-js",530677:"sr-latn-rs-welcome-bot-js",530702:"hostUxStrings0",530807:"ar-sa-meeting-analytics-js",531199:"fr-ca-discover-surface-js",531254:"ru-ru-sv-flyout-js",531418:"scaht-searchconvergedanswerteamsstrings-en-us",531422:"pl-pl-meeting-apis-app-js",531505:"nb-no-settings-js",531521:"components-teams-and-channels-entry",531527:"fi-fi-meeting-stream-app-js",531714:"mk-mk-growth-js",531755:"scaht-searchconvergedanswerteamsstrings-lv",531858:"pt-pt-meeting-recap-js",531961:"scaht-searchconvergedanswerteamsstrings-ur",532112:"en-us-health-js",532268:"da-dk-datepicker-js",532365:"lt-lt-unsupported-browser-js",532397:"mk-mk-teams-and-channels-js",532528:"codemirror",532919:"tr-tr-breakout-rooms-js",533203:"gl-es-calendar-js",533298:"da-dk-feedback-js",533453:"el-gr-toast-notifications-js",533508:"es-es-meeting-collaboration-js",533519:"cy-gb-artifacts-platform-js",533634:"tr-tr-live-persona-card-js",533818:"ja-jp-nova-js",534037:"ka-ge-tfl-onboarding-js",534047:"nn-no-edu-js",534460:"eu-es-phonelink-sms-js",534464:"is-is-share-to-teams-js",534566:"nl-nl-comment-stream-js",534653:"data-resolvers-callable-channel",534677:"vi-vn-phonelink-sms-js",534853:"ro-ro-tfl-homepage-js",534909:"bg-bg-survey-js",535132:"onecamera-locale-nn-no",535188:"it-it-url-preview-js",535268:"es-es-people-targeting-js",535334:"sv-se-meeting-bot-js",535352:"ru-ru-queues-js",535737:"nn-no-framework-js",535771:"zh-cn-activity-js",535868:"en-us-discover-surface-js",535960:"en-US-UiStrings-json",536050:"uk-ua-compose-js",536061:"lt-lt-carousel-multi-card-js",536133:"otlang23",536166:"sk-sk-meet-for-work-js",536217:"calling-broadcast-container",536251:"sl-si-live-persona-card-js",536336:"sv-se-chat-list-js",536345:"r_data-resolvers-transcript",536427:"tr-tr-premium-benefits-js",536471:"cy-gb-extensibility-ptz-extension-js",536544:"sr-latn-rs-hololens-js",536585:"ru-ru-extensibility-room-remote-js",536674:"is-is-compose-js",536677:"fi-fi-autosuggest-js",536714:"fns74",536743:"da-dk-search-js",537295:"lt-lt-welcome-bot-js",537307:"es-mx-recurrence-js",537481:"components-screen-recorder34",537559:"onecamera-locale-fil",537596:"zh-tw-messaging-js",537913:"ams-video-player-engine2",537956:"et-ee-teams-and-channels-js",537971:"fil-ph-video-message-js",538094:"is-is-mtma-missed-notifications-js",538431:"services-suggestions",538443:"scaht-searchconvergedanswerteamsstrings-mr",538576:"hostDefaultsStrings74",538718:"tr-tr-meeting-bot-js",538783:"components-screen-recorder12",538850:"fi-fi-meeting-apis-app-js",538883:"es-strings-jsonThinRes",538988:"components-calling-park-screen",539087:"cy-gb-people-picker-js",539098:"flipcamera",539270:"hr-hr-nova-js",539457:"is-is-meeting-room-console-js",539706:"data-resolvers-tfl-meeting-links",539829:"r_data-resolvers-os-file-share",539854:"ca-es-valencia-virtual-events-js",539872:"onecamera-locale-sq",539908:"ja-jp-meeting-options-js",540355:"hostDefaultsStrings13",540434:"it-it-embed-js",540444:"nb-no-toast-notifications-js",540694:"sq-al-survey-js",540826:"components-screen-recorder104",540958:"az-latn-az-simple-collab-js",541071:"hostUxStrings63",541081:"uk-ua-desktop-js",541145:"scaht-cortextopictypeswebstrings_pt",541228:"ko-kr-share-in-meetings-js",541335:"el-gr-people-app-js",541602:"en-gb-framework-js",541874:"id-id-pre-core-js",541895:"fns38",542061:"hostDefaultsStrings2",542167:"eu-es-unsupported-browser-js",542212:"bg-bg-activity-js",542340:"vi-vn-welcome-bot-js",542371:"itemsview-deferredactions",542443:"mk-mk-lms-integration-js",543003:"cs-cz-unsupported-browser-js",543142:"en-us-hololens-js",543191:"lt-lt-premium-benefits-js",543200:"ru-ru-errors-js",543347:"webrec2-language-is",543386:"es-mx-telemetry-js",543405:"ka-ge-simple-collab-js",543458:"search-lazy-chunk",543611:"tr-tr-calendar-js",543779:"es-mx-hololens-js",543791:"pl-pl-extensibility-js",544136:"ca-es-valencia-toast-notifications-js",544162:"he-il-discover-surface-js",544208:"sht-cortextopictypeswebstrings_sr-cyrl-ba",544349:"cs-cz-calling-js",544462:"data-resolvers-search-prefetch",544689:"ca-es-message-escalate-dialog-js",544703:"pt-br-broadcast-js",544750:"da-dk-semantic-object-js",544947:"ja-jp-url-preview-js",544949:"ams-video-player",545046:"en-us-meeting-flyout-js",545055:"pt-pt-channels-js",545130:"fns21",545212:"sq-al-esp-js",545233:"tr-tr-meeting-room-console-js",545549:"id-id-people-picker-js",545931:"sv-se-carousel-multi-card-js",546310:"data-resolvers-browser-call-recording",546453:"sht-searchanswerteamsstrings_es-si-lk",546487:"en-us-queues-js",546639:"fns29",546821:"sr-latn-rs-teams-and-channels-js",546823:"otlang62",546921:"add-thread-member-dialog",546928:"en-us-help-js",546944:"tr-tr-freemium-upgrade-js",547091:"ru-ru-health-js",547092:"nb-no-url-preview-js",547175:"ru-ru-compose-js",547224:"hr-hr-meet-for-work-js",547236:"es-es-unified-search-js",547540:"InformationProtectionStrings42",547946:"pl-pl-toast-notifications-js",548220:"it-it-lms-integration-js",548278:"hr-hr-datepicker-js",548329:"ar-sa-compose-js",548380:"ko-kr-person-js",548479:"ar-sa-activity-js",548494:"cs-cz-guardians-js",548645:"he-il-rsc-application-permissions-js",548666:"ka-ge-framework-js",548697:"ca-es-valencia-audience-view-dialog-js",548715:"r_data-resolvers-channel-messages",548736:"nb-no-nova-js",548818:"ru-ru-extensibility-ptz-extension-js",549118:"ca-es-people-targeting-js",549270:"vi-vn-hololens-js",549343:"ko-kr-edu-js",549437:"ca-es-valencia-share-to-teams-outlook-addin-js",549584:"nb-no-freemium-upgrade-js",549629:"tr-tr-biometric-enrollment-js",549695:"scaht-searchconvergedanswerteamsstrings-ro",549746:"ru-ru-unsupported-browser-js",549779:"el-gr-recurrence-js",549782:"webrec2-language-sk",549784:"meeting-room-front-of-room-home",549895:"fil-ph-share-to-teams-js",550142:"sht-searchanswerteamsstrings_es-id",550237:"az-latn-az-avatar-js",550341:"hu-hu-people-js",550752:"lv-lv-share-to-teams-third-party-js",550853:"is-is-esp-js",551011:"sht-searchanswerteamsstrings_es-sv",551018:"ar-sa-channels-js",551072:"navigationPanelShimmer",551329:"scaht-searchconvergedanswerteamsstrings-de",551353:"nb-no-artifacts-platform-js",551379:"lt-lt-esp-js",551442:"hi-in-chat-list-js",551444:"is-is-artifacts-platform-js",551632:"et-ee-meeting-recap-js",551689:"ar-sa-url-preview-js",551702:"tr-tr-shortcuts-js",551783:"hi-in-lms-integration-js",551792:"services-webinar",551947:"mk-mk-messaging-js",551961:"id-id-campaign-notifications-js",552067:"th-th-meeting-room-console-js",552154:"kk-kz-digital-signage-js",552198:"it-it-meeting-collaboration-js",552241:"sht-searchanswerteamsstrings_es-tt",552708:"lt-lt-calendar-js",552857:"otlang78",553026:"lt-lt-embed-js",553182:"sk-sk-virtual-events-js",553598:"el-gr-growth-js",553613:"ru-ru-nova-js",553762:"hi-in-funstuff-js",554018:"webrec2-language-sr-cyrl-rs",554189:"et-ee-teams-insider-js",554280:"pl-pl-meeting-collaboration-js",554309:"vi-vn-calling-js",554572:"onecamera-locale-hu",554696:"cs-cz-desktop-js",554800:"uk-ua-discover-surface-js",555045:"mk-mk-files-js",555145:"fil-ph-shortcut-js",555253:"r_data-schema",555437:"eu-es-compose-js",555549:"InformationProtectionStrings23",555662:"sq-al-teams-and-channels-js",555811:"bg-bg-biometric-enrollment-js",555856:"fr-ca-lms-integration-js",555910:"et-ee-simple-collab-js",555919:"data-resolvers-user-preferences",555989:"data-resolvers-mesh-audio",556073:"sk-sk-url-preview-js",556272:"sht-cortextopictypeswebstrings_fa",556551:"ka-ge-extensibility-js",556625:"fr-fr-edu-js",556929:"ca-es-telemetry-js",556964:"lv-lv-video-message-js",557148:"bg-bg-artifacts-platform-js",557458:"et-ee-carousel-multi-card-js",557549:"ja-jp-toast-notifications-js",557579:"az-latn-az-artifacts-platform-js",557681:"sk-sk-messaging-js",557810:"fi-fi-discover-surface-js",557931:"ca-es-valencia-feedback-js",558202:"fr-ca-teams-and-channels-js",558582:"r_data-resolvers-browser-ams",558632:"sv-se-meet-for-work-js",558862:"eu-es-communities-js",558990:"gl-es-meeting-options-js",559067:"platform-app",559176:"es-mx-auth-js",559216:"uk-ua-freemium-js",559349:"sq-al-communities-js",559508:"fns22",559515:"es-es-lms-integration-js",559521:"sv-se-person-js",560303:"ka-ge-errors-js",560311:"he-il-meeting-room-console-js",560382:"otlang94",560437:"pl-pl-webinar-js",560811:"team-dashboard",561167:"topics-sdk-aria-sdk",561319:"zh-cn-files-js",561458:"lv-lv-jana-js",561542:"zh-tw-message-escalate-dialog-js",561579:"cs-cz-contacts-js",561631:"gl-es-calling-js",561702:"nb-no-tfl-onboarding-js",561706:"is-is-jana-js",561861:"vi-vn-gallery-js",561877:"ro-ro-share-in-meetings-js",562256:"cs-cz-channels-js",563123:"sq-al-artifacts-platform-js",563136:"kk-kz-unsupported-browser-js",563179:"hi-in-coach-report-js",563258:"az-latn-az-shortcuts-js",563393:"fr-ca-framework-js",563694:"mk-mk-meeting-apis-app-js",564113:"zh-tw-webinar-js",564138:"ca-es-valencia-pre-core-js",564145:"hostDefaultsStrings85",564559:"es-es-extensibility-ptz-extension-js",564670:"nl-nl-compose-js",564709:"es-es-semantic-object-js",564752:"es-es-growth-js",564762:"zh-tw-chat-list-js",564830:"fr-fr-meeting-bot-js",564898:"en-gb-share-in-meetings-js",564900:"bg-bg-people-app-js",565306:"team-settings",565327:"vi-vn-jana-js",565656:"shareDialog",565748:"sht-cortextopictypeswebstrings_tk-tm",566001:"gl-es-freemium-upgrade-js",566124:"th-th-communities-js",566206:"ka-ge-phonelink-sms-js",566493:"data-resolvers-browser-activity",566626:"es-es-recurrence-js",566681:"el-gr-discover-surface-js",566875:"pt-pt-search-js",566896:"fns31",567014:"tr-tr-extensibility-js",567548:"da-dk-meeting-room-console-js",567856:"am-ET-UiStrings-json",567922:"ko-kr-channels-js",567997:"pl-pl-files-js",568260:"fi-fi-extensibility-room-remote-js",568330:"et-ee-communities-js",568481:"r_data-resolvers-contacts-sync-settings",568725:"ko-kr-presence-js",568740:"calls-main-app",568770:"r_data-resolvers-manage-tenant",568942:"lt-lt-rsc-application-permissions-js",569102:"et-ee-esp-js",569423:"ja-jp-people-targeting-js",569598:"hr-hr-shortcuts-js",569797:"sq-al-person-js",569839:"lt-lt-artifacts-platform-js",569979:"ca-es-activity-js",569981:"eu-es-share-to-teams-js",570014:"bg-bg-smart-device-js",570266:"fns77",570357:"sr-latn-rs-meeting-room-console-js",570498:"ru-ru-search-js",570619:"mk-mk-compose-js",570822:"en-GB-UiStrings-json",570872:"hostDefaultsStrings17",571047:"hi-in-framework-js",571078:"it-it-meeting-room-console-js",571118:"fr-ca-presence-js",571238:"he-il-people-picker-js",571341:"nl-nl-search-js",571383:"otlang106",571406:"et-ee-extensibility-ptz-extension-js",571850:"es-es-breakout-rooms-js",572067:"ro-ro-mtma-missed-notifications-js",572108:"th-th-framework-js",572239:"pt-br-errors-js",572766:"es-es-freemium-js",572781:"es-es-people-js",572914:"it-it-health-js",573292:"nb-no-esp-js",573366:"hu-hu-campaign-notifications-js",573381:"gl-es-pre-core-js",573484:"bg-bg-feedback-js",573668:"sk-sk-presence-js",573694:"es-mx-guardians-js",573790:"sv-se-hololens-js",573936:"ru-ru-premium-benefits-js",574091:"calling-app-post-critical",574214:"lv-lv-freemium-js",574464:"scaht-cortextopictypeswebstrings_et",574516:"mo-people-selection",574615:"ca-es-webinar-js",574649:"es-es-files-js",575e3:"is-is-feedback-js",575107:"sr-latn-rs-extensibility-room-remote-js",575207:"zh-cn-digital-signage-js",575489:"hr-hr-meeting-bot-js",575575:"tr-tr-settings-js",575810:"ru-ru-share-to-teams-outlook-addin-js",575962:"hi-in-datepicker-js",576100:"es-mx-presence-js",576215:"es-mx-jana-js",576306:"sk-sk-channels-js",576476:"he-il-auth-js",576708:"sq-al-pre-core-js",576971:"sq-al-tfl-onboarding-js",577783:"cy-gb-health-js",578006:"en-us-carousel-multi-card-js",578065:"hu-hu-pre-core-js",578195:"components-calling-paywall-end-screen",578351:"el-gr-webinar-js",578683:"cy-gb-recurrence-js",578781:"is-is-share-in-meetings-js",578787:"el-gr-sv-flyout-js",578990:"pl-pl-video-capture-js",578991:"fil-ph-freemium-upgrade-js",579093:"mk-mk-pre-core-js",579197:"services-external-calendar-email-address",579333:"zh-tw-meeting-analytics-js",579536:"gl-es-autosuggest-js",579538:"zh-tw-digital-signage-js",579706:"he-il-phonelink-sms-js",579804:"uk-ua-nova-js",580075:"hu-hu-gallery-js",580120:"eu-es-digital-signage-js",580480:"zh-cn-premium-benefits-js",580584:"fns48",580620:"fr-ca-carousel-multi-card-js",580871:"lt-lt-meeting-collaboration-js",580891:"compose-debug-handlers",580907:"InformationProtectionStrings66",580947:"pt-br-hololens-js",581034:"fil-ph-feedback-js",581148:"deferred",581159:"r_data-resolvers-transcript-settings-store",581181:"ca-es-comment-stream-js",581322:"nb-no-rsc-application-permissions-js",581354:"fr-fr-live-persona-editor-js",581369:"ca-es-errors-js",581414:"lt-lt-jana-js",581512:"ca-es-valencia-settings-js",581588:"sk-sk-welcome-bot-js",581598:"th-th-people-targeting-js",581675:"ar-sa-share-to-teams-js",581682:"otlang82",581695:"hr-hr-freemium-js",581771:"it-it-nova-js",581857:"ca-es-valencia-gallery-js",581871:"en-us-meeting-apis-app-js",581933:"otlang4",582193:"sv-se-meeting-room-console-js",582271:"react-diagnostics",582290:"broadcast-producer-screen",582523:"zh-tw-premium-benefits-js",582678:"es-es-meeting-meet-app-js",582862:"sr-latn-rs-datepicker-js",582897:"sl-si-help-js",583175:"hi-in-live-persona-card-js",583194:"core-services-cdl-worker-debug",583320:"r_data-resolvers-view-schema",583344:"he-il-share-to-teams-outlook-addin-js",583517:"kk-kz-channels-js",583576:"cs-cz-search-js",583607:"de-strings-jsonThinRes",583651:"lv-lv-biometric-enrollment-js",583959:"de-de-edu-js",584228:"el-gr-people-targeting-js",584266:"zh-tw-shortcuts-js",584405:"sr-latn-rs-teams-insider-js",584539:"onecamera-locale-he",584858:"hu-hu-coach-report-js",585077:"services-io-browser-calling-video-rendering",585108:"services-app-based-link",585678:"nb-no-video-capture-js",585819:"webrec2-language-fr",585918:"fr-ca-people-picker-js",586037:"scaht-searchconvergedanswerteamsstrings-ca",586060:"data-resolvers-search",586090:"data-resolvers-example",586367:"it-it-virtual-events-js",586395:"hostUxStrings22",586509:"sht-teams-externalanswers",586812:"hi-in-message-escalate-dialog-js",586989:"otlang70",587218:"fr-fr-cast-js",587321:"ka-ge-files-js",587384:"webrec2-language-et",587438:"el-gr-meeting-apis-app-js",587450:"uk-ua-people-js",587492:"fi-fi-share-to-teams-outlook-addin-js",587495:"eu-es-shortcut-js",587577:"sl-si-contacts-js",587588:"lt-lt-chat-list-js",587793:"ca-ES-UiStrings-json",587864:"cs-cz-calendar-js",587989:"tr-tr-avatar-js",588026:"calling-cdl",588116:"it-it-growth-js",588257:"pt-pt-guardians-js",588314:"data-resolvers-browser-chat",588593:"cs-cz-autosuggest-js",588637:"ru-ru-host-controls-js",588658:"zh-cn-audience-view-dialog-js",588891:"InformationProtectionStrings27",588919:"platform-modal",589005:"fi-fi-simple-collab-js",589142:"he-il-channels-js",589154:"ro-ro-meeting-apis-app-js",589434:"ko-kr-share-to-teams-outlook-addin-js",589438:"el-gr-calendar-js",589487:"ar-sa-sv-flyout-js",589799:"is-is-embed-js",589947:"ro-ro-communities-js",589989:"fi-fi-meeting-options-js",590132:"sk-sk-communities-js",590145:"fil-ph-lightbox-js",590442:"sq-al-coach-report-js",590538:"he-il-avatar-js",590640:"es-mx-meeting-meet-app-js",590769:"vi-vn-avatar-js",590842:"sq-al-breakout-rooms-js",591049:"de-de-tfl-homepage-js",591200:"kk-kz-smart-device-js",591494:"services-atp-safelinks",591540:"ca-es-valencia-datepicker-js",591554:"eu-es-meeting-flyout-js",591679:"r_data-resolvers-people-picker",591776:"tr-tr-sv-flyout-js",591853:"scaht-cortextopictypeswebstrings_kn",592053:"es-es-people-app-js",592101:"ca-es-sv-flyout-js",592203:"ru-ru-coach-report-js",592222:"nn-no-unsupported-browser-js",592294:"sk-sk-toast-notifications-js",592295:"uk-ua-meeting-analytics-js",592366:"ko-kr-nova-js",592424:"ro-ro-teams-insider-js",592496:"sk-sk-help-js",592546:"da-dk-toast-notifications-js",593038:"ar-sa-lms-integration-js",593058:"sk-sk-meeting-options-js",593357:"fr-ca-campaign-notifications-js",593704:"az-latn-az-freemium-js",593860:"el-gr-framework-js",594037:"hu-hu-tfl-homepage-js",594210:"gl-es-errors-js",594236:"calling-debug",594311:"ko-kr-teams-and-channels-js",594431:"da-dk-biometric-enrollment-js",594527:"sr-latn-rs-help-js",594865:"en-us-share-to-teams-outlook-addin-js",595017:"is-is-freemium-upgrade-js",595214:"ca-es-semantic-object-js",595233:"scaht-cortextopictypeswebstrings_fr-ca",595239:"nl-nl-files-js",595341:"hostUxStrings26",595518:"categories-ur-pk-json",595554:"hu-hu-auth-js",595638:"cy-gb-wiki-js",595655:"nl-nl-people-targeting-js",595809:"nn-no-meeting-recap-js",595862:"InformationProtectionStrings10",596181:"zh-cn-settings-js",596201:"mk-mk-esp-js",596860:"nl-nl-datepicker-js",597085:"categories-fr-fr-json",597090:"ro-ro-gallery-js",597256:"sv-se-premium-benefits-js",597291:"pt-pt-recurrence-js",597442:"eu-es-meeting-stream-app-js",597475:"kk-kz-shortcuts-js",597633:"scaht-searchconvergedanswerteamsstrings-fil",597732:"gl-es-share-to-teams-outlook-addin-js",598071:"et-ee-auth-js",598156:"webrec2-language-id",598244:"ar-sa-feedback-js",598330:"ru-ru-lms-integration-js",598410:"sr-latn-rs-chat-list-js",598805:"kk-kz-share-to-teams-outlook-addin-js",598854:"hr-hr-lightbox-js",598885:"sr-latn-rs-live-persona-editor-js",598989:"categories-fr-ca-json",599025:"pl-pl-shortcut-js",599619:"pt-pt-meeting-stream-app-js",599657:"r_data-resolvers-cypress-only",599928:"components-screen-recorder40",600025:"nn-no-comment-stream-js",600511:"hr-hr-unified-search-js",600574:"lv-lv-help-js",600788:"eu-es-funstuff-js",601032:"he-il-chat-list-js",601349:"kk-kz-video-message-js",601407:"ja-jp-calling-js",601576:"nn-no-settings-js",601667:"fr-ca-comment-stream-js",601687:"kk-kz-premium-benefits-js",601712:"az-latn-az-premium-benefits-js",601915:"calendar-create-event-intent-container",601938:"r_data-resolvers-import-msa-contacts",601959:"ca-es-valencia-message-escalate-dialog-js",602092:"vi-vn-extensibility-room-remote-js",602252:"en-us-audience-view-dialog-js",602311:"vi-vn-rsc-application-permissions-js",602398:"he-il-teams-insider-js",602452:"da-dk-freemium-upgrade-js",602605:"ca-es-framework-js",602767:"scaht-cortextopictypeswebstrings_zu-za",603081:"vi-vn-lms-integration-js",603215:"scaht-searchconvergedanswerteamsstrings-ja",603418:"nb-no-shortcut-js",603440:"scaht-cortextopictypeswebstrings_am",603576:"hostUxStrings18",603874:"sq-al-share-to-teams-outlook-addin-js",603921:"ro-ro-edu-js",603983:"en-us-extensibility-room-remote-js",604178:"fi-fi-meeting-flyout-js",604835:"it-it-tfl-homepage-js",605239:"vi-vn-errors-js",605412:"mk-mk-message-escalate-dialog-js",605443:"hostUxStrings10",605671:"hi-in-recurrence-js",605706:"fi-fi-people-targeting-js",605823:"da-dk-phonelink-sms-js",606085:"r_data-resolvers-esp",606114:"mk-mk-people-app-js",606208:"r_data-resolvers-compose-language",606227:"id-id-meet-for-work-js",606232:"en-us-coach-report-js",606317:"adaptivecard",606408:"services-tpn-notice",606545:"services-refresh-site-url",606645:"fr-fr-premium-benefits-js",606695:"r_data-client-calling",606780:"sk-sk-meeting-meet-app-js",606824:"tr-tr-feedback-js",607015:"is-is-sv-flyout-js",607028:"fil-ph-share-in-meetings-js",607275:"nn-no-jana-js",607673:"discover-surface-entry-and-offline-main",607726:"fr-fr-embed-js",607729:"az-latn-az-toast-notifications-js",607932:"data-resolvers-notifications-engine",607948:"ro-ro-phonelink-sms-js",608077:"ro-ro-video-capture-js",608108:"o365-connector-card",608178:"az-latn-az-breakout-rooms-js",608468:"mk-mk-teams-insider-js",608470:"hu-hu-host-controls-js",608927:"pl-pl-esp-js",608983:"global-auth",609050:"webrec2-language-az-latn-az",609301:"az-latn-az-meeting-apis-app-js",609339:"socketModule",609408:"vi-vn-compose-js",609636:"ko-kr-desktop-js",609652:"r_data-resolvers-connectors",609916:"r_data-schema-cdl",609962:"sv-se-esp-js",610190:"uk-strings-jsonThinRes",610234:"sr-latn-rs-comment-stream-js",610358:"en-gb-avatar-js",610634:"scaht-cortextopictypeswebstrings_ka",610698:"es-es-share-to-teams-third-party-js",610883:"fi-fi-meeting-room-console-js",610898:"r_data-resolvers-notifications-engine",611343:"hr-hr-extensibility-ptz-extension-js",611529:"gl-es-carousel-multi-card-js",611682:"components-screen-recorder74",611763:"shakaengine",611853:"vi-vn-toast-notifications-js",611880:"sq-al-files-js",611893:"is-is-meeting-analytics-js",612145:"cy-gb-framework-js",612154:"lv-lv-broadcast-js",612486:"hostUxStrings76",612579:"et-ee-message-escalate-dialog-js",613078:"ja-jp-queues-js",613179:"es-es-carousel-multi-card-js",613549:"services-user-profile",613587:"scaht-searchconvergedanswerteamsstrings-quz-pe",613609:"topics-sdk-loki-api",613734:"ca-es-files-js",613762:"hu-hu-edu-js",613763:"hu-hu-teams-insider-js",613785:"nb-no-unsupported-browser-js",613796:"sl-si-settings-js",613963:"sr-latn-rs-tfl-homepage-js",613973:"pt-pt-share-in-meetings-js",614200:"hu-hu-avatar-js",614316:"nn-no-broadcast-js",614493:"sht-cortextopictypeswebstrings_pa-in",614538:"da-dk-share-to-teams-outlook-addin-js",614553:"ca-es-valencia-desktop-js",614640:"cs-cz-url-preview-js",614991:"ca-es-valencia-growth-js",615263:"ka-ge-people-app-js",615372:"he-il-artifacts-platform-js",615482:"id-id-tfl-homepage-js",615505:"sr-latn-rs-nova-js",615584:"fil-ph-meeting-flyout-js",615632:"en-us-teams-and-channels-js",615700:"cs-cz-shortcut-js",616037:"sht-searchanswerteamsstrings_es-it",616052:"es-mx-webinar-js",616179:"nb-no-extensibility-js",616415:"nb-no-messaging-js",616738:"sr-latn-rs-framework-js",616760:"nl-nl-lms-integration-js",616774:"fr-fr-lms-integration-js",616789:"zh-cn-lightbox-js",616862:"zh-cn-lms-integration-js",617091:"kk-kz-chat-list-js",617235:"ar-sa-people-picker-js",617263:"components-screen-recorder28",617589:"fi-fi-datepicker-js",617598:"nn-no-errors-js",617703:"et-ee-toast-notifications-js",617716:"it-it-artifacts-platform-js",617759:"sk-sk-edu-js",617804:"az-latn-az-live-persona-card-js",617981:"ca-es-meeting-apis-app-js",618225:"sl-si-live-persona-editor-js",618231:"ca-es-people-picker-js",618719:"categories-ca-es-json",618827:"fr-fr-errors-js",618845:"zh-cn-breakout-rooms-js",619114:"data-resolvers-mention",619158:"az-latn-az-meeting-bot-js",619228:"r_data-resolvers-browser-notifications-settings",619436:"th-th-extensibility-ptz-extension-js",619908:"InformationProtectionStrings36",620047:"hostUxStrings71",620089:"kk-kz-auth-js",620188:"services-broadcast-streaming-attendee",620244:"az-latn-az-welcome-bot-js",620272:"categories-te-in-json",620356:"hostDefaultsStrings72",620461:"ko-kr-calendar-js",620477:"sv-se-errors-js",621125:"bg-bg-growth-js",621177:"da-dk-welcome-bot-js",621535:"ja-jp-communities-js",621583:"en-gb-premium-benefits-js",621819:"kk-kz-people-picker-js",621886:"r_data-resolvers-bots-platform",621958:"ro-ro-growth-js",622121:"services-file-upload",622490:"nb-no-recurrence-js",622504:"r_data-resolvers-fluid",622562:"az-latn-az-chat-list-js",622768:"ar-sa-jana-js",622892:"fr-ca-auth-js",623077:"scaht-searchconvergedanswerteamsstrings-lt",623134:"da-dk-person-js",623135:"mk-mk-smart-device-js",623310:"fr-fr-virtual-events-js",623440:"ko-kr-semantic-object-js",623568:"data-resolvers-mtma-user-data",623675:"errorConverter",623759:"data-resolvers-capiv3-contacts-state",623822:"sv-se-avatar-js",624009:"scaht-searchconvergedanswerteamsstrings-bg",624099:"sk-sk-sv-flyout-js",624149:"ru-ru-meeting-meet-app-js",624179:"fr-fr-jana-js",624191:"de-de-hololens-js",624307:"ka-ge-coach-report-js",624361:"hr-hr-share-in-meetings-js",624518:"nn-no-contacts-js",624556:"categories-sr-Cyrl-RS-json",624704:"fr-ca-meeting-analytics-js",624754:"sr-latn-rs-people-app-js",624796:"nn-no-tfl-homepage-js",624838:"bg-bg-broadcast-js",624879:"nb-no-lms-integration-js",625033:"es-mx-campaign-notifications-js",625041:"r_data-resolvers-live-state-broadcast",625331:"gl-es-lms-integration-js",625344:"az-latn-az-health-js",625454:"id-id-telemetry-js",625702:"InformationProtectionStrings80",625769:"he-il-meeting-bot-js",626102:"sv-se-jana-js",626252:"th-th-carousel-multi-card-js",626298:"bg-bg-meeting-collaboration-js",626317:"r_data-resolvers-files",626510:"broadcast-qna",626759:"data-resolvers-pstn",626851:"da-dk-framework-js",626889:"lt-lt-unified-search-js",626913:"ko-kr-chat-list-js",626988:"el-gr-auth-js",627058:"cs-cz-webinar-js",627145:"it-it-calendar-js",627366:"mk-mk-toast-notifications-js",627386:"components-screen-recorder42",627576:"cy-gb-activity-js",627994:"de-de-desktop-js",628035:"uk-ua-virtual-events-js",628041:"eu-es-sv-flyout-js",628202:"ar-sa-calling-js",628471:"otlang56",628474:"sl-si-people-picker-js",628564:"et-EE-UiStrings-json",628895:"es-es-artifacts-platform-js",628907:"data-resolvers-immersive-view",629095:"categories-id-id-json",629233:"tr-tr-funstuff-js",629504:"es-es-extensibility-js",629844:"webrec2-language-lt",630041:"ko-kr-gallery-js",630209:"cs-cz-growth-js",630672:"lv-lv-auth-js",630793:"da-dk-recurrence-js",630962:"en-gb-sv-flyout-js",630964:"pl-pl-help-js",631007:"az-latn-az-semantic-object-js",631211:"nl-nl-pre-core-js",631240:"pt-pt-avatar-js",631593:"nn-no-queues-js",631702:"nb-no-strings-jsonThinRes",631845:"fil-ph-meeting-meet-app-js",631967:"sht-cortextopictypeswebstrings_bn-bd",632173:"es-mx-unsupported-browser-js",632262:"en-us-extensibility-js",632287:"ca-es-valencia-coach-report-js",632323:"onecamera-locale-sl",632412:"is-is-campaign-notifications-js",632562:"fi-fi-meeting-bot-js",632584:"is-is-nova-js",632606:"el-gr-shortcut-js",632626:"ro-ro-cast-js",632712:"fr-ca-rsc-application-permissions-js",632825:"et-ee-guardians-js",632877:"hr-hr-comment-stream-js",632896:"ar-sa-gallery-js",632993:"hr-hr-teams-and-channels-js",633004:"fi-fi-live-persona-card-js",633145:"sr-latn-rs-live-persona-card-js",633510:"uk-ua-shortcuts-js",633602:"fil-ph-edu-js",633642:"hostUxStrings3",633780:"es-mx-people-app-js",633866:"sk-sk-biometric-enrollment-js",633868:"nl-nl-avatar-js",634077:"fr-fr-toast-notifications-js",634517:"lv-lv-phonelink-sms-js",634692:"services-chat-endpoint-provider",634930:"sq-al-settings-js",635024:"webrec2-language-eu",635300:"ka-ge-auth-js",635677:"et-ee-comment-stream-js",635791:"nb-no-breakout-rooms-js",635815:"ca-es-valencia-recurrence-js",635968:"fr-fr-message-escalate-dialog-js",636318:"ko-kr-share-to-teams-third-party-js",636324:"pt-br-comment-stream-js",636358:"ko-kr-welcome-bot-js",636446:"cy-gb-people-targeting-js",636501:"ro-ro-wiki-js",636601:"ro-ro-extensibility-room-remote-js",636608:"nn-no-live-persona-editor-js",636759:"onecamera-locale-hi",636805:"vi-vn-live-persona-card-js",636878:"sq-al-freemium-js",636934:"id-id-phonelink-sms-js",637327:"uk-ua-extensibility-ptz-extension-js",637388:"lt-lt-virtual-events-js",637406:"ru-ru-cast-js",637418:"ko-kr-coach-report-js",637662:"zh-cn-whats-new-js",637854:"fr-ca-nova-js",637865:"hr-hr-meeting-recap-js",637947:"vi-vn-webinar-js",638042:"ka-ge-extensibility-ptz-extension-js",638563:"bg-bg-lightbox-js",638620:"fr-ca-extensibility-ptz-extension-js",638829:"sr-latn-rs-shortcut-js",638830:"nl-nl-meeting-bot-js",639237:"et-ee-growth-js",639363:"categories-af-za-json",639455:"lv-lv-comment-stream-js",639696:"ko-kr-comment-stream-js",639910:"az-latn-az-funstuff-js",639977:"cy-gb-autosuggest-js",640162:"es-es-esp-js",640182:"ca-es-host-controls-js",640184:"kk-kz-telemetry-js",640250:"et-ee-queues-js",640347:"es-es-funstuff-js",640628:"r_data-resolvers-activity",640637:"et-ee-campaign-notifications-js",640852:"cs-cz-health-js",641007:"hostUxStrings41",641091:"r_data-resolvers-whats-new",641127:"webview2-service",641133:"vi-vn-guardians-js",641272:"hostDefaultsStrings3",641308:"da-dk-meeting-meet-app-js",641355:"ca-es-virtual-events-js",641463:"en-us-datepicker-js",641725:"kk-kz-semantic-object-js",641773:"it-it-share-to-teams-js",641781:"nl-nl-meeting-meet-app-js",641816:"es-es-whats-new-js",641847:"ar-sa-growth-js",641886:"es-mx-settings-js",642242:"pl-pl-whats-new-js",642298:"az-latn-az-teams-and-channels-js",642301:"et-ee-cast-js",642371:"gl-es-people-app-js",642420:"ar-sa-embed-js",642449:"zh-cn-mtma-missed-notifications-js",642548:"fi-fi-broadcast-js",642904:"gl-es-people-js",643054:"fns85",643138:"es-es-tfl-homepage-js",643461:"hu-hu-comment-stream-js",643511:"eu-es-search-js",644009:"ro-ro-message-escalate-dialog-js",644019:"cy-gb-video-capture-js",644626:"pl-pl-desktop-js",644634:"otlang118",644688:"sv-se-whats-new-js",644713:"pt-br-tfl-onboarding-js",644746:"nn-no-desktop-js",644878:"pl-pl-activity-js",644880:"ca-es-valencia-telemetry-js",644924:"bg-bg-meeting-recap-js",644935:"tr-tr-video-capture-js",645207:"lv-lv-share-to-teams-js",645284:"kk-kz-simple-collab-js",645722:"mk-mk-extensibility-room-remote-js",645913:"lazy-whiteboard-walk-up-experience",646119:"cortana-popup",646156:"ro-ro-share-to-teams-third-party-js",646391:"es-mx-premium-benefits-js",646433:"onePlayerLoader",646586:"cy-gb-embed-js",646639:"categories-nl-nl-json",646647:"ar-sa-semantic-object-js",646900:"sq-al-extensibility-room-remote-js",646936:"sq-al-telemetry-js",647461:"otlang52",647584:"da-dk-telemetry-js",647708:"it-it-video-capture-js",647799:"ca-es-discover-surface-js",647821:"ro-ro-esp-js",647882:"hi-in-rsc-application-permissions-js",648123:"de-de-extensibility-ptz-extension-js",648173:"hu-hu-meeting-room-console-js",648292:"pt-br-shortcuts-js",648337:"nl-nl-premium-benefits-js",648372:"de-de-breakout-rooms-js",648421:"onecamera-locale-zh-hans",648441:"scaht-cortextopictypeswebstrings_ml",648496:"mk-mk-search-js",649133:"fr-ca-meeting-collaboration-js",649330:"pt-br-survey-js",649841:"kk-kz-broadcast-js",649880:"services-MeetingRecapSwaservice",649941:"sr-latn-rs-meeting-meet-app-js",650073:"nl-nl-meeting-options-js",650091:"el-gr-hololens-js",650165:"vi-vn-host-controls-js",650238:"fns67",650284:"hostUxStrings16",650575:"cs-cz-share-to-teams-third-party-js",650756:"locked-teams-activate-dialog",650930:"is-is-search-js",651070:"webrec2-language-pl",651226:"r_data-resolvers-browser-payment",651995:"sq-al-video-message-js",652116:"th-th-message-escalate-dialog-js",652168:"ro-ro-calendar-js",652624:"copilot-container-panel",652763:"fil-PH-UiStrings-json",652828:"lt-lt-video-message-js",652906:"id-id-teams-and-channels-js",652953:"nn-no-webinar-js",652975:"uk-ua-people-picker-js",653047:"scaht-searchconvergedanswerteamsstrings-pa-in",653295:"it-it-edu-js",653314:"nb-no-biometric-enrollment-js",653353:"ro-ro-meeting-room-console-js",653406:"pl-pl-meeting-stream-app-js",653484:"hi-strings-jsonThinRes",653758:"is-is-messaging-js",653903:"en-gb-hololens-js",653930:"nl-nl-contacts-js",653937:"id-id-datepicker-js",654198:"components-compose-extensions",654272:"vi-vn-meeting-recap-js",654943:"he-il-share-in-meetings-js",655033:"sht-searchanswerteamsstrings_es-sw",655151:"onecamera-locale-uk",655167:"es-mx-coach-report-js",655402:"services-io-tfl-user",655736:"he-il-breakout-rooms-js",655939:"fr-fr-sv-flyout-js",656157:"he-il-hololens-js",656276:"uk-ua-meeting-flyout-js",656660:"th-th-phonelink-sms-js",656713:"az-latn-az-comment-stream-js",656737:"services-collab-object",656765:"sq-al-meeting-recap-js",656777:"pt-br-digital-signage-js",656906:"uk-ua-coach-report-js",656922:"el-gr-funstuff-js",657107:"he-il-whats-new-js",657191:"ca-es-valencia-nova-js",657330:"hr-hr-growth-js",658291:"fi-fi-welcome-bot-js",658310:"fi-fi-breakout-rooms-js",658335:"tr-tr-embed-js",658395:"de-DE-UiStrings-json",658438:"services-io-browser-video-message-camera-command",658511:"sr-latn-rs-telemetry-js",658610:"ar-sa-shortcut-js",658736:"fr-ca-autosuggest-js",659045:"sv-se-health-js",659074:"vi-vn-lightbox-js",659081:"scaht-cortextopictypeswebstrings_ug-cn",659098:"services-store",659141:"fr-fr-calling-js",659412:"r_data-resolvers-apps-monet",659831:"components-screen-recorder30",660115:"data-resolvers-policies",660171:"id-id-queues-js",660243:"sv-se-meeting-collaboration-js",660273:"hi-in-edu-js",660334:"da-dk-unified-search-js",660693:"zh-cn-campaign-notifications-js",660920:"uk-ua-framework-js",660956:"de-de-biometric-enrollment-js",661051:"create-folder-dialog",661111:"de-de-autosuggest-js",661172:"sk-sk-jana-js",661765:"es-es-meeting-analytics-js",662091:"zh-tw-comment-stream-js",662153:"categories-kn-in-json",662283:"pt-pt-calendar-js",662305:"fil-ph-share-to-teams-third-party-js",662463:"sht-searchanswerteamsstrings_es-ru",663296:"zh-cn-funstuff-js",663304:"ca-es-valencia-video-capture-js",663580:"sl-si-teams-insider-js",663763:"sq-al-hololens-js",663799:"cs-cz-teams-and-channels-js",663936:"meeting-apps-flyout-renderer",664084:"hr-hr-feedback-js",664089:"InformationProtectionStrings44",664140:"en-gb-guardians-js",664501:"sht-cortextopictypeswebstrings_ug-cn",664543:"gl-es-meeting-bot-js",664864:"fi-fi-whats-new-js",664915:"th-th-growth-js",664930:"et-ee-embed-js",665061:"lt-lt-calling-js",665242:"fluid-message-container",665284:"fr-fr-tfl-homepage-js",665347:"r_data-resolvers-collab-cloud",665666:"r_data-resolvers-browser-communities",665670:"ca-es-valencia-meeting-recap-js",665682:"gl-es-feedback-js",665831:"scaht-cortextopictypeswebstrings_cy",665934:"nn-no-avatar-js",666397:"tr-tr-tfl-onboarding-js",666482:"hostDefaultsStrings34",666518:"da-dk-wiki-js",666555:"scaht-searchconvergedanswerteamsstrings-kok",666581:"gl-es-meeting-flyout-js",666836:"r_data-resolvers-callable-channel",666907:"ro-ro-compose-js",666917:"bg-bg-meeting-flyout-js",666949:"pt-br-toast-notifications-js",667069:"pl-pl-people-picker-js",667128:"da-dk-messaging-js",667142:"pt-br-strings-jsonThinRes",667288:"hostDefaultsStrings45",667417:"call-blocking-service",667606:"el-gr-extensibility-js",667615:"ko-kr-extensibility-room-remote-js",667978:"nb-no-tfl-homepage-js",668018:"otlang38",668029:"ja-jp-meeting-bot-js",668265:"sk-sk-artifacts-platform-js",668286:"ga-IE-UiStrings-json",668299:"fns43",668331:"vi-vn-whats-new-js",668416:"nl-nl-meet-for-work-js",668508:"hr-hr-coach-report-js",668781:"is-is-tfl-onboarding-js",668987:"el-gr-channels-js",669027:"fr-fr-discover-surface-js",669065:"et-ee-welcome-bot-js",669469:"lt-lt-extensibility-js",669528:"ka-ge-share-to-teams-third-party-js",669721:"ka-ge-unified-search-js",669733:"services-io-organization-info",669982:"live-interpreter-promotion-dialog-container",670059:"otlang110",670125:"gl-es-meeting-meet-app-js",670362:"de-de-growth-js",670719:"ru-ru-tfl-onboarding-js",670810:"el-gr-jana-js",670825:"it-it-welcome-bot-js",670941:"long-lived-subscription-for-channels-app",670947:"ar-sa-shortcuts-js",670966:"ca-es-meet-for-work-js",670972:"services-import-msa-contacts",671219:"it-it-whats-new-js",671980:"cy-gb-strings-jsonThinRes",671994:"sq-al-premium-benefits-js",672007:"sv-se-live-persona-editor-js",672023:"et-ee-digital-signage-js",672046:"eu-es-comment-stream-js",672603:"bg-bg-video-capture-js",672754:"nb-no-person-js",672777:"scaht-searchconvergedanswerteamsstrings-ka",672787:"about-tab-renderer",672819:"en-gb-breakout-rooms-js",672830:"he-il-biometric-enrollment-js",672975:"et-ee-live-persona-card-js",673049:"fi-fi-search-js",673121:"teams-grid",673124:"pt-br-sv-flyout-js",673411:"id-id-autosuggest-js",673546:"pl-pl-extensibility-ptz-extension-js",673680:"categories-zh-hk-json",673930:"zh-cn-meeting-room-console-js",674093:"he-il-queues-js",674399:"nn-no-phonelink-sms-js",674562:"bg-bg-calendar-js",674802:"da-dk-simple-collab-js",674946:"ro-ro-audience-view-dialog-js",675293:"sk-sk-share-to-teams-outlook-addin-js",675311:"hr-hr-settings-js",675336:"es-mx-growth-js",675676:"sk-sk-people-js",675826:"de-de-meeting-room-console-js",675831:"ka-ge-unsupported-browser-js",676007:"onecamera-locale-ro",676028:"da-dk-activity-js",676130:"services-presence",676165:"mk-mk-recurrence-js",676179:"whiteboard-renderer",676362:"en-us-welcome-bot-js",676513:"buttonCollection",676618:"it-it-help-js",676634:"bg-bg-host-controls-js",676717:"th-th-errors-js",676801:"zh-cn-extensibility-js",676912:"hostUxStrings31",677202:"mk-mk-chat-list-js",677258:"th-th-rsc-application-permissions-js",677307:"fr-ca-premium-benefits-js",677397:"ru-strings-jsonThinRes",677406:"pl-pl-coach-report-js",677504:"eu-es-biometric-enrollment-js",677579:"uk-ua-message-escalate-dialog-js",677793:"hostUxStrings64",678026:"sht-cortextopictypeswebstrings_km-kh",678241:"fr-fr-webinar-js",678341:"sr-latn-rs-message-escalate-dialog-js",678408:"fns71",678489:"is-is-desktop-js",678609:"id-id-files-js",678669:"pt-br-people-picker-js",678680:"platform-chat-with-subscription",678729:"hostUxStrings13",678891:"ru-ru-meeting-collaboration-js",678893:"fr-fr-health-js",678932:"ca-es-rsc-application-permissions-js",679049:"r_data-resolvers-mesh-audio",679680:"sl-si-datepicker-js",679943:"ka-ge-video-message-js",680028:"et-ee-contacts-js",680051:"eu-es-chat-list-js",680292:"ja-jp-teams-insider-js",680441:"ca-es-valencia-breakout-rooms-js",680472:"fil-ph-cast-js",680707:"cs-strings-jsonThinRes",681146:"sk-sk-coach-report-js",681150:"nl-nl-teams-and-channels-js",681255:"is-is-meeting-bot-js",681535:"hr-hr-phonelink-sms-js",681698:"InformationProtectionStrings14",681826:"he-il-meeting-apis-app-js",682202:"nb-no-datepicker-js",682210:"ka-ge-meeting-stream-app-js",682225:"nb-no-virtual-events-js",682304:"zh-cn-video-message-js",682389:"bg-bg-guardians-js",682645:"bg-bg-messaging-js",682653:"ro-ro-live-persona-editor-js",683026:"ja-jp-virtual-events-js",683107:"sk-sk-growth-js",683178:"el-gr-digital-signage-js",683245:"en-gb-host-controls-js",683254:"uk-ua-broadcast-js",683256:"ja-jp-compose-js",683398:"es-es-audience-view-dialog-js",683628:"nb-no-mtma-missed-notifications-js",684091:"data-resolvers-invite-links",684198:"en-gb-survey-js",684214:"nn-no-meet-for-work-js",684615:"services-call-recording",684619:"ca-es-unsupported-browser-js",684655:"chat-audio-drop-in-join-button",684932:"nn-no-url-preview-js",685394:"r_data-resolvers-meet-for-work",685678:"vi-vn-contacts-js",685995:"something-went-wrong-empty-state",686049:"lv-lv-compose-js",686189:"fil-ph-queues-js",686206:"fr-fr-presence-js",686380:"InformationProtectionStrings8",686560:"scaht-cortextopictypeswebstrings_fr",686626:"sr-latn-rs-autosuggest-js",686681:"cy-gb-message-escalate-dialog-js",686692:"sk-sk-whats-new-js",686824:"data-resolvers-tenant-analytics",686855:"sq-al-phonelink-sms-js",687007:"ca-es-valencia-digital-signage-js",687254:"sht-cortextopictypeswebstrings_gl",687309:"reactions-overlay-webgl-renderer",687391:"data-resolvers-app-device-permission",687392:"data-resolvers-external-calendar-email-address",687937:"msal-service_1",687990:"r_data-resolvers-discover-surface",688222:"sq-al-people-app-js",688354:"hr-hr-premium-benefits-js",688487:"en-us-feedback-js",688540:"data-resolvers-tenant-membership",689045:"vi-vn-meeting-stream-app-js",689134:"es-mx-meet-for-work-js",689284:"en-us-whats-new-js",689312:"ka-ge-chat-list-js",689517:"r_data-resolvers-calling-diagnostics",689774:"el-gr-person-js",689797:"scaht-cortextopictypeswebstrings_sl",689864:"uk-ua-settings-js",689908:"bg-bg-channels-js",689961:"fns55",690042:"lt-lt-files-js",690115:"id-id-desktop-js",690134:"webrec2-language-ro",690224:"categories-ko-kr-json",690250:"onecamera-locale-ca",690265:"sl-si-pre-core-js",690408:"cs-cz-help-js",690461:"he-il-meeting-collaboration-js",690533:"categories-az-latn-az-json",690534:"InformationProtectionStrings81",690678:"el-gr-freemium-upgrade-js",690784:"pt-pt-url-preview-js",691086:"fns58",691270:"ko-kr-url-preview-js",691291:"accessibility-settings-panel",691548:"bg-bg-freemium-js",691589:"es-es-presence-js",691648:"el-gr-rsc-application-permissions-js",691730:"en-gb-meeting-analytics-js",691830:"gl-es-artifacts-platform-js",692030:"sk-sk-extensibility-ptz-extension-js",692073:"eu-es-files-js",692729:"hostUxStrings54",692872:"hu-hu-live-persona-editor-js",692889:"ca-es-valencia-share-to-teams-js",692915:"ka-ge-communities-js",693053:"da-dk-communities-js",693334:"config-gallatin",693371:"otlang26",693481:"data-resolvers-browser-video-message",693610:"hu-hu-phonelink-sms-js",693681:"en-gb-meeting-meet-app-js",693726:"scaht-cortextopictypeswebstrings_ms",693980:"th-th-meeting-bot-js",694037:"nl-nl-feedback-js",694153:"bg-bg-meeting-bot-js",694170:"categories-wo-sn-json",694174:"r_data-resolvers-missed-mtma-notifications",694255:"ja-jp-broadcast-js",694287:"it-it-queues-js",694623:"hostDefaultsStrings62",694886:"vi-vn-meeting-apis-app-js",694925:"az-latn-az-virtual-events-js",694945:"services-meeting-intelligence",695131:"is-is-wiki-js",695489:"hi-in-settings-js",695545:"ro-ro-extensibility-js",695636:"hi-in-semantic-object-js",695651:"bg-bg-gallery-js",695659:"sq-al-simple-collab-js",695765:"az-latn-az-rsc-application-permissions-js",695875:"hostDefaultsStrings24",695957:"lv-lv-queues-js",696208:"ro-ro-meeting-collaboration-js",696248:"is-is-live-persona-card-js",696363:"sk-sk-share-to-teams-third-party-js",696376:"pt-pt-digital-signage-js",696384:"id-id-lightbox-js",696540:"sq-AL-UiStrings-json",696798:"en-gb-freemium-upgrade-js",697029:"fil-ph-meeting-stream-app-js",697113:"sr-latn-rs-freemium-js",697202:"hu-hu-share-to-teams-js",697302:"hi-in-gallery-js",697399:"sl-si-biometric-enrollment-js",697834:"id-id-webinar-js",697866:"el-gr-mtma-missed-notifications-js",697962:"fr-fr-avatar-js",698080:"sht-searchanswerteamsstrings_es-sr-cyrl",698087:"ro-ro-health-js",698091:"webrec2-language-es",698203:"hu-hu-artifacts-platform-js",698430:"lt-lt-simple-collab-js",698556:"zh-cn-virtual-events-js",698767:"es-mx-meeting-stream-app-js",699309:"ja-jp-digital-signage-js",699357:"ko-kr-auth-js",699384:"mk-mk-guardians-js",699530:"r_data-resolvers-odsp-transcript",699870:"is-is-extensibility-ptz-extension-js",699941:"pt-pt-datepicker-js",699993:"id-id-extensibility-ptz-extension-js",700122:"id-id-discover-surface-js",700374:"cs-cz-comment-stream-js",700488:"data-resolvers-browser-calls-screen",700722:"nn-no-virtual-events-js",700798:"r_data-resolvers-viva-insights",700944:"zh-tw-activity-js",701035:"services-io-browser-collab-cloud",701333:"ar-sa-search-js",701505:"kk-kz-extensibility-room-remote-js",701562:"es-es-compose-js",701570:"r_data-resolvers-taskbar",701583:"hostDefaultsStrings78",701685:"th-th-discover-surface-js",701796:"ca-es-funstuff-js",701800:"gl-es-video-capture-js",701839:"scaht-searchconvergedanswerteamsstrings-zh-hant",701919:"ka-ge-meeting-recap-js",701963:"ca-es-valencia-url-preview-js",701966:"as-IN-UiStrings-json",702055:"vi-vn-share-to-teams-third-party-js",702115:"es-es-virtual-events-js",702762:"gl-es-people-picker-js",702869:"lt-lt-discover-surface-js",703007:"sl-si-artifacts-platform-js",703250:"cs-cz-auth-js",703299:"fil-ph-semantic-object-js",703475:"tr-tr-toast-notifications-js",703813:"hostUxStrings44",703834:"ro-ro-messaging-js",703842:"cy-gb-premium-benefits-js",703854:"da-dk-video-capture-js",703957:"th-th-premium-benefits-js",704087:"sq-al-guardians-js",704092:"mk-mk-premium-benefits-js",704286:"fns23",704339:"en-gb-feedback-js",704498:"sv-se-channels-js",704618:"es-es-gallery-js",704620:"fns64",704667:"mk-mk-meeting-bot-js",704803:"ar-sa-digital-signage-js",704913:"hr-hr-messaging-js",704922:"sv-se-compose-js",704933:"lt-lt-audience-view-dialog-js",704980:"sk-sk-unified-search-js",705111:"kk-kz-meeting-flyout-js",705175:"gl-es-audience-view-dialog-js",705297:"webrec2-language-ko",705313:"zh-tw-meeting-options-js",705390:"fil-ph-health-js",705464:"id-id-freemium-upgrade-js",705553:"r_data-resolvers-browser-virtual-events",705754:"components-files-super-picker",705900:"fil-ph-telemetry-js",705980:"hi-in-communities-js",706013:"categories-de-de-json",706165:"fr-ca-meeting-apis-app-js",706295:"az-latn-az-people-app-js",706338:"hi-in-premium-benefits-js",706366:"hostUxStrings40",706421:"ar-sa-meeting-room-console-js",706663:"sk-sk-breakout-rooms-js",706702:"sht-cortextopictypeswebstrings_ne-np",706763:"tr-tr-people-app-js",706785:"kk-kz-people-targeting-js",707040:"teachingMoment",707084:"pl-pl-rsc-application-permissions-js",707191:"hostDefaultsStrings70",707520:"bg-bg-shortcuts-js",707687:"fluentMtcInlineStyles",707729:"hostUxStrings52",707959:"fluid-component-renderer",708189:"ru-ru-desktop-js",708660:"sq-al-search-js",708749:"ru-ru-recurrence-js",708832:"fil-ph-chat-list-js",708916:"is-is-teams-and-channels-js",708945:"ko-kr-people-app-js",709479:"tr-tr-unified-search-js",709495:"meeting-options-panel",709592:"hostDefaultsStrings59",709675:"sht-cortextopictypeswebstrings_ms",709778:"hostUxStrings48",709785:"mk-mk-virtual-events-js",709928:"el-gr-people-picker-js",709962:"zh-cn-artifacts-platform-js",709976:"mk-mk-help-js",710191:"ja-jp-settings-js",710496:"kk-kz-freemium-js",710631:"scaht-cortextopictypeswebstrings_lv",710787:"webrec2-language-kk",710832:"cy-gb-carousel-multi-card-js",711354:"data-resolvers-low-friction-trial",711561:"sl-si-gallery-js",711690:"vi-vn-comment-stream-js",711743:"gl-es-gallery-js",711762:"fr-fr-meeting-meet-app-js",712017:"nl-nl-queues-js",712087:"eu-es-lms-integration-js",712155:"categories-en-gb-json",712173:"nb-no-coach-report-js",712610:"components-screen-recorder24",712669:"scaht-cortextopictypeswebstrings_quz-pe",712857:"ko-kr-activity-js",713028:"cs-cz-chat-list-js",713077:"r_data-resolvers-app-ratings-and-reviews",713307:"vi-vn-meeting-collaboration-js",713516:"hi-in-contacts-js",713738:"cs-cz-smart-device-js",713901:"ru-ru-people-js",714065:"r_data-resolvers-people-avatar",714073:"ka-ge-shortcuts-js",714076:"sht-searchanswerteamsstrings_es-lt",714079:"ro-ro-calling-js",714260:"lt-lt-lms-integration-js",714421:"calling-meeting-options-form",714653:"r_data-resolvers-example",714809:"pt-br-compose-js",714914:"sk-sk-discover-surface-js",714947:"th-th-chat-list-js",715013:"id-id-nova-js",715229:"fr-fr-compose-js",715271:"categories-kok-in-json",715379:"ar-sa-wiki-js",715469:"pt-pt-rsc-application-permissions-js",715707:"cy-gb-url-preview-js",715715:"ar-sa-mtma-missed-notifications-js",716110:"zh-cn-webinar-js",716111:"sk-sk-meeting-recap-js",716130:"th-th-mtma-missed-notifications-js",716151:"services-people",716170:"da-dk-whats-new-js",716185:"hi-in-meeting-collaboration-js",716313:"services-people-picker",716316:"hostUxStrings53",716550:"de-de-presence-js",716572:"ja-jp-phonelink-sms-js",716633:"lt-lt-shortcuts-js",716687:"otlang46",716712:"pt-pt-host-controls-js",716734:"th-strings-jsonThinRes",717142:"webrec2-language-sr-latn-rs",717260:"ru-ru-meeting-apis-app-js",717268:"ar-sa-unified-search-js",717269:"is-is-extensibility-room-remote-js",717421:"fil-ph-live-persona-card-js",717462:"gl-es-desktop-js",717490:"uk-ua-live-persona-editor-js",717722:"sr-latn-rs-breakout-rooms-js",717758:"vi-vn-funstuff-js",718034:"cs-cz-esp-js",718049:"lv-lv-teams-insider-js",718119:"es-mx-unified-search-js",718170:"categories-pt-pt-json",718262:"mk-mk-auth-js",718358:"tr-tr-communities-js",718392:"en-gb-video-capture-js",718418:"vi-vn-pre-core-js",718500:"chat-list-apollo",718815:"data-resolvers-transcript-feedback",718884:"data-resolvers-implicit-contacts",719080:"lt-lt-autosuggest-js",719180:"mk-mk-desktop-js",719234:"th-th-feedback-js",719560:"vi-vn-meeting-meet-app-js",719582:"he-il-coach-report-js",719678:"sv-se-autosuggest-js",719997:"components-screen-recorder21",720041:"cs-cz-people-targeting-js",720056:"is-is-people-targeting-js",720094:"pl-pl-unified-search-js",720555:"fi-fi-errors-js",720674:"hr-hr-webinar-js",720718:"content-bubble-container",720765:"components-screen-recorder110",720828:"zh-cn-unsupported-browser-js",720830:"da-dk-lightbox-js",720944:"zh-cn-help-js",720962:"de-de-meeting-flyout-js",720965:"components-calendar-peek-view-attachments",721041:"eu-es-host-controls-js",721128:"es-es-digital-signage-js",721240:"r_data-resolvers-closed-captions",721346:"sk-sk-errors-js",722086:"sr-latn-rs-share-to-teams-third-party-js",722426:"ar-sa-campaign-notifications-js",722487:"fns10",722536:"sv-se-telemetry-js",722761:"nl-nl-help-js",722762:"en-us-calendar-js",723040:"appbar-control-lazyflyout",723088:"services-invite-links",723099:"id-id-people-js",723113:"fr-ca-live-persona-card-js",723465:"r_data-resolvers-meeting-analytics",723695:"id-id-simple-collab-js",723969:"cs-cz-recurrence-js",723995:"en-gb-chat-list-js",724026:"scaht-cortextopictypeswebstrings_kk",724287:"pt-pt-help-js",725153:"ko-kr-phonelink-sms-js",725168:"id-id-meeting-bot-js",725344:"de-de-freemium-upgrade-js",725361:"da-dk-sv-flyout-js",725454:"fi-fi-funstuff-js",725579:"sr-latn-rs-people-picker-js",725621:"el-gr-messaging-js",725745:"tr-tr-share-to-teams-outlook-addin-js",725919:"ja-jp-campaign-notifications-js",726096:"fi-fi-semantic-object-js",726189:"fil-ph-comment-stream-js",726324:"pl-pl-avatar-js",726373:"nn-no-search-js",726445:"fns14",726510:"is-is-toast-notifications-js",726553:"InformationProtectionStrings26",726717:"fns18",726804:"cs-cz-gallery-js",726852:"cs-cz-lms-integration-js",726882:"az-latn-az-settings-js",726909:"pl-pl-meeting-room-console-js",726921:"nl-nl-channels-js",726937:"zh-tw-telemetry-js",727013:"InformationProtectionStrings24",727014:"tr-tr-share-to-teams-js",727055:"mk-mk-extensibility-js",727066:"de-de-semantic-object-js",727133:"zh-tw-auth-js",727303:"is-is-message-escalate-dialog-js",727335:"es-mx-biometric-enrollment-js",727476:"scaht-cortextopictypeswebstrings_ca",727513:"sht-cortextopictypeswebstrings_ro",727767:"fr-ca-messaging-js",727809:"hr-hr-communities-js",727819:"fil-ph-simple-collab-js",727879:"gl-es-coach-report-js",728420:"msal2-service",728584:"sht-cortextopictypeswebstrings_fr",728658:"sv-se-lms-integration-js",728709:"sr-latn-rs-meeting-flyout-js",728849:"id-id-presence-js",728881:"nl-nl-live-persona-card-js",728992:"sht-cortextopictypeswebstrings_ru",729025:"sht-cortextopictypeswebstrings_pl",729180:"data-resolvers-browser-tenant-privacy",729284:"eu-es-recurrence-js",729614:"ru-ru-teams-insider-js",729772:"eu-es-teams-and-channels-js",729961:"services-virtual-events",73e4:"vi-vn-extensibility-ptz-extension-js",730027:"az-latn-az-feedback-js",730041:"pt-pt-video-capture-js",730112:"gl-es-tfl-onboarding-js",730150:"sht-cortextopictypeswebstrings_pt",730168:"sht-searchanswerteamsstrings_es-fa",730418:"bg-bg-nova-js",730791:"scaht-cortextopictypeswebstrings_ro",730807:"zh-cn-meeting-collaboration-js",731094:"en-gb-nova-js",731503:"ne-NP-UiStrings-json",731538:"InformationProtectionStrings22",731830:"nb-no-meeting-bot-js",731961:"nl-nl-cast-js",732003:"cy-gb-meet-for-work-js",732093:"sht-cortextopictypeswebstrings_mn-mn",732126:"de-de-meeting-meet-app-js",732154:"fi-fi-shortcuts-js",732214:"bg-bg-auth-js",732226:"sht-cortextopictypeswebstrings_lt",732240:"data-resolvers-app-suggestions",732283:"hu-hu-lightbox-js",732521:"pa-IN-UiStrings-json",732522:"lazy-team-context-menu-container",732571:"hi-in-jana-js",732644:"nn-no-lms-integration-js",732937:"th-th-audience-view-dialog-js",733146:"he-il-calling-js",733206:"categories-kk-kz-json",733401:"ca-es-video-capture-js",733427:"en-gb-meeting-stream-app-js",733526:"share-meeting-search",733580:"nn-no-help-js",733806:"en-us-unsupported-browser-js",733885:"services-app-suggestions",733899:"nb-no-meeting-meet-app-js",733924:"zh-cn-sv-flyout-js",734054:"pt-pt-comment-stream-js",734151:"mk-mk-cast-js",734244:"sl-si-tfl-onboarding-js",734602:"components-screen-recorder37",734764:"ro-ro-shortcuts-js",734931:"vi-vn-presence-js",734949:"services-implicit-contacts",735063:"et-ee-tfl-homepage-js",735309:"pt-pt-semantic-object-js",735342:"hi-in-meet-for-work-js",735457:"zh-tw-presence-js",735512:"data-resolvers-platform-tabs-state",735529:"r_data-resolvers-pstn",735581:"it-it-auth-js",735596:"r_data-resolvers-favorite-user",735668:"InformationProtectionStrings47",735674:"ca-es-meeting-stream-app-js",735677:"otlang76",735776:"ar-sa-welcome-bot-js",735788:"lt-lt-comment-stream-js",735874:"uk-ua-chat-list-js",736018:"ca-es-valencia-share-in-meetings-js",736050:"ro-ro-biometric-enrollment-js",736151:"sv-se-wiki-js",736173:"hostDefaultsStrings32",736307:"it-it-meeting-meet-app-js",736344:"es-mx-files-js",736405:"hi-in-broadcast-js",736580:"fr-fr-tfl-onboarding-js",736583:"fr-fr-meeting-apis-app-js",736585:"th-th-share-to-teams-outlook-addin-js",736822:"pt-br-meeting-stream-app-js",737174:"el-gr-help-js",737175:"pt-br-phonelink-sms-js",737738:"cs-cz-virtual-events-js",737744:"es-mx-share-in-meetings-js",737813:"et-ee-calling-js",737920:"en-gb-carousel-multi-card-js",738057:"fr-ca-broadcast-js",738078:"scaht-cortextopictypeswebstrings_tk-tm",738088:"ru-ru-messaging-js",738288:"hu-hu-hololens-js",738368:"tr-tr-activity-js",738464:"scaht-cortextopictypeswebstrings_tr",738562:"da-dk-health-js",738564:"FluidFramework-HashFallback",738623:"et-ee-smart-device-js",738694:"cy-gb-welcome-bot-js",738777:"components-custom-emoji-dialog",739064:"nb-no-phonelink-sms-js",739113:"nn-no-share-to-teams-third-party-js",739182:"fr-ca-audience-view-dialog-js",739192:"cs-cz-activity-js",739245:"fil-ph-communities-js",739253:"en-gb-share-to-teams-outlook-addin-js",739281:"en-us-communities-js",739577:"ca-es-shortcuts-js",739657:"ka-ge-teams-and-channels-js",739751:"es-mx-shortcut-js",739791:"az-latn-az-meeting-room-console-js",739823:"lpc-teams-bootstrapper",740083:"bg-bg-esp-js",740114:"components-screen-recorder25",740278:"hu-hu-extensibility-js",740366:"ru-ru-video-capture-js",740802:"tt-RU-UiStrings-json",740851:"r_data-resolvers-user-preferences",740868:"data-resolvers-browser-floodgate",741014:"sl-si-files-js",741127:"r_data-resolvers-search-meeting-summary",741149:"is-is-carousel-multi-card-js",741200:"zh-cn-nova-js",741249:"hr-hr-people-picker-js",741333:"is-is-telemetry-js",741513:"tr-tr-extensibility-room-remote-js",741606:"el-gr-host-controls-js",741824:"he-il-tfl-onboarding-js",741880:"he-il-freemium-js",742051:"id-id-coach-report-js",742104:"nn-no-wiki-js",742122:"categories-el-gr-json",742241:"eu-es-simple-collab-js",742261:"pt-pt-mtma-missed-notifications-js",742297:"es-es-shortcuts-js",742450:"fil-ph-phonelink-sms-js",742465:"zh-cn-extensibility-room-remote-js",742705:"th-th-teams-insider-js",742843:"zh-cn-share-to-teams-js",742925:"ro-ro-person-js",742986:"bg-bg-telemetry-js",743081:"fr-fr-share-in-meetings-js",743251:"ka-ge-compose-js",743583:"InformationProtectionStrings30",743744:"fr-fr-extensibility-js",743783:"ca-es-tfl-onboarding-js",743811:"az-latn-az-coach-report-js",744140:"eu-es-webinar-js",744319:"cs-cz-live-persona-card-js",744334:"closedCaptionsTeachingMoment",744357:"hostUxStrings33",744551:"webrec2-language-gl",744672:"lt-lt-url-preview-js",744746:"categories-tt-ru-json",744957:"sq-al-discover-surface-js",744963:"sv-se-datepicker-js",745022:"da-dk-tfl-onboarding-js",745116:"hu-hu-settings-js",745250:"fns66",745404:"appbar-control-suggestedapptile",745513:"en-gb-telemetry-js",745692:"fi-fi-digital-signage-js",745695:"id-id-avatar-js",745772:"scaht-cortextopictypeswebstrings_mt-mt",746155:"nl-nl-share-to-teams-outlook-addin-js",746169:"gd-gb-UiStrings-json",746300:"pl-pl-errors-js",746428:"pt-pt-premium-benefits-js",746520:"ro-ro-search-js",746685:"ckeditor5-inspector",746774:"nb-no-meet-for-work-js",746979:"components-mesh-avatar-panel",747131:"fr-ca-calendar-js",747139:"en-gb-extensibility-ptz-extension-js",747579:"fns69",747715:"pt-pt-artifacts-platform-js",747762:"de-de-comment-stream-js",747765:"data-resolvers-video-extensibility",747958:"ca-es-datepicker-js",748032:"eu-es-audience-view-dialog-js",748167:"fil-ph-teams-and-channels-js",748307:"compose-box-v2-renderer",748309:"lv-lv-lms-integration-js",748338:"de-de-channels-js",748403:"eu-es-calling-js",748575:"sl-si-share-in-meetings-js",749317:"fi-fi-video-message-js",749502:"it-it-feedback-js",749612:"gl-es-edu-js",749687:"el-gr-errors-js",749871:"et-ee-live-persona-editor-js",749959:"sl-si-extensibility-room-remote-js",749962:"ar-sa-people-targeting-js",749971:"it-it-survey-js",750054:"ca-es-valencia-shortcut-js",750392:"th-th-meeting-apis-app-js",750676:"zh-cn-errors-js",750948:"zh-cn-search-js",751041:"nn-no-channels-js",751181:"de-de-meeting-recap-js",751221:"fi-fi-edu-js",751309:"services-teams-and-channels",751484:"zh-tw-host-controls-js",751534:"onecamera-locale-az",751661:"data-resolvers-targeting-hierarchy",751667:"otlang102",751744:"InformationProtectionStrings79",751856:"zh-cn-autosuggest-js",751949:"data-resolvers-browser-mention",752130:"da-dk-share-to-teams-js",752226:"fi-fi-jana-js",752388:"vi-vn-meeting-bot-js",752426:"ca-es-lms-integration-js",752567:"sht-searchanswerteamsstrings_es-sl",752866:"InformationProtectionStrings57",752908:"fr-ca-url-preview-js",753029:"categories-gd-gb-json",753113:"es-mx-host-controls-js",753332:"el-gr-avatar-js",753596:"az-latn-az-people-targeting-js",753678:"fi-fi-cast-js",754106:"gl-es-biometric-enrollment-js",754273:"it-it-funstuff-js",754294:"nn-no-lightbox-js",754309:"sht-cortextopictypeswebstrings_ca",754384:"eu-es-url-preview-js",754386:"gl-es-shortcut-js",754409:"zh-tw-breakout-rooms-js",754432:"r_data-resolvers-host-updates",754447:"components-screen-recorder56",754743:"id-id-live-persona-card-js",754805:"fr-fr-coach-report-js",754955:"gl-es-cast-js",755090:"th-th-share-to-teams-third-party-js",755279:"components-screen-recorder114",755294:"de-de-shortcuts-js",755406:"sl-si-url-preview-js",755519:"nn-no-datepicker-js",755649:"pl-pl-auth-js",755697:"nb-no-comment-stream-js",755703:"fi-fi-meeting-recap-js",755720:"lt-lt-funstuff-js",755728:"it-it-person-js",755732:"ko-kr-people-targeting-js",755859:"bg-bg-cast-js",755905:"th-th-calendar-js",756171:"fil-ph-webinar-js",756244:"hostUxStrings9",756291:"es-mx-activity-js",756300:"sht-searchanswerteamsstrings_es-pt-pt",756335:"sht-searchanswerteamsstrings_es-ga-ie",756387:"InformationProtectionStrings65",756425:"fns83",756585:"eu-es-tfl-homepage-js",756590:"sv-se-teams-and-channels-js",756880:"scaht-searchconvergedanswerteamsstrings-sr-cyrl-ba",757595:"fr-ca-share-in-meetings-js",757628:"is-strings-jsonThinRes",757912:"InformationProtectionStrings7",758095:"lt-lt-freemium-upgrade-js",758206:"ca-es-valencia-people-js",758371:"it-it-carousel-multi-card-js",758817:"sht-cortextopictypeswebstrings_as-in",759073:"zh-cn-coach-report-js",759082:"common-post-and-reply-types",759084:"sht-searchanswerteamsstrings_es-sr",759124:"es-es-video-capture-js",759214:"ca-es-hololens-js",759238:"InformationProtectionStrings71",759442:"pt-pt-health-js",759478:"ca-es-valencia-extensibility-ptz-extension-js",759493:"appbar-control-flyoutsearchresults",759836:"he-il-framework-js",759867:"hi-in-artifacts-platform-js",760081:"sk-sk-feedback-js",760200:"da-dk-live-persona-card-js",760262:"sv-se-cast-js",760500:"hostDefaultsStrings60",760569:"en-gb-queues-js",760712:"en-us-tfl-onboarding-js",760728:"cs-cz-toast-notifications-js",761014:"nb-no-compose-js",761033:"lt-lt-toast-notifications-js",761242:"az-latn-az-discover-surface-js",761269:"kk-kz-errors-js",761286:"hostUxStrings1",761397:"scaht-searchconvergedanswerteamsstrings-ca-es-valencia",761522:"tr-tr-channels-js",761587:"uk-ua-unified-search-js",761620:"scaht-cortextopictypeswebstrings_no",761889:"id-id-breakout-rooms-js",761906:"cy-gb-compose-js",761944:"services-io-store-apps",762058:"multi-window-dashboard-renderer",762151:"otlang72",762198:"hostUxStrings28",762526:"it-it-settings-js",762674:"uk-ua-meeting-collaboration-js",762722:"pl-pl-meeting-flyout-js",762771:"zh-cn-extensibility-ptz-extension-js",762856:"hr-hr-people-app-js",763140:"mi-NZ-UiStrings-json",763213:"hu-hu-cast-js",763572:"fr-ca-desktop-js",763661:"sq-al-edu-js",763664:"fil-ph-auth-js",763702:"sht-searchanswerteamsstrings_es-en-gb",764e3:"sht-cortextopictypeswebstrings_uz",764055:"categories-ms-my-json",764100:"data-resolvers-hosted-web-content-log",764297:"el-gr-communities-js",764419:"ka-ge-funstuff-js",764722:"ca-es-unified-search-js",764816:"fa-IR-UiStrings-json",764855:"kk-kz-autosuggest-js",764980:"he-il-messaging-js",765101:"lv-lv-message-escalate-dialog-js",765160:"fi-fi-esp-js",765294:"id-id-meeting-flyout-js",765331:"data-resolvers-browser-meeting-room",765593:"ca-es-channels-js",765645:"eu-es-desktop-js",766555:"de-de-errors-js",766558:"uk-ua-share-in-meetings-js",766724:"et-ee-meeting-flyout-js",766789:"fr-fr-activity-js",766968:"hu-hu-compose-js",767200:"he-il-presence-js",767218:"tr-tr-lightbox-js",767378:"hr-hr-rsc-application-permissions-js",767456:"es-es-framework-js",767650:"sht-cortextopictypeswebstrings_th",767937:"pt-br-feedback-js",767948:"it-it-extensibility-ptz-extension-js",767973:"components-screen-recorder72",768046:"mk-mk-meeting-options-js",768229:"sv-se-comment-stream-js",768262:"th-th-unsupported-browser-js",768407:"scaht-cortextopictypeswebstrings_mn-mn",768475:"mockauth-service",768556:"sq-al-freemium-upgrade-js",768731:"sq-al-digital-signage-js",768817:"nn-no-feedback-js",768866:"vi-vn-people-js",769048:"hr-hr-pre-core-js",769167:"r_data-resolvers-browser-logs-files",769315:"en-us-funstuff-js",769415:"feedback-renderer",769490:"sq-al-message-escalate-dialog-js",769614:"en-us-teams-insider-js",769626:"da-dk-campaign-notifications-js",769675:"categories-is-is-json",769941:"hr-hr-unsupported-browser-js",770078:"bg-bg-share-to-teams-js",770216:"sr-latn-rs-host-controls-js",770326:"calling-app",770357:"data-resolvers-browser-url-preview",770411:"sl-si-host-controls-js",770498:"lv-lv-live-persona-editor-js",770613:"es-mx-person-js",770616:"en-gb-errors-js",770646:"gl-es-share-in-meetings-js",770662:"it-it-sv-flyout-js",770682:"et-ee-share-to-teams-js",770706:"zh-cn-recurrence-js",770778:"eu-es-meet-for-work-js",770957:"pt-pt-unified-search-js",771211:"fi-fi-shortcut-js",771351:"zh-cn-guardians-js",771401:"services-async-media",771733:"sl-si-semantic-object-js",771767:"ca-es-survey-js",771880:"es-mx-artifacts-platform-js",772287:"sht-cortextopictypeswebstrings_cy",772618:"fr-fr-digital-signage-js",772704:"uk-ua-calling-js",772813:"ko-kr-tfl-homepage-js",773155:"es-mx-teams-and-channels-js",773282:"pl-pl-people-app-js",773343:"sht-cortextopictypeswebstrings_ja",773449:"vi-vn-tfl-onboarding-js",773469:"bg-bg-contacts-js",773546:"r_data-resolvers-copilot-plugin-user-config",773622:"pt-pt-gallery-js",773716:"en-us-person-js",773873:"tr-tr-search-js",773969:"data-resolvers-browser-survey",773974:"lt-lt-pre-core-js",773998:"webrec2-language-ca",774054:"it-it-extensibility-room-remote-js",774180:"hostDefaultsStrings4",774443:"ro-ro-chat-list-js",774675:"en-us-biometric-enrollment-js",774799:"da-dk-avatar-js",774922:"th-th-campaign-notifications-js",774924:"nl-nl-simple-collab-js",774933:"nl-nl-breakout-rooms-js",774952:"da-dk-people-app-js",775039:"categories-mt-mt-json",775141:"sht-searchanswerteamsstrings_es-mi-nz",775196:"pt-br-activity-js",775341:"fr-fr-pre-core-js",775557:"cs-cz-lightbox-js",775805:"scaht-cortextopictypeswebstrings_sq",775860:"mk-mk-communities-js",775863:"compose-event-profilers",775950:"de-de-survey-js",776502:"pl-pl-freemium-upgrade-js",776507:"lt-lt-share-to-teams-third-party-js",776755:"da-dk-desktop-js",776805:"zh-tw-share-to-teams-outlook-addin-js",776900:"en-us-digital-signage-js",776945:"data-resolvers-search-contextual",777093:"fi-FI-UiStrings-json",777253:"ca-es-live-persona-card-js",777340:"es-mx-extensibility-room-remote-js",777418:"cy-gb-hololens-js",777618:"r_data-resolvers-browser-meeting-bot",777649:"components-screen-recorder68",777685:"he-il-telemetry-js",777752:"hr-hr-campaign-notifications-js",778013:"group-template-cta-container",778516:"adaptivecard-react",778561:"lt-lt-telemetry-js",778592:"hu-hu-recurrence-js",778709:"da-dk-video-message-js",778823:"hr-hr-mtma-missed-notifications-js",779041:"sl-si-growth-js",779221:"en-gb-smart-device-js",779406:"fr-fr-people-app-js",779456:"sq-al-toast-notifications-js",779737:"hostUxStrings29",779814:"sr-latn-rs-lightbox-js",779920:"en-us-files-js",780163:"fns53",780174:"nl-nl-rsc-application-permissions-js",780192:"r_data-resolvers-mru",780364:"ar-sa-desktop-js",780487:"lt-lt-teams-and-channels-js",780511:"da-dk-url-preview-js",780563:"nb-no-desktop-js",780579:"cs-cz-meeting-bot-js",780694:"categories-sl-si-json",780924:"mk-mk-gallery-js",781026:"et-ee-extensibility-js",781676:"hu-hu-video-message-js",781677:"it-it-share-to-teams-third-party-js",781738:"it-it-avatar-js",781787:"kk-kz-guardians-js",782096:"uk-ua-growth-js",782107:"kk-kz-health-js",782245:"de-de-auth-js",782570:"de-de-messaging-js",782685:"sq-al-lightbox-js",782767:"sr-latn-rs-premium-benefits-js",782891:"es-mx-pre-core-js",783047:"scaht-searchconvergedanswerteamsstrings-mn-mn",783403:"nl-nl-video-message-js",783404:"data-resolvers-app-details",783415:"cy-gb-cast-js",783591:"el-gr-lightbox-js",783668:"uk-ua-calendar-js",783914:"uk-ua-share-to-teams-js",783969:"sr-latn-rs-extensibility-js",784071:"tr-tr-chat-list-js",784083:"ja-jp-meeting-analytics-js",784105:"mk-mk-nova-js",784138:"pt-br-meeting-meet-app-js",784676:"fil-ph-extensibility-room-remote-js",784801:"lt-lt-breakout-rooms-js",784899:"zh-tw-extensibility-js",785175:"pt-pt-meeting-flyout-js",785486:"fi-fi-toast-notifications-js",785617:"fi-fi-sv-flyout-js",785769:"fr-fr-search-js",785873:"fi-fi-freemium-js",786260:"pt-pt-toast-notifications-js",786331:"pt-br-files-js",786389:"it-it-biometric-enrollment-js",786694:"is-is-meet-for-work-js",786697:"th-th-contacts-js",786910:"hostUxStrings34",787085:"el-gr-meeting-analytics-js",787227:"data-resolvers-system-settings",787349:"ru-ru-mtma-missed-notifications-js",787370:"hu-hu-meeting-analytics-js",787480:"services-image-proxy",787581:"nb-no-communities-js",787657:"pl-pl-meeting-bot-js",787961:"pt-pt-freemium-js",788002:"sq-al-help-js",788211:"it-it-compose-js",788273:"r_data-resolvers-platform-tabs",788316:"pt-br-extensibility-ptz-extension-js",788695:"cy-gb-esp-js",788726:"zh-cn-jana-js",788890:"kk-kz-lms-integration-js",789071:"mk-mk-presence-js",789162:"r_data-resolvers-sensitivity-label",789266:"zh-tw-share-to-teams-js",789824:"r_data-resolvers-video-extensibility",789992:"es-es-extensibility-room-remote-js",790115:"sk-sk-meeting-room-console-js",790449:"ja-jp-webinar-js",790546:"nn-no-teams-and-channels-js",790752:"sht-cortextopictypeswebstrings_kn",790788:"uk-ua-teams-and-channels-js",791093:"vi-vn-activity-js",791224:"fr-fr-share-to-teams-outlook-addin-js",791405:"zh-tw-guardians-js",791530:"kk-kz-share-to-teams-js",791690:"sk-sk-cast-js",791742:"sl-si-calling-js",791761:"categories-zu-za-json",791789:"calling",791794:"sl-si-errors-js",791911:"is-is-unsupported-browser-js",792146:"fr-ca-meeting-stream-app-js",792523:"sq-al-errors-js",792615:"sv-se-pre-core-js",792645:"ca-es-valencia-messaging-js",792725:"nb-no-webinar-js",792821:"bg-bg-welcome-bot-js",792876:"services-signals",793180:"nl-nl-discover-surface-js",793266:"hi-in-campaign-notifications-js",793399:"fi-fi-host-controls-js",793477:"sht-searchanswerteamsstrings_es-as-in",793518:"r_data-resolvers-meeting-summary-qna-history",793546:"el-gr-meeting-options-js",793572:"zh-tw-feedback-js",793573:"mk-mk-digital-signage-js",793631:"he-il-contacts-js",793653:"video-attachment-light",793716:"tr-tr-carousel-multi-card-js",793742:"sk-sk-people-picker-js",793800:"he-strings-jsonThinRes",793844:"data-resolvers-people-picker",794079:"kk-kz-mtma-missed-notifications-js",794114:"zh-tw-semantic-object-js",794159:"hostUxStrings65",794166:"services-floodgate",794282:"is-is-shortcut-js",794334:"fi-fi-share-to-teams-js",794395:"lt-lt-share-to-teams-js",794694:"nn-no-guardians-js",794780:"ca-es-freemium-js",794826:"scaht-cortextopictypeswebstrings_ar",795037:"files-viewer-oneup",795079:"bg-bg-message-escalate-dialog-js",795121:"hi-in-presence-js",795282:"it-it-coach-report-js",795341:"pl-pl-settings-js",795424:"vi-vn-desktop-js",796014:"cy-gb-lightbox-js",796078:"hostDefaultsStrings68",796387:"pl-pl-share-to-teams-third-party-js",796766:"hi-in-phonelink-sms-js",796795:"cmd-trouter",797003:"pl-pl-survey-js",797113:"fi-fi-presence-js",797124:"ca-es-meeting-analytics-js",797149:"ka-ge-avatar-js",797153:"webrec2-language-zh-tw",797209:"ca-es-valencia-comment-stream-js",797433:"r_data-resolvers-apps-platform",797628:"sk-sk-settings-js",797638:"sq-al-gallery-js",797834:"it-it-people-picker-js",798176:"hostUxStrings61",798182:"lv-lv-discover-surface-js",798392:"az-latn-az-carousel-multi-card-js",798397:"nl-nl-lightbox-js",798498:"hostUxStrings69",798510:"pt-pt-share-to-teams-js",798877:"fil-ph-channels-js",798880:"nn-no-activity-js",799463:"ka-ge-rsc-application-permissions-js",799487:"he-il-comment-stream-js",799610:"eu-es-feedback-js",799666:"id-strings-jsonThinRes",799793:"components-screen-recorder20",799905:"hr-hr-jana-js",800106:"pt-br-teams-and-channels-js",800393:"zh-tw-calling-js",800481:"sht-searchanswerteamsstrings_es-es-mx",800502:"ca-es-valencia-calendar-js",800531:"fr-fr-meeting-options-js",800682:"ca-es-video-message-js",800691:"hr-hr-chat-list-js",800692:"pl-PL-UiStrings-json",801173:"et-ee-datepicker-js",801218:"cs-cz-embed-js",801258:"sr-latn-rs-discover-surface-js",801299:"hi-in-embed-js",801518:"nn-no-live-persona-card-js",802050:"ar-sa-people-js",802054:"core-essentials",802297:"cy-GB-UiStrings-json",802365:"pt-pt-contacts-js",802378:"lv-lv-communities-js",802772:"fi-fi-meeting-collaboration-js",802859:"sht-searchanswerteamsstrings_es-vi",802907:"sl-si-search-js",802989:"uz-Latn-UZ-UiStrings-json",803061:"cs-cz-person-js",803291:"cs-cz-avatar-js",803367:"ka-ge-audience-view-dialog-js",803475:"hi-in-webinar-js",803481:"zh-tw-video-message-js",803482:"gl-es-search-js",803591:"en-gb-recurrence-js",803625:"nl-nl-live-persona-editor-js",803698:"components-calendar-peek",803756:"de-de-meeting-bot-js",803841:"mk-mk-feedback-js",803891:"data-resolvers-browser-ddv",803959:"sl-si-rsc-application-permissions-js",804328:"th-th-freemium-js",804370:"categories-zh-tw-json",804534:"nb-no-people-app-js",804674:"nn-no-campaign-notifications-js",804686:"ro-ro-avatar-js",804734:"tr-tr-wiki-js",805034:"vi-vn-framework-js",805131:"otlang14",805136:"fi-fi-teams-insider-js",805157:"is-is-errors-js",805203:"services-apps-platform",805430:"otlang73",805674:"scaht-cortextopictypeswebstrings_fil",805794:"services-dynamics-marketing",805842:"sq-al-extensibility-js",805887:"id-id-contacts-js",805914:"sl-si-campaign-notifications-js",806382:"sk-sk-teams-and-channels-js",806409:"cy-gb-meeting-options-js",806582:"modal",806792:"es-es-live-persona-editor-js",806994:"teams-post-compose-box",807102:"ro-ro-lms-integration-js",807178:"chat-screen-share-button",807618:"kk-kz-rsc-application-permissions-js",807669:"pt-pt-people-js",807945:"cy-gb-meeting-apis-app-js",807971:"sk-sk-live-persona-card-js",807978:"da-dk-message-escalate-dialog-js",808277:"pl-pl-contacts-js",808289:"es-mx-live-persona-card-js",808338:"hi-in-nova-js",808376:"sht-searchanswerteamsstrings_es-te",808421:"et-ee-webinar-js",808589:"et-ee-tfl-onboarding-js",808712:"sl-si-video-capture-js",808744:"pt-br-meeting-bot-js",809170:"InformationProtectionStrings9",809193:"sht-cortextopictypeswebstrings_zh-hans",809257:"webrec2-language-bg",809264:"az-latn-az-survey-js",809287:"de-de-virtual-events-js",809440:"ro-ro-telemetry-js",809587:"tr-tr-lms-integration-js",809809:"zh-tw-growth-js",809820:"InformationProtectionStrings5",810016:"fns15",810170:"hu-hu-whats-new-js",810222:"ru-RU-UiStrings-json",810333:"hr-hr-hololens-js",810831:"hu-hu-files-js",811016:"es-es-discover-surface-js",811133:"lv-lv-meeting-flyout-js",811511:"bg-bg-people-targeting-js",811878:"cs-cz-messaging-js",811902:"eu-es-people-targeting-js",811974:"cs-cz-hololens-js",812044:"hi-in-audience-view-dialog-js",812086:"en-gb-embed-js",812099:"ca-es-extensibility-room-remote-js",812118:"components-meeting-room-smart-device-join-by-code",812188:"ca-es-desktop-js",812190:"calling-roster",812223:"tr-tr-share-to-teams-third-party-js",812289:"eu-es-breakout-rooms-js",812447:"ka-ge-growth-js",812695:"sht-cortextopictypeswebstrings_sd-arab-pk",812701:"ca-es-auth-js",812827:"ro-ro-files-js",812910:"he-il-shortcuts-js",812946:"services-io-calling-service-adapters",813129:"sk-sk-survey-js",813204:"ro-ro-meeting-stream-app-js",813584:"is-is-lightbox-js",813642:"sk-sk-funstuff-js",813658:"he-il-digital-signage-js",813665:"ca-es-valencia-communities-js",813769:"designer-full-dialog",813881:"et-ee-meet-for-work-js",814014:"sk-sk-files-js",814043:"cy-gb-growth-js",814298:"tr-tr-welcome-bot-js",814318:"da-dk-people-js",814408:"services-live-stream-renderer",814453:"mk-mk-calendar-js",814503:"scaht-searchconvergedanswerteamsstrings-tk-tm",814557:"ca-es-valencia-host-controls-js",814644:"hy-AM-UiStrings-json",815155:"sr-latn-rs-meeting-collaboration-js",815182:"zh-tw-share-in-meetings-js",815281:"ca-es-audience-view-dialog-js",815301:"ka-ge-jana-js",815451:"bg-bg-whats-new-js",815463:"categories-lt-lt-json",815468:"data-resolvers-calling-diagnostics",815633:"sht-searchanswerteamsstrings_es-bn-bd",815923:"platform-app-service",815983:"hi-in-toast-notifications-js",815985:"sr-latn-rs-settings-js",816113:"ko-kr-growth-js",816180:"mk-mk-freemium-js",816287:"es-es-share-to-teams-outlook-addin-js",816299:"kk-kz-communities-js",816436:"ko-strings-jsonThinRes",816523:"otlang104",816611:"nn-np-strings-jsonThinRes",816644:"en-gb-settings-js",816702:"services-calling-service-adapters",816733:"P2PFilesListEmptyStateView",816877:"az-Latn-AZ-UiStrings-json",816981:"InformationProtectionStrings72",816986:"sq-al-contacts-js",817037:"nl-nl-share-to-teams-js",817118:"tr-tr-meeting-flyout-js",817222:"fil-ph-digital-signage-js",817233:"InformationProtectionStrings54",817400:"data-resolvers-meeting-options",817746:"ka-ge-meeting-analytics-js",817791:"lt-lt-feedback-js",817896:"hu-hu-growth-js",817926:"sv-se-queues-js",818015:"zh-cn-cast-js",818102:"lt-lt-auth-js",818155:"eu-es-live-persona-card-js",818166:"hi-in-sv-flyout-js",818344:"categories-nso-za-json",818773:"message-escalate-dialog",819210:"InformationProtectionStrings1",819211:"services-transcript-settings-store",819277:"es-es-meeting-room-console-js",819416:"scaht-cortextopictypeswebstrings_ko",819433:"sr-Cyrl-RS-UiStrings-json",819451:"vi-vn-live-persona-editor-js",819632:"it-it-tfl-onboarding-js",819890:"is-is-hololens-js",819918:"hu-hu-meeting-bot-js",820004:"eu-es-survey-js",820048:"ja-jp-freemium-js",820293:"cs-cz-message-escalate-dialog-js",820464:"sharedServicesRest",820516:"services-meeting-options",820672:"services-bots-platform",821074:"cy-gb-live-persona-editor-js",821181:"kn-IN-UiStrings-json",821319:"cs-cz-extensibility-ptz-extension-js",821475:"scaht-searchconvergedanswerteamsstrings-fr-ca",821567:"pl-pl-person-js",821706:"data-schema-cdl",821714:"ja-jp-share-to-teams-js",821836:"services-address",821864:"cy-gb-shortcut-js",821945:"ko-kr-meeting-apis-app-js",822114:"sk-sk-carousel-multi-card-js",822245:"sv-se-breakout-rooms-js",822399:"az-latn-az-gallery-js",822447:"lv-lv-share-to-teams-outlook-addin-js",822956:"pl-pl-gallery-js",823029:"ar-sa-help-js",823207:"fi-fi-messaging-js",823263:"fr-ca-toast-notifications-js",823275:"en-gb-tfl-onboarding-js",823394:"es-mx-share-to-teams-outlook-addin-js",823506:"en-us-shortcuts-js",823511:"nl-nl-meeting-flyout-js",823531:"zh-tw-esp-js",823654:"cs-cz-telemetry-js",823921:"categories-si-lk-json",824610:"fil-ph-growth-js",824671:"vi-vn-telemetry-js",824842:"tr-tr-auth-js",824938:"scaht-map-topic",824966:"id-id-audience-view-dialog-js",825066:"fr-CA-UiStrings-json",825188:"uk-ua-meeting-recap-js",825268:"cs-cz-meeting-meet-app-js",825477:"sq-al-framework-js",825659:"channel-dashboard",825948:"gl-es-host-controls-js",825970:"categories-sq-al-json",826020:"fil-ph-smart-device-js",826044:"ro-ro-live-persona-card-js",826703:"ca-es-coach-report-js",826844:"bg-bg-discover-surface-js",826930:"et-ee-lightbox-js",826981:"kk-kz-share-to-teams-third-party-js",827005:"html2canvas",827106:"vi-vn-unsupported-browser-js",827168:"uk-ua-person-js",827187:"kk-kz-audience-view-dialog-js",827400:"lt-lt-people-app-js",827403:"kk-kz-webinar-js",827404:"lt-lt-guardians-js",827594:"vi-vn-calendar-js",827852:"id-id-meeting-recap-js",827947:"el-GR-UiStrings-json",827986:"sb-activated",828048:"hr-hr-video-message-js",828052:"scaht-cortextopictypeswebstrings_ha-latn-ng",828134:"de-de-video-capture-js",829089:"ru-ru-unified-search-js",829144:"categories-rm-ch-json",829150:"it-it-audience-view-dialog-js",829311:"r_data-resolvers-browser-esp",829602:"mk-mk-simple-collab-js",829722:"data-resolvers-transcript",829831:"zh-tw-autosuggest-js",829881:"InformationProtectionStrings46",829924:"mk-mk-channels-js",830208:"ja-jp-guardians-js",830338:"pt-pt-campaign-notifications-js",830535:"scaht-searchconvergedanswerteamsstrings-cs",830721:"ka-ge-cast-js",830755:"id-id-extensibility-room-remote-js",830909:"de-de-live-persona-editor-js",830964:"cy-gb-freemium-js",831e3:"sht-searchanswerteamsstrings_es-mk",831046:"mk-mk-comment-stream-js",831081:"otlang98",831103:"fil-ph-extensibility-js",831192:"data-resolvers-dynamics-marketing",831240:"en-gb-people-picker-js",831257:"es-es-channels-js",831267:"el-gr-freemium-js",831367:"r_data-resolvers-web-app-switcher",831388:"ka-ge-whats-new-js",831618:"nl-nl-meeting-collaboration-js",831664:"ja-jp-rsc-application-permissions-js",831670:"chat-audio-drop-in-start-button",831722:"ca-es-phonelink-sms-js",831992:"it-it-desktop-js",832023:"fns11",832057:"viewimages",832141:"sl-si-activity-js",832260:"appbar-control-tilecontextmenu",832306:"nl-nl-tfl-onboarding-js",832422:"pt-br-meeting-apis-app-js",832506:"ko-kr-lightbox-js",832611:"nb-no-presence-js",832740:"fi-fi-comment-stream-js",832820:"th-th-meeting-stream-app-js",833131:"pl-pl-chat-list-js",833467:"el-gr-extensibility-ptz-extension-js",833513:"th-th-semantic-object-js",833885:"sp-filter-actions",833923:"kk-kz-unified-search-js",834073:"it-it-shortcuts-js",834117:"calling-pluginless",834439:"is-is-contacts-js",834544:"webrec2-language-sv",834568:"cs-cz-people-picker-js",834595:"data-resolvers-sensitivity-label",834651:"calling-shell",834667:"postRollUi",835066:"onecamera-locale-gl",835208:"lt-LT-UiStrings-json",835221:"fr-ca-chat-list-js",835223:"nl-nl-artifacts-platform-js",835235:"el-gr-premium-benefits-js",835241:"data-resolvers-browser-teams",835268:"zh-cn-meeting-bot-js",835509:"hr-hr-meeting-collaboration-js",835579:"th-th-telemetry-js",835588:"categories-sk-sk-json",835922:"sl-si-queues-js",835949:"fr-ca-meeting-recap-js",836005:"pl-pl-wiki-js",836010:"components-calling-call-handoff-screen",836179:"kk-kz-wiki-js",836276:"mk-mk-share-to-teams-js",836291:"fixWebmDuration",836815:"ko-kr-meet-for-work-js",837108:"sl-si-people-targeting-js",837260:"r_data-resolvers-vdi",837437:"th-th-lightbox-js",837860:"az-latn-az-cast-js",837863:"lt-lt-people-targeting-js",837952:"scaht-cortextopictypeswebstrings_el",838018:"r_data-resolvers-notifications",838116:"is-is-share-to-teams-outlook-addin-js",838171:"ca-es-valencia-jana-js",838311:"pt-br-datepicker-js",838313:"ca-es-valencia-welcome-bot-js",838373:"ko-kr-errors-js",838377:"ru-ru-artifacts-platform-js",838429:"lt-lt-live-persona-card-js",838531:"vi-vn-people-targeting-js",839029:"ja-jp-meeting-recap-js",839180:"fr-fr-channels-js",839247:"fr-fr-extensibility-ptz-extension-js",839254:"sr-latn-rs-webinar-js",839399:"de-de-message-escalate-dialog-js",839412:"hostUxStrings80",839675:"kk-kz-calendar-js",839716:"th-th-sv-flyout-js",839966:"ca-es-valencia-sv-flyout-js",839990:"ru-ru-telemetry-js",840015:"he-il-carousel-multi-card-js",840068:"vi-vn-mtma-missed-notifications-js",840174:"r_data-resolvers-breakout-rooms",840177:"categories-bn-in-json",840209:"fil-ph-help-js",840298:"lt-lt-gallery-js",840333:"pt-br-desktop-js",840409:"scaht-cortextopictypeswebstrings_be-by",840596:"hostDefaultsStrings48",840684:"nl-strings-jsonThinRes",840813:"lv-lv-audience-view-dialog-js",841316:"zh-tw-datepicker-js",841391:"pt-br-share-in-meetings-js",841525:"sr-latn-rs-avatar-js",841817:"cy-gb-queues-js",841992:"hostDefaultsStrings44",842088:"tr-tr-url-preview-js",842214:"de-de-telemetry-js",842336:"mk-mk-datepicker-js",842562:"da-dk-meeting-flyout-js",842573:"sr-latn-rs-extensibility-ptz-extension-js",842583:"fil-ph-settings-js",842659:"mk-mk-video-capture-js",842859:"ko-kr-funstuff-js",843118:"he-il-nova-js",843596:"id-id-gallery-js",843714:"scaht-cortextopictypeswebstrings_de",843953:"hu-hu-discover-surface-js",844015:"sk-sk-extensibility-room-remote-js",844070:"bg-bg-carousel-multi-card-js",844129:"InformationProtectionStrings61",844329:"id-id-meeting-analytics-js",844473:"cy-gb-gallery-js",844563:"az-latn-az-communities-js",844596:"hostDefaultsStrings40",844607:"en-us-jana-js",844630:"ar-sa-meeting-collaboration-js",844807:"zh-cn-freemium-js",844812:"it-it-chat-list-js",844976:"he-il-embed-js",844988:"kk-kz-freemium-upgrade-js",845302:"ca-es-valencia-contacts-js",845330:"hi-in-hololens-js",845362:"categories-sw-ke-json",845437:"pl-pl-calendar-js",845470:"is-is-meeting-meet-app-js",845550:"en-us-broadcast-js",845665:"sht-searchanswerteamsstrings_es-ur",845699:"zh-tw-artifacts-platform-js",845702:"categories-hr-hr-json",845906:"categories-yo-ng-json",846261:"otlang116",846266:"sht-topics-sdk-km-api",846325:"pl-pl-jana-js",846378:"pt-br-tfl-homepage-js",846493:"et-ee-sv-flyout-js",846497:"nn-no-recurrence-js",846499:"lv-lv-person-js",846501:"el-gr-video-capture-js",846532:"categories-bn-bd-json",846534:"webrec2-language-nb-no",846552:"nb-no-message-escalate-dialog-js",846650:"pt-pt-jana-js",846730:"is-IS-UiStrings-json",846736:"otlang112",846752:"it-it-cast-js",847318:"ro-ro-comment-stream-js",847336:"is-is-person-js",847398:"ar-sa-cast-js",847401:"r_data-resolvers-browser-teams",847819:"mk-mk-share-in-meetings-js",847834:"hostDefaultsStrings82",847885:"ca-es-valencia-search-js",848094:"ja-jp-meeting-apis-app-js",848129:"data-resolvers-live-state-broadcast",848219:"fi-strings-jsonThinRes",848366:"pt-pt-meeting-analytics-js",848450:"scaht-cortextopictypeswebstrings_fa",848522:"webrec2-language-th",848640:"tr-tr-teams-and-channels-js",848646:"eu-es-meeting-analytics-js",848912:"fr-ca-lightbox-js",848943:"categories-mi-nz-json",848954:"gl-es-telemetry-js",848979:"id-id-channels-js",849027:"bg-bg-hololens-js",849122:"zh-cn-meeting-analytics-js",849223:"hr-hr-auth-js",849310:"zh-cn-smart-device-js",849331:"lv-lv-files-js",849378:"hostDefaultsStrings33",849381:"he-il-sv-flyout-js",849399:"fr-fr-video-capture-js",849579:"cy-gb-tfl-onboarding-js",849586:"uk-ua-meeting-stream-app-js",849632:"pt-br-premium-benefits-js",849672:"sht-searchanswerteamsstrings_es-km-kh",849761:"InformationProtectionStrings21",849899:"r_data-resolvers-contacts-sync",850069:"hr-hr-live-persona-card-js",850145:"sq-al-url-preview-js",850473:"lt-lt-meeting-room-console-js",850771:"InformationProtectionStrings11",850819:"scaht-searchconvergedanswerteamsstrings-nn-no",850868:"nb-no-guardians-js",850926:"pulsar-api",851082:"zh-tw-share-to-teams-third-party-js",851133:"et-ee-video-message-js",851135:"nn-no-survey-js",851244:"th-th-meeting-analytics-js",851453:"ko-kr-extensibility-js",851484:"zh-tw-extensibility-room-remote-js",851710:"services-transcript",851779:"kk-kz-cast-js",852005:"da-dk-people-picker-js",852233:"lv-lv-funstuff-js",852378:"pt-pt-sv-flyout-js",852382:"hu-hu-teams-and-channels-js",852423:"da-dk-nova-js",852943:"data-resolvers-meet-for-work",852957:"scaht-searchconvergedanswerteamsstrings-am",853029:"en-gb-channels-js",853093:"scaht-searchconvergedanswerteamsstrings-te",853760:"ca-es-valencia-help-js",853827:"scaht-searchconvergedanswerteamsstrings-sq",853911:"scaht-searchconvergedanswerteamsstrings-pt-pt",853912:"sk-sk-telemetry-js",853988:"ar-sa-coach-report-js",854008:"lv-lv-people-picker-js",854304:"fr-fr-semantic-object-js",854343:"bg-bg-search-js",854668:"config-gcchigh",854785:"el-gr-tfl-homepage-js",855010:"sv-se-search-js",855225:"mk-mk-campaign-notifications-js",855308:"bg-BG-UiStrings-json",855439:"webrec2-language-ja",855499:"ro-ro-meeting-meet-app-js",855615:"fil-ph-url-preview-js",855638:"is-is-breakout-rooms-js",855739:"zh-tw-person-js",855936:"categories-ja-jp-json",856007:"cy-gb-mtma-missed-notifications-js",856067:"sv-se-unsupported-browser-js",856256:"lt-lt-video-capture-js",856330:"hostDefaultsStrings66",856532:"hostDefaultsStrings23",857088:"InformationProtectionStrings15",857220:"pt-pt-meeting-apis-app-js",857426:"sk-sk-person-js",857549:"InformationProtectionStrings19",857785:"scaht-searchconvergedanswerteamsstrings-af",857824:"sv-se-campaign-notifications-js",858187:"uk-ua-extensibility-room-remote-js",858216:"fi-fi-biometric-enrollment-js",858275:"hu-hu-meeting-meet-app-js",858365:"r_data-resolvers-loki",858499:"precompiled-pluginless-encoded-streams-web-worker",858549:"InformationProtectionStrings67",858687:"mk-mk-mtma-missed-notifications-js",858719:"de-de-meeting-options-js",858764:"r_data-resolvers-browser-audience",859086:"r_data-resolvers-mtma-user-data",859185:"sl-si-hololens-js",860075:"el-gr-share-in-meetings-js",860192:"zh-tw-framework-js",860332:"onecamera-locale-de",860362:"et-ee-extensibility-room-remote-js",860494:"hostDefaultsStrings8",860630:"pl-pl-tfl-onboarding-js",860698:"selectmedia",861205:"zh-cn-meeting-flyout-js",861224:"hr-hr-meeting-flyout-js",861330:"hostUxStrings8",861605:"fns39",861844:"sht-cortextopictypeswebstrings_zu-za",861967:"en-us-mtma-missed-notifications-js",862151:"calling-debug-participants",862301:"uk-ua-autosuggest-js",862313:"pt-br-coach-report-js",862550:"ru-ru-simple-collab-js",862602:"ka-ge-meeting-meet-app-js",862670:"scaht-cortextopictypeswebstrings_gl",862778:"scaht-searchconvergedanswerteamsstrings-ug-cn",862807:"zh-tw-rsc-application-permissions-js",862815:"id-id-video-capture-js",862823:"hi-in-avatar-js",862885:"lv-lv-tfl-homepage-js",862969:"hi-in-share-to-teams-third-party-js",862986:"ca-es-valencia-tfl-homepage-js",863033:"vi-vn-feedback-js",863389:"sv-se-funstuff-js",863396:"pt-br-calendar-js",863403:"fr-fr-rsc-application-permissions-js",863647:"cy-gb-telemetry-js",863764:"sv-se-unified-search-js",863868:"ko-kr-meeting-meet-app-js",864438:"services-io-web-app-switcher",864486:"ar-sa-funstuff-js",864566:"pt-br-rsc-application-permissions-js",864574:"services-sharepoint-client",864696:"cs-cz-framework-js",864701:"id-id-comment-stream-js",864748:"fr-fr-freemium-upgrade-js",864829:"da-dk-shortcuts-js",865270:"kk-kz-extensibility-ptz-extension-js",865365:"data-resolvers-teams",865398:"data-resolvers-msa-authentication",865471:"spaddondeferred",865487:"tr-tr-audience-view-dialog-js",865520:"en-us-meeting-stream-app-js",865618:"nl-nl-teams-insider-js",865687:"da-dk-autosuggest-js",865888:"scaht-cortextopictypeswebstrings_tt",865898:"hi-in-auth-js",865906:"nn-no-telemetry-js",866028:"da-dk-cast-js",866188:"calling-electron",866217:"hr-hr-cast-js",866287:"mk-mk-meet-for-work-js",866495:"cy-gb-communities-js",866531:"lv-lv-coach-report-js",866787:"da-dk-meeting-recap-js",866846:"sht-cortextopictypeswebstrings_az-latn-az",866926:"gl-es-shortcuts-js",867079:"es-mx-teams-insider-js",867187:"ar-sa-smart-device-js",867294:"de-de-campaign-notifications-js",867576:"hu-hu-wiki-js",867630:"fil-ph-guardians-js",867647:"nl-nl-virtual-events-js",867824:"ko-kr-biometric-enrollment-js",867900:"et-ee-share-to-teams-outlook-addin-js",868060:"uk-ua-hololens-js",868095:"data-resolvers-transcript-settings-store",868187:"tr-tr-webinar-js",868200:"mk-mk-share-to-teams-third-party-js",868239:"id-id-smart-device-js",868452:"InformationProtectionStrings33",868485:"az-latn-az-help-js",868507:"data-resolvers-missed-mtma-notifications",868537:"he-il-extensibility-js",868635:"ko-kr-whats-new-js",868665:"he-il-url-preview-js",868706:"lv-lv-meeting-analytics-js",868839:"gl-es-help-js",868931:"lt-lt-shortcut-js",869185:"fr-fr-person-js",869348:"gl-es-meeting-stream-app-js",869534:"sv-se-contacts-js",869707:"az-latn-az-auth-js",869907:"otlang114",869939:"nn-no-meeting-analytics-js",870024:"bg-bg-embed-js",870220:"lt-lt-meeting-stream-app-js",870246:"sht-searchanswerteamsstrings_es-cs",870470:"nn-no-tfl-onboarding-js",870597:"fi-fi-pre-core-js",870760:"ca-es-valencia-freemium-js",870950:"sht-searchanswerteamsstrings_es-lo-la",871089:"he-il-health-js",871147:"fi-fi-recurrence-js",871219:"da-dk-gallery-js",871256:"ru-ru-people-picker-js",871408:"zh-cn-meeting-apis-app-js",871475:"id-id-teams-insider-js",871502:"sq-al-messaging-js",871504:"fr-ca-meeting-options-js",871522:"sl-si-people-js",871770:"nb-no-growth-js",871818:"nn-no-embed-js",871829:"pt-pt-live-persona-editor-js",871887:"sk-sk-message-escalate-dialog-js",871983:"lv-lv-errors-js",872171:"ja-jp-artifacts-platform-js",872177:"hu-hu-live-persona-card-js",872239:"ar-sa-framework-js",872484:"pt-PT-UiStrings-json",872564:"config-life",872565:"mk-mk-artifacts-platform-js",872746:"cs-cz-share-in-meetings-js",872826:"pt-br-extensibility-room-remote-js",872928:"eu-es-meeting-meet-app-js",873026:"sb-commanding-complete",873095:"en-gb-compose-js",873502:"scaht-searchconvergedanswerteamsstrings-fr",873533:"components-screen-recorder36",873606:"es-es-broadcast-js",873895:"et-ee-people-app-js",873974:"da-dk-meet-for-work-js",874176:"cy-gb-meeting-flyout-js",874186:"InformationProtectionStrings0",874691:"kk-kz-discover-surface-js",874919:"th-th-webinar-js",875208:"scaht-searchconvergedanswerteamsstrings-tr",875230:"data-resolvers-app-ratings-and-reviews",875261:"ca-es-valencia-semantic-object-js",875410:"cy-gb-share-to-teams-outlook-addin-js",875412:"ca-es-valencia-rsc-application-permissions-js",875763:"en-gb-cast-js",875814:"ka-ge-message-escalate-dialog-js",875819:"nn-no-meeting-flyout-js",875833:"hostUxStrings37",875873:"webrec2-language-ru",875985:"webrec2-language-prs-af",876003:"hostDefaultsStrings31",876073:"ca-es-meeting-recap-js",876138:"data-resolvers-biometric-enrollment",876571:"es-es-guardians-js",876710:"sht-cortextopictypeswebstrings_bg",876750:"fr-fr-broadcast-js",877047:"tr-tr-comment-stream-js",877236:"es-mx-freemium-js",877540:"gl-es-funstuff-js",877725:"sht-searchanswerteamsstrings_es-ar",878054:"fr-ca-phonelink-sms-js",878330:"bg-bg-mtma-missed-notifications-js",878698:"he-il-campaign-notifications-js",878713:"onecamera-locale-hr",878885:"nn-no-hololens-js",879166:"kk-kz-whats-new-js",879231:"es-mx-people-picker-js",879421:"zh-cn-host-controls-js",879485:"el-gr-live-persona-card-js",879579:"ko-kr-messaging-js",879629:"hostUxStrings15",879753:"zh-cn-meet-for-work-js",879833:"fns65",879883:"it-it-mtma-missed-notifications-js",879918:"nl-nl-share-in-meetings-js",879923:"ru-ru-meeting-stream-app-js",879934:"id-id-auth-js",879947:"sk-sk-contacts-js",879992:"mk-mk-phonelink-sms-js",880163:"scaht-cortextopictypeswebstrings_da",880389:"hi-in-meeting-flyout-js",880475:"id-id-survey-js",880511:"sl-si-meeting-stream-app-js",880740:"id-id-broadcast-js",880848:"pt-pt-meet-for-work-js",881073:"ca-es-contacts-js",881080:"eu-es-toast-notifications-js",881363:"en-us-meeting-meet-app-js",881484:"lt-lt-edu-js",881510:"da-dk-share-to-teams-third-party-js",881626:"r_data-resolvers-team-settings",881744:"sq-al-meeting-collaboration-js",881943:"th-th-share-to-teams-js",882162:"zh-tw-people-app-js",882204:"cs-cz-survey-js",882621:"et-ee-person-js",882732:"zh-cn-person-js",882880:"onecamera-locale-sr-latn-rs",883498:"sht-searchanswerteamsstrings_es-ko",883548:"services-meeting-questions-and-answers",883555:"hr-hr-wiki-js",883608:"cs-cz-unified-search-js",883750:"onecamera-locale-vi",883819:"components-screen-recorder112",883840:"ca-es-compose-js",883891:"ko-kr-telemetry-js",884006:"fi-fi-person-js",884183:"ko-kr-unsupported-browser-js",884358:"az-latn-az-presence-js",884489:"lv-lv-live-persona-card-js",884718:"sr-latn-rs-pre-core-js",884741:"sq-al-autosuggest-js",884803:"pt-pt-lms-integration-js",884843:"components-screen-recorder6",885034:"es-es-activity-js",885059:"ca-es-breakout-rooms-js",885119:"ru-ru-virtual-events-js",885456:"hu-hu-chat-list-js",885547:"lv-lv-meet-for-work-js",885763:"ca-es-messaging-js",885837:"scaht-searchconvergedanswerteamsstrings-si-lk",885875:"da-dk-queues-js",885924:"fr-ca-guardians-js",885976:"onecamera-locale-fr",886028:"sl-si-embed-js",886205:"data-resolvers-teams-and-channels",886222:"sl-si-discover-surface-js",886269:"ru-ru-people-app-js",886317:"sv-se-meeting-recap-js",886568:"pt-br-virtual-events-js",886643:"es-es-cast-js",886793:"hostUxStrings83",886845:"platform-conversation-pane-container",886960:"gl-es-channels-js",886972:"zh-tw-coach-report-js",887028:"it-it-simple-collab-js",887246:"is-is-auth-js",887363:"ja-jp-lms-integration-js",887574:"data-resolvers-esp-target",887811:"otlang68",888087:"r_data-resolvers-browser-core",888094:"otlang48",888188:"ro-ro-share-to-teams-outlook-addin-js",888394:"mr-IN-UiStrings-json",888766:"th-th-channels-js",888878:"appbar-control-lazydndcontext",888900:"bg-bg-extensibility-js",888965:"et-ee-edu-js",888983:"lv-lv-welcome-bot-js",889008:"sk-sk-campaign-notifications-js",889026:"sl-si-survey-js",889131:"live-interpretation-join-dialog-container",889338:"lv-lv-shortcut-js",889378:"gl-es-esp-js",889379:"sk-sk-tfl-homepage-js",889406:"scaht-cortextopictypeswebstrings_bs-latn-ba",889732:"uk-ua-artifacts-platform-js",889973:"zh-tw-settings-js",890134:"sr-latn-rs-recurrence-js",890249:"ka-ge-datepicker-js",890445:"pl-pl-embed-js",890634:"nb-no-meeting-options-js",890876:"sl-si-lms-integration-js",890885:"da-dk-shortcut-js",890971:"ro-ro-nova-js",891020:"vi-vn-files-js",891128:"uk-ua-comment-stream-js",891467:"en-gb-person-js",891546:"otlang40",891738:"de-de-coach-report-js",891782:"bg-bg-live-persona-card-js",892250:"he-il-shortcut-js",892371:"hi-in-smart-device-js",892494:"de-de-whats-new-js",892517:"ja-jp-calendar-js",892617:"categories-ro-ro-json",892920:"lt-lt-survey-js",892942:"sht-cortextopictypeswebstrings_mr",893393:"services-pstn",893497:"categories-mr-in-json",893691:"el-gr-teams-insider-js",893718:"hostDefaultsStrings39",893802:"mk-mk-activity-js",893806:"ru-ru-shortcut-js",893832:"en-us-simple-collab-js",894087:"fns9",894381:"sv-se-meeting-flyout-js",894382:"ka-ge-search-js",894629:"zh-cn-people-targeting-js",894744:"pt-pt-communities-js",894777:"pt-pt-teams-insider-js",894852:"tr-tr-campaign-notifications-js",895194:"pl-pl-artifacts-platform-js",895289:"sv-se-help-js",895444:"sht-cortextopictypeswebstrings_lb-lu",895581:"es-es-help-js",895655:"de-de-framework-js",895847:"fns5",896008:"hostUxStrings14",896091:"nb-no-health-js",896146:"cy-gb-person-js",896173:"kk-kz-tfl-onboarding-js",897043:"ko-kr-video-message-js",897118:"sq-al-meeting-bot-js",897213:"ja-strings-jsonThinRes",897290:"et-ee-framework-js",897485:"fr-fr-auth-js",897586:"en-gb-biometric-enrollment-js",897783:"ka-GE-UiStrings-json",897856:"ru-ru-contacts-js",897962:"hostDefaultsStrings15",897988:"sl-si-autosuggest-js",898050:"el-gr-biometric-enrollment-js",898275:"fr-ca-telemetry-js",898278:"hostUxStrings72",898408:"it-it-gallery-js",898458:"lv-lv-freemium-upgrade-js",898471:"sht-cortextopictypeswebstrings_am",898507:"cs-cz-meeting-room-console-js",898724:"r_data-resolvers-mfu-contacts",898862:"es-mx-discover-surface-js",899067:"ru-ru-share-to-teams-third-party-js",899181:"vi-vn-broadcast-js",899246:"da-dk-help-js",899304:"et-ee-people-js",899328:"el-gr-desktop-js",899367:"data-resolvers-manage-tenant",899487:"scaht-searchconvergedanswerteamsstrings-ne-np",899533:"ja-jp-search-js",899700:"sv-se-video-message-js",899768:"it-it-meeting-analytics-js",900038:"nn-no-smart-device-js",900140:"pl-pl-biometric-enrollment-js",900218:"r_data-resolvers-tfl-user",900389:"fil-ph-wiki-js",900657:"lv-lv-datepicker-js",900675:"services-io-connected-calendar",900837:"ca-es-valencia-biometric-enrollment-js",900860:"sk-sk-extensibility-js",900902:"sht-cortextopictypeswebstrings_gu",900945:"ko-kr-wiki-js",901383:"onecamera-locale-id",901510:"onecamera-locale-it",901530:"categories-es-es-json",901636:"mk-mk-person-js",901657:"az-latn-az-contacts-js",901891:"r_data-resolvers-tfl-homepage",902078:"services-substrate-meeting-recommendations",902132:"lv-lv-pre-core-js",902471:"mk-mk-meeting-meet-app-js",902600:"deferredcomponents",902611:"pt-pt-people-picker-js",902654:"fr-ca-search-js",902921:"fil-ph-desktop-js",902978:"ko-kr-unified-search-js",903024:"r_data-resolvers-calling",903152:"ka-ge-activity-js",903279:"hu-hu-freemium-upgrade-js",903420:"hostUxStrings6",903862:"ca-es-valencia-carousel-multi-card-js",904063:"zh-tw-meeting-collaboration-js",904115:"sht-searchanswerteamsstrings_es-am",904183:"ar-sa-toast-notifications-js",904221:"hostDefaultsStrings20",904297:"hr-hr-broadcast-js",904428:"es-es-biometric-enrollment-js",904435:"zh-cn-phonelink-sms-js",904692:"gl-es-sv-flyout-js",904757:"cs-cz-tfl-onboarding-js",904872:"sr-latn-rs-coach-report-js",905069:"en-us-meeting-bot-js",905207:"el-gr-meeting-recap-js",905305:"zh-tw-pre-core-js",905327:"sr-latn-rs-meeting-bot-js",905407:"nl-nl-meeting-stream-app-js",905506:"sk-sk-health-js",905548:"mk-mk-coach-report-js",905663:"cs-cz-video-message-js",905722:"hr-hr-freemium-upgrade-js",905752:"categories-ml-in-json",905920:"pl-pl-meeting-meet-app-js",906350:"vi-vn-teams-and-channels-js",906585:"zh-cn-contacts-js",906707:"sv-se-people-js",906767:"es-es-meeting-flyout-js",906848:"ar-sa-people-app-js",906874:"sht-searchanswerteamsstrings_es-zh-hant",906966:"sht-searchanswerteamsstrings_es-kk",907058:"nn-no-meeting-stream-app-js",907202:"ka-ge-hololens-js",907378:"say-hi-with-a-wave",907696:"webrec2-language-pt-br",907718:"kk-strings-jsonThinRes",907872:"en-us-unified-search-js",907908:"ko-kr-calling-js",907954:"en-us-auth-js",908199:"bg-bg-coach-report-js",908361:"scaht-searchconvergedanswerteamsstrings-sr-cyrl",908566:"fi-fi-campaign-notifications-js",908992:"it-it-toast-notifications-js",909100:"ja-jp-breakout-rooms-js",909179:"fr-ca-funstuff-js",909191:"ka-ge-comment-stream-js",909231:"ka-ge-meet-for-work-js",909255:"hi-in-errors-js",909269:"ja-jp-unified-search-js",909283:"nl-nl-unsupported-browser-js",909331:"eu-es-smart-device-js",909611:"cs-cz-queues-js",909664:"r_data-resolvers-message-common",909709:"pl-pl-growth-js",910345:"sl-si-broadcast-js",910582:"kk-kz-compose-js",910885:"scaht-cortextopictypeswebstrings_hu",910942:"sht-cortextopictypeswebstrings_ga-ie",911124:"ka-ge-teams-insider-js",911205:"gl-ES-UiStrings-json",911346:"cs-cz-rsc-application-permissions-js",911478:"pt-pt-virtual-events-js",911692:"ko-kr-message-escalate-dialog-js",911846:"services-breakout-rooms",911987:"en-us-lms-integration-js",912081:"r_data-resolvers-contacts-sync-banner",912212:"sr-latn-rs-contacts-js",912235:"de-de-person-js",912325:"fr-ca-person-js",912508:"uk-ua-campaign-notifications-js",912766:"el-gr-virtual-events-js",912870:"fi-fi-survey-js",913084:"th-th-welcome-bot-js",913261:"pt-pt-autosuggest-js",913340:"nl-nl-meeting-recap-js",913386:"splash-screen-image",913390:"lv-lv-whats-new-js",913462:"sl-si-shortcuts-js",913519:"ru-ru-toast-notifications-js",913560:"ar-sa-telemetry-js",913651:"mk-mk-meeting-flyout-js",913830:"kk-kz-meeting-room-console-js",914058:"pt-pt-coach-report-js",914091:"fns34",914202:"ko-kr-teams-insider-js",914264:"ka-ge-share-to-teams-outlook-addin-js",914532:"ja-jp-video-capture-js",914537:"fil-ph-person-js",914543:"hr-hr-smart-device-js",914682:"global-error-boundary",914704:"nn-no-rsc-application-permissions-js",914821:"is-is-welcome-bot-js",915001:"id-id-settings-js",915097:"it-it-freemium-js",915120:"fns84",915229:"fi-fi-compose-js",915401:"nl-nl-tfl-homepage-js",915771:"sr-latn-rs-presence-js",915782:"data-resolvers-yammer-notification",915868:"eu-es-nova-js",916105:"tr-tr-messaging-js",916452:"lv-lv-host-controls-js",916471:"hu-hu-meeting-recap-js",916857:"zh-cn-url-preview-js",916960:"fi-fi-meeting-meet-app-js",917098:"id-id-calling-js",917250:"hu-hu-share-to-teams-third-party-js",917572:"id-id-health-js",917716:"fns24",917736:"hi-in-whats-new-js",917784:"gl-es-person-js",917805:"fns70",917844:"webrec2-language-en-gb",918199:"r_data-resolvers-developer-switchers",918266:"pt-br-discover-surface-js",918419:"sv-se-freemium-js",918427:"en-gb-people-targeting-js",918688:"is-is-cast-js",918758:"en-gb-files-js",918797:"ro-strings-jsonThinRes",918876:"gl-es-webinar-js",919523:"nb-no-whats-new-js",919778:"data-resolvers-esp",919820:"scaht-cortextopictypeswebstrings_hy",919949:"sl-si-toast-notifications-js",919990:"fr-ca-digital-signage-js",920058:"data-resolvers-activity-settings",920155:"hr-hr-funstuff-js",920418:"sk-sk-comment-stream-js",920432:"r_data-resolvers-policies",920474:"ro-ro-freemium-upgrade-js",920748:"kk-kz-meeting-collaboration-js",920800:"de-de-communities-js",920995:"ka-ge-artifacts-platform-js",921638:"th-th-meeting-recap-js",921679:"scaht-cortextopictypeswebstrings_ta",921719:"th-th-avatar-js",922345:"es-es-unsupported-browser-js",922427:"fi-fi-live-persona-editor-js",922587:"cy-gb-freemium-upgrade-js",922608:"ru-ru-whats-new-js",922637:"ca-es-share-to-teams-outlook-addin-js",922761:"r_data-resolvers-brb",922784:"cs-cz-nova-js",922785:"it-it-shortcut-js",922808:"nl-nl-chat-list-js",922956:"es-mx-meeting-flyout-js",923115:"tr-tr-live-persona-editor-js",923139:"nl-nl-campaign-notifications-js",923167:"scaht-cortextopictypeswebstrings_af",923200:"r_data-resolvers-browser-tenant-privacy",923257:"kk-kz-messaging-js",923304:"cy-gb-help-js",923352:"fr-fr-funstuff-js",923355:"he-il-live-persona-editor-js",923386:"th-th-people-app-js",923449:"precompiled-wasmcv-web-worker",923658:"fr-ca-shortcuts-js",923685:"scaht-searchconvergedanswerteamsstrings-da",924251:"services-meeting-recap",924371:"uk-ua-meet-for-work-js",924380:"az-latn-az-people-picker-js",924625:"fr-ca-strings-jsonThinRes",924760:"cy-gb-virtual-events-js",924820:"hostDefaultsStrings16",924826:"fr-ca-coach-report-js",925262:"ja-jp-carousel-multi-card-js",925375:"data-resolvers-view-schema",925409:"hostDefaultsStrings12",925455:"ar-sa-errors-js",925500:"zh-cn-message-escalate-dialog-js",925587:"hi-in-biometric-enrollment-js",925940:"es-mx-audience-view-dialog-js",926162:"ca-es-meeting-collaboration-js",926340:"splash-screen",926711:"pt-br-funstuff-js",926754:"gl-es-settings-js",926851:"nn-no-host-controls-js",926908:"es-es-teams-and-channels-js",926934:"services-discover-surface",926958:"th-th-meeting-meet-app-js",927018:"ro-ro-meet-for-work-js",927019:"it-it-message-escalate-dialog-js",927075:"ar-SA-UiStrings-json",927092:"zh-cn-meeting-options-js",927218:"ko-kr-meeting-stream-app-js",927245:"onecamera-locale-zh-hant",927265:"ca-es-valencia-unified-search-js",927335:"gl-es-campaign-notifications-js",927433:"ro-ro-welcome-bot-js",927462:"ca-es-communities-js",927480:"eu-es-meeting-apis-app-js",927634:"et-ee-telemetry-js",927665:"ru-ru-meeting-bot-js",928046:"hu-hu-jana-js",928339:"sq-al-lms-integration-js",928422:"sv-se-embed-js",928491:"zh-tw-discover-surface-js",928641:"nn-no-messaging-js",928662:"sv-se-lightbox-js",928673:"sht-searchanswerteamsstrings_es-tk-tm",929057:"en-gb-meeting-collaboration-js",929118:"meeting-room-front-of-room-container",929488:"th-th-search-js",929732:"es-mx-meeting-bot-js",929745:"es-es-campaign-notifications-js",929861:"tr-tr-errors-js",930037:"tr-tr-coach-report-js",930038:"data-resolvers-browser-calendar",930087:"data-resolvers-bots-platform",930122:"en-us-share-in-meetings-js",930178:"es-es-autosuggest-js",930616:"lv-lv-url-preview-js",930815:"zh-tw-teams-and-channels-js",931063:"components-screen-recorder66",931090:"sk-sk-meeting-bot-js",931447:"tr-tr-artifacts-platform-js",931640:"ar-sa-datepicker-js",931860:"az-latn-az-sv-flyout-js",931868:"az-latn-az-extensibility-js",932070:"hi-in-shortcuts-js",932126:"nb-no-meeting-room-console-js",932159:"nb-no-funstuff-js",932170:"nb-no-auth-js",932192:"eu-es-messaging-js",933113:"lv-lv-breakout-rooms-js",933181:"msteams/data-view-schema",933202:"cs-cz-extensibility-room-remote-js",933324:"sk-sk-recurrence-js",933564:"de-de-simple-collab-js",933966:"scaht-searchconvergedanswerteamsstrings-bs-latn-ba",934026:"ko-kr-rsc-application-permissions-js",934060:"r_data-resolvers-teams-meeting-policies",934067:"prs-af-strings-jsonThinRes",934410:"ca-es-valencia-discover-surface-js",934570:"cs-cz-files-js",934857:"th-th-calling-js",934882:"data-schema",934978:"it-it-contacts-js",935193:"es-mx-mtma-missed-notifications-js",935205:"id-id-embed-js",935379:"da-dk-meeting-collaboration-js",935592:"otlang54",936191:"tr-tr-survey-js",936650:"nb-no-chat-list-js",936934:"r_data-resolvers-browser-calendar",936962:"et-ee-discover-surface-js",937102:"InformationProtectionStrings18",937127:"lt-lt-meeting-meet-app-js",937331:"fr-fr-meeting-recap-js",937411:"sr-latn-rs-wiki-js",937529:"sq-al-teams-insider-js",937677:"es-mx-comment-stream-js",937719:"de-de-smart-device-js",937757:"el-gr-message-escalate-dialog-js",937813:"sht-searchanswerteamsstrings_es-nn-no",937890:"ru-ru-meeting-flyout-js",938083:"ar-sa-pre-core-js",938090:"zh-cn-calendar-js",938093:"lv-lv-telemetry-js",938094:"id-id-virtual-events-js",938319:"r_data-resolvers-immersive-reader",938450:"hi-in-meeting-recap-js",938452:"categories-xh-za-json",938493:"th-th-guardians-js",938751:"en-gb-mtma-missed-notifications-js",938794:"da-dk-discover-surface-js",938968:"hostDefaultsStrings36",938996:"pt-br-gallery-js",939181:"sr-latn-rs-smart-device-js",939262:"data-resolvers-smb-user-intent",939394:"ru-ru-growth-js",939724:"onecamera-locale-ar",939726:"services-io-browser-keyboard-shortcut-lazy-chunk",940073:"es-mx-calling-js",940188:"en-us-presence-js",940373:"ja-jp-person-js",940461:"fr-fr-video-message-js",940899:"et-ee-recurrence-js",941204:"cs-cz-meeting-flyout-js",941305:"vi-vn-search-js",941411:"fi-fi-people-picker-js",941478:"mk-mk-whats-new-js",942194:"sht-cortextopictypeswebstrings_af",942270:"es-mx-freemium-upgrade-js",942475:"search-answer",942535:"sl-si-feedback-js",942643:"eu-es-extensibility-room-remote-js",942706:"hr-hr-meeting-apis-app-js",942768:"nl-nl-activity-js",942786:"fil-ph-meet-for-work-js",942866:"en-gb-people-js",943338:"is-is-presence-js",943443:"da-dk-people-targeting-js",943579:"hr-strings-jsonThinRes",943707:"scaht-searchconvergedanswerteamsstrings-eu",943718:"el-gr-wiki-js",943743:"sht-cortextopictypeswebstrings_ur",943768:"sv-se-shortcuts-js",943866:"hr-hr-calling-js",943933:"ka-ge-sv-flyout-js",943958:"data-resolvers-external-search-suggestions",944307:"pt-br-extensibility-js",944372:"hr-hr-welcome-bot-js",944423:"ar-sa-simple-collab-js",944566:"ca-es-valencia-framework-js",944607:"it-it-lightbox-js",944706:"fns51",944731:"hostUxStrings75",944843:"hr-hr-meeting-options-js",944923:"nl-nl-webinar-js",945005:"pt-br-semantic-object-js",945024:"sht-cortextopictypeswebstrings_sk",945193:"nb-no-pre-core-js",945331:"he-il-share-to-teams-third-party-js",945493:"cy-gb-broadcast-js",945614:"mk-mk-broadcast-js",945812:"fil-ph-meeting-collaboration-js",945935:"mk-mk-discover-surface-js",945941:"lt-lt-meeting-bot-js",945951:"hr-hr-desktop-js",946067:"fns16",946089:"categories-pa-in-json",946342:"sht-searchanswerteamsstrings_es-sk",946712:"lb-LU-UiStrings-json",946838:"it-it-unified-search-js",946945:"lt-lt-compose-js",947008:"gl-es-hololens-js",947356:"sl-si-lightbox-js",947603:"sr-latn-rs-whats-new-js",947799:"el-gr-meet-for-work-js",947806:"data-resolvers-suggestions",948007:"cy-gb-campaign-notifications-js",948051:"nb-no-video-message-js",948066:"r_data-resolvers-chat",948195:"data-resolvers-breakout-rooms",948373:"eu-es-share-in-meetings-js",948418:"sht-cortextopictypeswebstrings_fil",948569:"tr-tr-gallery-js",948606:"sl-strings-jsonThinRes",948678:"fil-ph-funstuff-js",948693:"services-item-crud",948706:"ru-ru-activity-js",948715:"hostUxStrings5",948952:"az-latn-az-embed-js",949502:"da-dk-funstuff-js",949567:"compose-add-ons",949576:"r_data-resolvers-phonelink-sms",949584:"services-video-message-upload",949619:"InformationProtectionStrings85",949634:"pt-br-share-to-teams-outlook-addin-js",949702:"az-latn-az-edu-js",949742:"categories-ha-latn-ng-json",949795:"id-id-shortcut-js",949835:"az-latn-az-channels-js",950081:"nb-no-premium-benefits-js",950103:"lv-lv-feedback-js",950104:"services-msa-authentication",950134:"de-de-meeting-stream-app-js",950615:"zh-hant-strings-jsonThinRes",950703:"en-us-people-js",950743:"sht-cortextopictypeswebstrings_uk",950769:"da-dk-calling-js",950790:"ja-jp-whats-new-js",950801:"otlang50",950860:"sk-sk-autosuggest-js",951278:"pt-pt-shortcuts-js",951313:"lt-lt-errors-js",951407:"fil-ph-calling-js",951449:"lv-lv-chat-list-js",951568:"es-mx-breakout-rooms-js",951652:"sl-si-avatar-js",951654:"fns12",952102:"calling-custom-video-backgrounds-panel",952202:"vi-vn-carousel-multi-card-js",952253:"pt-br-smart-device-js",952327:"cy-gb-lms-integration-js",952422:"es-mx-video-message-js",952589:"teamsHighContrastTheme",952639:"gl-es-comment-stream-js",952771:"ro-ro-people-targeting-js",952844:"de-de-phonelink-sms-js",953166:"ar-sa-meeting-stream-app-js",953361:"fns7",953497:"en-us-framework-js",953506:"zh-tw-tfl-homepage-js",953517:"da-dk-settings-js",953598:"fns3",953628:"gl-es-share-to-teams-third-party-js",953629:"is-is-people-picker-js",953670:"de-de-people-picker-js",953894:"id-id-meeting-collaboration-js",953909:"es-mx-live-persona-editor-js",954113:"sk-sk-calendar-js",954129:"zh-cn-share-in-meetings-js",954441:"ja-jp-activity-js",954501:"scaht-searchconvergedanswerteamsstrings-ky",954596:"de-de-premium-benefits-js",954603:"otlang34",954661:"es-mx-compose-js",955083:"hr-hr-guardians-js",955166:"th-th-queues-js",955264:"data-resolvers-collab-cloud",955442:"cy-gb-biometric-enrollment-js",955447:"de-de-contacts-js",955681:"da-dk-meeting-bot-js",955850:"mk-mk-shortcuts-js",955985:"pt-br-esp-js",956081:"lo-LA-UiStrings-json",956147:"az-latn-az-message-escalate-dialog-js",956166:"kk-kz-breakout-rooms-js",956232:"nl-nl-url-preview-js",956305:"scaht-cortextopictypeswebstrings_id",956343:"components-avatar-quick-picker",956593:"fr-fr-recurrence-js",956690:"en-us-autosuggest-js",956713:"zh-tw-channels-js",956858:"sq-al-cast-js",956867:"sht-cortextopictypeswebstrings_gd-gb",957070:"bg-bg-compose-js",957156:"sht-cortextopictypeswebstrings_sv",957302:"sk-SK-UiStrings-json",957625:"r_data-resolvers-coach-report",957796:"webrec2-language-nn-np",958095:"en-us-meeting-recap-js",958163:"apps-platform-service-enpoints",958184:"en-us-chat-list-js",958185:"ja-jp-share-in-meetings-js",958215:"es-es-errors-js",958338:"nn-no-freemium-upgrade-js",958408:"hr-hr-share-to-teams-js",958636:"fns47",958948:"pt-pt-meeting-room-console-js",958973:"uk-ua-meeting-meet-app-js",958977:"cs-cz-compose-js",959152:"ka-ge-wiki-js",959362:"onecamera-locale-cs",959374:"en-gb-semantic-object-js",959394:"uk-ua-meeting-bot-js",959671:"en-us-comment-stream-js",959775:"ko-kr-survey-js",959806:"hr-hr-avatar-js",959916:"id-id-search-js",960185:"r_data-resolvers-browser-chat",960267:"id-id-messaging-js",960337:"es-es-meeting-recap-js",960430:"sht-searchanswerteamsstrings_es-mt-mt",960502:"scaht-cortextopictypeswebstrings_it",960534:"r_data-resolvers-public-preview",960778:"hostDefaultsStrings53",960928:"pt-br-meeting-options-js",961444:"zh-cn-comment-stream-js",961614:"nn-no-coach-report-js",961804:"he-il-guardians-js",961854:"eu-es-wiki-js",962127:"fr-fr-settings-js",962432:"uk-ua-embed-js",962601:"ja-jp-meeting-stream-app-js",962613:"nb-no-discover-surface-js",963003:"sk-sk-share-in-meetings-js",963095:"mk-mk-host-controls-js",963378:"kk-kz-toast-notifications-js",963396:"hr-hr-recurrence-js",963572:"sv-se-broadcast-js",963691:"ru-ru-autosuggest-js",963701:"en-gb-url-preview-js",963772:"sl-si-video-message-js",964009:"lt-lt-framework-js",964068:"playbackRegion",964070:"categories-as-in-json",964083:"mk-mk-share-to-teams-outlook-addin-js",964084:"ro-ro-campaign-notifications-js",964227:"pl-pl-cast-js",964278:"data-resolvers-os-file-share",964418:"lt-lt-mtma-missed-notifications-js",964460:"hr-hr-message-escalate-dialog-js",964507:"ja-jp-share-to-teams-outlook-addin-js",964539:"es-mx-funstuff-js",964665:"es-mx-virtual-events-js",964669:"ca-es-valencia-auth-js",964702:"r_data-resolvers-browser-live-stream-rendering",964750:"InformationProtectionStrings58",964864:"de-de-people-targeting-js",964951:"es-es-host-controls-js",965028:"mk-strings-jsonThinRes",965082:"pl-pl-sv-flyout-js",965090:"lv-lv-extensibility-room-remote-js",965169:"gl-es-teams-and-channels-js",965271:"zh-tw-communities-js",965514:"ar-sa-audience-view-dialog-js",965579:"he-IL-UiStrings-json",965641:"az-latn-az-shortcut-js",965794:"sl-si-tfl-homepage-js",966227:"et-ee-meeting-meet-app-js",966247:"en-gb-whats-new-js",966277:"gl-es-virtual-events-js",966368:"vi-vn-campaign-notifications-js",966522:"hr-hr-meeting-stream-app-js",966761:"otlang66",966773:"tr-tr-phonelink-sms-js",966913:"et-ee-biometric-enrollment-js",967034:"ar-sa-teams-and-channels-js",967037:"el-gr-breakout-rooms-js",967088:"sk-sk-gallery-js",967498:"r_data-resolvers-activity-settings",967758:"az-latn-az-broadcast-js",967908:"zh-tw-cast-js",968148:"et-ee-unified-search-js",968456:"vi-vn-freemium-js",968620:"ar-sa-share-to-teams-outlook-addin-js",968671:"fr-fr-meeting-flyout-js",968823:"tr-tr-teams-insider-js",968972:"ka-ge-queues-js",969060:"is-is-shortcuts-js",969198:"InformationProtectionStrings69",969548:"hi-in-unsupported-browser-js",969594:"fi-fi-carousel-multi-card-js",969617:"nn-no-mtma-missed-notifications-js",969693:"fr-ca-share-to-teams-outlook-addin-js",969701:"fr-fr-queues-js",970113:"hi-in-breakout-rooms-js",970129:"es-mx-carousel-multi-card-js",970237:"kk-kz-presence-js",970245:"components-screen-recorder50",970293:"mk-mk-freemium-upgrade-js",970308:"fil-ph-meeting-apis-app-js",970310:"pt-br-meeting-recap-js",970387:"hi-in-host-controls-js",970421:"components-screen-recorder58",970509:"sr-latn-rs-sv-flyout-js",970563:"sr-latn-rs-unsupported-browser-js",970578:"it-it-esp-js",970632:"scaht-cortextopictypeswebstrings_hi",970640:"nn-no-message-escalate-dialog-js",970737:"scaht-cortextopictypeswebstrings_he",971344:"is-is-virtual-events-js",971365:"ca-es-toast-notifications-js",971563:"hi-in-freemium-js",971565:"r_data-resolvers-browser-video-message",971783:"pl-pl-queues-js",971790:"it-it-teams-insider-js",971917:"kk-kz-hololens-js",972123:"cy-gb-share-to-teams-third-party-js",972388:"en-gb-funstuff-js",972523:"gl-es-activity-js",972563:"gl-es-compose-js",972642:"sht-searchanswerteamsstrings_es-zh-hans",972675:"ar-sa-extensibility-room-remote-js",973008:"he-il-toast-notifications-js",973221:"bg-bg-files-js",973698:"otlang35",973736:"sht-searchanswerteamsstrings_es-et",974167:"sq-al-people-targeting-js",974211:"nl-nl-host-controls-js",974286:"uk-ua-people-targeting-js",974521:"mk-mk-contacts-js",974543:"id-id-message-escalate-dialog-js",974697:"ca-es-teams-and-channels-js",974770:"th-th-activity-js",974818:"sq-al-rsc-application-permissions-js",974974:"ro-ro-coach-report-js",975041:"tr-tr-people-picker-js",975080:"scaht-searchconvergedanswerteamsstrings-el",975145:"data-resolvers-desktop-client-shortcuts",975194:"pl-pl-funstuff-js",975213:"fil-ph-audience-view-dialog-js",975303:"fr-ca-contacts-js",975472:"ro-ro-presence-js",975499:"data-resolvers-coach-report",975602:"ca-es-valencia-chat-list-js",975651:"card-shared-header-ux-wrapper",975715:"et-ee-activity-js",976003:"data-resolvers-connected-calendar",976008:"ru-ru-lightbox-js",976025:"hu-strings-jsonThinRes",976201:"nn-no-whats-new-js",976260:"data-resolvers-apps-monet",976486:"sht-cortextopictypeswebstrings_ar",976501:"it-it-breakout-rooms-js",976576:"ka-ge-smart-device-js",976738:"hostUxStrings68",976808:"services-report-concern",976917:"sl-si-simple-collab-js",976985:"da-dk-esp-js",977012:"az-latn-az-meeting-flyout-js",977114:"sv-se-sv-flyout-js",977326:"fr-fr-audience-view-dialog-js",977511:"sht-cortextopictypeswebstrings_bs-latn-ba",977570:"pl-strings-jsonThinRes",977578:"sr-latn-rs-people-js",977727:"fr-ca-wiki-js",977982:"zh-cn-hololens-js",978776:"hu-hu-desktop-js",978848:"designer-mini-popup",978910:"cy-gb-unsupported-browser-js",979068:"sr-latn-rs-broadcast-js",979227:"et-ee-breakout-rooms-js",979307:"webrec2-language-es-mx",979530:"bg-bg-extensibility-room-remote-js",979630:"search-answer-v2-override",979695:"lv-lv-smart-device-js",979786:"en-us-compose-js",979869:"th-th-artifacts-platform-js",979948:"r_data-resolvers-meeting-intelligence",980234:"ca-es-feedback-js",981173:"tr-tr-help-js",981245:"cy-gb-semantic-object-js",981360:"ro-ro-rsc-application-permissions-js",981480:"mk-mk-framework-js",981578:"jszip",981614:"hr-hr-lms-integration-js",981774:"hu-hu-audience-view-dialog-js",981968:"bg-bg-unified-search-js",982074:"ja-jp-tfl-homepage-js",982146:"scaht-cortextopictypeswebstrings_vi",982248:"cy-gb-funstuff-js",982265:"tr-TR-UiStrings-json",982420:"fi-fi-extensibility-js",982425:"nl-nl-meeting-room-console-js",982546:"el-gr-meeting-bot-js",983025:"sk-sk-meeting-flyout-js",983088:"nn-no-calendar-js",983096:"uk-ua-pre-core-js",983155:"gl-es-messaging-js",983188:"hi-in-compose-js",983258:"nb-no-telemetry-js",983510:"sk-sk-live-persona-editor-js",983644:"eu-es-meeting-collaboration-js",983958:"lt-lt-wiki-js",984012:"en-us-premium-benefits-js",984067:"el-gr-meeting-meet-app-js",984085:"pt-br-mtma-missed-notifications-js",984098:"ca-es-valencia-autosuggest-js",984335:"data-resolvers-user-license",984464:"ca-es-freemium-upgrade-js",984597:"ac-experiments",984601:"az-latn-az-growth-js",984815:"bg-bg-people-js",984835:"ka-ge-share-to-teams-js",984898:"cy-gb-phonelink-sms-js",984935:"sl-si-coach-report-js",984983:"en-gb-meeting-flyout-js",985029:"sv-se-webinar-js",985081:"el-gr-settings-js",985093:"fr-ca-breakout-rooms-js",985324:"bg-bg-rsc-application-permissions-js",985382:"scaht-cortextopictypeswebstrings_bn-bd",986127:"ar-sa-survey-js",986183:"id-id-shortcuts-js",986246:"locked-teams-activate-banner",986639:"data-resolvers-channel-messages",986753:"mk-mk-survey-js",986875:"de-de-audience-view-dialog-js",987245:"ca-es-meeting-room-console-js",987311:"hostUxStrings39",987430:"et-ee-compose-js",987485:"de-de-unified-search-js",987833:"cy-gb-search-js",987927:"services-io-azure-maps",987929:"th-th-hololens-js",988005:"es-es-url-preview-js",988164:"hi-in-cast-js",988849:"lv-lv-virtual-events-js",988890:"cs-cz-people-js",989104:"sv-se-settings-js",989297:"sr-latn-rs-share-to-teams-outlook-addin-js",989309:"pt-pt-simple-collab-js",989419:"r_data-resolvers-suggestions",989537:"hostDefaultsStrings7",989689:"data-resolvers-guardians",989719:"sk-sk-webinar-js",989829:"services-loki",990236:"ka-ge-guardians-js",990398:"eu-es-broadcast-js",990486:"es-es-queues-js",990500:"hostDefaultsStrings28",990659:"he-il-cast-js",990961:"lt-lt-share-to-teams-outlook-addin-js",990963:"data-resolvers-browser-audience",991046:"sk-sk-lightbox-js",991457:"data-resolvers-tfl-user",991574:"ar-sa-broadcast-js",991580:"th-th-meeting-flyout-js",991696:"es-mx-edu-js",991987:"bg-bg-meet-for-work-js",992029:"sht-searchanswerteamsstrings_es-ca-es-valencia",992037:"onecamera-locale-pt-br",992180:"ca-es-calling-js",992277:"ka-ge-messaging-js",992326:"hostUxStrings46",992359:"ka-ge-freemium-upgrade-js",992468:"sv-se-welcome-bot-js",992542:"en-gb-communities-js",992546:"bg-bg-jana-js",992564:"vi-vn-share-to-teams-outlook-addin-js",992870:"pl-pl-nova-js",993013:"kk-kz-survey-js",993027:"cy-gb-discover-surface-js",993088:"et-strings-jsonThinRes",993270:"ka-ge-feedback-js",993376:"services-io-calendar",993392:"tr-tr-edu-js",993433:"az-latn-az-desktop-js",993467:"tr-tr-tfl-homepage-js",993532:"cy-gb-people-app-js",993560:"da-dk-edu-js",993715:"gl-es-semantic-object-js",993724:"uk-ua-url-preview-js",993829:"az-latn-az-datepicker-js",993870:"sq-al-tfl-homepage-js",994009:"sht-searchanswerteamsstrings_es-cy",994040:"hr-hr-simple-collab-js",994095:"bg-bg-meeting-apis-app-js",994177:"en-us-semantic-object-js",994389:"gl-es-phonelink-sms-js",994621:"lv-lv-meeting-apis-app-js",994803:"id-id-feedback-js",995137:"scaht-cortextopictypeswebstrings_sk",995234:"ru-ru-chat-list-js",995278:"r_data-resolvers-cross-tenant-policies",995316:"vi-vn-autosuggest-js",995319:"sq-al-webinar-js",995387:"uk-ua-datepicker-js",995550:"sv-se-framework-js",995627:"ko-kr-webinar-js",995936:"ro-ro-whats-new-js",995990:"cs-cz-datepicker-js",996028:"az-latn-az-people-js",996137:"data-resolvers-browser-1gql-view-data",996350:"hi-in-teams-and-channels-js",996388:"ar-sa-chat-list-js",996414:"pl-pl-live-persona-editor-js",996430:"kk-kz-welcome-bot-js",996502:"fil-ph-search-js",996583:"discover-surface-app",996681:"bg-bg-settings-js",996708:"msteams/components-meet-now-panel",996730:"ca-es-autosuggest-js",997083:"categories-gu-in-json",997110:"id-id-premium-benefits-js",997180:"uk-ua-feedback-js",997267:"fns57",997285:"mk-mk-people-picker-js",997378:"docx",997381:"zh-cn-discover-surface-js",997651:"id-id-edu-js",997667:"scaht-cortextopictypeswebstrings_en-gb",997891:"hr-hr-framework-js",997893:"sv-se-toast-notifications-js",997968:"r_data-resolvers-app-details",998062:"en-gb-tfl-homepage-js",998175:"cy-gb-jana-js",998474:"r_data-resolvers-implicit-contacts",999200:"fns49",999323:"kok-IN-UiStrings-json",999326:"en-us-meeting-options-js",999481:"nl-nl-shortcut-js",999722:"nb-no-meeting-flyout-js",999856:"apps-platform-data.mock",999919:"pt-pt-extensibility-js"}[e]||e)+"-"+{120:"c9ee1b49d45a8c99",145:"7fe24f4a09c7851d",229:"4a96c609a4420f1d",1088:"f6b31d4bf6be1ad1",1091:"b8fa5e8aefe49160",1161:"d62f2db8a120e8f6",1264:"91e4f4141c219ca8",1371:"0a38ff57bbd93bd1",1567:"48285cbe5df8e59b",1639:"060e8bdc576e9876",1675:"4ae7d1d853c8dcd3",1879:"ea0ba5bf80ab62df",2221:"96347934e10f6c51",2223:"d9af92b0631baa31",2272:"49246bc4f8b2e308",2875:"f20e480da974df2c",2941:"864a9c6f93145a16",2951:"d22c63f2adc1c5fb",2953:"1c8c7fb5d2429158",2987:"60bba427b674ea45",3021:"616711eb05d88a5a",3612:"798c8ed8431201c0",3985:"df957d5f3b22c970",4104:"f829c9a262d53ed5",4387:"372b24a9b6f747eb",4472:"e4eb91b4566bcd5b",4606:"8dc0056399dd3a8e",4768:"bcfd147893f1288d",4845:"eec7e72c744f2d1b",4864:"3b99bc066ea26253",5218:"2f985d75293445b9",5453:"cb579a71d6191f9d",5523:"846b31677c73ffda",5588:"76d33dd97a2e1444",5608:"fa9361b928663317",5631:"98976f9ccae02052",5694:"42784995f93fb194",5797:"8d84c8c9375774ea",5895:"c5b26257f5c5cf14",6095:"bc6fa640e995e374",6204:"5e35d7f3e899a5cd",6368:"be516514de144693",6431:"2a42ac36557a7446",6437:"ee58374b6dbd05e9",6442:"aaa3e58e0572f0ea",6578:"d7d52a1cf3edc273",6634:"9be2b1d82f687781",6698:"1a568d5c6c403fdd",6834:"1df03f60b2e14538",6851:"2fe025f1e017f877",6938:"e4de844945ddecea",7065:"da40c28faac8ae6e",7105:"aff88d22214bf711",7196:"06c91e792b950aec",7653:"0c24b0451a528ce9",7696:"b20fb45ef4eae114",7799:"d52e321462cd3f85",7868:"340969f9f6eb9153",7910:"5ed26b5908a3d931",8049:"f24bdbb5a70ed941",8057:"b4d6cf4066fca907",8074:"ff2df8d1cf447819",8113:"b90f860c876d4f98",8277:"37c2f21522d89f7b",8401:"9175e92302edd51c",8670:"eae8abce082094dd",8733:"f2125d3d00c39ac0",8806:"4df6e06c5e707d7c",8890:"96355c1f7828e813",9161:"834f5790994f0bda",9205:"7bcb7af48dc1c9a2",9318:"d4ed564b78651030",9320:"d02e1fd924e194fd",9469:"fae775ef4911a26f",9473:"68aae8d5d96291f0",9474:"3ff02a1938b51be6",9590:"e8cb78f69d219e7d",9606:"c9d156e5cca1a984",9642:"96f31baee59c6c08",9691:"36b8021fc705f37d",9716:"53d74fc81864b038",10014:"daf6362d576d7e61",10035:"8423c9ee25a70ce6",10062:"68a1eb19efc43ac1",10203:"c32ee1f3c92ea86c",10236:"9daea350c7eb62cb",10599:"7c938f2e56a1c41a",10675:"f703c698ad74ea9a",10905:"da5d651e0839525c",10961:"21144be12f13b981",11003:"ec66b4cd3acc448e",11049:"8c0209029a03aebf",11528:"b3d9cfb2b87f1bd9",11740:"77c71de4fff5f44a",11938:"a6334c36bdd91df1",12012:"73925cfe31f8b271",12133:"3ed62c4fb8737bfc",12181:"cdd6ebae301f5039",12252:"0e9f5a64b09dc779",12428:"6e9f61fd9dea4c4e",12535:"3ed9b03c7b413fae",12549:"d845df04a211a2c9",12564:"f3781ae4429a8f85",12615:"3ab29166b0352c46",12638:"af2611f635932557",12720:"ec01e44b5d268961",12947:"cabbb8ff22e8426b",13167:"81c7ab77fdc0f49b",13358:"86092e031fe98e6d",13419:"c9d27f3a2a0c3724",13491:"892db90644b97a05",13770:"079b012b748a4db0",13795:"621076c23dce9650",13872:"504ac5f4176ad12b",13891:"8f5cac844436ec47",13896:"8cb3aecfb961b2ee",14006:"1b2026af0182d285",14076:"d37ffeaff2d48b9c",14153:"328d8e2a50fc142e",14283:"7b575ff7a3117f85",14657:"bfee852a35819eb7",14743:"9dad7d43784a22fc",14787:"db49f08844898ee0",15154:"b6e8bfbbf00f42d1",15233:"55b1661b08bbcbfe",15367:"23fc6c3c90e927ef",15817:"827e7b37a363d11b",15943:"746454fbec393fc4",15965:"0ea711fb8889297e",16014:"ff06264205804a72",16288:"656c8bd4486c606e",16322:"204bd73041147c74",16457:"1ef326d22e4edd9a",16758:"fbc2b2f3cc6d6336",16852:"601d328da72827fc",16975:"0422a7d6694edb83",16993:"30b8c12abb174e67",17004:"e42a9c69aad847e7",17013:"95cb2542b91bccb7",17040:"b4e4bdb6b9611de5",17197:"e53bc7fe2edc3172",17244:"c84dcdbfcc0a2f48",17297:"6203b94bac6e6f26",17363:"9fea487f944f0542",17451:"bb3280802da91d2c",17624:"d49cb937ac03562e",17672:"563324f7ca31e835",17803:"b7a8bf32c5d802d0",17834:"60d39ff14f5912e4",17836:"466710d9625c6784",17906:"7c96d8f66ee7cbd3",17939:"a425748e85233f94",17994:"9e3fa67810a8fc78",18081:"6c82e5d4ad4b831a",18299:"65d089b3b150acdd",18555:"41d25743571346aa",18637:"77bfbff922ebf64a",18711:"e76c645af8bf28a7",18739:"3116e571d5758aa7",18809:"9030f044b88ed1f4",18898:"6abae6f4c6e28d43",18950:"625cab548a7f823a",19085:"092bfe7acfcc25d3",19100:"e45cd27964b9ab7f",19171:"e9f07ac673b8899b",19219:"3a959a22ee47d1fa",19310:"7e8cbfbfbe4dcede",19420:"8d11d048c10e67f6",19476:"9792ac89483058a4",19818:"fbbb756a74c8b4f6",19844:"8d0ee38c75339be1",20136:"6ea9f72470dc32ce",20170:"2e8c6aead60ffab9",20617:"8a3b35a2c9309ffb",20639:"ba245f7c643387d6",20676:"461397318c017daa",20962:"27da11ab7c0a79c4",20998:"2108931640af847d",21085:"dc1ce710bbdb66c0",21237:"ee8d2760b5ab18f8",21366:"11c6290721ef5516",21390:"22f7af29a53ca530",21524:"b0b5254568c54cb8",21652:"4c5477f6a73b3823",21767:"6ef9ecc24a242f7f",21829:"82cbaacf1a71c9cf",21868:"347dbcfe0bcd77ad",21962:"4ae3b89fce6080ee",21963:"54e5bcf70f45dd89",21993:"d5f85cb7a7ee0e86",22175:"c0ce418ac0f783d7",22182:"a4b4be62ac784c8a",22193:"3a59750b9aa4fdbb",22194:"b694ac2770e515c4",22197:"56bf0d13b3a72343",22258:"16da1edd4fe478e1",22332:"22ddaed74a9a6760",22383:"d48294a7f9c0335c",22422:"2a5b6fce29baa2a6",22463:"4cddbdc4e7040252",22935:"369127e0bfb8fa31",23046:"0359698491b5c26c",23095:"f68f5438e31824ce",23136:"e23371424965d3d0",23363:"9e29ec5f3f84a62b",23588:"44d39efd442db0da",23722:"7064826105264c63",23742:"33048860f2ba8e1c",23746:"9626cf6290bfbe52",23786:"c0b758cf3e5514d8",23787:"28a3750e1245f8fc",23812:"f50bc8803591d105",23989:"b9d4cf667760b610",23995:"818d7a7a5a11c871",24018:"38314bdd2ae7fd08",24054:"20fae151ded95082",24240:"a12b6041400e3732",24268:"0ac65380c69be8cc",24285:"024815116c4bd6d4",24348:"d22e1e52ae2a3c4c",24358:"d1168747e022dd3f",24506:"58dfd7e992c65a5a",24529:"6eb99dd5307d33fd",24601:"f19242e5ce9f0683",24782:"bb0f1661482cbeb9",24851:"3769a93590bb8020",25118:"06f4f20b4fbe5919",25350:"b713a63e62bbcfd8",25778:"fd15437d54028f80",26022:"9fad8f8cf02cc485",26078:"1b9fcf6aaf039892",26183:"220e40bd0288eb9d",26205:"099054d14928dda9",26352:"f17011fbb1cac128",26525:"e83cbfdca3aed4ef",26610:"a97e1f62a5c6cb59",26960:"9a7fbb877fdf95bb",27069:"42924521e968f0dd",27133:"134ae425bf08433d",27163:"aedc129a6c10714b",27203:"47f12af11978da66",27394:"c84eb31527ed84c4",27472:"4199e4d67d28d54f",27563:"73c5d2dfe510947e",27631:"6bd04370908c619b",27656:"51bb27a3df6f84c2",27878:"e0fa37de0fd7ff05",28043:"c1f36941cd76a97c",28091:"d57b59682df41f1c",28242:"677f5bdd94aa05b7",28521:"722d4e1fbd96a488",28643:"55964ce83ecf423c",28719:"0a4b20ebdda3aafe",28812:"31b393dfc313632d",28875:"abfbd11a75108a18",28894:"8c549dc6b107c550",28955:"696ad7adc9f1a4b4",29154:"d62cf9841371fc7e",29300:"e8d76eda1b9b78e5",29311:"3d21a1c03f8fc9fb",29694:"6895c549cf10b770",29780:"922e6d00757642a7",29889:"b9179fad37302ff8",29942:"b9f3b88e87c25a31",29954:"4883b6bee578014b",30010:"1b0f5ce95f083a3e",30100:"22619f23d03c54b6",30206:"1cea425488351ca5",30321:"4eedd468dd455abe",30373:"8cb8a7368215ebd4",30548:"b5e5ac3681662704",30735:"54103d053d0c068c",30756:"1e6eea1978702f55",31161:"844b1123ff16caa1",31177:"431c3597c631e469",31664:"01592221e6b51edb",31678:"41a63a89ddd12cb1",31738:"3f9447991c4058c1",32034:"bdc7a5421996ffdc",32186:"de88b06fb970615a",32567:"08afad1bcf2c6ec8",32583:"0fb21e224199c266",32739:"c01ab0edd312dd98",32786:"5fd65f4e99063fcb",32795:"5c8fee0c2ccb2b86",32847:"8a791032b5ac9edf",32853:"947b57f1f6247340",32966:"0951a3a790debf9b",32974:"9682852317cbf2f2",33287:"be9e13083a71fbe4",33524:"88c15d1471e3a81e",33724:"dd45225d4625abe9",33955:"18816dbda8d3f36c",34183:"8922ef45a991a836",34185:"03ac0d7ee760a9cb",34392:"48b77c8ebcae78e3",34471:"52cc58b781b65f82",34679:"9598a47cd1bbc8c1",34704:"4e102e7f8771ac83",34715:"657949317ceaa730",34805:"91f4dd1289b6288b",34904:"21f6676478470cf7",34972:"3191d280c13727db",35091:"db60a952f99e5b7f",35237:"caba3db69a02b11b",35317:"84db465b74b8ee5d",35444:"1d97567b313968be",35575:"53ca62853f1c5f89",35621:"3088a6488da93e7b",35632:"821e4d30dde84180",35661:"bc61f5f7fe874ce1",35786:"cc34a0542525a214",35795:"ca5f6a00829f683c",35974:"2b8ce103f006b1ed",36271:"3d8e47b919a32724",36552:"dd52878ccc0bf16b",36631:"8d618e4504ce872b",37045:"a7b39844db1c87e5",37137:"17473b5e47d4587a",37288:"ee14a354e7731b10",37342:"e370a5a85cbbf2ad",37506:"ff5cebdb5448c7d2",37608:"a67b9bfb63a7f16a",37697:"0ad6433cda901780",37888:"04c90a15d0b95a1f",37934:"e6099a53451cd6f5",37943:"8731c30259328973",38038:"3c372eff268ec026",38160:"986ca4ac997642dd",38184:"32e9916201b938cf",38246:"9b9849f9629fc576",38252:"173eaf0553e5a19a",38489:"ba8b8b4843ec77fe",38523:"403f23af1408201a",38604:"fe5589f3470fe356",38842:"543a7eeadb03dee6",38920:"75a4e97a0487316a",38987:"9b4075062e0eaa9c",39159:"b4166ed10e7ca11b",39355:"febe57553cca9ed7",39450:"1d5d71f6526383c7",39858:"593d17438b92486f",39865:"23daf578ad7998bb",39938:"783459e8fcd27638",40191:"d5b6ede9243db711",40294:"a6bc927eadd1ebba",40348:"c31d28d0085a6661",40352:"792d3ec0f7374242",40400:"c6e99353abcfd730",40674:"b30aa1efd8da16f6",40828:"233e84fb2ded5da1",41050:"f12105c5c684c075",41266:"ba2c5374b5d577cd",41389:"fedf5b3d8a02571e",41610:"eb5ff206ff9acbb2",41655:"96268943ed5ec6d2",41912:"f65b878708facdae",42072:"6a6967d37517ba5f",42215:"7c029a46a3bdfbd9",42250:"e1c3c4e093eca7b4",42279:"c11078b884f3a640",42388:"5e99059fa046d2fa",42754:"4c86d400a5a8c899",42756:"6e48bea0a4da39fe",42900:"4179415cfe6e7bbe",43105:"43205f8085aba622",43136:"f786a952ae70bdce",43191:"812861aeb6d7751b",43199:"b1ebe2454bd4ada1",43206:"07cad4be893ea6f1",43220:"0d5ffe9d9f2855f5",43522:"7e04b27561a64811",43597:"3add640f1f0861bb",43775:"d55ac3cb71f63541",43883:"7def7eaf368bb766",43886:"38130eae5a0ff8e3",43983:"71fe8f00db59e25d",43991:"cdf7b308f71dc0dd",44472:"ccb79021b411aee6",44644:"77543ec68fde250d",44716:"3b6280f553865b25",45029:"531e5f9dea872223",45419:"c092b62d5b2b940a",45617:"49c61d0ef905bd1d",45669:"7abbec1054d333a4",45978:"608be051828b81af",46003:"08b567f73124ac4e",46148:"d0c9d71ca349f446",46366:"3621950450e58fc4",46696:"6c6802f7a2364ee2",46985:"bd8d7b4c20940cb5",47064:"b019fd9b858bba2a",47361:"9ef05d92807306cb",47423:"84b812ee4800c60e",47556:"27481d42c988c87a",47681:"808b41682a01d49d",47693:"15b3aae9f494efc2",47775:"5f65bb2ef84d27a8",48148:"930fa13ad3e4e961",48601:"d1edc792a6181bc4",48623:"b42c6708f7d4a83d",48771:"8264f6c7e2280ba8",48839:"3694e634a68d90f3",48949:"89bae23648446539",49087:"a8a91a9ee1619785",49112:"2b5a894b9a641a89",49248:"3112852f5d290ac4",49339:"e6a79d016342c92a",49343:"d57b2ee0abcf7e84",49618:"8dc598a31ecd591b",49704:"22a402fb31ba500a",49742:"a0e253fb88e2037f",49776:"0e8a31ffff815f6f",49780:"4397cf443559561d",49863:"4c8140369a549df1",50105:"0db59364f29fd6a3",50129:"9392703502036fd8",50199:"6516934fbcad5818",50333:"be8ed81d22ba8e47",50593:"dc430760c220deee",50729:"97ab06abd4f5bf60",50770:"aa1de9b11857369f",50824:"00f8a97c819dda04",50861:"10a36b6f01b32ad2",50886:"af0173edc5d79e70",50945:"4c53b50848da47b4",51073:"f674cf8c47e2080a",51260:"a7df030f2c9667c1",51397:"94a670f6b02021a8",51403:"d5d4b75b305c1491",51404:"c9f082d4f9670727",51487:"7be71daf50a08b55",51539:"f737e2444aa17fff",51660:"784bad3e3fd9fc90",52001:"25d66e06ab674723",52144:"0f5e953505a5df94",52277:"aca5a7af87939185",52334:"6b00639c1486824e",52389:"c0bc6afdb86d2d14",52407:"b566c7bad74ed2af",52455:"2bba75b546338c90",52573:"0fc7a8fbd29af193",52791:"6025a73de3aa8a01",53042:"389d25722932ebba",53258:"444a6002e8c25c16",53285:"f95ee5a460978f98",53330:"4cecc88897d90a0c",53340:"c2bf63c9fa4626e0",53360:"0c6d894cfdad40f1",53393:"02e65be3ad038ff8",53502:"ad9081812897a3d1",53598:"b8d37a161979a5c6",53945:"7070f63a79a14c8d",53971:"2f4c7634183d0972",54014:"4479175ffc16eb38",54020:"b9738f6aeb4fe292",54193:"1cdf51963231eb17",54303:"5be4ad3903cc48d0",54390:"789483ad1229ff52",54473:"cc16151244fe86e7",54498:"c49dd63fe1718fa6",54583:"b5fe55eff26f6a9c",54594:"42245e7a34218e76",54705:"ff2e57540cb50e68",54738:"e57e4acebf2d76c7",54825:"259eb0cd177bc7dd",54984:"96c35e1a3c157113",55041:"878a6abd16a44dc8",55091:"2cb3664a989ae8c0",55106:"271f185539167d66",55135:"709e5c58e6a2b1b2",55328:"b766e71a7372408a",55471:"f0565f96022a1d92",55579:"d4c77715727792b2",55678:"1d9d2b0f7c77d88a",55909:"7239ad6ceb42a0ce",56071:"b03d8c26983d1d03",56125:"efd1b6925c98d540",56193:"2f85b8e3d8818fb0",56448:"1b8f0f32fadecf80",56508:"173bb0c197622a0c",56511:"60210757988f665f",56716:"83b3bdbfa3776c4d",56820:"6f5b5bbd28bdd155",56865:"f8de369e6281ffde",56884:"882c5c6aecb5bb8c",56900:"59e53eea8eb5cd84",56962:"160957faad87cfc5",57055:"2dfbdff89510472b",57245:"d877260044184c2a",57264:"cfdd6178f505da38",57368:"b6ed011089b00fb9",57400:"251f6a207c9d7b6b",57681:"f2d06d566d3d2a50",57746:"6f923dda4cb7c830",58041:"c960e95e2ea7bdff",58089:"50baf71b5e8415ea",58208:"12fc420b182a8ae0",58267:"703e2184b52e6748",58486:"beda6334989a3026",58562:"b2f2e816bba251c9",58824:"c8d2ada0804bbccb",59208:"24b76dec030738b1",59228:"3c2462686acb5cec",59401:"69ad186c2feb4136",59616:"ef0228a3a2225b3c",59938:"3a350cdd4279c6fa",59959:"c0c89699d425e38b",60031:"047c7888a4f86f82",60042:"1b0683a108aa2429",60088:"144c07caa5dfa6e0",60123:"dc6de099438442f5",60398:"64f0965d28bde48b",60441:"7acd826702568bce",60650:"218f7036759a9245",60982:"269baa370ed48fac",61033:"6e919f6f0c51bba3",61117:"7adeae1f5f168f9a",61184:"639b1621259336ca",61233:"c25d458c997e7958",62225:"a26cc8177fa2630c",62317:"319694185332b27c",62417:"ed95df5f614af449",62545:"8948fdfa15641f77",62665:"0ef7e525531ffbb4",62686:"6f9eb64c3d1bba2c",62921:"0c04b69b139db028",63159:"2d6499f31da2af29",63318:"1e221d5133d54226",63366:"3e0d9bbd081aef4f",63725:"07d9096a3e346928",63862:"f165a6ee680851d6",63915:"d8cdb9f3c389b595",64020:"8e96d64c7e4c69ed",64223:"1accda8be66412b7",64230:"2beee08dcec1fb1c",64426:"aa85880134b47a15",64487:"8fddabd61a0175b3",64620:"42457dfd4adcd143",64729:"b16a11673e30d58e",64742:"f8fbbba72992142f",64785:"34e57d599c3ec344",64904:"73a9f980ce1f223d",64937:"c654f9ada058dddc",65016:"4e4783c5efc38535",65489:"6ca9869479fca2c1",65606:"aab8cb0e22467a4c",65940:"c30cc4091bde31d1",66062:"166a56c395f27f95",66204:"70c5e81ab256d2e8",66246:"e7435593f294925d",66424:"6c18d653845a0fe0",66608:"57857c4c5704b996",66639:"83d0aa412cacb791",66654:"2e51ba1f8a4160cf",66718:"c94c00a68acaa722",66830:"9d130f0c819dd95c",67046:"eb8054fc287bafe3",67567:"bc7ee77ff9d2c174",67579:"ef031cc1ddd5247e",67722:"f2265784cb15092a",67738:"5cec7704623815eb",67775:"99bffc6e9500276f",67818:"7def01463cb7036f",67976:"0d694126905414b8",68072:"3045514918628af0",68194:"e86f03861fee302e",68316:"a59c821354fd64d1",68400:"438b20762b1cdca0",68443:"bda2b6ee0bee2809",68481:"6b27c20ed3203d3d",68516:"793c8229db985b75",68547:"9f8a31cf094f437c",68654:"a3cce637ee64960e",68699:"58440481de6bfd98",68715:"dbb24f7ac400f321",68857:"eac0694325b62937",68887:"c1986b7e35389fbb",68891:"57d088ec71edf55e",68903:"7b67216424ae8c1b",69021:"963b4bafa65eeb60",69057:"2e2dfe64da388b73",69195:"8ec567cb4523ae7c",69306:"9f3dd69e0fb6cc0e",69476:"6eb206fc7f0d343d",69526:"ae1ca51759495a9f",69752:"9da36d45b7d90a29",69817:"6ea697070d942e41",69987:"10cbfe85f053488c",70074:"c7690c08ddb9815b",70112:"f2b019d2ad473c51",70125:"31fb0952a83acfd5",70434:"4eada5ab07364f53",70610:"55534d6c67137a12",70672:"a8c4da0c37a51e36",70767:"7f1112561f11442f",70978:"6741a7ab5eb08edd",71247:"fa80bc6a7067b2b5",71358:"9795e081202a7370",71428:"9c6e27211102a4c0",71530:"2536d3b83343a9af",71546:"b7058d48e270f03b",71645:"3050d9d8fa8e9a29",71824:"241e10f6f25972af",71856:"9810cefe4531d5c7",71979:"e61cdb50231526ab",72143:"89d764f2796ced66",72259:"313ed4bf951f09b0",72340:"bbe2ca9c85ab8dc5",72526:"eb11dfad7fca9f85",72713:"3feb865380af7c09",72857:"73f415ca253d7b58",72869:"2edb1ffa4cf29048",72895:"9521940cdf0f744b",73058:"2c2411a7c87e10ac",73067:"3b1fe5a82533f347",73206:"f7ccd4f2ff8fecf6",73509:"6179019fd774ffee",73627:"9a32fb1515f8be96",73825:"ffe523d2ba66aa6a",74295:"fee1c23f8d6f6e16",74320:"f7413fc2ab541b07",74592:"0a58d653b48849dd",74712:"57acfd32275d66eb",74747:"dec11f7c5f736b45",74801:"be1ca57efb7eca23",74903:"9c6fdb45c5f3210c",74934:"954451fd6bf36312",75083:"55bc785fee4ce09c",75370:"5bc8aa3f0e449732",75381:"58fb2ac5e4263d4b",75489:"0b6a06c9442661e4",75727:"f0bbc3a402c9ca26",75774:"3b001c3607255df9",75783:"896a4022883dd7bf",75810:"f76171dac871f98a",75818:"7419271b20f700bd",75987:"72c82418604ff676",76027:"e8a08767b48b1e10",76057:"bee7e12088e5e45e",76552:"118c63f491b4d03f",76586:"990168449ff210f7",76862:"0daf48b031dddcb0",76882:"8fa84322cbd9e776",77099:"86c3e9f1b4d96cce",77111:"e65e534fb6522e96",77151:"5ba742bb3731e06f",77183:"8b3c25ee5ec1cbde",77247:"19e58b0f27b5c73d",77370:"008b096098908f6d",77741:"d679e3049dcef7fc",77771:"9009b424a9eacf65",77772:"0c81e3f784ce9567",77802:"c34e821200db98d2",77910:"b270b39f2e22c942",77930:"94752d8c3fa34eeb",78044:"7e2d9cb59ede9ace",78248:"2de1657aa103702d",78269:"8d4568c27d4ae989",78312:"293202f67be0d728",78385:"25645865034ac64c",78594:"8644bab6daffc094",78623:"08c574290c87c3c5",78721:"9a72f463069a3ea1",78733:"58c5f3a1839177c5",78846:"ee7fa5d63e7c2f69",79091:"74c388732bf25d0d",79156:"2cd0908394059501",79286:"fe71584d3d454a1b",79305:"d2019efa33a31fd6",79357:"e7579dbde550ad43",79443:"e185dbf56c4fb88a",79445:"bcca6c69302deace",79455:"2e8cdae281c0491d",79506:"ef50bf06535549d6",79613:"d030db01dfc16fc3",79803:"078d92994bd3cae2",79889:"3df985511db2f15c",80070:"bba1bdf0b60d86b8",80129:"913d48e1e0dfd0d3",80275:"89e0454f197c5c69",80680:"82eea3c900bb8457",80698:"1ecac4fee6ac9e04",80937:"7af08ddbb636f584",81020:"b2836bdec86eba32",81025:"cc3316a2825c1c9c",81228:"9110303ca54f3a72",81283:"939e290523ec2a17",81502:"32ba5e3497859c49",81686:"864d2dabc1cb3725",81769:"74b1167d52f4255f",81798:"1c7657f6fda442e6",81817:"d441c8d7934a321a",81939:"0bc4dfbdb607cf7a",81952:"17f7a002b4b8bf57",82039:"20db20419ac1f362",82218:"916d69509ebca2af",82329:"35c3ffda7bd77cfe",82870:"04b0719f4ff64de1",83035:"784770aadb423960",83084:"0571e785a22cd035",83109:"030d027e0a3a6b9c",83155:"6c461400c69198af",83324:"5067725ce4737dac",83344:"7999ab3c81913af5",83561:"d0aa4ea2574a5eb7",83563:"223866a48af20298",83644:"a532081427a8d8bc",83794:"3abaff1a92f1e098",83801:"9914efe1730b1ced",83905:"99a1982681457a3f",83948:"d380bc5174eab3bb",83977:"e5d99e4dbbaed31c",84042:"c5234d9f4a7ae632",84134:"6acbb75dd92f4dd4",84226:"7e075821c1db03dc",84370:"d44d404ef0a0f37b",84655:"430b5e1dde1cafe5",84743:"6f739f7f7c360987",84765:"ef86fbdcec539f99",84919:"88639b4349abbe01",85070:"0a8040a577c2d042",85242:"e11312ab09fbd146",85245:"5f123b1709f30e41",85441:"368f8e28e0401467",85537:"7bc975a27063eef9",85589:"da5e99b7eea7f84e",85810:"5323824deb08131b",85834:"f3797467f4e6c8e6",85993:"70cc8f605ecf2bb9",86002:"fba86beec0955de9",86407:"edd867f803bfac54",86985:"9f030bb33b73c3c4",86994:"29afee7f93b36939",87014:"360a2d36fe3069c4",87264:"ece22da880300647",87306:"fddb57d24a6ccb77",87397:"1d38e208e02a189e",87506:"4fd06da9873435c3",87507:"f6b9c666ba9431d8",87547:"fb52b0a9013764b1",87647:"89a5bb7104ddace1",87899:"d703a2764adb053a",88137:"6eb4ed4edcd5cf05",88167:"c9e48917857c349b",88599:"495251a3711a36a6",88762:"361e1c634e1da569",88811:"e6b23db8849926cc",88926:"43ab3c4ba7e11676",88995:"5fb741c1c0fa8147",89107:"b79477977f383881",89189:"9bb23528ac1e8a05",89254:"82763bd995d3637f",89514:"5cded728daf2e9a7",89545:"3364b6dedc2178a5",89785:"7a2925dacab2f4ca",89862:"4b96f18ca9275403",89964:"f2791b6c323be4ca",90245:"fa77e3fbf977daa5",90257:"3bb7a17f5fc1a23d",90384:"68c099e4770f9acd",90578:"b7cf423396e7e79e",90999:"176f73cbec29c2dc",91085:"475414bea1eda71f",91125:"1c9ee9c8b27396ed",91128:"6d8328a1b02b95cc",91727:"edd7da431a7b3b70",91878:"b2a6f535b8a65b57",91882:"048b1c35a9c8ff6c",91988:"2b7e66015f277820",92193:"88a0a6a1044e5616",92277:"7d4749479eed1b70",92325:"746b515422ec9c5f",92352:"5744cbd6389ca053",92374:"79c08ad7d810ecdc",92464:"da8d2acedfca43b7",92563:"2d23a996f99cc7b7",92567:"30d3eb8dd5dac65b",92598:"bc9c7e54d3d9232f",92606:"eedd8106910494da",92854:"5f15e0d445fcbf5c",92872:"87efa4b255ee6b38",92996:"25d724d9cf50269a",93e3:"2df11e12c379c91f",93163:"e40c7f53d76e0835",93564:"b001d4d7fb720082",93671:"8f17859bd73351a9",93726:"1304c91ee3355903",93843:"368d9f5d6bee3a81",94050:"98846b37eb7b8232",94065:"dad70be6d0dcb91c",94341:"833e6abde949feac",94385:"adc5006e28b2f52d",94451:"052865ee8b3a8927",94462:"4b374f84d4d470b0",94505:"4494a97c0853535e",94719:"efebdad70566942f",94945:"bf3b9830d199965c",94946:"74dfcfba23dedab7",95182:"30788e9067a26cea",95196:"a71a087a4af82cde",95213:"467b7c16ecf7c66b",95432:"204c8bfc01e779c2",95465:"f6797754cea0e267",95503:"357f15f74880a394",95837:"9e63bb1d2b17954a",95862:"c5ec6561e767ab94",95884:"306f1917965c15bd",95927:"0436e10a97ebeb0b",96228:"3ff92f87ab3b2c96",96450:"ec01e611a26f5b69",96545:"51841aa3798a9ef0",96698:"225a5e91b14f33ec",96861:"e950e5ac92daa6c1",96978:"489e61c89171b3bc",97206:"077e62e6d3fe532d",97312:"35d4b816eb4493c2",97324:"e158c50e5a764ea2",97366:"4c55a0f9f3d9d8dc",97392:"b6b0c22a8c87dc9f",97431:"3f8d6e15f63374f2",97492:"66beb0127f41c185",97497:"40604c83a376bdc3",97613:"efaf230248001c68",97740:"95b0fa303668b26e",97880:"44344fd81dfba758",97986:"e3392f9bc1fe92ac",98032:"a63770682caa95d0",98169:"3636e81fd02d3bab",98208:"78abeaa69ccc805a",98300:"573d4071e303ba7a",98301:"70604f70bc8e1833",98420:"480aaf11f091d907",98521:"9f9dd2909483d8fb",98578:"727c2e9d6fb76e06",98685:"893550eeae6cb24c",98687:"cb1879bbddb03909",98790:"cf6488465e2924cf",98950:"63342171e34be24c",98983:"df0d04ddf8ccadb5",99023:"04d1117e489e4a4d",99062:"852f1e3fa81ce728",99155:"30c2163a2b5d2dd6",99268:"7974ca4487afb26f",99311:"46249e7f81e3c6a4",99630:"073e64fe746c1c2e",99641:"6735ea3585c4e9a9",99816:"91cd5228333338e0",99834:"04d11962537a71cf",100004:"e5e22ee958298c0b",100251:"b5b7dae612e55bdc",100299:"312924bcbe0e8678",100401:"3eb350683c4cb658",100526:"691b6c9f6cf83b91",100545:"517d4d87517230ca",100588:"b3803beb78aa1a3c",100595:"d16028d7cd5c7007",100671:"61bbb4ec0f3a6668",101026:"9ece920e00a8faf0",101650:"f04a1236720d290c",101797:"823c9706feb16664",101827:"d7d68927fe75ed86",101870:"b7767d1e3dbb4b19",101989:"119395d89ea31a5b",102003:"e355414c8bfd8a26",102087:"9e9a6bbc55de1c8d",102499:"44d8bdda559201b5",102635:"dfd123e8c3f40d34",102678:"61c3bec0ffecfb5b",102893:"d0ef739a7db0b5d9",102953:"1b3bf17cae6550cf",103117:"dda6da2480fa85aa",103187:"ddf6661de9991e43",103385:"265dd74abcd3a1e2",103474:"49ea0e17d4723379",103842:"9b36cfc419300996",103998:"333ad2effbb289c3",104016:"588bd482857c47af",104346:"06ae46d311a5cc05",104475:"c57937c2b11c5055",104526:"4d5be5d07a5659de",104575:"e5bc0e91cc925655",104664:"01ca222c8934f9dd",104679:"448fe77ce922be21",104814:"8ca4acf442764aaf",104874:"96827a9e95ec49fe",105301:"3d72a45caaed7751",105632:"59035f1618147767",105853:"787f34e9835715c9",105887:"f921ba2333fbc693",106140:"812c5e515187b019",106279:"d62095c57ff24803",106328:"2c484a6bed3533a9",106428:"fa7b5281055b1de2",106652:"fc1a4aaba693b68a",106858:"57e0d992073c4afc",107009:"975b690840c7111c",107139:"3b66b4f3474f51e7",107222:"f2fd3cb35c4cd4ed",107285:"1c333fd144c049e6",107330:"8d3dc9a85984032b",107458:"738aaeac72c9f93d",107583:"290210306a4ff22f",107648:"d0ef1d8a326e62fd",107706:"64f549708d038823",107766:"e32004e88d078b3e",107832:"7ad39a6a24f3ca79",107922:"5985115bf808479e",108021:"e9a28f6875cf9972",108083:"1c19da2e78e33a96",108182:"35a4d22a8c648487",108235:"eb1cd6eee8df3bdc",108401:"2f5460e0ad6b0b86",108416:"0bf189f10f5d4d7a",108482:"6e8a148297445bc0",108525:"483ca46af27b92ba",108689:"72ea406551bc52f9",108725:"cea73312f2dcfef9",108732:"ead226f79e68775f",108897:"a7f96285dba17c5a",109030:"35f975ddf2f39422",109159:"b03a9331ddee5817",109245:"d2e01dbcea6233ab",109332:"e17dde6aaa0c996e",109505:"e53e1b34caaf5099",109557:"f77ba695e2e70251",109739:"98d15817227ed486",110131:"0520f0a4bb379de4",110425:"421cce53f3430014",110550:"eaf12246fdbbfbcf",110849:"4c6bbaf3f48576c1",110895:"39aea1aa5a9a5259",111064:"f8de03b35e77e7a2",111108:"f8d035f42828f5ef",111198:"b5629bec62b7c967",111318:"ca58c9214df4254a",111517:"5170b5f0480349e2",111814:"d5310e2cc89a78d9",111847:"5dc93617b9d7c983",111969:"f95f197f61fb6ab5",112002:"dcca76e3e30869c3",112047:"587f46c7f84dc87f",112279:"0505f8f5ceb14b9c",112391:"bd8b3b19b7b45a59",112395:"ad5b1e2909d4a92e",112447:"034f9b120419e00c",112505:"e2e5c7ef5bef97fb",112599:"f674d391c79475c5",112904:"b7cfe6dbc1b84ded",113265:"b0b54e9374999d84",113336:"2619b2438ec86fbb",113353:"5a11a94086d090d3",113401:"3d9025dd69c1f5f3",113468:"2ef9269a94de5224",113787:"3489cf2ceb816500",113842:"f63c23479abc383c",113962:"644e5f53c7a5671d",113982:"b855afb73416cfa4",114029:"24a1bd7fffecea53",114312:"29d88ef6acc45eed",114373:"8ac317e85603ade9",114390:"e39ff0ed8e0d9376",114394:"1c26072a900dfe3a",114580:"87faa1bff3e64071",114681:"e4b6deff410832ed",114826:"42168dfdfcaf958e",115381:"42cee3487c693c96",115383:"cf7ff9bcba6003cd",115670:"6f4ddd01da5448c1",115709:"5186671632b7090a",115717:"6752b0fba3bfb54d",115840:"fa10c3a25a4330b4",115853:"c08f33c27adb8ab3",115992:"1b4300e07c525da6",116083:"f8fab131c28a84c9",116205:"5893e25fdd75c8e0",116267:"e9c0d28d0c75db88",116471:"d6ecff6ab4508f7e",116608:"d51659160b487a17",116634:"47335beb285e214b",116645:"f2b7e93b0d06ddda",116894:"cbfddc6789c68745",117339:"613408adf69a245d",117843:"04f3c22a3bd3d0c4",118013:"a4c5e476ad6e423c",118109:"02534b952674a491",118223:"ae207a643a7ddf3d",118390:"c2b9b22d3d36ac5a",118491:"26b272d206809bfe",118516:"67ece3adff7f38f9",118660:"34e68392b3728138",118698:"79910684ef7216c4",118862:"b30c1774e5a8bdbd",118881:"ac606b6c57a4d182",119330:"40e72f9ccb3c8d81",119440:"fddeb36d8eb35464",119711:"491a863125fd814a",119749:"c1db17d34e74f0bf",119764:"1102e3587637c313",119790:"aae00db60965a5f0",119815:"efd14469d977cf8a",119825:"b9d5e95be446ac23",119974:"af18de66065ee71d",120012:"e0763dee723cd8b7",120103:"0d30d67dfce67c66",120155:"06a28a76e66ff6ec",120197:"da13e4bab2531e0b",120199:"5948e5726a4712e4",120284:"60f2a44067f6ec43",120394:"69e96313754e1ec9",120446:"da06936f57b1c2a2",120514:"db2760d989381ddd",120607:"508044384cac0480",120642:"ef8d74ccdba98681",120652:"fd65697ed9a771fe",120660:"b4a989d36b095eb4",120778:"b48f73c70f6ad83a",120889:"40a2fcff5e84c579",120998:"0f09a309f80186f5",121363:"4d4e6d9d4b1c4d12",121388:"c7b87aa327a46504",121479:"b30156bc1c977f46",121508:"485ca2d863e67a8d",121617:"642a59ad6a9ceb70",121645:"b6092e16a4ea10ed",121867:"4835c770bdb37593",122331:"a5f30e4422b29254",122471:"ee720f32b91827c5",122484:"0079c781e5132b26",122699:"a887eb13aadff9b6",122721:"d356534a04112e3b",122767:"f68ad536abb2a4a6",123015:"9943a36c614e1714",123288:"55b8b6d3156f9c07",123293:"f4d76cdf2b3b0074",123578:"6c653655f130811c",123976:"2add52a87f018064",124053:"77aa0cb41ccc18a3",124099:"52744ae969ecaa98",124197:"5934a99f2e6f6fe3",124468:"e4cf5cebbe98db74",124503:"4780ace130040169",124731:"7cff921c2c50b67a",124801:"90b68c5e686abfcb",124922:"33f0df78476ff896",125447:"dea1dfcede16d207",125565:"f2fa3bd3896ddfeb",125612:"7a6fdcfd6e56ef08",125768:"a36661984e414e77",125841:"b63595dbe6478d38",125891:"1167d68af0698df0",126034:"08f3c74e7bfb3637",126118:"1e331e2b894a09c2",126143:"cc554457f54679b2",126241:"09a308c589677b5b",126293:"6b0cac14645e9e82",126476:"6e73801307a32d76",126479:"9cee61b4da2a7efe",126715:"0e56fe8ddf2dace9",126756:"de4fc1c7f358319c",126838:"75348cb1d523142f",126924:"eaa04bae6122b9f1",127005:"b6e856356e1ae4f4",127006:"8fc4c19eed93d52a",127089:"9a9fbe33852777d1",127109:"1a7ecdadbd80306c",127490:"5002688d1468e29c",127564:"f23cd07c36431118",127687:"6166c3bdf2608978",127746:"6d76a790c43dbf12",127818:"6cf5790fecd26b5c",127919:"b637a5f5faf188f0",127994:"8062934a6d16c479",128109:"2532fd0154b737fa",128358:"1bed946c4283ee39",128560:"a38652b138f0fa4c",128690:"e0cae2d498cfb036",128846:"4fb74bd003d676cb",128887:"9e9e74d474a54c7c",129323:"799e084363428d59",129345:"274a7d903978a64b",129425:"48564c71bc478d29",129551:"e005ba08f28160b3",129638:"cb9159df9ac8ae87",129692:"6e46ebfd1993dbad",129880:"75208b9fa3569d9e",129884:"dd9be290186a47fa",130192:"85c873d8ba9cb1a1",130288:"0caf98c496112974",130313:"421c33dfcfe43e34",130480:"d10418d934ae692c",130500:"35de72406470d6eb",130649:"a135873b09f66416",130778:"89b77fbacbf53987",131077:"c3c73d5c6258c2cd",131089:"39f6f266274c4084",131103:"20dca07354e8eb1f",131282:"b7c0ba417c2d0bc6",131346:"9022da28d2ea8af6",131530:"73891b54616f0138",131607:"be1c0eaeb9be91c3",131689:"2003e98e507f70a2",132238:"a429ff97dbeb7aa8",132279:"cec5f41b48e8a3cc",132475:"f4f4f1d95e7dc803",132529:"eade469a83a05fb9",132539:"cdea8abc93b9d97c",132655:"562c4b3c5d4107c5",132880:"c628686ba1ce6163",133043:"05228b73334c0ecf",133047:"1eb4c26ced145708",133346:"c19103ebdfdbed2c",133587:"758725d78f01b2c1",133912:"bbfd716cc711e79f",133939:"21f6ae74532fcdde",134005:"7f88a2fbbbc25faf",134125:"0d91e4702a245b23",134164:"6bd0933bc2fe0d40",134257:"486ca588fe9dd780",134341:"c6901d96e33920bf",134374:"d261007cfdef0c5f",134500:"aabb650a8a4ffb01",134521:"85b820cb24b372c9",134697:"aa6a60950fc73f57",134898:"bff798aaff859fda",135084:"15f61d927a959c00",135357:"829bdd4d415bcad9",135393:"d090cd3fe00ac99f",135453:"75e4cdc371cc9fe3",135504:"3ab77f7053c1d992",135608:"ddc225d86cd86b55",135764:"689dbee27f5ba711",135829:"efe54c7f713dd943",135851:"cb5c9e3823564265",135869:"cdd499e83b966f61",135911:"18e6f375c8428326",136175:"2baba81c918a9bbe",136390:"8ab9f478032ffa20",136529:"e830640033a9405f",136665:"521473f4894fd67c",136666:"000813ca5eb058d2",137171:"4838fd66ea6a9db2",137302:"593da1bc9c3cc3a8",137308:"153064daaa44c899",137499:"d07c2fb7ffe25e6f",137643:"4e838c3747af7345",137648:"2ab6791f2a3e2aad",137764:"cb966ba5a184ff4a",137827:"93f6f35935431c6c",137831:"f5d4ce94703879c8",137833:"b7cb45fe0525864e",137885:"70bea0080648af2d",138011:"1ae60b4fe8432d3c",138052:"48768b6e8e876bf3",138487:"46d36becf45433ad",138495:"286ca103d770f7bf",138566:"abf00253865c91a1",138738:"1121848107379f45",138794:"98ee6c6aabd910d9",138796:"f815592b7c45adf2",139155:"89e8eee69ce3d737",139313:"d8b727188bb6fd7a",139442:"c3ea76d3772d2ff9",139515:"d149c76e7c70219f",139651:"fee20ca126486a13",139668:"91037d862a52d475",139680:"1ac9007fedc90c00",139746:"6204631337d94b69",139947:"1abcf53996ed3040",140521:"5c6a3e52297b3481",140536:"f8379cabeda7db41",140660:"41a9a4d3fbd48bbb",140661:"5b582a688cb1689a",140755:"23ad1f6c4e37ec60",140846:"05dac287f4908dc2",140955:"38a19b0b8c6ffbad",141147:"630aebbd36bf0ec0",141210:"72dd23a1e44b7cfb",141267:"348cc083a6548a6a",141425:"e6b8c8928a33f8f4",141429:"45cc4e67ed1b859b",141442:"8334c4fbefe4637f",141719:"58f6dafee1684d13",141912:"63f51f6a21406538",142297:"a6b8a30f7b48cf5c",142479:"9586b28b9026bf0f",142705:"f90eb4b1a0c51350",142771:"6d3aa46942a7426a",142919:"669f7a6fa6b3ad56",142980:"36b26bb7dd005966",143147:"cd4cc840f55d8d60",143544:"b3da0207d579dfe5",143673:"abb84ec1cdedd5d5",143688:"46223eb690cd3b70",143768:"d128dd7220c50cee",143825:"7cd52ca49dfedb30",144588:"6f59808ae296655a",144655:"4aaba362d349bab2",144741:"9a2f2a6ddbb49f9f",144777:"52eca575aeaa3dd0",144795:"21d1fb231a807248",144801:"462b24dd6e11df85",145020:"452710832cbedec1",145085:"9eb9d9bb5f96d0a4",145106:"901e158259838cef",145128:"ef05ed5e0a674724",145260:"992cd529b32e5d01",145324:"8e9763dee12a25f3",145332:"5bfda2a75e0a6873",145358:"a43038276cf7510c",145413:"fbc575b9eac5db99",145742:"94bc7fb41472a631",145987:"f08ad49ad3abcfd1",146515:"ee8233b3fb70155d",146811:"c09e4430a96972c8",146815:"7e4c7008c0d6a74f",147097:"9a990c237977a85f",147213:"3f7875cd0bf8c5ca",147468:"79fd99733b22d076",147475:"0a2326f9aa107dba",147484:"c2a4f6f5e63f7cb0",147549:"d00551fd70780360",147647:"96e57e772a81dfad",147696:"bab1073b2918d01c",147700:"49607d63bd278148",147938:"36ddc57527a1eb6b",147960:"dc5bb74daa26f064",148084:"683dbd1d12f028ee",148784:"2db59a22d7b76875",149040:"5e9899776ae29578",149130:"0e02252dfeef5668",149373:"7f5edf4da5318d88",149557:"e8e6b86e2ef4b1b1",149558:"2475b1f5ff0eb281",149576:"8db739453b7b2c94",149884:"35e86ccd5d8c4112",150216:"5941fe29c509edbe",150532:"1b3e25212589d46c",150544:"95335884c4357454",150557:"5be6c67ea4cd995d",150577:"f97ace38fcf1a03b",150585:"291cb8232f8ac255",150591:"d878d47289116855",150662:"2bd061bb2b9e53c6",150713:"12a92b9a7b348a8f",150802:"8425c7de117abf49",150960:"ca6226afc6b7b309",151167:"fd3095efbaef41ad",151194:"93f956e40356a396",151286:"81de94f1ff609784",151303:"09e92e57cd57d8d2",151469:"07ae0af97f693433",151566:"7bbad8c4c2884b3f",151673:"d0768314c596bc67",151772:"deb7620dc218839c",152022:"482262d419252083",152081:"456567cfa8e09ce0",152208:"16a6947a6193a63e",152281:"8f9ca02f518c1fc5",152395:"1975181665dd472c",152407:"9c6be141107faccc",152442:"98ffb0b2107de5fe",152481:"23689a4b8a82e596",152542:"a940b30c5af7767f",152685:"d8897993615c91fe",153021:"c0722c0c021e3c50",153022:"99e311de71564346",153087:"adc17b2b0b86f6be",153326:"926b33f5eb137567",153342:"7ddfbb60f9da0758",153385:"2e9d906df39f1091",153767:"7e103ea59735c5b7",153797:"e6955afc58e59e43",153894:"6b7e6c67ca667063",153907:"baa3930479eef04b",154002:"65d969863892bff9",154007:"05b90bd002872f0d",154085:"5c8f6e8e57ea77d5",154206:"eb9ca36b15ff49e5",154228:"79f899dde07d409b",154251:"b200a2771fb19ce3",154351:"9e833b912a084cd3",154365:"84a230d623db3731",154645:"b35d4d118fc622e4",154803:"9cef8dc6d6eeda02",154821:"6e5f2b21c92dc7f8",154941:"6da0425738ec4293",154972:"5a6bea4463c4d47f",155121:"e1ce87141ba3db38",155133:"56650487096b1488",155138:"213bc0c70a1ae889",155327:"6a6a361aa089df02",155340:"461f54789b235b77",155393:"0947759e982dde92",155566:"a457b9b7a56dee48",155672:"72dce196cd61147a",155795:"59c8b90e6200c50b",155903:"1c93704e000c2678",155945:"97ac79a972d610e4",156255:"e448e0dbedb6731c",156506:"fe6240f05f83381e",156512:"d60b1b3ac0d49aca",156852:"6a1e43663ad00d37",156998:"e17d4b5ed88ec70f",157251:"3d44d337a8885c94",157269:"1ea636554bf6c791",157312:"8da174348ddef52a",157352:"35c642582a2eb544",157358:"25fbae8ba751097d",157733:"a880d6f9a88c744c",157907:"ac631e5af52838ae",157918:"8672d8652c6c0215",158048:"c2affa917a5c3f3e",158094:"badaac2c78e4e7f5",158095:"884af8c3b7c6466b",158143:"bb505b24979e432e",158267:"288790034610c7dc",158301:"e9fea1b165599d5c",158670:"0fb5eb3273eeda33",159111:"7243e25805518dd8",159206:"18f17e73e5c79fb9",159225:"48d5033ec9b17586",159276:"3c15f296846e4669",159344:"0384acf3bc1bf970",159425:"2b73764dfb1aa863",159507:"3baa83d9797e4233",159551:"1e1cb47a97a0f519",159611:"a19fc88ba56f65ef",159696:"13bd2920ed80e9a9",159716:"5174f40935e15065",159753:"6da61441a0b20d97",159818:"76804909de85cb0d",159923:"57b2d7fb9e5b0362",160235:"d37ff790baa87f37",160295:"cab8b4a5497013fe",160479:"f7bc66e130a29754",160568:"30f43d8fd94f9d4a",160618:"a00e568be0f3c12f",160762:"d4aed1e7eb00cc91",160848:"7797f1f9accb2808",161100:"d4b86a41cad31ea9",161413:"ad7f248d7f186bec",161459:"7403007b06f3953c",161464:"09ed00619b3cf7ca",161530:"345bcb0fab9edfac",161864:"902d4a84eca91a73",161958:"24e39411f958ee72",161967:"638e6c09764e4ec8",162374:"003c883a943e3e76",162420:"b2f1b2aab8e345a3",162566:"bbd5ab7c36078682",162582:"502ce660b28cb388",162689:"04e2bc9dcf17ad38",163030:"d12f49fecc920b60",163084:"ed5cdbcf0c0fdd2f",163221:"f06458b1cdb3439c",163348:"9e56b1166b5e2b68",163568:"d99fab365fff1917",163861:"4e09a9b6ddbee716",164053:"ff010df2bf376f33",164066:"da82fe8e45470dda",164485:"8bd9b0639c43ab9b",164557:"30d632af017dac17",164752:"874c20d068acbd5a",165009:"0b6fa399cf3cecec",165150:"9165b09aaa1e5a30",165191:"64a2fa37ec355398",165227:"c8214e4e98ac8838",165278:"2e97d4ab4cd36133",165285:"3b423595ff70655a",165389:"ca8945a391147c79",165441:"35c48eac7ef0c610",165518:"7440d1f86b91447c",165558:"73749706401bef4d",165656:"1c8d6e9982416599",165745:"578e98f849d124ba",165873:"beae4e62af1fb53b",165903:"a882008ca404d20c",165930:"aa50da3f355e51e3",165950:"1f622e389eef7b10",165995:"0b7f75a6b322b889",166046:"2824595d5deb3387",166229:"2bf79c1e0b807d64",166288:"1c5f15dc5234d5d9",166450:"98be172159a5b89c",166937:"ef9156ae5b05bb3d",167105:"471f75f478d8d630",167107:"8a1faf14530ba953",167116:"e0e5339bc497ddaf",167225:"b0767568278afbad",167685:"4f162767da3d1791",167721:"bfb726937a978553",167790:"1db0c051ce9eba1e",167828:"8aa1889537a37a10",167955:"97eedd3e1b3397f2",167981:"64e6d85bacbe5990",168090:"c33909b16e9b9ca7",168179:"92c9381f35f8dcc1",168204:"471a0967e24c0cba",168331:"118197d8140cea85",168889:"f81d6c0ee8dcf77e",168915:"bcb36321b453c2a5",168943:"051eb9b0a4cf2eba",169035:"e095173fe72ad160",169128:"f0a34e2203662a93",169179:"7c6eacad6263a3d6",169281:"e948bd1553ab1692",169321:"eb66432d75ebde21",169369:"d60029ac71745068",169548:"af892377924d783f",169790:"6243031aa73969a1",169819:"8b522d830aa8ebcf",169834:"855bebe96e56ce26",170152:"72c2b9c40b01b835",170238:"39386eadee3af390",170318:"12516946543cc334",170387:"349973b247c7a61e",170499:"57f9a77893242ac1",170558:"7adba6b7d1ccdd0f",170726:"988980ad06a2c370",170727:"d684926e04b504b1",170874:"4a82daaed51bc25a",170976:"f0f9b31c90e4225b",171395:"a0e164cdc60a9382",171418:"05bf09c473966de0",171576:"2ea2db8abdfd471e",171627:"f1793fd51bfff26c",171636:"71f064e46211e105",171721:"99a8226b58b1c29a",171794:"c1e5840164c214ff",172001:"15998405bde461db",172042:"ac6d4ad4c8955cd4",172169:"fadff01c8c6eb2ca",172353:"a151ce4d447637a0",172525:"fb8084f729e42d61",172557:"f8ba9b8a6b8e330c",172670:"0efbd379d837303f",172787:"f1bb9fa4d45e725d",172842:"d435ed84ff7c03c1",173378:"61a9128f95642797",173399:"e9155213493d031c",173410:"5d7f5ef4330ae009",173524:"2582c4e2b5291b46",173661:"6a98ef849bc64cc8",173764:"99cb757a9bb84bc6",173778:"96921ff53092bf78",173817:"8f9568fe4be96d44",173890:"4252d54fa8800aa3",174279:"27ee0842c21bfd0a",174361:"a075a200c6cc2b69",174377:"626d36ddf94b31d1",174455:"54cb24580c8620cc",174478:"7c3bd3c8f9783642",174548:"770c8c75454aec37",174691:"0387159a3eaf713b",174711:"5a1d2e98f6210718",174851:"a8dc10b68bdc0b82",174883:"ff0c2fed3387206e",174890:"3c6e6264d3f7e127",175245:"211b1e3678d17da4",175372:"567e6a0742b63506",175567:"a6a329c0c67afea0",175586:"b1eae2a670dcde15",175608:"3a94d14c37111f5e",175776:"27bb30a145313b0e",175822:"b88ea3c77cfed65b",175925:"9de21d04f0cbbe20",176153:"dc131371c497ec3a",176247:"086137c6c21a31d7",176290:"84273f6bc90d3a6e",176502:"fabb77ac26ef968d",176935:"41d26e5ae6fff734",177060:"ae3fd7dad9763213",177104:"3f9eab6ea16449f7",177186:"d1afb3e078edfff3",177362:"351c157b69d18c45",177409:"b82e1294de7afd43",177422:"076631d6d4a3d5a9",177754:"758d7bbc8da43f57",177795:"44dac04315f1edb1",177846:"1a1175c8e116a486",177884:"6337edd95a61bd92",178367:"773853c401dbf01c",178429:"29114d218924f776",178500:"5757176b7843c92f",178533:"b799cb05625d0dc2",178761:"1a49c3add4747b1d",178800:"b8db3a56311f07c5",178815:"7f9e41ce5cf13dc3",178832:"82dd4e830f66632b",178866:"b6371c7e5d484e1f",178913:"daba17c5b5dac03c",179041:"5c5031a9f5469621",179246:"446e82554fa8c740",179405:"c8e62a2a08ce03e0",179475:"3f97dd6dd12a2c03",179588:"d75d280b8a4557e3",179802:"e154096967355aaa",179993:"c55c8043d42b5d15",180189:"a031dcbcc5bd3f81",180243:"fc7a14b1fb25b396",180280:"09d870ebaefb1cf4",180332:"ea83c0f2a10aabd3",180370:"378bb009752a5332",180560:"ad5974d2e6a77c26",180657:"8195828f1d6e72a5",180717:"62c0b00d88d7ae1c",180923:"b6875d6eb0becc03",181012:"caa59025a48491ad",181174:"ff0fe08fa5b8478b",181329:"95b806105d643cc4",181453:"aff52bb05c0022e0",181529:"f014c768653b8056",181701:"23a06ce22d9863c0",181802:"f0acde24106289e6",181870:"5808ad63c242feaa",182363:"4e617a347c5feba9",182392:"d5691de42a821210",182409:"cedc061844210b55",182627:"5a79f027cb88c0db",182695:"3ae1f0f2ef315327",182773:"1bcf3cb90708b276",182786:"c62b02d5a8ae3f78",182916:"5f8c7e437a10a9dd",183141:"ac71d689d2901e1c",183158:"ea7717bc03c8ebdc",183183:"c9657a595b1bdd80",183201:"182559570d116183",183483:"093cf35a2e91e4e5",183512:"1a0569d34daea71f",183663:"c8d5759df92771ac",183703:"da8955c2e9030c8a",183707:"91755e48c11a03ff",183819:"bec5661f5e440d81",184049:"5f868bcf829fef16",184074:"aacb8db2d183dd89",184079:"71933a2b92ebf102",184120:"8212d3f2efb54e8b",184277:"e9d2578d7c0c25a4",184427:"c0443b0cb6ce0078",184586:"64d30499f23622cb",184874:"1a0d629fa2ed4db2",184895:"eee4fe09bbc80ec2",184954:"527f7d52c68947bd",184998:"5fb0c1660f067a5e",185240:"62406d4c81b1253b",185632:"5369483baca03900",185873:"1e54f0f851251c8e",185977:"8cae8197eb99e274",186169:"ec0771308f1708cd",186248:"b093d023ae6e1338",186291:"23d442108afb975d",186354:"3f0c8040f786382c",186706:"7b1f0d53ff73e282",186781:"245770b9dafdd99e",186806:"6b6a558aeadc0aea",186931:"6d5ed439d81ea1ed",187194:"ffacd5bba83c25b8",187452:"a6d3f3b521b486c7",187556:"d486a82be38a044a",187643:"0850eff855acf16f",187657:"8da4fb155d9c4e22",187737:"97062fd32508d697",187923:"15f5b9bf69ffbea8",187956:"22296879e31d103a",188013:"ba3e235cde5f32aa",188070:"78bb8486fb58b468",188079:"d4b0f3f83317f77d",188231:"24a516c6dacaf757",188483:"33c03d7c1008560e",188532:"ee1976af6e0cd29b",188644:"2286b5abab3d7ab8",188975:"a78c054a804cfd18",188979:"82649ca6050813c2",189035:"3bdf3e5bd53c4111",189086:"4d43de2d10fb4539",189185:"0b8fba99a5d805e2",189206:"0235561c879a1ab0",189344:"7f351d525ecd7c50",189386:"5af285487c3d72e7",189755:"ba3f68b9229b11d2",189760:"23922f5896387224",189840:"0a5e39d7f217abe3",190171:"aeb15849ac3e9c14",190277:"cd254b1e299972ce",190387:"0bfea9e32ad67918",190434:"c4fedef353e69fbe",190505:"6fd7e94ebe0dcdcd",190587:"dc95750a29bb0adc",190769:"ae298028c57fc4cd",191071:"b3d1e605038ae791",191238:"877b3740e03b9dc6",191549:"21bfced3a47cf4d9",191872:"f264eab293a4e94b",191950:"3d53675bf0539f13",192021:"829350380930258a",192151:"21ee38ed89170ada",192203:"cbb8ceeae112a822",192301:"0d5cc549940314f9",192500:"00a4674c69e57fd6",192544:"a1411cdde637219a",192939:"e9eb7c99aee44a38",193050:"b49d5ff6249847d1",193101:"dd97d4d40f60eeac",193183:"0bad6a2e06b9ede1",193284:"22bf5e83fbeebd9f",193305:"ced79d9e3cce15ef",193553:"592148a3bf64326f",193567:"2f348685ea0e735e",193774:"77f22d458f3bb2c7",193841:"b6fffa53b9307d23",193937:"1e2b76a28b08870f",193939:"c18767615506e425",194051:"2575163dc2a598c9",194248:"a2dc79df7df2c878",194421:"43498cb1de6b68c8",194534:"2faa4283a72c3755",194800:"f44471908b611a0f",195073:"fb20d6db98f560f5",195107:"6c4fe0f72c8d6759",195211:"b576cfc124e88b10",195270:"885b2d90035dd267",195320:"671bd09c2b12ea52",195544:"cff1ff9c1fdcfd71",195584:"2d363c7e51166ac9",195696:"8c9ed73aae6027e0",195820:"d20777f9d00191da",195933:"f77e2ab841222e78",196001:"a0f1c2c614ce1823",196126:"1370eae94a805aa8",196188:"12a7ad37b2c7945c",196282:"9f5158f20c669d2c",196303:"4c72a443b4178454",196366:"574a2c2ba82e5528",196367:"4459c1949a02719b",196451:"1b89ad361f9732ef",196710:"318d7bbb4c0478f7",196755:"14ae3de07c753a77",196951:"e9c237352bdf9c97",197259:"9a5401711fc5773c",197322:"81b1939702c6ef62",197577:"f232c4005b482c1b",197587:"3b169f14ef07076a",197689:"24c5b6823f5227e0",197778:"3c0e508e682ac844",197913:"8b9cd094924b53ef",198050:"103472b268457f97",198163:"e029b0eb80cf8919",198294:"339006425777a44b",198364:"d8af9b0d1b8c629d",198532:"3a105d880144816d",198648:"5c98bd74b083d431",198662:"3802cea37a9b87ec",198722:"073bf099a5325321",198900:"25380507773df446",199081:"4c3a7e7648e100db",199228:"63433edf391c2563",199360:"7f1209b458c03075",199382:"5a2d83a40dbb8a12",199628:"bcf21fd8fd05f903",199668:"5ca82709ad50246e",199673:"f3a7c4ae35cbd2ad",199775:"7caab2f2eaee4754",199784:"ad1ce00a68f9c71e",199886:"dfae91cb6e1a69dd",200326:"f47614c54a2351b8",200434:"ed15d5051a92dd70",200670:"dca1ef00ce8c8e51",200755:"d9a878820840b361",201384:"d2379c69fd3f4577",201514:"2e4acdc9382b370a",201814:"987f1a41c6b2aa03",202001:"8718bd60e8362b9c",202066:"5f4664088d907aa2",202090:"812466c7810dffc4",202115:"82688fd487f5465a",202146:"da82b68e597c3e74",202301:"eb96fe9e8f6afb75",202308:"920a1098c7b4e9e8",202480:"42eea0d9924b3903",202667:"2a8a73c87d236075",202751:"2b2b15cd751aedb7",202852:"f96ceb72be9b8c59",202895:"a13d7d8ceeff9aa5",202985:"35d87e1595171d2f",203047:"c51ebad373b5c631",203069:"5e9b2f1cf5992b85",203090:"a14b0e1025405d5d",203137:"2970775537f284b7",203183:"095715b4712390f4",203213:"d0a7f007d99f1573",203249:"61c46394cfa8e9a1",203386:"66b5bcb05ecea140",203441:"282e1a8fa4437755",203776:"6e03410aa9a783db",203868:"f64fedb41a0a745e",204118:"7c13c7d29f5aa67e",204437:"9821cae92fee3b8d",204672:"a236d28a30507f94",204729:"5416d45991980fee",205023:"29bcf39b72d97b80",205126:"9b4490f3a36a6720",205283:"2306b5faae154237",205341:"ce7717b4e3e84415",205445:"61428347212b96e0",205543:"358195d465da8e64",205572:"c888a3670ee0668a",205629:"dae0cc1d040af58e",205688:"16819ffe8b84cf65",205745:"4c65f0890bdfcdec",205767:"95227f0d43e00c16",205927:"04368db8718c1b46",205961:"a8b8189e8d70d01f",206718:"93f185255173564b",206792:"75c0dd6704be152b",206864:"9ead7b77471c0380",206890:"16fc66e9a65b9ec7",206955:"565f4d01e497900a",207202:"2d471ae0afb92124",207272:"b1cd29d41c87eede",207351:"2928a466588d6c74",207356:"95a5bd042f55fbfb",207423:"bdb34ca039e18565",207514:"dea7efba0efcf697",207554:"7d667b1887b32279",207664:"e31f9bdc85e7f404",207711:"683944566d83a283",207723:"cfd475e1ddf2f610",207748:"e581ea7f87e76b3f",208189:"4bf7eece88254d6c",208466:"a0c899cabc5f88a1",208579:"17dc84cc1657c46b",208738:"ae3d80482a06f348",208969:"69911ed448a53eb5",208981:"6e9796bc54f51617",209067:"d7bdb46edf931754",209265:"853bf0190a08dfb8",209361:"a6347e83bd069b4c",209379:"ec47345ed1bf3fc2",209387:"d747be9aef65edbe",209480:"34094af9105a7a04",209735:"2b40696a23163e1e",209807:"c9d6afb5b02d341e",209849:"e6f52c710a462361",209921:"430a53b1b088b032",210035:"42f04510a9b72941",210130:"9ebdeeadba78505c",210181:"1c7a03b4b6af6853",210211:"a8870df8d042e084",210377:"53119909d005adeb",210419:"990fd4166df53e6f",210461:"f3d8a990b772c69a",210621:"9a04742f16f2d6d8",210651:"61187e53ba64b43e",211101:"a50c1fa5b79f85ce",211238:"35bfa42c95e13411",211332:"eca5693d99abfa5d",211385:"70b7e95642b1c503",211414:"daa785b6cd6bdc2d",211591:"262b865d27994a10",211752:"b07d590628a965bf",211847:"8f6f3cd7e4f9f752",212030:"60870a588301f5f4",212177:"8e037e21244da091",212216:"5ca078965829e24a",212352:"3cdd28373ee77494",212353:"b1a806d720a470dc",212401:"39c6f5885beff6ed",212425:"e07cf6a5ba461cd8",212521:"dc63d3a418c490b5",212882:"ccff3f145ef3e2f7",212922:"7315f4ae8f774616",213230:"e9ef076f42ca018b",213262:"21314a739f88de38",213345:"50515db9252e70fc",213862:"621bd5f288e645e2",214169:"b6d3318da58e9314",214495:"cb251c19dd45df94",214607:"39cbea78cae8e856",214699:"a21509780c226cbe",214744:"abe07c64f640706c",214988:"57fa03d1d580bf83",215424:"236310c33f5a1c7b",215525:"2db217867b38af5a",215674:"f2af18e067e4baf4",215710:"fc356af5d077f103",215734:"f1e89eb3ff44d08a",215738:"ac259b9fdaa3ecae",215793:"e80bd8609fb2f036",215842:"06ae7e1e7d3cc311",215994:"03694c76846e014f",216083:"4c6cc5280e927346",216147:"72f869fa0c3f8d07",216161:"892a28117939ddb5",216166:"9458eefad38d1130",216244:"e56edba40df0b92d",216266:"c9f5f73cd812faff",216366:"d7733cdaf3e2bba7",216419:"b2c6b54d3bfe311c",216489:"1f28ce66cd3e9ead",216764:"b8be4cef31463019",216822:"3a9cbea5c0dcb4ea",217117:"36c5639e23ee56b8",217195:"83d42b6f6c89641b",217439:"fb2a3b206dc7e496",217526:"3d8971c2fcceae89",217602:"60285e507d23926c",217609:"670db1f4c15ed211",217646:"b59fcb8f8238b1f9",217672:"d77c90c868304185",217807:"20f4fcf9c5416941",218027:"4977e06175547142",218100:"f356b241b1d56bc3",218129:"6dfb0a013e37d755",218167:"530d8695a21d73b1",218288:"1fe8b10f2d377787",218376:"5723a2188f12a764",218440:"952eed218cd64e8b",218484:"a65deadf95efc9d4",218519:"af3d30baef6027db",218831:"252b3a2ba0fbb837",218999:"5482d48f4c69a78f",219081:"101732f1637256d6",219259:"dd103790b7266c28",219300:"98ff33b877e5e32b",219574:"8df9ca11911981b5",219673:"22d079b025feddc5",219847:"fb0b363ef336bad7",219850:"3023a0d468ae1b7f",220112:"cfc24a88d345dd18",220358:"5d1733d19fc4e9e7",220493:"21708169ddf847be",220516:"5463c0a0f1894cd6",220996:"7dfaa44c66a1dd8a",221045:"21c3544ed318ac6c",221165:"ac5ca9791b3f75c0",221247:"4941d4674d6b7ca9",221253:"a66950806e29ab4d",221264:"fd4cd9a3d9aca910",221265:"d2d4e564c7f221e3",221368:"674080c82c3f3735",221477:"70cacd91529106f4",221519:"63e6546e5f9a23f9",221816:"2db60a90d43767ee",221985:"d9e32e5f79170f20",222032:"f7e619e6f1325711",222073:"fcdb7959197ae4b3",222316:"97f226e557e38a94",222348:"4666b8221ec91406",222479:"67d07a87449b6a98",222520:"f7ddc6f987b72546",222848:"b2eced6bbb6d26a0",222856:"8967b8364e16a565",222874:"85200faf0ade00bd",222877:"08e7c1e6ced0a82d",223041:"17f618f1558caff5",223071:"2289cba489bdc039",223245:"c5a79f920b1f9fb9",223341:"a818689b44fcdcf3",223454:"4eda759611a4f528",223490:"2c054b8cbab9cd06",223548:"bb6364c2b7ef50ce",223828:"99c7003660e7d9a5",223845:"5fe0af750b6351cb",223935:"dc220b7e32ca4093",224541:"e1a0f524b086e978",224632:"adc2dac3e8365b82",224925:"828cc06b9fd4c500",224946:"ccc459a9193379b7",224984:"8188dd00264012a0",225160:"703e6ced5090d33b",225215:"96a55920e9a36118",225330:"c97f021203692d4d",225445:"31c905a85dfb53b0",225570:"feb5167ae314098f",225604:"e262ea6bcfe2c0f1",226099:"3d51b4d545bfd680",226296:"05ef9dd041ceeddb",226381:"42e26d162e9110e3",226461:"bed95fd860621c19",226634:"24ef3e82b2713f1c",226741:"da1d171cb2c1709d",226835:"bf78bbbbd8efec82",226842:"9b50fba9d667bb98",227234:"06a2994d29695c90",227471:"b2901c731cc2fad4",227936:"f04159aca4990ed9",228048:"e162fb4df07d2cfa",228443:"588e38e758e8fcae",228743:"568a5d71503f8d0f",228978:"7dfad14826be37dc",229039:"84a98c498a3b7cd9",229117:"89ac73527ff59a19",229154:"830b9d38ab719986",229349:"3e457b4d67f680b6",229364:"4709055a6fee41fb",229533:"0698161777236f7a",229539:"ce3ae699c6eaa454",229652:"fccd8f3a570beab2",229959:"300fef9a83c8f929",229997:"6aeab52766de652a",230040:"afe7db6d75439ea0",230075:"20fd59df2e1f6bc1",230189:"cc4bfe97d01f71aa",230318:"4e1e3401eed6d27a",230470:"86ab94431e4c5707",230523:"109c0246cb2ce1bc",230897:"740209a66cd076f1",230915:"1c3d4229b530f770",231100:"00ced494d7b7d9a6",231588:"f7645219ef026eec",231852:"7c325975f561fbf7",231885:"863a7cf58bf72a63",231914:"1a4c8694e6ab2a5a",232019:"6e7b8d0bba4a7229",232064:"769e081116baf4b1",232334:"44f467b7a074c833",232349:"92fe1609bce17876",232421:"a816fad0c7fc7c40",232805:"72118334945622e8",233e3:"a1af96c127b8f9bf",233025:"ca8530fa4a7cf63b",233051:"aad7946e715e59bf",233061:"476426915de52ee0",233364:"a69890eb020b3293",233408:"831b0d9a3b416de9",233586:"771669a1b32016b6",233710:"647fddaf838dd428",233745:"557199bfc5d374b9",233779:"a854f591ae95a174",234247:"77ed04c3dcad2a99",234396:"8df0fd899fbe0510",234707:"8e2ce1991d10dbef",234786:"d2e62c4f4d48b9c1",234794:"602b9cb05c6c0f43",234848:"c976d5de7153fcf1",234914:"411cd52124f0d6f5",235069:"7dcb78fb91be9386",235095:"ea97b3846848d817",235129:"74df34cf04f793d4",235430:"43f2afb5111a8d9a",235512:"bccc4b9c53bf6ff7",235709:"43e1089e6c682977",235865:"2136169a8f3c736f",235921:"6dbb737bc0ab5e9e",236076:"d4b5377a1d654f05",236315:"aa5e7a625a822471",236345:"95c2b82913cd612c",236376:"4fa623c75fa85644",236388:"cc0f3ee7416ccf37",236636:"ac187e141e9ca377",236663:"ba0af212a151259a",236754:"b1e15644c6a2c813",236830:"f7484ae0954562d8",236840:"c46820ef13fdc60e",236861:"9869aeee99ef1985",237264:"b1d3c7e101be65d6",237271:"b04998cbccba0cc0",237456:"8686a1002ace0c2c",237572:"418f524f9926d495",237591:"a56d728da77b56b8",237775:"ff1313dc374e1912",237946:"a9128aba444d78f3",238020:"d3f6f2b822a6c933",238069:"a59468e2ac1b5e37",238298:"3e0ed48ceaa1ee47",238456:"0886b1f40481a4b8",238524:"3d876e1d39b3a74f",238535:"e1d9b93d6bed8d76",239578:"0f51163716d335db",239620:"20cea8b25965ee32",239717:"23ce64c4d0d63bf8",239743:"e0aff7547dcdfa5f",240090:"dc6b9ad704f17468",240276:"cbb85b8a1e98aeb2",240411:"a6167a2f626752ca",240651:"51541cfc67e83aa5",240790:"5eccc8398d16db86",240855:"54ffdf8d1280ccde",240863:"3860a5fba18aecac",241095:"e73783a2f6fd490f",241196:"7f1d400ac514a75b",241348:"af086323066bf876",241384:"f5cac040f7e8d9c6",241557:"c7c8fd0f94a40ddd",241609:"b52ce4183eb2bd90",241852:"3bafb3516b0a9015",242291:"e3f27b3945dcfdb2",242411:"dba68377c044ec03",242636:"8c92deba70bc1b60",242917:"81f43e328e2394b1",243069:"8919e3872a18929b",243220:"7b3054513e3fe06a",243223:"01c672b937ce59e6",243280:"fe7ad3c5715aa336",243301:"74e521cb2b498523",243364:"2567d873e357fdaf",243393:"8612af0367befa85",244029:"bb7d537fc063c799",244259:"0e4f5e58004a204e",244299:"ce8071ff7ead0748",244411:"285bff177ceb668f",244546:"d79dc65e1dc99592",244623:"449add3cf592d55a",244673:"59c313a9ad3970ee",244680:"50d8375a46397bfd",244690:"83a4edc08608653a",244738:"e4388104c9226cd3",244775:"00786e134e8fb3dd",244858:"4ec1d833cef761b5",245171:"f79238e35c2cdac6",245247:"0b82503b53eb3240",245372:"c69d80d2fb4fd1dc",245617:"dea68c9eaa72e0e9",245974:"ca775afead1c4288",246053:"2dff1b15a65eed90",246157:"9487880c4abc2583",246383:"8109d1a3b04fb5ce",246385:"693ad9b9f5674d3d",246810:"14516414792a1dee",246814:"d81d632cb4a178ff",247339:"dab43b4e4f534970",247364:"6679c8b9c7bfa773",247410:"0916a72cfb5dcf2e",247533:"17a7f207e25e9b99",247632:"490024b2876d2a5d",248126:"010f714d630e5a9a",248136:"9f67f38805c55ab8",248432:"8af51a08e72664a2",248447:"c53a55e2a9265988",248492:"227b2714ab2b6438",248549:"bd626a8f64437488",248708:"3a1e5248a3c05227",248735:"7b16de84db0e5199",249153:"1d42eae8744d0281",249203:"f2ce2215bd92c7bb",249319:"866112a6cc191aa3",249394:"543f7258e1f13acc",249424:"7bde696c27c34581",249438:"7076d1c4297322a5",249504:"1a700c991d70a6c4",249707:"9e1348b087a462e4",249839:"1512cf5072f86140",249882:"5d06264b52b0f87c",249996:"5922ab0c9bf1d971",250063:"4976db2697ed35c2",250148:"69f4af16005df994",250228:"c60b41ad8a24f64d",250432:"5488f54a6385f5e0",250449:"f85aab684ead50f3",250500:"1665aab8a664942f",250612:"3a71c146e79b531d",250792:"b412f5b0ca5b5cc2",250818:"0d61a4830719180c",251074:"eab5659ac0b2f54b",251083:"c79e889cc8074fc1",251233:"2589b5bbf3942b9b",251247:"0d6e121b44df1701",251367:"b54f4ebf71bd0a42",251425:"c6dc590422a9e6b3",251451:"350ea772bd741039",251452:"6040963630f362a2",251573:"29d3beb0fd7ba612",251600:"46b459f673c4ea0d",252018:"c446caa0343a699c",252164:"a9611ada1d1eb12d",252283:"f986d236746b7538",252405:"b998e6573b570bc2",252483:"253dafcff283f936",252696:"871839e6b4dd1a01",252797:"6eb0a4f41e8b764f",252885:"4d8264f0ddad1cfb",253046:"164436a7d29839c3",253108:"d865465e2d0cf7c1",253119:"0dfb9c6631587b84",253436:"3ea8dc07e6c83ae6",253506:"60e82a1c3acace18",253546:"18b702cc461d8dbb",254166:"a5b8e1c0cbf8e561",254185:"0acbc0273a402e15",254419:"2a0d3fbe5742772c",254431:"3ecaceedc152e234",254641:"f7621541b7dfc638",254692:"eeb09bf51417225c",254723:"2addb1f369a12809",254789:"9628a9df9d320994",254903:"1b5e3ee714e9af1e",254964:"0c509aa3c14e7952",255046:"05bc8abeb8f32db9",255278:"9dc5543561c8a0cc",255346:"d91fc43c8f996daf",255428:"7a18f1173f8330ee",256060:"1241e7a53243d4ee",256166:"9b0a87be7bec5997",256370:"8bb7ebb39544243a",256483:"56fc4af1ebcfdc21",256485:"d7e00f516672c000",256657:"e4951ce9da3a344b",256752:"12ea58472c267d55",256759:"774a01e4c99e074d",257010:"16c2d7d7262f9ae3",257077:"ade8e7bc360e2851",257246:"64025f30af8fc82b",257292:"a17886c648f34766",257298:"cc38d141b5fcbc3e",257380:"5328fd974ab71233",257610:"e4621ee6be853c32",257611:"1d85578c7002ee46",257666:"106d7ddb2e450fa5",257673:"83e41e0f91d7ecfa",257687:"7a790d17978296da",257931:"7ecdcec3d5ee4ae2",257936:"bf17f0528155b951",258006:"bceb6990dfc6a6ad",258263:"2318d69db111ae92",258466:"40866ffe41a0ac19",258483:"42ad09cfd3ea1a0d",258711:"66eaa3e4de9a6fe8",258715:"54f23057ce2f06d3",258717:"f86cd791ba40dde0",258789:"4961fa953392eb87",258830:"b73976f13d094477",258877:"42d8d435825081ff",259010:"8277b321b2d29665",259164:"14571c4c8b4f6bf4",259465:"a5aac4b0824cc591",259659:"ee3bba6b585f9274",259723:"444750bff9fa3483",259844:"644b6d703c08d8f4",259877:"c93beec7b6024b7d",260020:"dd661be67dd764ee",260067:"e2cb1189d347ff3a",260225:"d6ff96e347ed42cf",260371:"00cafedadd565d60",260438:"dbb5b16fac97cde7",260457:"15e8225e753c9099",260509:"af0edb40f2befc12",260630:"efeeea5631965376",260758:"dcc82da3542bc57a",260891:"ee807561ef1d86f5",261006:"4fba194706a9d5e6",261063:"5ec8843daaa1529b",261742:"62dc9a932f89bb94",261784:"99e53e104d201fbb",261809:"d31b8b290592f2fa",262027:"bbe0d0b7033a045b",262199:"13e9eb4611b26e3a",262262:"09965ec292755218",262283:"969b1fcb0dfe5fa8",262475:"12d8dd16305be080",262895:"192ccc9a44c31c49",262933:"e844e1bfbae4dccc",262995:"a0154152355a3c55",263038:"491fedea82d62db6",263067:"ce283fc098b74459",263140:"fe7ed0025805a7f7",263311:"e5142234e57795b3",263408:"ed9ab3cc4c31f20b",263409:"7c2ec5aa1d2baae6",263542:"ce67f350152166ce",263573:"c85db5404e1fa459",263732:"8eccb73019ad66de",263907:"4459d84828267a0a",263998:"bc449f27f0dd9e1b",264347:"b5af790e35dfcc65",264496:"6cd282b456be86aa",264509:"47087b2c6f11a920",264602:"864235283250b321",264710:"d537e2c8a20a8583",264759:"9e0d48bdd1f2cea6",264779:"5b1813fdd5f3db55",264796:"697484d8b177d292",264815:"b67d264044ea9c1a",265042:"7c03abe7c5abf180",265106:"145830475e98ce17",265130:"5a08c1b41f983d0a",265360:"427d65bd0cea08f3",265420:"7a4e326a3a35b91a",265630:"9b355bcd28d51158",265735:"fdb87396030c8e6e",265996:"c5d4aad71e89aa01",266215:"572441fd25778f2d",266281:"d90f406344d1b275",266302:"b5c8af77f7292178",266711:"45a5c44f67adedfc",266828:"2516c6ac88295977",267041:"2f91af7d5d201145",267099:"ef40b61168d43506",267226:"0c925ad7ca5babcd",267228:"f24812bca71ed8c6",267296:"4a1ecb014faab835",267415:"1153ebc690e63d4f",267509:"08ab13eb12ad0c39",267553:"83dc099dd424bd85",267623:"91a770015bd4f952",267807:"2d2acc10e42b0b2a",267987:"c57244a14f2cee1b",267996:"8cbb69ec3360cc69",267998:"665fcda04da7c066",268204:"8d74d8ad34b06e98",268342:"a476d80b896225f5",268355:"8c3bdddbb7d0845a",268446:"7b6452eca11b7e82",268462:"5e9c66786000fa86",268756:"63380e049c2ff17a",268782:"63b7e820a8c61a26",269222:"726f9a6fc8310e5b",269337:"e128917bdcdbc83e",269541:"853b0d7b39bef41e",269548:"93a2bf0cf8b9bb25",269586:"70c9fcf924f97aee",269775:"e37114a200917b25",269928:"789c4350479b2fc7",270410:"41745865de752029",270562:"5545ef8607d03b51",270621:"0d8d94bb1d4d05b5",270649:"3df3e2dbab90ecc8",270767:"e070cf125ae75f15",270842:"95bbf9b8e50c6e84",270912:"2aba486e2fbefac3",271254:"01f30463fcddd27d",271312:"66b11dec51177126",271497:"6052122109510247",271599:"575462fdd0a1c6d2",271650:"7926125bc4e80ccc",271722:"1d24334151e041ca",271732:"8792a458938886a6",271812:"29dc603432a5293f",271972:"ea6b081abe51cfea",272252:"6a65975028a913e3",272457:"efc4a38ab10e40cb",272526:"9617fd5955209720",272734:"bac5bb711de238c8",272871:"e7eeb72f35265ded",272913:"3281c0d739f5404c",272976:"0fca0e17dd68c6ef",273104:"249b1b6fd646c563",273113:"cc19c360e9b66973",273120:"f2845cce4cac5561",273130:"cafb98876ca1764f",273423:"a1f05a6748f8f86e",273754:"9e8cbfa4cda9d61f",273806:"ed4fb500b269ee96",273824:"e208cf2f0de0efe7",273836:"54000b86008e1f4f",274225:"a7e8e54bf83f998e",274511:"573b8430da6e91aa",274543:"4b3d6b5c229f5f6d",274580:"d53a7438841ee4d6",274873:"1cc174ca04e73849",275174:"1060c98b238ffa2c",275221:"eb082eeaa856526d",275287:"284377f06cdfb222",275292:"0afec1d363b5bf75",275578:"2e618d7d4d521cf0",275782:"b3e8b844cff087b7",275948:"9ff7bbdfe80beb5b",275996:"570af6e014422d7b",276081:"ce10db495d72f411",276087:"a0014fae4654ed0a",276518:"0f3e3b578030e13a",276673:"3b10dbb8025af976",276958:"1c8272f510cce38f",277110:"5e20c42b487020f0",277118:"4359ee9ed6460152",277412:"e39b92a90f9370c9",277419:"5339cea120417768",277639:"5c3d36b9ed2b1849",278225:"3913eb098fd3e677",278522:"a91c6d268102dd61",278895:"9a8a476a4b14787a",278910:"89c8cfd806ba4a54",278975:"f752942a260c9371",278996:"3769b760acb06a79",279132:"e4c2719883f6ef55",279229:"bca005121639f766",279281:"9fd923bc0ecf5cb2",279367:"d99da70d304d1501",279403:"06f6414501440b1e",279552:"feae3b58859e0d4a",279568:"c4d9551331ae31e8",279646:"5a54f8ffb015c994",279673:"c0c78b0337fa28ba",279764:"8f2728fd20347616",279849:"d3c5c5a825f93381",279932:"6193f1bb4500cdb1",280180:"f89665dd1cb019a2",280359:"0567c3a9f6461fd5",280412:"fe618c3ab4ae55f3",280509:"559e1c5b437e4040",280574:"5f37c1e0a34a6075",280579:"3faca95c0ed8be6e",280605:"7c34b67580841e20",280664:"51c7de50525fe20c",280680:"d2706629c8ff8326",280886:"777c74d1357fc0d4",281374:"868cc96409893c7d",281415:"56d98164091cdd12",281439:"ccbef4bd4b0da446",281728:"39b350c913ae055e",281764:"b13578e8196d430e",281894:"e6232271c75c41f0",281978:"71d9df6295af4ca7",282009:"0ab9dad358989df6",282033:"65598bed6bc32929",282184:"76ab1e785fdd4a7a",282249:"604e3a154323d894",282280:"dd07f0bc29af2c3e",282389:"0f1c859e379917e5",282534:"ad68ea47f07bcfb2",282596:"dd3033a26d92bda1",282789:"509914eec43eab3b",282850:"fe5033f0902ee129",283035:"4360cf8c1b152ffa",283285:"eaf2dd0a70f664b4",283305:"8e29f444931cc84d",283364:"bd8ef6285a86a56c",283385:"092f3d25fbb013ea",283601:"86031ef890b3c6e2",283938:"9b42567ff17c0418",283976:"fb9fbe218ae0e8ca",284004:"458d18bf926ad7e2",284022:"d853010d6f42ca3f",284100:"48df57ebdf3e450d",284323:"f0a42cdfbf7f725f",284463:"c86163c96f6040d7",284602:"78ba5816a8ccaf01",284678:"68f0bcb3c2ab04db",284843:"ee5a886be5708e50",284863:"fbf567295f6916c7",284870:"e94fcf2b5c7879db",285108:"303074ec9f62105b",285260:"58389453ca62849b",285267:"84a668a690dfc7ad",285351:"a7e74968b3e2b3b3",285538:"49d103507edd43c7",285539:"f1782a5882aefcef",285818:"4200554132dd7e03",286190:"fb7a0a16cab7704b",286813:"373d3b84a889bbd6",286973:"95c03430c2a9bf20",287071:"faafc06b929aa679",287683:"1ef31b802ca1b2ae",287688:"a1670049f135958f",287988:"68ffaef27a0eacef",288301:"bb5a8ebddd022722",288376:"1fe69f69a1f2e5d8",288413:"8aa209d2df8c6f43",288421:"65b016839fd335f5",288470:"38e97967a1bc8228",288475:"91d0a4192ebdcbd1",288478:"06e51b302ccaa666",288542:"ac8836dece7f27f3",288771:"79d59d45fcf01578",288891:"58d158cf64d28bcb",289142:"d69779b72e18b171",289232:"639dc31670206c39",289297:"664b62c5f9d3f315",289304:"5b4145beb5ac8afc",289526:"6b817bb78d6a4c4c",289585:"790e6fa1b08daaba",289682:"3f643f186e348559",289707:"d3fcd2612e1ffce0",289817:"ef43af94fe38969b",290080:"f07862dac9c064bc",290134:"15d768901499ec24",290378:"e88f1b33456697e2",290689:"9cf03c077b95341c",290799:"bbd1650bd19183da",291343:"37d7e53709a89860",291346:"3209c1d6f48e0022",291431:"2d32fd2176c139a3",291443:"80247bfa5b0e8849",291550:"5920932004ed470d",291600:"f5b816b18eb1eba8",291916:"cd8565f15f701fbc",291920:"9c2691663de99722",292105:"70761a7b4116855c",292406:"b39c8fa2e7e6afac",292538:"ef9bcae08f2df9af",292751:"b8664bbc2861c837",292831:"297bed454c60abc1",292866:"d6a8f76596deea17",292958:"27ddda9969c37f4b",292978:"d5754983c4fd3959",292998:"4e49711217a5bcf7",293050:"df00b99de4ce5e40",293072:"04533da1baae514e",293186:"2175d41186def199",293329:"b2b755a023611bdd",293465:"47bd8b13f354f456",293506:"f2deec785becd0be",293740:"b7519bd06c33c7c1",293783:"60b232e2ece12ea0",293785:"7fd2c6b50a7a4483",293946:"e446e1ea2d460c6b",294157:"4d65cee1719e469f",294169:"afc08248548a04d3",294263:"8de0a91fd3cb5d66",294267:"c52c1b3585d43381",294553:"d510a26eb9f7002a",295014:"969055b915e8f1ca",295252:"48a7f6ea60bca6ec",295295:"8f28e1c9d4fe8ef1",295417:"66d3edcb7d02fc33",295422:"5eb9eb51d3cef4cf",295590:"2a1f7c94a7849e37",295598:"e45e342fcd682b3e",295746:"59fa3af4398d96ba",295797:"d98aa17e66c5e2c7",295824:"929d98900002f03d",295890:"802b54fb55d38e0d",296327:"05d9e7fa7ce93585",296386:"7a7cc7fcb91f6719",296422:"11af66c7d4294b09",296728:"969caea837e39fd1",296767:"d7df563276cd1f3c",297038:"f6da39a98b5348ea",297071:"ed46dd26ce6071fa",297136:"f59da9c93449c8fb",297139:"09819e1e44cc7a20",297276:"7c4981d983a5c8b4",297399:"cdbe6746aa397180",297816:"85504a00620b2010",297884:"53cf6f98206dabf1",298059:"fdc63f62b58fbddb",298068:"2d68c7f05c9160ff",298150:"e0cbe9aeba252d67",298216:"7def64febbb12f25",298696:"81d5d0b88b493e71",298758:"8ea631ff3d4e3cc0",299041:"f5cbbc6dafa132ca",299116:"90724a8b881c247f",299189:"a3aee5b696201f9a",299224:"7533aa6765882008",299243:"c04cae5439c38402",299306:"a5d9d9d914cb1d21",299351:"5c2a8d2b071319d6",299366:"cb2fce22d9f6f36a",299382:"092ddbfd787dfc07",299451:"8c0f9ecaed2d04ec",299567:"17a1d0ba5580b416",299677:"0c0b6b2bccb1fad8",299785:"66235e6a9f84677b",299893:"05c0f00a16ad8017",300374:"12cc267f563c6524",300420:"5d0059508e8fa981",300524:"6d27f15b1768a914",300866:"1cd3409a0154fbdd",301097:"a34ddcc2725f6b85",301252:"64eb4149469fef17",301267:"db91c35ca64de083",301294:"95791facb9cee158",301315:"8259caf49f085ea2",301420:"67f51c7689c7be7c",301741:"1f872daa6093baf4",301930:"6f7a5fff0755397b",302168:"ba9a668fedec1dc5",302274:"d7e68525e741d3f9",302518:"acf0ab2497800ab4",302621:"47d6a248542e3f4a",302653:"495be3b7653aa215",302667:"34ac9777980e18e4",302696:"c101e4c29f8bb4b4",302747:"8b42d3a4766acb54",302773:"13f65a1b37d56abb",302959:"e817c75ccafafe23",303014:"0ec583ea8611ef58",303061:"37bb735e4a4cd02b",303105:"a6a3ec152ffdde30",303220:"4748a8810e639afc",303241:"7e5ab986cddfbe99",303460:"eb44aa2f0ecaa47c",303762:"726a8969fe2ceab2",303821:"c737eed8379c9ad6",303919:"f568a8286ed385aa",304106:"e5814b68eb9ca447",304195:"239a4ced80741312",304212:"8c11c083eeb0d7a2",304523:"08719ac7b763db2c",304596:"3088ef9a2842686e",304609:"5f4c92f274e74547",304952:"24c913988dbf28d8",305036:"7669a16e285bffab",305081:"576cb3e6ea5a0b32",305129:"8fe12d92a54d6e88",305142:"d66e8a9851fd3be7",305264:"b3b9ece0f98c2927",305271:"11d27429d01b386d",305303:"507f0a965cd87ede",305406:"d16deb6a41f90460",305551:"f37b5fcce8d62522",305652:"8a0dc6ff4bc95318",306157:"7c54c38dafdbde6f",306158:"aba50b2013557fb8",306223:"484b65c8d393249f",306292:"4781e1fac806c1b2",306529:"72f79924895a5b6f",306644:"aea14008dd8ea0c5",306760:"1c36d773a331e87a",306978:"54aed0e60d240eb0",307290:"53461796b0531469",307298:"1289af0d3a911a52",307421:"adc4228375acca77",307473:"8dda4d3c310ada50",307494:"1a9246696875cd1d",307581:"9e66f506eaaa8670",307674:"bf618b7bfd2870b2",307738:"e1f746b8e49101d2",307828:"03af2cf41f32dee9",308019:"97a34622500b9533",308063:"8aeb952be58d7b5a",308104:"0dc3bdca2d64dd25",308398:"4f10387da2e0fc85",308418:"2424ce7db934d955",308640:"e63271dd899451f7",308687:"258ae4dd3a8470ca",308690:"02714caf2b825353",308725:"1955976bc6982c75",308961:"57bebf4c177da46f",309051:"fea1fead87448a74",309119:"7bba753b9f4e0ed0",309164:"fc606669db3e6ce4",309235:"ab7f2bf6cff82274",309342:"3c7ff96b90a616fd",309416:"5bc5a4da0b2fc2ee",309711:"e084f2e22859a648",309779:"6bb0d0bd3bbce13c",309800:"464ba6cabbd0b8f2",310050:"2f2c8b1135d1f20e",310262:"24b9529c3b41dd49",310446:"830506728bca3cba",310612:"06569d36e9d7e09f",310683:"5ae9801dc4460bd0",310861:"0fe865df4b8fa4d7",311115:"3dfd8e2bc6cffb98",311165:"f6f926039aee08e9",311313:"34cb07475934b7e2",311338:"0a657a8a3f921024",311358:"3c86f0c722f10a9e",311368:"641698fbb66bcd9b",311461:"e08048d87c34d86b",311602:"060685a18bf68e9c",311794:"1604ecda612c0d56",312064:"90d736d8318bfc0d",312327:"580a89fae53b9f0b",312417:"859c0e4ec536844a",312727:"7a0eef1ec24066f4",312773:"930eec5a1f6b3033",312939:"9b8b926797bcedce",313011:"b34fc2bcc0cf4362",313170:"41f286ebf8b17ce7",313279:"2e1a1be4a00609ff",313304:"e6d6120e30b83ad5",313308:"643913dab8e707b6",313311:"2053bdeab5bab42b",313417:"a8162a632a78d143",313459:"4bc45249ac4b9ffa",313563:"4dfa8e387208f72d",313615:"16af3e4851f97804",313795:"b30a7509c6307597",313832:"a8f4faa7ab0fd1d3",314149:"0765447d490e961c",314263:"b319e6cd260d816e",314457:"bc13fd9ff5c088fb",314717:"77cc14a46fe8626f",314748:"2e160dc33f4b8a1b",314925:"a40ba61067b51507",315084:"0ecd2bdad43a8d0e",315427:"114126f2e6f8217f",315614:"23b34b8a063d1593",315622:"b440c29fbebeb7d2",315811:"078967482cf7cff4",315850:"f265eb694163124e",315956:"58bbe362c78c7954",315961:"326a28dffebadb87",316146:"2e9d59a7b3e583c0",316439:"363a860e562d681f",316673:"2c327d697c18bc3c",316711:"63c7f28a6901c0af",316907:"c8905aa3f8f4f673",316931:"bf6d9dc9e414e526",316953:"8a2f85045392a185",316968:"b58a6a519b6189e1",317120:"cdce0b5ad11e2db5",317323:"c0f027880999ea9f",317438:"a3707c44f1de4c93",317601:"3662e25dbd67a69d",317627:"59793a128209ede9",317915:"676d83725d4ee151",317961:"6848c99f2443a4db",318049:"1815ced5b2aff779",318063:"ad0901eb807c29f0",318112:"72658c5c02b27df5",318128:"fa867a321979c086",318194:"e7d7eae5e4420c26",318689:"9e4059a17181ff3e",318806:"a8348c432e0d66d0",318838:"6eceb4cf108efd90",318888:"4b9212d57df46c33",318941:"b01189c92b7e302f",318968:"36c3da2594e3622c",319002:"927368cdcfa21138",319049:"45124347742a56c4",319085:"5ff925f94d93d0e1",319113:"7d2698c4c46933e3",319154:"fa4e602c826ae837",319420:"45ffaa1727d102d8",319446:"7b394bdf6f72ab8a",319648:"517e37371164c76e",319676:"157922adb51fc776",319722:"041370bd7579b8d5",319870:"70b9d39a46156f87",319974:"aeedf80849a666e2",320011:"bd4b75d7980bb8ce",320174:"857f9d82d576d3ab",320271:"897323acc238a7bd",320406:"824500c0b9a2e4a3",320427:"103ebf3cdd912e67",320457:"ce65311fef3a85d7",320464:"80a75eb0080d459c",320483:"3078998d06ae11f9",320555:"ee603568409c9a0c",320585:"6527befe7675130c",320677:"3355fa4331ffac57",321003:"b6cc3b2af8df6624",321051:"d6b2a3a4c60f08ca",321141:"3b52eabf17460300",321149:"72dce682b4ffcae3",321437:"fab2e6aa0ac6c9ea",321487:"e42616853eef6d4a",321571:"981f76b136171caf",321672:"74f65330fc4ed9c1",321881:"aa926e1d693921ee",322117:"ea5f55ce4c3bef13",322216:"2700f5da39855089",322466:"1d91cc04a9811980",322473:"fe0e3653a90166de",322499:"83b3c48f57223ee8",322540:"602aaa3887283ba1",322581:"9516bb278c3a5f97",322610:"d6c912f70bb186a4",322825:"ff0bc1726d064ee0",322845:"8da979d6b1d29645",322999:"54af851223198bfd",323134:"83512e19a3b17baa",323172:"3d6619e6ec8af036",323233:"ab06f2e8b96519f7",323492:"25e529b46bf3e751",323817:"53f171169831f133",323987:"3637a20ffd946761",324001:"ac44b1a16abe60ee",324138:"a4badb2cb8d7e083",324348:"0f4bbf30e5540752",324494:"890941ff5964275d",324622:"2cbe468c91321569",324669:"799ead2deeb7cf70",324697:"33f74f59d652118d",324784:"86ac9a91455e1f40",324857:"a1e26a4e1e5f4169",324925:"dbaa07e490f70987",325021:"19637dbac6496769",325064:"44955a986378713c",325175:"5731201becfa7ff4",325223:"f2f10456e8a7e4d7",325383:"e9d6a961cfcdf721",325428:"b408d4e55da37466",325585:"b8a9796f5c1e3bc2",325603:"d02233aba57302ab",325814:"0fdd8dccf6cf13fc",326115:"c4640f9617d31e67",326427:"4c3027164207b951",326594:"d6b2968cd7dbd7d9",326722:"46ced95fcf60a48c",326801:"bd3175996e9b2570",327059:"2450adcfac3189b6",327076:"b264257dc527c03d",327081:"69d0a1df752e695b",327082:"c5286338660f31d5",327340:"c0f4076c5e8a253c",327525:"ad7cf847a37fb77e",327724:"3601b7a3f78cf047",327735:"f2a6f51d2330ebd1",327853:"35e3a96284acdc81",328141:"45a2fd31b4aaeb8d",328281:"6b85ffa90a089623",328403:"f3fcaeda57376bca",328436:"f142a3a720a8869a",328457:"8bd85fdc9277069a",328502:"bcb09aa0faeca734",328508:"02306e2b3701be6d",328571:"1d4a24bd3cc43ef5",328580:"f3256e9f22927e5c",328662:"0a83c4472afb82c7",328985:"4df74fe38f188e2f",329094:"3c2c5ad0036daec0",329123:"ae49274c471d7d10",329294:"11210a0984858890",329392:"dea25d98936a853a",329589:"b7bc2beaacea913a",330200:"eadf19c50c906f57",330424:"b5298d975abd5cbb",330467:"355a43ba20636a3d",330480:"d1e30e19d0ce9a7c",330725:"3fadd19f5cae6258",330768:"1c54b847d210d8ef",331224:"550ce2f39820c3bc",331625:"c7f8d03b5670f1a3",331986:"148d4aa980031f2a",332107:"8dd0b20d2964ddb3",332160:"acf0bae364008a8e",332275:"0d0561a1dae9c834",332295:"e20f53f26f8a4ad6",332303:"9f223b2b9a65c0bc",332313:"7fc552859cac5181",332403:"4cf979cfd97d2159",332701:"240e0d8fc8cf9b2e",332999:"4b3e9b56a5ce4bd8",333004:"0a8ad51444950a8d",333012:"41b6a4d6b6d02161",333089:"9e4bb55887a6fa05",333176:"4ff189b704563181",333433:"12fb13030c0eb3b1",333515:"9e55fa7d5f7180cd",333577:"3d25043bf2bd2155",333684:"2232fff489ec4568",333785:"4d73d4b9cc6ab332",333802:"1946ba2369f419b6",334137:"65ceff045d175352",334170:"dcb8f9a4d6cff54f",334295:"64b66164fb5cee3d",334343:"8f6f472c51b18bcd",334406:"4dc1367db08bf0ad",334581:"59aaa2a949e545cd",334704:"4364ae19eee84a67",334723:"37eb0d613e87fc6c",334731:"046a962e392b194a",334794:"a6841ce748f157d6",334850:"8547dfee9caffa05",334992:"c299ec9e772a83eb",335101:"d46a984acfaccebe",335171:"5401e8aa85279535",335225:"ba2f0eb3b61311b9",335251:"a4acb05037384213",335255:"b68e2a72677fdb12",335376:"5cfadceb35e10ab1",335413:"f3b798d5aa7d6702",335438:"315a825c2d22fc56",335542:"b4b44a7212c66a54",335902:"1810713240d48812",336029:"e52654cf46634d2e",336037:"a2ecccce42a2aef0",336217:"9d68b6d372ad49c7",336354:"5f32a991fe4a3f80",336463:"ad21b9b4c4cd39cd",336826:"907daeb29faa66c4",336907:"9aed0f2e01c72e61",336934:"bd656867d6160838",336961:"14941e6fb59dd77f",336969:"1b99b61196e7f187",337042:"c859c5a1528383f2",337062:"c07e9eb0b9d69a52",337085:"99e0fa936753000e",337244:"a121fb6b867fce53",337301:"8b09d18b5620b1d2",337427:"12e70586ba9f7821",337793:"8cdaa51777862e6c",337884:"947df9cf5cf16241",338059:"55c25a65cdaf8de7",338259:"54df4aea5e256ae5",338299:"8013200e99a6f25c",338586:"29a41783fc15107f",338625:"a9fcdeb1f1fdb795",338734:"8373e7dffeead881",339008:"c996bb31eba9a040",339122:"ae88d925ead86fc5",339195:"cce28ba617b0b381",339410:"b44f3d8d16e87a5f",339441:"5096c72fb6d69be0",339501:"a8eed296c956b027",339541:"d052db54f13ee054",339750:"a72d9ee785a1e383",339830:"65b35ba54c87f37e",339888:"bb8cb5ff03335a40",339902:"021efb161f68c519",340060:"8df4cad837574ff3",340285:"07d3de0465a9ef90",340437:"7755d0ea946eb004",340469:"1ba15682ca3e579e",340513:"45bd2a6effae84a8",340718:"bd5c0a8569522c00",340848:"0240f36ae49ad4ea",340938:"a1fb2288c84c1709",341009:"52ce0beba4d24d61",341018:"369d93af39c24372",341224:"745e7067206814cd",341245:"d99654015c4d7855",341267:"373d86db86fdd5ce",341305:"ba8f6ea10a2d51f2",341502:"4af5746767376e48",341722:"3bc90e32ffac49ae",341802:"389bb7168fb0aa6e",341875:"7c282fa25a5f795c",342195:"2aea556a5d1a9535",342426:"d722852d7f700d62",342436:"a40c7df335adbe73",342461:"21dd5c6da1798ff6",343151:"7b950c395c10877c",343223:"17bb4a4d36e480db",343430:"984caf2002ec4b45",343531:"309c66bcc216cd59",343577:"1e2c83ef8258cf54",343607:"5108569285f25142",343742:"0058d5c172e1eb84",343831:"f8ee3469aae8475d",343945:"03badc9cfb2f239e",344114:"3980b4446080a7be",344134:"9cec11eb941b2f6c",344452:"c23fcf0ed55207c7",344729:"ebf1e0ea97366e4c",344742:"9037420ff20e6275",345315:"3c945cd055ae47e1",345626:"23e4e446b9d31d1a",345709:"cef3d4e9a4807e19",345805:"146e9137dc07e054",345855:"bdc3d7fcd54a4e23",345866:"6b9bcdb7e2cc8247",345933:"61978a97bac10422",345988:"38652ae2aba0d145",346082:"8c1399c92e60fcf8",346208:"a3656dae470170f4",346447:"c2df36a53c657325",346525:"e93fb90aaf47451c",346646:"838024f2e50d1b9a",346704:"4c5b36b6187cd600",346789:"160dabc540e20f59",346852:"abedd3030b700cec",346866:"af2019aa5a4faf06",347162:"8399aa2a4f197a9c",347262:"de8fe1c4f04ba95d",347386:"dbd2df27379ceb23",347400:"de97e341534e9172",347451:"553e13ea9f037ce0",347600:"28cf969a666952d6",347644:"18623e19a4e22f8f",347758:"471a26412dfa58b2",347778:"6c94f19b78b17ce5",347800:"950013283abed611",347958:"f8887dc85fe35bb4",348010:"d805adc9ee3e76f1",348025:"3b126c67d763f2da",348040:"58dfdadc6aa21ea2",348151:"f88c2756fc3b500e",348166:"279760709c33466a",348627:"074785c770df15cc",348658:"a2085d46821930fc",348671:"c1d327a9908664e7",348678:"9fd25844672e5365",348687:"378761c0853cbe34",348840:"429ed262a980c427",349073:"d13f48333abcd310",349174:"102a4e1716979ba5",349191:"69a51f66ff3d3f74",349346:"d8f29c1dca8d860d",349347:"1734d2c2bfca7792",349410:"d78a51a8089d3841",349519:"25d8c68b8b85892d",349539:"378f23495e242803",349682:"4f812d69cc38a27a",349785:"26b3b2052e22f3f5",350030:"c0540e24003c378c",350038:"69f1ee7cc074c18e",350192:"2f6db816569b4d4d",350223:"e8262ae3c304a56c",350505:"2364630a5758b5ab",350650:"a846d60ccdec3ee0",350718:"359a3c17385dab87",350782:"a11d445308b8878e",350842:"4b7b7fd3b29a9cef",350961:"4cef37867cde0d31",350977:"9fa12185bd09bb34",351002:"0c05c5c5ec2fcd01",351085:"5137f62438ea7cf1",351161:"3ac557fca904d743",351606:"e49e4540f09d9399",351752:"b42414ad42f5d34b",351816:"fd472a88ff4acaa8",351914:"c7ff9fc4c1e88ebf",352250:"cbf8bd11e0f1004e",352277:"ef0cb6043861e246",352324:"6b79b2e7f02e3e8b",352415:"a050fa6116692605",352585:"197a01fd8e433515",352609:"4c3e74e03fbf1a24",352820:"2970a93f88d9bcf7",352849:"db658da6da8f9c38",352931:"bfcf305a377247eb",352933:"aada0d836af675aa",353236:"7e70b130aa0e7f0c",353488:"1c48c2da1114beae",353749:"65f1a84109e007ca",353833:"7d3f87beb38afd35",353936:"e6bcbf1dc157536c",353991:"a5884d95e3161d12",354258:"507368ff1649effd",354265:"6796f2742c993cce",354456:"a20ea2c22eb8f93e",354540:"c5339551277383a5",354548:"a127b329aa0406c3",354564:"dacb42f4bbdee782",354599:"c5c7e5fa4d524b01",354673:"1d8f3064cf512908",354725:"2b9a123e4ce98e8f",354735:"6495e994c85f042e",354881:"87b36404cc0306c7",354905:"8466f11bf964eb0e",354936:"ba4ed6d56498b5f2",354989:"626eede1a97520b3",355015:"b87e8f5b4426b417",355221:"452205556f7b9ac0",355430:"3e3c2ad082c87d97",355573:"d2443438281e4092",355835:"a213a881b3cbc258",356053:"4e2d241550fb8365",356098:"f360f2d76e1de7da",356113:"d91995f6db3e36be",356149:"f05dd690fd3c3129",356383:"4a2385a681659d8c",356545:"fff014a23e37ced1",356564:"e3cb2c6cb25bca7e",356640:"f7a0ecfac9deef6c",356693:"19e40c3620348d74",356859:"9898af6fbbdf06fb",356862:"c9c6777dc1c3bdb9",356871:"a6a4e7127c06005f",356956:"76151482bc6182aa",357005:"d65c3b9a3f93fe78",357260:"ea0f05447e44c7f6",357298:"a3909281c1a7e295",357352:"991b367702a96bfc",357498:"9182d689c653d4e8",357625:"e0ae121dfa067fa9",357660:"9d93ef93038b5569",357786:"511ed58016696ce7",357821:"19c3feaf40426d1a",357973:"8dfa8128ed486158",358035:"5908bb2d13f401d2",358132:"77ebf287d2d521df",358342:"27a2ce2b863846db",358377:"88a566772eb2fa98",358438:"c25a09193d52f09c",358512:"de4c425b36690253",358685:"eeffe59c8a1654c9",358766:"a8f4bdf82e6e7b2c",358825:"9857761cd4a37110",358861:"f142067175062373",359034:"b817efd5de0616d8",359168:"e733aeac9d1ee254",359350:"2c06363cfe7428f5",359514:"825421350a1222ed",359571:"0e46fab5fbefbcc3",359808:"c84d32b5663a1e62",359923:"eb21d1d11b40799f",360016:"9c3b1c3e54a79910",360345:"a1b6047c0fd64001",360351:"f21dd119876b4bf1",360532:"c3a7877ca6e68347",360695:"7841cc5a1a50208a",360806:"65dc95bd7f19a4f3",360940:"f8d77995cc3a74bb",360941:"07dccaaf514c4136",361001:"919d86d12cd94076",361024:"bfc662529eb6fcd2",361029:"a2029960f1239491",361123:"956e65b57ddd62dd",361256:"f2b6511e665364d6",361748:"8c90e9dba835c9f4",361849:"4091b7ce52594896",362201:"47d35c0b31b16960",362281:"e89b014f47cde7c5",362362:"241838e8225d2c25",362363:"a752a810b098b286",362376:"b69f0b53d9e555ad",362387:"67674a15a00b771d",362437:"3c8b6ba0c3918ebe",362497:"7264514015c59849",362660:"ec17a4b62c13c949",362979:"e8aea968a3986920",363127:"0226dc0403af9349",363184:"2d19decc86dc2cba",363339:"aa844db56a1a8159",363557:"c32bc22b5bf955c5",363651:"b202549ad1f04720",363685:"e370976079f30842",364183:"5328c8eb4ed4f56a",364517:"4e0d960267cca429",364681:"1d2df5d9b6a03ac3",364786:"d7ee66512affd56b",364933:"3566364b9a905e0e",364946:"f05e523cad5c4d77",364961:"7bf2a5d695a66e1a",365093:"0ef6058344d52d45",365132:"a8a4f1abbc49d8da",365143:"2afd8810110be51f",365161:"6efba5e2f2964831",365379:"d513a4ab475711d0",365664:"8cc5ca05ebdf923c",366053:"32ebe45067a5bfdd",366155:"9ca22923d7ba058e",366176:"eb2d33a6d682e586",366232:"7e598bb561f8f775",366263:"d51a954522801fee",366373:"aa9a83acf0c5ed46",366411:"d993588794a8d80c",366438:"8783a1b52f4200b9",366591:"dfcb95702c54a2b7",366620:"fb8e9ec0f0332691",366629:"2c3e4e895eb0f1f3",366962:"07e59aff3e699728",366971:"36941ace61e68663",366973:"f17f9fd6b6fbb460",367254:"b677cf40c13710a1",367374:"e97804b3ce7ff99f",367636:"f35f841693b97670",367809:"7f2c9ee7997a348f",367949:"93482b56112e67fa",367961:"ad761a19a970cc5a",368e3:"137822fbd90e457a",368037:"14a0403767df846c",368283:"5eea2c83ab8690eb",368576:"19cd9fac1f80502f",368621:"420d74a41b124adc",368732:"e3674a849df2aa15",368763:"5d1739b2bff5642b",369061:"a564021db5345f0a",369263:"25637a217714d54c",369265:"03a82e9bed01901c",369402:"55732767fe586b8f",369429:"6be977d1d8836a33",369617:"f3adc711297459ad",369944:"ae5921734e045e1a",370004:"82cc1cfd6a68dbdf",370388:"f683eea71d75df8f",370409:"7b4c93f5d74a3797",370533:"5cc56ec6262531ff",370582:"3592fc35be6b302b",370696:"7bc5256a87ebfe4b",371040:"66a18310b977bc4d",371194:"422b7fd394e6e850",371222:"f60d680e8107e7db",371306:"b10bd6b1ff0af06b",371336:"f5288233b7b2162d",371374:"4272a27fbac80688",371401:"b796236384a5326f",371493:"d1edc164b3dda2c0",371595:"96b3d911e297d99f",372136:"e238eb22c6923881",372276:"db5ba4232f5b893b",372298:"c842375edf75a4d3",372349:"47230ae3b7a514cb",372354:"ecd93f7c42f6f993",372371:"0945f2f18acb7fc0",372389:"469f602eed0ff203",372397:"3a6e8b37b50dc054",372479:"4ef97dba3fa4c6a9",372697:"e819cb92083e93e0",372713:"85eb8851ccb1f60b",372936:"e41aeedd57f0f439",373369:"5e824412a4fd9d1f",373809:"9b987588318c4fba",373965:"21512fa919d01e41",374059:"04bda24cf9f8e815",374154:"f2c1752d95301c55",374424:"ec1871561591beda",374736:"684f028d7c7543cb",374750:"2db3d53994566030",374817:"0de351b9ee11e4f8",374863:"f562c1cb90a20de9",374929:"cdaf6d27a3f7735f",374934:"3fdcc0faee43afcf",375119:"4ab40ed914ab48bd",375136:"5a275a57e3106b05",375271:"8ec1e02d4506c1eb",375434:"2ee0cfb7c8719d63",375470:"06aab3e1b4bf3a36",375558:"a24593015856a261",375610:"b75aba533e3c6164",375616:"e1523c652996eabb",375804:"a0646aeef0344b01",376001:"9e8e0a32e9844a1d",376049:"36c39739b6643749",376072:"55c2a7d068b3b782",376090:"289135f8719d7822",376222:"ce8512e9b6889cf4",376238:"c4450d08e0ad8de5",376422:"5ecea705c40e53b6",376445:"b6373b609d8be05f",376461:"69c4ed6999331acd",376505:"5463e73c702d3df4",376548:"005a15803bc96c64",376713:"07a1d2cdc5827498",376803:"ada034ac7a5cdba3",377004:"bf26cb58a99aa876",377087:"a5fd9016ae1181b7",377149:"8cca546ceffae967",377159:"8f92e48c2bdab7b5",377323:"104c9415b24e4d31",377459:"c606b62bdb9c7aa8",377504:"be2c4b8215b7aabc",377610:"ad63e01f9b329f5b",377707:"a90530e96fd84e60",378066:"d5b46db3f1ab3a4d",378092:"c07efa8d2b52f2a9",378117:"aa2ff1972e75a26b",378377:"f2507b254b88eac9",378872:"5035aaa929a36e03",378958:"6bcf2946016131f4",379033:"9ee642ecfc27df11",379084:"aa25a1000bcafa99",379265:"e6a18afd4a775265",379413:"87589167c124b2dc",379531:"f70a17003c480169",379688:"a5a5a68bce9854ac",379786:"c9648c9a92aeebdf",379883:"a84ee3387fe64e23",380024:"4c889a1f2446bf1e",380052:"399f89cdc8972d66",380217:"748500dec091ad41",380400:"0dcb2a21cb0b18c3",380571:"d41b7702df6750e5",380673:"26516dfaeacd76fb",380690:"dfc432ae415adc06",380702:"ff177449cd409a26",380975:"e9990ac2647a1857",381170:"19e10310bfbc3e56",381274:"e6886b8878c6daf5",381293:"26fe9a05c14342e8",381319:"34351ecbb884c2d8",381364:"66a0f1d4ecb2ce38",381631:"4f6da5fe94d136fa",381637:"f9e50af56120b4db",381852:"835ac7fc723aee34",381916:"b28edb816f8396ef",382178:"1955d559247c5b25",382272:"1ecd67984e787aa0",382317:"be01b9b40aaefeda",382415:"8769c6989a51e56c",382506:"8882c5751d8978e7",382732:"d2222e9a7cf3cbe7",382874:"284eb63894ea2dcb",382958:"dd1cc82db6b207ea",382977:"455f83a225b36381",382998:"257dadd0051e772c",383028:"7763df50d072aa8e",383371:"d1142c3bd26a7d03",383464:"df806cb47e5241a0",383505:"2bc116e6f9f7b310",383533:"d6789743c6c33967",383606:"e46ff1427ce9ad82",383738:"5b174e11f4aa822a",383995:"521e25c0d132f9ae",384008:"33fe7245cdf6fea7",384056:"a694b0dfe4a8ca3c",384100:"780090d60cac9e1a",384105:"df4ac2f5ed49fe3f",384215:"ea69288a0888b5ae",384548:"2efe710e2feb7205",384896:"56344cb27cbbc5d4",384910:"c485685e25d9b519",384977:"d66821ed3e1f5bd8",385090:"52af0e9df98c4cad",385177:"aaefe723cc32f02e",385190:"13356515c6a1ddc2",385249:"9dc64c24e9af1374",385312:"100a60ddecabab04",385446:"486760924cc80576",385591:"f880176274b1a976",385659:"60642e75bd85526a",385686:"a62037e62c779f3a",386296:"022603b4e60999b0",386491:"c5a4473ab263f6e8",386657:"e386e1d7c79c1c6f",386669:"f5852784c3eddb85",386886:"0202ba43bbb96d1c",387503:"741dbea1e3a4edba",387621:"b4979cf98f228615",387728:"0351eacfcb14bf0b",387758:"6272786d27ebb17b",387918:"2e75ae46c60c5e6f",388009:"77e3b5961ff793ba",388172:"06d2c1bd0b2643ac",388339:"b51f9d2f41cb9f6d",388412:"8935a3c45c19d51c",388561:"ca55dfceacf99011",388628:"6ba3d1a5cfd188d0",388634:"2845a91d7224c366",388951:"402cd861196a4186",388962:"f6c222a717363e47",389026:"94af6f687802bf7b",389097:"6598c09579305de8",389301:"51df9cec196df40a",389402:"b1e579b082550ff4",389465:"e01a6c13d4eab122",389571:"c9ba30878dc4a6cc",389708:"3d4fbed8373930dd",389905:"66119049f84d681f",390096:"c842ba3feabf8f2d",390291:"443451b845e90d7b",390354:"e23d6f1b5d0f2783",390387:"92723fd321ec256a",390590:"9825a3f5c6075fdf",390627:"79689561950bb6b4",390684:"cdaea5f99f384dc6",390750:"019b664a1989c3e9",390758:"7e19cd5353f2a242",390904:"22ebdc8f9d10f09a",391025:"87ebcee9293ae351",391063:"5e3696b7f9313bd9",391386:"856d3363ceab4e01",391559:"a5e51e201cb70389",391679:"4ef951ff9eec5b3b",391809:"ce507614bba8c33b",391838:"b58c0cf88bdff5d7",391863:"da8ea4b7228251db",391929:"515b8fea65ccd2b7",391945:"bbd6439e0d053d33",392313:"434595417a919c92",392449:"476f0fb536a3ed09",392572:"1d0a98340e1cd387",392865:"5002c42c43282809",392937:"34ed2100d58d601d",393015:"c0510caa61b083f5",393061:"0220924b817edafe",393253:"e7e2510e4a8d84ee",393258:"dff88ccf8365f6f1",393339:"c5a91a37887dee01",393735:"14d0d667c6db2188",393940:"0038bbb006225c92",394089:"097f9d441e64d3ac",394125:"14b13ff6a41cd7ee",394185:"4e7012333d7bccd1",394222:"71ffaa6e9dad9557",394301:"ae82d0a5681b648f",394341:"f2ec50856a3d8130",394358:"28707c4832486954",394387:"1fbc7c49d57db789",394425:"c7cc55d944aa3c4c",394483:"33d53e7b78519104",394548:"bd956c7548b140d4",394601:"e38e09447a7371bb",394622:"1d02fb88f2c5a251",394761:"348f0daa072137c6",394925:"ff1bdf17cf598ea3",395059:"cc7d24b1c522b4fb",395300:"fed706d59386145c",395303:"fa3da1775dc893d1",395433:"3f1cf8905f2f8777",395569:"a0768e5d923c55be",395681:"bf2391e4f4f2074e",395709:"b7cb9540c6ea4914",395826:"4ce37b9b552f59ef",395834:"97a3fddf1b3cd038",396008:"3b77d555e5a6e1de",396092:"b803953f72ee2ff1",396209:"d05d1305973a3086",396705:"9d89b173d159fa45",396710:"7b445e31a4770505",396917:"eaf9706412943c02",397230:"83997f58b641c679",397238:"808e2b980a37b28c",397241:"6ccb99b1fe5a4c5d",397265:"fac0f775cd95cad3",397323:"0a98b3d5fe83fcb4",397423:"16ff1c99a3c70cf3",397523:"2a8e0af72ada3ea0",397536:"63d253eb0cbe88c0",397679:"4c5be654a96f8440",397922:"e3142c6bc884961f",398048:"2fbb63b20c08b42c",398177:"e40de4dd2bf22cc4",398326:"f37997e710492ae3",398391:"8385085e7a41af21",398409:"4e81598db22586cf",398411:"8bc6a238786b12fd",398667:"6b1738aee9fef696",398845:"e830bfe19fb6e2c1",398911:"05fc8276bf8e3e18",399388:"e02ff9bd276587ed",399808:"fdb53628f383a3b0",399837:"2f11afad1df24283",399954:"6d349737c61a536d",400010:"efc5bf0f5d1fb4a6",400014:"031154156c93d1ee",400060:"72ce41136a932ec4",400081:"96e6e63f5583083c",400101:"51697ee895f865bc",400162:"85fa538389f7b2b7",400200:"0a728871a8489b62",400347:"4666aefebb81da57",400386:"137bc8c1733b0657",400483:"4d8bef4a133a8866",400514:"8ad8291f70166962",400604:"f00029cb42425cbc",400745:"91bcfce1bc68fd2f",400880:"4fb5801aac75c4ef",400912:"f286d0844b9ed349",401011:"faa8cc60f593cffb",401130:"2fb95854fabadeaf",401351:"7484ea0cb07552bd",401421:"0ac702178341235b",401466:"8935822d81ba411e",401742:"5d19417d65126b8b",401848:"89136b79484e5a4d",401926:"ff24996b45f6c48c",402236:"8435e96aa1a39442",402293:"c7b3c32f84c40969",402845:"c09cc7cb500395ea",403018:"393a29b125a1248d",403066:"31a4b903aa4117c0",403201:"0eb12e205d12e293",403222:"18e92d551684eb0b",403331:"d9bda94ec18fac3f",403528:"49ff9f6d1cabfcf3",403818:"2a6a18f311a54c59",404177:"4e802fa5a89ed716",404198:"c51cc970d0a4fac5",404216:"ad4d9d32098e07ba",404256:"f440b66d65fedad5",404342:"845252b20aa3791f",404416:"be5f8ccaf9f10845",404517:"cd823e7b501019a1",404522:"03bc66ae70b53963",404541:"81e138250c04c2d9",404542:"847326a663897c07",404564:"1eb31f15540ae04e",404686:"eed01c581a86f1d8",404800:"c3e1827b79e446c3",404874:"e904509d0001f233",405032:"5647248a877d9c4c",405109:"312e48571052ac80",405151:"e38f5ae5d42f6488",405506:"3d7ac01fb7cf226d",405667:"0dadc70bfcbca628",405851:"6e4ce1f9be05a8c0",405861:"ff52e2e642b5d788",406607:"f4560738d933ea3a",406740:"b4baccfdddf088cb",406746:"377db7f392cce2f4",406788:"ed7ecc5d5547aec8",406868:"d99f66ad4fa48c49",406880:"3a0c9bf77835a2da",407071:"74846726b8fb80f3",407138:"13dbe8f3dd0c2bd5",407139:"80c51cac25c3bd42",407560:"9ff2f0cac9bc1d3a",407598:"0c56f46f27fab42a",407615:"65a0696c8fea44f4",407760:"320da3def88cc9de",407893:"a86ecec70b1765c2",408299:"6c85ba4399322587",408311:"91227fe58c0db5e2",408376:"ffafec59e8425963",408535:"abc023fad48512a0",408600:"8c9c4c4543621249",408631:"7cdf7fddcf6d0bd0",408750:"4833b3c89c952f21",408781:"89bc980de0d3dab5",408819:"0c1518afcec13bdb",408902:"aa3d617427933324",409094:"92fb4e3959258465",409199:"86a0fcd66c63d193",409312:"02360dbede48378e",409393:"0da2b8e2b388b61a",409586:"fda4f9e504d7ddca",409863:"14ef7864950f3bc8",409866:"acba23edec8e900a",409884:"92f33c5eff3e4f77",410067:"3d647be6d60b2d59",410229:"93962fd9be26b1d4",410349:"e2335dbde35fa8d5",410425:"3b528d138851a156",410528:"389a38f5a145613f",410752:"68e27768a71ad511",410812:"30cf786b7fcd7a22",410926:"e6e212a23bde1d9c",411048:"543769f74a470027",411158:"f49e5674a405b1ba",411185:"44162b8024ac9556",411338:"91f353db0bf35d16",411341:"b3b3a733255d5811",411584:"44c4e8134b7f3e35",411742:"5ccec9190e1f86f8",411743:"bdee9b8c79106a8f",411828:"af9cfe26cafe4823",412136:"99743bb5484f73b2",412194:"1c9d25efc1bf07b6",412281:"bfef96c117d90964",412560:"5fa911d111d6a432",412590:"9d2db9ecd231b6ee",412850:"ac9d35642897d7d6",412851:"863db2af16a6a44f",413015:"eaf46591db8afb0b",413058:"cc5fcaef7803f0dd",413110:"558e37120a286455",413308:"6add7127886dac12",413446:"8a73d8cc54a6acc3",413508:"d2a0b865664225dd",413592:"b8dea84e2c712746",413602:"33f5008e303274f2",413690:"0da2f1b811dc6ace",414026:"1878883d3bd865b4",414071:"40298a26329eed21",414118:"7077f23c1a76f546",414251:"82c68128efb5a72f",414422:"fd086887aef9a3eb",414658:"ce7cd635bc5801c2",414692:"26988412c9dcb612",414736:"c915c34b67098a7a",414766:"0ff6da122a300a1e",414790:"67202c72e810a789",415279:"74c76c229d96c84c",415289:"029631381781fd0e",415331:"69704622d49f2e25",415340:"88bb39633f38fcec",415498:"22df931bae1bc934",415582:"9ed57ae35a160018",415768:"72246c624f8afde5",415785:"37e33dc8f17743b1",415806:"6928eda6d24ad985",415953:"40b8ba305512da30",416023:"a190665c0abf3b0b",416117:"539f0b54421c0dc3",416189:"64741d340c6fca4a",416347:"0ea4e5e2130a5e2b",416369:"7d1196decf2164ad",416523:"bdfe4666a0dc3d6b",416696:"42fd83c5c2c05bfd",416829:"350220939e2e0484",417016:"972cd5b82b940ed0",417062:"4684a2b0e2afe116",417066:"7614d64dd35677a8",417220:"5579d801f04e0c22",417266:"e9d1e7d68981b64d",417298:"28702b02533acfe1",417332:"0a8b1c6c68ad2b7c",417341:"3c035535477a4d32",417361:"f01289608af247f4",417471:"85fd3ec56e1bfa48",417671:"f2ca7426572a4e79",417678:"6bbef2d46b2717fc",417747:"dd2d5f2e92d4283f",417787:"0ae9a18b0bfe483a",417902:"061fe2e4e6050c4e",417957:"4c056f858e380203",417982:"5628cc7e67551fb1",418012:"c8bc372e86d5054b",418035:"fb1999c14b9b22b4",418219:"cc9d5bc1594b062f",418252:"663dcb20a33568a2",418433:"83f2ff904247ba12",418505:"0cbee91eea96acb2",418642:"6a1819bfcab520b9",418699:"0bc0cd83c991425e",418888:"74d6fa4f11745111",419161:"5867beee02a6ee51",419318:"2f68e962567d7ce9",419525:"9b271a8da68ffda6",419632:"186e16f461736c81",419926:"4660428bd803d3c7",419939:"1d4ac2b60170e767",420144:"a4826a5aac5d82b0",420169:"338dea02f671fe7e",420199:"0e5b9bb20abd78cf",420494:"c74c2963956fe738",420609:"331c48cd2b82b60d",420786:"aee7f8be6ea96166",421014:"09e4c9c2565b4e6f",421056:"14244171b9beb625",421174:"69f71eabcd129b27",422012:"f2db6ef6492ecaac",422297:"f94f844ab04dfd35",422371:"20956d41bbbe5462",422452:"ca3130dbf2d472d9",422474:"3b45e9113002aea1",422616:"adef885543254865",422705:"820608d485ee20bf",422726:"e962ec39a4154653",422765:"1ceea7e98ea70d1e",423017:"8c3b8378a802bcc9",423136:"bafe0a41c9494664",423385:"04a7178f47ff5ff5",423603:"da70caf22e01fe15",423752:"21448d62a4737d94",423864:"5aa8a439fa4eb10b",423927:"92e3821cbc7285b3",423968:"4a298daa5e5ae8a7",424096:"dff1fc9927550452",424188:"1b926fa3de02840c",424252:"7a45f94650564224",424333:"aa3105a7615932a3",424685:"c6177954caed39ea",424831:"733e3ffd6c084970",424855:"1cc91ae4e4eafa55",424998:"a066d1e82369ffba",425102:"e29d87b1ed0e68f4",425270:"f4e49f7e8ae012a7",425813:"375074f4e12c3ee7",425874:"0b04317ed7dbbc52",425901:"ff3a8b8dd9d41df5",426054:"1556e047dee47648",426132:"0cf1d286975a1817",426302:"60796d87ec65bca3",426443:"d70ca7b28fd0d76c",426476:"7b6520c82bd37977",426705:"6829b8e0d55b9562",426712:"c4e58cbff0c839e7",426726:"6097c0df611ccefc",427038:"b1aaf75f461fd897",427078:"72ee2930d8aed5be",427161:"2d4a75b7aa17a4e6",427201:"d881c8057005e79e",427301:"cdb705862c330680",427573:"759d7363c70d2ea2",427788:"fdf87cf98dc8178a",427923:"2aaeb7869aed6f09",428126:"0898a24367f5e977",428167:"c3f56b35cae2232b",428394:"8aeb0fe69010b931",428421:"d0072417f6506d6d",428497:"0af9d636e50708b5",428508:"b185ccb786c3a715",428631:"6398538b9d721749",428763:"511a9766c43e6f69",428767:"e60aff5de7c4c302",428933:"36aded8c3b9a2c23",429326:"d19eea1202ecb96c",429331:"0365cd5a83915131",429391:"049d7d6f59e18408",429502:"9ba41dd8dafd3504",429636:"e7dc1775c2fd310f",429655:"1c6064456c3f1041",429698:"46879ed3d548cdf1",429864:"1966f36ec4368fa2",430174:"c17856a51bfe6a32",430520:"5961587fb3a4c023",430624:"f7e933eccd9b2fbf",430745:"19aa88aba5f9d0fc",430892:"9079e9879777606d",430915:"637c12c004d616f1",431044:"7a6b38dfc80463a9",431589:"87056db1a43ac503",431651:"87c6bd3171474eef",432250:"c126e7f193d2c8f1",432285:"869b4df0d15afe67",432412:"57435ecb184c0edf",432670:"44952eca83d36ced",432794:"d9932b4005faaf16",433013:"d4428cffbb2042b1",433040:"6361c7f98ac543cc",433071:"125429947d9d759b",433166:"7e4c8513a0aacd84",433242:"c163b1f9eea59759",433282:"450a54756b23dbcb",433329:"fc80796c6dbf3890",433384:"d02edc7b952493f9",433401:"c9a41da376e3fef2",433555:"7bce857286e74f8b",434e3:"ad188ac2cad87327",434022:"5de9805a05de55bb",434029:"d303340c3b26687a",434518:"e787640a466619b9",434791:"adabbc954737669b",434817:"0cfeda94cc126e2b",434871:"4e1d3ba97c924010",434946:"e74a9d1aa5c3c1a3",435062:"499c06a1a7e607fe",435129:"e53b745f89cb880a",435175:"efcb2916c08bacd2",435182:"046ce0a3576a399d",435364:"d84dd8c0304312b4",435573:"7041f01195da1aeb",435611:"161d928d58b2a569",435812:"7ed47e325cf9b6a6",435859:"a4f5ac3e01b07021",436009:"38e97236ccdfd512",436058:"1b1e3c681018e171",436143:"48eca8f714ab720d",436148:"7ca347a8195b5e01",436314:"e44daa0437d16ee5",436323:"9765af8ef24c5a6a",436512:"6d1f33220c62e496",436519:"d570d5617863e436",437061:"fb3b0a8ab69a8439",437209:"78a8efe7ee9032c4",437425:"dba952ab923e16ba",437458:"4b0fe0e67c162f27",437490:"f436a0e05627a18a",437570:"7a0d1da0f19fe7f5",437686:"13d9507cb1310e2f",437804:"a6053cadca983bab",437808:"7e9d95ff9aed446f",437829:"0590273351af3e32",437859:"5b55406f8384664b",437974:"d4de3c0f21f1a0bb",438011:"f3246ee87532d4e2",438427:"991ca7e5e3defb82",438529:"745c3cf9ae97e38e",438860:"2e75991e873f8d15",439095:"6be1cb8220a4db75",439151:"be81f979f1b8cc1f",439201:"c2e1e4b00382c334",439573:"99876982a3d2112a",439613:"cc79f490393c6d47",439665:"a6dea834c1d562ee",439691:"5e4cfb7877040ca0",439912:"2e7f171abe2da0d9",439949:"833252a4d2876745",439961:"b68ac3d48a53b6e9",440170:"7add995fc634dc82",440226:"6315ac0937de0449",440281:"04cde8979c9a25b3",440348:"f6a9acef4039d0c8",440391:"cda03d10ad833673",440487:"e35d7e4af7c9ecb8",440591:"5c7954214a3ac4d0",440634:"9bd5727745dc7dbb",440840:"c69752c29fbc74cb",440857:"8b1c368d1313c83f",441252:"424824676acf0e2c",441404:"b8995cc860252973",441788:"67900f1be086ec1f",441920:"d40b4684ba1d41ae",441931:"18bfe3c0aeb1db40",442122:"865b7c1a580a6435",442284:"7753b50af08ed73d",442482:"2826204de5db0225",442501:"95a875809554f21f",442604:"148d2c5ddde25f8b",442651:"54de64645fd863f3",442972:"6125f27e2526a108",443058:"31291bc2ed8db6af",443091:"054e13dec4729609",443208:"c10b56218439ad20",443608:"dbf2d9ab0e4f722a",443981:"37e1b4b798fc1ce5",444199:"801340c6918f767c",444808:"bab4c4d35d1b92d9",444908:"ba6bc115734b4ad4",444963:"2dd7c1b33dddf120",444968:"9550ad0d18b24fbe",444977:"dea5da877865b32f",445170:"06131c9d82ab7ad2",445434:"2e95f327651d92f4",445620:"36e98136153cdcc6",445624:"1c49ae3904275bc2",445698:"902fed6d15e1fefb",446210:"63a49552ee21203b",446246:"60d67acae27d4cc6",446276:"51b774e8c206c6bb",446525:"00e668870e66967f",446538:"67d48aa34b721e37",446684:"0bb6145f4064fe4a",446848:"15bc52c23eb96b0a",446885:"051bff0d664ba47a",446977:"d92cdf9cd85c4417",446990:"0d4f5de9eb7e2226",447085:"938d92266fa644fb",447244:"146cd5abc0df2c48",447818:"162ae7aff9f5141c",447863:"1c9a66ce8e84954d",447958:"65a5210f06825933",448025:"dee8c3f138c5d54c",448073:"cba3f92bcc71e17b",448111:"2d72d61d699e33a7",448436:"5d98327ef28fcdea",448557:"4bb52c81f878e0f3",448601:"8bd84f31a7685dd9",448863:"9f59683fd2392bd1",448981:"a6d2b1a6f98c0faf",449062:"d6c655f278f2124b",449355:"71b201db7ee06da0",449401:"31ee38cfc3950d4c",449610:"9ec258c3df159371",449680:"139691fdd22c733c",449898:"48a39d62186689a8",449902:"b16dbe3cce763036",450050:"eca9518c240e1206",450067:"aefabad36bdff8f2",450084:"fb0a5678acc13aa5",450157:"f8bedb1b7dafecbc",450366:"d73400b7082adf20",450612:"77034040fe676737",450673:"6922834dbe8d9fd6",450912:"9d1872135df81368",450960:"4fe389e338352867",450987:"f676a0ac1ae97f82",451060:"11fc88de4b94254d",451254:"0c8e5e21ef95fa49",451477:"a964c7da97907ebc",451540:"ebcc8f957718239d",451796:"df0674a029aa209d",451815:"2d178785eead9a46",451825:"f2b85db69093740f",451958:"b2dda6f89ef2fea7",452230:"76989c90a3660618",452574:"e60ba9a6512a88fe",452579:"7845c52c853c26b5",452713:"ade4ed3c6d72e3a2",453547:"7eed22b7f27656b3",453806:"5a46d553f27e8f4e",454145:"568f15819e2f7ce5",454161:"c5e670c43e385645",454165:"44d35094a186b3d8",454172:"254dd876135d92a9",454242:"0b2cbfc8047149ac",454275:"02ab09021c330908",454281:"2e26c35dd5fa6398",454356:"9675af2fbea1f007",454485:"e9b66e9350cd8769",454658:"6e93aa76d49f04d1",454687:"2735f208f49ed4b5",454726:"f1ddbda9cbbf9d57",454730:"b509ae540d666446",454758:"f6ae65ef643c4ed4",454835:"cec03e12d8486828",455080:"bba6ea850dbf18f9",455097:"ee28812ae5404c73",455143:"af98736eef572bcf",455339:"720ce321cb6034a1",455513:"e7beae61360ebb8d",455520:"75f92ba17d84a90c",455555:"dcb183fefff2dd3b",455627:"631f1075df53fb8c",455810:"38cf537056dca30e",456038:"1ebee4f27b8a84f9",456109:"d5e8b34bd27d114f",456205:"3975bcd8e775838f",456403:"677a5574dd92270d",456751:"0ed8030f3d7f8ff9",456809:"41f3ace7a66648a6",456832:"79384970384b6fb9",456904:"1caa16e559f60fae",456970:"4ffc3563072ee1a8",457155:"8c98dda4d72e479c",457375:"5171a1abfa3eaeb7",457490:"7b9de11bc0137d34",457512:"6dcf5f627fc988da",457725:"7390a6e51e0ce41f",457744:"598064dc8b6d6538",457748:"bbfb705fc539853e",457964:"5c3436ba0008f5ca",458001:"ee60b14cc3a1b4ac",458075:"5f76008b7a597410",458179:"a87f4ab3ec55171e",458232:"e21e03179e6efc4a",458306:"6cf21fbbbfefc303",458637:"19402ea92fc65df0",458771:"e2a4ba95310f2b59",458820:"c29449c7656319df",458966:"6ec955ad852ad434",459169:"69268832601195e9",459174:"0a623d8507d46e07",459357:"a06dc49007f4a176",459461:"8bdb942c53e13335",459476:"86e3ab9505bcf455",459683:"53efc7b1d5da781d",459687:"ec5e91f2a4b56bf3",460039:"ddd278a7f43cd6a8",460041:"f64ccb3715d8241a",460301:"15453ba94d870fa7",460649:"c0919ed26103dccf",460820:"dd059c3962b3e61d",460893:"1f5e334424ac8447",460927:"0728ea6ce52991e6",461005:"f68129153e8c368b",461045:"4622a0afb7bcd2b7",461118:"d52af8137a45b3c7",461203:"96b488040a100068",461234:"912405b0a0ac1ff2",461251:"9c786d800707ba99",461409:"63f3461efb1d78ad",461627:"876559f040c9e857",461956:"dc1fd39b127d8457",462109:"174c3f81ea3ea7c1",462115:"57ba4534ec5a909f",462170:"6225fbe035f67646",462223:"d241364b6a9a058f",462239:"583475c4df039240",462270:"756c57d45054f3d7",462315:"ac87839cb771d02a",462365:"a754133ef3de9d32",462432:"d47c749483225628",462438:"5883d990651d2731",462478:"51eca3f301148795",462591:"85ec8eae26d551e4",462623:"6b2ff45d27fa2333",462773:"33d0c8c35aa88167",462843:"6937f7fb8ee859e8",462939:"4b44ea935e91a050",463153:"339b562979213603",463268:"13e884b4df94eafa",463402:"dfa2de54b805ffe5",463473:"b8385508c1c1d3d7",463648:"40565e9f80a58c7d",463770:"b98c23f43a7c13df",463848:"700d8e9748f70eec",463944:"7bdd0058cc3fb85c",464189:"7b670f16295b36f0",464236:"d76c0eee8b90c098",464241:"70f5e5a813fb45b5",464759:"0520695743581d31",464824:"9f2926f0230cabec",465017:"5c5573bddd06c4ae",465041:"238ebcc515990b32",465181:"d7e94a1f7a57a38c",465385:"4d25c66169847a1b",465423:"c7440e881fc60dff",465486:"b3b50c260c5390e0",465665:"93e079e3375335e7",465677:"1b1f0b4323d6312a",465681:"9fa72ba05f1e0e88",465904:"23d51581d79e1c0a",466204:"6452022ba7e3a40d",466476:"eaa1aa7727f8a7dc",466585:"e57cbafa495083c0",466622:"85ed5cf4ccbc517c",466786:"ad2a6b6dd6f22244",466886:"ae16a801cb45de5d",466938:"934c3a6da5a4ad5f",466973:"185bb81b84f03c97",466976:"e4e9546c0330c8f2",466987:"37dc0f891b7b0834",467138:"82a9991de28e1981",467162:"7b8602f27ba86205",467173:"41175cd582bc7faa",467254:"a641a830157c148c",467657:"a59f3801e5139a56",467764:"c2f3601c488aa548",467767:"8f2989ac9f645da4",467775:"04e769b2a2a33b06",467785:"49e4526a59ddab70",467957:"55925d1fc9d0955b",468196:"9f61d68a76806470",468318:"bbaf738eefc50b72",468341:"2021e5c50fe54a41",468479:"3cc207aedba56b78",468504:"f5e9203438f5af09",468660:"7c4501fc97e1ce14",468661:"942b7cc3d633f0fb",468677:"663295323e5e3068",468701:"2a9899b77a4fba1a",468771:"c1d82122136dcaf0",468792:"60390817d301d487",468840:"f995b5127be45dc7",468846:"9073ffe44ea7bc28",468880:"3dd5088c3865750f",468994:"c735c423548af556",469063:"96def8be4f1693c8",469081:"faf56ecfc1fe4b29",469374:"a9775895133efa54",469375:"b9dee88075ca1ada",469387:"c0ca53bcb8a3af49",469445:"12855d2533ea5c1b",469518:"d079a1b8f85a6826",469728:"e4f30ebfb13bbbb7",469742:"361b2f855b5d0a98",469792:"6323ae1d388d8cef",469929:"cbadd34a41cfc25a",469997:"32ce83bd2045fe72",470083:"745c6342dc3b8863",470141:"8c54de62ec7b4d1f",470178:"27300892a99d6c62",470225:"48e4c5b5f748e66d",470359:"af38e683e0887cc7",470472:"41b6ade952916376",470507:"d8c0c420e8e26c6b",470530:"ab7f20ca1901ef7b",471042:"0f96947ba07a5996",471055:"3689d32130e74b77",471096:"77aa63606f61bae8",471136:"3141b1f6617df36d",471167:"11df07178fbf6aaa",471213:"86354bdd6991b231",471342:"f7c9b618276db7b0",471344:"1422e3a27765e134",471680:"ee99792dc45faa8b",471726:"f41146fdaa7a920d",471782:"b0b6f064a0e1935a",471790:"5ac45646dc97e41b",471926:"ed7347aed6beaf52",472202:"468702ff193a0ba5",472209:"4507fa6e6c54a067",472415:"b1eb4c0ac7461420",472589:"410251c991e03b75",472674:"4ab67adca9f2b243",472788:"9e4165048c6302ec",472804:"07fd480c8505845a",472905:"52a52a0ace56d641",473165:"b3ef7eed81a8d4fa",473262:"859826fe33c05cf9",473442:"0990af944adb350c",473449:"daa3fc9eef04465e",473572:"a5ee88ddf2f8b8cb",473676:"d7b0e7d0ae52cf3b",473863:"be9b3362d6fee635",474189:"9bd6f5f5b766c50c",474248:"6e24a6b79e728b58",474404:"436958e4bc7ecc57",474786:"f65d31677430bd17",474833:"38e2ea57fb9b388a",475060:"64f4cfd44f6589bf",475063:"2ca420a54cb865a2",475450:"a519e918db762d3a",475487:"ec4eada0f6f426e1",475758:"cdec5066462c73e2",475837:"9a2f064bd39bea2a",475906:"ea3d365dc51e2b0b",475962:"d41dfc3a68873bb4",476023:"df139f02d7262f91",476158:"d95c8670ed97bb45",476476:"ff3db1f203b2c091",476524:"bb3813a0489ab747",476553:"a95a4230eee59df1",476843:"fb107116bc73c9ed",476896:"3817cc3ecfe59808",477078:"9d8a43db04216186",477209:"2d6e15844ff76151",477285:"cbd83bc193426737",477307:"748c28cd4a75bfea",477356:"8ee68309b4052cc8",477358:"57082b5f5e6393f7",477482:"dee07654898d42cc",477536:"31f58b2b6ef206b4",477547:"03f7c30a6ef16250",477697:"1563535ca4039ee0",477877:"f1c9a63c60e3aaf1",477970:"0db3da55d985e067",478001:"1457aade56d8f8c2",478053:"35cd75931a357bd5",478087:"69a871e02ef6dc4b",478744:"a9a2d53a6c9b5f17",478826:"c0e09040f894292c",478930:"2a5107c09cfad968",478942:"450f91230191fa75",479017:"42e36886541564cf",479071:"0a1f95f2a801d150",479078:"a79ba0ac88cf553a",479108:"275f6318f4d41383",479132:"31fc1781993019b7",479377:"f1d63aaa9ea33a6c",479474:"3cee673a24689d37",479539:"e75e6ab19c7bdc2d",479807:"e1f1e9fd8c86cf5b",480017:"b5809816b8ae0aa4",480041:"7249d70c54a685ab",480090:"690df07cdc7152bd",480094:"b5e3c3dac40a83fa",480103:"39ad9dbc127fcfc2",480220:"e8b5009e74dd024b",480809:"fcbe259cc28109af",480810:"e322b578cc50a670",480919:"2c7ef5889608bfe4",480976:"3872d34d66919f7a",481135:"048bad8e9d4cb8c6",481162:"977195d39c2489ee",481218:"8fef6b50263b6999",481571:"3bf099fe552610fe",481580:"f481cb2fcbd1a8a8",481608:"5ce0ff1c6de89b65",481618:"c9f62740ffc8ea04",481647:"b9e90dc67a187f90",481683:"a334e2897b6de2fa",481694:"32f433cf52cae9fe",481786:"8f9fa8eecf1d2b8b",481967:"900a7c9f46da9223",481968:"91bc9f19b791abcc",482158:"c1a41790a11e54a9",482161:"fe7ac28603ebf1b1",482544:"eb9bd446d80fc512",482682:"68e431bff3b88945",482887:"4cf286582251b813",482991:"3c420cc1f38e2a98",483650:"dbc76c5b3ae18433",484066:"ef4cac0ec4e99e7a",484188:"084630f411926a1c",484322:"5d6c3911bf550196",484396:"182caa466dc4df40",484520:"e5fbb1f354358a65",484639:"f4771e053a12f156",484671:"baf32401e2032369",484734:"f17141dbf8a23900",484754:"ee5e60f2bcd42b40",485140:"cbca87a37d33f131",485197:"16b4d8d23a1bf8a9",485211:"6f62d3848be0174c",485268:"1cdc9c3931590637",485292:"e1ca07c4e1588b25",485391:"09fc449bcf23bd1f",485491:"b171e26f94246a67",485504:"db3d7ae1f10c55a3",485984:"25c8f315e8cad07c",486006:"651d255d82c46b9b",486238:"9d26d2d96926829b",486340:"660fc7b39098fc1d",486418:"ac11373913438d10",486600:"d9b981aac37ef56e",486723:"aa06829bdd321cf5",486855:"ad5a3fb55bee4e50",486974:"d3035c6d2a2e918b",487151:"d33184124290a2d0",487899:"cc4d3a646c60e554",487914:"79258430dfa05fbd",487948:"bec30b62d9fd718e",488303:"eab7a7fc6561a8d2",488338:"934c7caee5eaf4ad",488461:"9e97fe7c100d5738",488571:"ef56d303f3010ed8",488729:"9b7b71d0fbf1fcbe",488806:"6677cb95c100335b",488821:"5667371eef707dec",488996:"e547d67584bca7cd",489003:"97b09164c9a3aeaa",489147:"bb003f5a57ec9d00",489194:"5469747768c59376",489425:"f83a292da94ff7ce",489568:"5cb7be97f145f53c",489589:"cc8f2e34ca99ec8d",489682:"313386cbcdefc70d",489721:"eae3a39dddcbf474",489931:"a40ac4fc580fe435",490017:"2cd0e64693c26c8a",490245:"d00b3bf0fa5bbf6f",490281:"c4a2aff0c2005c69",490530:"3b07ed014968c37b",491029:"4674501ed235d73b",491036:"8b4fbd90b2602e9f",491411:"6351635245a0f965",491500:"26b5551e82a96da3",491563:"cea70f17b5a0c79c",491647:"261a2325299e0f70",491773:"a4af1f38e5ebc3cb",492077:"1e4d5c84ea690357",492230:"0b71d4686f8ae444",492278:"08b85b96caffe5da",492567:"30236ff7d9be26dd",492685:"008987f0d06051dd",492699:"cb17da9c48abc270",492721:"7d89d95c33a6f5bb",492894:"00bdde1abf1e738f",492922:"8764dd9018d690e9",492956:"8929a9a28e991507",493352:"91f6033070d267db",493429:"7c5e88f943438d88",493486:"2fe6b18d33eb36ef",493799:"f844410b41c543a2",493866:"83cef2504330f4b5",493902:"215790cac1be07aa",494060:"94800e79dc90fcc7",494061:"1e3aa88723fef444",494074:"2e9d677b06a9272f",494135:"c693620bbfebe6fd",494217:"e7be5acd73a7789a",494286:"776a66ec72aadb81",494385:"773b3698a19468f0",494409:"0bf2ad1606e69aec",494431:"c22a38bdbc2f5041",494810:"4c72e4659d349b51",495045:"07b4a0c767105f57",495049:"7d18c86d153cbd62",495120:"b29d184f37a73b1a",495195:"65179352ac24877b",495249:"af1e78c4b178b555",495284:"e865f33198b37b3c",495468:"0b8c8abf69325c5a",495937:"9cd8290ca0e53b50",496106:"8e956d442a2328f0",496488:"54ea27ed8eeb0151",496656:"928cf4f2fd399c01",496741:"853d6c7e9abf046b",496751:"b95fb06e9dfa2484",496769:"2f59eaeafcdc22ed",496872:"e6d7522b8053ee87",496900:"76ef9f4227660685",496925:"26035820baa51f8d",497407:"ba0a9269df3e6cbf",497439:"d9ab671129b78c51",497475:"84a4e646ab05328c",497626:"3ec23b503d152438",497800:"0f0cb62d8a8451ef",497907:"625265ec77ac67f5",497979:"d2a7006004017484",498023:"ec5a12109f445ab8",498034:"0b7e051532d5fd9b",498086:"607809e428ffa9be",498278:"935387f07bcf8f97",498287:"f5bb4c90af8fb434",498416:"e47ee97f6fcb7ff2",498539:"c55ff9383a4cebe5",498580:"b86669451b940307",498810:"fd07e6153cc2f7a4",498846:"05e76eadbf30fed8",498871:"801a20bef80455c9",499230:"d365711149f9b4c8",499240:"aa561ea4bba58c1d",499433:"267edff8591bb0c6",499522:"c8d172e2ebcc44a0",499534:"61e82824b84e2fe4",499607:"bb9ab5229db301d9",499614:"783a8cb891eac809",499615:"70a51161e8f5d811",500365:"701361a4ef12d924",500439:"e742893c9160206d",500474:"9964d2f58938603e",500923:"67cabfbc78f9c692",500979:"8330f3d76e584782",501054:"c52e5de09ab0ed49",501129:"ad9565aeca0ee47d",501131:"d9a0ed027742197c",501375:"222a6027f357aff6",501384:"bbf5cd70be85f326",501653:"a4aeafdc313ef7c7",502111:"4e8f971492c7fffe",502217:"a7b2e7e48aa5275f",502219:"3a840eb1ae44600c",502317:"c62108d5d8d60754",502319:"f5132d133040977e",503013:"e9d99879796d54c2",503420:"7e6bcdf7382eaf0c",503485:"830ea689238eba29",503743:"f9795ea4654575d4",503908:"9c77ad961d708e6f",503951:"cb2ac687c9a87c1e",504166:"048d8a4093494531",504210:"12894f060d60cd4d",504295:"c728c3d689037fa4",504454:"4bc67fd34250fa4e",504631:"00cb590881062be5",504703:"52363259e13bf10d",504752:"a3b74944ee3be59a",505064:"a6108cd49b5ed45d",505556:"3a3a602254154469",505751:"f94b8deab6025030",505794:"901bfd0f8d451583",505952:"4015503e48b4a0df",506020:"b4ecb33f60d06a26",506093:"8b98c3f992160be4",506312:"d389c1f7aeb30fe8",506606:"bce934677db5ba7f",506681:"b060f76e17ab673c",506693:"4e3eb96de184ed09",506865:"7b7e138c4bbc2bcf",506878:"0b5967d504ed3374",506886:"411c65fe1a9b78a7",506901:"458c2d06cb6e23c6",506942:"85c7b0e13385a3d5",506971:"79a224539e199644",507296:"d903ab5a9aea0bcf",507413:"bfc916d395262a25",507448:"7a163847b852cd42",507469:"b84ceb0eb6c4b205",507562:"04a061ca952a6591",507563:"13625d99039c4409",507830:"6d82c246bfd13c8d",508025:"a11872320dfbb5b4",508209:"b166a62f50deeed8",508230:"1ba70e69d42cd1f7",508390:"73cb99f0892d82ce",508751:"f8495dabd48ba533",508842:"ee2e195fc9762a46",508850:"fc5750fd599d80e0",509098:"c1d35c51374f888f",509113:"914719ff03ec451f",509141:"61f9b6ac8ed6de06",509149:"43a15443a6ce048f",509228:"bfa7428242bd3503",509352:"a8de51bbe4decdf7",509366:"fd2854b639153c9c",509834:"2ed7e71d6302121f",509862:"c2cb7d25cd6f2e93",510085:"6faa5b5f5a0dd673",510104:"d8bd7cd516d46c61",510122:"dbfbe30a5cc205d3",510128:"3349928ea0a3893b",510129:"2218089949e06917",510318:"45ac7361cf14c861",510568:"bb50049d7058dd12",510800:"efe189ede1fce2ab",510846:"791c5e6240254b26",510901:"a0b618e85996d98a",510919:"1802f412f8f3b41f",511020:"2530d79e826dc602",511141:"8722c7ddeb6e383d",511154:"9561303790512461",511250:"3cc21ea95acc48ab",511290:"88fe1c4e3bee8ef6",511576:"52d441b8b070861f",511596:"52072b3779ddf93d",511807:"145e9850635ecb3d",511961:"01e92173ff3cfff1",512033:"3108d1dab6055ae6",512097:"5b6d6dd099234401",512159:"056e7cb18ab60a19",512248:"152663cdeefaaef5",512748:"bb113766d281b904",512767:"6ef2b79c602a8f86",513731:"92a2c77fb7d239eb",513802:"795aaf68365d008e",513901:"f901103355693c29",514027:"2626ac177ce6a164",514248:"546a7329e11902b4",514423:"c7d8623df02f6247",514572:"8225c12f9f16ca04",514603:"a0aaa32fd2851db7",514621:"5e37be61afcdc9c5",514631:"ebf04f89ca6b677e",514684:"4cdd93053965d7df",514689:"69de99577f9fca0f",514880:"040aee415decb2bb",515045:"8313e3ad05c595c6",515061:"ff263e8f046c0512",515143:"cc581fdc424ef5bf",515179:"268062329dc9d93a",515406:"3022121780833f2e",515450:"b70fc2b83173c5ea",515537:"da41c57d5576b3de",515636:"b946f7ed302a9984",515711:"ee1eae23fe2135f4",515778:"bdb1d7d87ae49a64",515781:"ae46fa33a37406c0",515885:"48c98e430d8210c4",516095:"148a74d5749fda79",516471:"e81c044934fc91c2",516511:"1d717cde824b60e8",516649:"a91645847b41509c",516942:"a2dcfd607346fc13",517097:"1e5931f123b03475",517107:"38820abcb8edcee0",517193:"f1e568a372e928dd",517418:"c6bf054a085d2ea8",517495:"0c4515dd8ee01425",517583:"4fafd2b5820a8560",517693:"206f2a86afe4fc1e",517759:"df354fe813fc394e",517784:"09fb69386fb894ec",517823:"cce81fbf4abaa3b9",517921:"6e9484704864c333",517965:"5ddd6d39c84bb408",518048:"c8caaf627117e281",518102:"8c1b7612a5bacab8",518254:"4af06319596e229e",518359:"5b2f2f5ab34731b8",518371:"71dbb685b8e7cd03",518402:"059b81ca364773d3",518790:"f7bc7729cbff6de9",518983:"e25dd0f835a8e7f5",519056:"4b0d2cbf7dc50aff",519146:"0ad5e7947c20c304",519199:"db8fb163ba465b41",519301:"f44762f22dcfb20c",519319:"3f328dbcec691bd9",519400:"7088e95de000ef11",519426:"53d91c7a53fc5d78",519531:"58765ef42e751003",519586:"f315409ce704a9d8",519838:"206740b0b298f660",519853:"1d64e64d0abf7277",519937:"d9f85a868af41661",519960:"87ae079be3303449",519989:"605478250699dbd6",519998:"bd871940c2908d19",520068:"35b12e2f69804b72",520320:"cc8b4292d8119d16",520351:"cc08c14806970376",520424:"ade1bee40f9311f2",520455:"8d21cd0247d2ade7",520499:"db679036c488e11d",520505:"b484f645ab45b07c",520663:"2f43081b32b344b1",520665:"4088ae5fd102b0f8",520715:"0c48d2b5c806aa71",520764:"43d6c80ef7ef729f",520873:"c354f36915644fbe",520930:"9bfc3ac54392acda",521112:"1acfc2b9d3e2aa1f",521202:"3de3c3e43eeb6950",521475:"7ce117e98533663c",521529:"9db4119dfe9d483a",521590:"cd0e9f061bde86c0",521646:"3b947ed9713fe6b2",521690:"4c5c51b4a6132b31",521709:"9d3f9253f2bb2030",521943:"7e9f307048021683",521954:"c1c49a8e484def25",522030:"bacfb957819fa4a6",522134:"51fcd5ebb2dd4031",522155:"39507e5b43c28dd9",522191:"756243d9400dc853",522299:"e4fbf45a8e264937",522509:"5aa907b56e47c456",522580:"da1a6e5916ea7e5b",522589:"15feab61db045796",522594:"04e66794adcb4666",522764:"eaeac4b5f7edc5d0",522857:"c76804a1fb4e325c",523051:"c9458a788e4036ec",523384:"0988965fa417831a",523656:"d86ff5b38571fe13",523667:"04d5a38ef6c69170",523747:"f79b09a137b2d70f",523857:"9c9fd64e698eedbe",523871:"3977a9493b3cf3a8",523890:"3c7a9c552ecdb318",524088:"6c415bd4524c9b57",524101:"21ac48abd46293a5",524177:"785ebf851b35aa18",524282:"964bc3a0396453ba",524489:"86fd1d753316d5fc",524506:"cb18370bd88ad532",524937:"131701e92356431f",525094:"4c8818493652c2f9",525145:"55d37222472bfd7f",525152:"c0430367a42c311b",525219:"71a03f27af795c8a",525249:"5af943527bf8134b",525265:"b8130253abfd6aa1",525271:"546e40f8b79bdc89",525509:"af9a6cfdceb2414e",525575:"b1f048c4fd8426e2",525596:"9e1594539b623add",525603:"eb0b0550a2ec3323",525831:"308a2d8ec44ed045",526124:"92c15728222af0d3",526202:"0a48a073a95cc81a",526332:"8db29546228f0542",526657:"ae68e6d0f9652914",526915:"b0ca148ba657d21d",526996:"1a720f2e3e0f43ad",527002:"2d460a77b44a7e61",527105:"65e329e2c63a8d9c",527297:"50e556114390fbef",527317:"76ce97f2c00ce67d",527386:"d5b7be9d20133652",527466:"41f534d475b69d6b",527558:"897a3f1586b9a4ba",527770:"de2c49867863250f",527789:"8453382eded29192",527818:"d40fb8590c47981f",527900:"78abf6771622ac8f",527973:"52508138abd419eb",528081:"9742421db31a2ca8",528126:"8de99113d0bb1fd1",528186:"3a3a21459eca6472",528224:"eb030f5a62dbc2ad",528226:"72ecfcf0b8d0fe61",528229:"c4afac51492519d4",528264:"533752fdad78c545",528342:"699b9cdafef9dfaf",528939:"ec4464991146b479",528944:"7084f21f90dbd536",529092:"f8d2df4dace571fb",529188:"a6c0922978847cc0",529311:"a8fb9e1fd04e5ab8",529516:"a5541d58256d8917",529540:"4b0944f4f645e59c",529709:"ce4bffca62a32926",529713:"fec776d0d1faf24a",529790:"347901481f60ba40",529992:"cc37d9dbf9964d06",529994:"38c0076df9d62785",530035:"914694325b4cae34",530118:"2bdf2f49e1c3e1de",530135:"3a991151ef410b09",530174:"aacfd2764c5fa150",530321:"6a3eb67e23595304",530597:"bb649e1391cb5bd5",530629:"634386c7c8f9c2bd",530677:"c48679e10d139071",530702:"b2ffedf20b53756b",530807:"feb50fc8db96ffd1",530825:"9368aeb7ba24fe9b",531199:"faebae8f721a19a8",531254:"ae45aebf1c9e529f",531418:"a9bb75fa0f63ef33",531422:"4dd7ba164d2fb6c8",531505:"aa2c2f0e8d529c0f",531521:"0f917780ff95c8f6",531527:"e100780515088a11",531714:"88da4a5bb6937eea",531755:"087f0186d1ad582d",531858:"7ec9de28b5c9a4b1",531924:"3b160f9a48266d67",531961:"381e40ac3e085717",532112:"fef796719ea0e864",532268:"773b91f1b233a5a5",532365:"7c6c179ed83ec596",532397:"9f1eca83d2a40db9",532528:"b0e079a167ab1e61",532919:"df91a56cdbe94af0",533203:"e73ebb014c600a2a",533298:"745be6a6debd8dab",533453:"a3e77252b6323521",533508:"938c7cc34e526876",533519:"5c8c1af0f3477e4e",533634:"db50e1c0b776836f",533818:"2118758a6c1654bc",534037:"350fba4d497326fe",534047:"00251badd26a3bc7",534460:"eaebde1b466096f4",534464:"f8742e58456f3e5d",534566:"dfb59c6c89cf32fb",534653:"a366b6d8808efb5b",534677:"c9fe7d31446e872c",534853:"f2feb2cd2bb959cf",534909:"06593cedcdb5add8",535132:"e82ebca4dbf1dff1",535188:"3c78785b4b0cec05",535268:"91baa60e13569734",535334:"5288b5dc61c3a0fd",535352:"13fc0593c94241e1",535737:"a3c6914b58b4d8b7",535771:"b2b6f9a132494b0d",535868:"94671661c3abb7e4",535960:"055bb8b210b3c8c2",536050:"f57758619abad456",536061:"7ede0b381677d028",536133:"cd184579fd082e30",536166:"b5326003c7363388",536217:"64bc4dcb83696381",536251:"68e0575412c3d209",536336:"4bfb6b0ac3f1a53a",536345:"c046471b86b0096e",536427:"ccc0d6312fec8944",536471:"feb34eb758acbc66",536544:"c879c95cae1f83b6",536585:"16581e9b9e05daec",536674:"8da902a044b11ac8",536677:"ca189258b2267be8",536714:"59b3408701bdca23",536743:"923db75ff5d23ebd",537295:"f34857be19f69794",537307:"f9acc8243133c3a4",537436:"da59fb8a7fd27ab6",537481:"2619ec1b8f77ea45",537559:"2e1b215a266a2dec",537596:"ca4ef7a83a1c99c6",537913:"b41f464e325f1069",537956:"49198cacdf3ad6f1",537971:"9efbf7cf329dc618",538094:"2971d60e6cedb283",538431:"b2ce94a3c0ae06d0",538443:"0613e86d16d4ba3b",538576:"9dcaf0f6cbab8250",538718:"abc88872264c039f",538783:"e53b5a9274fe81f2",538850:"56d91dbf60af64b0",538883:"e2c264712294f969",538988:"a2cbd1013fa493e5",539087:"82c0365f17696601",539098:"5fc33ef6f179bd8a",539270:"5da708232e03bc42",539457:"79e7df755448cde6",539706:"cc767fc1a345ae27",539829:"ab3c8a5567f21b96",539854:"2dadd316cfbe236c",539872:"0070673370316516",539908:"fdd27b9db7e90e70",540355:"e16a639eaadfa410",540434:"99bf84bccd02be82",540444:"9460d2a2c598bb00",540694:"f3bf52b207ff0c80",540826:"58c4d9d9a5f176af",540958:"55b58954663fca1e",541071:"497b54247d619d9d",541081:"acf52cc5c861077d",541145:"672d61f875b9fea1",541228:"a05a1f4a4b2f3bf2",541335:"cffefd5163726980",541602:"857c406836e5cb08",541874:"e814e340ae31d24e",541895:"4e8038781e428bce",542061:"7d509fdfeb733700",542167:"8eab519d6b2950a5",542199:"ad1044f3a706a848",542212:"12a6f53f33a42715",542340:"7babfe5f65604e61",542371:"2deed646d01c8af9",542443:"74d531ebd5d76937",543003:"178f4e9f6750b690",543142:"542620b31d0b4590",543191:"9b37043926e5d00b",543200:"c1a5b0953b887732",543347:"23205a9b86608911",543386:"defe83eb8d3756a6",543405:"7c918b6e7f106bd5",543458:"28139177374ac7e1",543611:"0f28ba9bcad45cac",543779:"4782b6581a83938c",543791:"16d31f241a3eddb0",544136:"a0ae48f564deb3b2",544162:"27c98bf24d4f8570",544208:"d349508e1ac9837d",544349:"a6fb9d371a339ff6",544462:"1ea739a29a6f5fc4",544689:"8d10c27a6cff2d03",544703:"428ca07e23ae659c",544750:"eb5d7992cca20207",544947:"9dce394dcae31d3a",544949:"6bc3f2986676ba2a",545046:"c3e98e31302d0c80",545055:"dbc34434e1517791",545130:"dc745df736cc4762",545212:"cc6341a2c82e4633",545233:"7b94efc150054db4",545549:"c823b27db676667e",545931:"2bde1cc06bd38002",546175:"24effa2e5e7f20e6",546310:"81c53a574cf4a66d",546453:"24e60e9b2e51fbcc",546487:"99ab246d9b31c9dc",546639:"30ded0839bd70c1c",546803:"a2750b9379faec3b",546821:"4ab1b60d179a39c7",546823:"5d7731c6250be4de",546921:"8f4d7a42644249d2",546928:"36333ce8558738ba",546944:"0525ad337b8574d0",547091:"cb06ec07c24fe9c5",547092:"9176248da3c6c0c9",547175:"816c1f864e5a477c",547224:"5ad247bd8f3908a6",547236:"4c84144901d3f4d3",547540:"bf7726d469e73702",547946:"cc66b0a9caefe113",548220:"f4771dbad94b1290",548278:"c08bb8175ab0672c",548329:"b4498fae45e57375",548380:"bf4819763d73d104",548479:"be794a31184ec7c2",548494:"9044a7ced1f98205",548645:"ddd06300912b7498",548666:"81a2791b1820cf0b",548697:"ba8b66d5173373a3",548715:"092fc35b8cccc708",548736:"42fd5bf42b1ef88c",548818:"1289998995dce4e5",549118:"7eb8544bdd86dd64",549270:"cd39b7b3db89c21d",549343:"b93aaff8b4b8f3fd",549437:"12ea4d29ec38f207",549584:"2c9bfa0496dda01f",549629:"02b4de860ace63ef",549695:"b4d09e97b679593e",549746:"1d022bb221892e86",549779:"40de6f4c48976cad",549782:"b56851bc40ef9053",549784:"de26e1b5da442b02",549895:"0e6ddf840481d5f6",550070:"fe98648aa13db0d0",550142:"9cca73f7383e03cd",550237:"ce83106f5ec43439",550341:"5054e5f0bc37a115",550483:"5eb4b9f4b6549d88",550752:"7ad4489cfa3ed980",550853:"68408af1e9f4bab8",551011:"730cdffd03b1db6a",551018:"3d2ef9a83576b38d",551072:"26841fdc2fcf5216",551329:"085c96d29aa37764",551345:"b086bfea4815977d",551353:"8848284b189a1329",551379:"e7ae390e0b333aa4",551442:"51252d89134fa5bc",551444:"db5c6799d6eb40c9",551632:"14cab627d2f6d972",551689:"a8db8da64221842c",551702:"637c4280d3c40241",551783:"23bfade7d81fe2c6",551792:"449bdfbaf351ae66",551886:"c2cca0b058bf5d75",551947:"1b56afff5ab4c5d0",551961:"ceb1268819b3ba01",552067:"4a253ef9695cc991",552154:"2c860a053fc66434",552198:"711833de9b2d7c6c",552241:"b26ec80314319d73",552338:"f81cc791772c1e15",552708:"e415b6c733abb8cb",552857:"fdaa0dccf5e19abd",552996:"dfe68d58c8ef9040",553026:"96b17f2c0657d40b",553125:"3d70f5193442809a",553182:"4f08a32ef280805f",553598:"e6665cfcdf03a2ae",553613:"3b128b14ce02b4a2",553762:"c55ce1ebbbd83c77",554018:"1997991f6c5164b2",554189:"528872c45d27181e",554280:"bb1bb519817b3baf",554309:"12838d136db7f091",554572:"546c7ccfc0ab6097",554696:"9d309d3529967c73",554800:"a08e66d4a6e3504e",555045:"48753886cd57cb94",555145:"7e823773d6fe5330",555253:"6156fc4a8a8b7a59",555437:"6a74ec0600350c0c",555549:"b308932556412b51",555662:"a4efdad7a9b22fa2",555811:"a8a852f766a74de7",555856:"f43214c30316d934",555910:"56038bd086bf0d59",555919:"18ba5fde52bcf3c9",555989:"0a1224149e828f9b",556073:"8eb0063295d66687",556272:"45204e4cc24a10ec",556551:"10af636b95b141c3",556625:"53d2c361372220c4",556929:"d29fbe1e1e299916",556964:"1ba9e0d60b006a53",557148:"c02c7223ddce3476",557458:"f808f01a98de0450",557549:"4a3a20c9b9eacb55",557579:"0a605940bb79c158",557681:"cb1822d2d0bf0823",557810:"369a72cc06a7d752",557931:"98e3d9479221ceb2",558014:"524faf42c9407d96",558202:"3140c4a302b21c3d",558582:"d382a61399ad6141",558632:"e2ce7b8d7d251140",558862:"1e3565f4cbb2aa3e",558915:"9a7b9f0644f80ae7",558990:"aa2fc57775fd6ae0",559067:"161a101267520cb6",559176:"d066faebbccfa938",559216:"294e3264ee40f142",559349:"30800a9d55095fa9",559508:"3e73127231e2ca0c",559515:"31457476083eb2f8",559521:"56cf5cfae1844333",560303:"9902f4e3fdad9a05",560311:"f3af47e9c4bde202",560382:"d63b609b2af7c278",560437:"a9a2d010f52048f5",560811:"9397c39551378a43",561167:"751de6f0e25fb379",561319:"5dc3d5a99f35ae60",561458:"8e917be3ecc04822",561542:"b6515f21561a90d5",561579:"359c0bc042d89343",561631:"d4bc65a86be5729b",561702:"cc9604553b57e294",561706:"4d189787dde01266",561861:"1fa1b14fec6e65e7",561877:"0b635a48e5216ef2",562148:"6203beb97af79808",562256:"bc99dbd3bef0360f",563123:"45dcd12c538abdff",563136:"fcb7c8dacd60e57d",563179:"6f11e615bd28598d",563258:"89e12ff46432aadc",563393:"a02ff36bb689b51a",563694:"d33342529f38711c",564086:"005bad733f83e8e1",564113:"0dba2e580c83a89f",564138:"f58eb1801a27464a",564145:"2a82ffd7b1fc7d69",564559:"4c05b7d737a95176",564670:"75c3126976512c7d",564709:"cd2d3940c36a7e33",564752:"a66e6e55787e7ed5",564762:"13eeec9a34c973df",564830:"c2a2d168b4752a02",564898:"b9dd9cb1bff8288d",564900:"e8d17f2e12453ef1",565306:"114f2899f78d581d",565327:"74bfb7f5f70591b4",565656:"a37a396153fade93",565748:"e3d39ac3b1299b74",566001:"fe40223f8d777b59",566124:"bd28fde5101cf62e",566206:"a3b4e92b0839f0e7",566493:"3cb6b316a72996bf",566626:"f6eeb389372dee0a",566681:"418824258be7983d",566875:"e13b4f9063e60732",566896:"4aaa9676329c06d2",567014:"88ae7014fdc414d1",567548:"f3728612ca1a93c0",567856:"d8d0383f36ce2c42",567922:"19bdac8393486ae7",567997:"7823cffdae38638e",568260:"0f41cc3f1d48d741",568330:"60b16d2eb438f376",568481:"68ec11fd2b8d3ebf",568725:"00543cb28f4654e9",568740:"da279dcce595ef2e",568770:"0824a292a7c5949a",568942:"42e66280f5774701",569102:"a77bfb32049d991f",569423:"1b0b1c31bcc4232c",569598:"acb461f3047e095d",569797:"7095f568d4ac6cf5",569839:"65bd678a427faeed",569979:"d41b9c74fa37e40b",569981:"596b995c06d22b5f",570014:"c2ecb1f116067269",570266:"bc6a791ae271b31a",570357:"16540ce46904a8d8",570498:"effa4f895312e74b",570619:"46176423d3e7965c",570822:"40beeda5e7ff5808",570872:"9887e19da99e0069",571047:"dc23e4222f2b011c",571078:"1572142255e8299f",571118:"94156ca91015c51e",571238:"4aa0070fc067dec9",571341:"96f2f22bfebb88b2",571383:"aa4480b30debb45a",571406:"9e026a04eb81d5ab",571515:"553649d0d4384083",571850:"bf738b949d90b2b9",572067:"9cddceb8ca36857f",572108:"d12bac8108ce7f8a",572239:"9fc1df69af775c15",572766:"f89528c82dabe927",572781:"6f7a3ae408e15990",572914:"bbe6b4555a1e97b9",573292:"2e958ae2234922e8",573366:"06eccae656bb9dde",573381:"933a7c6c3fd3d7a5",573484:"32332e57d816e4b5",573668:"a6822ba47a6baf4f",573694:"7f2d95a403feabe7",573790:"0fd5b0c330f1936b",573919:"25855c5758858693",573936:"bd550024350ad80e",574091:"eae9da5c0243070a",574214:"34a5a5a75dbdc9da",574464:"96c4a6fcfd62b637",574516:"bdcb31eb4c4b346d",574615:"ade3cc230c47be12",574649:"d8bb7be162bbb22a",574771:"d717e30a81b61805",574803:"c618b73d705ac1fe",575e3:"92dd5ae5580b450d",575107:"f7e1917ef3fbbb7b",575207:"988742f3a8821310",575489:"f9531455e5eb34a0",575575:"e81b6207f8edc31e",575810:"dc545afc0bc2c9e9",575962:"28bbdfa0b7c731ff",576100:"b9a48ff40b23d422",576215:"9f3900b403edc5b6",576306:"27eddc2676660c31",576476:"6c622492babc6101",576708:"88725197ec24680d",576971:"b6730deb952a49cf",577783:"18c985e79a3b0be2",578006:"bb3f2d7d1728fa0e",578065:"2bfbe64037a7c1e3",578195:"922aacede6af6bf4",578351:"6ee6889dd3475423",578683:"e5abc20def9400cd",578781:"dd6bb5eb65966e40",578787:"0463c4fa002a7810",578990:"7c03a3f4238b8498",578991:"af41117ee6b06048",579093:"af418855c804012a",579197:"281aa49284fb8ce2",579333:"0798afdb120c452b",579536:"7b0f8b84d0b7677b",579538:"1e03f053a362f73b",579601:"7d44d2051fde4273",579706:"95e219bce92da544",579735:"519dbc0170dda643",579759:"7a2225be21c98de5",579804:"15be12a71bebb8eb",580075:"761bfc3c8b236a46",580120:"c6448528613e0564",580480:"dc4d6869ece90bd2",580584:"162d2d132b1bd9d1",580620:"d32fab593f6cb55c",580871:"892f85e34203a8b6",580891:"adadc74ca645a7e6",580907:"b82ae718604c5ce9",580947:"caed405f938f6406",581034:"8aaae33821b30e10",581148:"c080162a41165e9b",581159:"dcecb465a798f2fd",581181:"eae344d95b95a168",581322:"2f1b04418c8f9f9e",581354:"14cc45fa204234c1",581369:"ba5ef0b6701e0ddf",581414:"97a0444b496f7d5b",581512:"7625305e61b8f68b",581588:"26a22d7174fb42f9",581598:"31228e752041f934",581675:"676a8c9cf992edab",581682:"4fef36d9f0979ba4",581695:"77e3e63e62b07d8b",581771:"609c01052c65a34e",581857:"5320dbc648d0628e",581871:"7690ef8cf6859cbe",581933:"bbeac3a8d73cfece",582193:"96458c595926b349",582271:"1c200f3261c9a1a0",582290:"495191ee1cd7c44b",582523:"ad7ebf71f9534008",582678:"481818b0f01ebab8",582795:"1753e566d14ca6ce",582862:"c4bd586d54515d28",582897:"6a5752226c254137",583175:"038d709bb3f24ecf",583194:"5ea292568ac6b8ba",583320:"d20a586ff339c758",583344:"404a6f62c199194a",583517:"76934d77c178d886",583576:"7f2f6d37ca3eaa9a",583607:"4263894f763070a9",583651:"149b59bd0a7a16d4",583959:"e33fd84dfd183a1b",584228:"5eb58d76f558ebac",584266:"4c4e753d6fea850a",584405:"94906d99d1113463",584524:"431cf29035ddf34c",584539:"10bfc556735219a4",584571:"06f00f68f4563bb6",584858:"d9e4efa1d2327eda",585077:"c2e87412047b38b7",585108:"7cb932ab046bcde8",585678:"af81676606da5ca7",585819:"ede947e65210ad31",585918:"79b944f70d37b97c",586031:"f49026abd5bbd027",586037:"292801f93ec7c4a6",586060:"c3f6c32d616c720b",586090:"88d328c9c3e78c64",586367:"bd046b306a4d1273",586395:"9af9b9bf7b6ca10f",586509:"89695517f1d14a3e",586812:"30104c9b4a039424",586989:"8ee57bb7a074e764",587218:"8a3c9f7fc526b4cc",587321:"ac1f30413cf0c9dd",587384:"d4617dcc93965dcb",587438:"2eae9276ef5b847c",587450:"edadec389d2bd5d2",587492:"a357d8c22291d626",587495:"fc2ac01b5aa7ec25",587577:"93053d0f21da8196",587588:"dfac575603d87fd0",587793:"06a132ca0541a043",587864:"3b632a41a3799b50",587989:"b30ea160b7458292",588026:"f532bc4669b2a6b7",588116:"fb8695250d49fa77",588257:"940fabcf10c06b28",588314:"a174c12aa7d5d168",588593:"b77cf205c01b1fff",588637:"f3c12ad8b7088a89",588658:"ecdda44620d57cbb",588891:"4eaf47e5e5bd5739",588919:"0093ba5607275621",589005:"9e67457ea88f2d02",589142:"6e8513b26a417efc",589154:"3ab2215fc92157b9",589434:"8be34d63c6a0f073",589438:"afc9c4a65d0c9bdc",589487:"66caf304598e0e82",589622:"85f27a09832d738b",589799:"f401f1f7e3bee83c",589947:"4f7e6ed070a633f2",589989:"7e265111581faa08",590130:"106aa2cf1aa81cce",590132:"a08178f81044b5e9",590145:"02c028b59096dc47",590442:"ce96653f0a734657",590538:"0d5231cbe9f16f3b",590640:"0d3d99a3cd5f4f90",590769:"5ab624a47e11ebbf",590842:"edbb8752946ea69b",591049:"b6dc5a98ada892f0",591200:"ee4979cb7873e31f",591333:"74eb2d527ba2f7fd",591494:"07efa5e67f575ebc",591540:"783bc58abf9cc09f",591554:"86e499b198874594",591679:"029c00869f2a1b8b",591776:"3b84a27083dd63e0",591853:"4022782be4b513d2",592053:"db46cef4679af144",592101:"d6d7f5ae806b4383",592203:"ee253b9455ab4d94",592222:"d78abad501d743bc",592294:"beb8c9affff8d717",592295:"5be2a8252e1b17fe",592366:"033d4a00ed13aef9",592424:"5d8ffd8c9c6a8c7b",592496:"3411bf65ccf00fe7",592546:"aa453b1fff95ac2d",592900:"6a0cdd726e51c63f",593038:"371fcf10648f3ecd",593058:"bff5eb21c507aab3",593357:"40f79919beafa10b",593704:"0f326d219e5f83e7",593860:"89b43128f00cda8c",594037:"b3a78e8cb9f75200",594210:"36d599b43fc0dc2b",594236:"9f1bfc9d81b4c21b",594311:"b4e70e4cfcc44abb",594431:"d42222629c03ff18",594527:"654c3c275d63ef5a",594865:"c8b6a45fc0607a78",595017:"65c9f3694e3755be",595214:"85a0ca8c4ea46086",595233:"a1a0cf9fd01299d8",595239:"fa6ad4caacbbde39",595341:"663ca4c7def892cb",595518:"2c4850d4d974c0f4",595554:"6dfc13006916c695",595638:"15ba98f29aed0abe",595655:"4427f1d8c84d4f22",595809:"ffe06478ef97c83d",595862:"8671af11ce347316",596181:"a64fbd0e2e2126ac",596201:"ca14a0feca3e4152",596860:"189bc36313809768",597085:"410cb37da4ac1c1b",597090:"7ac6b19c1e3b194f",597256:"122036f85baa2517",597291:"f249d17214f69fee",597442:"a13956ffb06bb2de",597475:"025506d00c82b27f",597633:"b0f3bc7c2e71c409",597732:"734dd69b7cf1150c",598071:"45d5afb537640987",598156:"8e9057b200fd6a94",598244:"067fc7eea618ae46",598330:"fa26f484c4e0f970",598410:"d77897db493e4a7d",598805:"2021d85d0417e048",598854:"3fd4d12cee57a09b",598885:"00bcbf8fe00cd5b3",598989:"b5cdcf8eaeebf88d",599025:"6a30c14fd1a66a2d",599619:"cf30aa2c9e7cb644",599657:"b442d315f279b405",599928:"5c4d76bc225f17d4",600025:"01bce43e2f6a999a",600315:"2c892f52b43c27c8",600511:"9be8821be47e2608",600574:"3ec78ca0367528fd",600788:"b9e158380eaaded5",601032:"ada7259cf748cba8",601349:"dc849efa18482f58",601407:"107da83104e66533",601576:"bf3bac85691868eb",601667:"aa0cacf14ae258b3",601687:"c98d447f67536bf7",601712:"64a4bf14972d04b2",601915:"bd9b22c49eaafe68",601938:"08ea86b5a989e8c7",601959:"f174db43825a11bd",602092:"87a0664f25b7581a",602252:"61f30e71beca891d",602311:"bf83b441d68869d9",602398:"c3b93d539b740a5e",602452:"0a423191e3d13148",602605:"e3351a95a5d07714",602767:"55597690730306f6",603081:"5b071e44b9423100",603215:"890344c603a57a1f",603418:"a5eac6fe1f7ac102",603440:"380365420373b154",603576:"3cb3ad47921b0d76",603874:"55346970fe1b2cbd",603921:"70545ed83b231d76",603983:"3d686c636dd46261",604178:"b4f5b981f3f60c1c",604835:"0c6622280e5d0662",605169:"8169527b2746cf34",605239:"1b84f40d37f1cb25",605412:"9079215f2d457d92",605443:"ff325a57a8b840f0",605448:"236383b522889947",605671:"83931a0421822e87",605706:"59bd11266e364a3a",605823:"adfd1a6cf1b5314c",606085:"32a43c2d5a8df68c",606114:"e946ffe5aa092999",606208:"645bd8f3430ff127",606227:"4d88ae4394641c87",606232:"8cedef64bb5a9e69",606317:"bb88372f7e0f44dd",606408:"115000d8a5a29093",606522:"ce4994c3ca16a6ed",606545:"d7cf5c638433425f",606645:"f414ccc71a469516",606695:"f1696ab4443b1799",606780:"587c65ae772d7f94",606824:"6803ac9c5c7735f2",607015:"3bc17b3b0ae7b48c",607028:"0fd46976e03d61a3",607275:"ee8fa6e9cf8e8576",607477:"95ff7c2e9314a660",607673:"67eadbdec17e0326",607726:"bb5e198e792df723",607729:"6c81fed3155e59ff",607932:"1923dfa4920366f7",607948:"5605cfaec528fc78",608077:"cdfe4b0e69884c5f",608108:"8f34dc538efce9d4",608178:"1df9f6a48369bc9f",608468:"66a3b5198898081c",608470:"71dbe720ba8c4630",608927:"1d48a8713ff0fda5",608983:"97c259e5d30f2dab",609050:"e0a652f03a8c8ef3",609301:"b0e295b1213ce29c",609339:"09087f5fada31cf9",609356:"0f181b2a5d701e21",609408:"6faa06ef146a2172",609492:"fda31e2d07dfc1b3",609636:"2ec2854e632c18c6",609652:"9a7af0fb6e2fc989",609916:"618e807558c34b3e",609957:"c6f13c1e880141ca",609962:"cbdca3e389dba4a8",610190:"3d9a75ef9929276d",610234:"0fe9099b2826ede9",610358:"9d2181f24ad5462d",610634:"08a841309d71b1e1",610698:"9d72c3f4975746bd",610883:"1395684bf49a3609",610898:"765fd3c54786e94a",611343:"5c80cd60fb17b4d8",611529:"6174e9d909e6f9bf",611682:"ce0bd430fccf5b2f",611763:"88b5a193762a3dd8",611853:"c2b93eac439be34d",611880:"1f29a792449d7d23",611893:"328e93f9e4f21aeb",612145:"48ae23e3db525e70",612154:"dd1d54defcbf6ae1",612486:"0e06b065f344f30d",612579:"ee4ff74659d12634",613078:"a1b9bcbaf88a3ccc",613179:"50c1294d89471cb4",613549:"2a2f75806b92dd48",613587:"fe52198dbc30ef1b",613609:"667d21b2c5461e47",613734:"538969f1a57947f2",613762:"2f1c37c399cf9da4",613763:"a9c92955db244114",613785:"c73960a8429c58a9",613796:"ef5ccab093bdd30a",613963:"73965cf1234f25af",613973:"8c7ac33dd06c59a4",614200:"9fc9f9a13914e668",614316:"300a76ecc5333299",614493:"1bf0845049f8e843",614538:"7ad088d13f2848bb",614553:"41633b59f0a3c873",614640:"e2c4a12f6ac7c426",614904:"e39062ff9502afde",614991:"4dacee844acad3d0",615242:"650b4d0fc625ccbd",615263:"36b8ad2daca13e19",615372:"982ef303a35257c9",615482:"a573585af8b5bd2e",615505:"f2e573309d880ddf",615584:"db7923fbff8378e9",615632:"60281480293da989",615700:"03d0b5b1281fba7f",615942:"413f63f95b82ede8",616037:"1ce6ce8dc2fc3ea7",616052:"9ded91cad7caaee6",616179:"71aa913ef5bac75f",616415:"eb3f0f342bc2fad4",616738:"deddc4c2aa36c6fe",616760:"3790630ace1c652d",616774:"1d254ec8dedb49a0",616789:"ddc97f346b2e8aff",616862:"017a99fb75899ca5",617091:"f6e724cfa8bd496b",617235:"d3d18b6f09849a71",617263:"88132e6851cdcb35",617589:"d40fea08fff206ff",617598:"a358cd04742d2d33",617703:"c97924bd32b1c021",617716:"c2b675abd5126a02",617759:"12be75d4084f7c85",617804:"e8a6592a87d79876",617981:"62f85e13a5b24098",618225:"64e6f6bdc60bd295",618231:"1494d51713147311",618719:"53a701ccdd5993d4",618827:"207d168d681fc48a",618845:"93a0f8d1d07805ea",619114:"a853d32088fbe07f",619158:"379e246533001f5c",619228:"4d09a8bf2487fae1",619290:"5ed005f8fe703c41",619436:"edd0b4f427258324",619908:"7e13a3312646e53f",620047:"3d9d05c60469298d",620089:"d21370e2a2e51ab2",620188:"f6c341d67012cf35",620244:"8d8b714ea7913148",620272:"4e5d14d0c5254f9f",620356:"ef5aabb0929d4f13",620461:"5c85eba7f5fb7e88",620477:"2d73db2acd3c8bc3",621125:"550314fa2b4720af",621177:"2b1556141299cdf1",621535:"601da977dbdffd10",621583:"f5e57191b77d6892",621800:"889994a549907b1b",621819:"f9cdef0977971b21",621886:"9929338548883778",621958:"4c78bd79201860db",622121:"0d1d2331be44d5a0",622490:"5a4dbded6e5b8abd",622504:"68a95c1861c6b4b0",622562:"e9d7038b99e1d792",622768:"1478341f88bfb52c",622892:"58550c2836006485",623077:"3b4dc3483fb9f847",623134:"550fa69c29705866",623135:"3410dfe43a02f72e",623310:"018baa156a09241f",623440:"81d8cdea304c02ca",623568:"cc91f371d1e60585",623675:"750ea63b5a954492",623759:"f29c5d0e27b92b85",623822:"5b6e83dd6a0400da",624009:"f901b746d6db585d",624099:"e91179289b22cee2",624149:"8d229802681c8d5f",624179:"f4fd2b495a8e77b8",624191:"74e89c477df6d815",624307:"d0ca06cf9371d8ad",624361:"1b6ddb3dfeeddb15",624518:"39a701dd196017ff",624556:"2118657da4f72562",624704:"7f3d8d36bf756983",624754:"74f83d498a8d8179",624796:"e1836310c4a3980f",624838:"23ffb78e3247b48a",624862:"79ffa3e3e6fd708d",624879:"afe833e50d9389b6",625033:"c4ed6f4e77ef6aae",625041:"030e37e7559fe143",625331:"68d7a8c7c020a9e0",625344:"509c8c6f1559c367",625454:"6e42ab1e0ab3a865",625503:"f50da43a44451853",625702:"056909577ba55d67",625769:"0339034d9ff0de1a",626102:"04e133448e5227ad",626252:"c685992262ee374c",626298:"a59e5ccdaab2da43",626317:"bc746bf78bf86175",626510:"798efb8b678623fc",626759:"9733c0c4f152cbdd",626851:"8190cb0cae701cd0",626889:"17515a1c12692a04",626913:"d5a4a9607c1fc711",626976:"acc4edc814c16d6b",626988:"a8ed6f324b49dba1",627058:"9f1fa6dc4020483d",627145:"b460b734f390bfce",627366:"8ee42675fbf8bc27",627386:"9ec638795f39824d",627576:"aed8493c41b9edc0",627994:"a2eaf8c68b4aa928",628035:"2f0ad271e7663dc1",628041:"7d4695fc03bb3aa2",628202:"e7e6d23c7d86fc6b",628471:"7403dc7072f6d700",628474:"aceabdc9131a3830",628564:"b71cf1e2cbf8c0ca",628895:"66863d0a6dfd6134",628907:"86c6028178bb9326",629095:"233f7d60724adcc8",629233:"14dbc6c8ac26d8c1",629504:"f9dbef21a61a7247",629844:"f264996d7842740d",629959:"1ce3b33a48f27eec",630041:"ca0bc1fdc88a587d",630209:"863c61244fab001f",630483:"3e1bb8f9eae58b30",630672:"83c1f4821b297edd",630793:"7ade261b2e30f462",630962:"f1be8225175c94cf",630964:"e2472ecc88944e6c",631007:"d4f5511394b5f1ff",631211:"cd78af20161f2cec",631240:"aacdbd154d3f37e5",631593:"5b8a08dda0ccd14b",631702:"c8b8d7fff62166ee",631845:"ebf49198ac316379",631900:"31de0314771f6272",631967:"50084daa0fcb1799",632173:"eb6ba2cdb7123a24",632262:"233800e3ced1d04b",632287:"7a2a85d7ecb7bf29",632323:"40074b6a4fdf96ea",632412:"db667d8fc16623cf",632562:"f9a1be24eb770fa0",632584:"ecc3c840416f7bb0",632606:"61b7b251f707d4b0",632626:"b8026196348a7057",632712:"3e0b72704823f5bc",632825:"1143df3f2ba8e168",632877:"9c7df73a9fea55b4",632896:"8ba8370cacd7debb",632993:"44a647b834c39ead",633004:"17d2f5b23c7a5991",633145:"24e7f009a60b5098",633510:"a2cad1f6e896f66e",633514:"1dca130bd826cd05",633602:"8401dcffb4794582",633642:"1487c51e9f3a25b4",633731:"6be72c1b7be89c6a",633780:"eb55fe82f70d3a43",633866:"eb4b8a4601a22c51",633868:"d75eb9e3a830f31d",634077:"660f2a39dab0395a",634287:"930d6e16573dacb9",634517:"f8c1cc0b0c1bac55",634692:"2f957481f1019ca8",634930:"de224e38acfef12d",635024:"bc8166d8e83ba0ce",635300:"ffda8c4681be1990",635677:"948e68644ef6dfe1",635689:"e5c86dfa46deae31",635791:"07b65c53134bfdf3",635815:"9d5854d6656e0884",635968:"e2e1c5bc26770e42",636318:"f895906b9f4ce771",636324:"7d2fedba6f7c2741",636358:"b6bcc9c041097770",636446:"ccf4f293f5508308",636501:"54fac600b4bd08f4",636601:"5b248fc11405b52f",636608:"47aa615bcef8d2e2",636759:"3dbac9d1f6200af3",636805:"acec27acab34a824",636878:"0007bed487b47fa7",636934:"a8907855ee114105",637327:"fbe2bdfe94d6d0de",637388:"e8a8a833391108ea",637406:"346323c53d5a3fce",637418:"07facf4d8f1db650",637662:"a0aeacffb802ede8",637854:"0d0c2bbb3a6a549f",637865:"bfaf9b2b8bd7b261",637947:"0f5952a32c0213f5",638042:"5e6a76cfb6cb9233",638563:"2b0a3cfe62bc1233",638620:"d26ca5c9be55ab1f",638829:"b0f52919d5288a8f",638830:"4885186ef8c6a103",639237:"b8a88b3857156d23",639363:"2082875114560930",639455:"de6813f8d66e28cf",639696:"17aebbf51c8ccb3d",639910:"fbc1bb09e5ddc75d",639977:"3b097003ac17523d",640162:"4ec84b064b4b1e78",640182:"8709585ad1dc74f9",640184:"6f319488d1643f2a",640212:"03036fb0eaa20834",640250:"41dc623fa86617b9",640347:"6d4dfdecee16e336",640628:"be58c02bf829f3c2",640637:"dd18e186f77ea062",640852:"a5e141aee01310f8",641007:"e00681988039534d",641091:"2fbdfb9b3184ab89",641127:"98ff4adeba2be8d6",641133:"fed10df463c12ba5",641272:"e57bbd6241b58925",641308:"8ad403948511354c",641355:"88a3cef3ac83eba5",641463:"6ff0dca2bfc53ade",641725:"f9c20fe4606432f2",641773:"3d1cd0ca14706efc",641781:"83166eb209172e48",641816:"119d71cf9d7b63e0",641847:"5af3be7752d6da7a",641886:"b3cf238338076ccc",642242:"caf6261b2030a8d8",642293:"4ac9a53f726c05ff",642298:"07fc3326247bf1dd",642301:"e2cbbd84428c491a",642371:"ba49cbe6ae68108c",642420:"df1076bf5f2aa697",642449:"ad31fb1072ccda9d",642548:"1889bd5ae6258870",642904:"99dec7fb0ed7f273",643054:"36a9a983dc13f8bb",643138:"6e46b588247b7464",643461:"30f2bb3bb3a7b760",643511:"9ca035f553552e16",643547:"151592233b04760d",644009:"1c7005c2190208b6",644019:"336006ea8c4f02d9",644626:"d9ef83914b542c26",644634:"91a7cfd09762d6b7",644688:"18d7d955df977732",644713:"1f7e5a3082af0ae7",644746:"59e2ca0785c853e1",644878:"7aba579593534b4b",644880:"a6efeb7ffa6fc8b8",644924:"aff86dbc2138f005",644935:"9e2eccd4cea040cc",645207:"0d5a43bc5f527f93",645284:"78848c0d7e12f5c8",645722:"464e7fd0adab1111",645913:"ba716bfe578699a2",645979:"23863f7e64723c25",646119:"ccd14c8e957a1d51",646156:"a207579efa8f988e",646391:"c56ac1f7619d831f",646433:"427be506b06453c4",646586:"5a9a18f4457ce3a8",646639:"0bff083c92de63ce",646647:"4c1013b938c44279",646757:"4ddcb8d1ca136800",646900:"49ac6205edfcac93",646936:"9322658f7f8701dc",647461:"a25872e7d1fbf7b7",647584:"2af149767aa63004",647708:"41e7e99a128b5f13",647799:"8d532bd01c70d45f",647821:"3479f9a581f7cb8b",647882:"d86096d91d1643b1",648076:"58ffe272c4d9b0f2",648123:"56a933a36a003875",648173:"8c50e936dd915012",648292:"a0c64bb2bc25ffbd",648337:"f409e4295c0f4a03",648372:"9a515b151c7f8a49",648421:"ad982dab7c7a261f",648441:"5618b6ce7179515b",648496:"151938d41408098a",649133:"93a966bfaa0696dc",649330:"226b6c95d72663be",649841:"1424c6050d5ca623",649880:"4b7671d13d5d55b0",649941:"240d9ab4b22d5de8",650073:"bc4e3e72c9c2fe67",650091:"c57d6e6e93795c9c",650165:"1e845d708e68cfc3",650238:"4dd002c9a73ea70a",650284:"66888a1f512b33ae",650575:"bd4c8b31397d5203",650756:"ae47c11a9f583b81",650930:"194bed1cb5609aea",651070:"ee0a27327c676fd2",651226:"901cc0547a3fd34a",651995:"855466c1f189c790",652116:"c9a08ed55e575203",652168:"5937be9e84b55083",652624:"c6732db17ae3cb0f",652763:"97b2233f6de3b4bf",652828:"06c01261acee262b",652906:"6e98ac01def6a2ec",652953:"f1cdf41de9fd3349",652975:"0d34bc48232e0eb2",653047:"515adca70184812f",653295:"96e28caf5344fdbc",653314:"a4fde3dddb3c8489",653353:"7b94452761d9ab64",653406:"bca0df5ad2e22ace",653484:"f01acb590253666d",653565:"4dc38d77dfc11e86",653758:"b2660bafe6467530",653903:"e166b3ed3c3f9c45",653930:"a4defd157ce5560d",653937:"1335d08756deb13b",654198:"9a3c55b4604297a8",654272:"b8c369d46ac71d40",654862:"82a7fca4676ace82",654943:"753370f938c2f72d",655033:"565faaced0d07747",655151:"8f3aba916d4283d4",655167:"af07a1c36439a67a",655377:"4ab5ef3947c666e2",655402:"db37d817dd5369a0",655736:"de62e80e66f4f438",655939:"9f515a20dce93aaf",656157:"8b062d775f1c6924",656276:"aa42c66fa38affe0",656283:"098c49c960f3ccd4",656660:"4218f1eca2f5c273",656713:"4c9059c134e4b9d5",656737:"52b8122835718ca8",656765:"10b5428a1dc9dc58",656777:"abd88800d9d442f2",656906:"081e4e3f6b77f485",656922:"e73aefbb17ad1106",657107:"b7a746039df684b3",657191:"d471b5e865a5bd7b",657219:"68af08c6d61238f0",657330:"4e8daa995d746709",657542:"b1808afccce5c808",658291:"fb773ff20947fb5a",658310:"157dac6d1622645d",658335:"1a39bccabcca2bb2",658395:"1bd60695705c9caa",658438:"c2805bf020bacc1d",658511:"69f068075d447447",658610:"9d2664b52a364535",658736:"bf3a5b128f287710",659045:"4125bbdf617b2fd8",659074:"4fde025857c959be",659081:"a3706e00dc8d447e",659098:"9c8fc3bcc84a9fee",659141:"219993d93c2712de",659277:"564817f0de66b0f3",659412:"c44e509fccbc93c5",659831:"9fd2b9fcf579dd26",660115:"e068208fb4f404e1",660171:"539eac70fa3c58f8",660243:"ae36cd52196acb98",660273:"4b26b70d9e1c2cc8",660334:"a161f5d2864cfa98",660693:"bb127891ad1edcf1",660920:"cd72ccc496b6649f",660956:"2871ddbb3492ad35",661051:"e623551695e076cc",661111:"99df26689ea86071",661172:"9d3ea77c6e9baf48",661765:"81a22c0b60b35875",662091:"5dcbf018c790adcf",662153:"e09b92824529a957",662283:"98cb4c2c6ce5ae8a",662286:"dc0587a978d71049",662305:"6640a685653e794c",662463:"a6750cb43b2f3cf6",663296:"22370aabf4b3bca4",663304:"e9f39f9ebc15dc49",663580:"f091c454eaa86ced",663763:"3bafee2b80a8f660",663799:"85e57d033b0cd332",663905:"9d4e66e458dd0606",663936:"c46926908890f213",664084:"a84d801876a15b6e",664089:"5159413648346fc1",664140:"07af18b3d37da2ca",664501:"bbd6ca66c17547dd",664543:"6a3cfac3f1aa485a",664864:"010846c8f57383d2",664915:"ca03bc6f78de3edf",664930:"f8709d2983aaaa03",665061:"bcce48011569faf7",665242:"5540fc2989add711",665284:"6375771e25bf935a",665347:"ada4a0f2b96baf83",665666:"e7ff9ae2ad652278",665670:"5fcd4f4fe1bc2d17",665682:"824593c1d340772f",665831:"2894a03da1a57992",665934:"cf1cb91c78065c97",666397:"c6da61c6b202fff0",666482:"1ac66031e0f54cd1",666518:"268fc731192aeb7a",666555:"4bb0721d389c8459",666581:"fee643d207362f0a",666836:"9956aeed74a1067d",666907:"a4b454c9d84eaf5e",666917:"dcadb28bea99220b",666949:"90a6ec5a99a39571",667069:"03ab906c27dab880",667128:"d55cf9e36a2b4874",667142:"0f0c827ff709cd3c",667288:"c5e4985b8b409dfb",667417:"0f4ee1c9cc9d11de",667606:"0a35f52540f94711",667615:"86355f766e71519d",667978:"39c87597646260ff",668018:"7a0045c168a41924",668029:"cbd82e448c0a2dcf",668059:"0f7a81b0e797ea19",668265:"bf17104e54c5af18",668286:"565b67106a7b86f0",668299:"526de43f9f14cdf5",668331:"d48c273c62942771",668416:"987fb5b79b4c54a5",668508:"da9f3e000a300850",668781:"cb12f6f4408de798",668987:"04a4b44ca5362f44",669027:"8f251279d07cb0df",669065:"eb7648f8bcd203a0",669469:"4f1ae218f2a3b5fd",669528:"fd5e31540d335800",669721:"ccdf2547941dc457",669733:"b4427f1411de946d",669982:"9f3f3fbe47f7d646",670059:"02520b9eac526223",670125:"983edf080177ab03",670362:"7060c6c731d29779",670719:"00e33bfacd5f947a",670810:"34467351aa27ec03",670825:"e6995834ec8bc36a",670941:"77c7e2d24cbbb968",670947:"67c03fd2860a63da",670966:"72616c663d042045",670972:"c72860edd05f8e59",671219:"a93df00831de32e2",671980:"189c14aa94d311d4",671994:"4e594f3261c06ae1",672007:"628eb692e0f5c81e",672023:"0c7069ae671360ca",672046:"e06edb08f893dadc",672443:"e00b557be1adef87",672603:"7acc6441ef58b49a",672754:"1a754776fdea1e9a",672777:"3025548a6359acd3",672787:"d13d68e26c16b86d",672819:"473e988a11bbb61f",672830:"1b2b5c798cdb97b7",672975:"2af918d560f58134",673049:"02f112d27ea9b58a",673121:"74e040f085b995ba",673124:"06455230b8e373ca",673319:"5d76117184ee0c6f",673411:"7c47c8140a804638",673546:"cb4ba98cf50a5e1b",673680:"0001161fdaec34d1",673930:"f7164d6c4f5b2c44",674093:"7e26ce7440eb24d2",674399:"d4c2d2d272a7e762",674562:"a61904f028356bc3",674802:"b17d35fdd37e397d",674821:"e0669cc602fac179",674872:"0c6f1f137adc3f5f",674946:"7d062b18dd03bce6",675193:"5036e4d9c4f55dd5",675293:"b9eef567f3668681",675311:"aa761669d2b458e7",675336:"ed380dd9d74e75a6",675676:"8549048a1ceb4c40",675770:"5afab62580fd24cc",675826:"0848b9270bea53d9",675831:"04b5c3554b05653c",676007:"213cc535311a80cf",676028:"52133489aa101b19",676130:"0bdc910a3a63ba72",676165:"b1423be06ebb9ac3",676179:"fca2953009379837",676362:"7a2c091d10b873db",676513:"2dc57daac23ed208",676618:"090c3aef684f16eb",676634:"07880223994b093d",676717:"7f9737b3412656a0",676801:"898e6bf2bafa0423",676912:"972b8802d972797f",677202:"82883c04fef4dd25",677258:"a6aaee30860e9924",677307:"e4ec79366aeaa26c",677397:"57d6a190104c506f",677406:"22b968956f2144d0",677502:"0ff37075c26c8543",677504:"9ff2de0bcc1024c5",677579:"efe6e9b3697477a1",677665:"a3b670b80c62da1e",677793:"b275577d98d32aa8",678026:"acbdae23d42a7133",678241:"a9157fc0156bbf20",678341:"6516bc6de8f4e91d",678408:"c7fc046e1f77820f",678489:"0101d954f408ba6f",678609:"d189b504a95a9bf8",678669:"9e0d21608702105a",678680:"5adf0138d4944e13",678729:"956d3a9e340d4752",678891:"ea1f46e6cac86477",678893:"40ed05377c810a63",678932:"1a031e5d2998f57a",679049:"5018c1d712f45a01",679313:"29641aa89b507f2b",679680:"6686bfb201d202da",679943:"e906b3f2f75b1a7a",680028:"4bcffa5c38066243",680051:"afcc4b5113d35395",680292:"9e7a72eb5315074e",680441:"49983f7edf24e74f",680472:"6724ff07efd816e3",680562:"fb494b0ca2991b6b",680707:"b0678ddf05dae164",681146:"a9986690702352b9",681150:"da09bcac5e819b76",681255:"248ae9e232e791c2",681535:"ada3467088ea3e90",681698:"2dbf94548287f5c9",681826:"3b7e162f89e49969",682202:"417b5cee07243b2a",682210:"123a8e526e25278f",682225:"d5f4b04c3dc827e9",682304:"8894c16c048fbffd",682389:"da5917f15a3932e3",682645:"70a2271ab2121221",682653:"6063c2c613455c0b",683026:"b8441d0b9f125a71",683107:"a28c5c679f65f7d4",683178:"8c1cfd7aab39272e",683245:"58f1fe314085b0f8",683254:"ea1744e744c8ff22",683256:"85fa396c12e6a446",683398:"3e7d930315f3cd3e",683628:"420fbd673da0da7c",683825:"999bdc485c7e3d0a",684091:"9be9565097fd31ac",684198:"89d5a9341f2c92b1",684214:"7617787d7c891593",684615:"2e320aa87ccd3cfd",684619:"b91bf0b4a308a027",684655:"bf000ed6de803882",684932:"da0537d01db1d276",685394:"f37a52c2c1e10abd",685464:"d857bc36072eb5eb",685678:"0616c221624da778",685767:"630d6a05502afd8f",685995:"1306467792f95b7f",686049:"333440610d4b6265",686189:"6e52ef6e4ad98cec",686206:"2464b299b6480d92",686380:"6de98c93c18f3aed",686560:"179758768ed6d72f",686626:"ba80bcb2307f313c",686681:"3d6048733e7d7fb2",686692:"e232e330dbf9abeb",686824:"361b381d54a2f39b",686855:"8850a19700544b40",687007:"81fcc3a10a735b7e",687254:"db52457eb04795e1",687309:"d0d0fca59e405192",687391:"0faddb39b3e7ad38",687392:"6cdd886bcd7aaf9d",687937:"109e277c0546a7ed",687990:"ebc96158456f4aad",688222:"e2b8a133880806cb",688354:"6a309d12b4fe2a26",688487:"03997efe5d6a8bdf",688540:"30b7579fc57d30c3",688772:"09c80b91c0ea86e9",689045:"0c89a5ca09fc6337",689134:"58bbe5322abbe4a5",689284:"cc6e6ca1fed1c540",689312:"fb86844a9b79d93c",689517:"892c3bba50cb44c0",689774:"895231add2f0f747",689797:"0bbd2ca738a2727a",689864:"1555a4763762c8b6",689908:"654907db05f3fc27",689961:"27913162ea81bef0",690042:"c13ac2a27868967f",690115:"ca45304cfc1812b9",690134:"cb4a156ed0fd426b",690224:"4a5e3e1145d514ad",690250:"84631cf9b662f844",690265:"3d98b0b2f06574b0",690295:"640f8d9ace566f14",690408:"2ad8be1a5aa9d8d1",690461:"c34e9124865ea9c9",690533:"5be63f8203bd8707",690534:"00deffe6b466acdc",690678:"297195821688cd5c",690784:"5821e924473924af",690912:"b0ac8f6699fa5c07",691086:"901e4e21ccd722c4",691270:"95abf0f974304319",691291:"59dd762187bf8dcf",691548:"178ae9d66ac021a5",691589:"042f2db244bbf260",691648:"58fa29b376bfe669",691730:"48cff23e150e9a7b",691830:"ce26e4cacf75e545",692030:"8816341d5810ad7b",692073:"460a9ebb8bd286dd",692534:"21178422def98c12",692729:"1a4db12a4658217e",692872:"254b01e863e81f8d",692889:"e24c3721e56d016d",692915:"06a0b2a37cf9962f",693053:"dea1130d629c32b0",693306:"968047ea49a761d2",693334:"5bb867724d55ea46",693371:"d78b3b5129cca86b",693481:"d38d61b224046415",693610:"ee828de6029dd9f1",693681:"823b78906d4426a2",693726:"f660c9fb9fd74f55",693980:"9315eca7374ca93c",694037:"0f1bc5bc87c88365",694153:"108fb2ca82dfcab8",694170:"8887a3b82a915ed2",694174:"3483d8b088c06386",694255:"5e733e60d88a22e1",694287:"66f4d10370cf5add",694623:"2931cf294016e1ec",694886:"584c0d0d7a363343",694925:"60c87da64d5d2a1d",694945:"c5ee068b7094249a",695131:"c980ca216953022a",695198:"5e9fc090fe9dd321",695489:"263c55a3393ac8af",695545:"015e045ec299929f",695636:"f82137ccc9e72fa8",695651:"9968fac5e1a6c796",695659:"9ad1bbd43f525327",695765:"d008d9b7f0f05b9b",695875:"bb41f60af2a13f8d",695957:"74d2a989ada6f0f3",696208:"989912edca93bdfe",696248:"4db7d55a8c1910f0",696363:"f32115f4bb8776fe",696376:"c8b3f86c7559a0c2",696384:"d0303c39939885cd",696540:"cae4ce7b7167d869",696798:"b5d33d79f8ba15dd",697029:"ea9fc24d73e3aa3e",697113:"5ea63cbd9090533c",697202:"3fcec9188ea6c013",697302:"2f5074ae65fd89ac",697399:"53c7e8f8069f48b7",697834:"07a562e771353288",697866:"978269553e18b69d",697962:"30b691fac4fd39fa",698080:"0f293446265409d2",698087:"d4ba1b0e360df861",698091:"4ee024034bfb0c68",698203:"9054fb3287204769",698430:"132e131016e97790",698556:"4ed53e6829d86246",698767:"d26ab4f59603c511",699309:"82e1e7d6055f11b2",699357:"7facf4e14623386f",699384:"d24bbd3229b1c969",699530:"a790865364c610f8",699870:"606283d60aaa3b9f",699941:"18769c834f81e757",699993:"62bd1a095afbabcf",700122:"baef213c5da26345",700374:"1a47932c69513a38",700488:"af623366381c0f3a",700722:"efa039ecd77ed495",700798:"77d1cb7f1f85ee4d",700944:"6ba61b3a5e68b60a",701035:"35b679c0fd283276",701333:"ec0abf84a6289dd4",701505:"86a0a82ad5b3d02f",701562:"8906a73d074ccabe",701570:"b1650dd89c7f8381",701583:"c7b592e6e7a81b9f",701685:"18cfb177ae5523f6",701796:"9bec001119636863",701800:"3c9a92dfeaee14de",701839:"036f329f7243289d",701919:"329f09ef00867130",701963:"6a00933599764a06",701966:"68abc250753d6f41",702055:"6ee6c8fd8e36e267",702115:"dceb215c9b297998",702762:"4fab3003f0d35d88",702869:"86a0d10213c215fa",703007:"4cc4ef2b0e196515",703250:"13ccfc97d5d672d8",703299:"0a91ba184ad2cbc0",703475:"640e15674f0dd5ec",703813:"57b9240fef5b13a9",703834:"a3c45862a2c1e505",703842:"a5e0c2e356d930b1",703854:"92df8688d640dc21",703957:"da95133aef239faa",704087:"fd975e027a47e03d",704092:"af0ba402568903c5",704286:"58b808fc32f2a9a4",704339:"02e948c43fa3ed0f",704498:"959c4de159373afb",704618:"15248bb55a41be93",704620:"d88f4407a8d35bd7",704667:"6aa33cc2ff28fe8b",704803:"51cf49fe2c73938d",704887:"01fa751d617beb58",704913:"a458c29db79a9ad6",704922:"1ac10a3f236e827e",704933:"68f7708e263159ab",704980:"12b60433f33a2d01",705111:"43262368be16e02a",705175:"0956fc9e29ffdfc0",705297:"cd576d4355963af9",705313:"8b1de874ff644583",705390:"79229dd85c66743c",705464:"0aed3d6569c27328",705553:"4e37ce881f44913b",705754:"a346a847350ac1ac",705849:"47e3eef96ffccf9c",705900:"aa7cb47dbd8d7850",705980:"7992ea69459c47d7",706013:"bc32b254f618df28",706165:"29fb9c20af969ba2",706295:"abd0cd92b32a0f4a",706338:"5f410c6d6601be99",706366:"0faa86cb2368c325",706421:"27d0326875fae9e0",706663:"ea26ed2f92dba220",706702:"59e6b14dbb687b99",706763:"1e1bb3f2e23ce2e7",706785:"0e84716386c74325",707040:"976f88828a5af581",707084:"85c50cd6e98b4b03",707191:"c6c0cf49670ad2d9",707520:"2ac8c82785a63992",707687:"a20e74b2910b1e04",707729:"652cf9a751e898aa",707959:"af4910ddf8ea5c9c",708189:"dd3b302ccb705915",708660:"836160081a06fdae",708749:"1c18312160dd99e0",708832:"6358da7ad213cf72",708916:"a58a044ad8e03807",708945:"a536ff8d00019e3f",709479:"891c60312e6c6c6d",709495:"013bd587d511e2da",709592:"0461b9d74398828c",709675:"9cb5dbd271bdaa4d",709778:"04c68c23d4f63c13",709785:"8083314a9abab5df",709928:"e2e545dd3e2177a7",709962:"f5197b4372aaffd9",709976:"38131b46ddcc040a",710191:"1f31cc1ee604c638",710496:"0e0122afc5d0e49a",710631:"7fd7673cc93ed309",710787:"a8e911718c259bcc",710832:"1b6e16ac582a7c57",710881:"3a487c24e2ffd699",711340:"778c4cf554406297",711354:"39b9d271f5c3f236",711561:"79185c1a02b7f987",711690:"456b6a6f78edd68d",711743:"2290fd9d8c8a7abd",711762:"5ff3bb89122ebd45",712017:"b412c632cc98b1e5",712087:"db01ca19f8094c0f",712155:"bd16e970264057a5",712173:"c57b261a95ae1300",712610:"308244b77acbeeaa",712669:"e740e56f4bc7783f",712857:"353f4a0307c46567",713028:"91a9e7b436c25f6d",713077:"2aaa7e3b350986da",713279:"ca23dea2557b9eae",713307:"f041eb53f42cea95",713516:"f27c6e0bcc56c6be",713738:"c4e29577d4c5276d",713901:"e56a197a436cb9fc",714065:"77322977d6fbfeba",714073:"df3d44a992b534e3",714076:"c36a9934bfbac570",714079:"ce4d0e8c47e4a6f4",714260:"a95b82cffd24bf15",714421:"09ce0478df8443be",714653:"98cfa58222144235",714809:"34cf55e9fd6ba0cc",714914:"5ac84d65107c4ef2",714947:"20236ac38568003b",715013:"54585372ac962d16",715182:"22a6be63274c80c6",715229:"4920867810dd86b8",715271:"c1cd9b2cd810816f",715379:"13f21f913e91ba18",715469:"cad93edd5bc53793",715707:"336a7a1d2b3f77f3",715715:"9c7d52faba886f07",716110:"926b0f803db63581",716111:"b0312af4055286e0",716130:"b3bb2ba474985004",716151:"59ef4195de5a10e2",716170:"cf755c5b53ebcb2f",716185:"95194627997b4665",716313:"de0ed6e5f1682dbe",716316:"a76da3716e68397f",716550:"561ba7975fe8ac14",716572:"38d884c7d882c96c",716633:"07affe46b8c15a79",716687:"a270e2a06eed8f1e",716712:"dd9710686b9768df",716734:"320030cb5f243c3b",716743:"f4b325bddbeeaf11",717142:"a78b85ef1645f79f",717260:"abdc00158050b3b4",717268:"555641d8d2c921f9",717269:"c9a5694922adfc67",717421:"d17e447c26ac5cbb",717462:"0bb48e0a6fb1a799",717490:"8c40f9741d2d7e9b",717722:"79e9c7548ed06034",717758:"0f3c150eb29b9d31",718034:"507dd9b16e065404",718049:"5c4a34b4d14e8b21",718119:"9163cb5bd89e5c1a",718170:"2c4aba00a96877b0",718262:"8787578dcad2227d",718358:"9d166ebb6681e533",718392:"6f21a4ebf35907f0",718418:"4654a71fb5301eb9",718500:"429dd0b407e202a6",718815:"ad6f6a64f5bbac13",718884:"c15d324d2196e8c1",719080:"6169bb21f0903e91",719180:"c79f93776a46d417",719234:"71aa4505689f16fe",719560:"b2d50163741099dc",719582:"8fd5a6303ebf38ad",719678:"86a6446c61657239",719937:"2eb3e5321b1c633f",719997:"860c785c7c6977df",720041:"4ce98ee3f5e46722",720056:"1ed6d1a34cb5a5a7",720094:"36f768a209fc5aa9",720555:"68fdbcefe195e7bb",720674:"c7d00e89e90471c8",720718:"6b2ac0598e5f2d69",720765:"4ae9982ef882b91b",720828:"bdcc788b94108dee",720830:"421b279b022174b8",720944:"f1838a81e5133003",720962:"7ca727288b258322",720965:"f26912125f14c03f",721041:"adbeb0972e57c47c",721128:"5e5832034e482c64",721240:"9720372123d2db85",721346:"098741fe1dd9552b",722086:"273f83960d740466",722426:"9ca88c14c56917c5",722487:"eef0741fbe4d7cbf",722536:"4454540f032049f2",722761:"e5c457a4cc8f3108",722762:"86a283101d18a833",723040:"68238bfd0ea78fb8",723088:"c8bfd170c505abea",723099:"e3408f085cdb21e2",723113:"ffe2f17ca702f18c",723465:"93c99a0bf676ce83",723695:"689e595334b89621",723969:"2375e865a192aca0",723995:"fd25663d248cc642",724026:"922e69fe0c8301ca",724287:"f6bb0036887d682a",725153:"f045ffaf645b382a",725168:"aabfb6f6a0b5e939",725344:"ae4202a35ba5f837",725361:"e15a75feccaa7ca4",725454:"465789ba1bf9fb0f",725561:"024aba86f77af3a2",725579:"940073f7f6b57457",725621:"3d618251dc99296a",725745:"d2cad2c807579acf",725919:"7e9b03f36b331dd2",726096:"3702546710bed622",726189:"6879786a0dca4420",726324:"10a13ad799901842",726373:"8672b5e3bbb2c0e4",726445:"190a5e4c4ffb0f5f",726510:"00a5b9bc5368b45b",726553:"ab7abf71764af7f0",726717:"3989fc03ed63a505",726804:"06fbb23346d84ee6",726852:"8f1b234b4cff101d",726882:"85a7b8a43bef6be6",726909:"526ee1f86904f475",726921:"e07a72c8fbb7057f",726937:"f39ce5844d7310f5",727013:"d8447b7cdd6e33a3",727014:"65e91cee4d78bc01",727055:"97450dff755f15f2",727066:"8aff9ea057e5da87",727133:"b54d48ae327a13ad",727303:"904775492df18ad7",727335:"0e31ff0c549f89a5",727476:"244bfba6f139d5da",727513:"1f089914747ba76e",727767:"0cc28df126fb7ff5",727809:"014cbfdce5fa9680",727819:"a54df9c8afc4002a",727879:"06a4e32d5f586cec",728420:"e6adf9e05fcf9cf4",728584:"90ce360fe82c7495",728658:"269ae03daea196b8",728709:"6996090a75a1d7dd",728849:"b58fcbf88b49c494",728881:"c1eb221fb0939e3b",728961:"44f9d823c877a936",728992:"87a5ac5dea4f0a95",729025:"67d5db6d3d9fde30",729180:"e8860bfa08b096de",729284:"6501683568944f27",729614:"ce59907ca55651e6",729772:"0ec377146419eff3",729961:"811260c2678fce6a",73e4:"ed06dae708ea1bc6",730027:"024514942ee1921e",730041:"543e4623dfa65d1f",730112:"2a23e79682984591",730150:"11214d8e298ae918",730168:"bfb11e792ce371c7",730418:"b221b29c6a4b803a",730791:"3d488d3fe4f52865",730807:"51d23088744211b2",731094:"1dc0c7a73f6f2a37",731503:"40a8ad3364978b06",731538:"a823b511b22e9ce3",731760:"e814150239f405ae",731830:"fd0ec4af8c4e1fc7",731961:"be1c505030501bb0",732003:"c7a9184c6ead96c8",732093:"cb53aa1164642185",732126:"345133cc184ddfee",732154:"8934edd294196240",732214:"1f1847781e3190ed",732226:"acbb5aeef427ed46",732240:"4232af3013b26c76",732283:"1d1ea577e1470c42",732521:"e6c4dd20c8e543c8",732522:"13b1bf4df687057e",732571:"d4acce13cb49f2f2",732644:"9caee8a7b0cbe31e",732937:"82acdc96bede5a57",733146:"829cecfbab77844b",733206:"7cdd989db7108a9b",733269:"bb429a614edbf5b8",733401:"03ba4ac23b3d5ebb",733427:"f79e61986f70dd1c",733526:"f074ba683685854a",733580:"47d58d36a5e442ef",733806:"e0888633ab67eb31",733830:"f544596160009418",733885:"795ab13ae2fc077c",733899:"16c63971eaa4baf0",733924:"5a4e5c8cc4b6d94c",734054:"c1921d91849f86b4",734151:"1ca8033bca1f66b2",734244:"d6c74e4fb3781170",734602:"71abd97e7d7f3c45",734764:"3f01339b737e6b4e",734931:"872b8bea5ee35558",734949:"62cf3a05da848f9b",735063:"9e6c0a29141daed2",735309:"72ba424683611005",735342:"80e876465d80dacf",735457:"10679585c16aeafa",735512:"eb28a28e02d726f9",735529:"8033f4ddf5219072",735581:"98e5755b9b687873",735596:"6269f5a0ca8c7a60",735668:"0c13d88d26ed2ff0",735674:"42fc6bd91a1166cf",735677:"586b872f676a9e5d",735776:"01d4a02ecde37b3f",735788:"ffec71d4d9bebb95",735861:"ce437d96b70f6944",735874:"f8fd5a02d3cab2ea",736018:"64cfd15373a85c43",736050:"01b74e8896553adb",736151:"4eac48bb579c30dc",736173:"776d3a466bcfcb9c",736307:"c68824258be0ba89",736344:"9a39c53f42006876",736405:"d6d24a12df419bd5",736580:"35f7c70216524066",736583:"256a92b98d2dbe78",736585:"754fd091867b154d",736822:"043be1adcc6d9b5e",736870:"8b474cc168c4c362",737174:"fe3791e012f8e12d",737175:"5492a771d1799a31",737738:"024efd40722852b3",737744:"0d87cbfe5ce75afa",737813:"504a37d6628338d2",737920:"d1bff544489b9593",738057:"0def567c9a1e96da",738078:"951c719b05aa8b96",738088:"7efa764e64406dca",738089:"5bab98c5a2070391",738288:"4b81696998c039f1",738368:"69c8868512c880d3",738464:"7c4d11b8d966d722",738562:"b97a6fd762f810d9",738564:"d2c04a04c6ba297b",738623:"bac820d8f0c0d0a2",738694:"6397d7f08964c498",738777:"ecc8cf3aea3a612d",739064:"d555dd652bbb70f9",739113:"263f4b1ad35d3e33",739182:"37665b0bd0ccfe5d",739192:"87f4c546078b56c9",739245:"7efae51e49b816dd",739253:"00fd32d7deaf9bec",739281:"88b2c611d103b2de",739288:"d6782763aebd9b11",739577:"0eaa6bb9d9a54fca",739657:"92b56bff72bca3a6",739751:"a7b40b46a7fdde6d",739791:"04b439426427cb96",739823:"5b97b763a37cb072",740083:"57129c2ea3085906",740114:"1775fae6a0d4b1aa",740278:"2227213870e1342d",740324:"687e9cf7611adaf5",740366:"bed52675454c6043",740436:"cf34b60a372d3917",740802:"0309385662b81c62",740851:"b8fb94ce5928ad97",740868:"d1eecfea2e0ea736",741014:"13dbd2b1d5342bfb",741127:"5b854d7f8c24c5e2",741149:"03afc08f1d2afd03",741200:"8db12bbc86f32ae5",741249:"a16e70ca20a51775",741333:"5df1f1f25cc57ddb",741513:"224b25b5813ced7d",741606:"5866c08c82e6775f",741824:"9c9732f281c6ce3e",741880:"d24342c9780e4afa",742051:"3c024a525f06beb8",742104:"31b6237caf1d8b29",742122:"ebf9b57de52f9f04",742241:"0a02e7ffb877acbb",742261:"fc781fa54b36bed3",742262:"497a4ad619801a1b",742297:"d2a6f3276c1fa351",742450:"6007378f0626f707",742465:"c132f66a36fc2013",742705:"57080304dd39f24f",742843:"baddcfe8858e604c",742925:"44f298c3a9f871a8",742981:"e76d0092528cabd5",742986:"2247cbda76b7006e",743081:"6c2f0191b8589811",743251:"aed32a32a18c40de",743583:"85e56c1d8e029a6f",743719:"dd1740db2331b72a",743744:"4c512164b77a21dc",743783:"eefbbc12139a3090",743811:"b8d9507c0f596491",744140:"9a67f9fa9c7bbff2",744319:"8167d9abe442611b",744334:"26827319edb70cc3",744357:"04f005d6d398bd79",744551:"088a820c38bcd566",744672:"dd2e1f412e27ea32",744746:"2641f6f6786d0efa",744957:"c599a3e420d4309a",744963:"e6af370440528822",745022:"cbba0400f6841a85",745116:"a6fac115495ba8d9",745250:"c8abef7853951e16",745404:"6436a6971d96eb36",745474:"e3c41affcfcc9248",745513:"e6cdcf88254b6e66",745692:"dfab461003005fb6",745695:"6d93153d03a65915",745772:"12fdc0bf2e09989d",746155:"81b173f33903260b",746169:"a4323e5d4b0dd1b0",746300:"5e69e2a91e377828",746303:"be824dcb9e2a93af",746428:"8b63c27d5efa6887",746520:"03d53af3c228cbec",746685:"46356ab2067127b0",746774:"d8633a7d2e7ba61d",746979:"23bf356223e867cd",747131:"2f702356a59212fc",747139:"c2600fb722947e27",747579:"8c6ab57a14046cbb",747715:"ab5c92b21a282e88",747762:"3c3c056aae1585e5",747765:"e7a87ac2d08f99fe",747958:"6f810168a352d7d8",748032:"07dad5d9a11eec6f",748167:"dec04ba3cf1981da",748307:"967bbc732f843c3f",748309:"fc05a255e16d8f2f",748338:"75b417728ca8bb6d",748403:"da972e4483f36c9a",748575:"b6f55ebfd12ed5b5",749317:"22f9315f356abc2e",749502:"28c02983c5fff098",749612:"c4e8e138335a1635",749687:"0ac4a72c8ef263cb",749871:"828aff2fd0a80b2f",749959:"251c9ed1fd660acf",749962:"37cf8f6c7ad8219b",749971:"35e442836e27fb84",750054:"22e75a04f9880fa8",750392:"7941c1f3b795c782",750676:"d77b720ad92124b1",750948:"f18784a1b3f219c2",751041:"1fe7f95a8674e77f",751181:"0b366d8955ee0425",751221:"173a07d7cbdfef4c",751309:"e3043af2c7097c36",751484:"09dafc3823e48d59",751534:"f2f2bf82d8038227",751661:"651c6b8456c537d1",751667:"ad190d396b5dc07d",751744:"a78a63649455ea06",751856:"2c1d6f92075281c4",751949:"1e1f5a324ae7a25c",752130:"9bb206490f45665b",752226:"7a53b529ffe5ea33",752388:"99786b027e8bd8e3",752426:"cc8348df5f167f27",752567:"c7d357cd7f03c9d1",752866:"f9625be51b6fb9d9",752908:"fdae26519f16d80f",753029:"a336398768649a5c",753113:"fc903171a0d37507",753319:"4c1204cc038bc854",753332:"19988570c50ef297",753596:"729334cc378a00ee",753678:"8a2da09dc7952761",754106:"d5a661e36766c25c",754273:"e158fdd3faee3525",754294:"c4b7fae8d5c9c5d4",754309:"9eee34bd61085d25",754384:"73613f5ed64b54db",754386:"88e5165881ef0b49",754409:"ee99f3ea27acb01d",754432:"207bfa0f1b87b6bf",754447:"aaa361fa93cfe686",754743:"5fcb1b5da2931fb9",754805:"1b6eb67f04980a0d",754955:"d32930f1f3c821f2",755090:"f95b2e87c1443f51",755279:"293d907aaa26bf8f",755294:"60b605a7476dcb22",755406:"a99935fada11fa6a",755519:"d559a68377b6b21a",755649:"b47ec8463b0c58aa",755671:"c06736670398a0a1",755697:"3ad69911a63730fd",755703:"b846ad5a04d251e4",755720:"1517bee838b1ce9f",755728:"4e3643815906bc5a",755732:"d7d505b23c7e1a3f",755859:"78dc2a46dd7e3661",755905:"0ddc7705df3b5416",756171:"3a7a541c3aa11024",756244:"9c771611edfca6a1",756291:"31009afebba9653b",756300:"eb12aa544dbe3f9a",756335:"e05dceb7a868c679",756387:"d83924378206700b",756425:"d21d023a288e9c34",756585:"96be81965015a78a",756590:"c353561ef873074a",756880:"58067c1b49c780d7",757595:"5de9254e3b6373d3",757628:"dab261d09edc44cb",757912:"7a9ac22644817352",758095:"beb896f154b94e48",758206:"5642fb5679211f6b",758371:"6fad133ce5e91501",758755:"e59d04f50cffe83a",758817:"52b24d39f366f7b5",759073:"a367e5a4a0757291",759082:"7781d883d5fe50be",759084:"a1b918f93b3aa7d6",759124:"cf8a3768e1d17faf",759214:"55bbcab0600fd8f0",759238:"fcc2d5820257efa6",759442:"7ee252773d7bf72d",759478:"ebb21e0955fe5b83",759493:"f1ee142f3df369ae",759836:"6dc9721cb43a02ae",759867:"76ca68bc38a64775",760081:"12372a11e639fe0d",760200:"5139de5ee52ed2b8",760262:"8b0f9e97a09fc94a",760500:"a081c3f3e3136fa0",760569:"88cb974716e2efca",760712:"88ca2cdbfe53d553",760728:"335aad3b1a48165d",761014:"8f5616f4195efd07",761033:"1c109ad99bc23d7e",761242:"c0962c8855cfba01",761269:"ec663b4944ca5e32",761286:"b2ca8f2e6b72ecef",761397:"933356621e5629f9",761522:"688bf2752ddcfa0e",761548:"af79d412214743f1",761587:"54b3ad4b7f2ea9a3",761620:"5d7ec4893092b5a6",761889:"c7f93ae327f83c4a",761906:"f602235fdcbb80fc",761944:"0ae5a87dc86f46b7",761953:"2e7925fb56052088",762058:"b88a6a7b3cf075e6",762151:"39bafd8edab4f362",762198:"1daa8e555bc7a6a6",762498:"7572ae1bb565c64f",762526:"6a208b4fde14124b",762674:"39b0ca71c029fb20",762722:"69b715f68e99ba41",762771:"fac46e216e5567b7",762856:"daa6cf236edb43d1",763140:"0b88850174dbce26",763213:"f8c4885bf817cfbb",763572:"33d1b5886d3c5a85",763661:"70e3d5159177c83f",763664:"b2b18d61001f9e18",763702:"ff979cf1b781379e",764e3:"1531643cfcfb37b8",764055:"11c30ef19b491210",764100:"c90870bc5d9c352f",764297:"c9706c7c4c250f79",764419:"00e50b53b447f19c",764722:"2530ad53d12e5089",764816:"57725fd56c4911d2",764855:"50547f1ea13a56ac",764980:"e6af7d3c157b7d69",765101:"8d70eed0987c37bd",765160:"28eeb7a40e9e2fd8",765294:"dcf82dbf5301688d",765331:"47c2928ea48b7281",765593:"ef431e4f04c523a4",765645:"38d2e61ed511c8c2",765745:"7d295a1400b3cbf2",766555:"b413f1cb8a009ff3",766558:"5ba1ce6dc33e4589",766724:"b06754e2d7059bcd",766789:"552b0a1b2d4e280d",766968:"9100b8d725f3a628",767200:"9ea718a6b8f15cb9",767218:"b2810325b0584728",767266:"f6c37aadd1b2e6ca",767378:"c58634b178b0f7b0",767456:"49c2a8fc5651e61c",767650:"4fb93ba51948e66d",767655:"4c5f2beb8ba5fbdc",767937:"7e9b14e8499ba1f6",767948:"7098dc7302e794e1",767973:"3ae7b5615718e0f7",768046:"f105a3ad753766b6",768229:"e885da267b645bad",768262:"3070e05f09b414a4",768407:"4af878193ef14c6d",768475:"d63c66f5f67574bc",768556:"76d774e51ec1d4e0",768731:"33644adb61d10435",768817:"16216b1214b53348",768866:"2bbdabb42b85f3e1",769048:"cee0e02dd8b89909",769167:"11748ff92eb91b2d",769315:"56fb122a93ed49b4",769346:"85cefd13459917c7",769415:"0445b44b6a950e67",769490:"c72f87f5732cbc4b",769614:"333aeae50d42c485",769626:"8300f424320466d4",769675:"df46078a5f01d76b",769941:"08c0ed904da129b5",770078:"fbcbf83f390a35e1",770216:"4587ea6e30b2d6b0",770326:"746182b371a40b17",770357:"67d0266cfcbe30dd",770411:"7d5e5d02449afa39",770498:"0b5c5fb88c2997b1",770613:"41fa20d8cd0d1068",770616:"9663bf5e3328bea1",770646:"a4bd380bff4f4bbf",770662:"f10c3922ac2bd75d",770682:"c2df52564876baf4",770706:"1cf0e0c6c9f9c541",770778:"085c21a7ac7e0ae9",770957:"fb1905c97834e4f1",771211:"f7ae27752e354e28",771351:"30fa0b169048406f",771401:"03b231e1e81a9fc6",771733:"e59e1e5408404f2b",771767:"955cdf5c51d82bbb",771880:"45bf4c20f333eab6",772287:"4d6922f45a964707",772618:"c64a325a212c71da",772704:"c577dd93b5433e05",772813:"0d90daad0348b6de",773155:"bda5d8624a72063b",773282:"00137563056e5705",773343:"22e1dff6b1240817",773449:"e88282dd19992456",773469:"17e351194e360b35",773546:"16ac9026560ff484",773622:"37dbee6567fe53b0",773716:"a3ef8c71741615ab",773873:"3177f272306e7f60",773969:"b40e45ef4ecfe177",773974:"b4234c7b83c0f254",773998:"bc69122c4f5f8825",774054:"ee44a3875bff8c76",774180:"4a51bba3d352ac9c",774443:"227d6d21799d2fe4",774675:"96113aeda38759a5",774689:"f3f1cd078d6966a3",774799:"74dd0c9124d003f1",774922:"f72be6420e9821a1",774924:"d32aa8c1110ec8d1",774933:"633cc44167f7e241",774952:"28acdbd3c0d5cc0c",775039:"641d0797c7274fe6",775141:"d0d5c706fd35b4a3",775196:"274bf5125b8cd2de",775341:"0ed4346027a38639",775557:"82abbbc883ee5dae",775622:"8c9c53d31a4a4634",775805:"18b8df8bf7b94a7f",775860:"9c57c923791eb8ae",775863:"e3a85d20ca23e260",775950:"d16a5216faaed82c",776103:"ff4f57eab38dcbf4",776502:"c16bfd6aecbaab2d",776507:"27791d528439e48e",776755:"fe524a233e677cb4",776805:"15fb39d9ac9ed6ea",776900:"fe04e5cb8c110e06",776945:"cf84382e217c184d",777093:"e64538edf9c13082",777253:"4b0997ff988fa60e",777340:"6091bab157b7e352",777418:"effa2cb4fb67eebe",777618:"29d0a98d067655d6",777649:"5cc3ed14931cb34f",777685:"05b689f29fe746c2",777752:"17eb5e1d88c7b3b6",778013:"890a64380554d965",778516:"ed559b00c85ce4b0",778561:"752fac5747f77d75",778592:"e9282a763bd06f5c",778709:"9c5431efd46b2ed5",778823:"857a47358632542d",779041:"2087047a05354ffe",779221:"078d9beae2220236",779406:"da51a75bbab2eec6",779456:"58c60d4143eecfc3",779737:"c64633469cc1897d",779814:"c0cf952b99980416",779920:"56eabaac85433d44",780163:"bb3653193324c8ae",780174:"745ca3b22408edfc",780192:"d746ea1a4a694547",780364:"b2851a8de51aa736",780487:"d2ec40a36b5573d5",780511:"39de99206f0b2617",780563:"1a3d993119af4cdf",780579:"d1b016cb3f690fa2",780694:"0cdeb67c7124de1a",780924:"e07c458a00e6be22",781026:"aeb82eb7e6629c53",781676:"a735a9a5b8d09a19",781677:"8f74b90c14b97bc0",781738:"40b74267779ce268",781787:"093f07aac88149df",782096:"af42ccdf418d5056",782107:"e903e241ec21664b",782245:"87a5ef985897aac6",782570:"e2ff663da8aa23e8",782685:"61707422ed1a4ae8",782687:"8f574c9b43bea877",782767:"c21ffef6250d2f80",782891:"ade9af6313056976",783047:"2b9a015d39bd79be",783178:"a16c179b0857109c",783403:"e5132a0a36c277c1",783404:"21639d7c322f2bc8",783415:"dc2308f4135660cb",783591:"90b01da13c17f0c8",783668:"ab2454de5a5eab9f",783914:"00d17218925ab7a4",783969:"eb4579d16f48dc03",784071:"743fa714bc9c384b",784083:"776bd1c38caa409d",784105:"918b9eb63d9db680",784138:"c64990d7c916fc11",784676:"760133996a758c8a",784801:"77355dac9a1154e8",784898:"d7fc5fcc5e87268d",784899:"2009a07fe5458bde",785175:"439268bc631935f6",785486:"40a52ecb7a06fcf9",785617:"4879ab0d2cd76bd6",785769:"8f04ac46600a848f",785873:"2085601abbf5561a",786260:"76026cf272635ec3",786331:"ded6f4fcc527f293",786363:"b98ed3d107c58c62",786389:"df6f0ed01bbaf636",786694:"455809b01802a8b3",786697:"614ab1d5f4b0a257",786910:"c93b17154bdd0340",787085:"4c13b9626ce0fa7c",787227:"042bbf5ce3ddc645",787349:"3f88930887e87172",787370:"2bb775e0f058950a",787480:"7b1031ee2b11df26",787581:"da153d1284709561",787657:"51bc18d701dd3757",787961:"5cff67da946e0fb4",788002:"30e552a098420c89",788211:"560e16211b2dc7fc",788273:"57c601fa027c21d2",788316:"01aa1e0cab9cca8a",788695:"54f4b19a55a4de36",788726:"6cba378ff57e58e8",788890:"81793520af06510f",789071:"2746b2efddadff03",789162:"a2088a863b58111c",789266:"e4c75d5484344ac2",789824:"9174c4a2aae1c67f",789992:"441e5ef091f9862c",790115:"da9deb60f0e8d70d",790449:"5d96fae74339d08e",790546:"5cac956d86c54f1e",790752:"8d99270310dd013f",790788:"80f8a3b07781bf56",790938:"7cc981aa457316c0",791093:"e1cd74f5d44751fd",791118:"370969f9b5ad0c35",791224:"042d4f0584376944",791405:"b6509b7977cbb463",791530:"8bece0de6e58e3fe",791690:"85d6a8092c63f038",791742:"29231cd0e38b6441",791753:"7a2a8a3d2cfcc6e4",791761:"2ebe0440d0f0346f",791789:"257e91964a20820d",791794:"13a16066f4dab867",791911:"415a69136571fbdc",792146:"3a3b7551b4469ad8",792523:"e8414469ddd34ee1",792615:"07e21c3910be5e36",792645:"2590fd9232925e98",792725:"e885079ad4c417cb",792821:"b980491e808d12ee",792876:"ac9a9ec8d386424b",793180:"3613c5551a0ff219",793266:"33f0b2fec2a121c2",793399:"be6809c6a0bc245d",793477:"dba9345be0ac114d",793518:"9af58c089b01c1f9",793546:"0b2c7adf98f5a025",793572:"a0d94bec597d5930",793573:"c6763bb87ff93bca",793631:"d8ba560fa99cff02",793653:"ad1d96fbc3fd795c",793716:"39e6efa87a7ea6b7",793742:"9cafac305d0e37b5",793800:"777252683293a25b",793844:"672f48db501c80de",794079:"603f6f5e4ede6ca2",794114:"f613a2556d3b5a75",794159:"e53401861b8d6401",794166:"1044c0a2ae5e6a90",794282:"4093d26386d9d11a",794334:"6acb6f57defa99d3",794395:"024e29dc7f9e99b9",794694:"864eb59e332522a3",794780:"3c3fd861a85f7fa9",794826:"fc356404fe57ba6b",795037:"be2244858bff2d12",795061:"8829282127132531",795079:"07bc899dae5435d3",795121:"6b43ff88985f77b9",795282:"aa68b58f1b595967",795341:"1e67752609b4fa5f",795424:"6c8fb614c838306b",796014:"36e8bd52c426c73e",796078:"0ebbf2768764f3a2",796387:"3087cf783324c338",796766:"1d0b4412658c2809",796795:"4edc4d5c3c7a8b04",797003:"78d6db965e2309d3",797113:"5c181220161fc7a8",797124:"be15db969a1841f0",797149:"ed2e311f1b1b1e94",797153:"0ace0197b21df220",797209:"b371caa571d8c786",797433:"802419fecf63011a",797628:"20ddd792f0e43a74",797638:"9090bad824a0b56d",797834:"491b06b61b1dd7ec",798176:"a35bcb334164e0ec",798182:"aaaefbb8e0099905",798392:"e2e0ad47046132d9",798397:"eace75dea47312ea",798498:"89ce1955be7b8615",798510:"f0f176785dd305bc",798877:"f28071fe1445f96d",798880:"11dec6269751ff8d",799463:"3fecb6e0fdf515ad",799487:"6458ecbefe361149",799610:"2cf4c7593d2fa868",799666:"4b8f9c2d776d1546",799793:"030bd942e702be05",799905:"cda797cd2842f66b",800106:"444eb3bafbe75561",800393:"d9a3dbecc0fd0421",800481:"2f5713a74690c4e2",800502:"7439f4bf266aa46b",800531:"75a4bd3d858e9882",800682:"651d5e48935ce463",800691:"6f1bd88ec05d905f",800692:"73affe8c2d44ded3",801173:"db36954cc10e9e23",801218:"eb6f539e1d295ef8",801258:"7ebaa0aea876fd4d",801299:"ea66a9fa7c05e09b",801518:"78e59acbcd04407a",802050:"4d8c299f4116b3a8",802054:"2c59a7b455e807cc",802297:"549aad6f574fbb84",802365:"98766117279ea776",802378:"dfd02766466814d5",802772:"393f9cb99b126e2c",802859:"705d9831a7d8aaf9",802907:"326dfcac43a15295",802989:"9355c64ace1044f2",803061:"2f5942421a440776",803291:"80ea3d0bfc6d4a28",803367:"f868165e5d592fdd",803388:"bee8830351d7d77c",803475:"0e436b07b086bdbb",803481:"26eab7b8a9a2fc5d",803482:"f2d5bf975086ebc3",803591:"ef30e7cceb92bdad",803625:"0df6b917bf5f2a12",803698:"d46ce08ad2270123",803756:"5cb51bddfb82ead5",803841:"e674d37844167be8",803891:"d226a7ebfb3984c4",803959:"0c849e96a14159b9",804328:"3679c4956f5ced8a",804370:"86d4013954e897d9",804534:"088a6c845705f49e",804674:"2cbeaafd46242af1",804686:"9b6ec66785a38f5f",804734:"2f7f09f1f1214eb5",805034:"bc53b679ecf7fb64",805131:"e1d062294432307f",805136:"2d15e94c3649144e",805157:"96ecc99aa8983623",805203:"15049c5b0745acf0",805430:"33cbffc697c97e4c",805674:"6e9739e1187598ee",805794:"8ac9f796b42bea48",805842:"81bdfbd3d20c8f2b",805887:"ba5618cb5fb24e29",805914:"eada6f363460576a",806382:"ed51fa6f7cca86e5",806409:"7103e3cfeb166508",806582:"9c777e3f04e06d4f",806792:"b4155e09f7250580",806994:"4c01f9ac08da309e",807072:"421b51f690c07668",807102:"56d99a535d2a208a",807178:"85ade337167893c7",807292:"f5f8091e2cba2a1e",807618:"2637e2a1d18d972e",807669:"339a011db176360d",807945:"af3cf5da370f0cba",807971:"eaf46a93c9bee22a",807978:"6f58c0de2579207e",808277:"85dfa92e3776ad65",808289:"a397e9a421cb3d14",808338:"1b6f004ffec3f950",808376:"1cc39d2954629c77",808421:"676d5f64b552eec2",808589:"c76369f28df3435c",808712:"1f00561273892cee",808744:"f4ad8a776b9f709f",809170:"6d4fa5eaf4ac0fe7",809193:"8db5591671c6e22b",809257:"b8e02b10d68c5662",809264:"5d91a14c5daaa568",809287:"90639f81ede61e3c",809440:"912216559392c5b6",809587:"2032c275aa48c398",809809:"df94cce068a8d4d4",809820:"d183eafe9412d94d",810016:"d81c51865a57817a",810170:"169c19a1c5d5e5c8",810222:"eb4de3fdfe89069e",810333:"7d8e7baea2b871ac",810831:"3201f97b95c1dd59",810882:"503abfb64f985e41",811016:"d23de54737e63e60",811128:"3cff882d06c8822b",811133:"53af9814e2ee39ef",811511:"fde38b885962cd67",811878:"947ecaa0ad002d5e",811902:"6204e76d2f01ae66",811974:"90ed04d6fa50185d",812044:"c2ab9104c93b7202",812086:"f302b0f4c412e208",812099:"459e486e0e0095e3",812118:"6bdbc146df428c93",812126:"5aa50dc8a05fb41a",812188:"74174e9aeb22fa13",812190:"42e6ca9200972112",812223:"9e27405f4eaad694",812289:"dd7d70c1adfe61a5",812321:"53404d5f846c38b5",812447:"61c5906dc03c32bc",812695:"46f015ffa82e36ea",812701:"949084415202f65b",812827:"c71dcbcadbc4f93b",812910:"0fd2a852172c629f",812946:"bed21b57696e0872",813129:"29177cc9de7e9059",813177:"4ef3951d89e9819e",813204:"b48c5619033c87d9",813584:"90ce70b2482bdc1a",813642:"aee64de98faf1188",813658:"11679aa511da42ff",813665:"3e7bdd110f4736af",813769:"6fdf35db4e3d4050",813881:"766d1ff58c075a5d",814014:"8b2400f61da427a9",814043:"6829188f9e785217",814183:"5145172e8076e773",814199:"fc43fa2784642c43",814298:"a81e7c336ec3c863",814318:"58a7bf1ed98fb695",814408:"60068fdec6c7f376",814453:"a9693b1543f2de09",814503:"416533a5925ad53a",814557:"1f76989184a8fabc",814644:"5165d68bbfe05598",815155:"be85585e1df12eb3",815182:"5949da08ce3d2205",815281:"ec97ed57ba7ae5a9",815301:"4cb1d2d70b448213",815451:"496ad264d69c710f",815463:"1dd5c0aa37560f2e",815468:"c6bfcca20514a420",815633:"90946955b89387d8",815793:"6ab50b44e92e0852",815923:"6645f8774500f1e5",815983:"2b160e00f2d2d64c",815985:"5939f1eca6f8e736",816113:"6e214af4869fa911",816180:"3fddbcff02bd0484",816287:"e1fd6bc4a9ce2b79",816299:"ba4414fa871815fa",816436:"29ca3c5088a7f3d9",816523:"159151f06c3e548f",816611:"28db6c1bfcbf40f3",816644:"0d2e519e7734e44e",816702:"959d39ad28abecb0",816733:"f7aee1a91397c115",816877:"e89c3efc4fd98b53",816981:"e40a3b04b41e5fe8",816986:"345659f28dea31d4",817037:"a70a10a5e70126d6",817118:"31906aeb5151e99c",817222:"ddc94d56b2aca55b",817233:"c9ece40d9373df5a",817400:"9efd5d560353bf4b",817746:"d4377a7d2a7e67d6",817791:"6b2861a6580ca77e",817896:"95f91afe6f0776cf",817926:"3c461deacb3ff8ac",818015:"860369eb433516ee",818102:"8733d02f0e7f79a3",818155:"a863600c31bdf09c",818166:"bf38c427af45f104",818344:"d0c07fc6146e8414",818773:"ebb50d77b321ec17",819210:"9ec1bfaf81746c68",819211:"116f3ab871f19db6",819277:"a839cbe0b3c98b6b",819416:"99376eab9e75dc02",819433:"0f83d5d9bc0ada42",819451:"1dbab1e8037ff51a",819632:"a55b42618880f09b",819890:"6a4d71a7d736379c",819918:"62c4ade43b52f4ad",820004:"252460cd4da02c26",820048:"4639d6a8fb4cc95f",820293:"395d6c94fe313a95",820464:"d229c06eaeef0649",820516:"04dbe9589bb8a69c",820672:"5a9df9c71fa5a220",821074:"37a8e4fa12b2ad06",821181:"03dda17e6ef3d083",821202:"88164b755a150449",821319:"075b41fc849dca53",821475:"680a113317d9ed43",821567:"2b1456b0ba9e3200",821706:"a7ce177f02790082",821714:"818836c649435dec",821836:"4a62979890b265c1",821864:"18fda4633611c040",821945:"f5f97759df6051e9",822114:"8616b7d28ae47ba1",822166:"36e5a2152df09c76",822245:"5c62d26dc6f6f59c",822399:"4e2e3961e8ece608",822447:"b010c855c69b20a4",822956:"ff9aecdca289ae87",823029:"d996d02ce402d446",823207:"4874d2c72c81765a",823263:"c5aeb405c8175d59",823275:"39ca320c96ea2e0e",823394:"948eac17621be3dd",823506:"e583adb28c65aada",823511:"3158d0a61355b468",823531:"cb6262a6a0dca608",823654:"b6f22ff0ef51a9ad",823921:"c8fa80e3afd21497",824610:"4c3974142232ce92",824671:"54de0b1ccc2d2f4f",824842:"bee75c6e65365b41",824888:"dfa64590ef4057cf",824938:"2d7290dda04acd03",824966:"b3defbf28d2ad8be",825066:"c4b977d2bc715bde",825188:"fa2de4b190573171",825268:"efe8bd12564b43aa",825477:"78957134f9b13830",825659:"01562b478a651c02",825779:"4f6c558b68fb8224",825948:"59d544d592a8e9be",825970:"762e7c97a21b930b",826020:"7fe61d8832c752e0",826044:"9757c6ec42543736",826310:"958ab3b2ca42e8c7",826703:"1acc5f27a6425a4b",826844:"e416a0b87e29f1c5",826930:"657ec42fbe89e225",826981:"5e1200c088e5d5b7",827005:"11428efb04f3d86e",827106:"97a37e4ee43929d6",827168:"10d18db170909bcc",827187:"a9d7591d9db3e077",827400:"0872212359ad0d4d",827403:"c53b38868351f317",827404:"ae3b714f1180b0ba",827594:"874a116e25a11f2c",827852:"bb5cdd4958c09e3b",827947:"9bdaf29936b3a372",827986:"b12586257ac2b06b",828048:"544300f513c6e7d1",828052:"fce7a03d7fb4fbdc",828134:"ecd1ff2227a79715",829089:"02783d60a55ee403",829144:"5d533a8195d3a5b6",829150:"34a987445af4f39c",829311:"c266f5e9bf45747a",829602:"364c0c4bacfc67a9",829722:"9d49dc0be0e65970",829831:"45431ec650fa5756",829881:"f0e2abbdf7c5dc1b",829924:"8fd086396977a557",829970:"2ee57c1f2b41a539",830208:"44f96a71a5539f90",830338:"7732dd29a555cde1",830535:"3430ef317f0b45bb",830721:"8291adddae83c87f",830755:"5292ba94d4a8011c",830909:"9c5ca9530ef3a40d",830964:"98bb036bbb0adee5",831e3:"0546668efe785b63",831046:"4f1e5b8168b3e762",831081:"e08a35392fc59e29",831103:"e3bfbd7f43a12c0e",831192:"442a5ab96efe590a",831240:"745d6417b07127a1",831257:"1c9052692d69c9dd",831267:"dfd14857155e826d",831367:"30cace795e9396cd",831388:"7774db22976963cd",831618:"ce01b177f3f1f414",831664:"1255d010c3dc5e2f",831670:"5d47776e530cff6f",831722:"59232c3358d38012",831892:"e0174863f0194029",831992:"7aac14ffcdde7b3c",832023:"c7a8a002dd2f6047",832057:"8cb2330491fc1898",832141:"aceedc9829de72ad",832260:"fe731e703a8fbc0c",832306:"e3543d4e9e1391ec",832422:"e56f47d170e68a0b",832506:"ce3fe2f7bae56a60",832611:"c76d27be8e7cefea",832717:"028e0e682588454a",832732:"283be510cad60188",832740:"c7ec95a9de687850",832820:"57bcb74eb053a666",832841:"e11c171ba64fcaf7",833131:"e76f4c3dbfdde9a0",833467:"3b5e8a6df7feebe6",833513:"9e6a8e4c999c1e70",833885:"dffd288e40f59b8c",833923:"9263344ab52deced",834073:"f701baaf7d29d2e6",834117:"84e5d808aa06ac7d",834439:"181ee159678369ac",834544:"cdaf4ac8abc87b49",834568:"2d1ffa4f827aaf22",834595:"805fd4a07d6d213f",834651:"d658ef9c0101f7e0",834667:"471781fb35b625e0",834967:"6b306d5309ac5b6f",835066:"26a92f54438b6ed4",835208:"a7a848fbc05c89ed",835221:"541b3e05a8afa71f",835223:"6e0a8bea4c01c018",835235:"6c8876544aea19f0",835241:"88d952c6ed3b58ca",835268:"077e7cd3580c5461",835503:"624ad54dd42c3347",835509:"71b63419c6e6c52a",835579:"332864049bdf883c",835588:"ddcfeb20fd3ac742",835630:"26a42c32a9358216",835922:"186310b5124fc49f",835949:"df96ff331c2badb3",836005:"f10b7219f7517180",836010:"e4aa6bf97bf45ceb",836179:"83673f41dedcbf42",836276:"5ee112a44a98e8d9",836291:"348873f1d2c76606",836815:"263f2ad185a610bd",837108:"5d4500cfaa26e1e1",837260:"8dc4f4e18d51c803",837437:"22a53887e1d30b7e",837860:"2f4558dbee012b21",837863:"b25dce2af2db00b2",837952:"c7ff4ab0ece657e6",838018:"0613c57e97e0dc51",838116:"6c91f82856028ba4",838171:"ae17673fdaa994d5",838311:"8fc11b9ce827affa",838313:"22885652e5eb5e25",838373:"d242950f8c625441",838377:"dd75cff29c561710",838429:"afb6d1ba88051331",838531:"50e6ce72f702b37d",839029:"92d7d1b8f1414ce9",839180:"acd9a8d56d172b1c",839247:"5535a2fea4db69c3",839254:"f0f032f82105254d",839399:"54546ad7ed2cb812",839412:"4d8b7d048ecf054a",839675:"1239134b2efc3b4c",839716:"3ee99ec93a41b2ec",839966:"b63e92d526e3e290",839990:"74790d2cdcd4fb03",840015:"25e8ac4e876c83ef",840068:"7e2a36dd23beffc8",840174:"c082347ae8a51d47",840177:"d4daf0cc5ae3fd0a",840209:"f4b8df5e911cbb6a",840278:"e852304b63361c57",840298:"92d4865ff7507d15",840333:"95fd0215a12b5a35",840409:"7af6622b233b4248",840596:"0d4a10580ec2c13b",840651:"43e4f40fe916905c",840684:"b40456ad4ad05398",840813:"a24866a3f5889108",840829:"afdd53fcd7a7f280",841316:"247fc86aa74856f6",841391:"33110d65fee81f87",841525:"cab9f5dc6534717d",841817:"b6c883060c18aba4",841992:"aec77d95075faf27",842088:"865ad894866f261c",842214:"192804ffb3a12469",842319:"eb1a074c88cef92b",842336:"d948bdc9fbe2dc06",842562:"8ac94f04398a7122",842573:"b68448743b904496",842583:"c7aa3dba57177ee2",842659:"cf3167a0a424a4be",842859:"efc556fca42063ea",843118:"65398b8e5e2e6204",843596:"6151d4ca5b42579d",843714:"d137a842791eb6e1",843953:"07c93c59835d5807",844015:"c596802677f93889",844070:"fb2e4d9fbcff1a84",844129:"38c85bf857df9ea0",844329:"cccb2ee0a16aa590",844473:"8e84f1b2661c096f",844563:"846557a330f4554c",844596:"b56a321dfb79408c",844607:"51586fba09e3e98d",844630:"a8ebde27b8d35f64",844807:"22be177733f7723a",844812:"8f7551c427e67d4b",844976:"b12241ec3171e6db",844988:"ec5a8dd664daaaf8",845302:"0b6c4999885bf46d",845330:"635665ced8b97be1",845362:"f7dd109d8db311bc",845437:"f7edba127494c852",845470:"9cc9a6442417bb67",845550:"e6ee50901fa03e7c",845665:"e20b6ad6d21c0f08",845699:"cff0f66a8ab31cd6",845702:"efb5498e9974a9b3",845906:"b326739432b0dbec",846261:"ba62694758a8778a",846266:"4ca428f0e650b2e3",846325:"aefd58e2b4f33a7f",846369:"c2350a527f50ff02",846378:"86ff79acb8ed2912",846493:"edd9ffaf75082fc1",846497:"da9e316347a5fa7d",846499:"6cf5f43fe1836c74",846501:"975edb2886318499",846532:"63c1a27ba353b6cd",846534:"72f9623cb5b04778",846552:"2052a9b6eabf2e32",846650:"8bb2c1730ffc991e",846730:"d0d53c0a0c7662c2",846736:"010aaa74545b9f5e",846752:"85ac48985a8f1cb2",847318:"ad9de1c91ed1358c",847336:"f621829a530c5a6c",847398:"45a04772d801b9c6",847401:"4fcf4f8d4e05acdb",847819:"23b1334719a0ad6e",847834:"6b1435db6df47029",847885:"ffc5af2f50ca7a22",847947:"fbecb7a12ea2ede7",848094:"f84611d6f25ae680",848129:"70e0486dbb05e44a",848219:"d1998e62b2e13cac",848366:"5b8a2080506d47fd",848450:"0641a52ffbf50dab",848522:"4de1ce7cd18add1b",848640:"825f9a51b2cd9e5d",848646:"8bbe2aeb835af45c",848912:"cdde5495d6779096",848943:"6a6ac2461c83c893",848954:"77d4458247e3975d",848979:"698c60a663e1a323",849027:"db6b7aca81c88075",849122:"7c024b5d84ef570d",849223:"6530ee04f2500260",849310:"37422de577150371",849331:"1eeb3b4065426d77",849378:"c393af839d436c82",849381:"5920716926982c87",849399:"9d10fb9213c5beb3",849579:"dc8bbff7c4a786d1",849586:"b8f0df35bc8768cc",849632:"6e5eaf55be45ba6c",849672:"e46ce39b1ecf9042",849761:"a270750b7e2f72ad",849899:"21e5fa706ee8e3e1",850069:"4066e2653f4b19d1",850145:"867707db740d628c",850473:"7ad72f4d9d87151f",850503:"0499361dc21aa4e4",850771:"713c4b217eaed9c4",850819:"37bb0671b3121d54",850868:"577a57c53483da35",850926:"f14ada0d50bcf70a",851082:"4fceca5244486b16",851133:"e0ff1d022432473d",851135:"931da8d9008a170f",851244:"77c9160f068234ed",851453:"69ad37df07b86ce7",851484:"1c47513399fbdd76",851710:"84398fdb50e90aa9",851779:"140485135eb16d47",852005:"9c6a76dfdd09a956",852233:"a18ccc01fe5c4ed4",852378:"c803de118b8916dc",852382:"cf4324c8a61014e5",852423:"d6e6031a971da0ec",852943:"7281442ef698835a",852957:"db3c159080c55219",853029:"7a487bfffcb53a39",853093:"1d85366cfa8348ca",853181:"fad5275ca19ff111",853362:"e26f46d96d97d66d",853760:"89b58186ff6e4a9a",853827:"ce26fc391850421b",853911:"9ca84438ea3a4665",853912:"a27006f312db2e2f",853988:"7a062801b786f177",854008:"77cfae06595823cb",854054:"ed356b895c193eb5",854304:"b9d571dbcc96d20d",854343:"144ff5049f22d4b6",854668:"a0368e11ad817682",854785:"424a87657c199b8e",854879:"171ca50b70b345ad",855010:"02a34bcfff22d0c7",855197:"2c09b416da5ea8e9",855225:"65832f527dc70b8e",855308:"d7ac2a1315285e34",855439:"03bfbaff5ca982bc",855499:"fa294573c3c31167",855615:"3ba644f2c743bd5f",855638:"b8117f56f5d5b4ff",855739:"7d29c2647de0109f",855936:"ddde903329a70255",856007:"cbfa1a36bd9fb68a",856067:"b5e9f5834df6c53c",856256:"d82c49b71214de71",856270:"8b2d0077a052a2ac",856330:"a0baaa1eb70f1b2c",856532:"212434c6d4e72b9b",857088:"046f8b3c50a1a4d3",857220:"481a4955bafbdd4d",857426:"8f2f34562a4879d7",857549:"8e5525feadffdb07",857785:"a005e5fcb71b016a",857824:"6485c7f6597e4eab",858187:"885cb16de890b7ca",858216:"ec4eb034303fcfdb",858275:"24d69e73e07ff508",858365:"9a6ec73b02aa4cb0",858499:"f10e3479924f5d43",858549:"a6e06a39f755c805",858687:"7a17cd4a6c84a56f",858719:"ae4ffd98200a5952",858764:"d62f73b6e8bfc2b6",859086:"2bdf5fa29776b083",859185:"4350cbb3e6abf6b8",860075:"eaffca61be2743b8",860192:"aa1b50c370c7a6e2",860332:"3cd07f3427ffccd3",860362:"692625d007aa6a98",860494:"f4da434590655bd0",860630:"57f1d1759e9dbce3",860698:"4636e22faf4dea20",861205:"46d43c9d272151e1",861224:"966f48e830ebab60",861330:"a037bce3a202bc56",861605:"7c00252b69f2cdb1",861844:"4daab546bcc08099",861910:"a65f68b86cf6f538",861967:"0736c80b9bb42a9c",862151:"bc975c130cbaefff",862301:"1cc7b9d264665159",862310:"f8dd24125dc2a788",862313:"b5531a74ee9a8002",862550:"4f6f098cddd59ff4",862602:"af93f18993fca8e3",862670:"446ed8f84abcbbde",862778:"b4685defd5cefbc8",862807:"2f28906d15240d8d",862815:"b3145f9c7b080b42",862823:"cd72f03b7a8538d6",862885:"8c89322717a433bb",862969:"56c012602ffb03ce",862986:"cb0a38d16a55b4c5",863033:"5bf94a1417de35cd",863389:"a42adffcc0b0d520",863396:"32d3a5cd16429d15",863403:"532871fddc98d547",863647:"9e051281498e0224",863764:"3dcbd130befa0117",863868:"93072bd2ae4747e7",864438:"def464eb3ac8c3b6",864486:"ec4eb134730eb42b",864566:"7f4f04d293fe341e",864574:"99f871f1a64ffc52",864696:"4064ba19ca2fb24f",864701:"93a0cecf8273b4eb",864748:"b85d220af882cf36",864829:"9396e9ac56ad149d",865270:"705a85a5ff57fce6",865365:"33ae403620863c1a",865398:"7094f8ea8a393883",865419:"e98b18255c8d8fed",865471:"9984ca427110dfba",865487:"ec4372c9afa375ff",865492:"8516ac0d62cae18d",865520:"6495f2fd22e38387",865618:"1827599f5f72f808",865687:"30a3eb58770b142e",865888:"d109d33bad3b9ae5",865898:"a2e8ffa5fbed1678",865906:"9a561ec75c81517b",866028:"7edaa903be7857b8",866188:"93d6c208dbaf544c",866217:"2545e3ae64cbe657",866287:"44c6067c7aaeb1a5",866495:"df8f546ab90dce67",866531:"73f2d2af22c2b60c",866787:"74200e209b886875",866846:"ace27070282b3f4e",866926:"7814c20762c2a9a3",867079:"1ceb5a7e275d7e1c",867187:"a338805ba0718ae6",867294:"9046789a94f995b8",867520:"b2f2f2572b70bb42",867576:"88775d3ca90aac58",867630:"cc60c3d9a9b2f92f",867647:"098075c1f3c67d2d",867824:"d88004e354da6f99",867900:"14ffd4185c07c49c",868060:"a083141d37ed5271",868095:"873804c4078df2f9",868167:"370498c5e22ce816",868187:"165e8a609760de25",868200:"0d226ffdfb63e831",868239:"1b81b57254678cb6",868452:"238953954985a427",868485:"949dbd114f094cb2",868507:"fbb2883611542f34",868537:"ce2db8a5b2bdf643",868635:"db6ae584a3ba4787",868665:"2f376162cb71f7f2",868696:"ec56e1bd8a678175",868706:"bd56137319096d79",868839:"e23f1b8a93f8155f",868931:"8b962044b6754093",869185:"bbad847d78f3ceb3",869348:"5133124e96f95898",869534:"438eeb5493d61ccf",869675:"babd8c8f5a26d925",869707:"5ce31b87c8035abb",869907:"ee4c9d36ae3503cf",869939:"b08fe0dc47723209",870024:"1270fc07e48d360b",870220:"7fed6d7187c00254",870246:"34fcfe6ff6dd65a4",870470:"cddaf3c9c9f5fe39",870597:"265c308264f0afac",870760:"124773d21410b0a3",870950:"9cbdca8b3b05843e",871089:"895e8f9e370ff933",871147:"6c8dc65f6eba3aab",871219:"0b123d1348c4576b",871256:"826111b5c33e5b04",871408:"22eabc646f563813",871475:"8451779989dc0f36",871502:"b8a47d199b8c4109",871504:"4f9c4b25621c19bb",871522:"cc8be4e926d50bb7",871770:"1a740d434cd8e3e7",871818:"2d9625d4e4c973fa",871829:"993745b1d9cfe234",871887:"00d51a9ba4e52810",871983:"074f2e09597024d6",872171:"226c1b8dddccb655",872177:"8db7369afec6b0ba",872239:"0667c22630933e62",872484:"d44e617d077b3fc5",872564:"ee639ceb71f4cf39",872565:"00b754ed8178f5ba",872746:"783df80d64749d19",872826:"d10f57a752f2d650",872928:"0280a3a21ea18298",873026:"e286e98f161c8056",873095:"ef30c98049e154e5",873428:"87099f9000dfcf41",873502:"6b737ffc5869aaf0",873533:"98d436b8f068ccdf",873606:"6ffc336c4cdafe9e",873895:"ed1f6c6beb14e19d",873974:"1b873e136f4460c5",874176:"9ab370890e3a3a86",874186:"356627bb17a7a7b4",874691:"a856048cc80bb1f2",874919:"28ed3ef49bb12193",875009:"14331c05cdc24476",875208:"c572a9e9d16e58fe",875230:"5511732c31df75f4",875261:"c124eb843646c682",875410:"aaccc3bb09c068ee",875412:"61fa5bd3211e84e9",875763:"7ba883ba67a9b027",875814:"4d06a195bdec8051",875819:"b74a1bf44f62060c",875833:"deb0e394b6ffef10",875873:"3d3d111f6c4f7eb2",875985:"be901fe4e3c9412d",876003:"c4ec3a470b51d8b5",876073:"e5ab45c3488450c8",876138:"d889cf4a334b70a0",876571:"afd058a173ebb1fe",876710:"1d75fd117b108a4c",876750:"e265ec978abf28ba",877025:"c4ac104728be9c26",877047:"c516bb172c295d07",877236:"7783385b416efb5b",877540:"d1e36b76c56e7467",877725:"9a9c574efd2d3863",877856:"b55f59b96d9097b2",878054:"7ac422ddbe3fefc5",878330:"5d4f2a0f533842a3",878698:"02b2491efd0494e3",878713:"7cc91ceb1bda3cc4",878885:"cbd0f8ab96300298",879166:"83cd19a7fc173922",879231:"d7e4fbe7327bb1fa",879421:"9fccc74bf235a911",879485:"1adedece94273efb",879579:"5720935ebefd2cd3",879629:"0d3df5cf5ae8582e",879753:"70557d081eec742e",879833:"d6d8aa0d9c1e2de5",879883:"c1a01a423a2bb364",879918:"4f946d6bb0a308ef",879923:"28d0c6520f4b9cdd",879934:"8a26fec15ee6f8a5",879947:"a36bbaaf4e142f29",879992:"efe9774f0b4f4dda",880163:"4b1845390c4f67af",880389:"753375906c8a6f4f",880475:"d682c302ce8fd665",880511:"5297925fd59fb166",880740:"34071dda884e68d7",880848:"39e475c1d9ad89e1",881073:"a70e706eb6ad857e",881080:"83ef2a621e786652",881128:"0ec64b4eca0e0543",881363:"ecd62ff8a9e69a8a",881484:"cf5969d051e699d7",881510:"24bfb4acf2c3486f",881626:"e40511da5ee7c891",881744:"24ef87ddd6b93082",881943:"4afec5cc8057d3d8",882162:"17fb18e03bf9a88d",882204:"cb814c32e202d869",882621:"f44a35d10cb6473d",882732:"edefa2210cbb69ea",882880:"42d3fa0268c539ee",883498:"ed1d3e179002c4ac",883548:"4f23b23b26f12e97",883555:"64d2136557f1b31b",883608:"2d24e01726684d3f",883750:"07b4ffa76485cdad",883819:"66d1875f65889862",883840:"224bb58ad1c17e4b",883891:"4e1c10b5c897b40e",884006:"312b30580e644db7",884183:"65c449d4f1316d02",884358:"af6457baa5f5e028",884489:"cfe9034bea22d425",884718:"75699cefa955a7d7",884741:"b53a7dc172ce1cd1",884803:"e6f8255837e50b66",884843:"04fb1112b68c2107",885034:"ff11886acc436673",885059:"e984c2d10656df5f",885119:"901056c8eb8fae19",885456:"5a6d858b717234d5",885547:"a7b05716c1194f60",885763:"5daf81725aa6749b",885837:"52df25970a5bcf31",885875:"4c08f503bc45f4b6",885924:"040f8cd7f0ce4486",885976:"6c5028e2989cc778",886028:"217402848c27c589",886205:"d88f616032b5f4c8",886222:"5b335bdeaf89d057",886269:"f81ace3d6756ff76",886317:"7a7d3247ff55c4a1",886568:"8a32d4db753d451d",886643:"6682f9886d6ad8a7",886793:"f3acd251bec59e63",886845:"f803435aa2d59113",886960:"ef68ea213ccb29bc",886972:"51a5cf16e355fa77",887028:"0d9dea37c30c953d",887171:"7ecfd332aef5c05c",887246:"9d49330f30585083",887363:"3fda9b6f543b0730",887574:"85775c78a87bfb6d",887811:"f1b7d02ae16f4e33",888087:"430d808c987b1bb9",888094:"e95c0e0882ae6f7a",888188:"466943dd9fbe44a0",888393:"2594e112a3c0cdc7",888394:"9d07568adce3e524",888766:"ab8ebac7dd84e2e6",888878:"9fdc1cc0b9e7be74",888900:"b20370fe6009c411",888923:"8a6bfad41fa26f1a",888965:"65e7f46a0373bdf3",888983:"0e27705e42fde2db",889008:"03166c57fba3fe63",889026:"640e6cb0ffdfaefd",889131:"f8170ccb7de1ad1b",889338:"0f47fe05f4c164df",889378:"2812b9aea732d241",889379:"c7703b6a7fc496a9",889406:"8a2955019248be52",889732:"fdb1cf58d6572d32",889906:"b24f5fb05b18aeb3",889973:"d43b5f72ed5ad042",890032:"d594e3a41732459b",890134:"619b3c7f57ce811e",890249:"07369ef2e44b3f11",890445:"d1addacc6c4f164d",890634:"28e2f61a304dab29",890876:"0e984f32980b2bfe",890885:"e7af51f7422c7a22",890971:"44b3911ec670cb00",891020:"7fda34f1ed0bde04",891128:"2ab70d91afbe1ae5",891467:"2d54840d31813944",891546:"aae73fb18c4e65fc",891738:"4e0984915220f4a2",891782:"86b73d0fd0be9fdf",892250:"4c43a3825072e421",892371:"47fb9fd691b6bdbc",892494:"cb5f2eaa0232f620",892517:"a4679b0b69ba8a24",892617:"8f3ea0dca612ea42",892920:"4810316a9f894c71",892942:"d6547f2c39e5beb8",893393:"08bf7cc9bcc2649b",893497:"948dce30bac07f3d",893549:"c0f39aea56a6f8e7",893691:"b409fa82c267d5bd",893718:"7aeeec925bd04a3a",893802:"2ad936c34106cbd8",893806:"5ea7c24c43280afa",893832:"33da284fe9146abb",894087:"d7fbf77f921a0c24",894381:"77212c758776a2f2",894382:"77fd03623c94101d",894629:"1aa023a2b44ac8ff",894744:"291ec74af96241b7",894777:"a30edd4629be4772",894852:"c06b89daf329eea9",895194:"0c1748ce61729a11",895289:"29b1e0466da775a8",895444:"fd5e1448ba161dce",895581:"bd19b1fc1fb83fb6",895655:"82b3696d82772901",895847:"57a3a47ba5d0d925",896008:"8a0416ac65a6efc2",896091:"638203b7bc59cad8",896146:"f38d245405bcc54b",896173:"c776638c6c16124c",896474:"7630612d6c036a62",897043:"5d3c74433500691c",897118:"a10aeda7cea874ad",897213:"117d81fe486c4450",897290:"e94e181dd5c2b56c",897305:"168d84ab66d4831f",897485:"98e70094d57ecaac",897586:"7b15776700145a46",897685:"dff8ba9d03ef29be",897783:"198a3d8b782542f7",897856:"f1a8433387d6b9fe",897962:"0582d2ddfdc6adbc",897988:"7c6b5623b3c0dbca",898050:"7613805c57e71910",898275:"d05bd624508ca293",898278:"db6592b8c8a06e97",898408:"1a117efc11d796fd",898458:"f2987c097534d940",898471:"540a32bee224d6f2",898507:"50a06321c76142e3",898724:"0dd6605a7290c49e",898862:"ad9af84f74d3a8ee",899067:"4ef794acd9e5294d",899181:"64439001dc25cbec",899246:"29bbc67f3143ae60",899304:"b34f504265ee585d",899328:"56a39cd0d25b740c",899367:"74711751e1b96b86",899487:"c58f5ff14c9ea8f9",899533:"a05055161f68d348",899700:"db3a89d63cb4738f",899737:"23f252ed4b73f4f7",899768:"86b1f0c37d9c1350",900038:"84b7a5aed969a4e4",900140:"c789e5167063a227",900218:"1d2ffbea029cea0e",900389:"570a4f740be46c7f",900657:"2c2211ef79a2ebad",900675:"c55ae7b678553149",900837:"7cc7d84a42f31244",900860:"56926587c3f3ed41",900902:"d65109605d1b55e6",900945:"84384dae6378b278",901383:"27a1cabddeea3c80",901510:"35ac6f5b44ea7c32",901530:"92eec6f0c24a9adf",901636:"f05d68997691aa45",901657:"c3f8fe45472cf45e",901891:"93a649a439ea5157",902078:"360b2db7939fcda5",902132:"5838b0e841f633ae",902471:"7f99d2982471825a",902600:"deedbf97e6673697",902611:"c67bbb3c72c1fad2",902654:"10aa05bc63d3cbc0",902921:"84ac1af0ec57983b",902978:"c8658cf01e3db6f5",903024:"ad52f760e7102173",903152:"c74ee7515aa8948b",903279:"911435fb5deb186b",903420:"a185b89ddb1dbb48",903862:"49792108aaa61cde",904063:"b68a393bb8afed76",904115:"892222c5c7028154",904183:"388d15c5e1128aa0",904221:"66cb50564c6a866a",904297:"074c596ebcb4dfe7",904428:"1d23a5e7923e2994",904435:"e1e0825d94fc12eb",904692:"52ec7e024d1b7fbe",904757:"342b00223c76f269",904872:"065ddef2ef7543fc",905069:"8113adcdd95619af",905207:"bc1691578e05d4ad",905305:"b06c7e77d33eb0f3",905327:"e5f75fb72b7301f3",905407:"ef3c682d5497588a",905506:"4b4577fa7e5ca74a",905548:"debfa7840dd90c6d",905663:"e0508f20ae3e5999",905722:"d5c78abcc8282387",905752:"5d8d2d3b70a8e7b0",905920:"734169c6e4111b75",906350:"7a25af87cfa7cbb9",906585:"8c1abeb7086f7c54",906707:"bf6c37285c02935e",906767:"0a2f0ab1b800c813",906848:"5a4f1c23231c04df",906874:"7cf4f2b29e67187d",906966:"6660497053c5815b",907058:"818e4d0b40e31d7c",907202:"266f98bfd06ef559",907378:"d3fc2ee36b76a596",907696:"53a12afe6ddbc906",907718:"f51eabaf62b8db95",907872:"922e008a19cb981c",907908:"7fccb99b049a509a",907954:"80fb06919a836ce5",908199:"fdfd82556ae8e227",908361:"771ac7919198e0d8",908544:"55a7e32a0ce0cd9b",908566:"e262922d35bbdc19",908992:"d03a1b6b1fbfacb9",909100:"7490ea1784b5154c",909179:"4d6cd665c84e7cec",909191:"f026dcabe0c952eb",909231:"a31b386fedcaabd7",909255:"30a793e43c54bfed",909269:"d1734c0609bd6c37",909283:"4eb9e6c5f335dd02",909331:"22823da5921aa330",909611:"ccb230a3704646dd",909664:"145633a169a0c2c3",909693:"70221aae9a1ad1b3",909709:"4d989e6c9f4c5088",910345:"a1099f8291ecfd5f",910360:"2b58c0f6bfcdb2fe",910575:"1b8879ec48b48402",910582:"3a03192e33423122",910885:"2dc8e1427f5a98de",910942:"372fc68919eeb283",911124:"25dcc3ec9ce916c9",911205:"26fdf9c9fb629fb1",911346:"39b6fa436a9587cc",911375:"16d35af56de993f9",911478:"8422cae67c27ef1a",911692:"5f0465e421dc223e",911846:"287eed303acf2939",911987:"a0f7b5d2d62c9d8a",912081:"286885d0c023c16d",912212:"b850307f114d6597",912235:"a6acf77c856184f7",912325:"4b02e021eb553e76",912508:"2e6fe9d424899fdd",912766:"8b02dfa6f7884ad1",912870:"ddaad12f5d57090b",913084:"afcac46de3ba4c4f",913261:"c87f035f00814dc1",913340:"34eb08f60d7ed40b",913386:"ae47f2e99a566c8a",913390:"0d1e08dcdf3382f0",913462:"5f930b543a5c11d0",913519:"1854f443d5ce31dc",913560:"f7852e7465ab09d9",913651:"5509fd7c343febe0",913830:"9c498af43fac3b4d",914058:"8d0db5a1cbaf3788",914091:"c266005b57c75ab3",914202:"8a6ee2c1e039d6ef",914264:"87709fe0dc067a83",914532:"19a5e17b18a816b9",914537:"2322783e33c97ca9",914543:"817b690f950ae9e6",914682:"4444b8d624692239",914704:"f4f348ea96242384",914821:"98292bca9988ea41",915001:"51ed75cd5312f655",915097:"efec9db359a4f568",915120:"87eb669f8872a875",915229:"ed7adff12afef74f",915401:"46867b19e593cd41",915771:"b1d80ab252226369",915782:"27b0c695b581abfb",915868:"b5630d121afa74da",916105:"35eafaf4e8e65a4d",916452:"115d7ad484278ffd",916471:"59cc7cd10c81cd2c",916590:"9541962e9ac241dd",916714:"01b821a1cd430238",916857:"18f5902eb653a0d1",916960:"2dbecabbad383f04",917098:"f49da4822109f72f",917250:"5a8ce95a9331b73b",917572:"95870a9e252e08bf",917716:"b29c1ba789191330",917736:"02c4413b2d50a6d8",917784:"73c3e099d4a2399c",917805:"741a58b81742c55f",917844:"3a1707c525bd6fa9",918043:"ee8e1c89dacc2c00",918180:"b96cbcad90073824",918199:"8e652db825bf8204",918266:"14fee064ebf49930",918419:"a87f8c44b1da7407",918427:"f93e96fab2a4657a",918688:"bd4284ef7bd29786",918758:"41d0de4c6098152f",918797:"3e6576c9534dcf68",918876:"66dd6c6fa7dd5965",918947:"b43f2a1857133440",919523:"68f9ed332f545a8b",919524:"9ddfb554cb037b0d",919778:"575ed44b58f6c05a",919820:"ed7e1a145cdf87e2",919949:"14bf551fdf745931",919990:"f54b49034c32d1be",920058:"cd771f9a0392521e",920155:"372b998b604b08c7",920418:"69b19f25834849fc",920432:"c871a9713f655226",920474:"692d19a8e371c212",920748:"b310b8bb82f6e588",920800:"9a4adc820789520e",920995:"7a6b672ddcc30e82",921638:"88771fce59e5c0d2",921679:"d409178e3dc36c49",921719:"7217944c30f61589",922345:"9381ac2a31169261",922427:"97242b9ddd6c4404",922587:"eb67825170248c50",922608:"4c896cb0bcc6cf4c",922637:"f26ebce3aa0b8d12",922761:"b1f71b5bd9cb9837",922784:"79b96f194b12b562",922785:"63f3683b2d1dbc9c",922808:"e1cdbbe745f13383",922956:"3b4a2dbf4c5e1b40",923115:"b330ef24bd94464f",923139:"63a78d17e603e6e6",923167:"1fee0e827f424482",923200:"4c27539eb87ff570",923257:"468c1e81dd2ad800",923304:"d069435a52c386c3",923352:"aa9f4f4222fb5a96",923355:"7865d1007ee449de",923386:"7ce7607aca030f85",923449:"0dddf0c1c07199b8",923658:"ef14801ec971bcad",923685:"114f132751d5e610",923731:"a74070b42b3cadbf",923870:"ba094956416ac95d",924251:"edfa49e0a43815d9",924371:"d9c1559eacc55d59",924380:"04476b928cb61eb1",924625:"0d7118aaf76ac274",924760:"1b5dc07f8c246d7b",924820:"2d44dfafd02218d3",924826:"2b1398d256477db1",925262:"0004002d0f6a6083",925375:"e8af0589d653d905",925409:"6dd842d7b9bee40d",925455:"f303553c45221ae3",925500:"cc2e2758d262f982",925587:"0472666239fe7ad0",925940:"3789bd1cf4946591",926162:"7f38c438beecb2aa",926340:"ceffa20d9360e1b0",926711:"7574a1e1bd51b4ba",926754:"141a63d71a718fc2",926851:"e214e336d036a1ad",926908:"680c96e37466c48a",926934:"9993d8ec6138c32d",926958:"afa7112fb08aa75a",927018:"fa7181e12e812b6e",927019:"e9e2669a4180f4c1",927075:"e565ecab8c9e43e6",927092:"1e3addbcfee1c8d7",927218:"9a8c01b9d37ee01c",927245:"733e430dbfb2e739",927265:"1daeef95a22f339f",927335:"847f41a4fb479f11",927433:"000fc765122762a1",927447:"bc8409f8eb167cb7",927462:"9d4a952035db1346",927480:"e6c88ed6c42d276a",927634:"51f0705ac57061cd",927665:"87ee4f1b963daefc",928046:"adba846cad905649",928339:"ac2aff25929d499b",928422:"0f1c72c58167ac2b",928491:"56ffb0c1625e5af5",928641:"490db1cb5075d270",928662:"28204be4ff9e4c20",928673:"227ccf19a684495f",929057:"58e80b7969b0942b",929118:"5cd1761fc808d76c",929488:"094d21f7ea857363",929732:"48795babe3c05b96",929745:"1f3728f17e26ecb0",929861:"6a2351fea4ec5f29",930037:"c0a79bad055652ed",930038:"ab251dc191decdac",930054:"b773f693b62a8b7c",930087:"5cd84cf04a81fd90",930122:"5770dca33f355a3e",930178:"9b98a0027505a76f",930616:"2e95c29c4ee2b24d",930815:"2266077882a11f1f",931063:"fcb34c3ca95ed4cb",931090:"a377b62ec91b0519",931447:"6389b6a0466b4e9f",931640:"e39b25dedf760694",931860:"0ab80bb79beca3ad",931868:"9270c79fbbe40686",932070:"66d50d9e0a48b98d",932126:"28cb0566bcc0bd1d",932159:"cf6f556075188415",932170:"05e26763e802c603",932192:"379ba8ebf613f7c0",933113:"7594384cebc4ceaf",933181:"a0aec5f82c834189",933202:"05e35975263eaa0b",933324:"bd041300e8d5b35f",933564:"1058d7738979c1fc",933966:"d03fe1f42158e451",934026:"a8377909469f6290",934060:"7621906a327e2f07",934067:"9207ee21a770afc9",934410:"67dccc6ee736ba67",934570:"d1eb59e445b1b563",934857:"3ef48d47d5817073",934882:"4c63f3b4f056ebce",934921:"daba5ed5631a4f70",934978:"4b1bdd5663648e30",935193:"1bfcc51e2d592b53",935205:"a83fbed69c51f4ef",935379:"6376f749036a0b41",935592:"aad8b2ac302a67b9",936191:"bf5a852afef837bc",936650:"188280821e5731b2",936934:"4466e413907a9ad1",936962:"5720ccb5d257d0c9",937102:"d88547b98cae8b81",937127:"a2c6cfeba2a6aaa7",937331:"e00f8e41e8c1ce63",937411:"dd848d1ef8a8f06a",937481:"724e8cba0ab4076b",937529:"a2be5970c924b10b",937677:"9a81440b5c0bd8df",937719:"656cb4ec001df598",937757:"4c141e50be9743a0",937813:"4a27eeb9f341f98d",937890:"40eec24ba490a515",938083:"b59e90ed9e1f4e50",938090:"977d84590db73d07",938093:"91e375c6f81dbf94",938094:"12485366e497b3c2",938319:"74c8ee2ffe109c9d",938450:"344a0198ae6397f1",938452:"a0cb7061a38e0a9c",938493:"b44e22f445d90827",938751:"c41c484e69a8c893",938794:"50a550fc790824bf",938968:"97ae4a8a457e23e8",938996:"89031de21ee28099",939110:"9069faa0a4d9407f",939181:"a55aec8bd2fd2cb0",939262:"6fa2cb5e1b2334dd",939394:"9cd32bc551a0307c",939724:"1c9b12d29c09d8e3",939726:"84692250c03e95c6",940073:"c3da0b008228353d",940188:"e15930dfe939181a",940373:"b8351ae11adabba0",940461:"5584adf629e96e44",940899:"b7254f885fa52060",941204:"4eba0065907494ab",941305:"d05d1873eaac27be",941411:"9f869f1453e20894",941478:"0571f5b081f13071",941569:"8651a162ae6221ee",942194:"e514f1710c3b760b",942270:"4855d0eeb45b85b3",942475:"aef56f95f9b1f00f",942535:"b94d374e42f95910",942641:"39cd2c9fe50e4ce7",942643:"a86b5a2fb164b8ed",942706:"9aa5e3395e0eb645",942768:"0f83a3d1f9c99867",942786:"1d541d697c78ca87",942866:"cf1fea0d7f4dc553",943338:"203cbcf487151d0f",943443:"8f8bcdd5c431ff94",943579:"6aa19ed113a6245b",943707:"4c127b229e3dcf85",943718:"e288fb248fe20f4f",943743:"51bd53d98242bd4e",943768:"d009b239e28ba8ac",943866:"48e95759ab02c7e0",943933:"fee3d43c4336d7cf",943958:"5a4f90d2da3005d0",944307:"16b16b3330cf6e37",944372:"3c32785327b02102",944423:"b91beb4688c8c2ac",944566:"4b4936d1d2a4956b",944607:"99da8450f7acf347",944706:"0ae7c994a7af75eb",944731:"18f414e67103c02e",944843:"74a1f0acbdcf0344",944923:"d3ee72535decc591",945005:"830c5c3b98cfdcc3",945024:"aeecd6fed1042583",945193:"99b23e1c95b38ec8",945331:"603aefd90b27d45d",945493:"14dc0f258a2150b7",945614:"073c9c3254be90f3",945812:"92b16f7fb0f71d90",945935:"ec121970affb1699",945941:"c3b4cbc4ed570995",945951:"26cb601e29f7e625",946067:"f376052f966dc311",946089:"2cfae2a0dbf83f81",946338:"d231f92ec4f8b91a",946342:"46b4651a61db86f6",946712:"21a9706c88876730",946838:"554a3b36fec12bdc",946945:"a8a5985f871f621a",947008:"58db3d4d277e9556",947356:"3c8ea8cb85a4b875",947603:"7040c67a4f8805fd",947799:"42077c1f3b707439",947806:"5029121f5276128f",948007:"ea432ac8fbcd940a",948051:"2fee4d596886569d",948066:"b0969e98065a26a3",948195:"90bb45424bcc9a9e",948373:"50610796e25651e3",948418:"c1e35d4a75ab4609",948569:"bf65bfeed26861bd",948606:"c2c6ddb20e4a983c",948678:"567c3a91d46ecaa7",948693:"ae769264eaa22c86",948706:"5944ce9477ae83e9",948715:"1d24314e1a6c10e7",948717:"d2c67745dd49d6c6",948952:"7b1d751674e7e271",949502:"40b8dbcd7fe5cdf2",949567:"ac43e774b0fa5c3f",949576:"659fb6d79bee9af6",949584:"55a6d7c1869d5cc6",949619:"2fee21692e1e7b16",949634:"f062604ea326eb60",949702:"eddea3a61d37b076",949742:"b3e42825da734a0b",949795:"2b973e56596891ff",949835:"3b805d79eb163221",950081:"4927ca431b330e78",950103:"f6feb37955379287",950104:"d337da04c9405a9b",950134:"f327b1b116f888d7",950615:"5a5500b2e0681afc",950703:"d30220fe3ace8cd8",950743:"21d843133c2b6af5",950769:"b22870ee4a56514e",950790:"10cb365a8a4a668e",950801:"d065f5d7556b1ec0",950860:"eb4ac3dd904ffb1e",951278:"ce182292165966b9",951313:"83cc245c3f3f01a4",951407:"95cf9cc34f1005f0",951449:"d3d476d87ffdd079",951568:"29e78a7c6865da63",951652:"9d9ea6b62905841b",951654:"30b021abc8ec6c53",952102:"55826c00589367a0",952202:"2aaf683bff5d0737",952253:"bda2e8ac0b357623",952327:"6dc5a3a57221b195",952422:"7759bed5c93e1d31",952589:"64cb6a09d5b9a661",952639:"5ba2df644124bad2",952771:"6cc5bbd16eb01522",952844:"d9baa7df369ffa55",953166:"3041d97db311a82b",953361:"aef314847cf0900e",953497:"116375a07daecbfe",953506:"cb1cf445efbef288",953517:"fcc911ad86cec765",953598:"7b9a1ec1d2834df8",953628:"415b07c01e601ac7",953629:"6c96858ca589b1a5",953670:"feeeee940efd9adc",953894:"fcf62c11dc9ef7cc",953909:"0cca02a0acf4cf0f",954113:"3e61e038509db1b9",954129:"afd63d38823d8a9e",954441:"743176ff0845acc5",954501:"e8ff74845304825e",954596:"179712c1205b9f71",954603:"8140e745b541f5b6",954661:"c1df46d0770c2ca5",955083:"79c3558b0e2a0967",955166:"c576f02d54d5a00c",955264:"01b343f0f67e3321",955442:"b99754eba12206fe",955447:"db0f9229aff91f07",955681:"6d13d0266c0fbeb8",955850:"28233ab363dcaa2a",955985:"54a7c98858e28626",956081:"87f19116e570b217",956120:"11265c2683863422",956147:"b176f095bb5352ca",956166:"447f9168873cd8e7",956232:"5d5cb12a3e8d0c08",956305:"941cd69f8de49104",956343:"eb2bf8ee9cc05004",956593:"6bb9c90f400212df",956690:"de41af0b85143e19",956713:"4e1eded31c4cb627",956858:"a77d1b51c2979a3a",956867:"270f49033332185b",957070:"230608f99f96272b",957156:"7fd80d3f6cf4014b",957302:"b388d5e167489a8b",957625:"29b2c252f1d5c7cd",957796:"ff617cdd9e9cd4b1",958095:"ac20919242114376",958163:"ccd77051ebfa42ff",958184:"57eee11c2fec5a10",958185:"a05f0aaffdb664d7",958215:"84221ca08ee1650b",958338:"48f3dd83ca88d5bc",958408:"5e7314fe4794bcbe",958636:"648a69b3a2cf109e",958828:"25516e16f749aba0",958948:"e43371a59f7ffc03",958973:"a65a009b3a140d31",958977:"dddb1cd180c3a596",959152:"971cab4df8862ea8",959362:"2931710ac9410dcc",959374:"736d6d28e67dc4b1",959394:"b7687ac8535b4b82",959671:"f62355c2f597ef26",959775:"83fe8739d2703eba",959806:"289e34fafa694270",959916:"94a03ca9ded42eb9",960185:"2edadf407e9ccfb4",960267:"a022ac33a336a168",960337:"fdfc701177b70b81",960430:"53edbff7be7f7b8d",960502:"c416dd3db80c1336",960534:"0b2d5c2c4132f81e",960778:"cd02f2c4a25e27a8",960928:"11ea4898de6a200f",961444:"a1bb87e337d9529a",961614:"23c9e68cb408e1ab",961804:"ee19e841c17327b9",961854:"9d427b5e14e4d23a",962127:"f217abde348960f8",962432:"a0bed9c58c97aa0c",962601:"ef1e941b645a4489",962613:"0f0ad903e352213f",963003:"64da8f308b778efc",963095:"e6675fdc7319c236",963378:"e52a4202ecb9c25c",963396:"73eea4be981fb5c2",963572:"fcf0b48ec1420eeb",963691:"3b15c7fd470d51d8",963701:"3c87adb50baee6df",963772:"57c15c39af29fe49",964009:"6e009e1eb5db3833",964067:"75cc80773f1aa1e1",964068:"17a95dae5841e852",964070:"da1ead251c91ea89",964083:"4506684e8b7d3e6d",964084:"6d611945d7528237",964227:"fb9f4cb12570f656",964278:"d320b1a631776dad",964418:"6286d0a5440c0b5a",964460:"5395c27568cd7807",964507:"f3753a9947aaf76d",964539:"fc6998d9c4b6a491",964665:"ef772dd307a40f3d",964669:"eae6e1ea80709ae4",964702:"c4e69d035c3cda62",964750:"6ddddd62daadecf9",964864:"55e5aea901799020",964951:"776a372b128c9d46",964984:"d51c74fdabfcc8b2",965028:"5bd82b874b09dc11",965082:"b3bf5cf5dbb5cdd6",965090:"05e58725ca673eee",965169:"9bd2a7609bf836ef",965271:"d63b575cce4c365d",965514:"cbff243055f4be48",965573:"bbcbe133fa70e046",965579:"18a5430fc7a1f757",965641:"4b43b79f66fd0587",965794:"e6b1c7aca882bc97",966227:"24882656d163ebd6",966247:"4a673dc9be165324",966277:"2b6e89787dac8b52",966368:"3681347ae4644fd9",966522:"113141e94f89f20d",966761:"ab68f8f66c9a7fd6",966773:"659b7a797a18694c",966913:"6cb3e3aa6ab2e3c7",967034:"d1b5faf561d5ac02",967037:"bc278be9ceac3276",967088:"0d15880de250cd74",967498:"49d7e2928a431cb4",967758:"b47f3c87b4991f88",967908:"26408b3330f99fef",968148:"8eedb56b0e6873c4",968456:"420ee26beffc96c8",968486:"1b88325b2a5aec51",968620:"273e7f702d1502b5",968671:"475cb482821bacf7",968823:"e294b6b3cf77a589",968972:"b04fa891770fad2b",969060:"295e14571ec2ad81",969198:"a64bd43ffcaf25b6",969548:"cf0f95bc2e6ffdbd",969594:"9312affd171d77c1",969617:"9868797b0a7d20b5",969631:"a58d523919fe3038",969693:"ab158cfe6624f746",969701:"6fe056dc035ff645",970113:"96dcd01727c90a6c",970129:"a98a5eabdbcbcff0",970237:"877510634f71e4bf",970245:"f367aaa5cd777961",970293:"8d09a3537a0602f5",970308:"092731ef9977e1be",970310:"1af02b0d14e99038",970387:"7c57cdc009523f2e",970421:"ef6088a3d4648750",970509:"84a37131c76c1de9",970563:"9c80244c174fc853",970578:"02972626213c0bea",970632:"312c02fab6a59819",970640:"247d6d900a782271",970737:"c80ea0d3d254e252",971344:"e04768bb3bbbe42a",971365:"6abcbd17354aee65",971563:"a2a3c130c6666f4c",971565:"03b077e4a759d097",971783:"2357a5f11baf6ebb",971790:"017aed470b57458e",971917:"42b1bf7ff0a42c97",972123:"9ac5b2893c3fcb0e",972388:"aae7af508bf69611",972523:"e4b96f404be097c3",972563:"c190dd27b54a13c8",972642:"e88b54a5543d76f8",972675:"73f3dd4566b50e44",973008:"3119b7dadcddca53",973221:"015ee4961497fe0d",973698:"0cfead53ff7dc012",973736:"fec20f82e0126457",974153:"287306d31d6f4720",974167:"f385091ac833cf09",974211:"b99049edcbbd036b",974286:"0f24c02a55310c05",974361:"c25baa69e70c2324",974521:"3d12c0ac91ac62e9",974543:"917d050d01209882",974697:"b050df0ddfae4704",974770:"2d8b49e7587778f5",974818:"0f416efeae23da20",974974:"f30938ce8eb4d998",975041:"685ae34d2dc10fa9",975080:"db816aded499d9e9",975145:"0b25bb25a3053b6b",975194:"ddfe80e236a683ff",975213:"b39c7141eb19eb23",975303:"485cffc9f912842d",975472:"ecfad91e7206c9a9",975499:"291b4008206e0f32",975602:"96d4be02458dbb38",975651:"59d5af5ca1f6e4cc",975715:"38f86b90db412d6b",976003:"96cd244e5a448f4c",976008:"bf080557b6fd00c8",976025:"a151c8874fc7c779",976201:"654478f063e8fdb0",976260:"5006525aa6f1b5ec",976486:"852e805e645b5740",976501:"cace178509925abb",976576:"349bd4a3df8d3e38",976738:"e26ad396de29e8a1",976808:"d74243536f0ffb9d",976917:"11dac695b2fd86d3",976985:"6ead44ecbbb78ac6",977012:"2d3e86bf61b27d64",977114:"8fac5adcb75c8bd4",977326:"6f5f8a3ba2854798",977511:"5ff49c5e1df87365",977570:"6885672d74807cca",977578:"ed55851456b549ff",977727:"73e64ab0d039b395",977982:"afb413398d4cce0a",978315:"c72b1ddb7a35b4e9",978428:"991943fd6157fc18",978776:"cceb51e19722afc8",978848:"4bbb2ecd4b23a6a5",978910:"be493bc3ead81a90",979068:"9b79e2629991bc27",979227:"248fd4edc3c990ad",979307:"298fc96ccb96348f",979530:"14b4841280c3c75e",979630:"5c1a0511b0a5d926",979695:"ca70e861762dd2fd",979786:"8e5ce64072c92a18",979869:"6fcf2475d70aff2f",979948:"622be7207c67b3dd",980234:"0bf977ee8563be5a",981173:"81cfdb6eaa1b0105",981245:"e75ea53786e7d2be",981360:"e0d209f15ec75815",981480:"dd649f5fae94662c",981488:"98a3b0ab01ef8fdf",981578:"e4cea14a2ccac3e3",981614:"3fb0e34e490f9ff1",981774:"06a822c4533ff4e4",981968:"628793b827182e6b",982074:"3c8eeb6783f857f9",982146:"c0a86a882f8bf745",982248:"6ba4ae6c74c73da3",982265:"edca86c36b7600f0",982420:"5fe2c7a8b59877b2",982425:"f236c4cf83042042",982546:"4a68fc5e67b82e4d",983025:"e832c5292cc40160",983088:"352301441b2fe6ac",983096:"ed78f9f7d458994f",983155:"b315cffdfdca231d",983188:"333b2776936ccca8",983258:"1a708cb98e9d81b3",983436:"6bad427d9d083e4f",983510:"fc9f6ba178c6958a",983644:"984adf860f65109d",983679:"5f90aa8e9a07fd6d",983958:"ab14f1b4701bcf86",984012:"d00d0032d79c1886",984067:"5bc0a909e076592d",984085:"848c711e7980ed0d",984098:"8a95580175ed66bf",984335:"405e6f41c36761f3",984464:"347d9b3c4d303176",984597:"936276a37412a837",984601:"ce023000175f32f7",984815:"d17f39e4d1271b84",984835:"05d1d80ecbc17d09",984898:"9d661efb168c7791",984935:"d6d9e657144b2a06",984983:"086c276a2129765d",985029:"c0ece516f145d125",985081:"2aa277815db9805a",985093:"cffd1db9b749cec3",985324:"12a381ae55fb779f",985382:"9caff8a5018fea90",986127:"b4fd9de6f20a8b28",986183:"8737313133f6cae5",986246:"0d77f918add859bd",986639:"dcc521a3d939c310",986753:"6bd9a1a03b14e2f7",986875:"9318e43b282c1488",987245:"383c2d81aa3582ab",987311:"8cbb0e7055db6d59",987430:"198ecf7c1a4f8355",987485:"3fe1bfa28a1f375d",987833:"df7cca34f97e7c64",987927:"4b359ffc592746f5",987929:"25e4746f09ae9852",988005:"a0780614aac59395",988070:"c3c5ac535286b928",988164:"2c5c83dbb59c2f7c",988849:"3619cbe7062fc10e",988890:"d1d1052ca70d4d34",988985:"a8378164dfd88efb",989104:"e1ca8a021c5ac597",989297:"62ad900beb78b416",989309:"f8da21200b311f1a",989419:"1e3942678614ce04",989537:"c22751718375bb23",989689:"4e9cbdfc9db07840",989719:"9b2266610d4e3d10",989829:"70f384fc882d769f",990236:"45e2f55367a45152",990398:"e30eda113c18692e",990486:"cfd0033742b19c16",990500:"dc43f0184c55512b",990659:"2a519ce5941d4408",990961:"09d68800e7fec4d0",990963:"9cdd4ea6c6a3d26f",991046:"96f948484cd927f8",991457:"e4486ea1791e19c7",991574:"f0e1c39c71f6975f",991580:"08b16797bf5c3114",991696:"f12055ec9e09ffba",991987:"9c9010d4f9baa067",991994:"8395cfebb843d269",992029:"07e5a3520c365909",992037:"5ffef091eb8b491f",992180:"e079cfeb9899a857",992277:"59b11aadc34ad4aa",992326:"2ecde8fb8d7905ce",992359:"7862ee2970ac1341",992468:"d7379a97a36d741c",992542:"6a6a15a6ab535e47",992546:"8c443476834e1d3a",992564:"4dbdc7584fd713e4",992870:"f246a84e431ae007",993013:"e7d168422f56f1aa",993027:"0f20464b8e05e116",993088:"4de33b4db03a16cc",993270:"4158cece7331d903",993376:"111faf6c2bca6f43",993392:"f8f8922656322260",993433:"8cc934fc0e9e2183",993467:"f190f993b5bd8a03",993532:"8f62a775b1af6b46",993560:"ae19fdf53b13455a",993715:"293fb55eb19146a2",993724:"8bff1f414b21a563",993829:"1558b4369050fe77",993870:"bc2680b4069b013b",994009:"f840820bf194aaf5",994040:"91878765ec29bdad",994095:"d674ceec85285cc8",994177:"b5a78a73f93d8730",994389:"8b6befb6ce0311b6",994621:"310d4d95abaa2042",994766:"e67ef34f6ddb3f35",994803:"345db156ca53c717",995137:"35aa425c1793da74",995234:"af1988accb5068c6",995278:"fd75c9774ee7a90b",995316:"7e4d8a177dde79ce",995319:"5e7c42100c673a25",995387:"90d04bf22b4234b7",995444:"bc79a946790c5a92",995550:"2fb2d381ef2a11cb",995627:"a33ecce64fb3e00f",995936:"4f9abe542d3b6402",995990:"fdac6e8de135f696",996028:"1236c5221fa1a394",996137:"61cbf0e3f302ba9d",996350:"686471c418921b45",996388:"477b9326c37808ac",996414:"d6dea12b67781436",996430:"e5f10d2e1a8eefa4",996502:"66bc0bd021091c0d",996583:"296e16399e4b0778",996681:"8730945ebec1aa8d",996708:"525dd7721b2a1506",996730:"ce3a6c420428ff01",997083:"c5cb7b9d0d3f54f2",997110:"690b2455b4d759c9",997180:"9faef855622f10a0",997267:"590cd9d5e9ae6585",997285:"e8a66dbd0c64a65b",997378:"e360e7d4a46425ed",997381:"8985ee9d50448c24",997651:"0fbe33c0b18dcda7",997667:"ceb69b3ff92e09e2",997891:"5f076671185db180",997893:"29085b31f5230514",997968:"14bed07a594f9cf9",998062:"3e594bb1b388cae2",998175:"390d524e2a113ff5",998255:"8f6f3346f2745e65",998474:"c38083005eb441e4",999200:"7c10edddc3aa3b19",999323:"937647fade2af124",999326:"e52a9984f5fa9120",999481:"1fd31a1151756e5a",999722:"1505bc07b76b3f64",999856:"943e7a7d507f4a5d",999919:"fbe3fee4342dc6c9"}[e]+".js"),u.miniCssF=e=>({150591:"onePlayerLoader2",294157:"web_recorder_v2"}[e]+"-"+{150591:"e4a2a463a975f310",294157:"de6072609892c2db"}[e]+".css"),u.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),u.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},a="@msteams/convene:",u.l=(e,t,i,s)=>{if(n[e])n[e].push(t);else{var o,r;if(void 0!==i)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var d=c[l];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==a+i){o=d;break}}o||(r=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=60,u.nc&&o.setAttribute("nonce",u.nc),o.setAttribute("data-webpack",a+i),o.src=u.tu(e),0!==o.src.indexOf(window.location.origin+"/")&&(o.crossOrigin="anonymous")),n[e]=[t];var m=(t,i)=>{o.onerror=o.onload=null,clearTimeout(g);var a=n[e];if(delete n[e],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((e=>e(i))),t)return t(i)},g=setTimeout(m.bind(null,void 0,{type:"timeout",target:o}),6e4);o.onerror=m.bind(null,o.onerror),o.onload=m.bind(null,o.onload),r&&document.head.appendChild(o)}},u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),u.tu=e=>(void 0===s&&(s={createScriptURL:e=>e},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(s=trustedTypes.createPolicy("@msteams/convene",s))),s.createScriptURL(e)),u.p="https://statics.teams.cdn.office.net/teams-modular-packages/hashed-assets/",(()=>{if(void 0!==u){var e=u.u,t=u.e,i=new Map,n=new Map;u.u=function(t){return e(t)+(i.has(t)?"?"+i.get(t):"")},u.e=function(a){return t(a).catch((function(t){var s=n.has(a)?n.get(a):1;if(s<1){var o=e(a);throw t.message="Loading chunk "+a+" failed after 1 retries.\n("+o+")",t.request=o,t}var r="ts="+Date.now();return i.set(a,r),n.set(a,s-1),u.e(a)}))}}})(),void 0!==u&&(u.p=u.g&&u.g.__webpack_public_path__||u.p),o=e=>new Promise(((t,i)=>{var n=u.miniCssF(e),a=u.p+n;if(((e,t)=>{for(var i=document.getElementsByTagName("link"),n=0;n<i.length;n++){var a=(o=i[n]).getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(a===e||a===t))return o}var s=document.getElementsByTagName("style");for(n=0;n<s.length;n++){var o;if((a=(o=s[n]).getAttribute("data-href"))===e||a===t)return o}})(n,a))return t();((e,t,i,n)=>{var a=document.createElement("link");a.rel="stylesheet",a.type="text/css",a.onerror=a.onload=s=>{if(a.onerror=a.onload=null,"load"===s.type)i();else{var o=s&&("load"===s.type?"missing":s.type),r=s&&s.target&&s.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=o,c.request=r,a.parentNode.removeChild(a),n(c)}},a.href=t,0!==a.href.indexOf(window.location.origin+"/")&&(a.crossOrigin="anonymous"),document.head.appendChild(a)})(e,a,t,i)})),r={740179:0},u.f.miniCss=(e,t)=>{r[e]?t.push(r[e]):0!==r[e]&&{150591:1,294157:1}[e]&&t.push(r[e]=o(e).then((()=>{r[e]=0}),(t=>{throw delete r[e],t})))},(()=>{u.b=document.baseURI||self.location.href;var e={740179:0};u.f.j=(t,i)=>{var n=u.o(e,t)?e[t]:void 0;if(0!==n)if(n)i.push(n[2]);else{var a=new Promise(((i,a)=>n=e[t]=[i,a]));i.push(n[2]=a);var s=u.p+u.u(t),o=new Error;u.l(s,(i=>{if(u.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var a=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+s+")",o.name="ChunkLoadError",o.type=a,o.request=s,n[1](o)}}),"chunk-"+t,t)}},u.F.j=t=>{if(!u.o(e,t)||void 0===e[t]){e[t]=null;var i=document.createElement("link");i.crossOrigin="anonymous",u.nc&&i.setAttribute("nonce",u.nc),i.rel="prefetch",i.as="script",i.href=u.p+u.u(t),document.head.appendChild(i)}},u.H.j=t=>{if(!u.o(e,t)||void 0===e[t]){e[t]=null;var i=document.createElement("link");i.charset="utf-8",u.nc&&i.setAttribute("nonce",u.nc),i.rel="preload",i.as="script",i.href=u.p+u.u(t),0!==i.href.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous"),document.head.appendChild(i)}},u.O.j=t=>0===e[t];var t=(t,i)=>{var n,a,[s,o,r]=i,c=0;if(s.some((t=>0!==e[t]))){for(n in o)u.o(o,n)&&(u.m[n]=o[n]);if(r)var l=r(u)}for(t&&t(i);c<s.length;c++)a=s[c],u.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return u.O(l)},i=this.webpackChunk_msteams_convene=this.webpackChunk_msteams_convene||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),c={114681:[582795,159716,634287,197587,821202,635689,725561,467173,50199,389139,565656,468318]},u.f.prefetch=(e,t)=>Promise.all(t).then((()=>{var t=c[e];Array.isArray(t)&&t.map(u.E)})),(()=>{var e={175925:[812946,716151,283035]};u.f.preload=t=>{var i=e[t];Array.isArray(i)&&i.map(u.G)}})();var m=u.O(void 0,[275742,728160,178389,255995,750674,321561,313066,499746,575502,766380,898696,64370,601932,974794,340690,389139,112218,421774,113236,100754,439247,237286,91968,661482,41205,703689,336094,490130,715432,806585,516909,232237,179414,644124,934545,825370,256604,424600,410218,96711,528175,835321,392355,490516,645345,599558,810078,275873],(()=>u(38641)));m=u.O(m)})();