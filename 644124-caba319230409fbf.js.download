"use strict";(this.webpackChunk_msteams_convene=this.webpackChunk_msteams_convene||[]).push([[644124],{251609:(e,t,o)=>{o.d(t,{k:()=>l});var r=o(850402),n=o(799894),i=o(265858),s=o(275742);const a=(0,o(606395).s)({flex:{mc9l5x:"f22iagw"},inline:{mc9l5x:"ftuwxu6"},column:{Beiy3e4:"f1vx9l62"},alignItemsFlexStart:{Bt984gj:"f6jr5hl"},alignItemsCenter:{Bt984gj:"f122n59"},alignItemsFlexEnd:{Bt984gj:"fgs5rwf"},alignItemsStretch:{Bt984gj:"f1q9h2pe"},justifyContentFlexStart:{Brf1p80:"fbhxue7"},justifyContentCenter:{Brf1p80:"f4d9j23"},justifyContentFlexEnd:{Brf1p80:"f9c4gz4"},justifyContentStretch:{Brf1p80:"fsxf2b5"},justifyContentSpaceAround:{Brf1p80:"f1iw3tyt"},justifyContentSpaceBetween:{Brf1p80:"f1869bpl"},justifyContentSpaceEvenly:{Brf1p80:"figf6al"},wrap:{Eh141a:"fni485r"},fill:{a9b677:"fly5x3f",Bqenvij:"f1l02sjl"},gapForColumnFlexSmall:{Belr9w4:"fd7ph1c"},gapForColumnFlexSmaller:{Belr9w4:"fn67r4l"},gapForColumnFlexMedium:{Belr9w4:"f16r77es"},gapForColumnFlexLarge:{Belr9w4:"fej36a"},gapForRowFlexSmall:{i8kkvl:"f18w1nra"},gapForRowFlexSmaller:{i8kkvl:"f4px1ci"},gapForRowFlexMedium:{i8kkvl:"f1lv1r8n"},gapForRowFlexLarge:{i8kkvl:"fzco7x8"},paddingMedium:{z8tnut:"f1809wu7",z189sj:["f81rol6","frdkuqy"],Byoj8tv:"f1fow5ox",uwmqm3:["frdkuqy","f81rol6"]}},{d:[".f22iagw{display:flex;}",".ftuwxu6{display:inline-flex;}",".f1vx9l62{flex-direction:column;}",".f6jr5hl{align-items:flex-start;}",".f122n59{align-items:center;}",".fgs5rwf{align-items:flex-end;}",".f1q9h2pe{align-items:stretch;}",".fbhxue7{justify-content:flex-start;}",".f4d9j23{justify-content:center;}",".f9c4gz4{justify-content:flex-end;}",".fsxf2b5{justify-content:stretch;}",".f1iw3tyt{justify-content:space-around;}",".f1869bpl{justify-content:space-between;}",".figf6al{justify-content:space-evenly;}",".fni485r{flex-wrap:wrap;}",".fly5x3f{width:100%;}",".f1l02sjl{height:100%;}",".fd7ph1c{row-gap:10px;}",".fn67r4l{row-gap:8px;}",".f16r77es{row-gap:15px;}",".fej36a{row-gap:30px;}",".f18w1nra{column-gap:10px;}",".f4px1ci{column-gap:8px;}",".f1lv1r8n{column-gap:15px;}",".fzco7x8{column-gap:30px;}",".f1809wu7{padding-top:10px;}",".f81rol6{padding-right:10px;}",".frdkuqy{padding-left:10px;}",".f1fow5ox{padding-bottom:10px;}"]}),l=i.forwardRef((function(e,t){const{children:o,column:l,fill:c,gap:d,hAlign:u,inline:g,padding:h,space:p,vAlign:m,wrap:E,className:v}=e,_=(0,r.__rest)(e,["children","column","fill","gap","hAlign","inline","padding","space","vAlign","wrap","className"]),f=a(),w=i.useMemo((()=>({alignItems:{start:f.alignItemsFlexStart,center:f.alignItemsCenter,end:f.alignItemsFlexEnd,stretch:f.alignItemsCenter},justifyContent:{start:f.justifyContentFlexStart,center:f.justifyContentCenter,end:f.justifyContentFlexEnd,stretch:f.justifyContentStretch},justifyContentSpace:{around:f.justifyContentSpaceAround,between:f.justifyContentSpaceBetween,evenly:f.justifyContentSpaceEvenly},gapForColumnFlex:{"gap.smaller":f.gapForColumnFlexSmaller,"gap.small":f.gapForColumnFlexSmall,"gap.medium":f.gapForColumnFlexMedium,"gap.large":f.gapForColumnFlexLarge},gapRow:{"gap.smaller":f.gapForRowFlexSmaller,"gap.small":f.gapForRowFlexSmall,"gap.medium":f.gapForRowFlexMedium,"gap.large":f.gapForRowFlexLarge},paddings:{"padding.medium":f.paddingMedium}})),[f]),S=(0,n.z)("fui-Flex",f.flex,g&&f.inline,l&&f.column,u&&(l?w.alignItems[u]:w.justifyContent[u]),m&&(l?w.justifyContent[m]:w.alignItems[m]),p&&w.justifyContentSpace[p],E&&f.wrap,c&&f.fill,d&&(l?w.gapForColumnFlex[d]:w.gapRow[d]),h&&w.paddings[h],v),C=i.Children.map(o,(e=>(0,s.get)(e,"type.__isFlexItem")?i.cloneElement(e,{flexDirection:l?"column":"row"}):e));return i.createElement("div",Object.assign({ref:t,className:S},_),C)}));l.displayName="Flex"},27220:(e,t,o)=>{o.d(t,{f:()=>n,L:()=>i});var r=o(265858);const n=r.createContext({});n.displayName="UIProviderContext";const i=()=>r.useContext(n)},419925:(e,t,o)=>{o.d(t,{ab:()=>r,Xt:()=>n,vC:()=>i,fe:()=>s,su:()=>a,oz:()=>l,oq:()=>c,lO:()=>d,PH:()=>u,mR:()=>g});const r="com.microsoft.teams.corelayout",n="com.microsoft.teams.entitymoreinfo",i="com.microsoft.teams.notifications";var s,a,l,c,d,u,g;!function(e){e.show="show",e.showWithoutFocusing="showWithoutFocusing",e.hide="hide",e.toggle="toggle"}(s||(s={})),function(e){e.none="none",e.flush="flush",e.forceFlush="forceFlush",e.flow="flow",e.forceFlow="forceFlow",e.new="new",e.extend="extend"}(a||(a={})),function(e){e.organization="organization",e.privacyManageVisibility="privacy_manage_visibility",e.linkedin="linkedin"}(l||(l={})),function(e){e.Cancelled="Cancelled",e.Closed="Closed",e.Confirmed="Confirmed",e.Error="Error",e.Open="Open"}(c||(c={})),function(e){e.minimal="minimal",e.focus="focus",e.standard="standard",e.minimode="minimode"}(d||(d={})),function(e){e.main="main"}(u||(u={})),function(e){e.header="header",e.subNav="subNav",e.contextualNotifications="contextualNotifications",e.end="end",e.nav="nav",e.main="main",e.start="start",e.titleBar="titleBar",e.toasts="toasts",e.notifications="notifications",e.monitor="monitor"}(g||(g={}))},382433:(e,t,o)=>{var r;o.d(t,{R:()=>r}),function(e){e.flyout="flyout",e.iFrame="iFrame",e.primary="primary",e.secondary="secondary",e.minimode="minimode"}(r||(r={}))},125386:(e,t,o)=>{var r;o.d(t,{W:()=>r}),function(e){e.WindowReady="windowReady",e.WindowUnloaded="windowUnloaded",e.WindowAppStart="windowAppStart",e.CoreInitialized="coreInitialized",e.CommandChangeType="commandEvent",e.ExperienceStarted="experienceStarted",e.CoreInitializationFailed="coreInitializationFailed",e.ExtendedEntityContainerState="extendedEntityContainerState",e.MainWindowBlockedState="mainWindowBlockedState"}(r||(r={}))},609901:(e,t,o)=>{var r,n,i,s;o.d(t,{QP:()=>r,d:()=>n,zF:()=>s}),function(e){e.standAlone="main",e.iframe="iFrame",e.secondary="MW",e.embedded="EDOM",e.worker="Worker"}(r||(r={})),function(e){e.flyout="flyout",e.main="main",e.minimode="mini",e.notifications="notifications"}(n||(n={})),function(e){e.owa="OWA",e.outlook="Outlook",e.officeOnline="OfficeOnline",e.wordWeb="WordWeb",e.word="Word",e.excelWeb="ExcelWeb",e.excel="Excel",e.powerPointWeb="PowerPointWeb",e.powerPoint="PowerPoint",e.lmsBlackBoard="BlackBoard",e.lmsCanvas="Canvas",e.lmsMoodle="Moodle",e.lmsBrightspace="Brightspace",e.lmsOther="OtherLMS",e.lmsOpenLMS="OpenLMS",e.lmsSchoology="Schoology",e.unknown="unknown",e.thirdParty="ThirdParty",e.dynamics="Dynamics",e.onePlayer="OnePlayer",e.devHost="DevHost",e.edge="Edge",e.purview="Purview"}(i||(i={})),function(e){e.userInitiated="userInitiated"}(s||(s={}))},656690:(e,t,o)=>{var r,n,i,s,a;o.d(t,{rY:()=>r,cr:()=>n,Gx:()=>i,H:()=>a}),function(e){e.ExpandTab="expandTab",e.UndoExpandTab="undoExpandTab",e.MaximizeTab="maximizeTab",e.UndoMaximizeTab="undoMaximizeTab",e.WindowInitialized="windowInitialized",e.WindowErrored="windowErrored",e.GetAadToken="aadGetToken",e.Login="login",e.GetDriveItemResponse="getDriveItemResponse",e.GetAadCurrentUser="aadCurrentUser",e.AadClearCacheForResource="aadClearCache",e.GetStateData="getStateData",e.GetLogs="getLogs",e.GetSettings="getSettings",e.TriggerAutoBrb="triggerAutoBrb",e.ShouldShowChatNotification="shouldShowChatNotification",e.GetLeaks="getLeaks",e.GetMemory="getMemory",e.UpdateWindowState="updateWindowState",e.AppStateSyncMessage="appStateSyncMessage",e.CentralDataLayerRequest="centralDataLayer:request",e.CentralDataLayerResponse="centralDataLayer:response",e.ScreenSharingControlMessage="screenSharing:controlMessage",e.HideFileViewerLoader="hideFileViewerLoader",e.StopDocStageScenario="stopDocStageScenario",e.AddScenarioMarker="addScenarioMarker",e.FilesExperienceSendData="filesExperience:sendData",e.FilesExperienceRequestData="filesExperience:requestData",e.ActivityEvent="activityEvent",e.GetAggregatedSettings="getAggregatedSettings",e.SetAggregatedSettings="setAggregatedSettings",e.GetWindowLaunchSubSteps="getWindowLaunchSubSteps",e.CreateWebview="createWebview",e.UnhandledMouseEvent="unhandledMouseEvent",e.GetHeartbeat="getHeartbeat",e.GetApolloCacheStats="getApolloCacheStats",e.GetCdlStats="getCdlStats",e.GetWindowEntityTypeStats="getWindowEntityTypeStats",e.SetTouchBar="set-touch-bar",e.ClearTouchBar="clear-touch-bar",e.LayoutChangeMessage="layoutChangeMessage",e.UnhandledShortcut="unhandledShortcut",e.NavigateToOpenerLandmark="NavigateToOpenerLandmark",e.NavigateToLandmark="NavigateToLandmark",e.HybridRouteNavigation="hybridRouteNavigation",e.FocusManagementEvent="focusManagementEvent",e.FocusResetEvent="focusResetEvent",e.CdlRegistration="cdlRegistration",e.NotificationBannerUpdate="NotificationBannerUpdate",e.EntityCommandTimedOutAtHost="entityCommandTimedOutAtHost",e.ActivateOutlook="activateOutlook",e.RequestTabMetrics="requestTabMetrics",e.SendWebviewIdentity="sendWebviewIdentity",e.HasDevicePermissions="hasDevicePermissions",e.HasDevicePermissionsCallback="hasDevicePermissionsCallback"}(r||(r={})),function(e){e.GlobalWindowError="error",e.UnhandledRejection="unhandledrejection"}(n||(n={})),function(e){e.Create="createIframe",e.Destroy="destroyIframe",e.ChildReady="iframeReady",e.Acquired="iframeAcquired",e.ToggleMinimized="toggleChatMinimize"}(i||(i={})),function(e){e.ConversationOpened="conversationOpened",e.CreateNewConversation="createNewConversation",e.EmbedClientInitializationSuccess="embedClientInitializationSuccess",e.EmbedClientInitializationFail="embedClientInitializationFail",e.NewConversationResolved="newConversationResolved",e.SetFocusOnChatList="setFocusOnChatList",e.UpdateSettings="UpdateSettings",e.ShowCoreIFrame="ShowCoreIFrame",e.HideCoreIFrame="HideCoreIFrame",e.TeamsPreAuthComplete="teamsPreAuthComplete",e.ContinueWithTeamsCoreTasks="continueWithTeamsCoreTasks"}(s||(s={})),function(e){e.LogoutSuccess="logoutSuccessful",e.LogoutFailed="logoutFailed",e.Logout="logout"}(a||(a={}))},530014:(e,t,o)=>{o.d(t,{G:()=>n});var r=o(599768);class n extends Error{get extensions(){return this.getExtensions()}constructor({type:e,code:t,message:o,originSlotName:r,originAppId:n,prevError:i,userContextId:s}){var a;super(o),this.type=e,this.code=t,this.originSlotName=r,this.originAppId=n,this.prevError=i,this.userContextId=s;const l=function(e){var t;return null!==(t=null==e?void 0:e.split("\n").slice(1))&&void 0!==t?t:[]}(null!==(a=null==i?void 0:i.stack)&&void 0!==a?a:this.stack);this.stack=[`${t} Error: ${o}`,...l].join("\n"),Object.setPrototypeOf(this,new.target.prototype)}static isFunction(e){return"function"==typeof e}getBoundaryProps(){return{title:`default_${this.type.toLowerCase()}_title`,description:`default_${this.type.toLowerCase()}_description`}}toTelemetryEntry(){var e,t;let o=this.toTelemetryCode(),i=this.prevError;for(;i;)i instanceof n&&n.isFunction(i.toTelemetryEntry)?(o+=i.toTelemetryEntry(),i=void 0):(0,r.a)(i)?(o+=`[IError::${i.code}]`,i=null!==(e=i.innerError)&&void 0!==e?e:null===(t=i.reason)||void 0===t?void 0:t.innerError):(o+=`[Error::${i.message}]`,i=void 0);return o}toJSON(){return{type:this.type,code:this.code,stack:this.stack,userContextId:this.userContextId,prevError:this.prevError}}serialize(){const e=new WeakSet;return JSON.stringify(this,((t,o)=>{if("object"==typeof o&&null!==o){if(e.has(o))return;e.add(o)}return o}))}deserialize(e){this.stack=e.stack}toTelemetryCode(){return`[${this.type}::${this.code}]`}getExtensions(){return{type:this.type,code:this.code,prevError:this.prevError,boundaryProps:this.getBoundaryProps()}}}},5575:(e,t,o)=>{o.d(t,{$:()=>r,G:()=>c});var r,n=o(530014),i=o(762757),s=o(599768);!function(e){e.CDL_WORKER_FAILURE="CDL_WORKER_FAILURE",e.CLEANUP="CLEANUP",e.CORE_SERVICES_MISSING="CORE_SERVICES_MISSING",e.CREATE_USER_CONTEXT_FAILED_GENERIC="CREATE_USER_CONTEXT_FAILED_GENERIC",e.CREATE_WINDOW_WRAPPER="CREATE_WINDOW_WRAPPER",e.DISABLED_BY_ADMIN="DISABLED_BY_ADMIN",e.EXPERIENCE_DISABLED="EXPERIENCE_DISABLED",e.GET_CURRENT_CLOUD_FAILED="GET_CURRENT_CLOUD_FAILED",e.INVALID_INTENT_OVERRIDE="INVALID_INTENT_OVERRIDE",e.LAUNCH_CLOUD_DEEPLINK_ERROR="LAUNCH_CLOUD_DEEPLINK_ERROR",e.LAYOUT_ERROR="LAYOUT_ERROR",e.LAYOUT_ERROR_USER_BLOCKED="LAYOUT_ERROR_USER_BLOCKED",e.LAYOUT_PHASE_STATE_MACHINE_TIMEOUT="LAYOUT_PHASE_STATE_MACHINE_TIMEOUT",e.NETWORK_OFFLINE="NETWORK_OFFLINE",e.NETWORK_OFFLINE_USER_BLOCKED="NETWORK_OFFLINE_USER_BLOCKED",e.RENDERING_CONTEXT_DOES_NOT_EXIST="RENDERING_CONTEXT_DOES_NOT_EXIST",e.UNKNOWN="UNKNOWN",e.TELEMETRY_PRIMARY_USER_SET_FAILURE="TELEMETRY_PRIMARY_USER_SET_FAILURE",e.USER_DOES_NOT_EXIST="USER_DOES_NOT_EXIST",e.USER_NOT_AUTHENTICATED="USER_NOT_AUTHENTICATED",e.USERCONTEXTID_EMPTY="USERCONTEXTID_EMPTY",e.WINDOW_UNDEFINED="WINDOW_UNDEFINED"}(r||(r={}));const a={CDL_WORKER_FAILURE:"Cdl worker did not start up properly.",DISABLED_BY_ADMIN:"Please switch back to classic Teams.",EXPERIENCE_DISABLED:"We can't wait to show you the new Teams, but we're not quite ready for you. We'll let you know when it's time.",LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:"Layout phase state machine has timed out triggering a view tear down.",TELEMETRY_PRIMARY_USER_SET_FAILURE:"This can result from a failure to load the PIE api, a failure to call maglev, or a failure to set primary user in the telemetry web worker"},l={CREATE_USER_CONTEXT_FAILED_GENERIC:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},DISABLED_BY_ADMIN:{title:"default_disabledbyadmin_title",description:"default_disabledbyadmin_description",actions:["SWITCH_TO_CLASSIC","SIGN_OUT"],icon:i.P.NoLongerAllowed},EXPERIENCE_DISABLED:{title:"default_experiencedisabled_title",description:"default_experiencedisabled_description",actions:["SIGN_OUT"],icon:i.P.NoLongerAllowed},LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},NETWORK_OFFLINE:{title:"default_nonetwork_title",description:"error_nonetwork_text"},NETWORK_OFFLINE_USER_BLOCKED:{title:"default_nonetwork_title",description:"error_nonetwork_text",actions:["RESTART"]},CDL_WORKER_FAILURE:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},LAYOUT_ERROR:{title:"default_unknown_title",description:"",actions:[]},LAYOUT_ERROR_USER_BLOCKED:{title:"default_unknown_title",description:"",actions:["RESTART"]},RENDERING_CONTEXT_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},USER_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]}};class c extends n.G{constructor(e,t,o,r){var n,i,l,c,d;super({type:"CoreError",code:e,message:null!==(n=a[e])&&void 0!==n?n:(0,s.a)(t)?null!==(l=null===(i=t.innerError)||void 0===i?void 0:i.message)&&void 0!==l?l:null===(d=null===(c=t.reason)||void 0===c?void 0:c.innerError)||void 0===d?void 0:d.message:null==t?void 0:t.message,originSlotName:r,prevError:t,userContextId:o})}getBoundaryProps(){var e;return null!==(e=l[this.code])&&void 0!==e?e:{title:"default_core_title",description:"default_core_description"}}static fromSerialized(e){if("CoreError"!==(null==e?void 0:e.type))return null;const t=new c(e.code,e.prevError,e.userContextId);return t.deserialize(e),t}}},682265:(e,t,o)=>{o.d(t,{Y:()=>n});var r=o(530014);class n extends r.G{constructor(e,t){super({type:"TrustedTypeError",code:e,prevError:t})}}},762757:(e,t,o)=>{var r;o.d(t,{P:()=>r,X:()=>n}),function(e){e.DefaultDark="defaultDark",e.Default="default",e.NoLongerAllowed="noLongerAllowed"}(r||(r={}));const n={[r.DefaultDark]:"/evergreen-assets/illustrations/error/something-went-wrong-v2-dark.svg",[r.Default]:"/evergreen-assets/illustrations/error/something-went-wrong-v2.svg",[r.NoLongerAllowed]:"/evergreen-assets/illustrations/error/license-error-no-longer-allowed-hero.svg"}},599768:(e,t,o)=>{function r(e){const t=e;return"string"==typeof(null==t?void 0:t.code)}o.d(t,{a:()=>r})},247554:(e,t,o)=>{o.d(t,{n:()=>ie});var r=o(125386),n=o(609901),i=o(382433),s=o(915929),a=o(905581),l=o(132756);class c{constructor(e,t){this.shellComms=e,this.globalWindow=t,this.defaultRequestTimeoutMs=3e4,this.bufferInTimeout=5e3}postMessage(e,t){const o={eventId:e,payload:t,correlationId:(0,s.v4)()};this.shellComms.postMessage(o)}requestMessage(e,t,o=this.defaultRequestTimeoutMs){let r;const n=(0,s.v4)(),i=((null==t?void 0:t.timeout)||o)+this.bufferInTimeout;return new Promise(((o,s)=>{const c=t=>{this.globalWindow.clearTimeout(r),t&&!t.error?o(t.payload):s((0,a.Tr)(l.w5.ShellService,l.jK.RemoteOperationFailed,"requestMessage",{eventName:e,error:t&&t.error,correlationId:n},"Received an error from IPC"))};r=this.globalWindow.setTimeout((()=>{this.shellComms.remove(e,c),s((0,a.Tr)(l.w5.ShellService,l.jK.TimedOut,"requestMessage",{eventName:e,correlationId:n}))}),i),this.shellComms.once(e,c,n);const d={eventId:e,correlationId:n,payload:t};this.shellComms.postMessage(d)}))}addEventListener(e,t,o){o&&o.once?this.shellComms.once(e,t):this.shellComms.on(e,t)}removeEventListener(e,t){t?this.shellComms.remove(e,t):this.shellComms.removeAll(e)}open(e,t,o){const r={openType:e,openHandler:t,handlerParams:o};this.postMessage("requestShellToOpen",r)}}class d{constructor(e,t,o){this._globalWindow=e,this.shellComms=t,this.envPerformance={getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}};const{isInCypressFrame:r,isInIframe:s}=o;let a=n.QP.standAlone;this.viewportContext=i.R.primary,s&&!r?(a=n.QP.iframe,this.viewportContext=i.R.iFrame):null!==this._globalWindow.opener&&(a=n.QP.secondary,this.viewportContext=i.R.secondary),this._hostedWindowContext=Object.assign(Object.assign({},o),{panelContext:a,startReason:n.zF.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__}),this.opener=new c(this.shellComms,this._globalWindow)}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){}setTimeout(...e){return this._globalWindow.setTimeout(...e)}clearTimeout(...e){return this._globalWindow.clearTimeout(...e)}}var u=o(301835),g=o(433728);var h=o(228846);class p{constructor(e,t){this.getObservableOn=e=>{const t=this.observableCache,o=t.get(e);if(o)return o;const r=new h.xQ;return t.set(e,r),r},this.next=e=>{this.logger.debug("Incoming message received. Filtering through cached observables.");const t=e.metaData.destination.channel,o=this.observableCache.get(t);o&&o.next(e)},this.error=e=>{const t=e.message?e.message:e;this.logger.error(`Internal Message Source emitted an error - {${t}}. Completing then clearing all observables from cache...`),this.completeAndClearCache()},this.complete=()=>{this.logger.debug("Internal Message Source completed. Completing then clearing all observables from cache..."),this.completeAndClearCache()},this.completeAndClearCache=()=>{this.observableCache.forEach((e=>e.complete())),this.observableCache.clear(),this.logger.debug("Cache cleared")},this.logger=t,this.observableCache=new Map,e.subscribe(this)}}const m="multi-window-manager-channel";var E=o(545618),v=o(168616),_=o(275742);const f=/^https:\/\/local\.teams\.(office|live)\.com(:8080)?$/;function w(e,t){return t.some((t=>{if(t.startsWith("regex:")){const o=t.replace("regex:","");return new RegExp(o).test(e)}return t===e}))}function S(e){return f.test(new URL(e).origin)}const C=(e,t,o,r)=>{const n=E.y.create((n=>{e.addEventListener("message",(e=>{const{eventId:i,channel:s}=e.data;e&&i&&s===m&&function(e,t,o){var r,n,i;const s=o.newLogger("PostMessage origin validation","services-io-browser-shell-message-passing-browser"),a=e.origin;return t?!("*"!==t&&!S(a)&&((0,_.isArray)(t)?0===t.length?(null===(r=s.errorToTelemetry)||void 0===r||r.call(s,`PostMessage is disabled for this experience. (case 5) ${a}`,"core_origin_validation_failed",void 0,!0),1):!w(a,t)&&(null===(n=s.errorToTelemetry)||void 0===n||n.call(s,`Event origin is not in allow-list. Event was dropped. (case 4) ${a}`,"core_origin_validation_failed",void 0,!0),1):(null===(i=s.errorToTelemetry)||void 0===i||i.call(s,`Could not match the event origin. Event was dropped. (case 6) ${a}`,"core_origin_validation_failed",void 0,!0),1))):(s.debug("PostMessage is enabled for backwards compatibility. No postMessageConfig is set on this experience. https://aka.ms/tmp-post-message-config (case1 )"),!0)}(e,o.postMessageConfig,r)&&(t.debug("Incoming message from post messages"),n.next(e.data))}))})).pipe((0,v.B)());return n};class R{constructor(e,t,o,r){this.opt=r,this.postMessage=e=>{var t,o;if((0,_.isArray)(this.opt.postMessageConfig)&&0===this.opt.postMessageConfig.length)return void(null===(o=(t=this.logger).errorToTelemetry)||void 0===o||o.call(t,"postMessageConfig is set to empty array. No outgoing post messages are allowed","core_origin_validation_failed",void 0,!0));this.logger.log("Sending targeted message to host browser only");const r=null!==e.payload&&"object"==typeof e.payload?Object.assign({},e.payload):{payload:e.payload};this.windowReference.parent.postMessage({channel:m,payload:Object.assign(Object.assign({},r),{channel:e.channel})},((e,t,o)=>{const r=new URL(e.location.href).origin;let n;if(!t||"*"===t)return"*";if(e.document.referrer)try{n=new URL(e.document.referrer).origin}catch(t){o.error(`Invalid referrer: ${e.document.referrer}`)}return n?n===r||S(n)||w(n,t)?n:(o.error(`Invalid target origin (${n}). Source origin (${r}) was returned as target origin.`),r):(o.log(`Could not determine target origin. Falling back to source origin: ${r}`),r)})(this.windowReference,this.opt.postMessageConfig,this.logger))},this.broadcast=()=>{},this.asObservable=e=>this.shellChannelCache.getObservableOn(e).pipe((0,g.U)((e=>(e=>({channel:e.metaData.destination.channel,payload:e.payload}))(e)))),this.createShellChannelCache=(e,t,o,r)=>{t.debug("Creating Shell Channel cache");const n=C(e,t,o,r);return new p(n,t)},this.logger=o.newLogger("RndrShComm","services-io-browser-shell-message-passing-browser"),this.processId=e,this.windowReference=t,this.shellChannelCache=this.createShellChannelCache(this.windowReference,this.logger,this.opt,o)}}const I="main_process",T="main_renderer";var b;!function(e){e[e.Request=0]="Request",e[e.Response=1]="Response"}(b||(b={}));var y=o(688506),A=o(848280),O=o(320155),L=o(57931),x=o(701129),D=o(613477),N=o(457333),F=o(568587),M=o(135671);const k=5*o(726727).gT.MILLI_PER_SECOND;class U{constructor(e,t,o){this.createResponseFunction=(e,t,o)=>r=>{const n=this.messagePassingService,i={direction:b.Response,responsePayload:r,procedureSignature:o},s={channel:t,payload:i};this.logger.log(`Sending response with signature: ${o}`),n.postMessage(s,[e])};if(3!==arguments.length||e.trim().length<=0)throw(0,a.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof U);this.logger=o,this.messagePassingService=t,this.metaData={requestId:e}}send(e,t,o=k){const r=this.messagePassingService,n=this.metaData,i=r.processId,a=n.requestId,l=s.v4(),c=t?[t]:r.processId!==I?[I]:[T],d={channel:a,payload:{direction:b.Request,senderProcessId:i,procedureSignature:l,requestPayload:e}};this.logger.log(`Invoking procedure on ${t} with id, ${l}`);const u=(0,y.c)().pipe((0,L.x)((()=>r.postMessage(d,c)))),g=r.asObservable(a).pipe((0,x.h)((e=>e.payload.direction===b.Response)),(0,D.zg)((e=>{const t=e.payload;return t.procedureSignature===l?(0,A.of)(t.responsePayload):(0,y.c)()})));return(0,O.z)(u,g).pipe((0,N.P)(),(0,F.V)(o))}sendAsPromise(e,t,o=k){return this.logger.debug("Invoking procedure as promise"),new Promise(((r,n)=>{this.send(e,t,o).subscribe((e=>{r(e)}),(e=>{n(e)}))}))}asObservable(){const e=this.messagePassingService,t=this.metaData.requestId;return this.logger.debug("Retreiving observable on request-response procedure"),e.asObservable(t).pipe((0,x.h)((e=>e.payload.direction===b.Request)),(0,M.b)((e=>{this.logger.log(`Incoming request with signature - ${e.payload.procedureSignature}`)})),(0,g.U)((e=>{const o=e.payload,r=o.procedureSignature,n=o.requestPayload,i=o.senderProcessId;return{payload:n,respond:this.createResponseFunction(i,t,r)}})))}}var P=o(644049),W=o(293033),B=o(706007);class z{constructor(e,t,o){this.setState=e=>{const t=this.metaData,o={lastAuthorMetaData:t,newState:e};this.logger.debug(`Process, ${t.authorId}, is setting the state`),this.stateUpdateSource.next(o)},this.asObservable=()=>(this.logger.debug("Retreiving observable on the state"),this.distinctStateUpdates.pipe((0,g.U)((e=>e.newState)))),this.setupContinuousSyncronizationAcrossShellBoundary=()=>{const e=this.messagePassingService,t=this.metaData,o=this.logger,r=this.stateUpdateSource,n=this.distinctStateUpdates,i=t.storeId;n.pipe((0,x.h)((e=>e.lastAuthorMetaData.authorId===this.metaData.authorId)),(0,M.b)((()=>o.debug("Broadcasting state update")))).subscribe((t=>{const o={payload:t,channel:i};e.broadcast(o)})),e.asObservable(i).pipe((0,x.h)((e=>e.payload.lastAuthorMetaData.authorId!==t.authorId)),(0,M.b)((()=>o.log("State update incoming from message passing service")))).subscribe((e=>{r.next(e.payload)}))},this.setupInitialStateSynchronizationRequest=()=>{const e=this.metaData,t=this.distinctStateUpdates,o=this.messagePassingService,r=e.storeId,n=r.concat("-initial-sync-request");t.pipe((0,M.b)((()=>this.logger.debug("State updated. SwitchMapping to observable on incoming sync requests"))),(0,W.w)((()=>o.asObservable(n)),((e,t)=>{const o=t.payload.requesterMetaData.authorId;return{syncResponseMessage:{channel:r,payload:e},targetId:o}})),(0,M.b)((({targetId:e})=>this.logger.debug(`Incoming initial sync request from ${e}.`)))).subscribe((({syncResponseMessage:e,targetId:t})=>{o.postMessage(e,[t])}));const i={channel:n,payload:{requesterMetaData:e}};this.logger.debug("Sending out initial synchronization request..."),o.broadcast(i)};if(3!==arguments.length||e.trim().length<=0)throw(0,a.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof z);const r=t.processId;this.logger=o,this.messagePassingService=t,this.metaData={storeId:e,authorId:r};this.stateUpdateSource=new P.t(1),this.distinctStateUpdates=this.stateUpdateSource.pipe((0,B.x)(((e,t)=>(0,_.isEqual)(e,t)))),this.setupContinuousSyncronizationAcrossShellBoundary(),this.setupInitialStateSynchronizationRequest()}}class j{constructor(e,t,o){if(3!==arguments.length||e.trim().length<=0)throw(0,a.Tr)("Invalid constructor arguments",l.jK.InvalidInput,typeof j);this.logger=o,this.messagePassingService=t,this.metaData={streamId:e}}next(e,...t){const o=this.metaData,r=this.messagePassingService,n=t&&t.length>0?t:this.messagePassingService.processId!==I?[I]:[T],i={channel:o.streamId,payload:e};this.logger.debug(`Invoking stream on targets: ${JSON.stringify(n)}.`),r.postMessage(i,n)}asObservable(){const e=this.messagePassingService,t=this.metaData.streamId;return e.asObservable(t).pipe((0,g.U)((e=>e.payload)),(0,M.b)((()=>{this.logger.debug("Handling stream event.")})))}}class Y{constructor(e,t){if(this.getRequest=e=>new U(e,this.messagePassingService,this.loggerFactory.newLogger(`ShRqst${e}`,"services-io-browser-shell-communication-provider")),this.getStream=e=>new j(e,this.messagePassingService,this.loggerFactory.newLogger(`ShStrm${e}`,"services-io-browser-shell-communication-provider")),this.getStore=e=>new z(e,this.messagePassingService,this.loggerFactory.newLogger(`ShStr${e}`,"services-io-browser-shell-communication-provider")),!e||!t)throw(0,a.Tr)(`sc: ${e}, lf: ${t}`,l.jK.Undefined,typeof Y);this.messagePassingService=e,this.loggerFactory=t}}var K=o(125374),H=o(442755);class q{constructor(e,t){if(this.windowReference=e,this.opt=t,!this.windowReference)throw(0,a.Tr)(l.w5.ShellService,l.jK.Undefined,"constructor");const o={error:()=>{},warn:()=>{},debug:()=>{},info:()=>{},log:()=>{}},r={newLogger:()=>o},n=new R("browserWindow",this.windowReference,r,this.opt);this.shellComms=new Y(n,r),this.subscriptionManager=new h.xQ}postMessage(e){this.shellComms.getStream(e.eventId).next(e)}on(e,t,o=""){this.createSubscription(e,t,!1,o)}once(e,t,o=""){this.createSubscription(e,t,!0,o)}remove(e,t){this.subscriptionManager.next({channel:e,listener:t})}removeAll(e){this.subscriptionManager.next({channel:e})}createSubscription(e,t,o,r){const n=this.shellComms.getStream(e).asObservable().pipe(this.filterWrapper((e=>{var t;const o=(null==e?void 0:e.correlationId)||(null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.correlationId);return!e||!o||o===r}))),i=this.registerForUnsubscription(e,t);(o?n.pipe((0,K.q)(1),(0,H.R)(i)):n.pipe((0,H.R)(i))).subscribe((e=>{t({payload:e})}),(e=>{throw(0,a.Tr)(l.w5.ShellService,l.jK.RemoteOperationFailed,"createSubscription",{errorMsg:(0,a.B9)(e)})}))}registerForUnsubscription(e,t){return this.subscriptionManager.pipe(this.filterWrapper((o=>o.channel===e&&(void 0===o.listener||o.listener===t))))}filterWrapper(e){return(0,x.h)(e)}}class ${constructor(e,t){this.globalWindow=e,this.opt=t}configureShell(e){const t=this.globalWindow,o=this.createShellCommService(this.globalWindow,this.opt),r=new d(this.globalWindow,o,e);return{hostedWindowContext:r.getHostedWindowContext(),window:(0,u.So)(t,r,!1)}}createShellCommService(e,t){return new q(e,t)}}class G{constructor(e,t,o,s){this.envPerformance=e,this._globalWindow=t,this.shellComms=o,this._hostedWindowContext=Object.assign(Object.assign({},s),{panelContext:n.QP.secondary,startReason:n.zF.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__}),this.viewportContext=i.R.iFrame,this.opener=new c(o,this._globalWindow),this._globalWindow.addEventListener("unload",(()=>{this.shellComms.postMessage({eventId:r.W.WindowUnloaded})}))}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){const e={eventId:r.W.WindowAppStart};this.shellComms.postMessage(e)}setTimeout(...e){return this._globalWindow.setTimeout(...e)}clearTimeout(...e){return this._globalWindow.clearTimeout(...e)}}var X,V=o(656690);!function(e){e.WindowMinimize="child-window-minimize",e.WindowMaximize="child-window-maximize"}(X||(X={}));const Q="experience-renderer-channel";class J{constructor(e){this.ipcRenderer=e,this.onceListenerLookup={},this.listenerLookup={},this.ipcRenderer.on(Q,((e,t)=>{if(t&&t.eventId){const e=`${t.eventId}${t.correlationId||""}`;this.onceListenerLookup[e]?(this.onceListenerLookup[e].forEach((e=>e(t))),delete this.onceListenerLookup[e]):this.listenerLookup[e]&&this.listenerLookup[e].forEach((e=>{e(t)}))}}))}postMessage(e){switch(e.eventId){case V.rY.ActivityEvent:case V.rY.CreateWebview:case V.rY.GetWindowLaunchSubSteps:case V.rY.SetTouchBar:case V.rY.ClearTouchBar:case V.rY.ActivateOutlook:case V.rY.RequestTabMetrics:case V.rY.HasDevicePermissionsCallback:this.ipcRenderer.send(Q,e);break;case r.W.CoreInitialized:case V.rY.WindowInitialized:this.ipcRenderer.send(Q,e),this.ipcRenderer.sendToHost(Q,e);break;default:this.ipcRenderer.sendToHost(Q,e)}}on(e,t,o=""){const r=`${e}${o}`;this.listenerLookup[r]||(this.listenerLookup[r]=[]),this.listenerLookup[r].push(t)}once(e,t,o=""){const r=`${e}${o}`;this.onceListenerLookup[r]||(this.onceListenerLookup[r]=[]),this.onceListenerLookup[r].push(t)}remove(e,t){e&&t&&(this.onceListenerLookup[e]&&(this.onceListenerLookup[e]=this.onceListenerLookup[e].filter((e=>e!==t)),0===this.onceListenerLookup[e].length&&delete this.onceListenerLookup[e]),this.listenerLookup[e]&&(this.listenerLookup[e]=this.listenerLookup[e].filter((e=>e!==t)),0===this.listenerLookup[e].length&&delete this.listenerLookup[e]))}removeAll(e){delete this.onceListenerLookup[e],delete this.listenerLookup[e]}}class Z{constructor(e){this.windowHandle=e,this.ipcRenderer=this.windowHandle.desktop.ipcRenderer,this.webViewCommService=new J(this.ipcRenderer),this.browserShellCommService=new q(e,{})}postMessage(e){switch(e.eventId){case V.rY.ActivityEvent:case V.rY.CreateWebview:case V.rY.GetWindowLaunchSubSteps:case V.rY.SetTouchBar:case V.rY.ClearTouchBar:this.ipcRenderer.send(Q,e);break;case r.W.CoreInitialized:case V.rY.WindowInitialized:this.ipcRenderer.send(Q,e),this.browserShellCommService.postMessage(e);break;default:this.browserShellCommService.postMessage(e)}}on(e,t,o=""){this.webViewCommService.on(e,t,o),this.browserShellCommService.on(e,t,o)}once(e,t,o=""){this.webViewCommService.once(e,t,o),this.browserShellCommService.once(e,t,o)}remove(e,t){this.webViewCommService.remove(e,t),this.browserShellCommService.remove(e,t)}removeAll(e){this.webViewCommService.removeAll(e),this.browserShellCommService.removeAll(e)}}class ee{constructor(e){this.globalWindow=e}configureShell(e){const t=this.globalWindow,{isInIframe:o}=e,r=this.extractPerformanceTooling(t),n=o?new Z(t):new J(t.desktop.ipcRenderer),i=new G(r,t,n,e);return Object.keys(t.desktop).forEach((e=>{"perf"!==e&&delete t.desktop[e]})),{hostedWindowContext:i.getHostedWindowContext(),window:(0,u.So)(t,i,!1)}}extractPerformanceTooling(e){return e.desktop.perf||{getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}}}}var te=o(772580);class oe{constructor(e){this.windowEnvironment=e}configure(e){const t={isInCypressFrame:re(this.windowEnvironment),isInIframe:ne(this.windowEnvironment)};t.isInIframe&&function(e){var t;if(e.navigator){if("Electron"===te.getParser(null===(t=e.navigator)||void 0===t?void 0:t.userAgent).getBrowserName())return!0}return!1}(this.windowEnvironment)&&function(e){var t;try{const o=e.parent;if(!o||!function(e){return!(!e||!e.electronSafeIpc)}(o))return;e.desktop={perf:null===(t=o.desktop)||void 0===t?void 0:t.perf,ipcRenderer:o.electronSafeIpc},e.createInterprocessStore=o.createInterprocessStore,e.vdiSettings=o.vdiSettings}catch(e){return}}(this.windowEnvironment);return(function(e){return!!(e&&e.desktop&&e.desktop.ipcRenderer)}(this.windowEnvironment)?new ee(this.windowEnvironment):new $(this.windowEnvironment,e)).configureShell(t)}}function re(e){try{let t=!!e.Cypress;if(!t){const o=e.top||e.parent;t=!!(null==o?void 0:o.Cypress)}return t}catch(e){return!1}}function ne(e){try{return e.self!==e.top}catch(e){return!0}}class ie{constructor(){this._opt={};const e=new oe(window);this.config=e.configure(this._opt),this.config.window.opener.postMessage(r.W.WindowReady)}set opt(e){Object.keys(e).forEach((t=>{this._opt[t]=e[t]}))}static getInstance(){return ie.instance||(ie.instance=new ie),ie.instance}get window(){return this.config.window}}},301835:(e,t,o)=>{o.d(t,{YR:()=>R,dP:()=>S,So:()=>w});var r=o(850402),n=o(50805),i=o(446652),s=o(419925),a=o(382433),l=o(5575);function c(e){return e.ResizeObserver?e.ResizeObserver:function(t){const o=new Map;let r,n=!1;function i(){if(n||!o.size)return void(r=void 0);const s=[];o.forEach(((e,t)=>{const r=t.getBoundingClientRect();e.height!==r.height&&(o.set(t,r),s.push({target:t,contentRect:r,borderBoxSize:[{inlineSize:r.width,blockSize:r.height}],contentBoxSize:[{inlineSize:r.width,blockSize:r.height}],devicePixelContentBoxSize:[]}))})),s.length&&t(s),r=e.requestAnimationFrame(i)}return{observe(t){o.has(t)||(o.set(t,t.getBoundingClientRect()),r||(r=e.requestAnimationFrame(i)))},unobserve(e){o.has(e)&&o.delete(e)},disconnect(){o.clear(),r=void 0,n=!0}}}}var d=o(682265),u=o(614665);class g{constructor(e,t){this._document=e,this._chunkConfig=t,this._loadedItems=new Map,this._loadScript=(0,u.m)(((e,t)=>new Promise(((o,r)=>{if(!e)return o();const n=this._document.createElement("script");if(n.onload=()=>o(),n.onerror=r,n.async=!0,n.id=`${t}-script`,n.charset="utf-8",!this._coreSecurityService)throw new d.Y("DEVELOPER_ERROR",new Error("Chunkloader core security service is not defined. This should never happen"));try{const t=this._coreSecurityService.getTrustedTypePolicy("@msteams/services-utilities-common#ChunkLoader").createScriptURL(e,n.baseURI);n.src=t}catch(e){throw e}this._document.body.appendChild(n)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this._loadStyle=(0,u.m)(((e,t)=>new Promise(((o,r)=>{if(!e)return o();const n=this._document.createElement("link");n.onload=()=>o(),n.onerror=r,n.type="text/css",n.rel="stylesheet",n.id=`${t}-style`,n.charset="utf-8",n.href=e,this._document.head.appendChild(n)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this.loadChunk=(e,t=!1)=>(0,r.__awaiter)(this,void 0,void 0,(function*(){if(!this._chunkConfig)throw new Error("Chunk loading is not supported in this window or host.");const o=e.reduce(((e,o)=>{const r=this._chunkConfig&&this._chunkConfig[o];if(!r)return e.push(Promise.reject(new Error(`No chunk information found for ${r}.`))),e;const n=r.endsWith(".css")?this._loadStyle:this._loadScript,i=this._loadedItems.get(r)||n(r,o).catch((e=>{throw t&&this._loadedItems.delete(r),e}));return this._loadedItems.has(r)||this._loadedItems.set(r,i),e.push(i),e}),[]);yield Promise.all(o)}))}configureCoreSecurityService(e){if(this._coreSecurityService)throw new d.Y("DUPLICATE_POLICY_FOUND",new Error("ChunkLoader::coreSecurityService is already defined. Developer should not be calling configureCoreSecurityService multiple times in it's context"));e&&(this._coreSecurityService=e)}}var h=o(824303),p=o(688506),m=o(135671),E=o(57931),v=o(706007);const _=(e,t,o)=>{const{interprocessStoreService:r,loggerFactory:n,platformService:s}=o||{},a=null==n?void 0:n.newLogger("WindowUtilities","services-io-browser-shell");if((null==s?void 0:s.config.clientType)===i.Bh.Desktop)return r?r.onWindowFullscreen(t).pipe((0,m.b)((e=>null==a?void 0:a.log(`WindowHook[onFullscreen] update to: ${e}`)))):(null==a||a.error("WindowHook[onFullscreen] on desktop failed due to interprocessStoreService missing"),new h.X(!1));{const t=e,o=new h.X(f(t)),r=new t.ResizeObserver((()=>{t.requestAnimationFrame((()=>{o.next(f(t))}))}));return r.observe(t.document.documentElement),o.pipe((0,E.x)((()=>r.disconnect())),(0,v.x)())}},f=e=>!(!e.matchMedia("(display-mode: fullscreen)").matches&&!e.document.fullscreenElement),w=(e,t,o)=>{var n,i,s,a,d;let u;try{u={DOMRect:e.DOMRect,loader:e.loader,loaderConfig:e.loaderConfig,preCoreUiAdapter:e.preCoreUiAdapter,Cypress:e.Cypress,document:e.document,HTMLVideoElement:e.HTMLVideoElement,Element:e.Element,emitDebugEvent:e.emitDebugEvent,external:e.external,location:e.location,history:e.history,navigator:e.navigator,caches:e.caches,crypto:e.crypto,parent:e.parent,self:e.self,top:e.top,performance:e.performance,msCrypto:e.msCrypto&&e.msCrypto,IntersectionObserver:e.IntersectionObserver,ResizeObserver:c(e),WeakRef:e.WeakRef,chunkLoader:new g(e.document,e.__experienceWindowChunks__),screen:e.screen,viewportContext:t.viewportContext,chrome:e.chrome,open:e.loader&&e.loader.openWindow?e.loader.openWindow.bind(e.loader):e.open.bind(e),getLoadingWindow:(null===(n=e.loader)||void 0===n?void 0:n.getLoadingWindow)&&e.loader.getLoadingWindow.bind(e.loader),fetch:e.fetch&&e.fetch.bind(e),close:e.close.bind(e),alert:e.alert.bind(e),requestAnimationFrame:e.requestAnimationFrame.bind(e),cancelAnimationFrame:e.cancelAnimationFrame.bind(e),requestIdleCallback:e.requestIdleCallback?e.requestIdleCallback.bind(e):e.requestAnimationFrame.bind(e),cancelIdleCallback:e.cancelIdleCallback?e.cancelIdleCallback.bind(e):e.cancelAnimationFrame.bind(e),scheduler:e.scheduler,setInterval:e.setInterval.bind(e),clearInterval:e.clearInterval.bind(e),clearTimeout:e.clearTimeout.bind(e),setTimeout:e.setTimeout.bind(e),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e),dispatchEvent:e.dispatchEvent.bind(e),focus:e.focus.bind(e),getScreenDetails:()=>e.getScreenDetails?e.getScreenDetails():Promise.resolve(void 0),getSelection:e.getSelection.bind(e),getComputedStyle:e.getComputedStyle.bind(e),onpagehide:null===(i=e.onpagehide)||void 0===i?void 0:i.bind(e),setBounds:e.setBounds,setMinimumSize:e.setMinimumSize,createInterprocessStore:e.createInterprocessStore,Logging:e.Logging,matchMedia:e.matchMedia?e.matchMedia.bind(e):null,proxyPostMessage:(t,o,r)=>{e.proxyPostMessage&&e.proxyPostMessage(t,o,r)},getLocaleInfoAsync:()=>e.getLocaleInfoAsync?e.getLocaleInfoAsync():Promise.resolve(void 0),getUserMedia:t=>{var o,r;return(null===(r=null===(o=e.navigator)||void 0===o?void 0:o.mediaDevices)||void 0===r?void 0:r.getUserMedia)?e.navigator.mediaDevices.getUserMedia(t):Promise.reject(new Error("Not available"))},enumerateDevices:()=>{var e,o;return(null===(o=null===(e=t.navigator)||void 0===e?void 0:e.mediaDevices)||void 0===o?void 0:o.enumerateDevices)?t.navigator.mediaDevices.enumerateDevices():Promise.reject(new Error("Not available"))},handleGlobalWindowError:null===(s=e.handleGlobalWindowError)||void 0===s?void 0:s.bind(e),decodeURIComponent,encodeURIComponent,getDesktopCapturerSources:t=>e.getDesktopCapturerSources?e.getDesktopCapturerSources(t):Promise.reject(new Error("Not available")),get __experienceWindowChunks__(){return e.__experienceWindowChunks__},get __webpack_nonce__(){return e.__webpack_nonce__},get __VERSION__(){return e.__VERSION__},get __webpack_public_path__(){return e.__webpack_public_path__},get devicePixelRatio(){return e.devicePixelRatio},get localStorage(){return e.localStorage},get sessionStorage(){return e.sessionStorage},get indexedDB(){return e.indexedDB},get CKEDITOR(){return e.CKEDITOR},get ITEMS_VIEW_STRINGS(){return e.ITEMS_VIEW_STRINGS},get CodeMirror(){return e.CodeMirror},get MutationObserver(){return e.MutationObserver},get LivePersonaCardStrings(){return e.LivePersonaCardStrings},get LivePersonaCardHoverTargetV2(){return e.LivePersonaCardHoverTargetV2},get LPC(){return e.LPC},get SlimCore(){return e.SlimCore},get authLogger(){return e.Logging},get Microsoft(){return e.Microsoft},get Office(){return e.Office},get Image(){return e.Image},get DOMParser(){return e.DOMParser},videoRenderer:e.videoRenderer,get FrameSinkReader(){return e.FrameSinkReader},get continueExternalAuth(){return e.continueExternalAuth},set continueExternalAuth(t){e.continueExternalAuth=t},get continueMsaAuth(){return e.continueMsaAuth},set continueMsaAuth(t){e.continueMsaAuth=t},get FabricConfig(){return e.FabricConfig},set FabricConfig(t){e.FabricConfig=t},get CKEDITOR_BASEPATH(){return e.CKEDITOR_BASEPATH},get ClipboardItem(){return e.ClipboardItem},get PerformanceObserver(){return e.PerformanceObserver},get opener(){return t.opener},get envPerformance(){return t.envPerformance},getHostedWindowContext:t.getHostedWindowContext.bind(t),onAppStart:t.onAppStart.bind(t),get isHighResolution(){if(e){const t=1.3,o=e.navigator&&e.navigator.userAgent&&e.navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if(void 0!==e.devicePixelRatio&&!o)return e.devicePixelRatio>t;if(e.matchMedia){const t="(-webkit-min-device-pixel-ratio: 1.3),            (min--moz-device-pixel-ratio: 1.3),            (-o-min-device-pixel-ratio: 1.3),            (min-resolution: 120dpi)";return e.matchMedia(t).matches}}return!1},get screenX(){return e.screenX},get screenY(){return e.screenY},get innerWidth(){return e.innerWidth},get innerHeight(){return e.innerHeight},isFocused:()=>e.isFocused?e.isFocused():e.document.hasFocus(),onFullscreen:()=>new h.X(!1),exitFullscreen:()=>{},maximize:()=>{},minimize:()=>{},requestFullscreen:()=>{},show:()=>{},windowTitleDblClick:()=>{},clearCache:()=>{var t;return null===(t=e.clearCache)||void 0===t?void 0:t.call(e)},getZoomFactor:()=>e.getZoomFactor?e.getZoomFactor():0,zoomFactors:null!==(a=e.zoomFactors)&&void 0!==a?a:p.E,zoomIn:()=>e.zoomIn?e.zoomIn():void 0,zoomOut:()=>e.zoomOut?e.zoomOut():void 0,zoomReset:()=>e.zoomReset?e.zoomReset():void 0,vdiSettings:e.vdiSettings,setSelectedAudioOutputDevice:t=>e.setSelectedAudioOutputDevice?e.setSelectedAudioOutputDevice(t):Promise.resolve(),destroy:n=>(0,r.__awaiter)(void 0,void 0,void 0,(function*(){return o?new Promise(((o,r)=>{const i=t.setTimeout((()=>{try{t.clearTimeout(i);for(const e of Reflect.ownKeys(u))"windowLeakInfo"!==e&&(delete u[e],Reflect.defineProperty(u,e,{get:()=>{throw new Error(`wrapWindow: Accessing window.${e} after destroy`)},set:()=>{throw new Error(`wrapWindow: Accessing window.${e} after destroy`)}}));e.document.documentElement.innerText="",o()}catch(e){r(e)}finally{e=void 0,t=void 0}}),n+1)})):void 0}))}}catch(e){throw new l.G(l.$.CREATE_WINDOW_WRAPPER,e)}e.CKEDITOR_BASEPATH=e.CKEDITOR_BASEPATH||`${e.__webpack_public_path__||(null===(d=null==t?void 0:t.getHostedWindowContext())||void 0===d?void 0:d.__webpack_public_path__)||""}ckeditor/4.15.1-msft-11/`||"";const m=new Proxy(u,{deleteProperty:(t,o)=>delete e[o]});return u.__lpcWindowProxy=m,u};function S(e,t,o,r,i){const{coreSecurityService:s,windowProvider:a,coreSettings:l}=t,c=e,{enableDisconnectWindowWrapper:d}=l.get(n.J.Core),u=w(c,a,null!=d&&d),h=R(r,i),p=new g(c.document,a.__experienceWindowChunks__);p.configureCoreSecurityService(s);const m={chunkLoader:p,parent:a,viewportContext:h,FabricConfig:{mergeStyles:{namespace:"cw"}},exitFullscreen:()=>C("exitFullscreen",e,t,o),focus:()=>C("focus",e,t,o),maximize:()=>C("maximize",e,t,o),minimize:()=>C("minimize",e,t,o),requestFullscreen:()=>C("requestFullscreen",e,t,o),windowTitleDblClick:()=>C("windowTitleDblClick",e,t,o),onFullscreen:()=>_(e,o,t)};return Object.assign(u,m)}function C(e,t,o,r){const{interprocessStoreService:n,loggerFactory:s,platformService:a}=o,l=s.newLogger("WindowUtilities","services-io-browser-shell");if(l.log(`Performing action ${e}`),a.config.clientType===i.Bh.Desktop){if("focus"===e&&(null==t?void 0:t.document.hidden)&&(e="show"),!n)return void l.error(`WindowAction[${e}] on Desktop failed due to interprocessStoreService missing`);n[e](r).then((()=>{l.log(`WindowAction[${e}] on Desktop succeeded.`)})).catch((t=>{l.error(`WindowAction[${e}] on Desktop failed with: ${t&&t.message} (${t&&t.code})`)}))}else{const o=t;switch(e){case"exitFullscreen":o.document.exitFullscreen().catch((t=>{l.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;case"requestFullscreen":o.document.documentElement.requestFullscreen().catch((t=>{l.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;default:try{o[e]()}catch(t){l.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}}}}function R(e,t){let o;if(e)switch(t){case s.lO.minimal:o=a.R.flyout;break;case s.lO.minimode:o=a.R.minimode;break;default:o=a.R.primary}else o=a.R.secondary;return o}},765923:(e,t,o)=>{o.d(t,{J:()=>n,l:()=>i});var r=o(247554);function n(){return r.n.getInstance().window}function i(e,...t){const o=window.electronSafeIpc;o&&o.send(e,...t)}},614665:(e,t,o)=>{o.d(t,{X:()=>c,m:()=>d});var r=o(850402),n=o(682265),i=o(540929),s=o(905581),a=o(132756),l=o(827748);const c=(e,t)=>(...o)=>(0,r.__awaiter)(void 0,void 0,void 0,(function*(){for(;;)try{return yield e(...o)}catch(e){yield t(e,...o)}})),d=(e,t)=>{const{maxRetries:o,retryWindow:c,backoffTime:d,shouldRetry:u}=t,g=e=>c-(Date.now()-e);return(...t)=>(0,r.__awaiter)(void 0,void 0,void 0,(function*(){const r=Date.now();let c=0,h=g(r);for(;c++<=o&&h>0;)try{return yield Promise.resolve(e.apply(e,t))}catch(e){if(e instanceof n.Y)throw e;const t=yield(0,i.tE)(e);if(u&&!u(t))throw t?(0,s.Tr)(t.context,t.code,t.subContext?t.subContext:"",t.reason,t.message,t.serverResponse):(0,s.Tr)("RetryWithBackoff",a.jK.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${c}, RemainingTime: ${h}`);if(c>=o||g(r)<=0)break;yield(0,l._)(d),h=g(r)}throw(0,s.Tr)("RetryWithBackoff",a.jK.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${c}, RemainingTime: ${h}`)}))}},726727:(e,t,o)=>{var r,n,i;o.d(t,{gT:()=>r,lP:()=>n,ej:()=>i}),function(e){e[e.Two=2]="Two",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.TWENTY_FOUR=24]="TWENTY_FOUR",e[e.THIRTY=30]="THIRTY",e[e.ONE_HUNDRED=100]="ONE_HUNDRED",e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.MILLI_PER_MINUTE=6e4]="MILLI_PER_MINUTE",e[e.MILLISECONDS_PER_HOUR=36e5]="MILLISECONDS_PER_HOUR",e[e.MILLISECONDS_PER_DAY=864e5]="MILLISECONDS_PER_DAY"}(r||(r={})),function(e){e[e.LOAD_FRAME_TIMEOUT=15e3]="LOAD_FRAME_TIMEOUT",e[e.EXPIRE_OFFSET_SECONDS=600]="EXPIRE_OFFSET_SECONDS",e[e.MT_TOKEN_INTERVAL=12e4]="MT_TOKEN_INTERVAL",e[e.ACQUIRE_TOKEN_TIMEOUT=6e4]="ACQUIRE_TOKEN_TIMEOUT",e[e.DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES=3]="DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES",e[e.DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW=3e4]="DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW",e[e.DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME=2e3]="DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME",e[e.ELECTRON_ACQUIRE_TOKEN_TIMEOUT=22e4]="ELECTRON_ACQUIRE_TOKEN_TIMEOUT",e[e.ACQUIRE_TOKEN_SCENARIO_TIMEOUT=24e4]="ACQUIRE_TOKEN_SCENARIO_TIMEOUT",e[e.DEFAULT_SKYPE_MAX_DELAY_TIME_MS=3e4]="DEFAULT_SKYPE_MAX_DELAY_TIME_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS=15e3]="DEFAULT_SKYPE_MAX_RETRY_DURATION_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_COUNT=3]="DEFAULT_SKYPE_MAX_RETRY_COUNT",e[e.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS=1e3]="DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS",e[e.DEFAULT_SKYPE_EXP_DELAY_FACTOR=2]="DEFAULT_SKYPE_EXP_DELAY_FACTOR",e[e.DEFAULT_REGION_GTM_MIN_LENGTH=10]="DEFAULT_REGION_GTM_MIN_LENGTH"}(n||(n={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.AUTHZ_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read",e.CSA_PHONELINK_AUTH_URL="https://chatsvcagg-tfl.teams.microsoft.com/user_impersonation"}(i||(i={}))},540929:(e,t,o)=>{o.d(t,{E6:()=>s,xn:()=>a,Q6:()=>l,tE:()=>d});var r=o(850402),n=o(132756),i=o(905581);const s=e=>{if(!e)return null;const{graphQLErrors:t}=e;return t&&t.length>0&&t[0]&&t[0].originalError?(0,i.Jn)(t[0].originalError,n.w5.Apollo,n.jK.ApolloError,"getOriginalError",{status:t[0].originalError.code}):null},a=e=>{var t,o;const r=null===(o=null===(t=e.graphQLErrors)||void 0===t?void 0:t[0])||void 0===o?void 0:o.extensions;return r?r.prevError&&"UNKNOWN"===r.code?(0,i.Jn)(new Error(e.graphQLErrors[0].message),r.prevError.context,r.prevError.code,r.prevError.subContext,r.prevError.reason):(0,i.Jn)(new Error(e.graphQLErrors[0].message),r.context,r.code,r.subContext,r.reason):null},l=e=>{const t=c(e);return!(!(0,i.Wc)(t)&&!(0,i.K3)(t.reason,t.context))},c=e=>{var t,o;return null===(o=null===(t=null==e?void 0:e.graphQLErrors[0])||void 0===t?void 0:t.extensions)||void 0===o?void 0:o.prevError},d=e=>(0,r.__awaiter)(void 0,void 0,void 0,(function*(){if(!e)return null;let t=null;const{graphQLErrors:o,networkError:s}=e;var a;return s&&(t=u(s)),!t&&o&&o.length>0&&o[0].originalError&&(t=yield(a=o[0],(0,r.__awaiter)(void 0,void 0,void 0,(function*(){var e,t,o;let r=null;try{if(r=a.originalError,!(null===(e=null==r?void 0:r.serverResponse)||void 0===e?void 0:e.body))return r;const n=null===(t=null==r?void 0:r.serverResponse)||void 0===t?void 0:t.status,i=yield null===(o=null==r?void 0:r.serverResponse)||void 0===o?void 0:o.body.json();if(!m(i))return r;r.reason={status:n,errorCode:i.errorCode,errorSubCode:i.errorSubCode}}catch(e){}return r})))),t||(t=o&&o.length>0&&o[0]&&o[0].originalError?(0,i.Jn)(o[0].originalError,n.w5.Apollo,n.jK.ApolloError,"getOriginalError",{status:o[0].originalError.code}):null),t})),u=e=>{let t=null;try{const o=JSON.parse(e.message);if(o){const r=JSON.parse(o.message);if(r){const o=JSON.parse(r.reason);o&&(t=Object.assign(Object.assign({},e),{reason:{status:p(o)?o.status:void 0,errorCode:m(o)?o.errorCode:void 0}}))}}}catch(o){t=g(e)}return t},g=e=>{var t;if(!e.serverResponse)return null;const o=Object.assign({},null==e?void 0:e.reason);return(0,i.Tr)(e.context,e.code,e.subContext?e.subContext:"",Object.assign({status:e.serverResponse.status,errorCode:null!==(t=o.errorCode)&&void 0!==t?t:void 0,reason:e.reason},o),e.message,e.serverResponse)},h=e=>"number"==typeof e,p=e=>!!e&&void 0!==e.status&&h(e.status),m=e=>!!e&&void 0!==e.errorCode&&h(e.errorCode)}}]);