"use strict";(this.webpackChunk_msteams_convene=this.webpackChunk_msteams_convene||[]).push([[490516],{704361:(e,t,i)=>{i.d(t,{E:()=>a,n:()=>r});var n=i(265858);const a=({channelData:e,children:t,isLoadingData:i})=>{const a=n.useMemo((()=>({channelType:null==e?void 0:e.channelType,displayName:null==e?void 0:e.displayName,id:null==e?void 0:e.id,createdAt:null==e?void 0:e.createdAt,description:null==e?void 0:e.description,isGeneral:null==e?void 0:e.isGeneral,isArchived:null==e?void 0:e.isArchived,isDeleted:null==e?void 0:e.isDeleted,isUserMember:null==e?void 0:e.isUserMember,isUserMuted:null==e?void 0:e.isUserMuted,isChannelExternallyShared:null==e?void 0:e.isChannelExternallyShared,isLie:null==e?void 0:e.isLie,realThreadId:null==e?void 0:e.realThreadId,isCreationFailed:null==e?void 0:e.isCreationFailed,substrateGroupId:null==e?void 0:e.substrateGroupId,hostTeamId:null==e?void 0:e.hostTeamId,hostTenantId:null==e?void 0:e.hostTenantId,hostTeamGroupId:null==e?void 0:e.hostTeamGroupId,memberRole:null==e?void 0:e.memberRole,membershipSummary:null==e?void 0:e.membershipSummary,sensitivityLabel:null==e?void 0:e.sensitivityLabel,owningTeam:null==e?void 0:e.owningTeam,sharepointSiteUrl:null==e?void 0:e.sharepointSiteUrl,spaceAdminSettings:null==e?void 0:e.spaceAdminSettings,moderation:null==e?void 0:e.moderation})),[null==e?void 0:e.channelType,null==e?void 0:e.displayName,null==e?void 0:e.id,null==e?void 0:e.createdAt,null==e?void 0:e.description,null==e?void 0:e.isGeneral,null==e?void 0:e.isArchived,null==e?void 0:e.isDeleted,null==e?void 0:e.isUserMember,null==e?void 0:e.isUserMuted,null==e?void 0:e.isChannelExternallyShared,null==e?void 0:e.isLie,null==e?void 0:e.realThreadId,null==e?void 0:e.isCreationFailed,null==e?void 0:e.substrateGroupId,null==e?void 0:e.hostTeamId,null==e?void 0:e.hostTenantId,null==e?void 0:e.hostTeamGroupId,null==e?void 0:e.memberRole,null==e?void 0:e.membershipSummary,null==e?void 0:e.sensitivityLabel,null==e?void 0:e.owningTeam,null==e?void 0:e.sharepointSiteUrl,null==e?void 0:e.spaceAdminSettings,null==e?void 0:e.moderation]);return n.createElement(s.Provider,{value:i?void 0:a},t)};a.displayName="ChannelDataContextProvider";const s=n.createContext(void 0);s.displayName="ChannelDataContext";const r=()=>n.useContext(s)},138730:(e,t,i)=>{i.d(t,{f:()=>r});var n=i(265858),a=i(334330);class s extends n.Component{constructor(e){super(e),this.mounted=!1;const{i18n:t,namespace:i,namespaces:n}=e,a=(n||[]).filter((e=>!t.isNamespaceLoaded(e)));!i||t.isNamespaceLoaded(i)||a.includes(i)||a.push(i),this.state={namespacesToLoad:a}}componentDidMount(){const{i18n:e}=this.props;this.mounted=!0;const t=()=>{this.mounted&&this.setState((t=>({namespacesToLoad:t.namespacesToLoad.filter((t=>!e.isNamespaceLoaded(t)))})))};this.state.namespacesToLoad.length&&Promise.all(this.state.namespacesToLoad.map((t=>e.waitForNamespace(t)))).then(t).catch(t)}componentWillUnmount(){this.mounted=!1}render(){const{loaderRenderer:e,children:t}=this.props;return this.state.namespacesToLoad.length?e?e():null:t||null}}const r=(0,a.G)(s);r.displayName="GenericNamespaceProvider"},334330:(e,t,i)=>{i.d(t,{G:()=>s,v:()=>r});var n=i(265858),a=i(898071);const s=e=>t=>n.createElement(a.OO.Consumer,null,(i=>n.createElement(e,Object.assign({},Object.assign(Object.assign({},t),{i18n:i}))))),r=s},459989:(e,t,i)=>{i.d(t,{uH:()=>a,lS:()=>s,qi:()=>r});var n=i(516909);const a=e=>"com.microsoft.teams.callable-channel"===e||"com.microsoft.teamspace.tab.file.staticviewer.pdf"===e||"44263ed4-f1ac-4e96-93aa-d24dd50459ea"===e||"com.microsoft.teamspace.tab.web"===e,s=(e,t,i)=>{if(i){const{correlationId:a,installationScope:s,tabConfigurationData:r,threadId:o,teamId:l,isEduContext:d,isTmpLaunch:c}=i;switch(s){case n.qi6.Team:return t.platform.inContextStorePostInstall({appId:e,teamId:l,correlationId:a,isEduContext:d,isTmpLaunch:c,tabConfigurationData:r,channelId:o,name:"openTabInstanceConfigDialogForChannel",inContextStoreLaunchOptions:i});case n.qi6.GroupChat:return t.platform.inContextStorePostInstall({appId:e,correlationId:a,tabConfigurationData:r,isTmpLaunch:c,chatId:o,name:"openTabInstanceConfigDialogForChat",inContextStoreLaunchOptions:i})}}return Promise.resolve()},r=e=>"Student"===e||"Teacher"===e},950262:(e,t,i)=>{i.d(t,{M:()=>l});var n=i(850402),a=i(956255),s=i(738646);const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsStageViewUtilsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callByThreadId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var o=i(18564);const l=(e,t,i,l)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{const{convId:n}=e,d=JSON.parse(e.tabInfo);null==l||l.mark(s.ck.StageViewsAppTabInfoDestructured);const{data:c}=yield t.query({query:r,fetchPolicy:"no-cache",variables:{conversationId:n}}),u=`${e.appId}-${e.convId}-${d.tabInfo.contentUrl}-${e.reloadToggle}`;return null==l||l.mark(s.ck.StageViewsGetCallByThreadIdSuccessful),i.platform.launchStageMW({id:u,linkedEntity:(null==c?void 0:c.callByThreadId)?{id:`${n}-stageview`,type:a.py.platformstageinactivemeeting}:{id:(0,o.fd)(n,e.replyChainId),type:a.py.chats},stageOptions:e})}catch(e){throw null==l||l.mark(s.ck.StageViewsFailedBeforeCommandTrigger),e}}))},470901:(e,t,i)=>{i.d(t,{A:()=>f});var n=i(850402),a=i(248965),s=i(663945),r=i(50805),o=i(956255),l=i(419925),d=i(955105),c=i(554404),u=i(18564),m=i(516909),h=i(401717),p=i(491465);var g=i(738646);const v=(e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(i)return m.qi6.Team;if(t){const i=yield((e,t,i)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n,a;const{data:s}=yield t.query({query:p.vh,variables:{convId:e},context:{callerInfo:i}});return null!==(a=null===(n=s.chat)||void 0===n?void 0:n.isOneOnOneBotChat)&&void 0!==a&&a})))(t,e,"handleJITInstallForStageView");return i?m.qi6.Personal:m.qi6.GroupChat}return m.qi6.Personal})),_=(e,t,i,a,s,r,o,l)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=yield(0,h.yx)(a,e);null==o||o.mark(g.ck.StageViewAppDefFetched),null==l||l.mark(g.ck.StageViewAppDefFetched);if((0,h.WW)(m.qi6.Personal,n)){const t=yield(0,h.eI)(a,s,g.RG.AppInstallationDialogInstallApp,e,m.qi6.Personal,r,!0);return null==o||o.mark(g.ck.StageViewAppInstallationDone),null==l||l.mark(g.ck.StageViewAppInstallationDone),{appInstalled:!!t,appInstallScope:m.qi6.Personal}}if(i!==m.qi6.Personal&&(0,h.WW)(i,n)){const n=yield(0,h.eI)(a,s,g.RG.AppInstallationDialogInstallApp,e,i,r,!0,t);return null==o||o.mark(g.ck.StageViewAppInstallationDone),null==l||l.mark(g.ck.StageViewAppInstallationDone),{appInstalled:!!n,appInstallScope:i}}throw null==o||o.mark(g.ck.StageViewJITInstallScopeNotSupported),null==l||l.mark(g.ck.StageViewJITInstallScopeNotSupported),Error(`installScope: ${i} is not supported by app: ${e}`)}));var k=i(950262);const f=(e,t,i,o,l,d,p)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{enableCommandingTelemetryForCollabStageMW:k,enableReactStageModal:f}=t.get(r.J.Extensibility);if(!f&&e.entryPoint===c.mQ.adaptiveCardStageModal&&d)return S(e,t,i,d,void 0);let I,y;if(!k){const{phase1CollabStageScenario:t,endToEndScenario:i}=(0,u.R3)(e,o,e.entryPoint);I=t,y=i,e.launchScenarioId=i.id,e.phase1OnlyScenarioDetails={scenarioMarkerName:t.name,scenarioMarkerId:t.id}}const{appInstalled:N,appInstallScope:C}=yield((e,t,i,a,s,r)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(e.entryPoint===c.mQ.adaptiveCardCollabStage||e.entryPoint===c.mQ.adaptiveCardStageModal)return{appInstalled:!0,appInstallScope:m.qi6.Personal};const{appId:n,convId:o,replyChainId:l,channelId:d}=e,u=d||l?void 0:o,p=l?d||o:void 0,k=p||u||"";let f=m.qi6.Personal;try{f=yield v(t,u,p),null==s||s.mark(g.ck.StageViewTargetInstallationScopeConfirmed),null==r||r.mark(g.ck.StageViewTargetInstallationScopeConfirmed);const o={conversation:{id:k,scope:f},shouldFetchPersonalApps:!0},l=(yield(0,h.xJ)(t,a,i,n,!0,`jit-install-for-stage-view-${e.entryPoint}`,o)).find((e=>[m.JMQ.Installed,m.JMQ.InstalledAndFavorited,m.JMQ.InstalledAndPermanent,m.JMQ.AdminPreInstalled].includes(e.installationState)));if(l)return null==s||s.mark(g.ck.StageViewAppIsPreInstalled),null==r||r.mark(g.ck.StageViewAppIsPreInstalled),{appInstalled:!0,appInstallScope:l.installedScope};{null==s||s.mark(g.ck.StageViewAppIsNotPreInstalled),null==r||r.mark(g.ck.StageViewAppIsNotPreInstalled);const{appInstalled:e,appInstallScope:o}=yield _(n,k,f,t,i,a,s,r);return{appInstalled:e,appInstallScope:o}}}catch(e){return a.log(null==e?void 0:e.message),null==s||s.fail({errors:`JIT Install failed - ${null==e?void 0:e.message}`}),null==r||r.fail({errors:`JIT Install failed - ${null==e?void 0:e.message}`}),{appInstalled:!1,appInstallScope:f}}})))(e,i,o,l,I,y);return p&&p.recordPanelAction(((e,t,i)=>{const n=i.createDatabag(),r={actionGesture:s.uS.auto,actionOutcome:s.$K.submit,actionScenario:s.Tk.openCollabStageWindow,actionScenarioType:s.Yu.collabStage_Window,moduleName:s.rA.collabStage,moduleType:s.PO.collabStage,panelRegion:s.Ai.main,panelType:s.wh.AdaptiveCardTab,extensibilityData:{id:e,scope:t,scenarioCapability:a.Ky.tabs}};return r.dataBag=n,r})(e.appId,(e=>{let t=a.Mv.personal;switch(e){case m.qi6.Team:t=a.Mv.team;case m.qi6.GroupChat:t=a.Mv.group}return t})(C),p)),N?(null==I||I.appendEventData({"App.Scope":C}),null==y||y.appendEventData({"App.Scope":C}),S(e,t,i,d,I).catch((e=>(null==y||y.fail({errors:"Failed to launch"}),null==I||I.fail({errors:"Failed to launch"}),Promise.reject(e))))):(null==I||I.fail({errors:`App could not be installed- ${C}`}),null==y||y.fail({errors:`App could not be installed- ${C}`}),Promise.reject("App not installed"))})),S=(e,t,i,a,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){switch(e.entryPoint){case c.mQ.adaptiveCardCollabStage:return a?(0,k.M)(e,i,a,s):Promise.reject("Entity commanding not available");case c.mQ.deepLinkStageModal:return Promise.resolve({entityCommand:{entity:{id:e.appId,type:o.py.platformstagemodal,action:o.uk.view},command:{visibilityState:l.fe.show,stateTransition:l.su.extend,correlation:{source:d.D.StageViewDeeplink}},entityOptions:e},metadata:{allowAnonymous:!1}});case c.mQ.adaptiveCardStageModal:case c.mQ.sdk:return a?((e,t,i)=>{const{enableReactStageModal:n}=t.get(r.J.Extensibility);return n?i.platform.launchReactStageModal(e.appId,e).toPromise():i.platform.launchStage({stageOptions:e}).toPromise()})(e,t,a):Promise.reject("Entity commanding not available");default:return Promise.reject(`Stage view entry point not supported. Entrypoint: ${e.entryPoint}`)}}))},18564:(e,t,i)=>{i.d(t,{fd:()=>u,zt:()=>m,R3:()=>h,g:()=>g});var n=i(50805),a=i(248965),s=i(956255),r=i(459989),o=i(369398),l=i(281710),d=i(738646),c=i(554404);const u=(e,t)=>t?`${e};replyChainId=${t}`:e,m=(e,t,i,a)=>{const{licenseType:s}=e.get(n.J.UserResources),{enableStageviewMW:o,enableStageviewMWInChannels:l,enableCollabStageForEDU:d}=e.get(n.J.Extensibility),u=t===c.E4.desktop;return!(!d&&(0,r.qi)(s)||!u)&&(o&&!l?"chats"===i.type&&!a:!!l&&("chats"===i.type||"channels"===i.type))},h=(e,t,i)=>{var n,s;const{appId:r,convId:o}=e,l=p(i),c=t.newScenario(l),u=t.newScenario(d.RG.PlatformTabLaunch);return c.appendEventData({"App.Id":r,"Thread.Id":o,"PlatformApp.ScenarioCapability":a.Ky.tabs,"App.EntryPoint":i}),u.appendEventData({"App.Id":r,"Thread.Id":o,"App.EntryPoint":i}),c.clientId=c.id,u.clientId=u.id,null===(n=t.hoistScenarioToCore)||void 0===n||n.call(t,c),null===(s=t.hoistScenarioToCore)||void 0===s||s.call(t,u),{phase1CollabStageScenario:c,endToEndScenario:u}},p=e=>{switch(e){case c.mQ.adaptiveCardStageModal:case c.mQ.deepLinkStageModal:case c.mQ.sdk:return d.RG.PlatformTabStageModalLaunch;case c.mQ.adaptiveCardCollabStage:default:return d.RG.PlatformTabCollabStageLaunch}};function g(e,t,i){var n,a,r,d,c;const u={};try{if((null===(n=e.linkedEntity)||void 0===n?void 0:n.type)===s.py.calls){const{convId:i,messageId:n}=(0,l.U3)(e,s.py.extensions,s.uk.view,t);n&&"0"!==n?(u.channelId=i,u.parentMessageId=n,u.channelMeetingMessageId=n,u.chatId=i):u.chatId=i}else if((null===(a=e.linkedEntity)||void 0===a?void 0:a.type)===s.py.channels){const{channelId:t}=(null===(r=e.linkedEntity)||void 0===r?void 0:r.id)&&JSON.parse(null===(d=e.linkedEntity)||void 0===d?void 0:d.id);u.channelId=t}else switch(e.type){case s.py.channels:const{channelId:n}=e.id&&JSON.parse(e.id);u.channelId=n;break;case s.py.chats:const a=(null!==(c=e.id)&&void 0!==c?c:"").split(";replyChainId=");a.length>1&&(u.replyChainId=a[1],u.channelId=a[0]),u.chatId=a[0];break;case s.py.extensions:const r=(0,o.cq)(e,i,t);u.parentMessageId=null==r?void 0:r.messageId,u.channelMeetingMessageId=null==r?void 0:r.messageId,u.chatId=(null==r?void 0:r.messageId)||null==r?void 0:r.threadId,u.channelId=(null==r?void 0:r.messageId)?null==r?void 0:r.threadId:void 0}}catch(e){t.log("Error while parsing source view entity.",null==e?void 0:e.message)}return u}},606896:(e,t,i)=>{i.d(t,{q:()=>k});var n=i(265858),a=i(824965),s=i(180410),r=i(662332),o=i(568094),l=i(427662),d=i(642799),c=i(431422),u=i(332447),m=i(457695),h=i(814423),p=i(50805),g=i(704361);const v=null===u.f||void 0===u.f?void 0:u.f.root,_=[a.h,v],k=e=>{var t;const{userBiService:i,loggerFactory:a,host:u}=(0,l.SE)(),v=(0,d.sV)(),k=v?v.entity:void 0,f=e.entityType||k&&k.type,S=n.useContext(o.Il),I=(0,g.n)();let y,N;if(I&&I.owningTeam){const{owningTeam:e}=I;y=null==e?void 0:e.id,N=null!==(t=null==e?void 0:e.teamSiteInformation.groupId)&&void 0!==t?t:""}const{useV0BoxTelemetryPanel:C}=(0,h.NC)(p.J.Telemetry),T=C?s.x:m.W;return n.createElement(c.S,Object.assign({biLogger:i||S.biLogger,loggerFactory:a,WrapperComponent:e.disableWrapper?r.R:T,whitelistedClassNames:_,host:u,entityType:f,channelDataTeamId:y,officeGroupId:N},e))}},431422:(e,t,i)=>{i.d(t,{S:()=>p});var n=i(850402),a=i(265858),s=i(275742),r=i(663945),o=i(984696);const l={tags:["a","button","input"],classNames:[]},d=(e,t)=>{const i=function(e){if(e.path)return e.path;if(e.composedPath)return e.composedPath();return c(e.target)}(e),{trackableDataset:n,isActionable:a}=function(e,t){let i=!1,n={};const a=[...l.classNames,...t];return e.some((e=>e.dataset&&"false"===e.dataset.track?(i=!1,!0):(function(e){if(!e.dataset)return!1;const t=Object.keys(e.dataset).filter((e=>e.match("track")));return!(0,s.isEmpty)(t)}(e)&&(n=e.dataset),e.tagName&&(0,s.includes)(l.tags,e.tagName.toLowerCase())&&(i=!0),e.classList&&(0,s.intersection)(a,e.classList).length>0&&(i=!0),e.dataset&&"true"===e.dataset.track&&(i=!0),!(!i||!n)))),{trackableDataset:n,isActionable:i}}(i,t||[]);if(!a)return null;const r=Object.keys(n).length>0;return r&&n.trackEventType&&n.trackEventType!==e.type?null:a&&!r?function(e){const t=[];return e.forEach((e=>{if("BODY"===e.tagName||"HTML"===e.tagName||e instanceof Document||e instanceof Window)return;let i="";e.classList&&e.classList.length>0&&(i=`.${e.classList.value.replace(/ /g,".")}`),t.push(`${e.tagName&&e.tagName.toLowerCase()}${i}`)})),{trackDebug:t.reverse().join(" > ")}}(i):n};function c(e,t){return e?((t=t||[]).push(e),e.parentElement?c(e.parentElement,t):t):t||[]}var u=i(560197),m=i(410218),h=i(827748);class p extends a.Component{constructor(e){super(e),this._logger=this.props.loggerFactory.newLogger("BILogger","components-telemetry"),this._eventListenerDispose=[],this._dataBags=[],this._recordPanelView=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const{biLogger:t,contextWorkLoads:i,channelDataTeamId:a,officeGroupId:s}=this.props,r=e||i?(e||[]).concat(i||[]):void 0;if(!t)return void this._logger.warn("BI Logger is not set on the context. No BI events are being logged.");const o={teamId:a,officeGroupId:s},l=this._dataFromPanelView(),{dataBag:d}=l,c=(0,n.__rest)(l,["dataBag"]);t.recordPanelView(Object.assign(Object.assign(Object.assign({},o),{dataBag:d}),c),this._logger,r),null==d||d.dispose()})),this._dataFromPanelView=()=>{const e=this.props,{dataBagProps:t}=e,i=(0,n.__rest)(e,["dataBagProps"]);if(!t)return i;const a=this._createDatabag();return Object.keys(t).forEach((e=>{a[e]=t[e]})),Object.assign({dataBag:a},i)},this._recordPanelAction=(e,t,i)=>(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=this.props,{biLogger:a,teamId:s,contextWorkLoads:r,channelDataTeamId:o,officeGroupId:l}=t,d=(0,n.__rest)(t,["biLogger","teamId","contextWorkLoads","channelDataTeamId","officeGroupId"]);if(!a)return;const c={teamId:null!=s?s:o,officeGroupId:l};a.recordPanelAction(Object.assign(Object.assign(Object.assign({},c),d),e),this._logger,i||r)})),this._createDatabag=()=>{const e=new m.S;return this._dataBags.push(e),e.setDispose((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){yield(0,h._)(0);const t=this._dataBags.findIndex((t=>t.id===e.id));this._dataBags.splice(t,1)})))),e},this._appendBiData=(e,t)=>{var i,n;null===(n=null===(i=this.props)||void 0===i?void 0:i.biLogger)||void 0===n||n.appendBiData(e,t)},this._removeBiData=(e,t)=>{var i,n;null===(n=null===(i=this.props)||void 0===i?void 0:i.biLogger)||void 0===n||n.removeBiData(e,t)},this._handleRef=e=>{const t={capture:!0};if(e){const i=!!e.setAttribute&&!!e.removeAttribute&&!!e.hasAttribute;i&&e.hasAttribute("telemetrySet")||(i&&(e.setAttribute("telemetrySet","true"),this._eventListenerDispose.push((()=>{e.removeAttribute("telemetrySet")}))),e.addEventListener("click",this._captureAction,t),this._eventListenerDispose.push((()=>{e.removeEventListener("click",this._captureAction,t)})),e.addEventListener("keydown",this._captureActionOnEnter,t),this._eventListenerDispose.push((()=>{e.removeEventListener("keydown",this._captureActionOnEnter,t)})),e.addEventListener("scroll",this._debouncedCaptureAction,t),this._eventListenerDispose.push((()=>{e.removeEventListener("scroll",this._debouncedCaptureAction,t)})))}},this._captureAction=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t,i;const a=this.props,{biLogger:s,loggerFactory:o,children:l}=a,c=(0,n.__rest)(a,["biLogger","loggerFactory","children"]);let u;if(!s)return;this._isSyntheticEvent(e)&&(e=e.nativeEvent);const m=d(e,this.props.whitelistedClassNames);if(!m)return;m.trackDatabagId&&(yield(0,h._)(0),u=this._dataBags.find((e=>e.id===m.trackDatabagId)));let p=c.contextWorkLoads;if(m.trackContextWorkLoads){p=m.trackContextWorkLoads.split(",").map((e=>r.sz[e]))}const g=Object.assign(Object.assign({dataBag:u},c),this._cleanDataSet(m)),v=this.props.host?(null===(i=null===(t=this.props.host)||void 0===t?void 0:t.performance)||void 0===i?void 0:i.now())-e.timeStamp:void 0;v&&Object.assign(g,{actionInputDelay:v}),s.recordPanelAction(g,this._logger,p)})),this._cleanDataSet=e=>{const t={},i="track";return Object.keys(e).map((n=>{if(n.match(i)&&n!==i){const i=n.substr(5),a=`${i[0].toLowerCase()}${i.substr(1)}`;t[a]=e[n]}})),t},this._debouncedCaptureAction=(0,s.debounce)(this._captureAction,500),this._captureActionOnEnter=(0,s.cond)([[(0,s.matches)({keyCode:o.n.enter}),this._captureAction]]),this._contextValue={recordPanelAction:this._recordPanelAction,createDatabag:this._createDatabag,appendBiData:this._appendBiData,removeBiData:this._removeBiData,recordPanelView:this._recordPanelView,panelViewData:this._dataFromPanelView}}componentDidMount(){const e=this.props.panelViewOnComponentVisible&&this.props.isComponentVisible;this.props.skipPanelViewOnMount&&!e||this._recordPanelView()}componentDidUpdate(e){const t=this.props.panelViewOnComponentVisible&&this.props.isComponentVisible&&this.props.isComponentVisible!==e.isComponentVisible;if(!this.props.recordViewOnUpdate&&!t)return;const{disableWrapper:i,biLogger:a,loggerFactory:s,newLogger:r,children:o}=e,l=(0,n.__rest)(e,["disableWrapper","biLogger","loggerFactory","newLogger","children"]);let d=!1;Object.keys(l).forEach((t=>{e[t]!==this.props[t]&&(d=!0)})),d&&this._recordPanelView()}componentWillUnmount(){this._eventListenerDispose.forEach((e=>e())),this._eventListenerDispose=[],this._debouncedCaptureAction.cancel(),this._dataBags=[]}render(){const{biLogger:e,children:t,WrapperComponent:i,wrapperClassName:n}=this.props;if(!e)return t;const s=this.props.disableWrapper&&!this.props.disableNativeListeners?{children:a.createElement(a.Fragment,null,t),innerRef:this._handleRef}:{children:t,onClickCapture:this._captureAction,onKeyDownCapture:this._captureActionOnEnter,onScrollCapture:e=>{e.persist(),this._debouncedCaptureAction(e)}},r=n?Object.assign({className:n},s):s;return a.createElement(u.R2,{value:this._contextValue},a.createElement(i,Object.assign({},r)))}_isSyntheticEvent(e){return!!e&&!!e.nativeEvent}}},870017:(e,t,i)=>{i.d(t,{Y:()=>a});let n=[];function a(e){n.push(e)}},127097:(e,t,i)=>{i.d(t,{e:()=>n,S:()=>d});var n,a=i(850402);!function(e){e.Configurations="Configurations",e.HorizontalBar="HorizontalBar",e.Main="Main",e.Modal="Modal",e.Monitor="Monitor",e.Rail="Rail",e.OverlayThinHorizontalBar="OverlayThinHorizontalBar",e.PartialOverlay="PartialOverlay",e.ThinHorizontalBar="ThinHorizontalBar",e.TitleBar="TitleBar",e.VerticalBar="VerticalBar"}(n||(n={}));const{OverlayThinHorizontalBar:s,ThinHorizontalBar:r,TitleBar:o,VerticalBar:l}=n,d=(0,a.__rest)(n,["OverlayThinHorizontalBar","ThinHorizontalBar","TitleBar","VerticalBar"])},969939:(e,t,i)=>{var n;i.d(t,{h:()=>n}),function(e){e.default="default",e.skypeConCore="conCore",e.mediaAgent="mediaAgent",e.CDL="CDL"}(n||(n={}))},455572:(e,t,i)=>{var n,a,s,r,o,l,d,c,u,m,h,p,g,v,_,k,f,S,I,y;i.d(t,{OV:()=>n,Qf:()=>a,Ml:()=>s,z7:()=>o,Wz:()=>l,Zc:()=>d,XR:()=>c,cb:()=>u,Lv:()=>m,oW:()=>h,$g:()=>p,hD:()=>v,_v:()=>k,zP:()=>f,Dz:()=>S,xu:()=>I,UE:()=>y}),function(e){e.Work="",e[e.Freemium=2]="Freemium",e[e.Life=3]="Life"}(n||(n={})),function(e){e.Personal="personal",e.Channel="channel",e.Unknown="unknown"}(a||(a={})),function(e){e.GuardianChat="GuardianChat"}(s||(s={})),function(e){e[e.anonymous=0]="anonymous",e[e.default=1]="default",e[e.guest=2]="guest",e[e.msaGuest=3]="msaGuest",e[e.msaMember=4]="msaMember",e[e.otpGuest=5]="otpGuest",e[e.otpMember=6]="otpMember"}(r||(r={})),function(e){e[e.Admin=0]="Admin",e[e.Anonymous=1]="Anonymous",e[e.Guest=2]="Guest",e[e.Regular=3]="Regular"}(o||(o={})),function(e){e.x64="x64",e.ia32="ia32",e.x86="x86",e.unknown="unknown"}(l||(l={})),function(e){e.MACOSX="UNIX/MACINTOSH",e.UNIX="UNIX",e.UNKNOWN="Unknown",e.WINDOWS="Windows"}(d||(d={})),function(e){e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(c||(c={})),function(e){e.background="background",e.foreground="foreground"}(u||(u={})),function(e){e.maximized="maximized",e.minimized="minimized",e.systray="systray"}(m||(m={})),function(e){e.copy="Copy"}(h||(h={})),function(e){e.nav="nav",e.notification="notification"}(p||(p={})),function(e){e.Cold="cold",e.Warm="warm"}(g||(g={})),function(e){e.TopLevel="L1",e.DrillDown="L2"}(v||(v={})),function(e){e.SettingsPrivacyPage="SettingsPrivacyPage",e.LpcMeProfileCard="LpcMeProfileCard"}(_||(_={})),function(e){e.tflExternal="TFLExternal",e.tfwUser="TFWUser"}(k||(k={})),function(e){e.addMembers="addMembers",e.pinChannel="pinChannel",e.unpinChannel="unpinChannel",e.favoriteChannel="favoriteChannel",e.manageChannel="manageChannel",e.getChannelEmail="getChannelEmail",e.getChannelLink="getChannelLink",e.editChannel="editChannel",e.editChannelConnectors="editChannelConnectors",e.editChannelWorkflows="editChannelWorkflows",e.deleteChannel="deleteChannel",e.leaveChannel="leaveChannel",e.toggleChannelOrder="toggleChannelOrder"}(f||(f={})),function(e){e.pinned="pinned",e.shown="shown",e.hidden="hidden"}(S||(S={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared",e.Standalone="Standalone"}(I||(I={})),function(e){e.General="General",e.NotGeneral="NotGeneral"}(y||(y={}))},281710:(e,t,i)=>{i.d(t,{Mf:()=>a,f$:()=>s,U3:()=>r,cW:()=>o});var n=i(956255);function a(e,t){return{entity:{type:n.py.chats,action:n.uk.create,id:s(e)},command:t}}function s(e){return JSON.stringify(e&&e.length>0?e.sort():[])}function r(e,t,i,n){let a={};if(!e)return a;if(e.type===t&&e.action===i){const t=e.options;if(t&&"string"==typeof t)try{a=JSON.parse(t)}catch(e){n.warn(`Entity options are in unexpected format. Expected a valid stringified JSON object but instead received: ${t}.`)}}else n.warn(`Entity options are (incorrectly) being asked for type and action that do not pertain to the entity. ${e.type} != ${t} or ${e.action} != ${i}`);return a}const o=e=>`${e.substring(0,32)}00000000${e.substring(40)}`},642601:(e,t,i)=>{i.d(t,{A:()=>n});class n{constructor(e,t){this.router=e,this.coreSettings=t,this.categorySubscriptions=new Map}init(){this.channel=new MessageChannel,this.router.postMessage("initCoreSettingsWorker",void 0,[this.channel.port2]),this.registerListeners()}registerListeners(){this.channel&&(this.channel.port1.onmessage=e=>{const{data:t}=e;"settingsRequest"===t.type&&this.handleSettings(t.payload),"subscribeCategory"===t.type&&this.handleSubscription(t.payload),"unsubscribeCategory"===t.type&&this.handleUnsubscription(t.payload)})}handleSubscription({category:e}){if(this.categorySubscriptions.has(e))return;const t=this.coreSettings.getObservable(e).subscribe((t=>{var i;null===(i=this.channel)||void 0===i||i.port1.postMessage({type:"categorySubscriptionResponse",payload:{values:t,category:e}})}));this.categorySubscriptions.set(e,t)}handleUnsubscription({category:e}){const t=this.categorySubscriptions.get(e);t&&(t.unsubscribe(),this.categorySubscriptions.delete(e))}handleSettings({category:e,settings:t,id:i}){var n;const a=this.coreSettings.get(e),s={};null==t||t.forEach((e=>{s[e]=a[e]})),null===(n=this.channel)||void 0===n||n.port1.postMessage({type:"settingsResponse",payload:{values:s,id:i}})}}},300426:(e,t,i)=>{i.d(t,{k:()=>r,H:()=>o});var n=i(50805),a=i(549571),s=i(738646);const r=-1;class o{constructor(){this.FractionalBuckets=1e3,this.ConvertToWholeDeviser=10,this.WholeNumberBuckets=100,this.DefaultCohort=0,this.DefaultSampleRate=100,this.rulesLookup={},this.cohortBoundary=this.DefaultCohort,this.telemetrySettings={},this.deviceId=null,this.userId=null,this.blockZeroSampleRate=!1,this.preAuthUserSamplingId=null,this.updateSamplingSettings=e=>{if(e){this.telemetrySettings=e;let t={};e.samplingRules&&(t=e.samplingRules,this.rulesLookup=t),this.setCohortBoundry(),this.blockZeroSampleRate=e.enableBlockZeroSampleRate}}}initialize(e){e.getObservable(n.J.Telemetry).subscribe(this.updateSamplingSettings),this.telemetrySettings=e.get(n.J.Telemetry),this.updateSamplingSettings(this.telemetrySettings)}static getInstance(){return this.eventSuppressionService||(this.eventSuppressionService=new o),this.eventSuppressionService}setSamplingByUser(e){this.userId||(this.userId=e,this.setCohortBoundry())}setSamplingByPreAuthId(e){this.preAuthUserSamplingId=e,this.setCohortBoundry()}setSamplingByDevice(e){this.deviceId=e,this.setCohortBoundry()}getCurrentCohort(){return this.cohortBoundary}shouldSuppressEvent(e,t="*"){return this.getSampleRate(e,t,"*")===r}getCrossClientScenarioSampleRate(e){if(this.telemetrySettings.enableExpandedCrossClientScenarioDefaultSampling&&e===s.t7.Expanded)return this.DefaultSampleRate}getSampleRate(e,t="*",i="*"){const n=this.rulesLookup[e];if(void 0!==n){const e=void 0!==n[`${t}|${i}`]?n[`${t}|${i}`]:void 0!==n[t]?n[t]:void 0!==n[`*|${i}`]?n[`*|${i}`]:void 0!==n["*"]?n["*"]:this.DefaultSampleRate;if(0===e&&this.blockZeroSampleRate)return r;if(this.cohortBoundary!==this.DefaultCohort)return this.cohortBoundary>e?r:e}return this.DefaultSampleRate}setCohortBoundaryByIdType(e,t){return t&&t>r&&t<=this.DefaultSampleRate?void(this.cohortBoundary=t):e}setCohortBoundry(){if(this.cohortBoundary!==this.DefaultCohort)return;let e=null;const t=this.telemetrySettings;!this.userId&&t.enablePreAuthIdSampling?e=this.preAuthUserSamplingId:t.enableDeviceIdSampling?e=this.setCohortBoundaryByIdType(this.deviceId,this.telemetrySettings.deviceIdSampleCohort):t.enableUserIdSamplingV2&&(e=this.setCohortBoundaryByIdType(this.userId,this.telemetrySettings.userIdSampleCohort)),t.enablePreAuthIdSampling||t.enableDeviceIdSampling||t.enableUserIdSamplingV2?e&&(this.cohortBoundary=((0,a.E)(e)%this.FractionalBuckets+1)/this.ConvertToWholeDeviser):this.userId&&(this.cohortBoundary=(0,a.E)(this.userId)%this.WholeNumberBuckets+1)}}},781662:(e,t,i)=>{i.d(t,{G:()=>y});var n,a=i(850402),s=i(185870),r=i(100836),o=i(969939),l=i(738646);!function(e){e.Desktop="Desktop",e.Messaging="Messaging",e.Files="Files",e.Apps="Apps",e.Activity="Activity",e.Feeds="Feeds",e.Teams="Teams",e.CMD="CMD",e.Notifications="Notifications",e.Foundation="Foundation"}(n||(n={}));const d=new Map;d.set(l.RG.WindowLaunchTime,{featureArea:n.Foundation,customDimensions:["App"]});var c=i(50805),u=i(507829),m=i(575644),h=i(89062),p=i(870017),g=i(300426);class v{constructor(){this.propagators={}}addCallback(e,t){const i=this.propagators[e];this.propagators[e]=i?Object.assign(Object.assign({},i),{callbacks:[...i.callbacks,t]}):{filters:void 0,usingCache:!1,cache:{},callbacks:[t]};const n=this.propagators[e];if(n){const{cache:e,usingCache:i}=n;i&&Object.keys(e).forEach((i=>{const n=e[i];n&&t(i,n[0],n[1])}))}}updateFilter(e,t,i=!1){const n=this.propagators[e];n?(n.filters=t,n.usingCache=i):this.propagators[e]={filters:t,usingCache:i,cache:{},callbacks:[]}}send(e,t,i){Object.keys(this.propagators).forEach((n=>{var a,s;const r=this.propagators[n];if(r){const o=r.filters;o?o.has(e)&&(r.usingCache&&(r.cache[e]=[t,i]),null===(a=this.propagators[n])||void 0===a||a.callbacks.forEach((n=>n(e,t,i)))):null===(s=this.propagators[n])||void 0===s||s.callbacks.forEach((n=>n(e,t,i)))}}))}}var _=i(642601),k=i(406900);const f="default",S=o.h.default;class I{constructor(){this._contextPropagator=new v,this._sessionId="",this._silent=!1,this._sharedWorkerOptions={delayLoadingWorker:!1,isSharedWorkerEnabled:!1,isWorkerEnabled:!1},this._cachedOperation=[],this._workerInited=!1,this._capturingEventsForDiagnosticPanel=!1,this._capturingContextForDiagnosticPanel=!1,this._capturedEvents={},this._capturedContext={},this._primaryUserId="",this._primaryTenantId="",this._users=new Set,(0,p.Y)((()=>{this._cachedOperation=[],this._sharedWorkerOptions.sharedWorkerUrl=void 0}))}getUsers(){return this._users}getPrimaryUserId(){return this._primaryUserId}getPrimaryTenantId(){return this._primaryTenantId}get sessionId(){return this._sessionId}startCapturingEventsAndContext(){this._capturingContextForDiagnosticPanel=!0,this._capturingEventsForDiagnosticPanel=!0}stopCapturingEventsAndContext(){this._capturingContextForDiagnosticPanel=!1,this._capturingEventsForDiagnosticPanel=!1}get capturedContext(){return this._capturedContext}get capturedEvents(){return this._capturedEvents}clearCapturedEvents(){this._capturedEvents={[f]:[]}}setCdlContextCallback(e){this._contextPropagator.addCallback("cdl",((t,i,n)=>{var a;e(t,null!==(a=null==i?void 0:i.toString())&&void 0!==a?a:"",n)}))}setMultiContextCallback(e){this._contextPropagator.addCallback("maglev",((t,i,n)=>{var a;e(t,null!==(a=null==i?void 0:i.toString())&&void 0!==a?a:"",n)}))}setCollectorContextCallback(e){this._collectorContextCallback=e}setEndpointHealth(e){this._getEndpointHealth=e}getEndpointHealth(e,t){var i;return this._getEndpointHealth?null===(i=this._getEndpointHealth(e,t))||void 0===i?void 0:i.isHealthy:void 0}setupReinitSubscriptions(e){var t;if(!this._initializeParams||!e.enableTelemetryRegionReinit)return;let i=!1;e.oneDsCollectorUrl&&this._initializeParams.oneDsCollectorUrl!==e.oneDsCollectorUrl&&(this._initializeParams.oneDsCollectorUrl=e.oneDsCollectorUrl,i=!0),e.telemetryServer&&this._initializeParams.config.collectorUrl!==e.telemetryServer&&(this._initializeParams.config.collectorUrl=e.telemetryServer,i=!0),void 0!==e.enableOneDsSdkNs&&this._initializeParams.enableOneDsSdkNs.toString()!==(null===(t=e.enableOneDsSdkNs)||void 0===t?void 0:t.toString())&&(this._initializeParams.enableOneDsSdkNs=e.enableOneDsSdkNs||!1,i=!0),e.defaultToken&&this._initializeParams.appTokens.default!==e.defaultToken&&(this._initializeParams.appTokens.default=e.defaultToken,i=!0),i&&(this._sendOrCacheOperation("flushForReinit",this._initializeParams),this.logReinitEvent()),void 0!==e.telemetryRegionFetchComplete&&null!==e.telemetryRegionFetchComplete&&this.setContext("telemetryRegionFetchComplete",e.telemetryRegionFetchComplete),e.telemetryRegion&&this.setContext("UserInfo.TelemetryRegion",e.telemetryRegion),void 0!==this._collectorContextCallback&&i&&e.telemetryRegionFetchComplete&&e.telemetryRegion&&this._collectorContextCallback(e.enableTelemetryRegionReinit,e.telemetryRegion,e.telemetryRegionFetchComplete)}initialize(e,t){var i,n,s,r,o,d,h,p;const{workerOptions:v,services:f}=e,I=(0,a.__rest)(e,["workerOptions","services"]),{coreSettings:y,columnSuppressionService:N}=f,{workerType:C,workerSetup:T}=v;this._initializeParams=I,this._initializeParams&&(null!==(i=(p=this._initializeParams).defaultLoggerName)&&void 0!==i||(p.defaultLoggerName=S)),this._silent=I.isSilent,this._sharedWorkerOptions.delayLoadingWorker=null!==(n=I.delayLoadingWorker)&&void 0!==n&&n,this._sharedWorkerOptions.isSharedWorkerEnabled=null!==(s=I.enableSharedWorker)&&void 0!==s&&s,this._capturingEventsForDiagnosticPanel=null===(r=I.debugMenuSettings)||void 0===r?void 0:r.debugMenuCaptureEvents,this._capturingContextForDiagnosticPanel=null===(o=I.debugMenuSettings)||void 0===o?void 0:o.debugMenuCaptureContext,t&&(this._consoleLogger=t,I.config.log=void 0,I.enableDebugTrace=!0),this.initScenario=e.services.scenarioFactory.newScenario(l.RG.TelemetryWorkerInitialization),this.columnSuppressionService=N,this._initializeDefer=(0,u.P)(),(0,m.E)(this._initializeDefer.promise,3e4).catch((e=>{var t;this.setContext("Session.TelemetryWorkerType","embed"),null===(t=this.initScenario)||void 0===t||t.mark(l.ck.WorkerTimeout),this._router=new k.v,this._setupWorker(this._router,I)})),this._router=T(),this._setupWorker(this._router,I);const E=y.get(c.J.Telemetry);if(Array.isArray(E.multiContextColumns)){const e=new Set(E.multiContextColumns);this._contextPropagator.updateFilter("maglev",e)}else null===(d=t.warnNoPii)||void 0===d||d.call(t,"Failed to update maglev multi context filter, setting in unexpected format "+typeof E.multiContextColumns);if(Array.isArray(E.cdlMultiContextColumns)){const e=new Set(E.cdlMultiContextColumns);this._contextPropagator.updateFilter("cdl",e,!0)}else null===(h=t.warnNoPii)||void 0===h||h.call(t,"Failed to update maglev multi context filter, setting in unexpected format "+typeof E.cdlMultiContextColumns);I.documentInfo.deviceId&&g.H.getInstance().setSamplingByDevice(I.documentInfo.deviceId);if(y.getObservable(c.J.Telemetry).subscribe((e=>{this._updateSDKwithPrivacyGuard(e),this._updateSecondPartyTelemetryFlag(e),this.setupReinitSubscriptions(e)})),this.setContext("Session.TelemetryWorkerType",C),("shared"===C||"dedicated"===C)&&void 0!==this._router){new _.A(this._router,y).init()}}createEvent(e,t,i,n,a,r){var o;const l=new s.kc;return l.name=e,l.eventType=t,l.timestamp=Date.now(),l.setProperty("EventInfo.BaseType",t),i&&(this._copyEventProperties(l,i,n),null===(o=this.columnSuppressionService)||void 0===o||o.applyColumnBlockingRules(e,null!=r?r:t,l,a),a&&l.setProperty(a.columnName,(0,h.XC)(a.packedData))),r&&l.setProperty("EventInfo.Identifier",r),l}flush(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return this._silent?new Promise(((e,t)=>{t()})):new Promise(((t,i)=>{this._router?(this._router.registerMessageHandler("flushed",(()=>{this._router&&this._router.unregisterMessageHandler("flushed"),t()})),this._router.postMessage("flush",{isAsync:e})):i()}))}))}logEvent(e,t,i=""){this._silent||(this._sendOrCacheOperation("logEvent",{key:e,value:t,userContextId:i}),this._addCapturedEvent(t,i))}initializeSecondPartyLogger(e,t,i=!1){this.enableSecondPartyTelemetry&&this._sendOrCacheOperation("newSecondPartyOneDsLogger",{key:e,value:{ingestionToken:t,useTeamsContext:i}})}logSecondPartyEvent(e,t){this.enableSecondPartyTelemetry&&!this._silent&&this._sendOrCacheOperation("logSecondPartyEvent",{key:e,value:t})}initializeLogger(e,t){this._sendOrCacheOperation("newLogger",{key:e,value:t})}logOutUser(e){e&&(this._sendOrCacheOperation("logOutUser",{userContextId:e}),this._users.delete(e))}setPrimaryUser(e,t){e&&(this._primaryUserId=e,this._primaryTenantId=t,this._users.has(e)||this._users.add(e),this._sendOrCacheOperation("setPrimaryUser",{userContextId:e,userTenantId:t}))}setContext(e,t,i,n){var a,s,r;if("UserInfo.Id"===e&&"string"==typeof t&&(g.H.getInstance().setSamplingByUser(t),t&&!this._users.has(t)&&this._users.add(t)),!(null===(a=this.columnSuppressionService)||void 0===a?void 0:a.isContextColumnOk(e)))return;const l=(0,h.XC)(null!=t?t:""),d={key:e,value:l,pii:i,userContextId:n};(null===(s=this._initializeParams)||void 0===s?void 0:s.defaultLoggerName)&&(null===(r=this._initializeParams)||void 0===r?void 0:r.defaultLoggerName)!==o.h.default&&(d.logger=this._initializeParams.defaultLoggerName),this._sendOrCacheOperation("setContext",d),this._addCapturedContext(e,l,n),this._contextPropagator.send(e,t,n)}setPrivacyGuardUserInfo(e,t){this._sendOrCacheOperation("setPrivacyGuardUserInfo",{userNames:e,upns:t})}setDeviceAuthToken(e){this._sendOrCacheOperation("setDeviceAuthToken",e)}start(){this._silent||this._sendOrCacheOperation("start")}stop(){this._silent||this._sendOrCacheOperation("stop")}sendPulsarSignal(e){this._sendOrCacheOperation("pulsarSignal",e)}registerPulsarBackchannelListener(e){var t;null===(t=this._router)||void 0===t||t.registerMessageHandler("pulsarSignal",e)}Verbose(e){this._consoleLogger&&this._consoleLogger.debug(e)}Error(e){this._consoleLogger&&this._consoleLogger.error(e)}Info(e){this._consoleLogger&&this._consoleLogger.debug(e)}_addCapturedEvent(e,t){const i=5e3;this._capturingEventsForDiagnosticPanel&&(t&&!this._capturedEvents[t]?this._capturedEvents[t]=[]:t||this._capturedEvents[f]||(this._capturedEvents[f]=[]),this._capturedEvents[t||f].unshift(e),this._capturedEvents[t||f].length>=i&&(this._capturedEvents[t||f].length=i-Math.floor(500)))}_addCapturedContext(e,t,i){this._capturingContextForDiagnosticPanel&&e&&(i&&!this._capturedContext[i]?this._capturedContext[i]={}:i||this._capturedContext[f]||(this._capturedContext[f]={}),this._capturedContext[i||f][e]=t)}_setupWorker(e,t){var i,n,a,r;return e.registerMessageHandler("sessionId",(e=>{this._sessionId=null==e?void 0:e.value})),e.registerMessageHandler("batchDone",(()=>{var e;this._workerInited=!0,null===(e=this.initScenario)||void 0===e||e.stop()})),e.registerMessageHandler("workerInitialized",(()=>{var e,t;null===(e=this._initializeDefer)||void 0===e||e.resolve(),null===(t=this.initScenario)||void 0===t||t.mark(l.ck.WorkerInitialized),this._cachedOperation.length>0&&this._router&&(this._router.postMessage("batch",this._cachedOperation),this._cachedOperation=[])})),e.registerMessageHandler("error",(e=>{this.Error(e)})),e.registerMessageHandler("info",(e=>{this.Info(e)})),e.registerMessageHandler("verbose",(e=>{this.Verbose(e)})),this._sendOrCacheOperation("newLogger",{key:null!==(n=null===(i=this._initializeParams)||void 0===i?void 0:i.defaultLoggerName)&&void 0!==n?n:S,value:t.appTokens.default}),this._sendOrCacheOperation("logSession",{name:null!==(r=null===(a=this._initializeParams)||void 0===a?void 0:a.defaultLoggerName)&&void 0!==r?r:S,state:s.sM.STARTED,sessionId:t.sessionId,sessionStartTime:t.sessionStartTime}),this._sendOrCacheOperation("sessionId",t.sessionId),e.postMessage("initialize",t),e}logReinitEvent(){const e="loggingns",t="instrumentation_reinit",i="info",n=g.H.getInstance().getSampleRate(e,t,i);if(n===g.k)return;const a=this.createEvent(e,t,{message:"Triggering logger reinit",sampleRate:n,"EventInfo.Identifier":t,logLevel:i});this.logEvent(o.h.default,a)}static getInstance(){return this.telemetryProviderInstance||(this.telemetryProviderInstance=new I),this.telemetryProviderInstance}_sendOrCacheOperation(e,t){this._workerInited&&this._router?(this._cachedOperation.length>0&&(this._router.postMessage("batch",this._cachedOperation),this._cachedOperation=[]),this._router.postMessage(e,t)):this._cachedOperation.push({name:e,params:t})}_copyEventProperties(e,t,i){let n=null;for(const i in t)t.hasOwnProperty(i)&&(n=t[i],null!=n&&""!==n&&("object"==typeof n&&Object.prototype.hasOwnProperty.call(n,"piiKind")&&Object.prototype.hasOwnProperty.call(n,"value")&&n.piiKind in r.A4?e.setProperty(i,(0,h.XC)(n.value),n.piiKind):e.setProperty(i,(0,h.XC)(n))));if(i){const t=d.get(e.eventType);t&&this._copyMonitoringData(e,t,i)}}_copyMonitoringData(e,t,i){const n=[void 0,void 0,void 0],a=t.customDimensions.length;e.setProperty("Scenario.Priority",i.scenarioPriority),i.scenarioErrorCode&&e.setProperty("Scenario.ErrorCode",i.scenarioErrorCode),i.data.forEach((i=>{i.value&&e.setProperty(this._createMonitoringKey(t.featureArea,i.key),i.value);const a=t.customDimensions.findIndex((e=>e===i.key));a>0&&a<3&&(n[a]=i.value)}));let s="";for(let e=0;e<a;e++){const t=void 0===n[e]?"":n[e];s=e===a-1?`${s}${t}`:`${s}${t},`}e.setProperty("CombinedMonitoringDimensions",s)}_createMonitoringKey(e,t){return`QoS.${e}_${t}`}_updateSecondPartyTelemetryFlag(e){this.enableSecondPartyTelemetry=Boolean(e.enableSecondPartyTelemetry)}_updateSDKwithPrivacyGuard(e){var t,i;if(e&&(null===(t=this._initializeParams)||void 0===t?void 0:t.enableOneDsSdkNs)){const t=!!e.enablePrivacyGuard;t!==(null===(i=this._initializeParams)||void 0===i?void 0:i.enablePrivacyGuard)&&(this._initializeParams.enablePrivacyGuard=t,this._sendOrCacheOperation("updateSDKWithPrivacyGuard",t))}}}const y=()=>I.getInstance()},561890:(e,t,i)=>{i.d(t,{t:()=>n});class n{constructor(){this.messageHandlers={},this.registerMessageHandler("batch",(e=>{for(const t of e)if(t&&t.name){const e=this.messageHandlers[t.name];e&&e(t.params)}this.postMessage("batchDone")}))}registerMessageHandler(e,t){this.messageHandlers[e]?console.warn(`message handler already registered for - ${e}`):this.messageHandlers[e]=t}unregisterMessageHandler(e){delete this.messageHandlers[e]}}},406900:(e,t,i)=>{i.d(t,{v:()=>k});var n=i(850402),a=i(589008),s=i(185870);class r{constructor(){this.telemetry=a.sE.CreateTelemetryManager(),this.ariaLoggers={},this.statusParams={active:!0,firstPartyLoggerTokens:{},secondPartyLoggerTokens:{}},this.mainContextMap={},(0,s.cS)(this.telemetry)}initialize(e){this.initParams=e,this.telemetry.Initialize(e.config),s.hD.initialize(e.documentInfo,e.appTokens.default)}start(){this.telemetry.Start(),this.statusParams.active=!0}stop(){this.telemetry.Stop(),this.statusParams.active=!1}flush(e,t){let i=8;const n=()=>{const t=this.telemetry._eventsCache.IsEmpty(),a=0==--i;t||a?e.postMessage("flushed"):this.telemetry.Flush(n)};n()}flushForReinit(e){let t=8;const i=()=>{const n=this.telemetry._eventsCache.IsEmpty(),a=0==--t;n||a?(e.postMessage("flushedForReinit"),this.stop()):this.telemetry.Flush(i)};i()}createNewLogger(e,t){this.statusParams.firstPartyLoggerTokens[e]=t,this.ariaLoggers[e]=new s.Yd(t)}logEvent(e,t){if(!e)return;const i=this.ariaLoggers[e];i&&i.logEvent(t)}logSession(e,t){const i=this.ariaLoggers[t.name];if(!i)return;const n=t.state;i.logSession(n,t.properties,t.sessionId,t.sessionStartTime),e.postMessage("sessionId",{key:t.name,value:i.getSessionId()})}createNewSecondPartyLogger(e,t,i){this.statusParams.secondPartyLoggerTokens[e]=t}logSecondPartyEvent(e,t){}setContext(e){this.mainContextMap[e.key]={value:e.value},s.hD.setContext(e.key,e.value,e.pii)}setUserId(e){s.hD.getSemanticContext().setUserId(e)}setUserTenantId(e){s.hD.getSemanticContext().setUserTenantId(e)}setUserRing(e){s.hD.getSemanticContext().setUserRing(e)}setAppClientType(e){s.hD.getSemanticContext().setAppClientType(e)}setDeviceAuthToken(e){}setPrivacyGuardSensitiveInformation(e){}updateSDKWithPrivacyGuard(e){}logOutUser(e){}setPrimaryUser(e){}}var o=i(969939),l=i(349869),d=i(399518),c=i(139171);const u=["admin","Admin","ADMIN","administrator","Administrator","ADMINISTRATOR","automation","Automation","AUTOMATION","client","Client","CLIENT","limited","Limited","LIMITED","office","Office","OFFICE","services","Services","SERVICES","user","User","USER"],m={"appinfo.id":"ext.app.id","appinfo.env":"ext.app.env","appinfo.version":"ext.app.ver","appinfo.versionnew":"ext.app.ver","appinfo.language":"ext.app.locale","userinfo.language":"ext.user.locale","userinfo.timezone":"ext.location.tz","userinfo.id":"ext.user.id","userinfo.tenantid":"ext.user.tenantid","deviceinfo.id":"ext.device.localid","deviceinfo.make":"ext.device.make","deviceinfo.model":"ext.device.model","deviceinfo.networktype":"ext.net.type","deviceinfo.browsername":"ext.web.browser","deviceinfo.browserversion":"ext.web.browserversion"};class h{constructor(){this.oneDsLoggers={},this.contextCallbacks={},this.secondPartyLoggers={},this.oneDsManager=new l.Z,this.sharedConfig={},this.privacyGuardContext={},this.loggerContextMap={},this.userContextMap={},this.mainContextMap={},this.commonSchemaContextMap={},this.statusParams={active:!0,firstPartyLoggerTokens:{},secondPartyLoggerTokens:{}}}initialize(e){var t,i,n;this.initParams=e,this.sharedConfig={instrumentationKey:e.appTokens.default,endpointUrl:e.oneDsCollectorUrl,extensions:[],extensionConfig:[],propertyConfiguration:{populateBrowserInfo:!0,populateOperatingSystemInfo:!0,sessionAsGuid:!0},channelConfiguration:{payloadPreprocessor:e.enableCompression?(e,t)=>{this.gzipPayload(e,t)}:void 0,eventsLimitInMem:e.eventsLimitInMem,autoFlushEventsLimit:e.eventsLimitInMem*e.autoFlushPercent,ignoreMc1Ms0CookieProcessing:!0,enableCompoundKey:!0},maxMessageLimit:0},this.privacyGuard=new d.q,this.sharedConfig.extensionConfig||(this.sharedConfig.extensionConfig=[]),this.privacyGuardContext.IgnoredNameParts=u,this.sharedConfig.extensionConfig[null===(t=this.privacyGuard)||void 0===t?void 0:t.identifier]={context:this.privacyGuardContext,iKey:this.initParams.privacyGuardIngestionToken,useEventFieldPrefix:!0,useAbsoluteFieldName:!0},this.oneDsManager.create(this.sharedConfig,[this.privacyGuard]),null===(n=(i=this.oneDsManager.getPostChannel().core).stopPollingInternalLogs)||void 0===n||n.call(i),this.initParams.enablePrivacyGuard&&this._initializePrivacyGuard(),this.contextCallbacks["DeviceInfo.OsVersion"]=this.onOsVersion.bind(this)}updateSDKWithPrivacyGuard(e){e?this._initializePrivacyGuard():this._stopPrivacyGuard()}setPrivacyGuardSensitiveInformation(e){if(this.privacyGuard){const t=e.userNames,i=e.upns;t&&(this.privacyGuardContext.UserNames=t),i&&(this.privacyGuardContext.UserAliases=[],i.forEach((e=>{var t;const i=e.split("@")[0];i&&(null===(t=this.privacyGuardContext.UserAliases)||void 0===t||t.push(i))}))),this.privacyGuard.updateCommonContext(this.privacyGuardContext)}}start(){this.resume()}stop(){this.pause()}pause(){this.oneDsManager.getPostChannel().pause(),this.statusParams.active=!1}resume(){this.oneDsManager.getPostChannel().resume(),this.statusParams.active=!0}setDeviceAuthToken(e){var t;(null===(t=this.initParams)||void 0===t?void 0:t.enableLoggingGlobalDeviceId)&&this.oneDsManager.getPostChannel().setMsaAuthTicket(e)}flush(e,t){this.oneDsManager.getPostChannel().flush(!!t,(()=>{e.postMessage("flushed")}))}flushForReinit(e){this.oneDsManager.getPostChannel().flush(!1,(()=>{e.postMessage("flushedForReinit"),this.pause()}))}createNewLogger(e,t){if(e&&(this.statusParams.firstPartyLoggerTokens[e]=""),e&&t&&this.initParams){const i=this.oneDsManager.newInst(t);if(!i)return;i.stopPollingInternalLogs(),this.oneDsLoggers[e]=i,this.statusParams.firstPartyLoggerTokens[e]=t;const n="MSTeamsFix15SecondsProfile";this.oneDsManager.getPostChannel()._loadTransmitProfiles({[n]:[this.initParams.normalPrioritySendTimeInSecs,this.initParams.highPrioritySendTimeInSecs]}),this.oneDsManager.getPostChannel()._setTransmitProfile(n)}}logEvent(e,t,i){var n;if(!e||!t)return;const a=this.oneDsLoggers[e];if(!a)return;const s=t.properties,r={logger:{value:e}};for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e)){const t=s[e],i={value:t.value,kind:t.pii};r[e]=i}const l=new Date(t.timestamp).toISOString(),d={name:t.name,baseType:t.eventType,time:l,data:Object.assign(Object.assign(Object.assign({},r),this.mainContextMap),this.loggerContextMap[e])};if(e!==o.h.default&&(d.data=Object.assign(Object.assign({},d.data),this.loggerContextMap[e])),null===(n=this.initParams)||void 0===n?void 0:n.enableMTMA){const e=!i&&this.primaryUser?this.userContextMap[this.primaryUser]:this.userContextMap[i];d.data=Object.assign(Object.assign({},d.data),e)}a.track(d)}createNewSecondPartyLogger(e,t,i=!1){const n=this.oneDsManager.newInst(t);n.stopPollingInternalLogs(),this.secondPartyLoggers[e]={logger:n,useTeamsContext:i},this.statusParams.secondPartyLoggerTokens[e]=t}logSecondPartyEvent(e,t){if(!e||!t)return;const i=this.secondPartyLoggers[e];i&&(i.useTeamsContext&&(t.data=Object.assign(Object.assign({},t.data),this.commonSchemaContextMap)),i.logger.track(t))}setContext(e){var t;const i={value:e.value};if(e.logger)return this.loggerContextMap[e.logger]||(this.loggerContextMap[e.logger]={}),void(this.loggerContextMap[e.logger][e.key]=i);(null===(t=this.initParams)||void 0===t?void 0:t.enableMTMA)?("UserInfo.Id"===e.key&&e.userContextId&&(this.userContextMap[e.userContextId]||(this.userContextMap[e.userContextId]={})),e.userContextId?(this.userContextMap[e.userContextId]||(this.userContextMap[e.userContextId]={}),this.userContextMap[e.userContextId][e.key]=i):this.mainContextMap[e.key]=i,this._setToCommonSchemaPropMap(e.key,i)):(this.mainContextMap[e.key]=i,this._setToCommonSchemaPropMap(e.key,i)),e.key in this.contextCallbacks&&this.contextCallbacks[e.key](e.key,e.value)}setUserId(e){var t;const i="UserInfo.Id",n={value:e,kind:void 0};(null===(t=this.initParams)||void 0===t?void 0:t.enableMTMA)?this.setContext({key:i,value:e,userContextId:e}):(this.mainContextMap[i]=n,this._setToCommonSchemaPropMap(i,n))}logOutUser(e){var t;(null===(t=this.initParams)||void 0===t?void 0:t.enableMTMA)&&(this.userContextMap[e]={})}logSession(e,t){t.sessionId&&this.oneDsManager.getPropertyManager().getPropertiesContext().session.setId(t.sessionId)}setPrimaryUser(e){this.primaryUser||(this.primaryUser=e,this.userContextMap[e]||(this.userContextMap[e]={}))}setUserTenantId(e){}setUserRing(e){}setAppClientType(e){}gzipPayload(e,t){e.data=(0,c.gzip)(e.data),e.urlString+="&content-encoding=gzip",t(e)}_setToCommonSchemaPropMap(e,t){const i=m[e.toLowerCase()];i&&(this.commonSchemaContextMap[i]=t)}_initializePrivacyGuard(){var e;null===(e=this.privacyGuard)||void 0===e||e.setEnabled(!0),this.intervalId||(this.intervalId=setInterval((()=>{var e;null===(e=this.privacyGuard)||void 0===e||e.sendSummaryEvent(!0)}),6e5))}_stopPrivacyGuard(){var e;this.intervalId&&clearInterval(this.intervalId),null===(e=this.privacyGuard)||void 0===e||e.setEnabled(!1)}onOsVersion(e,t){this.oneDsManager.getPropertyManager().getPropertiesContext().os.ver=t}}var p=i(915929);class g{constructor(e){this.router=e,this.isInitialized=!1,this.messageHandlers={},this.router.registerMessageHandler("initCoreSettingsWorker",(e=>{this.port=e.port,this.port.onmessage=this.onMessageHandler.bind(this),this.isInitialized=!0}))}get(e,t){return new Promise(((i,n)=>{var a;this.isInitialized&&this.port||n("CoreSettingsWorkerConsumer is not initialized");const s=`${(0,p.v4)()}-${e}`;this.messageHandlers[s]=e=>{const{values:t}=e;delete this.messageHandlers[s],i(t)},null===(a=this.port)||void 0===a||a.postMessage({type:"settingsRequest",payload:{category:e,settings:t,id:s}})}))}subscribe(e,t){var i;if(!this.isInitialized||!this.port)return;const n=i=>{const{values:n}=i;t(n),this.subscriptionCache&&this.subscriptionCache[e]&&(this.subscriptionCache[e].valueCache=n)};return this.subscriptionCache||(this.subscriptionCache={}),this.subscriptionCache[e]?(n({category:e,values:this.subscriptionCache[e].valueCache}),this.subscriptionCache[e].handlers.push(n)):this.subscriptionCache[e]||(this.subscriptionCache[e]={handlers:[],valueCache:{}},this.subscriptionCache[e].handlers.push(n),null===(i=this.port)||void 0===i||i.postMessage({type:"subscribeCategory",payload:{category:e}})),()=>{var t;this.subscriptionCache&&this.subscriptionCache[e]&&(this.subscriptionCache[e].handlers=this.subscriptionCache[e].handlers.filter((e=>e!==n)),0===this.subscriptionCache[e].handlers.length&&(null===(t=this.port)||void 0===t||t.postMessage({type:"unsubscribeCategory",payload:{category:e}})))}}onMessageHandler(e){const{type:t,payload:i}=e.data;if("settingsResponse"===t){const{id:t}=e.data.payload;this.messageHandlers[t](e.data.payload)}"categorySubscriptionResponse"===t&&this.subscriptionCache&&this.subscriptionCache[i.category]&&this.subscriptionCache[i.category].handlers.forEach((e=>{e(i)}))}}class v{constructor(){this.enableOneDsSdk=!1,this.transportDelayed=!1,this.existingTransports={},this.secondPartyLoggers={},this.firstPartyLoggers={},this.contextMap={},this.userContextMap={},this.primaryUser=""}initialize(e){if(!e)throw new Error("WebWorkerRouter did not exist.");this.router=e,this._registerMessageHandlers(e),this.workerCoreSettings=new g(e)}setupFirstPartyRouter(e,t){e.registerMessageHandler("initialize",(t=>{this.telemetryTransport?e.postMessage("workerInitialized"):this.transportDelayed=!0})),e.registerMessageHandler("newLogger",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.createNewLogger(e.key,e.value),this.firstPartyLoggers[e.key]=e.value})),e.registerMessageHandler("logEvent",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.logEvent(e.key,e.value,e.userContextId)})),e.registerMessageHandler("setContext",(e=>{var i;const{contextFilter:n}=t;n.has(e.key)&&(null===(i=this.telemetryTransport)||void 0===i||i.setContext(e))}))}Verbose(e){this.router&&this.router.postMessage("verbose",e)}Error(e){this.router&&this.router.postMessage("error",e)}Info(e){this.router&&this.router.postMessage("info",e)}_registerMessageHandlers(e){e.registerMessageHandler("initialize",(t=>{this.initTelemetryTransport(t),e.postMessage("workerInitialized")})),e.registerMessageHandler("start",(()=>{var e;null===(e=this.telemetryTransport)||void 0===e||e.start()})),e.registerMessageHandler("stop",(()=>{var e;null===(e=this.telemetryTransport)||void 0===e||e.stop()})),e.registerMessageHandler("flush",(t=>{var i;null===(i=this.telemetryTransport)||void 0===i||i.flush(e,null==t?void 0:t.isAsync)})),e.registerMessageHandler("flushForReinit",(t=>{this.reinitTelemetryTransport(t,e)})),e.registerMessageHandler("newLogger",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.createNewLogger(e.key,e.value),this.firstPartyLoggers[e.key]=e.value})),e.registerMessageHandler("logEvent",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.logEvent(e.key,e.value,e.userContextId)})),e.registerMessageHandler("newSecondPartyOneDsLogger",(e=>{this.createSecondPartyLogger(e.key,e.value.ingestionToken,e.value.useTeamsContext)})),e.registerMessageHandler("setPrimaryUser",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.setPrimaryUser(e.userContextId)})),e.registerMessageHandler("logSecondPartyEvent",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.logSecondPartyEvent(e.key,e.value)})),e.registerMessageHandler("logSession",(t=>{var i;t.sessionId&&(this.contextMap["Session.Id"]=t.sessionId),null===(i=this.telemetryTransport)||void 0===i||i.logSession(e,t)})),e.registerMessageHandler("setUserId",(e=>{var t;this.contextMap["UserInfo.Id"]=e,null===(t=this.telemetryTransport)||void 0===t||t.setUserId(e)})),e.registerMessageHandler("setUserTenantId",(e=>{var t;this.contextMap["UserInfo.TenantId"]=e,null===(t=this.telemetryTransport)||void 0===t||t.setUserTenantId(e)})),e.registerMessageHandler("setUserRing",(e=>{var t;this.contextMap["UserInfo.Ring"]=e,null===(t=this.telemetryTransport)||void 0===t||t.setUserRing(e)})),e.registerMessageHandler("setDeviceAuthToken",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.setDeviceAuthToken(e)})),e.registerMessageHandler("setAppClientType",(e=>{var t;this.contextMap["AppInfo.ClientType"]=e,null===(t=this.telemetryTransport)||void 0===t||t.setAppClientType(e)})),e.registerMessageHandler("setContext",(e=>{var t;this.contextMap[e.key]=e.value,this.enableMTMA?("UserInfo.Id"===e.key&&e.userContextId&&(this.userContextMap[e.userContextId]||(this.userContextMap[e.userContextId]={}),this.primaryUser||(this.primaryUser=e.userContextId)),e.userContextId?(this.userContextMap[e.userContextId]||(this.userContextMap[e.userContextId]={}),this.userContextMap[e.userContextId][e.key]=e.value):this.contextMap[e.key]=e.value):this.contextMap[e.key]=e.value,null===(t=this.telemetryTransport)||void 0===t||t.setContext(e)})),e.registerMessageHandler("setPrivacyGuardUserInfo",(e=>{var t;this.enableOneDsSdk&&(null===(t=this.telemetryTransport)||void 0===t||t.setPrivacyGuardSensitiveInformation(e))})),e.registerMessageHandler("updateSDKWithPrivacyGuard",(e=>{var t;this.enableOneDsSdk&&(null===(t=this.telemetryTransport)||void 0===t||t.updateSDKWithPrivacyGuard(e))})),e.registerMessageHandler("logOutUser",(e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.logOutUser(e)})),e.registerMessageHandler("pulsarSignal",(e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!this.pulsarSignalProcessor){const{ProcessorFactory:e}=yield i.e(850926).then(i.bind(i,502414));this.pulsarSignalProcessor=e.getInstance().createDefaultProcessor({notify:this.notifyPulsarConsumer.bind(this),workerCoreSettings:this.workerCoreSettings})}if(e.span&&e.type)switch(e.type){case"onStart":this.pulsarSignalProcessor.onStart(e.span.name,e.span);break;case"onEnd":this.pulsarSignalProcessor.onEnd(e.span.name,e.span)}}))))}notifyPulsarConsumer(e){var t;null===(t=this.router)||void 0===t||t.postMessage("pulsarSignal",e)}createSecondPartyLogger(e,t,i){var n;this.secondPartyLoggers[e]={token:t,useTeamsContext:i},null===(n=this.telemetryTransport)||void 0===n||n.createNewSecondPartyLogger(e,t,i)}reinitTelemetryTransport(e,t){var i,n,a;null===(i=this.telemetryTransport)||void 0===i||i.flushForReinit(t);const r=e.enableOneDsSdkNs?e.oneDsCollectorUrl||"":e.config.collectorUrl||"",l=this.existingTransports[r];l?l.statusParams.active?this.telemetryTransport=l:(this.telemetryTransport=l,Object.keys(this.firstPartyLoggers).forEach((e=>{var t,i,n;(null===(t=this.telemetryTransport)||void 0===t?void 0:t.statusParams.firstPartyLoggerTokens[e])&&(null===(i=this.telemetryTransport)||void 0===i?void 0:i.statusParams.firstPartyLoggerTokens[e])===this.firstPartyLoggers[e]||null===(n=this.telemetryTransport)||void 0===n||n.createNewLogger(o.h[e],this.firstPartyLoggers[e])})),Object.keys(this.secondPartyLoggers).forEach((e=>{var t,i,n;(null===(t=this.telemetryTransport)||void 0===t?void 0:t.statusParams.secondPartyLoggerTokens[e])&&(null===(i=this.telemetryTransport)||void 0===i?void 0:i.statusParams.secondPartyLoggerTokens[e])===this.secondPartyLoggers[e].token||null===(n=this.telemetryTransport)||void 0===n||n.createNewSecondPartyLogger(e,this.secondPartyLoggers[e].token,this.secondPartyLoggers[e].useTeamsContext)})),Object.keys(this.contextMap).forEach((e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.setContext({key:e,value:this.contextMap[e]})})),this.telemetryTransport.start()):(this.initTelemetryTransport(e),null===(n=this.telemetryTransport)||void 0===n||n.createNewLogger(e.defaultLoggerName||o.h.default,e.appTokens.default),null===(a=this.telemetryTransport)||void 0===a||a.logSession(t,{name:e.defaultLoggerName||o.h.default,state:s.sM.STARTED,sessionId:e.sessionId,sessionStartTime:e.sessionStartTime}),Object.keys(this.firstPartyLoggers).forEach((e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.createNewLogger(o.h[e],this.firstPartyLoggers[e])})),Object.keys(this.secondPartyLoggers).forEach((e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.createNewSecondPartyLogger(e,this.secondPartyLoggers[e].token,this.secondPartyLoggers[e].useTeamsContext)})),Object.keys(this.contextMap).forEach((e=>{var t;null===(t=this.telemetryTransport)||void 0===t||t.setContext({key:e,value:this.contextMap[e]})})))}initTelemetryTransport(e){var t;e.enableDebugTrace?e.config.log=this:e.config.log=void 0,e.enableOneDsSdkNs?(this.enableOneDsSdk=!0,this.telemetryTransport=new h,this.existingTransports[e.oneDsCollectorUrl||"defaultOneDsUrl"]=this.telemetryTransport):(this.telemetryTransport=new r,this.existingTransports[e.config.collectorUrl||"defaultAriaUrl"]=this.telemetryTransport),this.telemetryTransport.initialize(e),this.transportDelayed&&(null===(t=this.router)||void 0===t||t.postMessage("workerInitialized"))}}var _=i(561890);class k extends _.t{constructor(){super(),this.telemetryWorker=new v,this.telemetryWorker.initialize(this)}postMessage(e,t){const i=this.messageHandlers[e];i&&i(t)}}},974016:(e,t,i)=>{i.d(t,{Ow:()=>a,wA:()=>s,gv:()=>n});const n={parseFileLabelQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"parseFileLabelFromUrl"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ParseFileLabelFromUrlInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"parseFileLabelFromUrl"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileLabel"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"linktype"}}]}}]}}]}}]},fileDetailsForChicletQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDetailsForChiclet"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FileDetailsForChicletInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetailsForChiclet"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}},{kind:"Field",name:{kind:"Name",value:"fileSourceDetail"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileSource"}},{kind:"Field",name:{kind:"Name",value:"permissionScope"}}]}},{kind:"Field",name:{kind:"Name",value:"sharepointIds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"listId"}},{kind:"Field",name:{kind:"Name",value:"listItemUniqueId"}},{kind:"Field",name:{kind:"Name",value:"siteId"}},{kind:"Field",name:{kind:"Name",value:"webId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"publication"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"level"}},{kind:"Field",name:{kind:"Name",value:"versionId"}}]}},{kind:"Field",name:{kind:"Name",value:"site"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dataLocationCode"}},{kind:"Field",name:{kind:"Name",value:"template"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]}}]}}]},fetchShareInfoQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fetchShareInfo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"redeemFileInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"RedeemFileInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"redeemFile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"redeemFileInput"},value:{kind:"Variable",name:{kind:"Name",value:"redeemFileInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}},{kind:"Field",name:{kind:"Name",value:"sharepointIds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"siteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]},currentFilesQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getFiles"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fileContainerId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentFiles"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fileContainerId"},value:{kind:"Variable",name:{kind:"Name",value:"fileContainerId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"progress"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"isReferencedFile"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"progressComplete"}},{kind:"Field",name:{kind:"Name",value:"permissionScope"}},{kind:"Field",name:{kind:"Name",value:"hasUploadFailed"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"chicletBreadcrumbs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sourceTeamName"}},{kind:"Field",name:{kind:"Name",value:"sourceChannelName"}}]}},{kind:"Field",name:{kind:"Name",value:"externalFileShareInfo"}},{kind:"Field",name:{kind:"Name",value:"sharepointIds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"listId"}},{kind:"Field",name:{kind:"Name",value:"listItemUniqueId"}},{kind:"Field",name:{kind:"Name",value:"siteId"}},{kind:"Field",name:{kind:"Name",value:"webId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"publication"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"level"}},{kind:"Field",name:{kind:"Name",value:"versionId"}}]}},{kind:"Field",name:{kind:"Name",value:"site"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dataLocationCode"}},{kind:"Field",name:{kind:"Name",value:"template"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]}}]},userPreferencesQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPersonalSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileOpenPreference"}},{kind:"Field",name:{kind:"Name",value:"nonFileOpenPreferenceSelectedCount"}}]}}]}}]}}]}}]},fileShareDialogAudience:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"shareDialogAudience"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shareDialogAudienceInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ShareDialogAudienceInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shareDialogAudience"},arguments:[{kind:"Argument",name:{kind:"Name",value:"shareDialogAudienceInput"},value:{kind:"Variable",name:{kind:"Name",value:"shareDialogAudienceInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recipients"}},{kind:"Field",name:{kind:"Name",value:"audienceConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityName"}},{kind:"Field",name:{kind:"Name",value:"audienceType"}}]}}]}}]}}]},fileDetailsByIdQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDetailsById"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"redeemFileByIdInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"RedeemFileByIdInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"redeemFileById"},arguments:[{kind:"Argument",name:{kind:"Name",value:"redeemFileByIdInput"},value:{kind:"Variable",name:{kind:"Name",value:"redeemFileByIdInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}},{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]},fileDetailsWithSharepointIdQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDetailsWithSharepointId"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fileDetailsWithSharepointIdInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FileDetailsWithSharepointIdInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetailsWithSharepointId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fileDetailsWithSharepointIdInput"},value:{kind:"Variable",name:{kind:"Name",value:"fileDetailsWithSharepointIdInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}},{kind:"Field",name:{kind:"Name",value:"sharepointIds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"listItemUniqueId"}}]}}]}}]}}]},fileDetailsForThumbnailQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientFilesFileRedeemThumbnailQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"redeemFileInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"RedeemFileInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetailsForThumbnail"},arguments:[{kind:"Argument",name:{kind:"Name",value:"redeemFileInput"},value:{kind:"Variable",name:{kind:"Name",value:"redeemFileInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"webUrl"}},{kind:"Field",name:{kind:"Name",value:"size"}},{kind:"Field",name:{kind:"Name",value:"eTag"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}},{kind:"Field",name:{kind:"Name",value:"odataContext"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"parentReference"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"driveId"}},{kind:"Field",name:{kind:"Name",value:"driveType"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"path"}}]}},{kind:"Field",name:{kind:"Name",value:"cTag"}},{kind:"Field",name:{kind:"Name",value:"sharepointIds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"listId"}},{kind:"Field",name:{kind:"Name",value:"listItemId"}},{kind:"Field",name:{kind:"Name",value:"listItemUniqueId"}},{kind:"Field",name:{kind:"Name",value:"siteId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"syncResourceId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"webId"}}]}},{kind:"Field",name:{kind:"Name",value:"currentUserRole"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"allowEdit"}},{kind:"Field",name:{kind:"Name",value:"blocksDownload"}},{kind:"Field",name:{kind:"Name",value:"readOnly"}}]}},{kind:"Field",name:{kind:"Name",value:"thumbnails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"small"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"medium"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"large"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"file"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mimeType"}},{kind:"Field",name:{kind:"Name",value:"irmEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"fileSystemInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createdDateTime"}},{kind:"Field",name:{kind:"Name",value:"lastModifiedDateTime"}}]}},{kind:"Field",name:{kind:"Name",value:"shared"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"effectiveRoles"}},{kind:"Field",name:{kind:"Name",value:"scope"}}]}}]}}]}}]},openInDesktopAsDeviceSpecificFileOpenPreferenceQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"openInDesktopAsDeviceSpecificFileOpenPreference"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"openInDesktopAsDeviceSpecificFileOpenPreference"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isDesktopSetAsDefaultFileOpenPreference"}}]}}]}}]},filesThumbnailContentQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientFilesFilesThumbnailBlobContentQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"siteUrl"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"driveId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"thumbnailBlobObject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"siteUrl"},value:{kind:"Variable",name:{kind:"Name",value:"siteUrl"}}},{kind:"Argument",name:{kind:"Name",value:"driveId"},value:{kind:"Variable",name:{kind:"Name",value:"driveId"}}},{kind:"Argument",name:{kind:"Name",value:"itemId"},value:{kind:"Variable",name:{kind:"Name",value:"itemId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"blobUrl"}},{kind:"Field",name:{kind:"Name",value:"isContentFetchSuccessful"}},{kind:"Field",name:{kind:"Name",value:"fetchResult"}}]}}]}}]},filesThumbnailContentViaEncodedUrlQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientFilesThumbnailBlobContentViaEncodedUrlQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"siteUrl"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"encodedUrl"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"doRedeem"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"thumbnailBlobObjectViaEncodedUrl"},arguments:[{kind:"Argument",name:{kind:"Name",value:"siteUrl"},value:{kind:"Variable",name:{kind:"Name",value:"siteUrl"}}},{kind:"Argument",name:{kind:"Name",value:"encodedUrl"},value:{kind:"Variable",name:{kind:"Name",value:"encodedUrl"}}},{kind:"Argument",name:{kind:"Name",value:"doRedeem"},value:{kind:"Variable",name:{kind:"Name",value:"doRedeem"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"blobUrl"}},{kind:"Field",name:{kind:"Name",value:"isContentFetchSuccessful"}},{kind:"Field",name:{kind:"Name",value:"fetchResult"}}]}}]}}]}},a={fileDownloadDetailsUsingItemDetailsServiceQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDownloadDetailsUsingItemDetailsService"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemDetailsServiceInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDownloadDetailsUsingItemDetailsService"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}},{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]},fileDownloadDetailsUsingLegacyVroomServiceQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDownloadDetailsUsingLegacyVroomService"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LegacyVroomServiceInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDownloadDetailsUsingLegacyVroomService"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}}]}}]}}]}},s={downloadFileMutation:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"downloadFile"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"downloadUrl"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadFile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"downloadUrl"},value:{kind:"Variable",name:{kind:"Name",value:"downloadUrl"}}},{kind:"Argument",name:{kind:"Name",value:"httpMethod"},value:{kind:"StringValue",value:"GET",block:!1}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadUrl"}}]}}]}}]}}},24756:(e,t,i)=>{i.d(t,{y:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageToParentResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageToParentResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},855767:(e,t,i)=>{i.d(t,{qL:()=>n});const n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingInformationFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"scenario"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"meetingData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingCode"}},{kind:"Field",name:{kind:"Name",value:"passcode"}},{kind:"Field",name:{kind:"Name",value:"meetingUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"isRecurring"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"eventRecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}}]}},{kind:"Field",name:{kind:"Name",value:"eventRecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patternType"}},{kind:"Field",name:{kind:"Name",value:"daily"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"weekly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"daysOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"monthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeMonthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"yearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheMonth"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeYearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"resolvedSensitivityLabelId"}},{kind:"Field",name:{kind:"Name",value:"isCopyRestrictionEnforced"}},{kind:"Field",name:{kind:"Name",value:"templateDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}},658630:(e,t,i)=>{i.r(t),i.d(t,{cloudDomains:()=>n,CrossCloudUtils:()=>c});const n={publicCommercialCloud:"teams.microsoft.com",gccHighCloud:"gov.teams.microsoft.us",dodCloud:"dod.teams.microsoft.us",dev:"local.teams.office.com",devLive:"local.teams.live.com",liveCloud:"teams.live.com",ag08Cloud:"https://teams.eaglex.ic.gov",ag09Cloud:"https://teams.microsoft.scloud"},a=/^(\s|\/)+|(\s|\/)+$/g,s={pathNamesLength:4,threadIDIndex:2,secondPathName:"meetup-join"},r={pathNamesLength:2,meetingIDIndex:1,firstPathName:"meet"};function o(e,t){return[n.dev,n.publicCommercialCloud].includes(t)?[n.devLive,n.liveCloud].includes(e):!![n.devLive,n.liveCloud].includes(t)&&[n.dev,n.publicCommercialCloud].includes(e)}function l(e,t){let i;try{i=new URL(e)}catch(e){return!1}const n=i.pathname.replace(a,"").split("/"),l=i.hostname;return!((n.length!==s.pathNamesLength||n[1]!==s.secondPathName||!n[s.threadIDIndex])&&(n.length!==r.pathNamesLength||n[0]!==r.firstPathName||!n[r.meetingIDIndex]))&&o(l,t)}function d(e){return e.substring(e.lastIndexOf(":")+1)}const c={getMeetingLegacyURL:function(e){const{tenantId:t,organizerId:i,meetingCloud:n}=e,a=encodeURIComponent(e.conversationId),s=encodeURIComponent(e.rootMessageId),r=e.messageId||void 0,o=encodeURIComponent(JSON.stringify({Tid:t,Oid:i?d(i):"",MessageId:r}));if(a&&s&&i&&t&&n)return`https://${n}/l/meetup-join/${a}/${s}?context=${o}`},isCrossCloudMeetingJoinAttempt:function(e,t){return!(!e||t===e||o(e,t)||t===n.dev&&e===n.publicCommercialCloud||t===n.devLive&&e===n.liveCloud)},isCrossCloudMeetingJoinAttemptBetweenTFLAndTFW:o,isCrossCloudMeetingJoinBetweenTFLAndTFWAllowed:l,isDeepLinkExecutionForCrossCloudMeetingJoinBetweenTFLAndTFWAllowed:function(e,t,i){let n,a;try{n=new URL(e).hostname,a=i&&l(t,n)}catch(e){a=!1}return a},isLegacyMeetingUrl:function(e){let t;try{t=new URL(e)}catch(e){return!1}const i=t.pathname.replace(a,"").split("/");return i.length===s.pathNamesLength&&i[1]===s.secondPathName&&!!i[s.threadIDIndex]},isTFWDomain:function(e){return[n.dev,n.publicCommercialCloud].includes(e)},stripMriPrefix:d,isTFLMeetingURL:function(e){try{let t;return e&&(t=new URL(e)),!((null==t?void 0:t.host)!==n.liveCloud)}catch(e){return!1}}}},829525:(e,t,i)=>{i.d(t,{D:()=>a,n:()=>s});const n={2:"teams.microsoft.com",3:"teams.microsoft.com",4:"teams.microsoft.com",90:"teams.microsoft.com",91:"teams.microsoft.com",92:"teams.microsoft.com",93:"teams.live.com",94:"teams.live.com",95:"teams.live.com",990:"teams.microsoft.com",991:"teams.microsoft.com",992:"gov.teams.microsoft.us",993:"dod.teams.microsoft.us",994:"teams.microsoft.com",995:"teams.microsoft.com",996:"teams.microsoft.com"},a=(e,t,i,a)=>{var s;const r=new RegExp(e||"^(?<meetingCloudKey>[1-8]|9+[0-8])[1-9][0-9]*$").exec(a),o=null===(s=null==r?void 0:r.groups)||void 0===s?void 0:s.meetingCloudKey,l=Object.assign(Object.assign({},n),t);return l[o]?`https://${l[o]}/`:i},s=(e,t,i,n,s)=>{const r=a(e,t,i,n),o=new URL(`meet/${n}`,r);return s&&o.searchParams.append("p",s),o.toString()}},589008:(e,t,i)=>{i.d(t,{Mk:()=>k,sE:()=>f});var n=i(100836);class a{static IsSafariOrFirefox(){return null===a._isSafariOrFirefox&&a._DetectBrowser(),a._isSafariOrFirefox}static ajax(e){var t=a._createConnection();if(e.headers){var i="qsp=true";for(var n in e.headers)i+="&",i+=encodeURIComponent(n),i+="=",i+=encodeURIComponent(e.headers[n]);e.url.indexOf("?")<0?e.url+="?":e.url+="&",e.url+=i}t.open(e.type,e.url),e.complete&&(t.onload=()=>{void 0===t.status&&(t.status=200),e.complete(t)},t.ontimeout=()=>{void 0===t.status&&(t.status=500),e.complete(t)},t.onerror=()=>{e.complete(t)}),t.send(e.data)}static keys(e){if(Object.keys)return Object.keys(e);var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t}static IsUsingXDomainRequest(){null==a._usingXDomainRequest&&(void 0===(new XMLHttpRequest).withCredentials&&"undefined"!=typeof XDomainRequest?a._usingXDomainRequest=!0:a._usingXDomainRequest=!1);return a._usingXDomainRequest}static _createConnection(){var e=new XMLHttpRequest;return a.IsUsingXDomainRequest()?new XDomainRequest:e}static _DetectBrowser(){var e=navigator.userAgent.toLowerCase();(e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0?a._isSafariOrFirefox=!0:a._isSafariOrFirefox=!1}}a._isSafariOrFirefox=null,a._usingXDomainRequest=null;var s,r,o,l=i(878097),d=i(435098);class c{constructor(){this._buffer=[]}WriteByte(e){this._buffer.push(d.Mr.ToByte(e))}Write(e,t,i){for(;i--;)this.WriteByte(e[t++])}GetBuffer(){return this._buffer}}class u{constructor(){this.data=[]}WriteBlob(e){let t={type:"blob",value:e};this.data.push(t)}WriteBool(e){let t={type:"boolean",value:e};this.data.push(t)}WriteContainerBegin(e,t){let i={type:"containerBegin",size:e,elementType:t};this.data.push(i)}WriteMapContainerBegin(e,t,i){let n={type:"mapContainerBegin",size:e,keyType:t,valueType:i};this.data.push(n)}WriteContainerEnd(){this.data.push({type:"containerEnd"})}WriteDouble(e){let t={type:"number",value:e};this.data.push(t)}WriteFloat(e){let t={type:"number",value:e};this.data.push(t)}WriteFieldBegin(e,t,i){let n={type:"fieldBegin",id:t};this.data.push(n)}WriteFieldEnd(){this.data.push({type:"fieldEnd"})}WriteFieldOmitted(e,t,i){let n={type:"fieldOmitted",id:t};this.data.push(n)}WriteInt16(e){let t={type:"number",value:e};this.data.push(t)}WriteInt32(e){let t={type:"number",value:e};this.data.push(t)}WriteInt64(e){let t={type:"number",value:4294967296*e.high+e.low};this.data.push(t)}WriteInt8(e){let t={type:"number",value:e};this.data.push(t)}WriteString(e){let t={type:"string",value:e};this.data.push(t)}WriteStructBegin(e,t){let i={type:"structBegin",isBase:t};this.data.push(i)}WriteStructEnd(e){let t={type:"structEnd",isBase:e};this.data.push(t)}WriteUInt16(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt32(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt64(e){let t={type:"number",value:e};this.data.push(t)}WriteUInt8(e){let t={type:"number",value:e};this.data.push(t)}WriteWString(e){let t={type:"string",value:e};this.data.push(t)}}!function(e){e[e.ECS_ERROR_OK=0]="ECS_ERROR_OK",e[e.ECS_ERROR_INVALID_STATUS=1]="ECS_ERROR_INVALID_STATUS",e[e.ECS_ERROR_INVALID_RESPONSE=6]="ECS_ERROR_INVALID_RESPONSE",e[e.ECS_ERROR_INVALID_CONFIG=8]="ECS_ERROR_INVALID_CONFIG"}(s||(s={}));!function(e){e[e.CONFIG_UPDATED=0]="CONFIG_UPDATED",e[e.TOKEN_IS_INVALID=1]="TOKEN_IS_INVALID"}(r||(r={}));class m{}m.Servers=["https://config.teams.microsoft.com/config/v1/Skype/"],m.RefreshIntervalInMS=36e5,m.FailedRetryFactorInMS=1e4,m.MaxRetryIntervalForFailedInMS=36e5,function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started",e[e.Loading=3]="Loading"}(o||(o={}));var h,p,g,v=i(119830);!function(e){e[e.SENT=0]="SENT",e[e.SEND_FAILED=1]="SEND_FAILED"}(h||(h={})),function(e){e[e.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",e[e.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",e[e.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",e[e.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",e[e.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",e[e.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"}(p||(p={}));class _{constructor(e){this._errorCode=p.DATARV_ERROR_OK,this._errorCode=e}ErrorCode(){return this._errorCode}toString(){switch(this._errorCode){case p.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case p.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case p.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case p.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case p.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case p.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}}}class k{constructor(){this.eventsLimitInMem=1e4}}class f{static CreateTelemetryManager(){return new I}}class S{}S.MaxPackageSizeInBytes=3e6,S.TimeIntervalForNextSendInMS=15e3,function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started"}(g||(g={}));class I{constructor(){this._MaxPackageSizeInBytes=S.MaxPackageSizeInBytes,this._listeners=[],this._status=g.Created,this._ecsClient=null,this._etag=null,this._ecsCallback=null,this._testServerResponseHook=null,this._testHookListeners=[]}Initialize(e){if(this._status!=g.Created)throw new _(p.DATARV_ERROR_INVALID_STATUS);if(!e||!e.collectorUrl)throw new _(p.DATARV_ERROR_INVALID_CONFIG);this._config=e,this._Reset(),this._status=g.Initialized,e.ecsClient&&(this._Verbose("ECS object assigned. Do integration"),this._ecsClient=e.ecsClient),e.overwriteSendTimeInterval&&e.overwriteSendTimeInterval>=0&&(S.TimeIntervalForNextSendInMS=e.overwriteSendTimeInterval),this._Verbose("Initialize() done")}setEventsLimitInMem(e){this._eventsCache.setEventsLimitInMem(e)}AddListener(e){if(this._status<g.Initialized)throw new _(p.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length)}RemoveListener(e){if(this._status<g.Initialized)throw new _(p.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return 1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",t,"new length: ",this._listeners.length].join(""));this._Verbose("listener isn't been found, new length"+this._listeners.length)}Start(){if(this._status<g.Initialized)throw new _(p.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",I._tag].join(" ")),this._status>=g.Started&&this._Verbose("Start() already, ignore"),this._ecsClient&&(this._ecsCallback=this._CreateEcsCallback(),this._ecsClient.AddListener(this._ecsCallback),this._etag=this._ecsClient.GetETag()),++I._tag,this._status=g.Started,this._Verbose(["Start() done, status: ",this._status,"tag: ",I._tag].join(""))}Stop(){if(this._status<g.Initialized)throw new _(p.DATARV_ERROR_INVALID_STATUS);this._Verbose("Stop(), status: "+this._status),this._status!=g.Initialized?(this._Reset(),this._status=g.Initialized,this._Verbose("Stop() done, status: "+this._status)):this._Verbose("Stop() already, ignore")}Flush(e){this._eventsCache.IsEmpty()||this._WorkThread(e)}SendAsync(e,t){var i;if(this._status<g.Initialized)throw new _(p.DATARV_ERROR_INVALID_STATUS);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",t.length].join(" ")),this._status<g.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!e||!t)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new _(p.DATARV_ERROR_INVALID_ARG);for(var n=0;n<t.length;++n)if(!t[n].Id||!I._eventTypeRegex.test(t[n].EventType)||t[n].Timestamp.Equals("0"))throw this._Error(["eventId:",t[n].Id,"eventType:",t[n].EventType,"timestamp high:",t[n].Timestamp.high,"timestamp low:",t[n].Timestamp.low].join("")),new _(p.DATARV_ERROR_INVALID_EVENT);return null===(i=this._eventsCache)||void 0===i||i.AddEvents(e,t),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0}_WorkThread(e){var t;try{var i=Date.now();if(this._Verbose("_WorkThread, status: "+this._status),this._status<g.Started)return void this._Verbose("_WorkThread, status is not started, return");var n=this._eventsCache.DequeuEvents();if(null==n)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer();var s=n.events.length,r=this._PackEvents(n.tenantToken,n.events);null===(t=this._eventsCache)||void 0===t||t.AddEvents(n.tenantToken,r.remainedEvents);var o=r.remainedEvents.length;if(null==r.buffer||0==r.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)));if(this._testHookListeners)for(var d=0;d<this._testHookListeners.length;++d)this._testHookListeners[d](r.sendEvents);if(this._testServerResponseHook){var c=this._testServerResponseHook();return void setTimeout((()=>this._SendCallback(m,n.tenantToken,r.sendEvents,c,null)),100)}var u={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+v.w.version},complete:t=>this._SendCallback(m,n.tenantToken,r.sendEvents,t,e)};this._config.useJsonTextStream?(u.data=r.buffer,u.headers["content-type"]="application/json"):a.IsSafariOrFirefox()||"undefined"==typeof Uint8Array?(this._Verbose("Uint8Array is undefined, send with base64 encode."),u.data=l.DS.GetString(r.buffer),u.headers["content-encoding"]="base64"):(this._Verbose("Uint8Array is defined, send with binary format directly."),u.data=new Uint8Array(r.buffer)),n.tenantToken&&(u.headers["x-apikey"]=n.tenantToken);var m=I._tag;this._lastActiveTime=(new Date).getTime(),a.ajax(u),this._Verbose("_Workthread, send via jquery, tag: "+m),this._Info("Processing telemetry events took "+(Date.now()-i)+" ms for "+(s-o)+" events with total size of "+r.buffer.length+" bytes, remaining events - "+o)}catch(e){this._Error("_WorkThread, exception: "+e)}}_PackEvents(e,t){this._Verbose("_PackageEvents, total Count: "+t.length);var i,a=new n.$L,s=new n.Pm;s.Source="JS_default_source",s.DataPackageId=n.P6.GetGuid(),s.Timestamp=n.P6.GetTimeStamp();var r=t;if(t=[],r.length>200){var o=r.splice(0,200);t.push.apply(t,r),r=o}for(;s.Records=[],s.Records.push.apply(s.Records,r),a.DataPackages=[],a.DataPackages.push(s),i=this._Serialize(a),this._Verbose(["_PackageEvents, sendEvents.length:",r.length," buffer.length:",i.length," MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),!(i.length<this._MaxPackageSizeInBytes);){if(1==r.length){r=[],i=null;break}var l=r.splice(0,Math.floor(r.length/2));this._Verbose("_PackageEvents, too large, package again"),t.push.apply(t,r),r=l}return this._Verbose(["_PakcageEvents done, sendEventsCount:",r.length,"buffer.length:",null==i?0:i.length,"remained events:",t.length].join("")),{buffer:i,sendEvents:r,remainedEvents:t}}_Serialize(e){if(this._config.useJsonTextStream){var t=new u;return e.Write(t),JSON.stringify(t.data)}var i=new c,n=new d.rH(i);return e.Write(n),i.GetBuffer()}_SendCallback(e,t,i,n,a){var s;if(this._Verbose(["_SendCallback","tag:",e,"current tag:",I._tag,"tenantToken:",t,"events count:",i.length,"jqXHR:",n].join("")),null==a){var r=null!=n&&n.status>=200&&n.status<300;if(this._status<g.Started||e<I._tag)this._Verbose("_SendCallback, is not started, or tag is not the same, return");else{if(!(r||n&&400==n.status))return this._Verbose("retry statusCode: "+(n?n.status:0)),null===(s=this._eventsCache)||void 0===s||s.AddEvents(t,i),void this._ScheduleTimer(!0);for(var o=0;o<this._listeners.length;++o)this._listeners[o](r?h.SENT:h.SEND_FAILED,n?n.status:0,t,i);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}}else a(n?n.status:0,t,i)}_CleanTimer(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null)}_ScheduleTimer(e){if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);t=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=setTimeout((()=>this._WorkThread(null)),1e3*t),this._Verbose("_ScheduleTimer, next try (s): "+t),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1)}else{var t=0,i=(new Date).getTime()-this._lastActiveTime;t=i>S.TimeIntervalForNextSendInMS?0:S.TimeIntervalForNextSendInMS-i,this._timer=setTimeout((()=>this._WorkThread(null)),t),this._Verbose("_ScheduleTimer, next try: "+t),this._rescheduleFactor=1}}_Verbose(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e)}_Info(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e)}_Error(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e)}_Reset(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new y(this._config.log,this._config.eventsLimitInMem),this._ecsClient&&(this._ecsClient.RemoveListener(this._ecsCallback),this._ecsCallback=null)}_CreateEcsCallback(){return e=>{e==r.CONFIG_UPDATED&&(this._etag=this._ecsClient.GetETag())}}__AddTestHookListener(e){if(this._status<g.Initialized)throw new _(p.DATARV_ERROR_INVALID_STATUS);for(var t=0;t<this._testHookListeners.length;++t)if(this._testHookListeners[t]==e)return;this._testHookListeners.push(e)}__ClearTestHookListener(){this._testHookListeners=[]}__GetListenerArray(){return this._listeners}__GetTotalEventsCount(){return this._eventsCache.GetTotalEventsCount()}__IsScheduled(){return null!=this._timer}__ChageMaxPackageSizeInKB(e){this._MaxPackageSizeInBytes=1024*e}__SetTestServerResponseHook(e){this._testServerResponseHook=e}}I._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,I._tag=0;class y{constructor(e,t){this._logger=e,this._eventsLimitInMem=t,this._events={},this._tokens=[]}AddEvents(e,t){t.length&&(t.length>this._eventsLimitInMem?this._logDroppedEvents(e,t.length):(this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t)))}IsEmpty(){return 0==this._tokens.length}DequeuEvents(){if(0==this._tokens.length)return null;var e=this._tokens.shift(),t=this._events[e];return delete this._events[e],{tenantToken:e,events:t}}GetTotalEventsCount(){var e=0;for(var t in this._events)e+=this._events[t].length;return e}setEventsLimitInMem(e){this._eventsLimitInMem=e}_logDroppedEvents(e,t){if(!this._logger)return;let i=0;this._events[e]&&(i=this._events[e].length),this._logger.Verbose(`[TelemetryEventCache]: Size of dropped events: ${t},\n      events size currently in queue for tenant ${e}: ${i}`)}}},119830:(e,t,i)=>{i.d(t,{w:()=>n});class n{static get version(){return"2.5.0"}}},185870:(e,t,i)=>{i.d(t,{cS:()=>c,kc:()=>m,sM:()=>a,hD:()=>v,Yd:()=>_});var n,a,s=i(589008),r=i(100836),o=i(447918),l=i(119830),d=null;function c(e){d=e}class u{constructor(){this.key=null,this.value=null,this.pii=null}static _isPii(e){if(e==r.A4.NotSet)return!1;var t=!1;for(var i in r.A4)isNaN(i)||i==e&&(t=!0);return t}}class m{constructor(){this.name=null,this.timestamp=null,this.properties=[],this.eventType=null}setProperty(e,t,i){if(!e||!this.properties[e]&&!m._propertyNameRegex.test(e))throw new h(n.INVALID_PROPERTY_NAME);this.properties[e]={key:e,value:t,pii:i!=r.A4.NotSet?i:null}}unsetProperty(e){if(!e)throw new h(n.INVALID_PROPERTY_NAME);void 0!==this.properties[e]&&(this.properties[e]=void 0,delete this.properties[e])}}m._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$/,function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.INVALID_COLLECTOR_URL=4]="INVALID_COLLECTOR_URL",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE"}(n||(n={}));class h{constructor(e){this.errorCode=null,this.errorCode=e}ErrorCode(){return this.errorCode}toString(){switch(this.errorCode){case n.INVALID_TENANT_TOKEN:return"Invalid tenant token";case n.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case n.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$";case n.INVALID_COLLECTOR_URL:return"Collector url can't be null or empty.";case n.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case n.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case n.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case n.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case n.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";default:return"Unknown error"}}}class p{constructor(e){this.contextMap=new o.D,this.piiKind=r.A4.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=e}setAppId(e){e&&this.contextMap.Add("AppInfo.Id",e)}setAppVersion(e){e&&this.contextMap.Add("AppInfo.Version",e)}setAppClientType(e){e&&this.contextMap.Add("AppInfo.ClientType",e)}setAppLanguage(e){e&&this.contextMap.Add("AppInfo.Language",e)}setDeviceId(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.Id",e)}setDeviceOsName(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsName",e)}setDeviceOsVersion(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsVersion",e)}setDeviceBrowserName(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserName",e)}setDeviceBrowserVersion(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserVersion",e)}setUserId(e,t){e&&this.contextMap.Add("UserInfo.Id",e),u._isPii(t)&&(this.piiKind=t)}setUserMsaId(e){e&&this.contextMap.Add("UserInfo.MsaId",e)}setUserANID(e){e&&this.contextMap.Add("UserInfo.ANID",e)}setUserAdvertisingId(e){e&&this.contextMap.Add("UserInfo.AdvertisingId",e)}setUserTimeZone(e){e&&this.contextMap.Add("UserInfo.TimeZone",e)}setUserLanguage(e){e&&this.contextMap.Add("UserInfo.Language",e)}setUserRing(e){e&&this.contextMap.Add("UserInfo.Ring",e)}setUserTenantId(e){e&&this.contextMap.Add("UserInfo.TenantId",e)}}class g{static initialize(e){g.documentInfo=e;var t=e.appLanguage;t&&g.semanticContext.setAppLanguage(t);var i=e.userLanguage;i&&g.semanticContext.setUserLanguage(i);var n=(new Date).getTimezoneOffset(),a=n%60,s=(n-a)/60,r="+";s>0&&(r="-"),a=Math.abs(a);var o=r+((s=Math.abs(s))<10?"0"+s:s.toString())+":"+(a<10?"0"+a:a.toString());g.semanticContext.setUserTimeZone(o),g.semanticContext.setDeviceBrowserName(g._getBrowserName()),g.semanticContext.setDeviceBrowserVersion(g._getBrowserVersion()),g.semanticContext.setDeviceOsName(g._getOsName()),g.semanticContext.setDeviceOsVersion(g._getOsVersion()),g.semanticContext.setDeviceId(e.deviceId),g.firstLaunchTime=e.firstLaunchTime,g.semanticContext.setAppVersion(e.appVersion)}static _getUserAgent(){return g.documentInfo.userAgent}static _userAgentContainsString(e){return g._getUserAgent().indexOf(e)>-1}static _isIe(){return g._userAgentContainsString("Trident")}static _isEdge(){return g._userAgentContainsString(g.BROWSERS.EDGE)}static _isEdgeAnaheim(){return g._userAgentContainsString("Edg/")}static _isOpera(){return g._userAgentContainsString("OPR/")}static _getBrowserName(){return g._isOpera()?g.BROWSERS.UNKNOWN:g._userAgentContainsString(g.BROWSERS.PHANTOMJS)?g.BROWSERS.PHANTOMJS:g._isEdge()?g.BROWSERS.EDGE:g._isEdgeAnaheim()?g.BROWSERS.EDGEANAHEIM:g._userAgentContainsString(g.BROWSERS.ELECTRON)?g.BROWSERS.ELECTRON:g._userAgentContainsString(g.BROWSERS.CHROME)?g.BROWSERS.CHROME:g._userAgentContainsString(g.BROWSERS.FIREFOX)?g.BROWSERS.FIREFOX:g._userAgentContainsString(g.BROWSERS.SAFARI)?g.BROWSERS.SAFARI:g._userAgentContainsString(g.BROWSERS.SKYPE_SHELL)?g.BROWSERS.SKYPE_SHELL:g._isIe()?g.BROWSERS.MSIE:g.BROWSERS.UNKNOWN}static _getBrowserVersion(){return g._isIe()?function(){var e,t=g._getUserAgent(),i=t.match(new RegExp(g.BROWSERS.MSIE+" "+g.REGEX_VERSION));if(i)return i[1];if(e=t.match(new RegExp("rv:"+g.REGEX_VERSION)))return e[1]}():function(e){var t;e===g.BROWSERS.SAFARI?e="Version":e===g.BROWSERS.EDGEANAHEIM&&(e="Edg");if(t=g._getUserAgent().match(new RegExp(e+"/"+g.REGEX_VERSION)))return t[1];return g.UNKNOWN_VERSION}(g._getBrowserName())}static _getOsName(){return g._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?g.OPERATING_SYSTEMS.WINDOWS_PHONE:g._getUserAgent().match(/ arm;/i)?g.OPERATING_SYSTEMS.WINDOWS_RT:g._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?g.OPERATING_SYSTEMS.IOS:g._getUserAgent().match(/android/i)?g.OPERATING_SYSTEMS.ANDROID:g._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?g.OPERATING_SYSTEMS.LINUX:g._getUserAgent().match(/(macintosh|mac os x)/i)?g.OPERATING_SYSTEMS.MACOSX:g._getUserAgent().match(/(windows|win32)/i)?g.OPERATING_SYSTEMS.WINDOWS:g.OPERATING_SYSTEMS.UNKNOWN}static _getOsVersion(){return g._getOsName()===g.OPERATING_SYSTEMS.WINDOWS?function(){var e=g._getUserAgent().match(new RegExp("Windows NT "+g.REGEX_VERSION));if(e&&g.VERSION_MAPPINGS[e[1]])return g.VERSION_MAPPINGS[e[1]];return g.UNKNOWN_VERSION}():g._getOsName()===g.OPERATING_SYSTEMS.MACOSX?function(){var e=g._getUserAgent().match(new RegExp(g.OPERATING_SYSTEMS.MACOSX+" "+g.REGEX_VERSION_MAC));if(e){var t=e[1].replace(/_/g,".");if(t){var i=function(e){if(e.indexOf(".")>-1)return".";if(e.indexOf("_")>-1)return"_";return null}(t);return i?t.split(i)[0]:t}}return g.UNKNOWN_VERSION}():g.UNKNOWN_VERSION}}g.semanticContext=new p(!0),g.firstLaunchTime=-1,g.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",EDGEANAHEIM:"EdgeAnaheim",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},g.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},g.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},g.REGEX_VERSION="([\\d,.]+)",g.REGEX_VERSION_MAC="([\\d,_,.]+)",g.UNKNOWN_VERSION="Unknown",g.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",g.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED"}(a||(a={}));class v{static initialize(e,t){if(!v._initialized){if(!t)throw new h(n.INVALID_TENANT_TOKEN);v._defaultToken=t,v._config.collectorUrl||(v._config.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/"),d||(d=s.sE.CreateTelemetryManager()).Initialize(v._config),d.Start(),g.initialize(e),v._initialized=!0}}static initializeWithConfiguration(e,t,i){if(!i.collectorUrl)throw new h(n.INVALID_COLLECTOR_URL);v._config.collectorUrl=i.collectorUrl,v.initialize(e,t)}static flush(e){d.Flush(e)}static addCallbackListener(e){v._initialized&&d.AddListener(e)}static setContext(e,t,i){""!==t&&"null"!==t&&"undefined"!==t?v._contextProperties.setProperty(e,t,i):v._contextProperties.unsetProperty(e)}static isInitialized(){return v._initialized}static getDefaultToken(){return v._defaultToken}static getSemanticContext(){return v._semanticContext}static __addTestHookListener(e){v._initialized&&d.__AddTestHookListener(e)}static __clearTestHookListener(){v._initialized&&d.__ClearTestHookListener()}static __backToUninitialized(){v._config=new s.Mk,v._semanticContext=new p(!0),v._contextProperties=new m,d=s.sE.CreateTelemetryManager(),v._initialized=!1}}v._initialized=!1,v._defaultToken=null,v._config=new s.Mk,v._contextProperties=new m,v._semanticContext=new p(!0);class _{constructor(e){this._initId=r.P6.GetGuid(),this._sequence=0,this._tenantToken=null,this._contextProperties=new m,this._semanticContext=new p(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=e||v.getDefaultToken()}logEvent(e){if(!e.name)throw new h(n.MISSING_EVENT_PROPERTIES_NAME);var t=this._createEventRecord(e.name,e.eventType);this._addCustomPropertiesToEvent(t,e),this._sendRecord(t)}logFailure(e,t,i,a,s){if(!e)throw new h(n.MISSING_FAILURE_SIGNATURE);if(!t)throw new h(n.MISSING_FAILURE_DETAIL);var r=this._createEventRecord("failure","failure");r.Extension.Add("Failure.Signature",e),r.Extension.Add("Failure.Detail",t),i&&r.Extension.Add("Failure.Category",i),a&&r.Extension.Add("Failure.Id",a),this._addCustomPropertiesToEvent(r,s),this._sendRecord(r)}logPageView(e,t,i,a,s,r){if(!e)throw new h(n.MISSING_PAGEVIEW_ID);if(!t)throw new h(n.MISSING_PAGEVIEW_NAME);var o=this._createEventRecord("pageview","pageview");o.Extension.Add("PageView.Id",e),o.Extension.Add("PageView.Name",t),i&&o.Extension.Add("PageView.Category",i),a&&o.Extension.Add("PageView.Uri",a),s&&o.Extension.Add("PageView.ReferrerUri",s),this._addCustomPropertiesToEvent(o,r),this._sendRecord(o)}logSession(e,t,i,s){if(e!==a.STARTED&&e!==a.ENDED)throw new h(n.INVALID_SESSION_STATE);var o=this._createEventRecord("session","session");if(e===a.STARTED){if(this._sessionStartTime>0)return;this._sessionStartTime=s||(new Date).getTime(),this._sessionId=i||r.P6.GetGuid(),o.Extension.Add("Session.Id",this._sessionId),o.Extension.Add("Session.State","Started")}else if(e===a.ENDED){if(0==this._sessionStartTime)return;var l=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);o.Extension.Add("Session.Duration",l.toString()),o.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(l)),o.Extension.Add("Session.Id",this._sessionId),o.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0}o.Extension.Add("Session.FirstLaunchTime",new Date(g.firstLaunchTime).toISOString()),this._addCustomPropertiesToEvent(o,t),this._sendRecord(o)}getSessionId(){return this._sessionId}setContext(e,t,i){this._contextProperties.setProperty(e,t,i)}getSemanticContext(){return this._semanticContext}_getSessionDurationFromTime(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"}_createEventRecord(e,t){var i=new r.WV;t||(t="custom"),i.EventType=e.toLowerCase(),i.Type=t.toLowerCase(),i.Extension.Add("EventInfo.Source","JS_default_source"),i.Extension.Add("EventInfo.InitId",this._initId),this._sequence++,i.Extension.Add("EventInfo.Sequence",this._sequence.toString()),i.Extension.Add("EventInfo.Name",e.toLowerCase());var n=new Date;return i.Timestamp=r.P6.GetTimeStampWithValue(n.getTime()),i.Extension.Add("EventInfo.Time",n.toISOString()),i.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+l.w.version),i}_addCustomPropertiesToEvent(e,t){this._addSemanticContext(e,g.semanticContext),this._addSemanticContext(e,v._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,v._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t)}_addSemanticContext(e,t){if(t&&t.contextMap.Count()>0)for(var i=t.contextMap.GetBuffer(),n=0;n<i.length;n++)"UserInfo.Id"==i[n].Key&&t.piiKind!=r.A4.NotSet?e.AddOrReplacePII(i[n].Key,i[n].Value,t.piiKind):e.Extension.AddOrReplace(i[n].Key,i[n].Value)}_addEventPropertiesToEvent(e,t){if(t){t.timestamp&&t.timestamp>=new Date("1/1/2000").getTime()&&(e.Timestamp=r.P6.GetTimeStampWithValue(t.timestamp),e.Extension.AddOrReplace("EventInfo.Time",new Date(t.timestamp).toISOString())),t.name&&(e.EventType=t.name.toLowerCase(),e.Extension.AddOrReplace("EventInfo.Name",t.name.toLowerCase()));var i=t.properties;if(i)for(var n in i)i[n].key&&"string"==typeof i[n].key&&(i[n].value||0==i[n].value||0==i[n].value||""==i[n].value)&&(u._isPii(i[n].pii)?(e.AddOrReplacePII(i[n].key,i[n].value.toString(),i[n].pii),e.Extension.Remove(i[n].key)):(e.Extension.AddOrReplace(i[n].key,i[n].value.toString()),e.PIIExtensions.Remove(i[n].key)))}}_sendRecord(e){v.isInitialized()&&d.SendAsync(this._tenantToken,[e])}}},428957:(e,t,i)=>{i.d(t,{Kz:()=>l,Kp:()=>d,D5:()=>u,eT:()=>m,uO:()=>h,aE:()=>p,eA:()=>g,C$:()=>v,h5:()=>_,vf:()=>k,Mw:()=>f,IM:()=>S});var n=i(132756),a=i(905581),s=i(516909),r=i(275742);const o="ParsingMeetingUrl",l=e=>{const t=decodeURIComponent(e),i=new RegExp("context=(.*)$","g").exec(t);if(!i||i.length<2)throw c(`Meeting context is not in valid format ${t}`);const n=JSON.parse(i[1]);if(!n||!n.Tid||!n.Oid)throw c("Meeting url is malformed Tid or Oid is missing");return{tenantId:n.Tid,organizerId:n.Oid}},d=e=>e.context===o&&e.code===n.jK.ErrorParsingQueryParams,c=e=>(0,a.Tr)(o,n.jK.ErrorParsingQueryParams,"",void 0,e),u=e=>{const t="meet",i="meetup-join",n=new URL(e);let a;if(n.pathname.includes(t)||n.pathname.includes(i))a=n;else{if(!n.hash||!n.hash.includes(t)&&!n.hash.includes(i))throw c("Invalid URL - unsupported URL format");a=new URL(n.hash.substring(1),n.origin)}const s=a.searchParams,r=a.pathname.split("/"),o={isLegacyUrl:!1,meetingCloud:a.hostname,meetingUrl:e};if(r[2]===i){const e=s.get("context");if(5!==r.length||!e)throw c("Invalid URL - context param is missing");o.threadId=decodeURIComponent(r[3]),o.messageId=decodeURIComponent(r[4]);const t=JSON.parse(decodeURIComponent(e));if(!t.Tid||!t.Oid)throw c("Invalid URL - context param is invalid. Tid or Oid missing.");o.tenantId=t.Tid,o.organizerId=t.Oid,o.isBroadcastMeeting=t.IsBroadcastMeeting||void 0,o.attendeeRole=t.role||void 0,o.replyChainMessageId=t.MessageId||void 0,o.isLegacyUrl=!0}else{if(r[1]!==t)throw c("Invalid URL - unsupported URL format");o.meetingId=r[2],o.passCode=s.get("p")||void 0}return o},m=(e,t,i,n)=>{const a=u(e),o=(0,r.isEmpty)(i)?"calendar_join_meeting_utils":i;let l;return l=a.isLegacyUrl?{type:s.GXC.Meeting,joinOptions:{meeting:{showPrejoin:!0,isPSTN:!1,title:t},context:o},coordinates:{legacyMeeting:{meetingCloud:a.meetingCloud,conversationId:a.threadId||"",rootMessageId:a.messageId||"",messageId:a.replyChainMessageId||a.messageId||"",isChannel:"0"!==a.messageId,isAdhoc:!1,tenantId:a.tenantId||"",organizerId:a.organizerId||"",broadcast:a.isBroadcastMeeting?{role:null!=n?n:s.tf6.None}:null}}}:{type:s.GXC.Meeting,joinOptions:{meeting:{showPrejoin:!0,isPSTN:!1,title:t},context:o},coordinates:{meetingData:{meetingUrl:e}}},l},h=e=>{var t,i,n,a;try{return new URL(e).hostname}catch(s){return(null===(a=null===(n=null===(i=null===(t=e.split("/"))||void 0===t?void 0:t[2])||void 0===i?void 0:i.split("@"))||void 0===n?void 0:n.pop())||void 0===a?void 0:a.split(":").shift())||""}},p=e=>{let t=!1;if(e&&e.skypeTeamsDataObj){t=1===e.skypeTeamsDataObj.type}return t};function g(e){return!(!e||!e.skypeTeamsDataObj||(0,r.isEmpty)(e.skypeTeamsDataObj))&&!1===e.skypeTeamsDataObj.private}function v(e){return(null==e?void 0:e.mailboxType)===s.Bfc.Group}const _=e=>{var t;return!!(null===(t=e.webinarRegistration)||void 0===t?void 0:t.webinarId)},k=e=>{var t;return!!(null===(t=e.virtualEventsData)||void 0===t?void 0:t.eventId)},f=e=>{try{return"meet"===new URL(e).pathname.split("/")[1]}catch(e){return!1}},S=(e,t)=>e&&t},923975:(e,t,i)=>{i.d(t,{wr:()=>r,ae:()=>o,ZC:()=>l,g0:()=>d,cI:()=>c,W5:()=>u,sM:()=>m,E:()=>h});var n=i(658630),a=i(516909),s=i(412183);const r=n.cloudDomains,o=n.CrossCloudUtils.isCrossCloudMeetingJoinAttemptBetweenTFLAndTFW,l=n.CrossCloudUtils.isDeepLinkExecutionForCrossCloudMeetingJoinBetweenTFLAndTFWAllowed,d=(n.CrossCloudUtils.isLegacyMeetingUrl,n.CrossCloudUtils.isTFWDomain),c=n.CrossCloudUtils.isTFLMeetingURL,u=e=>({coordinates:{meetingData:{instantMeetingOptions:void 0,isAdhoc:!0}},joinOptions:{outgoingVideo:!0,outgoingAudio:!0,context:"WatchParty",meeting:{deeplinkId:e,isWatchParty:!0,showPrejoin:!0}},type:a.GXC.Meeting}),m=(e,t,i)=>{let n;if((0,s.N6)(e)){const{conversationId:t,messageId:i,rootMessageId:a,isChannel:s,isAdhoc:r,tenantId:o,organizerId:l,meetingCloud:d,registration:c,participantPin:u,broadcast:m}=e;n={legacyMeeting:{conversationId:t,messageId:i,rootMessageId:a,isChannel:s,isAdhoc:r,tenantId:o,organizerId:l,meetingCloud:d,registration:c,broadcast:m,participantPin:u}}}else{const{meetingCode:t,passcode:i,meetingUrl:a}=e.meetingData;n={meetingData:{participantPin:null==e?void 0:e.participantPin,meetingCode:t,passcode:i,meetingUrl:a}}}return{coordinates:n,joinOptions:{outgoingVideo:!1,outgoingAudio:!1,context:"DeepLink",meeting:{deeplinkId:t,showPrejoin:!0,isPSTN:!1,homeCloud:i}},type:a.GXC.Meeting}},h=(e,t,i,n,s)=>({coordinates:{legacyMeeting:{conversationId:i,messageId:n,rootMessageId:"",isChannel:!1,isAdhoc:!1,tenantId:e,organizerId:t,meetingCloud:"",broadcast:null,registration:s?{participantRegistrationId:s,isPublic:!0}:null,instantMeetingOptions:null}},joinOptions:{outgoingVideo:!1,outgoingAudio:!1,context:"Meeting EmbedLink",meeting:{showPrejoin:!0,isPSTN:!1}},type:a.GXC.Meeting})},412183:(e,t,i)=>{i.d(t,{N6:()=>d,aW:()=>c,xz:()=>m,R0:()=>h,AW:()=>p,N:()=>g,VF:()=>f,nv:()=>S});var n=i(829525),a=i(516909),s=i(50805),r=i(385975),o=i(275742);const l={"teams.microsoft.com":!1,"teams.live.com":!0},d=e=>!e||e.joinType!==a.cku.MeetingData,c=({user:e,coreSettings:t})=>{var i,n;return(0,r.n2)(e)?Boolean(null===(i=t.get(s.J.Calling))||void 0===i?void 0:i.enableImprovedFreemiumExperience):Boolean(null===(n=t.get(s.J.Calling))||void 0===n?void 0:n.enableMeetNowShareInvite)},u=(e,t)=>{const{enableInstantMeeting:i}=e.get(s.J.Calendar),{enableMeetNowInLandingPage:n,enableMeetNowInChatList:a}=e.get(s.J.Calling);switch(t){case"calendar":case"calendarMigration":return Boolean(i);case"chatList":return Boolean(a);case"landingPage":return Boolean(n);default:return!1}},m=(e,t,i)=>{const{allowMeetNowPolicy:n,allowPrivateMeetNowPolicy:a}=e.get(s.J.Calling);return i?Boolean(u(e,t)&&a):Boolean(u(e,t)&&n)},h=(e,t,i,n)=>{if(i)return e;const a=p(t,n);return a&&f(t,a)?a:e},p=(e,t)=>{if(!t||(0,o.isEmpty)(t))return"";if(t.meetingUrl)return t.meetingUrl;if(!t.meetingCode||!t.passcode)return"";const[i,a,s]=v(e);return n.n(i,a,s,t.meetingCode,t.passcode)},g=(e,t)=>{const[i,a,s]=v(e);return t&&!(0,o.isEmpty)(t)&&t.meetingCode?n.D(i,a,s,t.meetingCode):s},v=e=>{const{meetingIdCloudRegex:t,meetingIdPrefixToCloud:i}=e.get(s.J.Calling),{deeplinkBaseUrl:n}=e.get(s.J.Auth);return[t,_(i),n]},_=e=>Array.isArray(e)?Object.assign({},...e.map((e=>({[e.prefix]:e.cloud})))):{},k=e=>{try{return new URL(e).hostname}catch(e){return""}},f=(e,t)=>{var i;const n=null===(i=e.get(s.J.Calling))||void 0===i?void 0:i.cloudToShareMeetCodeLink,a=Object.assign(Object.assign({},l),(e=>Array.isArray(e)?Object.assign({},...e.map((e=>({[e.cloud]:e.shareMeetCodeLink})))):{})(n)),r=k(t);return r in a&&a[r]},S=e=>{var t;return e?d(e)?e.meetingCloud||"":(e=>!e||e.joinType===a.cku.MeetingData)(e)?k((null===(t=e.meetingData)||void 0===t?void 0:t.meetingUrl)||""):"":""}},385975:(e,t,i)=>{i.d(t,{n2:()=>s,L5:()=>r});var n=i(50805),a=i(455572);const s=e=>{var t;return(null===(t=null==e?void 0:e.tenant)||void 0===t?void 0:t.type)===a.OV.Freemium},r=({user:e,coreSettings:t})=>(e=>{var t;return Boolean(null===(t=e.get(n.J.Calling))||void 0===t?void 0:t.enableImprovedFreemiumExperience)})(t)&&s(e)},507829:(e,t,i)=>{function n(){const e={};return e.promise=new Promise(((t,i)=>{e.resolve=t,e.reject=i})),e}i.d(t,{P:()=>n})},549571:(e,t,i)=>{function n(e){let t=5381;for(let i=0;i<e.length;i++)t=(t<<5)+t+e.charCodeAt(i);return t>>>0}i.d(t,{E:()=>n})},984696:(e,t,i)=>{i.d(t,{n:()=>n});const n={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,capsLock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,zero:48,a:65,c:67,v:68,command:91,contextMenu:93,number0:48,number9:57,numpad0:96,numpad9:105,numpadAdd:107,numpadSubtract:109,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,equal:187,hyphen:189,forwardslash:191}},541986:(e,t,i)=>{i.d(t,{H:()=>s,P:()=>r});var n=i(50805);const a=["msteams:","ms-teams:"];function s(e,t,i=!1){const{deepLinkDomains:a,deepLinkPaths:s,supportHashDeeplinks:r}=t.get(n.J.Messaging),o=i?[""]:s||[];let l=a||[];return i||(l=l.concat(function(e){const{enableCrossCloudLaunch:t}=e.get(n.J.Core);if(!t)return[];const i=null==e?void 0:e.get(n.J.Auth).cloudDomainMap;if(!i)return[];const a=i.map((e=>`https://${e.domain}`));return a}(t))),c({url:e,deepLinkDomains:l,deepLinkPaths:o,supportHashDeeplinks:!!r,coreSettings:t})}function r(e,t){if(a.includes(e.protocol)){const i=t.get(n.J.Host).deepLinkDomain||void 0,a=o(e,t)||i;return new URL(`${e.pathname}${e.search}${e.hash}`,a)}return e}const o=(e,t)=>{const{enableOriginValidationForIncomingIntents:i}=t.get(n.J.Core);if(!i||"null"!==e.origin)return e.origin;if(!a.includes(e.protocol))return;const s=e.searchParams.get("fqdn");return s?new URL(`https://${s}`).origin:"null"===e.origin&&e.hostname?new URL(`https://${e.hostname}`).origin:void 0},l=(e,t,i,n)=>{const a=o(e,n);return!(a&&a!==t.origin||!e.pathname.startsWith(i))},d=(e,t,i)=>{const n=o(e,i);return!(n&&n!==t.origin||!e.hash||"/_"!==e.pathname)},c=({url:e,deepLinkDomains:t,deepLinkPaths:i,supportHashDeeplinks:n,coreSettings:a})=>{for(const s of t)for(const t of i){let i,r;try{i=new URL(e),r=new URL(t,s)}catch(e){return!1}if(l(i,r,t,a))return!0;if(n&&d(i,r,a))return!0}return!1}},303307:(e,t,i)=>{i.d(t,{z:()=>n});const n=(e,t)=>{if(e&&t){const t=/^(.*); expires=(.*); path=\/$/,i=2,n=e.match(t);if(n){return new Date(n[i]).getTime()>Date.now()}}return!1}},816772:(e,t,i)=>{i.d(t,{X:()=>n,si:()=>s,D:()=>r});const n="other";var a;function s(e){return!!a[e]}function r(){return Object.keys(a).filter((e=>isNaN(Number(e))))}!function(e){e[e["3mf"]=0]="3mf",e[e.cool=1]="cool",e[e.glb=2]="glb",e[e.gltf=3]="gltf",e[e.obj=4]="obj",e[e.stl=5]="stl",e[e.movie=6]="movie",e[e.pages=7]="pages",e[e.pict=8]="pict",e[e.sketch=9]="sketch",e[e.ai=10]="ai",e[e.pdf=11]="pdf",e[e.psb=12]="psb",e[e.psd=13]="psd",e[e["3g2"]=14]="3g2",e[e["3gp"]=15]="3gp",e[e.asf=16]="asf",e[e.bmp=17]="bmp",e[e.hevc=18]="hevc",e[e.m2ts=19]="m2ts",e[e.m4v=20]="m4v",e[e.mov=21]="mov",e[e.mp3=22]="mp3",e[e.mp4=23]="mp4",e[e.mp4v=24]="mp4v",e[e.mts=25]="mts",e[e.ts=26]="ts",e[e.wmv=27]="wmv",e[e.dwg=28]="dwg",e[e.fbx=29]="fbx",e[e.erf=30]="erf",e[e.zip=31]="zip",e[e["7z"]=32]="7z",e[e.z=33]="z",e[e.dcm=34]="dcm",e[e.dcm30=35]="dcm30",e[e.dicm=36]="dicm",e[e.dicom=37]="dicom",e[e.ply=38]="ply",e[e.hcp=39]="hcp",e[e.gif=40]="gif",e[e.heic=41]="heic",e[e.heif=42]="heif",e[e.jpeg=43]="jpeg",e[e.jpg=44]="jpg",e[e.jpe=45]="jpe",e[e.mef=46]="mef",e[e.mrw=47]="mrw",e[e.nef=48]="nef",e[e.nrw=49]="nrw",e[e.orf=50]="orf",e[e.pano=51]="pano",e[e.pef=52]="pef",e[e.png=53]="png",e[e.rw2=54]="rw2",e[e.spm=55]="spm",e[e.tif=56]="tif",e[e.tiff=57]="tiff",e[e.xbm=58]="xbm",e[e.xcf=59]="xcf",e[e.key=60]="key",e[e.csv=61]="csv",e[e.dic=62]="dic",e[e.doc=63]="doc",e[e.docm=64]="docm",e[e.docx=65]="docx",e[e.dot=66]="dot",e[e.dotm=67]="dotm",e[e.dotx=68]="dotx",e[e.pot=69]="pot",e[e.potm=70]="potm",e[e.potx=71]="potx",e[e.pps=72]="pps",e[e.ppsm=73]="ppsm",e[e.ppsx=74]="ppsx",e[e.ppt=75]="ppt",e[e.pptm=76]="pptm",e[e.pptx=77]="pptx",e[e.xd=78]="xd",e[e.xls=79]="xls",e[e.xlsb=80]="xlsb",e[e.xlsm=81]="xlsm",e[e.xlsx=82]="xlsx",e[e.sltx=83]="sltx",e[e.eml=84]="eml",e[e.msg=85]="msg",e[e.vsd=86]="vsd",e[e.vsdx=87]="vsdx",e[e.cur=88]="cur",e[e.ico=89]="ico",e[e.icon=90]="icon",e[e.epub=91]="epub",e[e.odp=92]="odp",e[e.ods=93]="ods",e[e.odt=94]="odt",e[e.arw=95]="arw",e[e.cr2=96]="cr2",e[e.crw=97]="crw",e[e.dng=98]="dng",e[e.rtf=99]="rtf",e[e.abap=100]="abap",e[e.ada=101]="ada",e[e.adp=102]="adp",e[e.ahk=103]="ahk",e[e.as=104]="as",e[e.as3=105]="as3",e[e.asc=106]="asc",e[e.ascx=107]="ascx",e[e.asm=108]="asm",e[e.asp=109]="asp",e[e.awk=110]="awk",e[e.bas=111]="bas",e[e.bash=112]="bash",e[e.bash_login=113]="bash_login",e[e.bash_logout=114]="bash_logout",e[e.bash_profile=115]="bash_profile",e[e.bashrc=116]="bashrc",e[e.bat=117]="bat",e[e.bib=118]="bib",e[e.bsh=119]="bsh",e[e.build=120]="build",e[e.builder=121]="builder",e[e.c=122]="c",e[e.capfile=123]="capfile",e[e.cbk=124]="cbk",e[e.cc=125]="cc",e[e.cfc=126]="cfc",e[e.cfm=127]="cfm",e[e.cfml=128]="cfml",e[e.cl=129]="cl",e[e.clj=130]="clj",e[e.cmake=131]="cmake",e[e.cmd=132]="cmd",e[e.coffee=133]="coffee",e[e.cpp=134]="cpp",e[e.cpt=135]="cpt",e[e.cpy=136]="cpy",e[e.cs=137]="cs",e[e.cshtml=138]="cshtml",e[e.cson=139]="cson",e[e.csproj=140]="csproj",e[e.css=141]="css",e[e.ctp=142]="ctp",e[e.cxx=143]="cxx",e[e.d=144]="d",e[e.ddl=145]="ddl",e[e.dif=146]="dif",e[e.diff=147]="diff",e[e.disco=148]="disco",e[e.dml=149]="dml",e[e.dtd=150]="dtd",e[e.dtml=151]="dtml",e[e.el=152]="el",e[e.emake=153]="emake",e[e.erb=154]="erb",e[e.erl=155]="erl",e[e.f90=156]="f90",e[e.f95=157]="f95",e[e.fluid=158]="fluid",e[e.fs=159]="fs",e[e.fsi=160]="fsi",e[e.fsscript=161]="fsscript",e[e.fsx=162]="fsx",e[e.gemfile=163]="gemfile",e[e.gemspec=164]="gemspec",e[e.gitconfig=165]="gitconfig",e[e.go=166]="go",e[e.groovy=167]="groovy",e[e.gvy=168]="gvy",e[e.h=169]="h",e[e.haml=170]="haml",e[e.handlebars=171]="handlebars",e[e.hbs=172]="hbs",e[e.hrl=173]="hrl",e[e.hs=174]="hs",e[e.htc=175]="htc",e[e.hxx=176]="hxx",e[e.idl=177]="idl",e[e.iim=178]="iim",e[e.inc=179]="inc",e[e.inf=180]="inf",e[e.ini=181]="ini",e[e.inl=182]="inl",e[e.ipp=183]="ipp",e[e.ipynb=184]="ipynb",e[e.irbrc=185]="irbrc",e[e.jade=186]="jade",e[e.jav=187]="jav",e[e.java=188]="java",e[e.jfif=189]="jfif",e[e.js=190]="js",e[e.json=191]="json",e[e.jsp=192]="jsp",e[e.jsx=193]="jsx",e[e.l=194]="l",e[e.less=195]="less",e[e.lhs=196]="lhs",e[e.lisp=197]="lisp",e[e.log=198]="log",e[e.lst=199]="lst",e[e.ltx=200]="ltx",e[e.lua=201]="lua",e[e.m=202]="m",e[e.make=203]="make",e[e.markdn=204]="markdn",e[e.mdown=205]="mdown",e[e.mkdn=206]="mkdn",e[e.ml=207]="ml",e[e.mli=208]="mli",e[e.mll=209]="mll",e[e.mly=210]="mly",e[e.mm=211]="mm",e[e.mud=212]="mud",e[e.nfo=213]="nfo",e[e.opml=214]="opml",e[e.osascript=215]="osascript",e[e.out=216]="out",e[e.p=217]="p",e[e.pas=218]="pas",e[e.patch=219]="patch",e[e.php=220]="php",e[e.php2=221]="php2",e[e.php3=222]="php3",e[e.php4=223]="php4",e[e.php5=224]="php5",e[e.pl=225]="pl",e[e.plist=226]="plist",e[e.pm=227]="pm",e[e.pod=228]="pod",e[e.pp=229]="pp",e[e.profile=230]="profile",e[e.properties=231]="properties",e[e.ps=232]="ps",e[e.ps1=233]="ps1",e[e.pt=234]="pt",e[e.py=235]="py",e[e.pyw=236]="pyw",e[e.r=237]="r",e[e.rake=238]="rake",e[e.rb=239]="rb",e[e.rbx=240]="rbx",e[e.rc=241]="rc",e[e.re=242]="re",e[e.readme=243]="readme",e[e.reg=244]="reg",e[e.rest=245]="rest",e[e.resw=246]="resw",e[e.resx=247]="resx",e[e.rhtml=248]="rhtml",e[e.rjs=249]="rjs",e[e.rprofile=250]="rprofile",e[e.rpy=251]="rpy",e[e.rss=252]="rss",e[e.rst=253]="rst",e[e.rxml=254]="rxml",e[e.s=255]="s",e[e.sass=256]="sass",e[e.scala=257]="scala",e[e.scm=258]="scm",e[e.sconscript=259]="sconscript",e[e.sconstruct=260]="sconstruct",e[e.script=261]="script",e[e.scss=262]="scss",e[e.sgml=263]="sgml",e[e.sh=264]="sh",e[e.shtml=265]="shtml",e[e.sml=266]="sml",e[e.sql=267]="sql",e[e.sty=268]="sty",e[e.tcl=269]="tcl",e[e.tex=270]="tex",e[e.text=271]="text",e[e.textile=272]="textile",e[e.tld=273]="tld",e[e.tli=274]="tli",e[e.tmpl=275]="tmpl",e[e.tpl=276]="tpl",e[e.txt=277]="txt",e[e.vb=278]="vb",e[e.vi=279]="vi",e[e.vim=280]="vim",e[e.wsdl=281]="wsdl",e[e.xaml=282]="xaml",e[e.xhtml=283]="xhtml",e[e.xoml=284]="xoml",e[e.xml=285]="xml",e[e.xsd=286]="xsd",e[e.xsl=287]="xsl",e[e.xslt=288]="xslt",e[e.yaml=289]="yaml",e[e.yaws=290]="yaws",e[e.yml=291]="yml",e[e.zsh=292]="zsh",e[e.htm=293]="htm",e[e.html=294]="html",e[e.markdown=295]="markdown",e[e.md=296]="md",e[e.url=297]="url",e[e.one=298]="one",e[e.note=299]="note",e[e.whiteboard=300]="whiteboard"}(a||(a={}))},645534:(e,t,i)=>{i.d(t,{le:()=>n,bx:()=>a,Np:()=>s,V_:()=>r,Ie:()=>o,Q4:()=>l});const n={filePickerSource:{upload_from_pc:"upload_from_pc",share_from_odb:{key:"share_from_odb",sourceName:"OneDrive",icon:"fluent-onedrive"}},telemetry:{errorCodes:{messageSentBeforeSyncLinkConversion:"MessageAlreadySent",asyncLinkConversionPretransformFailure:"PretransformRuntimeError",asyncLinkMultiplePretransform:"MultiplePretransform",fileSharingErrorBoundaryError:"FileSharingErrorBoundaryError",asyncImportFailed:"AsyncImportFailed",pickerLocaleLoadFailed:"PickerLocaleLoadFailed",itemsViewStringsNotPresentInWindow:"ItemsViewStringsNotPresentInWindow",siteInfoError:"SiteInfoError"},errors:{messageSentBeforeLinkConversion:"message_sent_before_link_conversion"},markers:{auth_token_call_start:"auth_token_call_start",auth_token_received:"auth_token_received",auth_token_empty:"auth_token_empty",auth_token_requested_with_claims_challenge:"auth_token_requested_with_claims_challenge",super_picker_initialisation_auth_token_start:"super_picker_initialisation_auth_token_start",super_picker_initialisation_auth_token_received:"super_picker_initialisation_auth_token_received",super_picker_render_auth_token_start:"super_picker_render_auth_token_start",super_picker_render_auth_token_end:"super_picker_render_auth_token_end",super_picker_render_third_party_providers:"super_picker_render_third_party_providers",render_third_party_providers_start:"render_third_party_providers_start",render_third_party_providers_end:"render_third_party_providers_end",render_third_party_provider_content_start:"render_third_party_provider_content_start",render_third_party_provider_with_provider_type:"render_third_party_provider_with_provider_type",render_third_party_provider_content_end:"render_third_party_provider_content_end",super_picker_render_auth_token_failed:"super_picker_render_auth_token_failed",auth_token_call_failed:"auth_token_call_failed",claims_challenge_auth_token_call_start:"claims_challenge_auth_token_call_start",claims_challenge_auth_token_received:"claims_challenge_auth_token_received",claims_challenge_auth_token_failed:"claims_challenge_auth_token_failed",claims_challenge_auth_token_empty:"claims_challenge_auth_token_empty",site_info_call_started:"site_info_call_started",site_info_data_received:"site_info_data_received",async_bundle_import_start:"async_bundle_import_start",async_bundle_import_complete:"async_bundle_import_complete",picker_locale_load_start:"locale_load_start",picker_locale_retry:"picker_locale_retry",picker_locale_load_end:"picker_locale_load_end",items_view_strings_loaded_on_host:"items_view_strings_loaded_on_host",items_view_strings_loaded_on_parent:"items_view_strings_loaded_on_parent",filebrowser_prewarm_auth_token_failed:"filebrowser_prewarm_auth_token_failed",filebrowser_prewarm_auth_token_end:"filebrowser_prewarm_auth_token_end",filebrowser_prewarm_auth_token_start:"filebrowser_prewarm_auth_token_start",filebrowser_prewarm_close_post_message:"filebrowser_prewarm_close_post_message",filebrowser_prewarm_auth_post_message:"filebrowser_prewarm_auth_post_message",filebrowser_prewarm_window_creation_successful:"filebrowser_prewarm_window_creation_successful",filebrowser_prewarm_window_creation_failed:"filebrowser_prewarm_window_creation_failed",filebrowser_prewarm_window_removed:"filebrowser_prewarm_window_removed"},reasons:{auth_token_call_failed:"auth_token_call_failed",personal_site_info_query_failed:"personal_site_info_query_failed",personal_site_info_query_empty:"personal_site_info_query_empty",invalid_site_info_data:"invalid_site_info_data",async_bundle_import_fail:"async_bundle_import_fail",picker_locale_load_fail:"picker_locale_load_fail",error_loading_component_package:"error_loading_component_package"}},localeRetries:1,asyncLinkToChicletConversionIdentifier:"unprocessed-filelink",odsp2013IllegalCharsRegex:/[~"#%&*:<>?/\\{|}\r?\n\r]/g,odspM365IllegalCharsRegex:/["*:<>?/\\|\r?\n\r]/g,odspIllegalWordRegex:/_vti_/gi,odspUnsupportedFilenameList:["con","prn","aux","nul","com0","com1","com2","com3","com4","com5","com6","com7","com8","com9","lpt0","lpt1","lpt2","lpt3","lpt4","lpt5","lpt6","lpt7","lpt8","lpt9"],odspUnsupportedFilenameWithExtList:[".lock","desktop.ini"]};var a,s;!function(e){e.Treatment="TEAMS-TREATMENT",e.Control="TEAMS-CONTROL"}(a||(a={})),function(e){e.teamsMaglev="TEAMS-MAGLEV",e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB"}(s||(s={}));const r="Teams";var o,l;!function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB"}(o||(o={})),function(e){e.ODPicker="ODPicker",e.SharePointLink="SharePointLink",e.Slimpicker="Slimpicker",e.Superpicker="Superpicker",e.ConflcitReshare="ConflictResahre"}(l||(l={}))},298117:(e,t,i)=>{i.d(t,{Q:()=>r});var n=i(475230);const a=new RegExp(n.yH.oneDriveFile),s=new RegExp(n.yH.sharePointFile),r=(e,t)=>{if(t){const i=t.replace(n.yH.leadingAndTrailingSlashesRegex,"").split("/");i.pop();const a=i.join("/");return`${new URL(e).origin}/${a}/`}if(s.test(e)){const t=e.match(s);return t?t[0]:null}if(a.test(e)){const t=e.match(a);return t?t[0]:null}if(e){const t=e.split("/"),i=2;if(t.length>=i)return`${t[0]}//${t[i]}/`}return e}},475230:(e,t,i)=>{i.d(t,{as:()=>n,Ho:()=>a,HV:()=>s,Hr:()=>r,yH:()=>o,v$:()=>l,wg:()=>d,BY:()=>c,Y_:()=>u,Bx:()=>m,MI:()=>h,Aq:()=>p,N0:()=>g,BS:()=>v,Fk:()=>_,Z2:()=>k,Z$:()=>f,ov:()=>S,Mc:()=>I,p5:()=>y,xK:()=>N,_v:()=>C,JJ:()=>T});const n={url:{getDriveItemAndPermissions:"/_api/v2.0/shares/{shareID}",fetchShareInfo:"/_api/v2.0/shares/{shareID}/driveItem",getDriveItemWithId:"/_api/v2.0/sites/root/items/{fileId}/driveItem",defaultPermissionsWithFileId:"/_api/v2.0/sites/root/items/{fileID}/driveItem/commands",getLinkPermissions:"/_api/v2.0/shares/{shareID}/permission",fetchVideoInfoWithThumbnails:"/_api/v2.0/shares/{shareID}/driveItem?$expand=thumbnails",createLinkWithId:"/_api/v2.1/sites/root/items/{id}/driveItem/createLink",createLinkWithShareId:"/_api/v2.1/shares/{shareId}/driveItem/createLink",getSharingInformation:"/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid",getSharingInformationByUrl:"_api/web/GetFileByUrl(@a1)/ListItemAllFields/GetSharingInformation?@a1="}},a={THREAD_ID_UPDATE_URL:"beta/teams/recent/files/backfillSpoIds?threadId={channelThreadId}",THREAD_ID_UPDATE_APINAME:"backfillSpoIds"},s={personal:"personal",teams:"teams"},r={bim:"bim",mw:"mw",ns:"ns",rwc:"rwc"},o={leadingAndTrailingSlashesRegex:/(^\/|\/$)/g,oneDriveFile:`.*/${s.personal}/[^/]*/`,sharePointFile:`.*/(${s.teams}|sites)/[^/]*/`,trailingSlashRegex:/\/$/,oneNoteTargetRegex:/target\((.*)\/\)/,oneNoteSectionRegex:/(.*).one\|/,title:/^[^\\\/\:\*\?\"\<\>\|\#\%\t]*$/},l={personal:"personal",sharePoint:"share-point"},d={states:{active:"active",deleted:"deleted",reference:"reference",removed:"removed"}},c={type:"oneNote",extension:"one",extensionWithDot:".one"},u={openInTeams:"OpenFileInTeamsViewer",editInTeams:"EditInTeams",openInOfficeOnline:"OpenInOfficeOnline",openInOfficeClient:"OpenInOfficeClient"},m={clientError:-1,ok:200,badRequest:400,unauthorizedAccess:401,forbidden:403,notFound:404,notAcceptable:406,conflict:409,locked:423,tooManyRequests:429,internalServerError:500,serviceUnavailable:503,notModified:304},h={uploadCancelled:"UPLOAD_CANCELLED",conflicted:"-2130575257",conflicted_v2:"-2147024816",conflicted_v3:"nameAlreadyExists",folderDoesNotExist:"-2147024893",locked:"-2147018894",spQuotaReached:"-2147023080",quotaLimitReached:"quotaLimitReached",fileNotFound:"-2130575338",itemNotFound:"itemNotFound",fileAccessDenied:"FileAccessDenied",accessDenied:"accessDenied",sessionInProgress:"-2130575142",unauthorizedAccessException:"-2147024891",cobaltException:"-1, Cobalt.ErrorException",resourceLockedException:"-2147018887",audienceUriValidationFailedException:"Microsoft.IdentityModel.Tokens.AudienceUriValidationFailedException",unauthenticated:"unauthenticated",invalidAudienceUri:"invalidAudienceUri",siteRenameFailure:"-2147024809",notAllowed:"notAllowed",resourceLocked:"resourceLocked",authChallengeRequired:"authChallengeRequired",InteractionRequired:"InteractionRequired"};var p,g,v,_;!function(e){e.filePropertiesMissing="FILE_PROPERTIES_MISSING",e.maxFilesAttachment="MAX_FILES_ATTACHMENT",e.nullFiles="NULL_FILES",e.zeroSizeFile="ZERO_SIZE_FILE",e.titleContainSpecialCharacter="TITLE_CONTAIN_SPECIAL_CHARACTER",e.blacklistedFiletype="BLACK_LIST_FILE_TYPE",e.fileNameTooLong="FILE_NAME_TOO_LONG",e.siteInfoNotFound="SITE_INFO_NOT_FOUND",e.spQuotaReached="SP_QUOTA_REACHED",e.fileNotPresent="FILE_NOT_PRESENT",e.fileAccessDenied="FILE_ACCESS_DENIED",e.fileLocked="FILE_LOCKED",e.siteNotProvisioned="SITE_NOT_PROVISIONED",e.siteNotProvisionedSubtext="SITE_NOT_PROVISIONED_SUBTEXT",e.channelSiteNotProvisioned="CHANNEL_SITE_NOT_PROVISIONED",e.channelSiteNotProvisionedSubtext="CHANNEL_SITE_NOT_PROVISIONED_SUBTEXT",e.fileAlreadyAttachedInMessage="FILE_WITH_SAME_NAME_ALREADY_ATTACHED_IN_MESSAGE",e.audienceUriValidationFailed="INVALID_AUDIENCE_URI"}(p||(p={})),function(e){e.UNKNOWN_UPLOAD_ERROR="UNKNOWN_UPLOAD_ERROR"}(g||(g={})),function(e){e.InvalidRequest="invalidRequest",e.Unhandled="Unhandled"}(v||(v={})),function(e){e.ShareLinkCSL="files_messages_sharelink_csl",e.ShareLinkPSLWithoutIndividualAccess="files_messages_sharelink_psl_without_individual_access",e.ShareLinkPSLWithoutIndividualWrite="files_messages_sharelink_psl_without_individual_write_access",e.ShareLinkPSLWithoutFutureAccess="files_messages_sharelink_psl_without_future_access",e.ShareLinkPSLWithoutFullAndFutureAccess="files_messages_sharelink_psl_without_full_and_future_access",e.ShareLinkPSLWithoutWriteAndFutureAccess="files_messages_sharelink_psl_without_write_and_future_access",e.ShareLinkFederatedAndGuestCSL="files_messages_sharelink_federated_and_guest_csl",e.ShareLinkFederatedCSL="files_messages_sharelink_federated_csl",e.ShareLinkPSLWithoutFullAccess="files_messages_sharelink_psl_without_full_access",e.ShareLinkCSLXTenantSharedChannel="files_messages_sharelink_csl_xtenant_sharedchannel",e.ShareLinkPSLWithoutFullAndFutureAccessXTenantSharedChannel="files_messages_sharelink_psl_without_full_and_future_access_xtenant_sharedchannel",e.ShareLinkPSLWithoutFullAndFutureAccessInTenantSharedChannel="files_messages_sharelink_psl_without_full_and_future_access_intenant_sharedchannel"}(_||(_={}));const k=100,f=10485760,S=12e4,I=3e5,y=600;var N;!function(e){e.GRAPH_URL_KEY="@microsoft.graph.downloadUrl",e.CONTENT_URL_KEY="@content.downloadUrl"}(N||(N={}));const C="/_layouts/15/Doc.aspx?OR=teams&action=edit&sourcedoc=";var T;!function(e){e.InvalidURL="InvalidURL",e.InvalidURLProtocol="InvalidURLProtocol",e.Invalid3PURLDomain="Invalid3PURLDomain",e.InvalidSPOOrPersonalSiteDomain="InvalidSPOOrPersonalSiteDomain",e.DifferentURLDomains="DifferentURLDomains"}(T||(T={}))},514958:(e,t,i)=>{var n;i.d(t,{z:()=>n}),function(e){e.logErrorMessage="logErrorMessage",e.internalErrorCode="internalErrorCode",e.spoInnerErrorCode="spoInnerErrorCode",e.correlationId="correlationId",e.httpCode="httpCode",e.errorCode="errorCode",e.isExpected="isExpected",e.reason="reason",e.serverResponse="serverResponse"}(n||(n={}))},385589:(e,t,i)=>{i.d(t,{X:()=>a});var n=i(475230);const a=e=>{switch(e){case n.Bx.unauthorizedAccess:return!1;case n.Bx.clientError:case n.Bx.badRequest:case n.Bx.internalServerError:case n.Bx.serviceUnavailable:case n.Bx.tooManyRequests:return!0;default:return!1}}}}]);